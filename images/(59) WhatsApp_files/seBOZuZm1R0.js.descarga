;/*FB_PKG_DELIM*/

__d("PerCustomerDataSharingModel",["WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.dataSharing3pdEnabled=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="perCustomerDataSharing";var s=o("WAWebBaseModel").defineModel(e);l.PerCustomerDataSharingModel=s}),98);
__d("WAArrayBuffersConcat",[],(function(t,n,r,o,a,i){"use strict";function e(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce(function(e,t){return e+t.byteLength},0),o=new Uint8Array(r),a=0;return t.forEach(function(e){o.set(new Uint8Array(e),a),a+=e.byteLength}),o.buffer}i.concatArrayBuffers=e}),66);
__d("WAArrayMove",[],(function(t,n,r,o,a,i){"use strict";var e=function(t,n,r){var e=r<0?t.length+r:r,o=t.splice(n,1)[0];t.splice(e,0,o)},l=function(n,r,o){var t=n.slice();return e(t,r,o),t};i.arrayMoveMutate=e,i.arrayMove=l}),66);
__d("WAArrayMoveToFirst",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){var n,r=!1;for(n=0;n<e.length;n++)if(e[n]===t){r=!0;break}if(r){var o=e[n];e.splice(n,1),e.unshift(o)}}i.default=e}),66);
__d("WAArraysShallowEqual",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){return e===t}function l(t,n,r){return r===void 0&&(r=e),t===n?!0:t.length!==n.length?!1:t.every(function(e,t){return r(e,n[t])})}i.default=l}),66);
__d("WAAsyncCache",["WAAbortError","WAMemoizeConcurrent","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,a){return r("WAMemoizeConcurrent")(e,(function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){if(n!=null&&n.signal.aborted)throw new(o("WAAbortError")).AbortError;var r=e(n),i=yield t.get(r,n);if(n!=null&&n.signal.aborted)throw new(o("WAAbortError")).AbortError;if(i!=null)return i;var l=yield a(n);if(n!=null&&n.signal.aborted)throw new(o("WAAbortError")).AbortError;return yield t.set(r,l,n),l});function i(e){return r.apply(this,arguments)}return i})())}l.default=e}),98);
__d("WABackoffDelay",["Promise","WAPromiseDelays","WARetryableError","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s={retries:1/0};function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a){var i=babelHelpers.extends({},s,t),l=i.delay,u=i.signal,c=i.retries,d=0,m=Date.now(),p=null,_=function(o){return(e||(e=n("Promise"))).reject(new(r("WARetryableError"))(o))};try{return m=Date.now(),yield a(_,d,u)}catch(e){if(d++,!(e instanceof r("WARetryableError")))throw e;p=e}for(;d<=c;){var f=Date.now()-m,g=l({iterationCount:d,taskDuration:f});yield o("WAPromiseDelays").delayMs(g,u);try{return m=Date.now(),yield a(_,d,u)}catch(e){if(d++,!(e instanceof r("WARetryableError")))throw e;p=e}}if(!p)throw r("err")("assert: backoff completed without error or result");var h=p.source;throw h}),c.apply(this,arguments)}l.backoff=u}),98);
__d("WABase64Equal",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){var n=e.length,r=t.length;switch(n-r){case-2:return t.charCodeAt(n)===61&&t.charCodeAt(n+1)===61&&t.substr(0,n)===e;case-1:return t.charCodeAt(n)===61&&t.substr(0,n)===e;case 0:return e===t;case 1:return e.charCodeAt(r)===61&&e.substr(0,r)===t;case 2:return e.charCodeAt(r)===61&&e.charCodeAt(r+1)===61&&e.substr(0,r)===t;default:return!1}}i.b64Equal=e}),66);
__d("WABase64Modulo",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){for(var n=atob(e),r=0,o=0;o<n.length;o++){var a=n.charCodeAt(o),i=a>>4,l=a&15;r=((r<<4)+i)%t,r=((r<<4)+l)%t}return r}i.default=e}),66);
__d("WABidiRangeData",[],(function(t,n,r,o,a,i){"use strict";var e=[65,26,32,26,73,1,11,1,5,1,6,23,24,31,32,449,451,7,21,2,16,5,14,1,130,4,6,2,4,4,5,1,7,1,2,3,4,1,2,20,21,83,84,140,147,166,167,38,40,49,55,-1,46,-1,2,-1,3,-1,3,-1,2,-56,64,-1,3,-1,2,-1,14,-48,82,-3,4,-101,116,-2,9,-2,12,-23,24,-30,57,-91,102,-58,67,-2,6,-3,4,-24,28,-1,10,-1,4,-1,6,-43,46,-119,167,55,56,1,2,4,12,4,5,3,10,10,12,29,30,2,3,8,10,2,4,22,23,7,8,1,4,4,7,4,10,2,4,2,3,1,9,1,5,2,3,3,7,12,14,7,8,2,7,1,2,6,10,2,4,22,23,7,8,2,3,2,3,2,6,3,27,4,5,1,8,10,12,3,4,1,13,1,2,9,10,3,4,22,23,7,8,2,3,5,8,4,12,1,2,2,5,1,16,2,6,11,19,1,9,2,3,8,10,2,4,22,23,7,8,2,3,5,8,2,3,1,7,2,4,2,12,1,5,2,3,3,7,18,29,1,2,6,9,3,4,4,7,2,3,1,2,2,5,2,5,3,6,12,16,2,3,2,5,3,4,3,6,1,7,1,15,13,27,3,4,8,9,3,4,23,24,16,19,1,4,4,23,3,8,2,6,10,17,1,8,2,3,11,12,3,4,23,24,10,11,5,8,8,9,3,4,2,11,2,9,1,2,2,6,10,11,2,17,11,12,3,4,41,43,4,9,3,4,3,4,2,6,14,18,26,28,2,3,18,21,24,25,9,10,1,3,7,15,3,9,8,14,10,12,3,15,48,49,2,14,7,15,13,50,2,3,1,2,5,6,24,25,1,2,10,11,2,11,1,3,5,6,1,10,10,12,4,36,24,26,27,28,1,2,1,6,10,11,36,54,1,6,1,3,5,54,8,9,6,7,13,50,45,49,1,7,1,3,2,4,25,27,4,7,16,20,13,14,2,4,6,7,15,16,40,41,1,6,1,3,377,378,4,6,7,8,1,2,4,6,41,42,4,6,33,34,4,6,7,8,1,2,4,6,15,16,57,58,4,6,67,72,29,32,16,32,86,88,6,9,639,640,26,31,89,96,13,14,4,18,18,21,2,11,18,32,13,14,3,18,52,54,1,8,8,9,2,13,7,8,1,4,10,48,10,16,89,96,5,7,34,35,1,6,70,80,31,35,4,6,3,7,2,3,6,19,40,42,5,16,44,48,26,32,11,48,23,25,2,5,56,57,1,10,1,2,2,10,6,19,10,16,10,16,14,100,48,49,1,6,1,2,5,6,9,13,27,36,9,14,32,36,2,4,1,4,56,57,1,3,3,4,1,4,2,10,48,56,2,7,15,18,60,67,43,45,11,22,1,14,1,8,4,5,6,7,3,5,1,6,192,256,278,280,6,8,38,40,6,8,8,9,1,2,1,2,1,2,31,33,53,54,7,8,1,4,3,4,7,10,4,6,6,10,13,18,3,4,7,24,1,1,-1,98,1,14,1,17,13,114,1,5,1,3,10,11,1,4,5,11,1,2,1,2,1,2,4,5,11,13,4,9,5,9,2,18,41,470,69,95,1,263,78,528,1,340,256,1024,47,48,47,48,133,139,4,7,2,14,38,39,1,6,1,3,56,63,2,17,23,32,7,8,7,8,7,8,7,8,7,8,7,8,7,8,7,557,3,28,9,13,2,3,5,7,5,9,86,92,3,4,90,91,4,9,43,44,94,95,48,96,45,48,48,64,28,31,50,65,12,16,167,171,99,101,31,32,6592,6656,20989,20992,1165,1232,317,320,28,48,47,64,30,32,80,82,6,48,102,103,55,57,9,51,13,14,3,4,4,5,25,27,1,9,8,16,52,64,68,78,12,36,13,14,38,46,25,36,2,13,30,36,48,49,2,6,2,4,16,17,11,15,7,8,25,26,41,47,2,4,2,13,3,4,8,9,1,3,10,12,32,33,51,52,1,4,2,4,5,7,1,2,1,25,17,19,8,19,6,8,6,8,6,15,7,8,7,8,58,64,117,118,2,3,4,7,10,16,11172,11184,23,27,49,2101,6766,6768,106,144,7,19,5,10,-1,2,-10,11,-532,534,-144,176,-13,14,-2,114,-143,177,26,32,26,37,89,92,6,8,6,8,6,8,3,38,12,13,26,27,19,20,2,3,15,17,14,48,123,128,1,2,1,5,45,48,9,86,2,67,45,176,29,32,49,96,36,45,30,35,38,48,30,31,37,41,14,56,158,160,10,16,36,40,36,40,40,48,52,63,1,145,311,320,22,32,8,160,-287,288,-225,228,-1,3,-5,9,-40,43,-4,5,-165,167,-82,89,-484,488,-8,18,-294,325,-44,46,-153,164,-175,175,1,2,54,69,7,31,10,28,49,53,2,4,7,18,1,3,25,32,10,19,36,41,1,10,18,26,35,36,3,14,52,61,10,14,2,3,16,17,20,31,18,19,28,31,2,3,1,3,6,72,7,8,1,2,4,5,15,16,11,17,47,48,3,16,10,18,2,3,8,10,2,4,22,23,7,8,2,3,5,8,3,4,4,6,2,4,3,5,1,7,1,6,7,163,56,64,2,5,1,2,21,22,1,2,3,33,51,57,1,2,4,6,1,3,4,12,10,176,50,56,4,6,1,3,27,63,51,59,2,3,1,3,4,15,10,48,43,44,1,2,2,8,1,2,1,8,10,64,27,32,2,6,1,10,16,208,47,56,1,3,1,101,83,95,8,10,1,3,8,9,2,3,30,31,2,6,1,2,4,5,3,12,10,80,8,10,42,50,4,5,4,31,1,7,2,4,40,46,2,6,8,17,1,7,2,5,46,59,1,3,9,38,57,320,9,10,38,52,8,18,29,32,32,57,1,8,1,3,1,76,7,8,2,3,38,59,1,10,10,16,6,7,2,3,37,41,2,3,1,2,1,8,10,320,19,21,4,187,1,16,21,63,923,1025,111,112,5,16,196,2944,1071,1072,9,4048,583,9216,569,576,31,32,10,14,2,98,30,37,1,11,48,55,15,25,10,11,7,8,21,26,19,707,91,192,75,80,56,67,13,77,2,3,1,13,2,16,6136,6144,1238,1280,9,8960,287,336,3,20,4,12,396,2704,107,112,13,16,9,16,10,12,1,3,1,4961,246,256,39,41,62,65,9,25,2,9,30,34,59,306,20,128,25,160,85,86,71,72,2,4,1,3,2,4,4,5,12,13,1,2,7,8,65,66,4,6,8,9,7,8,28,29,4,5,5,6,1,4,7,8,340,342,51,52,57,58,57,58,57,58,57,58,8,60,512,567,4,54,8,9,14,15,7,1659,45,55,7,9,10,14,2,370,44,48,10,1296,-208,215,-109,116,-1445,1447,-270,542,31,32,58,64,61,118,29,42,44,48,9,16,2,3504,42718,42752,4149,4160,222,224,5762,5776,7473,10576,542,2048,4939,786432,65534,65536,65534];i.DATA=e}),66);
__d("WABidi",["WABidiRangeData"],(function(t,n,r,o,a,i){"use strict";var e,l;function s(){if(!e){var t=n("WABidiRangeData").DATA,r=t.length/2;e=new Int32Array(r),l=new Int32Array(r);for(var o=0,a=0;o<r;o++,a+=2)e[o]=t[a]+(o===0?0:e[o-1]),l[o]=t[a+1]}}function u(t){s();for(var n=0;n<t.length;n++){var r=t.charCodeAt(n)|0;if(55296<=r&&r<56320){if(++n===t.length)break;var o=t.charCodeAt(n);if(56320<=o&&o<57344)r=65536+((r&1023)<<10|o&1023);else continue}else if(56320<=r&&r<57344)continue;if(!(r<e[0])){for(var a=e.length|0,i=0,u=a-1|0;i<u;){var c=u+i>>1;if(e[c]>r)u=c-1|0;else if(e[c+1]>r){u=c;break}else i=c+1|0}var d=l[u],m=e[u]+Math.abs(d)|0;if(r<m)return d<0?"rtl":"ltr"}}}i.dir=u}),66);
__d("WAConcurrentPriorityPromiseQueue",["Promise","WANullthrows","WAPriorityQueue","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(){function t(e,t,n){n===void 0&&(n=0),this.$1=e,this.$2=t,this.$3=n,this.$4=new Map,this.$5=new Map}var o=t.prototype;return o.clearQueue=function(){this.$5.clear(),this.$4.clear()},o.enqueue=function(r,o){var t,a,i=new(e||(e=n("Promise")))(function(e,n){t=e,a=n});return this.$6(babelHelpers.extends({},o,{run:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var e=yield r();t(e)}catch(e){a(e)}});function o(){return e.apply(this,arguments)}return o})()})),this.$7(),i},o.$6=function(t){var e=this.$8(t.group);e.push(t)},o.$9=function(){return this.$10()},o.$7=function(){for(;this.$11()<this.$1;){var e=this.$9();if(e==null)break;this.$12(e)}},o.$12=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this,n=e.run,r=e.signal,o=e.group,a=this.$13(o);if(r!=null&&r.aborted){setTimeout(function(){return t.$7()},this.$3);return}a.add(e);try{yield n()}finally{a.delete(e),setTimeout(function(){return t.$7()},this.$3)}});function t(t){return e.apply(this,arguments)}return t})(),o.$10=function(){for(var e of this.$5.values()){var t=e.peek();if(t&&!this.$14(t.group))return e.pull()}return null},o.$11=function(){var e=0;for(var t of this.$4.values())e+=t.size;return e},o.getEnqueuedTasksCount=function(){var e=0;for(var t of this.$5.values())e+=t.size();return e},o.$13=function(t){if(!this.$4.has(t)){var e=new Set;return this.$4.set(t,e),e}return r("WANullthrows")(this.$4.get(t))},o.$14=function(t){var e=this.$4.get(t);return e==null?!1:e.size>=this.$15(t)},o.$8=function(t){if(!this.$5.has(t)){var e=new(r("WAPriorityQueue"))(function(e){return e.priority});this.$5.set(t,e)}return r("WANullthrows")(this.$5.get(t))},o.$15=function(t){var e=this.$2[t];return e==null?1/0:e},t})();l.default=s}),98);
__d("WACrypto",["Promise","WAArrayBufferUtils","WABase64","WABinary","WACryptoAesCbc","WACryptoHmac","WALogger","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(e,t,n){return o("WACryptoAesCbc").aesCbcEncrypt(e,new Uint8Array(n)).then(function(e){return o("WACryptoHmac").hmacSha256(t,e).then(function(t){return o("WABinary").Binary.build(t,e).readBuffer()})})}function c(t,a,i){return(s||(s=n("Promise"))).resolve(new Uint8Array(i)).then(function(n){var i=o("WABase64").encodeB64(n.subarray(0,32)),l=n.subarray(32);return o("WACryptoHmac").hmacSha256(a,l).then(function(n){var a=o("WABase64").encodeB64(n);if(i!==a)throw o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["crypto:macAndDecrypt HMAC don't match "," vs. ",""])),i,a),r("err")("macAndDecrypt HMAC mismatch");return o("WACryptoAesCbc").aesCbcDecryptSplit(t,l)})})}function d(e,t){var n=e.slice(-t.byteLength);return o("WAArrayBufferUtils").arrayBuffersEqualUNSAFE(n,t)?e.slice(0,e.byteLength-t.byteLength):e}l.encryptAndMac=u,l.macAndDecrypt=c,l.removeEncryptedPadding=d}),98);
__d("WACryptoLtHash",["Promise","WACryptoHkdf","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=2,u=128,c=new ArrayBuffer(u),d=(function(){function t(e){this.salt=e}var r=t.prototype;return r.add=function(r,o){var t=this;return o.reduce((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,n){return t.$1(yield e,n)});return function(t,n){return e.apply(this,arguments)}})(),(e||(e=n("Promise"))).resolve(r))},r.subtract=function(r,o){var t=this;return o.reduce((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,n){return t.$2(yield e,n)});return function(t,n){return e.apply(this,arguments)}})(),(e||(e=n("Promise"))).resolve(r))},r.subtractThenAdd=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield this.subtract(e,n),o=yield this.add(r,t);return{ltHash:o,subtractResult:r}});function t(t,n,r){return e.apply(this,arguments)}return t})(),r.$1=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WACryptoHkdf").extractAndExpand(t,this.salt,u);return this.performPointwiseWithOverflow(e,n,function(e,t){return e+t})});function t(t,n){return e.apply(this,arguments)}return t})(),r.$2=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WACryptoHkdf").extractAndExpand(t,this.salt,u);return this.performPointwiseWithOverflow(e,n,function(e,t){return e-t})});function t(t,n){return e.apply(this,arguments)}return t})(),r.performPointwiseWithOverflow=function(t,n,r){for(var e=new DataView(t),o=new DataView(n),a=new ArrayBuffer(e.byteLength),i=new DataView(a),l=0;l<e.byteLength;l+=s)i.setUint16(l,r(e.getUint16(l,!0),o.getUint16(l,!0)),!0);return a},t})(),m=new d("WhatsApp Patch Integrity");l.KEY_LENGTH_BYTES=u,l.EMPTY_LT_HASH=c,l.LtHash16=d,l.LT_HASH_ANTI_TAMPERING=m}),98);
__d("WAWebWamEnumBrowserEngineName",[],(function(t,n,r,o,a,i){var e=Object.freeze({BLINK:0,GECKO:1,WEBKIT:2,UNKNOWN:3});i.BROWSER_ENGINE_NAME=e}),66);
__d("WAWebWamEnumPlatformName",[],(function(t,n,r,o,a,i){var e=Object.freeze({WINDOWS:0,MAC:1,LINUX:2,ANDROID:3,CHROME_OS:4,IOS:5,UNKNOWN:6});i.PLATFORM_NAME=e}),66);
__d("WAFPUtils",["$InternalEnum","WAWebWamEnumBrowserEngineName","WAWebWamEnumPlatformName"],(function(t,n,r,o,a,i,l){"use strict";function e(){var e=[].constructor;try{(-1).toFixed(-1)}catch(n){var t=n.message.length+(e+"").split(e.name).join("").length;switch(t){case 80:return o("WAWebWamEnumBrowserEngineName").BROWSER_ENGINE_NAME.BLINK;case 58:return o("WAWebWamEnumBrowserEngineName").BROWSER_ENGINE_NAME.GECKO;case 77:return o("WAWebWamEnumBrowserEngineName").BROWSER_ENGINE_NAME.WEBKIT;default:return o("WAWebWamEnumBrowserEngineName").BROWSER_ENGINE_NAME.UNKNOWN}}return o("WAWebWamEnumBrowserEngineName").BROWSER_ENGINE_NAME.UNKNOWN}var s=n("$InternalEnum").Mirrored(["WINDOWS","MAC","LINUX","ANDROID","CHROME_OS","IOS","UNKNOWN"]);function u(e){switch(e){case s.WINDOWS:return o("WAWebWamEnumPlatformName").PLATFORM_NAME.WINDOWS;case s.MAC:return o("WAWebWamEnumPlatformName").PLATFORM_NAME.MAC;case s.LINUX:return o("WAWebWamEnumPlatformName").PLATFORM_NAME.LINUX;case s.ANDROID:return o("WAWebWamEnumPlatformName").PLATFORM_NAME.ANDROID;case s.CHROME_OS:return o("WAWebWamEnumPlatformName").PLATFORM_NAME.CHROME_OS;case s.IOS:return o("WAWebWamEnumPlatformName").PLATFORM_NAME.IOS;default:return o("WAWebWamEnumPlatformName").PLATFORM_NAME.UNKNOWN}}var c=e(),d=new RegExp("(^|\\.)whatsapp\\.(net|com)","i");l.Platforms=s,l.castPlatformNameToWamEnum=u,l.DETECTED_BROWSER_ENGINE=c,l.waUrlRegex=d}),98);
__d("WAExternalInjectedSources",["WAFPUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return e.startsWith("data:")}function s(t){return t===""||e(t)?!1:!o("WAFPUtils").waUrlRegex.test(t)}function u(e){var t=new Set,n=new Set;return e.forEach(function(e){var r=e.match(/chrome-extension:\/\/([a-z0-9]+)\//i);r?t.add(e):n.add(e)}),[Array.from(t),Array.from(n)]}function c(){var e=Array.from(document.querySelectorAll("link")),t=e.reduce(function(e,t){return t.href&&s(t.href)&&e.push(t.href),e},[]);return u(t)}function d(){var e=Array.from(document.querySelectorAll("script")),t=e.reduce(function(e,t){return t.src&&s(t.src)&&e.push(t.src),e},[]);return u(t)}function m(){try{var e=d(),t=e[0],n=e[1],r=c(),o=r[0],a=r[1];return{extensionIds:Array.from(new Set(t.concat(o))).join(","),externalSources:Array.from(new Set(n.concat(a))).join(",")}}catch(e){return{extensionIds:"error",externalSources:Math.random()<.1?e.stack:""}}}l.default=m}),98);
__d("WAInOrderPromiseQueue",["Promise","WAAbortError","WAPromiseRaceAbort"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(){function t(){this.$1=(e||(e=n("Promise"))).resolve(),this.$3=new AbortController,this.$2=[]}var a=t.prototype;return a.enqueue=function(t){var e=this;t.catch(function(){});var n=function(){return t},a=this.$3.signal;this.$1=this.$1.then(n,n);var i=r("WAPromiseRaceAbort")(this.$1,a).catch(o("WAAbortError").catchAbort(function(t){var n;throw(n=e.$4)!=null?n:t}));return this.$2.push(i),i.finally(function(){e.$2.length>0&&e.$2[0]===i&&e.$2.shift()})},a.cancelAll=function(t){this.$4=t,this.$2=[],this.$3.abort(),this.$3=new AbortController},t})();l.default=s}),98);
__d("WAIsMediaKeyReusable",["WATimeUtils"],(function(t,n,r,o,a,i,l){"use strict";var e=2*o("WATimeUtils").DAY_SECONDS;function s(t){var n=Math.floor(Math.random()*o("WATimeUtils").DAY_SECONDS);return t!=null&&o("WATimeUtils").happenedWithin(t,e+n)}l.MMS_MEDIA_KEY_TTL=e,l.isMediaKeyReusable=s}),98);
__d("WAIsoToCc",[],(function(t,n,r,o,a,i){var e={ES:34,DE:49,MX:52,GB:44,SA:966,IT:39,AF:93,AX:358,AL:355,DZ:213,AS:1,AD:376,AO:244,AI:1,AG:1,AR:54,AM:374,AW:297,AC:247,AU:61,AT:43,AZ:994,BS:1,BH:973,BD:880,BB:1,BY:375,BE:32,BZ:501,BJ:229,BM:1,BT:975,BO:591,BQ:599,BA:387,BW:267,BR:55,IO:246,VG:1,BN:673,BG:359,BF:226,BI:257,CI:225,KH:855,CM:237,CA:1,CV:238,KY:1,CF:236,TD:235,CL:56,CN:86,CX:61,CC:61,CO:57,KM:269,CG:242,CD:243,CK:682,CR:506,HR:385,CU:53,CW:599,CY:357,CZ:420,DK:45,DJ:253,DM:1,DO:1,EC:593,EG:20,SV:503,GQ:240,ER:291,EE:372,ET:251,FK:500,FO:298,FJ:679,FI:358,FR:33,GF:594,PF:689,GA:241,GM:220,GE:995,GH:233,GI:350,GR:30,GL:299,GD:1,GP:590,GU:1,GT:502,GG:44,GN:224,GW:245,GY:592,HT:509,HN:504,HK:852,HU:36,IS:354,IN:91,ID:62,IR:98,IQ:964,IE:353,IM:44,IL:972,JM:1,JP:81,JE:44,JO:962,KZ:7,KE:254,KI:686,KW:965,KG:996,LA:856,LV:371,LB:961,LS:266,LR:231,LY:218,LI:423,LT:370,LU:352,MO:853,MK:389,MG:261,MW:265,MY:60,MV:960,ML:223,MT:356,MH:692,MQ:596,MR:222,MU:230,YT:262,FM:691,MD:373,MC:377,MN:976,ME:382,MS:1,MA:212,MZ:258,MM:95,NA:264,NR:674,NP:977,NL:31,NC:687,NZ:64,NI:505,NE:227,NG:234,NU:683,NF:672,KP:850,MP:1,NO:47,OM:968,PK:92,PW:680,PS:970,PA:507,PG:675,PY:595,PE:51,PH:63,PL:48,PT:351,PR:1,QA:974,RO:40,RU:7,RW:250,RE:262,BL:590,SH:290,KN:1,LC:1,MF:590,PM:508,VC:1,WS:685,SM:378,SN:221,RS:381,SC:248,SL:232,SG:65,SX:1,SK:421,SI:386,SB:677,SO:252,ZA:27,KR:82,SS:211,LK:94,SD:249,SR:597,SJ:47,SZ:268,SE:46,CH:41,SY:963,ST:239,TW:886,TJ:992,TZ:255,TH:66,TL:670,TG:228,TK:690,TO:676,TT:1,TN:216,TR:90,TM:993,TC:1,TV:688,VI:1,UG:256,UA:380,AE:971,US:1,UY:598,UZ:998,VU:678,VA:379,VE:58,VN:84,WF:681,YE:967,ZM:260,ZW:263,XK:383},l=e;i.default=l}),66);
__d("WAMediaCalculateFilehash",["WACryptoDependencies","WACryptoSha256"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return o("WACryptoSha256").sha256Base64(e)}function s(){var e=o("WACryptoDependencies").getCrypto().getRandomValues(new Uint8Array(20)),t=e.buffer;return o("WACryptoSha256").sha256Base64(t)}l.calculateFilehash=e,l.getRandomFilehash=s}),98);
__d("WAPlatformEstimate",["WAFPUtils","WAWebWamEnumBrowserEngineName","WAWebWamEnumPlatformName"],(function(t,n,r,o,a,i,l){"use strict";function e(){var e,t,n,r,a,i,l;if(o("WAFPUtils").DETECTED_BROWSER_ENGINE!==o("WAWebWamEnumBrowserEngineName").BROWSER_ENGINE_NAME.BLINK)return o("WAWebWamEnumPlatformName").PLATFORM_NAME.UNKNOWN;var s="getVideoPlaybackQuality"in HTMLVideoElement.prototype,u=(e=CSS)==null?void 0:e.supports("color-scheme: initial"),c=(t=CSS)==null?void 0:t.supports("appearance: initial"),d="DisplayNames"in Intl,m=(n=CSS)==null?void 0:n.supports("aspect-ratio: initial"),p=(r=CSS)==null?void 0:r.supports("border-end-end-radius: initial"),_="randomUUID"in crypto,f="downlinkMax"in(((a=navigator.connection)==null?void 0:a.prototype)||{}),g="setAppBadge"in Navigator.prototype,h=function(t){return t in window},y=function(t,n){return t?n:!1},C=(i={},i[o("WAFPUtils").Platforms.ANDROID]=[y(m,h("BarcodeDetector")),y(c,h("ContentIndex")),y(s,h("ContactsManager")),f,y(_,!h("EyeDropper")),y(d,!h("FileSystemWritableFileStream")),y(p,!(h("HID")&&h("HIDDevice"))),y(p,!(h("Serial")&&h("SerialPort"))),!h("SharedWorker"),h("ontouchstart")&&h("TouchEvent"),y(u,!g)],i[o("WAFPUtils").Platforms.CHROME_OS]=[y(m,h("BarcodeDetector")),y(c,!h("ContentIndex")),y(s,!h("ContactsManager")),f,y(_,h("EyeDropper")),y(d,h("FileSystemWritableFileStream")),y(p,h("HID")&&h("HIDDevice")),y(p,h("Serial")&&h("SerialPort")),h("SharedWorker"),y(u,!g)],i[o("WAFPUtils").Platforms.WINDOWS]=[y(m,!h("BarcodeDetector")),y(c,!h("ContentIndex")),y(s,!h("ContactsManager")),!f,y(_,h("EyeDropper")),y(d,h("FileSystemWritableFileStream")),y(p,h("HID")&&h("HIDDevice")),y(p,h("Serial")&&h("SerialPort")),h("SharedWorker"),y(u,g)],i[o("WAFPUtils").Platforms.MAC]=[y(m,h("BarcodeDetector")),y(c,!h("ContentIndex")),y(s,!h("ContactsManager")),!f,y(_,h("EyeDropper")),y(d,h("FileSystemWritableFileStream")),y(p,h("HID")&&h("HIDDevice")),y(p,h("Serial")&&h("SerialPort")),h("SharedWorker"),!(h("ontouchstart")&&h("TouchEvent")),y(u,g)],i[o("WAFPUtils").Platforms.LINUX]=[y(m,!h("BarcodeDetector")),y(c,!h("ContentIndex")),y(s,!h("ContactsManager")),!f,y(_,h("EyeDropper")),y(d,h("FileSystemWritableFileStream")),y(p,h("HID")&&h("HIDDevice")),y(p,h("Serial")&&h("SerialPort")),h("SharedWorker"),!(h("ontouchstart")&&h("TouchEvent")),y(u,!g)],i[o("WAFPUtils").Platforms.UNKNOWN]=[!1],i),b=Object.keys(C).reduce(function(e,t){var n,r=C[(n=o("WAFPUtils").Platforms.cast(t))!=null?n:o("WAFPUtils").Platforms.UNKNOWN],a=+(r.filter(function(e){return e}).length/r.length).toFixed(2);return e[t]=a,e},{}),v=Object.keys(b).reduce(function(e,t){return b[e]>b[t]?e:t});return o("WAFPUtils").castPlatformNameToWamEnum((l=o("WAFPUtils").Platforms.cast(v))!=null?l:o("WAFPUtils").Platforms.UNKNOWN)}l.default=e}),98);
__d("WAPromiseProps",["Promise"],(function(t,n,r,o,a,i){"use strict";var e;function l(t){var r=Object.keys(t),o=(e||(e=n("Promise"))).all(r.map(function(e){return t[e]}));function a(e){for(var t={},n=0;n<e.length;n++)t[r[n]]=e[n];return t}return o.then(a)}i.promiseProps=l}),66);
__d("WARaceSignal",["asyncToGeneratorRuntime"],(function(t,n,r,o,a,i){"use strict";function e(e,t){return l.apply(this,arguments)}function l(){return l=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n,r=new AbortController;if(e.some(function(e){return e.aborted}))r.abort();else{n=function(){for(var t of e)t.removeEventListener("abort",o);n=null};var o=function(){n==null||n(),r.abort()};for(var a of e)a.addEventListener("abort",o)}try{return yield t(r.signal)}finally{n==null||n()}}),l.apply(this,arguments)}i.default=e}),66);
__d("WAReplaceRepeatingWhitespace",[],(function(t,n,r,o,a,i){"use strict";var e="\xA0";function l(t,n){var r=function(r){for(var t="",o=0;o<r.length;o++){var a=n===!0&&r[o]==="\n";t+=a?"\n":e}return t};return/\s\s+/.test(t)?t.replace(/\s\s+/g,r):t}i.default=l}),66);
__d("WASmaxInBizSettingsIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","error");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQErrorResponseMixin=e}),98);
__d("WASmaxInBizSettingsIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","bad-request");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",400);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorBadRequestMixin=e}),98);
__d("WASmaxInBizSettingsIQErrorFeatureNotImplementedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","feature-not-implemented");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",501);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorFeatureNotImplementedMixin=e}),98);
__d("WASmaxInBizSettingsIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","internal-server-error");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",500);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorInternalServerErrorMixin=e}),98);
__d("WASmaxInBizSettingsIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","service-unavailable");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",503);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorServiceUnavailableMixin=e}),98);
__d("WASmaxInBizSettingsPrivacySettingErrors",["WAResultOrError","WASmaxInBizSettingsIQErrorBadRequestMixin","WASmaxInBizSettingsIQErrorFeatureNotImplementedMixin","WASmaxInBizSettingsIQErrorInternalServerErrorMixin","WASmaxInBizSettingsIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInBizSettingsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:t.value});var n=o("WASmaxInBizSettingsIQErrorFeatureNotImplementedMixin").parseIQErrorFeatureNotImplementedMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorFeatureNotImplemented",value:n.value});var r=o("WASmaxInBizSettingsIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:r.value});var a=o("WASmaxInBizSettingsIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(e);return a.success?o("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:a.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorBadRequest","IQErrorFeatureNotImplemented","IQErrorServiceUnavailable","IQErrorInternalServerError"],[t,n,r,a])}l.parsePrivacySettingErrors=e}),98);
__d("WASmaxInBizSettingsGetPrivacySettingResponseError",["WAResultOrError","WASmaxInBizSettingsIQErrorResponseMixin","WASmaxInBizSettingsPrivacySettingErrors","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInBizSettingsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInBizSettingsPrivacySettingErrors").parsePrivacySettingErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorPrivacySettingErrors:i.value})):i}l.parseGetPrivacySettingResponseError=e}),98);
__d("WASmaxInBizSettingsIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQResultResponseMixin=e}),98);
__d("WASmaxInBizSettingsEnums",[],(function(t,n,r,o,a,i){var e={DISCOVERABLE:"DISCOVERABLE",HIDDEN:"HIDDEN",UNDEFINED:"UNDEFINED"},l={false:"false",notset:"notset",true:"true"},s={false:"false",true:"true"};i.ENUM_DISCOVERABLE_HIDDEN_UNDEFINED=e,i.ENUM_FALSE_NOTSET_TRUE=l,i.ENUM_FALSE_TRUE=s}),66);
__d("WASmaxInBizSettingsSmbDataSharingSettingValueMixin",["WAResultOrError","WASmaxInBizSettingsEnums","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").attrStringEnum(e,"value",o("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE);return t.success?o("WAResultOrError").makeResult({value:t.value}):t}l.parseSmbDataSharingSettingValueMixin=e}),98);
__d("WASmaxInBizSettingsSmbDataSharingSettingMixin",["WASmaxInBizSettingsSmbDataSharingSettingValueMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"privacy");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"smb_data_sharing_with_meta_consent");if(!n.success)return n;var r=o("WASmaxInBizSettingsSmbDataSharingSettingValueMixin").parseSmbDataSharingSettingValueMixin(n.value);return r.success,r}l.parseSmbDataSharingSettingMixin=e}),98);
__d("WASmaxInBizSettingsGetPrivacySettingResponseSuccess",["WAResultOrError","WASmaxInBizSettingsIQResultResponseMixin","WASmaxInBizSettingsSmbDataSharingSettingMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"privacy");if(!r.success)return r;var a=o("WASmaxInBizSettingsSmbDataSharingSettingMixin").parseSmbDataSharingSettingMixin(r.value);if(!a.success)return a;var i=o("WASmaxInBizSettingsIQResultResponseMixin").parseIQResultResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({privacySmbDataSharingSettingMixin:a.value},i.value)):i}l.parseGetPrivacySettingResponseSuccess=e}),98);
__d("WASmaxOutBizSettingsBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"get"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBaseIQGetRequestMixin=s}),98);
__d("WASmaxOutBizSettingsGetPrivacySettingRequest",["WASmaxJsx","WASmaxOutBizSettingsBaseIQGetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxOutBizSettingsBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(o("WASmaxJsx").smax("iq",{xmlns:"w:biz",to:o("WAWap").S_WHATSAPP_NET,smax_id:o("WAWap").INT(109)},o("WASmaxJsx").smax("privacy",null)));return e}l.makeGetPrivacySettingRequest=e}),98);
__d("WASmaxBizSettingsGetPrivacySettingRPC",["WAComms","WASmaxInBizSettingsGetPrivacySettingResponseError","WASmaxInBizSettingsGetPrivacySettingResponseSuccess","WASmaxOutBizSettingsGetPrivacySettingRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WASmaxOutBizSettingsGetPrivacySettingRequest").makeGetPrivacySettingRequest(),n=yield o("WAComms").sendSmaxStanza(t,e),r=o("WASmaxInBizSettingsGetPrivacySettingResponseSuccess").parseGetPrivacySettingResponseSuccess(n,t);if(r.success)return{name:"GetPrivacySettingResponseSuccess",value:r.value};var a=o("WASmaxInBizSettingsGetPrivacySettingResponseError").parseGetPrivacySettingResponseError(n,t);if(a.success)return{name:"GetPrivacySettingResponseError",value:a.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("GetPrivacySetting",{Success:r,Error:a}))}),s.apply(this,arguments)}l.sendGetPrivacySettingRPC=e}),98);
__d("WASmaxInBizSettingsSetPrivacySettingResponseError",["WAResultOrError","WASmaxInBizSettingsIQErrorResponseMixin","WASmaxInBizSettingsPrivacySettingErrors","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInBizSettingsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInBizSettingsPrivacySettingErrors").parsePrivacySettingErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorPrivacySettingErrors:i.value})):i}l.parseSetPrivacySettingResponseError=e}),98);
__d("WASmaxInBizSettingsSetPrivacySettingResponseSuccess",["WAResultOrError","WASmaxInBizSettingsIQResultResponseMixin","WASmaxInBizSettingsSmbDataSharingSettingMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"privacy");if(!r.success)return r;var a=o("WASmaxInBizSettingsSmbDataSharingSettingMixin").parseSmbDataSharingSettingMixin(r.value),i=o("WASmaxInBizSettingsIQResultResponseMixin").parseIQResultResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({privacySmbDataSharingSettingMixin:a.success?a.value:null},i.value)):i}l.parseSetPrivacySettingResponseSuccess=e}),98);
__d("WASmaxOutBizSettingsBaseIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"set"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBaseIQSetRequestMixin=s}),98);
__d("WASmaxOutBizSettingsSmbDataSharingSettingValueMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.anyValue,n=o("WASmaxJsx").smax("smax$any",{value:o("WAWap").CUSTOM_STRING(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeSmbDataSharingSettingValueMixin=s}),98);
__d("WASmaxOutBizSettingsSmbDataSharingSettingMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutBizSettingsSmbDataSharingSettingValueMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxJsx").smax("privacy",null,o("WASmaxOutBizSettingsSmbDataSharingSettingValueMixin").mergeSmbDataSharingSettingValueMixin(o("WASmaxJsx").smax("smb_data_sharing_with_meta_consent",null),e));return t}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeSmbDataSharingSettingMixin=s}),98);
__d("WASmaxOutBizSettingsSetPrivacySettingRequest",["WASmaxJsx","WASmaxMixins","WASmaxOutBizSettingsBaseIQSetRequestMixin","WASmaxOutBizSettingsSmbDataSharingSettingMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.smbDataSharingSettingMixinArgs,n=o("WASmaxOutBizSettingsBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(o("WASmaxJsx").smax("iq",{xmlns:"w:biz",to:o("WAWap").S_WHATSAPP_NET,smax_id:o("WAWap").INT(110)},o("WASmaxMixins").optionalMerge(o("WASmaxOutBizSettingsSmbDataSharingSettingMixin").mergeSmbDataSharingSettingMixin,o("WASmaxJsx").smax("privacy",null),t)));return n}l.makeSetPrivacySettingRequest=e}),98);
__d("WASmaxBizSettingsSetPrivacySettingRPC",["WAComms","WASmaxInBizSettingsSetPrivacySettingResponseError","WASmaxInBizSettingsSetPrivacySettingResponseSuccess","WASmaxOutBizSettingsSetPrivacySettingRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutBizSettingsSetPrivacySettingRequest").makeSetPrivacySettingRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInBizSettingsSetPrivacySettingResponseSuccess").parseSetPrivacySettingResponseSuccess(r,n);if(a.success)return{name:"SetPrivacySettingResponseSuccess",value:a.value};var i=o("WASmaxInBizSettingsSetPrivacySettingResponseError").parseSetPrivacySettingResponseError(r,n);if(i.success)return{name:"SetPrivacySettingResponseError",value:i.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("SetPrivacySetting",{Success:a,Error:i}))}),s.apply(this,arguments)}l.sendSetPrivacySettingRPC=e}),98);
__d("WASmaxInBlocklistsGetBlockListResponseInternalServerError",["WAResultOrError","WASmaxInBlocklistsIQErrorResponseMixin","WASmaxInBlocklistsServerErrors","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInBlocklistsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInBlocklistsServerErrors").parseServerErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorServerErrors:i.value})):i}l.parseGetBlockListResponseInternalServerError=e}),98);
__d("WASmaxInBlocklistsGetBlockListResponseInvalidRequest",["WAResultOrError","WASmaxInBlocklistsGetBlocklistErrors","WASmaxInBlocklistsIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInBlocklistsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInBlocklistsGetBlocklistErrors").parseGetBlocklistErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorGetBlocklistErrors:i.value})):i}l.parseGetBlockListResponseInvalidRequest=e}),98);
__d("WASmaxInBlocklistsDisplayNameMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").attrString(e,"display_name");return t.success?o("WAResultOrError").makeResult({displayName:t.value}):t}l.parseDisplayNameMixin=e}),98);
__d("WASmaxInBlocklistsPnJidMixin",["WAResultOrError","WASmaxParseJid"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseJid").attrUserJid(e,"pn_jid");return t.success?o("WAResultOrError").makeResult({pnJid:t.value}):t}l.parsePnJidMixin=e}),98);
__d("WASmaxInBlocklistsUnknownIdentifierMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"unknown_identifier","true");return t.success?o("WAResultOrError").makeResult({unknownIdentifier:t.value}):t}l.parseUnknownIdentifierMixin=e}),98);
__d("WASmaxInBlocklistsUsernameMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").attrString(e,"username");return t.success?o("WAResultOrError").makeResult({username:t.value}):t}l.parseUsernameMixin=e}),98);
__d("WASmaxInBlocklistsBlocklistIds",["WAResultOrError","WASmaxInBlocklistsDisplayNameMixin","WASmaxInBlocklistsPnJidMixin","WASmaxInBlocklistsUnknownIdentifierMixin","WASmaxInBlocklistsUsernameMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInBlocklistsUsernameMixin").parseUsernameMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"Username",value:t.value});var n=o("WASmaxInBlocklistsPnJidMixin").parsePnJidMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"PnJid",value:n.value});var r=o("WASmaxInBlocklistsDisplayNameMixin").parseDisplayNameMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"DisplayName",value:r.value});var a=o("WASmaxInBlocklistsUnknownIdentifierMixin").parseUnknownIdentifierMixin(e);return a.success?o("WAResultOrError").makeResult({name:"UnknownIdentifier",value:a.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["Username","PnJid","DisplayName","UnknownIdentifier"],[t,n,r,a])}l.parseBlocklistIds=e}),98);
__d("WASmaxInBlocklistsBlocklistIdentifierMixin",["WAResultOrError","WASmaxInBlocklistsBlocklistIds"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInBlocklistsBlocklistIds").parseBlocklistIds(e);return t.success?o("WAResultOrError").makeResult({blocklistIds:t.value}):t}l.parseBlocklistIdentifierMixin=e}),98);
__d("WASmaxInBlocklistsGetBlockListResponseMigratedSuccessWithMismatch",["WAResultOrError","WASmaxInBlocklistsBlocklistIdentifierMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"item");if(!t.success)return t;var n=o("WASmaxParseJid").attrLidUserJid(e,"jid");if(!n.success)return n;var r=o("WASmaxParseUtils").optionalLiteral(o("WASmaxParseUtils").attrString,e,"active","true");if(!r.success)return r;var a=o("WASmaxInBlocklistsBlocklistIdentifierMixin").parseBlocklistIdentifierMixin(e);return a.success?o("WAResultOrError").makeResult(babelHelpers.extends({jid:n.value,active:r.value},a.value)):a}function s(t,n){var r=o("WASmaxParseUtils").assertTag(t,"iq");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(t,"list");if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(n,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,t,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,t,"type","result");if(!s.success)return s;var u=o("WASmaxParseReference").attrStringFromReference(n,["id"]);if(!u.success)return u;var c=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,t,"id",u.value);if(!c.success)return c;var d=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,a.value,"dhash");if(!d.success)return d;var m=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,a.value,"addressing_mode","lid");if(!m.success)return m;var p=o("WASmaxParseUtils").mapChildrenWithTag(a.value,"item",0,64e3,e);return p.success?o("WAResultOrError").makeResult({type:s.value,listDhash:d.value,listAddressingMode:m.value,listItem:p.value}):p}l.parseGetBlockListResponseMigratedSuccessWithMismatchListItem=e,l.parseGetBlockListResponseMigratedSuccessWithMismatch=s}),98);
__d("WASmaxInBlocklistsGetBlockListResponseSuccessWithMatch",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",r.value);if(!a.success)return a;var i=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");if(!i.success)return i;var l=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",l.value);return s.success?o("WAResultOrError").makeResult({type:i.value}):s}l.parseGetBlockListResponseSuccessWithMatch=e}),98);
__d("WASmaxInBlocklistsGetBlockListResponseSuccessWithMismatch",["WAResultOrError","WASmaxInBlocklistsDisplayNameMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"item");if(!t.success)return t;var n=o("WASmaxParseJid").attrUserJid(e,"jid");if(!n.success)return n;var r=o("WASmaxParseUtils").optional(o("WASmaxParseJid").attrLidUserJid,e,"lid");if(!r.success)return r;var a=o("WASmaxInBlocklistsDisplayNameMixin").parseDisplayNameMixin(e);return o("WAResultOrError").makeResult({jid:n.value,lid:r.value,displayNameMixin:a.success?a.value:null})}function s(t,n){var r=o("WASmaxParseUtils").assertTag(t,"iq");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(t,"list");if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(n,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,t,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,t,"type","result");if(!s.success)return s;var u=o("WASmaxParseReference").attrStringFromReference(n,["id"]);if(!u.success)return u;var c=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,t,"id",u.value);if(!c.success)return c;var d=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,a.value,"dhash");if(!d.success)return d;var m=o("WASmaxParseUtils").optionalLiteral(o("WASmaxParseUtils").attrString,a.value,"addressing_mode","pn");if(!m.success)return m;var p=o("WASmaxParseUtils").mapChildrenWithTag(a.value,"item",0,64e3,e);return p.success?o("WAResultOrError").makeResult({type:s.value,listDhash:d.value,listAddressingMode:m.value,listItem:p.value}):p}l.parseGetBlockListResponseSuccessWithMismatchListItem=e,l.parseGetBlockListResponseSuccessWithMismatch=s}),98);
__d("WASmaxOutBlocklistsGetBlockListRequest",["WASmaxChildren","WASmaxJsx","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.itemDhash,n=o("WASmaxJsx").smax("item",{dhash:o("WAWap").CUSTOM_STRING(t)});return n}function s(t){var n=t.itemArgs,r=o("WASmaxJsx").smax("iq",{to:o("WAWap").S_WHATSAPP_NET,xmlns:"blocklist",type:"get",id:o("WAWap").generateId()},o("WASmaxChildren").OPTIONAL_CHILD(e,n));return r}l.makeGetBlockListRequestItem=e,l.makeGetBlockListRequest=s}),98);
__d("WASmaxBlocklistsGetBlockListRPC",["WAComms","WASmaxInBlocklistsGetBlockListResponseInternalServerError","WASmaxInBlocklistsGetBlockListResponseInvalidRequest","WASmaxInBlocklistsGetBlockListResponseMigratedSuccessWithMismatch","WASmaxInBlocklistsGetBlockListResponseSuccessWithMatch","WASmaxInBlocklistsGetBlockListResponseSuccessWithMismatch","WASmaxOutBlocklistsGetBlockListRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutBlocklistsGetBlockListRequest").makeGetBlockListRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInBlocklistsGetBlockListResponseSuccessWithMismatch").parseGetBlockListResponseSuccessWithMismatch(r,n);if(a.success)return{name:"GetBlockListResponseSuccessWithMismatch",value:a.value};var i=o("WASmaxInBlocklistsGetBlockListResponseMigratedSuccessWithMismatch").parseGetBlockListResponseMigratedSuccessWithMismatch(r,n);if(i.success)return{name:"GetBlockListResponseMigratedSuccessWithMismatch",value:i.value};var l=o("WASmaxInBlocklistsGetBlockListResponseSuccessWithMatch").parseGetBlockListResponseSuccessWithMatch(r,n);if(l.success)return{name:"GetBlockListResponseSuccessWithMatch",value:l.value};var s=o("WASmaxInBlocklistsGetBlockListResponseInvalidRequest").parseGetBlockListResponseInvalidRequest(r,n);if(s.success)return{name:"GetBlockListResponseInvalidRequest",value:s.value};var u=o("WASmaxInBlocklistsGetBlockListResponseInternalServerError").parseGetBlockListResponseInternalServerError(r,n);if(u.success)return{name:"GetBlockListResponseInternalServerError",value:u.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("GetBlockList",{SuccessWithMismatch:a,MigratedSuccessWithMismatch:i,SuccessWithMatch:l,InvalidRequest:s,InternalServerError:u}))}),s.apply(this,arguments)}l.sendGetBlockListRPC=e}),98);
__d("WASmaxInBotIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","bad-request");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",400);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorBadRequestMixin=e}),98);
__d("WASmaxInBotIQErrorForbiddenMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","forbidden");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",403);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorForbiddenMixin=e}),98);
__d("WASmaxInBotIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","internal-server-error");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",500);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorInternalServerErrorMixin=e}),98);
__d("WASmaxInBotIQErrorNotAllowedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","not-allowed");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",405);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorNotAllowedMixin=e}),98);
__d("WASmaxInBotBotListErrors",["WAResultOrError","WASmaxInBotIQErrorBadRequestMixin","WASmaxInBotIQErrorForbiddenMixin","WASmaxInBotIQErrorInternalServerErrorMixin","WASmaxInBotIQErrorNotAllowedMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInBotIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:t.value});var n=o("WASmaxInBotIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorForbidden",value:n.value});var r=o("WASmaxInBotIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:r.value});var a=o("WASmaxInBotIQErrorNotAllowedMixin").parseIQErrorNotAllowedMixin(e);return a.success?o("WAResultOrError").makeResult({name:"IQErrorNotAllowed",value:a.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorInternalServerError","IQErrorForbidden","IQErrorBadRequest","IQErrorNotAllowed"],[t,n,r,a])}l.parseBotListErrors=e}),98);
__d("WASmaxInBotIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","error");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQErrorResponseMixin=e}),98);
__d("WASmaxInBotBotListResponseError",["WAResultOrError","WASmaxInBotBotListErrors","WASmaxInBotIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInBotIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInBotBotListErrors").parseBotListErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorBotListErrors:i.value})):i}l.parseBotListResponseError=e}),98);
__d("WASmaxInBotEnums",[],(function(t,n,r,o,a,i){var e={all:"all",category:"category",featured:"featured"},l={dark:"dark",light:"light"},s={hidden:"hidden",hscroll:"hscroll",hscroll_icebreakers:"hscroll_icebreakers",hscroll_large:"hscroll_large",hscroll_small:"hscroll_small",listview:"listview"};i.ENUM_ALL_CATEGORY_FEATURED=e,i.ENUM_DARK_LIGHT=l,i.ENUM_HIDDEN_HSCROLL_HSCROLLICEBREAKERS_HSCROLLLARGE_HSCROLLSMALL_LISTVIEW=s}),66);
__d("WASmaxInBotIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQResultResponseMixin=e}),98);
__d("WASmaxInBotBotListResponseSuccessV2",["WAResultOrError","WASmaxInBotEnums","WASmaxInBotIQResultResponseMixin","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"theme");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"background");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"primary_text");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(e,"secondary_text");if(!a.success)return a;var i=o("WASmaxParseUtils").attrStringEnum(e,"mode",o("WASmaxInBotEnums").ENUM_DARK_LIGHT);if(!i.success)return i;var l=o("WASmaxParseUtils").contentString(n.value);if(!l.success)return l;var s=o("WASmaxParseUtils").contentString(r.value);if(!s.success)return s;var u=o("WASmaxParseUtils").contentString(a.value);return u.success?o("WAResultOrError").makeResult({mode:i.value,backgroundElementValue:l.value,primaryTextElementValue:s.value,secondaryTextElementValue:u.value}):u}function s(t){var n=o("WASmaxParseUtils").assertTag(t,"bot");if(!n.success)return n;var r=o("WASmaxParseJid").attrUserJid(t,"jid");if(!r.success)return r;var a=o("WASmaxParseUtils").attrString(t,"persona_id");if(!a.success)return a;var i=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrInt,t,"count");if(!i.success)return i;var l=o("WASmaxParseUtils").mapChildrenWithTag(t,"theme",0,2,e);return l.success?o("WAResultOrError").makeResult({jid:r.value,personaId:a.value,count:i.value,theme:l.value}):l}function u(e){var t=o("WASmaxParseUtils").assertTag(e,"section");if(!t.success)return t;var n=o("WASmaxParseUtils").attrString(e,"name");if(!n.success)return n;var r=o("WASmaxParseUtils").attrStringEnum(e,"type",o("WASmaxInBotEnums").ENUM_ALL_CATEGORY_FEATURED);if(!r.success)return r;var a=o("WASmaxParseUtils").mapChildrenWithTag(e,"bot",0,1/0,s);return a.success?o("WAResultOrError").makeResult({name:n.value,type:r.value,bot:a.value}):a}function c(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"bot");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(r.value,"default");if(!a.success)return a;var i=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,r.value,"v","2");if(!i.success)return i;var l=o("WASmaxParseJid").attrUserJid(a.value,"jid");if(!l.success)return l;var s=o("WASmaxParseUtils").attrString(a.value,"persona_id");if(!s.success)return s;var c=o("WASmaxInBotIQResultResponseMixin").parseIQResultResponseMixin(e,t);if(!c.success)return c;var d=o("WASmaxParseUtils").mapChildrenWithTag(r.value,"section",1,1/0,u);return d.success?o("WAResultOrError").makeResult(babelHelpers.extends({botV:i.value,botDefaultJid:l.value,botDefaultPersonaId:s.value},c.value,{botSection:d.value})):d}l.parseBotListResponseSuccessV2BotSectionBotTheme=e,l.parseBotListResponseSuccessV2BotSectionBot=s,l.parseBotListResponseSuccessV2BotSection=u,l.parseBotListResponseSuccessV2=c}),98);
__d("WASmaxInBotBotListResponseSuccessV3",["WAResultOrError","WASmaxInBotEnums","WASmaxInBotIQResultResponseMixin","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"bot");if(!t.success)return t;var n=o("WASmaxParseJid").attrUserJid(e,"jid");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(e,"persona_id");if(!r.success)return r;var a=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,e,"card_title");if(!a.success)return a;var i=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrInt,e,"count");return i.success?o("WAResultOrError").makeResult({jid:n.value,personaId:r.value,cardTitle:a.value,count:i.value}):i}function s(t){var n=o("WASmaxParseUtils").assertTag(t,"section");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(t,"name");if(!r.success)return r;var a=o("WASmaxParseUtils").attrStringEnum(t,"type",o("WASmaxInBotEnums").ENUM_ALL_CATEGORY_FEATURED);if(!a.success)return a;var i=o("WASmaxParseUtils").attrStringEnum(t,"display_type",o("WASmaxInBotEnums").ENUM_HIDDEN_HSCROLL_HSCROLLICEBREAKERS_HSCROLLLARGE_HSCROLLSMALL_LISTVIEW);if(!i.success)return i;var l=o("WASmaxParseUtils").mapChildrenWithTag(t,"bot",0,1/0,e);return l.success?o("WAResultOrError").makeResult({name:r.value,type:a.value,displayType:i.value,bot:l.value}):l}function u(e){var t=o("WASmaxParseUtils").assertTag(e,"default");if(!t.success)return t;var n=o("WASmaxParseJid").attrUserJid(e,"jid");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(e,"persona_id");return r.success?o("WAResultOrError").makeResult({jid:n.value,personaId:r.value}):r}function c(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"bot");if(!r.success)return r;var a=o("WASmaxParseUtils").optionalChildWithTag(r.value,"default",u);if(!a.success)return a;var i=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,r.value,"v","3");if(!i.success)return i;var l=o("WASmaxParseUtils").attrString(r.value,"bhash");if(!l.success)return l;var c=o("WASmaxInBotIQResultResponseMixin").parseIQResultResponseMixin(e,t);if(!c.success)return c;var d=o("WASmaxParseUtils").mapChildrenWithTag(r.value,"section",0,1/0,s);return d.success?o("WAResultOrError").makeResult(babelHelpers.extends({botV:i.value,botBhash:l.value},c.value,{botDefault:a.value,botSection:d.value})):d}l.parseBotListResponseSuccessV3BotSectionBot=e,l.parseBotListResponseSuccessV3BotSection=s,l.parseBotListResponseSuccessV3BotDefault=u,l.parseBotListResponseSuccessV3=c}),98);
__d("WASmaxOutBotBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"get"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBaseIQGetRequestMixin=s}),98);
__d("WASmaxOutBotBotListIQMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutBotBaseIQGetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxOutBotBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(o("WASmaxJsx").smax("iq",{to:o("WAWap").S_WHATSAPP_NET,xmlns:"bot"}));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBotListIQMixin=s}),98);
__d("WASmaxOutBotBotListRequest",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxOutBotBotListIQMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.botJid,n=o("WASmaxJsx").smax("bot",{jid:o("WAWap").JID(t)});return n}function s(t){var n=t.botArgs,r=t.botV,a=t.botBhash,i=o("WASmaxOutBotBotListIQMixin").mergeBotListIQMixin(o("WASmaxJsx").smax("iq",null,o("WASmaxJsx").smax("bot",{v:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,r),bhash:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,a)},o("WASmaxChildren").REPEATED_CHILD(e,n,0,1/0))));return i}l.makeBotListRequestBotBot=e,l.makeBotListRequest=s}),98);
__d("WASmaxBotBotListRPC",["WAComms","WASmaxInBotBotListResponseError","WASmaxInBotBotListResponseSuccessV2","WASmaxInBotBotListResponseSuccessV3","WASmaxOutBotBotListRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutBotBotListRequest").makeBotListRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInBotBotListResponseSuccessV2").parseBotListResponseSuccessV2(r,n);if(a.success)return{name:"BotListResponseSuccessV2",value:a.value};var i=o("WASmaxInBotBotListResponseSuccessV3").parseBotListResponseSuccessV3(r,n);if(i.success)return{name:"BotListResponseSuccessV3",value:i.value};var l=o("WASmaxInBotBotListResponseError").parseBotListResponseError(r,n);if(l.success)return{name:"BotListResponseError",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("BotList",{SuccessV2:a,SuccessV3:i,Error:l}))}),s.apply(this,arguments)}l.sendBotListRPC=e}),98);
__d("WASmaxInGroupsIQErrorAlreadyExistsMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","already-exists");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",304);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorAlreadyExistsMixin=e}),98);
__d("WASmaxInGroupsIQErrorConflictMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","conflict");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",409);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorConflictMixin=e}),98);
__d("WASmaxInGroupsAcceptGroupAddClientErrors",["WAResultOrError","WASmaxInGroupsIQErrorAlreadyExistsMixin","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorConflictMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorForbiddenMixin","WASmaxInGroupsIQErrorGoneMixin","WASmaxInGroupsIQErrorItemNotFoundMixin","WASmaxInGroupsIQErrorLockedMixin","WASmaxInGroupsIQErrorNotAllowedMixin","WASmaxInGroupsIQErrorNotAuthorizedMixin","WASmaxInGroupsIQErrorParentLinkedGroupsParticipantsResourceLimitMixin","WASmaxInGroupsIQErrorResourceConstraintMixin","WASmaxInGroupsIQErrorResourceLimitMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInGroupsIQErrorAlreadyExistsMixin").parseIQErrorAlreadyExistsMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorAlreadyExists",value:t.value});var n=o("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:n.value});var r=o("WASmaxInGroupsIQErrorNotAuthorizedMixin").parseIQErrorNotAuthorizedMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"IQErrorNotAuthorized",value:r.value});var a=o("WASmaxInGroupsIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(e);if(a.success)return o("WAResultOrError").makeResult({name:"IQErrorForbidden",value:a.value});var i=o("WASmaxInGroupsIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(e);if(i.success)return o("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:i.value});var l=o("WASmaxInGroupsIQErrorConflictMixin").parseIQErrorConflictMixin(e);if(l.success)return o("WAResultOrError").makeResult({name:"IQErrorConflict",value:l.value});var s=o("WASmaxInGroupsIQErrorGoneMixin").parseIQErrorGoneMixin(e);if(s.success)return o("WAResultOrError").makeResult({name:"IQErrorGone",value:s.value});var u=o("WASmaxInGroupsIQErrorResourceLimitMixin").parseIQErrorResourceLimitMixin(e);if(u.success)return o("WAResultOrError").makeResult({name:"IQErrorResourceLimit",value:u.value});var c=o("WASmaxInGroupsIQErrorLockedMixin").parseIQErrorLockedMixin(e);if(c.success)return o("WAResultOrError").makeResult({name:"IQErrorLocked",value:c.value});var d=o("WASmaxInGroupsIQErrorResourceConstraintMixin").parseIQErrorResourceConstraintMixin(e);if(d.success)return o("WAResultOrError").makeResult({name:"IQErrorResourceConstraint",value:d.value});var m=o("WASmaxInGroupsIQErrorNotAllowedMixin").parseIQErrorNotAllowedMixin(e);if(m.success)return o("WAResultOrError").makeResult({name:"IQErrorNotAllowed",value:m.value});var p=o("WASmaxInGroupsIQErrorParentLinkedGroupsParticipantsResourceLimitMixin").parseIQErrorParentLinkedGroupsParticipantsResourceLimitMixin(e);if(p.success)return o("WAResultOrError").makeResult({name:"IQErrorParentLinkedGroupsParticipantsResourceLimit",value:p.value});var _=o("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(e);return _.success?o("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:_.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorAlreadyExists","IQErrorBadRequest","IQErrorNotAuthorized","IQErrorForbidden","IQErrorItemNotFound","IQErrorConflict","IQErrorGone","IQErrorResourceLimit","IQErrorLocked","IQErrorResourceConstraint","IQErrorNotAllowed","IQErrorParentLinkedGroupsParticipantsResourceLimit","IQErrorFallbackClient"],[t,n,r,a,i,l,s,u,c,d,m,p,_])}l.parseAcceptGroupAddClientErrors=e}),98);
__d("WASmaxInGroupsAcceptGroupAddResponseClientError",["WAResultOrError","WASmaxInGroupsAcceptGroupAddClientErrors","WASmaxInGroupsIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInGroupsAcceptGroupAddClientErrors").parseAcceptGroupAddClientErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorAcceptGroupAddClientErrors:i.value})):i}l.parseAcceptGroupAddResponseClientError=e}),98);
__d("WASmaxInGroupsAcceptGroupAddResponseGroupJoinRequestSuccess",["WASmaxInGroupsIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"membership_approval_request");if(!r.success)return r;var a=o("WASmaxInGroupsIQResultResponseMixin").parseIQResultResponseMixin(e,t);return a.success,a}l.parseAcceptGroupAddResponseGroupJoinRequestSuccess=e}),98);
__d("WASmaxInGroupsAcceptGroupAddResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(e,t);return r.success,r}l.parseAcceptGroupAddResponseServerError=e}),98);
__d("WASmaxInGroupsAcceptGroupAddResponseSuccess",["WASmaxInGroupsIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInGroupsIQResultResponseMixin").parseIQResultResponseMixin(e,t);return r.success,r}l.parseAcceptGroupAddResponseSuccess=e}),98);
__d("WASmaxOutGroupsAcceptGroupAddRequest",["WASmaxJsx","WASmaxOutGroupsBaseSetGroupMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.acceptCode,n=e.acceptExpiration,r=e.acceptAdmin,a=o("WASmaxOutGroupsBaseSetGroupMixin").mergeBaseSetGroupMixin(o("WASmaxJsx").smax("iq",null,o("WASmaxJsx").smax("accept",{code:o("WAWap").CUSTOM_STRING(t),expiration:o("WAWap").INT(n),admin:o("WAWap").USER_JID(r)})),e);return a}l.makeAcceptGroupAddRequest=e}),98);
__d("WASmaxGroupsAcceptGroupAddRPC",["WAComms","WASmaxInGroupsAcceptGroupAddResponseClientError","WASmaxInGroupsAcceptGroupAddResponseGroupJoinRequestSuccess","WASmaxInGroupsAcceptGroupAddResponseServerError","WASmaxInGroupsAcceptGroupAddResponseSuccess","WASmaxOutGroupsAcceptGroupAddRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutGroupsAcceptGroupAddRequest").makeAcceptGroupAddRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInGroupsAcceptGroupAddResponseGroupJoinRequestSuccess").parseAcceptGroupAddResponseGroupJoinRequestSuccess(r,n);if(a.success)return{name:"AcceptGroupAddResponseGroupJoinRequestSuccess",value:a.value};var i=o("WASmaxInGroupsAcceptGroupAddResponseSuccess").parseAcceptGroupAddResponseSuccess(r,n);if(i.success)return{name:"AcceptGroupAddResponseSuccess",value:i.value};var l=o("WASmaxInGroupsAcceptGroupAddResponseClientError").parseAcceptGroupAddResponseClientError(r,n);if(l.success)return{name:"AcceptGroupAddResponseClientError",value:l.value};var s=o("WASmaxInGroupsAcceptGroupAddResponseServerError").parseAcceptGroupAddResponseServerError(r,n);if(s.success)return{name:"AcceptGroupAddResponseServerError",value:s.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("AcceptGroupAdd",{GroupJoinRequestSuccess:a,Success:i,ClientError:l,ServerError:s}))}),s.apply(this,arguments)}l.sendAcceptGroupAddRPC=e}),98);
__d("WASmaxInGroupsIQErrorItemNotFoundOrBadRequestOrRateOverlimitOrFallbackClientMixinGroup",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorItemNotFoundMixin","WASmaxInGroupsIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInGroupsIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:t.value});var n=o("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:n.value});var r=o("WASmaxInGroupsIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:r.value});var a=o("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(e);return a.success?o("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:a.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorItemNotFound","IQErrorBadRequest","IQErrorRateOverlimit","IQErrorFallbackClient"],[t,n,r,a])}l.parseIQErrorItemNotFoundOrBadRequestOrRateOverlimitOrFallbackClientMixinGroup=e}),98);
__d("WASmaxInGroupsAcknowledgeGroupResponseClientError",["WAResultOrError","WASmaxInGroupsIQErrorItemNotFoundOrBadRequestOrRateOverlimitOrFallbackClientMixinGroup","WASmaxInGroupsIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInGroupsIQErrorItemNotFoundOrBadRequestOrRateOverlimitOrFallbackClientMixinGroup").parseIQErrorItemNotFoundOrBadRequestOrRateOverlimitOrFallbackClientMixinGroup(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorIQErrorItemNotFoundOrBadRequestOrRateOverlimitOrFallbackClientMixinGroup:i.value})):i}l.parseAcknowledgeGroupResponseClientError=e}),98);
__d("WASmaxInGroupsAcknowledgeGroupResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(e,t);return r.success,r}l.parseAcknowledgeGroupResponseServerError=e}),98);
__d("WASmaxInGroupsAcknowledgeGroupResponseSuccess",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",r.value);if(!a.success)return a;var i=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");if(!i.success)return i;var l=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",l.value);return s.success?o("WAResultOrError").makeResult({type:i.value}):s}l.parseAcknowledgeGroupResponseSuccess=e}),98);
__d("WASmaxOutGroupsAcknowledgeGroupRequest",["WASmaxJsx","WASmaxOutGroupsBaseSetGroupMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxOutGroupsBaseSetGroupMixin").mergeBaseSetGroupMixin(o("WASmaxJsx").smax("iq",null,o("WASmaxJsx").smax("ack",null)),e);return t}l.makeAcknowledgeGroupRequest=e}),98);
__d("WASmaxGroupsAcknowledgeGroupRPC",["WAComms","WASmaxInGroupsAcknowledgeGroupResponseClientError","WASmaxInGroupsAcknowledgeGroupResponseServerError","WASmaxInGroupsAcknowledgeGroupResponseSuccess","WASmaxOutGroupsAcknowledgeGroupRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutGroupsAcknowledgeGroupRequest").makeAcknowledgeGroupRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInGroupsAcknowledgeGroupResponseSuccess").parseAcknowledgeGroupResponseSuccess(r,n);if(a.success)return{name:"AcknowledgeGroupResponseSuccess",value:a.value};var i=o("WASmaxInGroupsAcknowledgeGroupResponseClientError").parseAcknowledgeGroupResponseClientError(r,n);if(i.success)return{name:"AcknowledgeGroupResponseClientError",value:i.value};var l=o("WASmaxInGroupsAcknowledgeGroupResponseServerError").parseAcknowledgeGroupResponseServerError(r,n);if(l.success)return{name:"AcknowledgeGroupResponseServerError",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("AcknowledgeGroup",{Success:a,ClientError:i,ServerError:l}))}),s.apply(this,arguments)}l.sendAcknowledgeGroupRPC=e}),98);
__d("WASmaxInGroupsGetGroupInfoClientErrors",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorForbiddenMixin","WASmaxInGroupsIQErrorGoneMixin","WASmaxInGroupsIQErrorItemNotFoundMixin","WASmaxInGroupsIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInGroupsIQErrorGoneMixin").parseIQErrorGoneMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorGone",value:t.value});var n=o("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:n.value});var r=o("WASmaxInGroupsIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"IQErrorForbidden",value:r.value});var a=o("WASmaxInGroupsIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(e);if(a.success)return o("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:a.value});var i=o("WASmaxInGroupsIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(e);if(i.success)return o("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:i.value});var l=o("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(e);return l.success?o("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:l.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorGone","IQErrorBadRequest","IQErrorForbidden","IQErrorItemNotFound","IQErrorRateOverlimit","IQErrorFallbackClient"],[t,n,r,a,i,l])}l.parseGetGroupInfoClientErrors=e}),98);
__d("WASmaxInGroupsGetGroupInfoResponseClientError",["WAResultOrError","WASmaxInGroupsGetGroupInfoClientErrors","WASmaxInGroupsIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInGroupsGetGroupInfoClientErrors").parseGetGroupInfoClientErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorGetGroupInfoClientErrors:i.value})):i}l.parseGetGroupInfoResponseClientError=e}),98);
__d("WASmaxInGroupsGetGroupInfoResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(e,t);return r.success,r}l.parseGetGroupInfoResponseServerError=e}),98);
__d("WASmaxInGroupsGetGroupInfoResponseSuccess",["WAResultOrError","WASmaxInGroupsDedupAttrsMixin","WASmaxInGroupsGroupInfoMixin","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"group");if(!t.success)return t;var n=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,e,"size",0,19999);if(!n.success)return n;var r=o("WASmaxInGroupsGroupInfoMixin").parseGroupInfoMixin(e);if(!r.success)return r;var a=o("WASmaxInGroupsDedupAttrsMixin").parseDedupAttrsMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({size:n.value},r.value,{dedupAttrsMixin:a.success?a.value:null}))}function s(t,n){var r=o("WASmaxParseUtils").assertTag(t,"iq");if(!r.success)return r;var a=o("WASmaxParseUtils").optionalChildWithTag(t,"group",e);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(n,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,t,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,t,"type","result");if(!s.success)return s;var u=o("WASmaxParseReference").attrStringFromReference(n,["id"]);if(!u.success)return u;var c=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,t,"id",u.value);return c.success?o("WAResultOrError").makeResult({type:s.value,group:a.value}):c}l.parseGetGroupInfoResponseSuccessGroup=e,l.parseGetGroupInfoResponseSuccess=s}),98);
__d("WASmaxOutGroupsAddRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.addRequestAdmin,n=o("WASmaxJsx").smax("add_request",{admin:o("WAWap").USER_JID(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeAddRequestMixin=s}),98);
__d("WASmaxOutGroupsCodeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.addRequestCode,n=o("WASmaxJsx").smax("add_request",{code:o("WAWap").CUSTOM_STRING(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeCodeMixin=s}),98);
__d("WASmaxOutGroupsGetGroupInfoRequestTypeAttributeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.anyRequest,n=o("WASmaxJsx").smax("smax$any",{request:o("WAWap").CUSTOM_STRING(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeGetGroupInfoRequestTypeAttributeMixin=s}),98);
__d("WASmaxOutGroupsGetGroupInfoRequestTypeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutGroupsGetGroupInfoRequestTypeAttributeMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxOutGroupsGetGroupInfoRequestTypeAttributeMixin").mergeGetGroupInfoRequestTypeAttributeMixin(o("WASmaxJsx").smax("query",null),e);return t}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeGetGroupInfoRequestTypeMixin=s}),98);
__d("WASmaxOutGroupsGetGroupInfoRequest",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutGroupsAddRequestMixin","WASmaxOutGroupsBaseGetGroupMixin","WASmaxOutGroupsCodeMixin","WASmaxOutGroupsGetGroupInfoRequestTypeMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.addRequestExpiration,n=o("WASmaxOutGroupsCodeMixin").mergeCodeMixin(o("WASmaxOutGroupsAddRequestMixin").mergeAddRequestMixin(o("WASmaxJsx").smax("add_request",{expiration:o("WAWap").INT(t)}),e),e);return n}function s(t){var n=t.addRequestArgs,r=t.queryPhash,a=t.getGroupInfoRequestTypeMixinArgs,i=o("WASmaxOutGroupsBaseGetGroupMixin").mergeBaseGetGroupMixin(o("WASmaxJsx").smax("iq",null,o("WASmaxMixins").optionalMerge(o("WASmaxOutGroupsGetGroupInfoRequestTypeMixin").mergeGetGroupInfoRequestTypeMixin,o("WASmaxJsx").smax("query",{phash:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,r)},o("WASmaxChildren").OPTIONAL_CHILD(e,n)),a)),t);return i}l.makeGetGroupInfoRequestQueryAddRequest=e,l.makeGetGroupInfoRequest=s}),98);
__d("WASmaxGroupsGetGroupInfoRPC",["WAComms","WASmaxInGroupsGetGroupInfoResponseClientError","WASmaxInGroupsGetGroupInfoResponseServerError","WASmaxInGroupsGetGroupInfoResponseSuccess","WASmaxOutGroupsGetGroupInfoRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutGroupsGetGroupInfoRequest").makeGetGroupInfoRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInGroupsGetGroupInfoResponseSuccess").parseGetGroupInfoResponseSuccess(r,n);if(a.success)return{name:"GetGroupInfoResponseSuccess",value:a.value};var i=o("WASmaxInGroupsGetGroupInfoResponseClientError").parseGetGroupInfoResponseClientError(r,n);if(i.success)return{name:"GetGroupInfoResponseClientError",value:i.value};var l=o("WASmaxInGroupsGetGroupInfoResponseServerError").parseGetGroupInfoResponseServerError(r,n);if(l.success)return{name:"GetGroupInfoResponseServerError",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("GetGroupInfo",{Success:a,ClientError:i,ServerError:l}))}),s.apply(this,arguments)}l.sendGetGroupInfoRPC=e}),98);
__d("WASmaxInGroupsGetGroupProfilePictureClientErrors",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorForbiddenMixin","WASmaxInGroupsIQErrorItemNotFoundMixin","WASmaxInGroupsIQErrorNotAllowedMixin","WASmaxInGroupsIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInGroupsIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:t.value});var n=o("WASmaxInGroupsIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorForbidden",value:n.value});var r=o("WASmaxInGroupsIQErrorNotAllowedMixin").parseIQErrorNotAllowedMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"IQErrorNotAllowed",value:r.value});var a=o("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(a.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:a.value});var i=o("WASmaxInGroupsIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(e);if(i.success)return o("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:i.value});var l=o("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(e);return l.success?o("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:l.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorItemNotFound","IQErrorForbidden","IQErrorNotAllowed","IQErrorBadRequest","IQErrorRateOverlimit","IQErrorFallbackClient"],[t,n,r,a,i,l])}l.parseGetGroupProfilePictureClientErrors=e}),98);
__d("WASmaxInGroupsGetGroupProfilePicturesResponseClientError",["WAResultOrError","WASmaxInGroupsGetGroupProfilePictureClientErrors","WASmaxInGroupsIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInGroupsGetGroupProfilePictureClientErrors").parseGetGroupProfilePictureClientErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorGetGroupProfilePictureClientErrors:i.value})):i}l.parseGetGroupProfilePicturesResponseClientError=e}),98);
__d("WASmaxInGroupsGetGroupProfilePicturesResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(e,t);return r.success,r}l.parseGetGroupProfilePicturesResponseServerError=e}),98);
__d("WASmaxInGroupsBadLinkedGroupProfilePictureErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"picture");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"status","405");return n.success?o("WAResultOrError").makeResult({status:n.value}):n}l.parseBadLinkedGroupProfilePictureErrorMixin=e}),98);
__d("WASmaxInGroupsBadServerProfilePictureErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"picture");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"status","500");return n.success?o("WAResultOrError").makeResult({status:n.value}):n}l.parseBadServerProfilePictureErrorMixin=e}),98);
__d("WASmaxInGroupsPictureDidNotChangeMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"picture");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"status","304");return n.success?o("WAResultOrError").makeResult({status:n.value}):n}l.parsePictureDidNotChangeMixin=e}),98);
__d("WASmaxInGroupsPictureNotFoundMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"picture");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"status","204");return n.success?o("WAResultOrError").makeResult({status:n.value}):n}l.parsePictureNotFoundMixin=e}),98);
__d("WASmaxInGroupsPictureDidNotChangeOrPictureNotFoundOrBadServerProfilePictureErrorOrBadLinkedGroupProfilePictureErrorMixinGroup",["WAResultOrError","WASmaxInGroupsBadLinkedGroupProfilePictureErrorMixin","WASmaxInGroupsBadServerProfilePictureErrorMixin","WASmaxInGroupsPictureDidNotChangeMixin","WASmaxInGroupsPictureNotFoundMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInGroupsPictureDidNotChangeMixin").parsePictureDidNotChangeMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"PictureDidNotChange",value:t.value});var n=o("WASmaxInGroupsPictureNotFoundMixin").parsePictureNotFoundMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"PictureNotFound",value:n.value});var r=o("WASmaxInGroupsBadServerProfilePictureErrorMixin").parseBadServerProfilePictureErrorMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"BadServerProfilePictureError",value:r.value});var a=o("WASmaxInGroupsBadLinkedGroupProfilePictureErrorMixin").parseBadLinkedGroupProfilePictureErrorMixin(e);return a.success?o("WAResultOrError").makeResult({name:"BadLinkedGroupProfilePictureError",value:a.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["PictureDidNotChange","PictureNotFound","BadServerProfilePictureError","BadLinkedGroupProfilePictureError"],[t,n,r,a])}l.parsePictureDidNotChangeOrPictureNotFoundOrBadServerProfilePictureErrorOrBadLinkedGroupProfilePictureErrorMixinGroup=e}),98);
__d("WASmaxInGroupsGetGroupProfilePicturesPartialProfilePictureResponseMixin",["WAResultOrError","WASmaxInGroupsPictureDidNotChangeOrPictureNotFoundOrBadServerProfilePictureErrorOrBadLinkedGroupProfilePictureErrorMixinGroup","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"picture");if(!t.success)return t;var n=o("WASmaxInGroupsPictureDidNotChangeOrPictureNotFoundOrBadServerProfilePictureErrorOrBadLinkedGroupProfilePictureErrorMixinGroup").parsePictureDidNotChangeOrPictureNotFoundOrBadServerProfilePictureErrorOrBadLinkedGroupProfilePictureErrorMixinGroup(e);return o("WAResultOrError").makeResult({pictureDidNotChangeOrPictureNotFoundOrBadServerProfilePictureErrorOrBadLinkedGroupProfilePictureErrorMixinGroup:n.success?n.value:null})}l.parseGetGroupProfilePicturesPartialProfilePictureResponseMixin=e}),98);
__d("WASmaxInGroupsProfilePictureIdMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"picture");if(!t.success)return t;var n=o("WASmaxParseUtils").attrString(e,"id");return n.success?o("WAResultOrError").makeResult({id:n.value}):n}l.parseProfilePictureIdMixin=e}),98);
__d("WASmaxInGroupsProfilePictureTypeMixin",["WAResultOrError","WASmaxInGroupsEnums","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"picture");if(!t.success)return t;var n=o("WASmaxParseUtils").attrStringEnum(e,"type",o("WASmaxInGroupsEnums").ENUM_IMAGE_PREVIEW);return n.success?o("WAResultOrError").makeResult({type:n.value}):n}l.parseProfilePictureTypeMixin=e}),98);
__d("WASmaxInGroupsProfilePictureBlobResponseMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"picture");if(!t.success)return t;var n=o("WASmaxParseUtils").contentBytesRange(e,1,void 0);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}l.parseProfilePictureBlobResponseMixin=e}),98);
__d("WASmaxInGroupsProfilePictureUrlResponseMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"picture");if(!t.success)return t;var n=o("WASmaxParseUtils").attrString(e,"url");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(e,"direct_path");return r.success?o("WAResultOrError").makeResult({url:n.value,directPath:r.value}):r}l.parseProfilePictureUrlResponseMixin=e}),98);
__d("WASmaxInGroupsProfilePictureUrlOrBlobResponseMixinGroup",["WAResultOrError","WASmaxInGroupsProfilePictureBlobResponseMixin","WASmaxInGroupsProfilePictureUrlResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInGroupsProfilePictureUrlResponseMixin").parseProfilePictureUrlResponseMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"ProfilePictureUrlResponse",value:t.value});var n=o("WASmaxInGroupsProfilePictureBlobResponseMixin").parseProfilePictureBlobResponseMixin(e);return n.success?o("WAResultOrError").makeResult({name:"ProfilePictureBlobResponse",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["ProfilePictureUrlResponse","ProfilePictureBlobResponse"],[t,n])}l.parseProfilePictureUrlOrBlobResponseMixinGroup=e}),98);
__d("WASmaxInGroupsGetGroupProfilePicturesSuccessProfilePictureResponseMixin",["WAResultOrError","WASmaxInGroupsProfilePictureIdMixin","WASmaxInGroupsProfilePictureTypeMixin","WASmaxInGroupsProfilePictureUrlOrBlobResponseMixinGroup","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"picture");if(!t.success)return t;var n=o("WASmaxInGroupsProfilePictureIdMixin").parseProfilePictureIdMixin(e);if(!n.success)return n;var r=o("WASmaxInGroupsProfilePictureTypeMixin").parseProfilePictureTypeMixin(e);if(!r.success)return r;var a=o("WASmaxInGroupsProfilePictureUrlOrBlobResponseMixinGroup").parseProfilePictureUrlOrBlobResponseMixinGroup(e);return o("WAResultOrError").makeResult(babelHelpers.extends({},n.value,r.value,{profilePictureUrlOrBlobResponseMixinGroup:a.success?a.value:null}))}l.parseGetGroupProfilePicturesSuccessProfilePictureResponseMixin=e}),98);
__d("WASmaxInGroupsGetGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup",["WAResultOrError","WASmaxInGroupsGetGroupProfilePicturesPartialProfilePictureResponseMixin","WASmaxInGroupsGetGroupProfilePicturesSuccessProfilePictureResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInGroupsGetGroupProfilePicturesSuccessProfilePictureResponseMixin").parseGetGroupProfilePicturesSuccessProfilePictureResponseMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"GetGroupProfilePicturesSuccessProfilePictureResponse",value:t.value});var n=o("WASmaxInGroupsGetGroupProfilePicturesPartialProfilePictureResponseMixin").parseGetGroupProfilePicturesPartialProfilePictureResponseMixin(e);return n.success?o("WAResultOrError").makeResult({name:"GetGroupProfilePicturesPartialProfilePictureResponse",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["SuccessProfilePictureResponse","PartialProfilePictureResponse"],[t,n])}l.parseGetGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup=e}),98);
__d("WASmaxInGroupsSubGroupMixin",["WAResultOrError","WASmaxParseJid"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseJid").attrGroupJid(e,"sub_group_jid");return t.success?o("WAResultOrError").makeResult({subGroupJid:t.value}):t}l.parseSubGroupMixin=e}),98);
__d("WASmaxInGroupsParentOrSubGroupMixinGroup",["WAResultOrError","WASmaxInGroupsParentGroupMixin","WASmaxInGroupsSubGroupMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInGroupsParentGroupMixin").parseParentGroupMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"ParentGroup",value:t.value});var n=o("WASmaxInGroupsSubGroupMixin").parseSubGroupMixin(e);return n.success?o("WAResultOrError").makeResult({name:"SubGroup",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["ParentGroup","SubGroup"],[t,n])}l.parseParentOrSubGroupMixinGroup=e}),98);
__d("WASmaxInGroupsGetGroupProfilePicturesProfilePicturesResponseMixin",["WAResultOrError","WASmaxInGroupsGetGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup","WASmaxInGroupsParentOrSubGroupMixinGroup","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"picture");if(!t.success)return t;var n=o("WASmaxInGroupsParentOrSubGroupMixinGroup").parseParentOrSubGroupMixinGroup(e);if(!n.success)return n;var r=o("WASmaxInGroupsGetGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup").parseGetGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup(e);return r.success?o("WAResultOrError").makeResult({parentOrSubGroupMixinGroup:n.value,getGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup:r.value}):r}function s(t){var n=o("WASmaxParseUtils").flattenedChildWithTag(t,"pictures");if(!n.success)return n;var r=o("WASmaxParseUtils").mapChildrenWithTag(n.value,"picture",1,1e3,e);return r.success?o("WAResultOrError").makeResult({picturesPicture:r.value}):r}l.parseGetGroupProfilePicturesProfilePicturesResponsePicturesPicture=e,l.parseGetGroupProfilePicturesProfilePicturesResponseMixin=s}),98);
__d("WASmaxInGroupsGetGroupProfilePicturesResponseSuccessGroupPictures",["WAResultOrError","WASmaxInGroupsGetGroupProfilePicturesProfilePicturesResponseMixin","WASmaxInGroupsIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInGroupsIQResultResponseMixin").parseIQResultResponseMixin(e,t);if(!r.success)return r;var a=o("WASmaxInGroupsGetGroupProfilePicturesProfilePicturesResponseMixin").parseGetGroupProfilePicturesProfilePicturesResponseMixin(e);return a.success?o("WAResultOrError").makeResult(babelHelpers.extends({},r.value,a.value)):a}l.parseGetGroupProfilePicturesResponseSuccessGroupPictures=e}),98);
__d("WASmaxOutGroupsBaseGetGroupOrServerMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutGroupsBaseGetGroupMixin","WASmaxOutGroupsBaseGetServerMixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.baseGetGroup)return o("WASmaxOutGroupsBaseGetGroupMixin").mergeBaseGetGroupMixin(e,t.baseGetGroup);if(t.isBaseGetServer)return o("WASmaxOutGroupsBaseGetServerMixin").mergeBaseGetServerMixin(e);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeBaseGetGroupOrServerMixinGroup=e}),98);
__d("WASmaxOutGroupsSubGroupMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.anySubGroupJid,n=o("WASmaxJsx").smax("smax$any",{sub_group_jid:o("WAWap").GROUP_JID(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeSubGroupMixin=s}),98);
__d("WASmaxOutGroupsParentOrSubGroupMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutGroupsParentGroupMixin","WASmaxOutGroupsSubGroupMixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.parentGroup)return o("WASmaxOutGroupsParentGroupMixin").mergeParentGroupMixin(e,t.parentGroup);if(t.subGroup)return o("WASmaxOutGroupsSubGroupMixin").mergeSubGroupMixin(e,t.subGroup);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeParentOrSubGroupMixinGroup=e}),98);
__d("WASmaxOutGroupsProfilePictureIdMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.pictureId,n=o("WASmaxJsx").smax("picture",{id:o("WAWap").CUSTOM_STRING(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeProfilePictureIdMixin=s}),98);
__d("WASmaxOutGroupsProfilePictureQueryMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.pictureQuery,n=o("WASmaxJsx").smax("picture",{query:o("WAWap").CUSTOM_STRING(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeProfilePictureQueryMixin=s}),98);
__d("WASmaxOutGroupsProfilePictureTypeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.pictureType,n=o("WASmaxJsx").smax("picture",{type:o("WAWap").CUSTOM_STRING(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeProfilePictureTypeMixin=s}),98);
__d("WASmaxOutGroupsSubGroupHintMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.anyLinkedGroupsMembershipHint,n=o("WASmaxJsx").smax("smax$any",{linked_groups_membership_hint:o("WAWap").GROUP_JID(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeSubGroupHintMixin=s}),98);
__d("WASmaxOutGroupsGetGroupProfilePicturesProfilePicturesRequestMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutGroupsParentOrSubGroupMixinGroup","WASmaxOutGroupsProfilePictureIdMixin","WASmaxOutGroupsProfilePictureQueryMixin","WASmaxOutGroupsProfilePictureTypeMixin","WASmaxOutGroupsSubGroupHintMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.profilePictureIdMixinArgs,n=e.profilePictureTypeMixinArgs,r=e.profilePictureQueryMixinArgs,a=e.parentOrSubGroupMixinGroupArgs,i=o("WASmaxOutGroupsParentOrSubGroupMixinGroup").mergeParentOrSubGroupMixinGroup(o("WASmaxMixins").optionalMerge(o("WASmaxOutGroupsProfilePictureQueryMixin").mergeProfilePictureQueryMixin,o("WASmaxMixins").optionalMerge(o("WASmaxOutGroupsProfilePictureTypeMixin").mergeProfilePictureTypeMixin,o("WASmaxMixins").optionalMerge(o("WASmaxOutGroupsProfilePictureIdMixin").mergeProfilePictureIdMixin,o("WASmaxJsx").smax("picture",null),t),n),r),a);return i}function s(t){var n=t.pictureArgs,r=t.subGroupHintMixinArgs,a=o("WASmaxJsx").smax("smax$any",null,o("WASmaxMixins").optionalMerge(o("WASmaxOutGroupsSubGroupHintMixin").mergeSubGroupHintMixin,o("WASmaxJsx").smax("pictures",null,o("WASmaxChildren").REPEATED_CHILD(e,n,1,1e3)),r));return a}function u(e,t){var n=s(t);return o("WASmaxMixins").mergeStanzas(e,n)}l.makeGetGroupProfilePicturesProfilePicturesRequestPicturesPicture=e,l.mergeGetGroupProfilePicturesProfilePicturesRequestMixin=u}),98);
__d("WASmaxOutGroupsGetGroupProfilePicturesRequest",["WASmaxJsx","WASmaxOutGroupsBaseGetGroupOrServerMixinGroup","WASmaxOutGroupsGetGroupProfilePicturesProfilePicturesRequestMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.baseGetGroupOrServerMixinGroupArgs,n=o("WASmaxOutGroupsBaseGetGroupOrServerMixinGroup").mergeBaseGetGroupOrServerMixinGroup(o("WASmaxOutGroupsGetGroupProfilePicturesProfilePicturesRequestMixin").mergeGetGroupProfilePicturesProfilePicturesRequestMixin(o("WASmaxJsx").smax("iq",null),e),t);return n}l.makeGetGroupProfilePicturesRequest=e}),98);
__d("WASmaxGroupsGetGroupProfilePicturesRPC",["WAComms","WASmaxInGroupsGetGroupProfilePicturesResponseClientError","WASmaxInGroupsGetGroupProfilePicturesResponseServerError","WASmaxInGroupsGetGroupProfilePicturesResponseSuccessGroupPictures","WASmaxOutGroupsGetGroupProfilePicturesRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutGroupsGetGroupProfilePicturesRequest").makeGetGroupProfilePicturesRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInGroupsGetGroupProfilePicturesResponseSuccessGroupPictures").parseGetGroupProfilePicturesResponseSuccessGroupPictures(r,n);if(a.success)return{name:"GetGroupProfilePicturesResponseSuccessGroupPictures",value:a.value};var i=o("WASmaxInGroupsGetGroupProfilePicturesResponseClientError").parseGetGroupProfilePicturesResponseClientError(r,n);if(i.success)return{name:"GetGroupProfilePicturesResponseClientError",value:i.value};var l=o("WASmaxInGroupsGetGroupProfilePicturesResponseServerError").parseGetGroupProfilePicturesResponseServerError(r,n);if(l.success)return{name:"GetGroupProfilePicturesResponseServerError",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("GetGroupProfilePictures",{SuccessGroupPictures:a,ClientError:i,ServerError:l}))}),s.apply(this,arguments)}l.sendGetGroupProfilePicturesRPC=e}),98);
__d("WASmaxInMessagePublishNewsletterSenderRCATAckMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"ack");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"rcat");if(!n.success)return n;var r=o("WASmaxParseUtils").contentBytes(n.value);return r.success?o("WAResultOrError").makeResult({rcatElementValue:r.value}):r}l.parseNewsletterSenderRCATAckMixin=e}),98);
__d("WASmaxInMessagePublishNewsletterMessageAckMixin",["WAResultOrError","WASmaxInMessagePublishAckMixin","WASmaxInMessagePublishNewsletterSenderRCATAckMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"ack");if(!n.success)return n;var r=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,e,"server_id",99,2147476647);if(!r.success)return r;var a=o("WASmaxInMessagePublishAckMixin").parseAckMixin(e,t);if(!a.success)return a;var i=o("WASmaxInMessagePublishNewsletterSenderRCATAckMixin").parseNewsletterSenderRCATAckMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({serverId:r.value},a.value,{newsletterSenderRCATAckMixin:i.success?i.value:null}))}l.parseNewsletterMessageAckMixin=e}),98);
__d("WASmaxInMessagePublishNewsletterQuestionResponseAckMixin",["WAResultOrError","WASmaxInMessagePublishAckMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"ack");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(e,"response_server_id");if(!r.success)return r;var a=o("WASmaxInMessagePublishAckMixin").parseAckMixin(e,t);return a.success?o("WAResultOrError").makeResult(babelHelpers.extends({responseServerId:r.value},a.value)):a}l.parseNewsletterQuestionResponseAckMixin=e}),98);
__d("WASmaxInMessagePublishNewsletterQuestionResponseOrNewsletterMessageAckMixinGroup",["WAResultOrError","WASmaxInMessagePublishNewsletterMessageAckMixin","WASmaxInMessagePublishNewsletterQuestionResponseAckMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxInMessagePublishNewsletterQuestionResponseAckMixin").parseNewsletterQuestionResponseAckMixin(e,t);if(n.success)return o("WAResultOrError").makeResult({name:"NewsletterQuestionResponseAck",value:n.value});var r=o("WASmaxInMessagePublishNewsletterMessageAckMixin").parseNewsletterMessageAckMixin(e,t);return r.success?o("WAResultOrError").makeResult({name:"NewsletterMessageAck",value:r.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["QuestionResponseAck","MessageAck"],[n,r])}l.parseNewsletterQuestionResponseOrNewsletterMessageAckMixinGroup=e}),98);
__d("WASmaxInMessagePublishNewsletterResponseNegative",["WASmaxInMessagePublishNegativeAckMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"ack");if(!n.success)return n;var r=o("WASmaxInMessagePublishNegativeAckMixin").parseNegativeAckMixin(e,t);return r.success,r}l.parseNewsletterResponseNegative=e}),98);
__d("WASmaxInMessagePublishNewsletterResponseSuccess",["WAResultOrError","WASmaxInMessagePublishNewsletterQuestionResponseOrNewsletterMessageAckMixinGroup","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"ack");if(!n.success)return n;var r=o("WASmaxInMessagePublishNewsletterQuestionResponseOrNewsletterMessageAckMixinGroup").parseNewsletterQuestionResponseOrNewsletterMessageAckMixinGroup(e,t);return r.success?o("WAResultOrError").makeResult({newsletterQuestionResponseOrNewsletterMessageAckMixinGroup:r.value}):r}l.parseNewsletterResponseSuccess=e}),98);
__d("WASmaxInNewslettersAdminEditMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"edit","3");return n.success?o("WAResultOrError").makeResult({edit:n.value}):n}l.parseAdminEditMixin=e}),98);
__d("WASmaxInNewslettersAdminProfileMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"admin_profile");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"name");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"picture");if(!r.success)return r;var a=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,e,"id");if(!a.success)return a;var i=o("WASmaxParseUtils").contentString(n.value);if(!i.success)return i;var l=o("WASmaxParseUtils").attrString(r.value,"id");if(!l.success)return l;var s=o("WASmaxParseUtils").attrString(r.value,"direct_path");return s.success?o("WAResultOrError").makeResult({id:a.value,nameElementValue:i.value,pictureId:l.value,pictureDirectPath:s.value}):s}l.parseAdminProfileMixin=e}),98);
__d("WASmaxInNewslettersAdminProfileMetaMixin",["WASmaxInNewslettersAdminProfileMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(n.value,"admin_profile");if(!r.success)return r;var a=o("WASmaxInNewslettersAdminProfileMixin").parseAdminProfileMixin(r.value);return a.success,a}l.parseAdminProfileMetaMixin=e}),98);
__d("WASmaxInNewslettersAdminRevokeMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"edit","8");return n.success?o("WAResultOrError").makeResult({edit:n.value}):n}l.parseAdminRevokeMixin=e}),98);
__d("WASmaxInNewslettersIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","bad-request");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",400);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorBadRequestMixin=e}),98);
__d("WASmaxInNewslettersIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","error");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQErrorResponseMixin=e}),98);
__d("WASmaxInNewslettersBadRequestIQErrorResponseMixin",["WAResultOrError","WASmaxInNewslettersIQErrorBadRequestMixin","WASmaxInNewslettersIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInNewslettersIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(r.value);if(!a.success)return a;var i=o("WASmaxInNewslettersIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({errorIQErrorBadRequestMixin:a.value},i.value)):i}l.parseBadRequestIQErrorResponseMixin=e}),98);
__d("WASmaxInNewslettersIQErrorRateOverlimitMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","rate-overlimit");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",429);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorRateOverlimitMixin=e}),98);
__d("WASmaxInNewslettersRateLimitedIQErrorResponseMixin",["WAResultOrError","WASmaxInNewslettersIQErrorRateOverlimitMixin","WASmaxInNewslettersIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInNewslettersIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(r.value);if(!a.success)return a;var i=o("WASmaxInNewslettersIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({errorIQErrorRateOverlimitMixin:a.value},i.value)):i}l.parseRateLimitedIQErrorResponseMixin=e}),98);
__d("WASmaxInNewslettersBadRequestOrRateLimitedIQErrorResponseMixinGroup",["WAResultOrError","WASmaxInNewslettersBadRequestIQErrorResponseMixin","WASmaxInNewslettersRateLimitedIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxInNewslettersBadRequestIQErrorResponseMixin").parseBadRequestIQErrorResponseMixin(e,t);if(n.success)return o("WAResultOrError").makeResult({name:"BadRequestIQErrorResponse",value:n.value});var r=o("WASmaxInNewslettersRateLimitedIQErrorResponseMixin").parseRateLimitedIQErrorResponseMixin(e,t);return r.success?o("WAResultOrError").makeResult({name:"RateLimitedIQErrorResponse",value:r.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["BadRequestIQErrorResponse","RateLimitedIQErrorResponse"],[n,r])}l.parseBadRequestOrRateLimitedIQErrorResponseMixinGroup=e}),98);
__d("WASmaxInNewslettersNewsletterCreationTimeMetadataMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"metadata");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"creation_time");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(n.value,"value",0,void 0);return r.success?o("WAResultOrError").makeResult({creationTimeValue:r.value}):r}l.parseNewsletterCreationTimeMetadataMixin=e}),98);
__d("WASmaxInNewslettersQueryDescriptionResponseMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"description");if(!t.success)return t;var n=o("WASmaxParseUtils").attrString(e,"id");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(e,"update_time",0,void 0);if(!r.success)return r;var a=o("WASmaxParseUtils").contentString(e);return a.success?o("WAResultOrError").makeResult({id:n.value,updateTime:r.value,elementValue:a.value}):a}l.parseQueryDescriptionResponseMixin=e}),98);
__d("WASmaxInNewslettersNewsletterDescriptionMetadataMixin",["WAResultOrError","WASmaxInNewslettersQueryDescriptionResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"metadata");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"description");if(!n.success)return n;var r=o("WASmaxInNewslettersQueryDescriptionResponseMixin").parseQueryDescriptionResponseMixin(n.value);return o("WAResultOrError").makeResult({descriptionQueryDescriptionResponseMixin:r.success?r.value:null})}l.parseNewsletterDescriptionMetadataMixin=e}),98);
__d("WASmaxInNewslettersNewsletterInviteLinkMetadataMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"metadata");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"invite");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(n.value,"code");return r.success?o("WAResultOrError").makeResult({inviteCode:r.value}):r}l.parseNewsletterInviteLinkMetadataMixin=e}),98);
__d("WASmaxInNewslettersNewsletterLinkedAccountsMetadataMixin",["WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"metadata");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"linked_accounts");return n.success?o("WASmaxParseUtils").voidSuccess:n}l.parseNewsletterLinkedAccountsMetadataMixin=e}),98);
__d("WASmaxInNewslettersEnums",[],(function(t,n,r,o,a,i){var e={"1p_sticker":"1p_sticker",audio:"audio",avatar_sticker:"avatar_sticker",cataloglink:"cataloglink",collection:"collection",document:"document",genai_sticker:"genai_sticker",gif:"gif",image:"image",motion_photo:"motion_photo",motion_video:"motion_video",productlink:"productlink",ptt:"ptt",ptv:"ptv",sticker:"sticker",sticker_pack:"sticker_pack",url:"url",user_created_sticker:"user_created_sticker",vcard:"vcard",video:"video"},l={active:"active",geosuspended:"geosuspended",suspended:"suspended"},s={admin:"admin",guest:"guest",owner:"owner",subscriber:"subscriber"},u={all:"all",basic:"basic",none:"none"},c={hd_image_dual_upload:"hd_image_dual_upload",hd_video_dual_upload:"hd_video_dual_upload",hevc_video_dual_upload:"hevc_video_dual_upload",media_poll:"media_poll",motion_photo:"motion_photo",sticker_annotation:"sticker_annotation"},d={image:"image",preview:"preview"},m={off:"off",on:"on",undefined:"undefined"},p={private:"private",public:"public"},_={unverified:"unverified",verified:"verified"};i.ENUM_1PSTICKER_AUDIO_AVATARSTICKER_CATALOGLINK_COLLECTION_DOCUMENT_GENAISTICKER_GIF_IMAGE_MOTIONPHOTO_MOTIONVIDEO_PRODUCTLINK_PTT_PTV_STICKER_STICKERPACK_URL_USERCREATEDSTICKER_VCARD_VIDEO=e,i.ENUM_ACTIVE_GEOSUSPENDED_SUSPENDED=l,i.ENUM_ADMIN_GUEST_OWNER_SUBSCRIBER=s,i.ENUM_ALL_BASIC_NONE=u,i.ENUM_HDIMAGEDUALUPLOAD_HDVIDEODUALUPLOAD_HEVCVIDEODUALUPLOAD_MEDIAPOLL_MOTIONPHOTO_STICKERANNOTATION=c,i.ENUM_IMAGE_PREVIEW=d,i.ENUM_OFF_ON_UNDEFINED=m,i.ENUM_PRIVATE_PUBLIC=p,i.ENUM_UNVERIFIED_VERIFIED=_}),66);
__d("WASmaxInNewslettersNewsletterMembershipMetadataMixin",["WAResultOrError","WASmaxInNewslettersEnums","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"metadata");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"membership");if(!n.success)return n;var r=o("WASmaxParseUtils").attrStringEnum(n.value,"type",o("WASmaxInNewslettersEnums").ENUM_ADMIN_GUEST_OWNER_SUBSCRIBER);return r.success?o("WAResultOrError").makeResult({membershipType:r.value}):r}l.parseNewsletterMembershipMetadataMixin=e}),98);
__d("WASmaxInNewslettersNewsletterMutedMetadataMixin",["WAResultOrError","WASmaxInNewslettersEnums","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"metadata");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"muted");if(!n.success)return n;var r=o("WASmaxParseUtils").attrStringEnum(n.value,"state",o("WASmaxInNewslettersEnums").ENUM_OFF_ON_UNDEFINED);return r.success?o("WAResultOrError").makeResult({mutedState:r.value}):r}l.parseNewsletterMutedMetadataMixin=e}),98);
__d("WASmaxInNewslettersNewsletterNameMetadataMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"metadata");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"name");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(n.value,"id");if(!r.success)return r;var a=o("WASmaxParseUtils").attrIntRange(n.value,"update_time",0,void 0);if(!a.success)return a;var i=o("WASmaxParseUtils").contentString(n.value);return i.success?o("WAResultOrError").makeResult({nameId:r.value,nameUpdateTime:a.value,nameElementValue:i.value}):i}l.parseNewsletterNameMetadataMixin=e}),98);
__d("WASmaxInNewslettersQueryPictureDirectPathResponseMixin",["WAResultOrError","WASmaxInNewslettersEnums","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"picture");if(!t.success)return t;var n=o("WASmaxParseUtils").attrString(e,"id");if(!n.success)return n;var r=o("WASmaxParseUtils").attrStringEnum(e,"type",o("WASmaxInNewslettersEnums").ENUM_IMAGE_PREVIEW);if(!r.success)return r;var a=o("WASmaxParseUtils").attrString(e,"direct_path");return a.success?o("WAResultOrError").makeResult({id:n.value,type:r.value,directPath:a.value}):a}l.parseQueryPictureDirectPathResponseMixin=e}),98);
__d("WASmaxInNewslettersQueryPictureEmptyResponseMixin",["WAResultOrError","WASmaxInNewslettersEnums","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"picture");if(!t.success)return t;var n=o("WASmaxParseUtils").attrStringEnum(e,"type",o("WASmaxInNewslettersEnums").ENUM_IMAGE_PREVIEW);return n.success?o("WAResultOrError").makeResult({type:n.value}):n}l.parseQueryPictureEmptyResponseMixin=e}),98);
__d("WASmaxInNewslettersQueryPictureDirectPathOrEmptyResponseMixinGroup",["WAResultOrError","WASmaxInNewslettersQueryPictureDirectPathResponseMixin","WASmaxInNewslettersQueryPictureEmptyResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInNewslettersQueryPictureDirectPathResponseMixin").parseQueryPictureDirectPathResponseMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"QueryPictureDirectPathResponse",value:t.value});var n=o("WASmaxInNewslettersQueryPictureEmptyResponseMixin").parseQueryPictureEmptyResponseMixin(e);return n.success?o("WAResultOrError").makeResult({name:"QueryPictureEmptyResponse",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["QueryPictureDirectPathResponse","QueryPictureEmptyResponse"],[t,n])}l.parseQueryPictureDirectPathOrEmptyResponseMixinGroup=e}),98);
__d("WASmaxInNewslettersNewsletterPictureMetadataMixin",["WAResultOrError","WASmaxInNewslettersQueryPictureDirectPathOrEmptyResponseMixinGroup","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"picture");if(!t.success)return t;var n=o("WASmaxInNewslettersQueryPictureDirectPathOrEmptyResponseMixinGroup").parseQueryPictureDirectPathOrEmptyResponseMixinGroup(e);return n.success?o("WAResultOrError").makeResult({queryPictureDirectPathOrEmptyResponseMixinGroup:n.value}):n}function s(t){var n=o("WASmaxParseUtils").assertTag(t,"metadata");if(!n.success)return n;var r=o("WASmaxParseUtils").mapChildrenWithTag(t,"picture",0,2,e);return r.success?o("WAResultOrError").makeResult({picture:r.value}):r}l.parseNewsletterPictureMetadataPicture=e,l.parseNewsletterPictureMetadataMixin=s}),98);
__d("WASmaxInNewslettersNewsletterPrivacyMetadataMixin",["WAResultOrError","WASmaxInNewslettersEnums","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"metadata");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"privacy");if(!n.success)return n;var r=o("WASmaxParseUtils").attrStringEnum(n.value,"type",o("WASmaxInNewslettersEnums").ENUM_PRIVATE_PUBLIC);return r.success?o("WAResultOrError").makeResult({privacyType:r.value}):r}l.parseNewsletterPrivacyMetadataMixin=e}),98);
__d("WASmaxInNewslettersNewsletterStateMetadataMixin",["WAResultOrError","WASmaxInNewslettersEnums","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"metadata");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"state");if(!n.success)return n;var r=o("WASmaxParseUtils").attrStringEnum(n.value,"type",o("WASmaxInNewslettersEnums").ENUM_ACTIVE_GEOSUSPENDED_SUSPENDED);return r.success?o("WAResultOrError").makeResult({stateType:r.value}):r}l.parseNewsletterStateMetadataMixin=e}),98);
__d("WASmaxInNewslettersNewsletterSubscribersMetadataMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"metadata");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"subscribers");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(n.value,"count",0,void 0);return r.success?o("WAResultOrError").makeResult({subscribersCount:r.value}):r}l.parseNewsletterSubscribersMetadataMixin=e}),98);
__d("WASmaxInNewslettersNewsletterVerificationMetadataMixin",["WAResultOrError","WASmaxInNewslettersEnums","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"metadata");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"verification");if(!n.success)return n;var r=o("WASmaxParseUtils").attrStringEnum(n.value,"state",o("WASmaxInNewslettersEnums").ENUM_UNVERIFIED_VERIFIED);return r.success?o("WAResultOrError").makeResult({verificationState:r.value}):r}l.parseNewsletterVerificationMetadataMixin=e}),98);
__d("WASmaxInNewslettersCommonNewsletterMetadataMixin",["WAResultOrError","WASmaxInNewslettersNewsletterCreationTimeMetadataMixin","WASmaxInNewslettersNewsletterDescriptionMetadataMixin","WASmaxInNewslettersNewsletterInviteLinkMetadataMixin","WASmaxInNewslettersNewsletterLinkedAccountsMetadataMixin","WASmaxInNewslettersNewsletterMembershipMetadataMixin","WASmaxInNewslettersNewsletterMutedMetadataMixin","WASmaxInNewslettersNewsletterNameMetadataMixin","WASmaxInNewslettersNewsletterPictureMetadataMixin","WASmaxInNewslettersNewsletterPrivacyMetadataMixin","WASmaxInNewslettersNewsletterStateMetadataMixin","WASmaxInNewslettersNewsletterSubscribersMetadataMixin","WASmaxInNewslettersNewsletterVerificationMetadataMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"metadata");if(!t.success)return t;var n=o("WASmaxInNewslettersNewsletterCreationTimeMetadataMixin").parseNewsletterCreationTimeMetadataMixin(e),r=o("WASmaxInNewslettersNewsletterNameMetadataMixin").parseNewsletterNameMetadataMixin(e),a=o("WASmaxInNewslettersNewsletterPictureMetadataMixin").parseNewsletterPictureMetadataMixin(e),i=o("WASmaxInNewslettersNewsletterDescriptionMetadataMixin").parseNewsletterDescriptionMetadataMixin(e),l=o("WASmaxInNewslettersNewsletterInviteLinkMetadataMixin").parseNewsletterInviteLinkMetadataMixin(e),s=o("WASmaxInNewslettersNewsletterSubscribersMetadataMixin").parseNewsletterSubscribersMetadataMixin(e),u=o("WASmaxInNewslettersNewsletterPrivacyMetadataMixin").parseNewsletterPrivacyMetadataMixin(e),c=o("WASmaxInNewslettersNewsletterVerificationMetadataMixin").parseNewsletterVerificationMetadataMixin(e),d=o("WASmaxInNewslettersNewsletterLinkedAccountsMetadataMixin").parseNewsletterLinkedAccountsMetadataMixin(e),m=o("WASmaxInNewslettersNewsletterMembershipMetadataMixin").parseNewsletterMembershipMetadataMixin(e),p=o("WASmaxInNewslettersNewsletterMutedMetadataMixin").parseNewsletterMutedMetadataMixin(e),_=o("WASmaxInNewslettersNewsletterStateMetadataMixin").parseNewsletterStateMetadataMixin(e);return o("WAResultOrError").makeResult({newsletterCreationTimeMetadataMixin:n.success?n.value:null,newsletterNameMetadataMixin:r.success?r.value:null,newsletterPictureMetadataMixin:a.success?a.value:null,newsletterDescriptionMetadataMixin:i.success?i.value:null,newsletterInviteLinkMetadataMixin:l.success?l.value:null,newsletterSubscribersMetadataMixin:s.success?s.value:null,newsletterPrivacyMetadataMixin:u.success?u.value:null,newsletterVerificationMetadataMixin:c.success?c.value:null,hasNewsletterLinkedAccountsMetadataMixin:d.success,newsletterMembershipMetadataMixin:m.success?m.value:null,newsletterMutedMetadataMixin:p.success?p.value:null,newsletterStateMetadataMixin:_.success?_.value:null})}l.parseCommonNewsletterMetadataMixin=e}),98);
__d("WASmaxInNewslettersContentTypeMediaMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","media");return n.success?o("WAResultOrError").makeResult({type:n.value}):n}l.parseContentTypeMediaMixin=e}),98);
__d("WASmaxInNewslettersContentTypePollCreationMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","poll");if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"polltype","creation");if(!a.success)return a;var i=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,n.value,"contenttype");return i.success?o("WAResultOrError").makeResult({type:r.value,metaPolltype:a.value,metaContenttype:i.value}):i}l.parseContentTypePollCreationMixin=e}),98);
__d("WASmaxInNewslettersContentTypePollResultSnapshotMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","poll");if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"polltype","result_snapshot");return a.success?o("WAResultOrError").makeResult({type:r.value,metaPolltype:a.value}):a}l.parseContentTypePollResultSnapshotMixin=e}),98);
__d("WASmaxInNewslettersContentTypeQuizCreationMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","poll");if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"polltype","quiz_creation");if(!a.success)return a;var i=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,n.value,"contenttype");return i.success?o("WAResultOrError").makeResult({type:r.value,metaPolltype:a.value,metaContenttype:i.value}):i}l.parseContentTypeQuizCreationMixin=e}),98);
__d("WASmaxInNewslettersContentTypeTextMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","text");return n.success?o("WAResultOrError").makeResult({type:n.value}):n}l.parseContentTypeTextMixin=e}),98);
__d("WASmaxInNewslettersContentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup",["WAResultOrError","WASmaxInNewslettersContentTypeMediaMixin","WASmaxInNewslettersContentTypePollCreationMixin","WASmaxInNewslettersContentTypeQuizCreationMixin","WASmaxInNewslettersContentTypeTextMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInNewslettersContentTypeTextMixin").parseContentTypeTextMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"ContentTypeText",value:t.value});var n=o("WASmaxInNewslettersContentTypeMediaMixin").parseContentTypeMediaMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"ContentTypeMedia",value:n.value});var r=o("WASmaxInNewslettersContentTypePollCreationMixin").parseContentTypePollCreationMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"ContentTypePollCreation",value:r.value});var a=o("WASmaxInNewslettersContentTypeQuizCreationMixin").parseContentTypeQuizCreationMixin(e);return a.success?o("WAResultOrError").makeResult({name:"ContentTypeQuizCreation",value:a.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["ContentTypeText","ContentTypeMedia","ContentTypePollCreation","ContentTypeQuizCreation"],[t,n,r,a])}l.parseContentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup=e}),98);
__d("WASmaxInNewslettersCreateResponseClientError",["WAResultOrError","WASmaxInNewslettersBadRequestOrRateLimitedIQErrorResponseMixinGroup","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInNewslettersBadRequestOrRateLimitedIQErrorResponseMixinGroup").parseBadRequestOrRateLimitedIQErrorResponseMixinGroup(e,t);return r.success?o("WAResultOrError").makeResult({badRequestOrRateLimitedIQErrorResponseMixinGroup:r.value}):r}l.parseCreateResponseClientError=e}),98);
__d("WASmaxInNewslettersIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","internal-server-error");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",500);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorInternalServerErrorMixin=e}),98);
__d("WASmaxInNewslettersInternalServerErrorIQErrorResponseMixin",["WAResultOrError","WASmaxInNewslettersIQErrorInternalServerErrorMixin","WASmaxInNewslettersIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInNewslettersIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(r.value);if(!a.success)return a;var i=o("WASmaxInNewslettersIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({errorIQErrorInternalServerErrorMixin:a.value},i.value)):i}l.parseInternalServerErrorIQErrorResponseMixin=e}),98);
__d("WASmaxInNewslettersCreateResponseServerError",["WASmaxInNewslettersInternalServerErrorIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInNewslettersInternalServerErrorIQErrorResponseMixin").parseInternalServerErrorIQErrorResponseMixin(e,t);return r.success,r}l.parseCreateResponseServerError=e}),98);
__d("WASmaxInNewslettersIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQResultResponseMixin=e}),98);
__d("WASmaxInNewslettersNewsletterIDMetadataMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"metadata");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"id");if(!n.success)return n;var r=o("WASmaxParseJid").attrNewsletterJid(n.value,"jid");return r.success?o("WAResultOrError").makeResult({idJid:r.value}):r}l.parseNewsletterIDMetadataMixin=e}),98);
__d("WASmaxInNewslettersNewsletterMetadataIQResponsePayloadMixin",["WAResultOrError","WASmaxInNewslettersCommonNewsletterMetadataMixin","WASmaxInNewslettersNewsletterIDMetadataMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"metadata");if(!t.success)return t;var n=o("WASmaxInNewslettersNewsletterIDMetadataMixin").parseNewsletterIDMetadataMixin(e);if(!n.success)return n;var r=o("WASmaxInNewslettersCommonNewsletterMetadataMixin").parseCommonNewsletterMetadataMixin(e);return r.success?o("WAResultOrError").makeResult(babelHelpers.extends({},n.value,r.value)):r}l.parseNewsletterMetadataIQResponsePayloadMixin=e}),98);
__d("WASmaxInNewslettersNewsletterWithMetadataIQResponsePayloadMixin",["WASmaxInNewslettersNewsletterMetadataIQResponsePayloadMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"newsletter");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"metadata");if(!n.success)return n;var r=o("WASmaxInNewslettersNewsletterMetadataIQResponsePayloadMixin").parseNewsletterMetadataIQResponsePayloadMixin(n.value);return r.success,r}l.parseNewsletterWithMetadataIQResponsePayloadMixin=e}),98);
__d("WASmaxInNewslettersCreateResponseSuccess",["WAResultOrError","WASmaxInNewslettersIQResultResponseMixin","WASmaxInNewslettersNewsletterWithMetadataIQResponsePayloadMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"newsletter");if(!r.success)return r;var a=o("WASmaxInNewslettersNewsletterWithMetadataIQResponsePayloadMixin").parseNewsletterWithMetadataIQResponsePayloadMixin(r.value);if(!a.success)return a;var i=o("WASmaxInNewslettersIQResultResponseMixin").parseIQResultResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({newsletterNewsletterWithMetadataIQResponsePayloadMixin:a.value},i.value)):i}l.parseCreateResponseSuccess=e}),98);
__d("WASmaxInNewslettersIQErrorItemNotFoundMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","item-not-found");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",404);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorItemNotFoundMixin=e}),98);
__d("WASmaxInNewslettersItemNotFoundIQErrorResponseMixin",["WAResultOrError","WASmaxInNewslettersIQErrorItemNotFoundMixin","WASmaxInNewslettersIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInNewslettersIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(r.value);if(!a.success)return a;var i=o("WASmaxInNewslettersIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({errorIQErrorItemNotFoundMixin:a.value},i.value)):i}l.parseItemNotFoundIQErrorResponseMixin=e}),98);
__d("WASmaxInNewslettersIQErrorLockedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","locked");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",423);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorLockedMixin=e}),98);
__d("WASmaxInNewslettersSuspendedIQErrorResponseMixin",["WAResultOrError","WASmaxInNewslettersIQErrorLockedMixin","WASmaxInNewslettersIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInNewslettersIQErrorLockedMixin").parseIQErrorLockedMixin(r.value);if(!a.success)return a;var i=o("WASmaxInNewslettersIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({errorIQErrorLockedMixin:a.value},i.value)):i}l.parseSuspendedIQErrorResponseMixin=e}),98);
__d("WASmaxInNewslettersIQErrorUnavailableForLegalReasonsGenericMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","features-disabled");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",451);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorUnavailableForLegalReasonsGenericMixin=e}),98);
__d("WASmaxInNewslettersUnavailableForLegalReasonsResponseMixin",["WAResultOrError","WASmaxInNewslettersIQErrorResponseMixin","WASmaxInNewslettersIQErrorUnavailableForLegalReasonsGenericMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInNewslettersIQErrorUnavailableForLegalReasonsGenericMixin").parseIQErrorUnavailableForLegalReasonsGenericMixin(r.value);if(!a.success)return a;var i=o("WASmaxInNewslettersIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({errorIQErrorUnavailableForLegalReasonsGenericMixin:a.value},i.value)):i}l.parseUnavailableForLegalReasonsResponseMixin=e}),98);
__d("WASmaxInNewslettersGetNewsletterMessageUpdatesClientErrors",["WAResultOrError","WASmaxInNewslettersBadRequestIQErrorResponseMixin","WASmaxInNewslettersItemNotFoundIQErrorResponseMixin","WASmaxInNewslettersRateLimitedIQErrorResponseMixin","WASmaxInNewslettersSuspendedIQErrorResponseMixin","WASmaxInNewslettersUnavailableForLegalReasonsResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxInNewslettersBadRequestIQErrorResponseMixin").parseBadRequestIQErrorResponseMixin(e,t);if(n.success)return o("WAResultOrError").makeResult({name:"BadRequestIQErrorResponse",value:n.value});var r=o("WASmaxInNewslettersUnavailableForLegalReasonsResponseMixin").parseUnavailableForLegalReasonsResponseMixin(e,t);if(r.success)return o("WAResultOrError").makeResult({name:"UnavailableForLegalReasonsResponse",value:r.value});var a=o("WASmaxInNewslettersItemNotFoundIQErrorResponseMixin").parseItemNotFoundIQErrorResponseMixin(e,t);if(a.success)return o("WAResultOrError").makeResult({name:"ItemNotFoundIQErrorResponse",value:a.value});var i=o("WASmaxInNewslettersSuspendedIQErrorResponseMixin").parseSuspendedIQErrorResponseMixin(e,t);if(i.success)return o("WAResultOrError").makeResult({name:"SuspendedIQErrorResponse",value:i.value});var l=o("WASmaxInNewslettersRateLimitedIQErrorResponseMixin").parseRateLimitedIQErrorResponseMixin(e,t);return l.success?o("WAResultOrError").makeResult({name:"RateLimitedIQErrorResponse",value:l.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["BadRequestIQErrorResponse","UnavailableForLegalReasonsResponse","ItemNotFoundIQErrorResponse","SuspendedIQErrorResponse","RateLimitedIQErrorResponse"],[n,r,a,i,l])}l.parseGetNewsletterMessageUpdatesClientErrors=e}),98);
__d("WASmaxInNewslettersGetNewsletterMessageUpdatesResponseClientError",["WAResultOrError","WASmaxInNewslettersGetNewsletterMessageUpdatesClientErrors","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInNewslettersGetNewsletterMessageUpdatesClientErrors").parseGetNewsletterMessageUpdatesClientErrors(e,t);return r.success?o("WAResultOrError").makeResult({getNewsletterMessageUpdatesClientErrors:r.value}):r}l.parseGetNewsletterMessageUpdatesResponseClientError=e}),98);
__d("WASmaxInNewslettersGetNewsletterMessageUpdatesResponseServerError",["WASmaxInNewslettersInternalServerErrorIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInNewslettersInternalServerErrorIQErrorResponseMixin").parseInternalServerErrorIQErrorResponseMixin(e,t);return r.success,r}l.parseGetNewsletterMessageUpdatesResponseServerError=e}),98);
__d("WASmaxInNewslettersNewsletterForwardsCountMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"forwards_count");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(n.value,"count",0,void 0);return r.success?o("WAResultOrError").makeResult({forwardsCountCount:r.value}):r}l.parseNewsletterForwardsCountMixin=e}),98);
__d("WASmaxInNewslettersMediaMetaMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,n.value,"contenttype");return r.success?o("WAResultOrError").makeResult({metaContenttype:r.value}):r}l.parseMediaMetaMixin=e}),98);
__d("WASmaxInNewslettersMessageAssociationTypeMixin",["WAResultOrError","WASmaxInNewslettersEnums","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").attrStringEnum(n.value,"message_association_type",o("WASmaxInNewslettersEnums").ENUM_HDIMAGEDUALUPLOAD_HDVIDEODUALUPLOAD_HEVCVIDEODUALUPLOAD_MEDIAPOLL_MOTIONPHOTO_STICKERANNOTATION);return r.success?o("WAResultOrError").makeResult({metaMessageAssociationType:r.value}):r}l.parseMessageAssociationTypeMixin=e}),98);
__d("WASmaxInNewslettersPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"plaintext");if(!t.success)return t;var n=o("WASmaxParseUtils").contentBytesRange(e,1,1048576);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}l.parsePayloadMixin=e}),98);
__d("WASmaxInNewslettersWAMOSubMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"is_wamo_sub","true");return r.success?o("WAResultOrError").makeResult({metaIsWamoSub:r.value}):r}l.parseWAMOSubMixin=e}),98);
__d("WASmaxInNewslettersNewsletterMediaMixin",["WAResultOrError","WASmaxInNewslettersContentTypeMediaMixin","WASmaxInNewslettersEnums","WASmaxInNewslettersMediaMetaMixin","WASmaxInNewslettersMessageAssociationTypeMixin","WASmaxInNewslettersPayloadMixin","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxParseUtils").attrStringEnum(n.value,"mediatype",o("WASmaxInNewslettersEnums").ENUM_1PSTICKER_AUDIO_AVATARSTICKER_CATALOGLINK_COLLECTION_DOCUMENT_GENAISTICKER_GIF_IMAGE_MOTIONPHOTO_MOTIONVIDEO_PRODUCTLINK_PTT_PTV_STICKER_STICKERPACK_URL_USERCREATEDSTICKER_VCARD_VIDEO);if(!r.success)return r;var a=o("WASmaxInNewslettersPayloadMixin").parsePayloadMixin(n.value);if(!a.success)return a;var i=o("WASmaxInNewslettersContentTypeMediaMixin").parseContentTypeMediaMixin(e);if(!i.success)return i;var l=o("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(e),s=o("WASmaxInNewslettersMessageAssociationTypeMixin").parseMessageAssociationTypeMixin(e),u=o("WASmaxInNewslettersMediaMetaMixin").parseMediaMetaMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({plaintextMediatype:r.value,plaintextPayloadMixin:a.value},i.value,{wAMOSubMixin:l.success?l.value:null,messageAssociationTypeMixin:s.success?s.value:null,mediaMetaMixin:u.success?u.value:null}))}l.parseNewsletterMediaMixin=e}),98);
__d("WASmaxInNewslettersNewsletterTextMixin",["WAResultOrError","WASmaxInNewslettersContentTypeTextMixin","WASmaxInNewslettersPayloadMixin","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInNewslettersPayloadMixin").parsePayloadMixin(n.value);if(!r.success)return r;var a=o("WASmaxInNewslettersContentTypeTextMixin").parseContentTypeTextMixin(e);if(!a.success)return a;var i=o("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({plaintextPayloadMixin:r.value},a.value,{wAMOSubMixin:i.success?i.value:null}))}l.parseNewsletterTextMixin=e}),98);
__d("WASmaxInNewslettersNewsletterTextOrMediaMixinGroup",["WAResultOrError","WASmaxInNewslettersNewsletterMediaMixin","WASmaxInNewslettersNewsletterTextMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInNewslettersNewsletterTextMixin").parseNewsletterTextMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"NewsletterText",value:t.value});var n=o("WASmaxInNewslettersNewsletterMediaMixin").parseNewsletterMediaMixin(e);return n.success?o("WAResultOrError").makeResult({name:"NewsletterMedia",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["NewsletterText","NewsletterMedia"],[t,n])}l.parseNewsletterTextOrMediaMixinGroup=e}),98);
__d("WASmaxInNewslettersQuestionTypeReplyMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"questiontype","reply");return r.success?o("WAResultOrError").makeResult({metaQuestiontype:r.value}):r}l.parseQuestionTypeReplyMixin=e}),98);
__d("WASmaxInNewslettersNewsletterQuestionReplyMixin",["WAResultOrError","WASmaxInNewslettersNewsletterTextOrMediaMixinGroup","WASmaxInNewslettersQuestionTypeReplyMixin","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxInNewslettersQuestionTypeReplyMixin").parseQuestionTypeReplyMixin(e);if(!n.success)return n;var r=o("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(e),a=o("WASmaxInNewslettersNewsletterTextOrMediaMixinGroup").parseNewsletterTextOrMediaMixinGroup(e);return a.success?o("WAResultOrError").makeResult(babelHelpers.extends({},n.value,{wAMOSubMixin:r.success?r.value:null,newsletterTextOrMediaMixinGroup:a.value})):a}l.parseNewsletterQuestionReplyMixin=e}),98);
__d("WASmaxInNewslettersNewsletterQuestionReplyOrTextOrMediaMixinGroup",["WAResultOrError","WASmaxInNewslettersNewsletterMediaMixin","WASmaxInNewslettersNewsletterQuestionReplyMixin","WASmaxInNewslettersNewsletterTextMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInNewslettersNewsletterQuestionReplyMixin").parseNewsletterQuestionReplyMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"NewsletterQuestionReply",value:t.value});var n=o("WASmaxInNewslettersNewsletterTextMixin").parseNewsletterTextMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"NewsletterText",value:n.value});var r=o("WASmaxInNewslettersNewsletterMediaMixin").parseNewsletterMediaMixin(e);return r.success?o("WAResultOrError").makeResult({name:"NewsletterMedia",value:r.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["NewsletterQuestionReply","NewsletterText","NewsletterMedia"],[t,n,r])}l.parseNewsletterQuestionReplyOrTextOrMediaMixinGroup=e}),98);
__d("WASmaxInNewslettersNewsletterEditMixin",["WAResultOrError","WASmaxInNewslettersAdminEditMixin","WASmaxInNewslettersNewsletterQuestionReplyOrTextOrMediaMixinGroup","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxInNewslettersAdminEditMixin").parseAdminEditMixin(e);if(!n.success)return n;var r=o("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(e),a=o("WASmaxInNewslettersNewsletterQuestionReplyOrTextOrMediaMixinGroup").parseNewsletterQuestionReplyOrTextOrMediaMixinGroup(e);return a.success?o("WAResultOrError").makeResult(babelHelpers.extends({},n.value,{wAMOSubMixin:r.success?r.value:null,newsletterQuestionReplyOrTextOrMediaMixinGroup:a.value})):a}l.parseNewsletterEditMixin=e}),98);
__d("WASmaxInNewslettersNewsletterPollCreationMixin",["WAResultOrError","WASmaxInNewslettersContentTypePollCreationMixin","WASmaxInNewslettersPayloadMixin","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInNewslettersPayloadMixin").parsePayloadMixin(n.value);if(!r.success)return r;var a=o("WASmaxInNewslettersContentTypePollCreationMixin").parseContentTypePollCreationMixin(e);if(!a.success)return a;var i=o("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({plaintextPayloadMixin:r.value},a.value,{wAMOSubMixin:i.success?i.value:null}))}l.parseNewsletterPollCreationMixin=e}),98);
__d("WASmaxInNewslettersNewsletterPollResultSnapshotMixin",["WAResultOrError","WASmaxInNewslettersContentTypePollResultSnapshotMixin","WASmaxInNewslettersPayloadMixin","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInNewslettersPayloadMixin").parsePayloadMixin(n.value);if(!r.success)return r;var a=o("WASmaxInNewslettersContentTypePollResultSnapshotMixin").parseContentTypePollResultSnapshotMixin(e);if(!a.success)return a;var i=o("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({plaintextPayloadMixin:r.value},a.value,{wAMOSubMixin:i.success?i.value:null}))}l.parseNewsletterPollResultSnapshotMixin=e}),98);
__d("WASmaxInNewslettersQuestionTypeQuestionMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"questiontype","question");return r.success?o("WAResultOrError").makeResult({metaQuestiontype:r.value}):r}l.parseQuestionTypeQuestionMixin=e}),98);
__d("WASmaxInNewslettersNewsletterQuestionMixin",["WAResultOrError","WASmaxInNewslettersNewsletterTextOrMediaMixinGroup","WASmaxInNewslettersQuestionTypeQuestionMixin","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxInNewslettersQuestionTypeQuestionMixin").parseQuestionTypeQuestionMixin(e);if(!n.success)return n;var r=o("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(e),a=o("WASmaxInNewslettersNewsletterTextOrMediaMixinGroup").parseNewsletterTextOrMediaMixinGroup(e);return a.success?o("WAResultOrError").makeResult(babelHelpers.extends({},n.value,{wAMOSubMixin:r.success?r.value:null,newsletterTextOrMediaMixinGroup:a.value})):a}l.parseNewsletterQuestionMixin=e}),98);
__d("WASmaxInNewslettersNewsletterQuizCreationMixin",["WAResultOrError","WASmaxInNewslettersContentTypeQuizCreationMixin","WASmaxInNewslettersPayloadMixin","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInNewslettersPayloadMixin").parsePayloadMixin(n.value);if(!r.success)return r;var a=o("WASmaxInNewslettersContentTypeQuizCreationMixin").parseContentTypeQuizCreationMixin(e);if(!a.success)return a;var i=o("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({plaintextPayloadMixin:r.value},a.value,{wAMOSubMixin:i.success?i.value:null}))}l.parseNewsletterQuizCreationMixin=e}),98);
__d("WASmaxInNewslettersNewsletterRevokeMixin",["WAResultOrError","WASmaxInNewslettersAdminRevokeMixin","WASmaxInNewslettersContentTypeTextMixin","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInNewslettersAdminRevokeMixin").parseAdminRevokeMixin(e);if(!r.success)return r;var a=o("WASmaxInNewslettersContentTypeTextMixin").parseContentTypeTextMixin(e);if(!a.success)return a;var i=o("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({},r.value,a.value,{wAMOSubMixin:i.success?i.value:null}))}l.parseNewsletterRevokeMixin=e}),98);
__d("WASmaxInNewslettersNewsletterWAMOEmptyMixin",["WAResultOrError","WASmaxInNewslettersAdminEditMixin","WASmaxInNewslettersAdminRevokeMixin","WASmaxInNewslettersContentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(e);if(!r.success)return r;var a=o("WASmaxInNewslettersAdminRevokeMixin").parseAdminRevokeMixin(e),i=o("WASmaxInNewslettersAdminEditMixin").parseAdminEditMixin(e),l=o("WASmaxInNewslettersContentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup").parseContentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup(e);return l.success?o("WAResultOrError").makeResult(babelHelpers.extends({},r.value,{adminRevokeMixin:a.success?a.value:null,adminEditMixin:i.success?i.value:null,contentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup:l.value})):l}l.parseNewsletterWAMOEmptyMixin=e}),98);
__d("WASmaxInNewslettersNewsletterMessageHistoryContent",["WAResultOrError","WASmaxInNewslettersNewsletterEditMixin","WASmaxInNewslettersNewsletterMediaMixin","WASmaxInNewslettersNewsletterPollCreationMixin","WASmaxInNewslettersNewsletterPollResultSnapshotMixin","WASmaxInNewslettersNewsletterQuestionMixin","WASmaxInNewslettersNewsletterQuestionReplyMixin","WASmaxInNewslettersNewsletterQuizCreationMixin","WASmaxInNewslettersNewsletterRevokeMixin","WASmaxInNewslettersNewsletterTextMixin","WASmaxInNewslettersNewsletterWAMOEmptyMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInNewslettersNewsletterQuestionMixin").parseNewsletterQuestionMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"NewsletterQuestion",value:t.value});var n=o("WASmaxInNewslettersNewsletterEditMixin").parseNewsletterEditMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"NewsletterEdit",value:n.value});var r=o("WASmaxInNewslettersNewsletterQuestionReplyMixin").parseNewsletterQuestionReplyMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"NewsletterQuestionReply",value:r.value});var a=o("WASmaxInNewslettersNewsletterRevokeMixin").parseNewsletterRevokeMixin(e);if(a.success)return o("WAResultOrError").makeResult({name:"NewsletterRevoke",value:a.value});var i=o("WASmaxInNewslettersNewsletterTextMixin").parseNewsletterTextMixin(e);if(i.success)return o("WAResultOrError").makeResult({name:"NewsletterText",value:i.value});var l=o("WASmaxInNewslettersNewsletterMediaMixin").parseNewsletterMediaMixin(e);if(l.success)return o("WAResultOrError").makeResult({name:"NewsletterMedia",value:l.value});var s=o("WASmaxInNewslettersNewsletterPollCreationMixin").parseNewsletterPollCreationMixin(e);if(s.success)return o("WAResultOrError").makeResult({name:"NewsletterPollCreation",value:s.value});var u=o("WASmaxInNewslettersNewsletterQuizCreationMixin").parseNewsletterQuizCreationMixin(e);if(u.success)return o("WAResultOrError").makeResult({name:"NewsletterQuizCreation",value:u.value});var c=o("WASmaxInNewslettersNewsletterPollResultSnapshotMixin").parseNewsletterPollResultSnapshotMixin(e);if(c.success)return o("WAResultOrError").makeResult({name:"NewsletterPollResultSnapshot",value:c.value});var d=o("WASmaxInNewslettersNewsletterWAMOEmptyMixin").parseNewsletterWAMOEmptyMixin(e);return d.success?o("WAResultOrError").makeResult({name:"NewsletterWAMOEmpty",value:d.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["NewsletterQuestion","NewsletterEdit","NewsletterQuestionReply","NewsletterRevoke","NewsletterText","NewsletterMedia","NewsletterPollCreation","NewsletterQuizCreation","NewsletterPollResultSnapshot","NewsletterWAMOEmpty"],[t,n,r,a,i,l,s,u,c,d])}l.parseNewsletterMessageHistoryContent=e}),98);
__d("WASmaxInNewslettersNewsletterMessageLastEditTimestampMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(n.value,"msg_edit_t",15778656e5,41024736e5);return r.success?o("WAResultOrError").makeResult({metaMsgEditT:r.value}):r}l.parseNewsletterMessageLastEditTimestampMixin=e}),98);
__d("WASmaxInNewslettersNewsletterMessageOriginalTimestampMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(n.value,"original_msg_t",1577865600,4102473600);return r.success?o("WAResultOrError").makeResult({metaOriginalMsgT:r.value}):r}l.parseNewsletterMessageOriginalTimestampMixin=e}),98);
__d("WASmaxInNewslettersNewsletterMessageHistoryMixin",["WAResultOrError","WASmaxInNewslettersAdminProfileMetaMixin","WASmaxInNewslettersNewsletterMessageHistoryContent","WASmaxInNewslettersNewsletterMessageLastEditTimestampMixin","WASmaxInNewslettersNewsletterMessageOriginalTimestampMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrStanzaId,e,"id");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(e,"server_id",99,2147476647);if(!r.success)return r;var a=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,e,"t",0,void 0);if(!a.success)return a;var i=o("WASmaxParseUtils").optionalLiteral(o("WASmaxParseUtils").attrString,e,"is_sender","true");if(!i.success)return i;var l=o("WASmaxInNewslettersNewsletterMessageOriginalTimestampMixin").parseNewsletterMessageOriginalTimestampMixin(e),s=o("WASmaxInNewslettersNewsletterMessageLastEditTimestampMixin").parseNewsletterMessageLastEditTimestampMixin(e),u=o("WASmaxInNewslettersAdminProfileMetaMixin").parseAdminProfileMetaMixin(e),c=o("WASmaxInNewslettersNewsletterMessageHistoryContent").parseNewsletterMessageHistoryContent(e);return o("WAResultOrError").makeResult({id:n.value,serverId:r.value,t:a.value,isSender:i.value,newsletterMessageOriginalTimestampMixin:l.success?l.value:null,newsletterMessageLastEditTimestampMixin:s.success?s.value:null,adminProfileMetaMixin:u.success?u.value:null,newsletterMessageHistoryContent:c.success?c.value:null})}l.parseNewsletterMessageHistoryMixin=e}),98);
__d("WASmaxInNewslettersNewsletterPollVotesMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"vote");if(!t.success)return t;var n=o("WASmaxParseUtils").attrIntRange(e,"count",1,void 0);if(!n.success)return n;var r=o("WASmaxParseUtils").contentBytesRange(e,32,32);return r.success?o("WAResultOrError").makeResult({count:n.value,elementValue:r.value}):r}function s(t){var n=o("WASmaxParseUtils").assertTag(t,"message");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(t,"votes");if(!r.success)return r;var a=o("WASmaxParseUtils").mapChildrenWithTag(r.value,"vote",0,1e3,e);return a.success?o("WAResultOrError").makeResult({votesVote:a.value}):a}l.parseNewsletterPollVotesVotesVote=e,l.parseNewsletterPollVotesMixin=s}),98);
__d("WASmaxInNewslettersNewsletterReactionsMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"reaction");if(!t.success)return t;var n=o("WASmaxParseUtils").attrString(e,"code");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(e,"count",1,void 0);return r.success?o("WAResultOrError").makeResult({code:n.value,count:r.value}):r}function s(t){var n=o("WASmaxParseUtils").assertTag(t,"message");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(t,"reactions");if(!r.success)return r;var a=o("WASmaxParseUtils").mapChildrenWithTag(r.value,"reaction",0,1e3,e);return a.success?o("WAResultOrError").makeResult({reactionsReaction:a.value}):a}l.parseNewsletterReactionsReactionsReaction=e,l.parseNewsletterReactionsMixin=s}),98);
__d("WASmaxInNewslettersNewsletterResponsesCountMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"responses_count");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(n.value,"count",0,void 0);return r.success?o("WAResultOrError").makeResult({responsesCountCount:r.value}):r}l.parseNewsletterResponsesCountMixin=e}),98);
__d("WASmaxInNewslettersNewsletterViewsCountDeprecatedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"views_count");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(n.value,"count",0,void 0);return r.success?o("WAResultOrError").makeResult({viewsCountCount:r.value}):r}l.parseNewsletterViewsCountDeprecatedMixin=e}),98);
__d("WASmaxInNewslettersNewsletterViewsCountViewsMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"views_count");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"type","views");if(!r.success)return r;var a=o("WASmaxParseUtils").attrIntRange(n.value,"count",0,void 0);return a.success?o("WAResultOrError").makeResult({viewsCountType:r.value,viewsCountCount:a.value}):a}l.parseNewsletterViewsCountViewsMixin=e}),98);
__d("WASmaxInNewslettersNewsletterViewsCountViewsOrDeprecatedMixinGroup",["WAResultOrError","WASmaxInNewslettersNewsletterViewsCountDeprecatedMixin","WASmaxInNewslettersNewsletterViewsCountViewsMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInNewslettersNewsletterViewsCountViewsMixin").parseNewsletterViewsCountViewsMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"NewsletterViewsCountViews",value:t.value});var n=o("WASmaxInNewslettersNewsletterViewsCountDeprecatedMixin").parseNewsletterViewsCountDeprecatedMixin(e);return n.success?o("WAResultOrError").makeResult({name:"NewsletterViewsCountDeprecated",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["NewsletterViewsCountViews","NewsletterViewsCountDeprecated"],[t,n])}l.parseNewsletterViewsCountViewsOrDeprecatedMixinGroup=e}),98);
__d("WASmaxInNewslettersReceiverContentTypeMediaRCATMixin",["WAResultOrError","WASmaxInNewslettersContentTypeMediaMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"rcat");if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"mediatype","url");if(!a.success)return a;var i=o("WASmaxParseUtils").contentBytes(r.value);if(!i.success)return i;var l=o("WASmaxInNewslettersContentTypeMediaMixin").parseContentTypeMediaMixin(e);return l.success?o("WAResultOrError").makeResult(babelHelpers.extends({plaintextMediatype:a.value,rcatElementValue:i.value},l.value)):l}l.parseReceiverContentTypeMediaRCATMixin=e}),98);
__d("WASmaxInNewslettersNewsletterMessageHistoryWithAddOnsMixin",["WAResultOrError","WASmaxInNewslettersNewsletterForwardsCountMixin","WASmaxInNewslettersNewsletterMessageHistoryMixin","WASmaxInNewslettersNewsletterPollVotesMixin","WASmaxInNewslettersNewsletterReactionsMixin","WASmaxInNewslettersNewsletterResponsesCountMixin","WASmaxInNewslettersNewsletterViewsCountViewsOrDeprecatedMixinGroup","WASmaxInNewslettersReceiverContentTypeMediaRCATMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxInNewslettersNewsletterMessageHistoryMixin").parseNewsletterMessageHistoryMixin(e);if(!n.success)return n;var r=o("WASmaxInNewslettersNewsletterReactionsMixin").parseNewsletterReactionsMixin(e),a=o("WASmaxInNewslettersNewsletterPollVotesMixin").parseNewsletterPollVotesMixin(e),i=o("WASmaxInNewslettersNewsletterResponsesCountMixin").parseNewsletterResponsesCountMixin(e),l=o("WASmaxInNewslettersReceiverContentTypeMediaRCATMixin").parseReceiverContentTypeMediaRCATMixin(e),s=o("WASmaxInNewslettersNewsletterForwardsCountMixin").parseNewsletterForwardsCountMixin(e),u=o("WASmaxInNewslettersNewsletterViewsCountViewsOrDeprecatedMixinGroup").parseNewsletterViewsCountViewsOrDeprecatedMixinGroup(e);return o("WAResultOrError").makeResult(babelHelpers.extends({},n.value,{newsletterReactionsMixin:r.success?r.value:null,newsletterPollVotesMixin:a.success?a.value:null,newsletterResponsesCountMixin:i.success?i.value:null,receiverContentTypeMediaRCATMixin:l.success?l.value:null,newsletterForwardsCountMixin:s.success?s.value:null,newsletterViewsCountViewsOrDeprecatedMixinGroup:u.success?u.value:null}))}l.parseNewsletterMessageHistoryWithAddOnsMixin=e}),98);
__d("WASmaxInNewslettersNewsletterMessageResponsePayloadMixin",["WAResultOrError","WASmaxInNewslettersNewsletterMessageHistoryWithAddOnsMixin","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxInNewslettersNewsletterMessageHistoryWithAddOnsMixin").parseNewsletterMessageHistoryWithAddOnsMixin(e);return n.success,n}function s(t){var n=o("WASmaxParseUtils").assertTag(t,"messages");if(!n.success)return n;var r=o("WASmaxParseUtils").optional(o("WASmaxParseJid").attrNewsletterJid,t,"jid");if(!r.success)return r;var a=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,t,"t",0,void 0);if(!a.success)return a;var i=o("WASmaxParseUtils").mapChildrenWithTag(t,"message",0,300,e);return i.success?o("WAResultOrError").makeResult({jid:r.value,t:a.value,message:i.value}):i}l.parseNewsletterMessageResponsePayloadMessage=e,l.parseNewsletterMessageResponsePayloadMixin=s}),98);
__d("WASmaxInNewslettersGetNewsletterMessageUpdatesResponseSuccess",["WAResultOrError","WASmaxInNewslettersIQResultResponseMixin","WASmaxInNewslettersNewsletterMessageResponsePayloadMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"message_updates");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(r.value,"messages");if(!a.success)return a;var i=o("WASmaxInNewslettersNewsletterMessageResponsePayloadMixin").parseNewsletterMessageResponsePayloadMixin(a.value);if(!i.success)return i;var l=o("WASmaxInNewslettersIQResultResponseMixin").parseIQResultResponseMixin(e,t);return l.success?o("WAResultOrError").makeResult(babelHelpers.extends({messageUpdatesMessagesNewsletterMessageResponsePayloadMixin:i.value},l.value)):l}l.parseGetNewsletterMessageUpdatesResponseSuccess=e}),98);
__d("WASmaxInNewslettersIQErrorNotAllowedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","not-allowed");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",405);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorNotAllowedMixin=e}),98);
__d("WASmaxInNewslettersNotAllowedIQErrorResponseMixin",["WAResultOrError","WASmaxInNewslettersIQErrorNotAllowedMixin","WASmaxInNewslettersIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInNewslettersIQErrorNotAllowedMixin").parseIQErrorNotAllowedMixin(r.value);if(!a.success)return a;var i=o("WASmaxInNewslettersIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({errorIQErrorNotAllowedMixin:a.value},i.value)):i}l.parseNotAllowedIQErrorResponseMixin=e}),98);
__d("WASmaxInNewslettersGetNewsletterMessagesClientErrors",["WAResultOrError","WASmaxInNewslettersBadRequestIQErrorResponseMixin","WASmaxInNewslettersItemNotFoundIQErrorResponseMixin","WASmaxInNewslettersNotAllowedIQErrorResponseMixin","WASmaxInNewslettersRateLimitedIQErrorResponseMixin","WASmaxInNewslettersSuspendedIQErrorResponseMixin","WASmaxInNewslettersUnavailableForLegalReasonsResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxInNewslettersBadRequestIQErrorResponseMixin").parseBadRequestIQErrorResponseMixin(e,t);if(n.success)return o("WAResultOrError").makeResult({name:"BadRequestIQErrorResponse",value:n.value});var r=o("WASmaxInNewslettersUnavailableForLegalReasonsResponseMixin").parseUnavailableForLegalReasonsResponseMixin(e,t);if(r.success)return o("WAResultOrError").makeResult({name:"UnavailableForLegalReasonsResponse",value:r.value});var a=o("WASmaxInNewslettersItemNotFoundIQErrorResponseMixin").parseItemNotFoundIQErrorResponseMixin(e,t);if(a.success)return o("WAResultOrError").makeResult({name:"ItemNotFoundIQErrorResponse",value:a.value});var i=o("WASmaxInNewslettersSuspendedIQErrorResponseMixin").parseSuspendedIQErrorResponseMixin(e,t);if(i.success)return o("WAResultOrError").makeResult({name:"SuspendedIQErrorResponse",value:i.value});var l=o("WASmaxInNewslettersRateLimitedIQErrorResponseMixin").parseRateLimitedIQErrorResponseMixin(e,t);if(l.success)return o("WAResultOrError").makeResult({name:"RateLimitedIQErrorResponse",value:l.value});var s=o("WASmaxInNewslettersNotAllowedIQErrorResponseMixin").parseNotAllowedIQErrorResponseMixin(e,t);return s.success?o("WAResultOrError").makeResult({name:"NotAllowedIQErrorResponse",value:s.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["BadRequestIQErrorResponse","UnavailableForLegalReasonsResponse","ItemNotFoundIQErrorResponse","SuspendedIQErrorResponse","RateLimitedIQErrorResponse","NotAllowedIQErrorResponse"],[n,r,a,i,l,s])}l.parseGetNewsletterMessagesClientErrors=e}),98);
__d("WASmaxInNewslettersGetNewsletterMessagesResponseClientError",["WAResultOrError","WASmaxInNewslettersGetNewsletterMessagesClientErrors","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInNewslettersGetNewsletterMessagesClientErrors").parseGetNewsletterMessagesClientErrors(e,t);return r.success?o("WAResultOrError").makeResult({getNewsletterMessagesClientErrors:r.value}):r}l.parseGetNewsletterMessagesResponseClientError=e}),98);
__d("WASmaxInNewslettersGetNewsletterMessagesResponseServerError",["WAResultOrError","WASmaxInNewslettersIQErrorInternalServerErrorMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!a.success)return a;var i=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",a.value);if(!i.success)return i;var l=o("WASmaxParseJid").literalJid(o("WASmaxParseJid").attrDomainJid,e,"from","s.whatsapp.net");if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","error");if(!s.success)return s;var u=o("WASmaxInNewslettersIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(r.value);return u.success?o("WAResultOrError").makeResult({from:l.value,type:s.value,errorIQErrorInternalServerErrorMixin:u.value}):u}l.parseGetNewsletterMessagesResponseServerError=e}),98);
__d("WASmaxInNewslettersGetNewsletterMessagesResponseSuccess",["WAResultOrError","WASmaxInNewslettersNewsletterMessageResponsePayloadMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"messages");if(!r.success)return r;var a=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!a.success)return a;var i=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",a.value);if(!i.success)return i;var l=o("WASmaxParseJid").literalJid(o("WASmaxParseJid").attrDomainJid,e,"from","s.whatsapp.net");if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");if(!s.success)return s;var u=o("WASmaxInNewslettersNewsletterMessageResponsePayloadMixin").parseNewsletterMessageResponsePayloadMixin(r.value);return u.success?o("WAResultOrError").makeResult({from:l.value,type:s.value,messagesNewsletterMessageResponsePayloadMixin:u.value}):u}l.parseGetNewsletterMessagesResponseSuccess=e}),98);
__d("WASmaxInNewslettersIQErrorNotAuthorizedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","not-authorized");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",401);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorNotAuthorizedMixin=e}),98);
__d("WASmaxInNewslettersUnauthorizedIQErrorResponseMixin",["WAResultOrError","WASmaxInNewslettersIQErrorNotAuthorizedMixin","WASmaxInNewslettersIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInNewslettersIQErrorNotAuthorizedMixin").parseIQErrorNotAuthorizedMixin(r.value);if(!a.success)return a;var i=o("WASmaxInNewslettersIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({errorIQErrorNotAuthorizedMixin:a.value},i.value)):i}l.parseUnauthorizedIQErrorResponseMixin=e}),98);
__d("WASmaxInNewslettersMyAddonsClientErrors",["WAResultOrError","WASmaxInNewslettersBadRequestIQErrorResponseMixin","WASmaxInNewslettersItemNotFoundIQErrorResponseMixin","WASmaxInNewslettersRateLimitedIQErrorResponseMixin","WASmaxInNewslettersUnauthorizedIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxInNewslettersBadRequestIQErrorResponseMixin").parseBadRequestIQErrorResponseMixin(e,t);if(n.success)return o("WAResultOrError").makeResult({name:"BadRequestIQErrorResponse",value:n.value});var r=o("WASmaxInNewslettersUnauthorizedIQErrorResponseMixin").parseUnauthorizedIQErrorResponseMixin(e,t);if(r.success)return o("WAResultOrError").makeResult({name:"UnauthorizedIQErrorResponse",value:r.value});var a=o("WASmaxInNewslettersItemNotFoundIQErrorResponseMixin").parseItemNotFoundIQErrorResponseMixin(e,t);if(a.success)return o("WAResultOrError").makeResult({name:"ItemNotFoundIQErrorResponse",value:a.value});var i=o("WASmaxInNewslettersRateLimitedIQErrorResponseMixin").parseRateLimitedIQErrorResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult({name:"RateLimitedIQErrorResponse",value:i.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["BadRequestIQErrorResponse","UnauthorizedIQErrorResponse","ItemNotFoundIQErrorResponse","RateLimitedIQErrorResponse"],[n,r,a,i])}l.parseMyAddonsClientErrors=e}),98);
__d("WASmaxInNewslettersMyAddOnsResponseClientError",["WAResultOrError","WASmaxInNewslettersMyAddonsClientErrors","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInNewslettersMyAddonsClientErrors").parseMyAddonsClientErrors(e,t);return r.success?o("WAResultOrError").makeResult({myAddonsClientErrors:r.value}):r}l.parseMyAddOnsResponseClientError=e}),98);
__d("WASmaxInNewslettersMyAddOnsResponseServerError",["WASmaxInNewslettersInternalServerErrorIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInNewslettersInternalServerErrorIQErrorResponseMixin").parseInternalServerErrorIQErrorResponseMixin(e,t);return r.success,r}l.parseMyAddOnsResponseServerError=e}),98);
__d("WASmaxInNewslettersNewsletterMyPollVoteMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"vote");if(!t.success)return t;var n=o("WASmaxParseUtils").contentBytesRange(e,32,32);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}function s(t){var n=o("WASmaxParseUtils").assertTag(t,"message");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(t,"votes");if(!r.success)return r;var a=o("WASmaxParseUtils").attrIntRange(r.value,"t",0,void 0);if(!a.success)return a;var i=o("WASmaxParseUtils").mapChildrenWithTag(r.value,"vote",0,1e3,e);return i.success?o("WAResultOrError").makeResult({votesT:a.value,votesVote:i.value}):i}l.parseNewsletterMyPollVoteVotesVote=e,l.parseNewsletterMyPollVoteMixin=s}),98);
__d("WASmaxInNewslettersNewsletterMyReactionMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"reaction");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(n.value,"code");if(!r.success)return r;var a=o("WASmaxParseUtils").attrIntRange(n.value,"t",0,void 0);return a.success?o("WAResultOrError").makeResult({reactionCode:r.value,reactionT:a.value}):a}l.parseNewsletterMyReactionMixin=e}),98);
__d("WASmaxInNewslettersNewsletterMessageMyAddOnsMixin",["WAResultOrError","WASmaxInNewslettersNewsletterMyPollVoteMixin","WASmaxInNewslettersNewsletterMyReactionMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").attrIntRange(e,"server_id",99,2147476647);if(!n.success)return n;var r=o("WASmaxInNewslettersNewsletterMyReactionMixin").parseNewsletterMyReactionMixin(e),a=o("WASmaxInNewslettersNewsletterMyPollVoteMixin").parseNewsletterMyPollVoteMixin(e);return o("WAResultOrError").makeResult({serverId:n.value,newsletterMyReactionMixin:r.success?r.value:null,newsletterMyPollVoteMixin:a.success?a.value:null})}l.parseNewsletterMessageMyAddOnsMixin=e}),98);
__d("WASmaxInNewslettersMyAddOnsResponseSuccess",["WAResultOrError","WASmaxInNewslettersIQResultResponseMixin","WASmaxInNewslettersNewsletterMessageMyAddOnsMixin","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxInNewslettersNewsletterMessageMyAddOnsMixin").parseNewsletterMessageMyAddOnsMixin(e);return n.success,n}function s(t){var n=o("WASmaxParseUtils").assertTag(t,"messages");if(!n.success)return n;var r=o("WASmaxParseJid").attrNewsletterJid(t,"jid");if(!r.success)return r;var a=o("WASmaxParseUtils").mapChildrenWithTag(t,"message",0,5e3,e);return a.success?o("WAResultOrError").makeResult({jid:r.value,message:a.value}):a}function u(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"my_addons");if(!r.success)return r;var a=o("WASmaxInNewslettersIQResultResponseMixin").parseIQResultResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxParseUtils").mapChildrenWithTag(r.value,"messages",0,5e3,s);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{myAddonsMessages:i.value})):i}l.parseMyAddOnsResponseSuccessMyAddonsMessagesMessage=e,l.parseMyAddOnsResponseSuccessMyAddonsMessages=s,l.parseMyAddOnsResponseSuccess=u}),98);
__d("WASmaxInPreKeysFetchMissingPreKeysResponseRequestError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysRequestErrorsFetch","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInPreKeysRequestErrorsFetch").parseRequestErrorsFetch(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorRequestErrorsFetch:i.value})):i}l.parseFetchMissingPreKeysResponseRequestError=e}),98);
__d("WASmaxInPreKeysFetchMissingPreKeysResponseServerError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysServerErrors","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInPreKeysServerErrors").parseServerErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorServerErrors:i.value})):i}l.parseFetchMissingPreKeysResponseServerError=e}),98);
__d("WASmaxInPreKeysFetchMissingPreKeysUserErrorFallbackMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"user");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(n.value,"text");if(!r.success)return r;var a=o("WASmaxParseUtils").attrIntRange(n.value,"code",500,599);return a.success?o("WAResultOrError").makeResult({errorText:r.value,errorCode:a.value}):a}l.parseFetchMissingPreKeysUserErrorFallbackMixin=e}),98);
__d("WASmaxInPreKeysFetchMissingPreKeysUserErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"user");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(n.value,"text");if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,n.value,"code",500);return a.success?o("WAResultOrError").makeResult({errorText:r.value,errorCode:a.value}):a}l.parseFetchMissingPreKeysUserErrorMixin=e}),98);
__d("WASmaxInPreKeysFetchMissingPreKeysUserSuccessMixin",["WAResultOrError","WASmaxInPreKeysDeviceIdentityMixin","WASmaxInPreKeysEnums","WASmaxInPreKeysIdentityKeyMixin","WASmaxInPreKeysKeyTypeMixin","WASmaxInPreKeysPreKeyMixin","WASmaxInPreKeysRegistrationIDMixin","WASmaxInPreKeysSignedPreKeyMixin","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"device");if(!t.success)return t;var n=o("WASmaxParseUtils").attrIntRange(e,"id",0,99);if(!n.success)return n;var r=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,e,"t",0,void 0);if(!r.success)return r;var a=o("WASmaxParseUtils").optionalLiteral(o("WASmaxParseUtils").attrString,e,"is_cloud_api","true");if(!a.success)return a;var i=o("WASmaxInPreKeysRegistrationIDMixin").parseRegistrationIDMixin(e);if(!i.success)return i;var l=o("WASmaxInPreKeysKeyTypeMixin").parseKeyTypeMixin(e),s=o("WASmaxInPreKeysIdentityKeyMixin").parseIdentityKeyMixin(e);if(!s.success)return s;var u=o("WASmaxInPreKeysPreKeyMixin").parsePreKeyMixin(e),c=o("WASmaxInPreKeysSignedPreKeyMixin").parseSignedPreKeyMixin(e);if(!c.success)return c;var d=o("WASmaxInPreKeysDeviceIdentityMixin").parseDeviceIdentityMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({id:n.value,t:r.value,isCloudApi:a.value},i.value,{keyTypeMixin:l.success?l.value:null},s.value,{preKeyMixin:u.success?u.value:null},c.value,{deviceIdentityMixin:d.success?d.value:null}))}function s(t){var n=o("WASmaxParseUtils").assertTag(t,"user");if(!n.success)return n;var r=o("WASmaxParseJid").attrJidEnum(t,"jid",o("WASmaxInPreKeysEnums").USERJID_USERJID);if(!r.success)return r;var a=o("WASmaxParseUtils").mapChildrenWithTag(t,"device",1,100,e);return a.success?o("WAResultOrError").makeResult({jid:r.value,device:a.value}):a}l.parseFetchMissingPreKeysUserSuccessDevice=e,l.parseFetchMissingPreKeysUserSuccessMixin=s}),98);
__d("WASmaxInPreKeysUserFetchMissingPreKeysSuccessOrFetchMissingPreKeysErrorOrFetchMissingPreKeysErrorFallbackMixinGroup",["WAResultOrError","WASmaxInPreKeysFetchMissingPreKeysUserErrorFallbackMixin","WASmaxInPreKeysFetchMissingPreKeysUserErrorMixin","WASmaxInPreKeysFetchMissingPreKeysUserSuccessMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInPreKeysFetchMissingPreKeysUserSuccessMixin").parseFetchMissingPreKeysUserSuccessMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"FetchMissingPreKeysUserSuccess",value:t.value});var n=o("WASmaxInPreKeysFetchMissingPreKeysUserErrorMixin").parseFetchMissingPreKeysUserErrorMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"FetchMissingPreKeysUserError",value:n.value});var r=o("WASmaxInPreKeysFetchMissingPreKeysUserErrorFallbackMixin").parseFetchMissingPreKeysUserErrorFallbackMixin(e);return r.success?o("WAResultOrError").makeResult({name:"FetchMissingPreKeysUserErrorFallback",value:r.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["UserSuccess","UserError","UserErrorFallback"],[t,n,r])}l.parseUserFetchMissingPreKeysSuccessOrFetchMissingPreKeysErrorOrFetchMissingPreKeysErrorFallbackMixinGroup=e}),98);
__d("WASmaxInPreKeysFetchMissingPreKeysResponseSuccess",["WAResultOrError","WASmaxInPreKeysEnums","WASmaxInPreKeysIQResultResponseMixin","WASmaxInPreKeysResponsePaddingMixin","WASmaxInPreKeysUserFetchMissingPreKeysSuccessOrFetchMissingPreKeysErrorOrFetchMissingPreKeysErrorFallbackMixinGroup","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"user");if(!t.success)return t;var n=o("WASmaxParseJid").attrJidEnum(e,"jid",o("WASmaxInPreKeysEnums").USERJID_USERJID);if(!n.success)return n;var r=o("WASmaxInPreKeysUserFetchMissingPreKeysSuccessOrFetchMissingPreKeysErrorOrFetchMissingPreKeysErrorFallbackMixinGroup").parseUserFetchMissingPreKeysSuccessOrFetchMissingPreKeysErrorOrFetchMissingPreKeysErrorFallbackMixinGroup(e);return r.success?o("WAResultOrError").makeResult({jid:n.value,userFetchMissingPreKeysSuccessOrFetchMissingPreKeysErrorOrFetchMissingPreKeysErrorFallbackMixinGroup:r.value}):r}function s(t,n){var r=o("WASmaxParseUtils").assertTag(t,"iq");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(t,"list");if(!a.success)return a;var i=o("WASmaxInPreKeysIQResultResponseMixin").parseIQResultResponseMixin(t,n);if(!i.success)return i;var l=o("WASmaxInPreKeysResponsePaddingMixin").parseResponsePaddingMixin(t),s=o("WASmaxParseUtils").mapChildrenWithTag(a.value,"user",0,1e5,e);return s.success?o("WAResultOrError").makeResult(babelHelpers.extends({},i.value,{responsePaddingMixin:l.success?l.value:null,listUser:s.value})):s}l.parseFetchMissingPreKeysResponseSuccessListUser=e,l.parseFetchMissingPreKeysResponseSuccess=s}),98);
__d("WASmaxInPrivacyPnJidMixin",["WAResultOrError","WASmaxParseJid"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseJid").attrUserJid(e,"pn_jid");return t.success?o("WAResultOrError").makeResult({pnJid:t.value}):t}l.parsePnJidMixin=e}),98);
__d("WASmaxInPrivacyUsernameMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").attrString(e,"username");return t.success?o("WAResultOrError").makeResult({username:t.value}):t}l.parseUsernameMixin=e}),98);
__d("WASmaxInPrivacyContactListIds",["WAResultOrError","WASmaxInPrivacyPnJidMixin","WASmaxInPrivacyUsernameMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInPrivacyUsernameMixin").parseUsernameMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"Username",value:t.value});var n=o("WASmaxInPrivacyPnJidMixin").parsePnJidMixin(e);return n.success?o("WAResultOrError").makeResult({name:"PnJid",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["Username","PnJid"],[t,n])}l.parseContactListIds=e}),98);
__d("WASmaxInPrivacyEnums",["WAJids"],(function(t,n,r,o,a,i,l){var e,s={all:"all",contact_blacklist:"contact_blacklist",contacts:"contacts",none:"none"},u={all:"all",contacts:"contacts"},c={all:"all",contacts:"contacts",known:"known"},d={all:"all",contacts:"contacts",none:"none"},m={all:"all",match_last_seen:"match_last_seen"},p={all:"all",none:"none"},_={calladd:"calladd",cover_photo:"cover_photo",defense:"defense",dependentaccountmessages:"dependentaccountmessages",groupadd:"groupadd",groupcreation:"groupcreation",last:"last",linked_profiles:"linked_profiles",messages:"messages",online:"online",pix:"pix",profile:"profile",readreceipts:"readreceipts",status:"status",stickers:"stickers"},f={contacts:"contacts",none:"none"},g={off:"off",on_standard:"on_standard"},h={validators:[(e=o("WAJids")).validateDomainJid,e.validateUserJid],typeName:"DomainJid|UserJid"},y={validators:[e.validateUserJid,e.validateUserJid],typeName:"UserJid|UserJid"};l.ENUM_ALL_CONTACTBLACKLIST_CONTACTS_NONE=s,l.ENUM_ALL_CONTACTS=u,l.ENUM_ALL_CONTACTS_KNOWN=c,l.ENUM_ALL_CONTACTS_NONE=d,l.ENUM_ALL_MATCHLASTSEEN=m,l.ENUM_ALL_NONE=p,l.ENUM_CALLADD_COVERPHOTO_DEFENSE_DEPENDENTACCOUNTMESSAGES_GROUPADD_GROUPCREATION_LAST_LINKEDPROFILES_MESSAGES_ONLINE_PIX_PROFILE_READRECEIPTS_STATUS_STICKERS=_,l.ENUM_CONTACTS_NONE=f,l.ENUM_OFF_ONSTANDARD=g,l.DOMAINJID_USERJID=h,l.USERJID_USERJID=y}),98);
__d("WASmaxInPrivacyDeprecatedIQErrorResponseOptionalFromMixin",["WAResultOrError","WASmaxInPrivacyEnums","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseUtils").optional(o("WASmaxParseJid").attrJidEnum,e,"from",o("WASmaxInPrivacyEnums").DOMAINJID_USERJID);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","error");return l.success?o("WAResultOrError").makeResult({from:i.value,type:l.value}):l}l.parseDeprecatedIQErrorResponseOptionalFromMixin=e}),98);
__d("WASmaxInPrivacyDeprecatedIQResultResponseOptionalFromMixin",["WAResultOrError","WASmaxInPrivacyEnums","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseUtils").optional(o("WASmaxParseJid").attrJidEnum,e,"from",o("WASmaxInPrivacyEnums").DOMAINJID_USERJID);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");return l.success?o("WAResultOrError").makeResult({from:i.value,type:l.value}):l}l.parseDeprecatedIQResultResponseOptionalFromMixin=e}),98);
__d("WASmaxInPrivacyIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","bad-request");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",400);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorBadRequestMixin=e}),98);
__d("WASmaxInPrivacyIQErrorFeatureNotImplementedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","feature-not-implemented");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",501);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorFeatureNotImplementedMixin=e}),98);
__d("WASmaxInPrivacyIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","internal-server-error");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",500);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorInternalServerErrorMixin=e}),98);
__d("WASmaxInPrivacyIQErrorRateOverlimitMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","rate-overlimit");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",429);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorRateOverlimitMixin=e}),98);
__d("WASmaxInPrivacyIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","service-unavailable");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",503);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorServiceUnavailableMixin=e}),98);
__d("WASmaxInPrivacyGetPrivacyListError",["WAResultOrError","WASmaxInPrivacyIQErrorBadRequestMixin","WASmaxInPrivacyIQErrorFeatureNotImplementedMixin","WASmaxInPrivacyIQErrorInternalServerErrorMixin","WASmaxInPrivacyIQErrorRateOverlimitMixin","WASmaxInPrivacyIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInPrivacyIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:t.value});var n=o("WASmaxInPrivacyIQErrorFeatureNotImplementedMixin").parseIQErrorFeatureNotImplementedMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorFeatureNotImplemented",value:n.value});var r=o("WASmaxInPrivacyIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:r.value});var a=o("WASmaxInPrivacyIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(e);if(a.success)return o("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:a.value});var i=o("WASmaxInPrivacyIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(e);return i.success?o("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:i.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorBadRequest","IQErrorFeatureNotImplemented","IQErrorServiceUnavailable","IQErrorRateOverlimit","IQErrorInternalServerError"],[t,n,r,a,i])}l.parseGetPrivacyListError=e}),98);
__d("WASmaxInPrivacyGetContactBlacklistResponseError",["WAResultOrError","WASmaxInPrivacyDeprecatedIQErrorResponseOptionalFromMixin","WASmaxInPrivacyGetPrivacyListError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInPrivacyDeprecatedIQErrorResponseOptionalFromMixin").parseDeprecatedIQErrorResponseOptionalFromMixin(e,t);if(!a.success)return a;var i=o("WASmaxInPrivacyGetPrivacyListError").parseGetPrivacyListError(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorGetPrivacyListError:i.value})):i}l.parseGetContactBlacklistResponseError=e}),98);
__d("WASmaxInPrivacyGetContactBlacklistResponseSuccess",["WAResultOrError","WASmaxInPrivacyDeprecatedIQResultResponseOptionalFromMixin","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"user");if(!t.success)return t;var n=o("WASmaxParseJid").attrUserJid(e,"jid");if(!n.success)return n;var r=o("WASmaxParseUtils").optional(o("WASmaxParseJid").attrLidUserJid,e,"lid");return r.success?o("WAResultOrError").makeResult({jid:n.value,lid:r.value}):r}function s(t){var n=o("WASmaxParseUtils").assertTag(t,"list");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(t,"dhash");if(!r.success)return r;var a=o("WASmaxParseUtils").mapChildrenWithTag(t,"user",0,64e3,e);return a.success?o("WAResultOrError").makeResult({dhash:r.value,user:a.value}):a}function u(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"privacy");if(!r.success)return r;var a=o("WASmaxParseUtils").optionalChildWithTag(r.value,"list",s);if(!a.success)return a;var i=o("WASmaxParseUtils").optionalLiteral(o("WASmaxParseUtils").attrString,r.value,"addressing_mode","pn");if(!i.success)return i;var l=o("WASmaxInPrivacyDeprecatedIQResultResponseOptionalFromMixin").parseDeprecatedIQResultResponseOptionalFromMixin(e,t);return l.success?o("WAResultOrError").makeResult(babelHelpers.extends({privacyAddressingMode:i.value},l.value,{privacyList:a.value})):l}l.parseGetContactBlacklistResponseSuccessPrivacyListUser=e,l.parseGetContactBlacklistResponseSuccessPrivacyList=s,l.parseGetContactBlacklistResponseSuccess=u}),98);
__d("WASmaxInPrivacyPrivacyContactListIdentifierMixin",["WAResultOrError","WASmaxInPrivacyContactListIds"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInPrivacyContactListIds").parseContactListIds(e);return t.success?o("WAResultOrError").makeResult({contactListIds:t.value}):t}l.parsePrivacyContactListIdentifierMixin=e}),98);
__d("WASmaxInPrivacyGetContactBlacklistResponseSuccessLID",["WAResultOrError","WASmaxInPrivacyDeprecatedIQResultResponseOptionalFromMixin","WASmaxInPrivacyPrivacyContactListIdentifierMixin","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"user");if(!t.success)return t;var n=o("WASmaxParseUtils").optional(o("WASmaxParseJid").attrLidUserJid,e,"jid");if(!n.success)return n;var r=o("WASmaxInPrivacyPrivacyContactListIdentifierMixin").parsePrivacyContactListIdentifierMixin(e);return r.success?o("WAResultOrError").makeResult(babelHelpers.extends({jid:n.value},r.value)):r}function s(t){var n=o("WASmaxParseUtils").assertTag(t,"list");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(t,"dhash");if(!r.success)return r;var a=o("WASmaxParseUtils").mapChildrenWithTag(t,"user",0,64e3,e);return a.success?o("WAResultOrError").makeResult({dhash:r.value,user:a.value}):a}function u(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"privacy");if(!r.success)return r;var a=o("WASmaxParseUtils").optionalChildWithTag(r.value,"list",s);if(!a.success)return a;var i=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,r.value,"addressing_mode","lid");if(!i.success)return i;var l=o("WASmaxInPrivacyDeprecatedIQResultResponseOptionalFromMixin").parseDeprecatedIQResultResponseOptionalFromMixin(e,t);return l.success?o("WAResultOrError").makeResult(babelHelpers.extends({privacyAddressingMode:i.value},l.value,{privacyList:a.value})):l}l.parseGetContactBlacklistResponseSuccessLIDPrivacyListUser=e,l.parseGetContactBlacklistResponseSuccessLIDPrivacyList=s,l.parseGetContactBlacklistResponseSuccessLID=u}),98);
__d("WASmaxInPsaIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","internal-server-error");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",500);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorInternalServerErrorMixin=e}),98);
__d("WASmaxInPsaIQErrorRateOverlimitMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","rate-overlimit");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",429);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorRateOverlimitMixin=e}),98);
__d("WASmaxInPsaIQErrorRequestTimeoutMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","request-timeout");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",408);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorRequestTimeoutMixin=e}),98);
__d("WASmaxInPsaIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","service-unavailable");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",503);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorServiceUnavailableMixin=e}),98);
__d("WASmaxInPsaChatBlockError",["WAResultOrError","WASmaxInPsaIQErrorInternalServerErrorMixin","WASmaxInPsaIQErrorRateOverlimitMixin","WASmaxInPsaIQErrorRequestTimeoutMixin","WASmaxInPsaIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInPsaIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:t.value});var n=o("WASmaxInPsaIQErrorRequestTimeoutMixin").parseIQErrorRequestTimeoutMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorRequestTimeout",value:n.value});var r=o("WASmaxInPsaIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:r.value});var a=o("WASmaxInPsaIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(e);return a.success?o("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:a.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorInternalServerError","IQErrorRequestTimeout","IQErrorServiceUnavailable","IQErrorRateOverlimit"],[t,n,r,a])}l.parseChatBlockError=e}),98);
__d("WASmaxInPsaIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","error");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQErrorResponseMixin=e}),98);
__d("WASmaxInPsaChatBlockGetResponseServerError",["WAResultOrError","WASmaxInPsaChatBlockError","WASmaxInPsaIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInPsaIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInPsaChatBlockError").parseChatBlockError(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorChatBlockError:i.value})):i}l.parseChatBlockGetResponseServerError=e}),98);
__d("WASmaxInPsaEnums",["WAJids"],(function(t,n,r,o,a,i,l){var e={blocked:"blocked",unblocked:"unblocked"},s={image:"image",video:"video"},u={validators:[o("WAJids").validateStatusJid,o("WAJids").validateUserJid],typeName:"StatusJid|UserJid"};l.ENUM_BLOCKED_UNBLOCKED=e,l.ENUM_IMAGE_VIDEO=s,l.STATUSJID_USERJID=u}),98);
__d("WASmaxInPsaIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQResultResponseMixin=e}),98);
__d("WASmaxInPsaChatBlockGetResponseSuccess",["WAResultOrError","WASmaxInPsaEnums","WASmaxInPsaIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"blocking");if(!r.success)return r;var a=o("WASmaxParseUtils").attrStringEnum(r.value,"status",o("WASmaxInPsaEnums").ENUM_BLOCKED_UNBLOCKED);if(!a.success)return a;var i=o("WASmaxInPsaIQResultResponseMixin").parseIQResultResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({blockingStatus:a.value},i.value)):i}l.parseChatBlockGetResponseSuccess=e}),98);
__d("WASmaxInWaffleEnums",[],(function(t,n,r,o,a,i){var e={false:"false",true:"true"};i.ENUM_FALSE_TRUE=e}),66);
__d("WASmaxInWaffleIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","bad-request");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",400);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorBadRequestMixin=e}),98);
__d("WASmaxInWaffleIQErrorFeatureNotImplementedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","feature-not-implemented");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",501);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorFeatureNotImplementedMixin=e}),98);
__d("WASmaxInWaffleIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","internal-server-error");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",500);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorInternalServerErrorMixin=e}),98);
__d("WASmaxInWaffleIQErrorNotAllowedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","not-allowed");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",405);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorNotAllowedMixin=e}),98);
__d("WASmaxInWaffleIQErrorRateOverlimitMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","rate-overlimit");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",429);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorRateOverlimitMixin=e}),98);
__d("WASmaxInWaffleIQErrorRequestTimeoutMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","request-timeout");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",408);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorRequestTimeoutMixin=e}),98);
__d("WASmaxInWaffleIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","service-unavailable");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",503);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorServiceUnavailableMixin=e}),98);
__d("WASmaxInWaffleGetCertificateErrors",["WAResultOrError","WASmaxInWaffleIQErrorBadRequestMixin","WASmaxInWaffleIQErrorFeatureNotImplementedMixin","WASmaxInWaffleIQErrorInternalServerErrorMixin","WASmaxInWaffleIQErrorNotAllowedMixin","WASmaxInWaffleIQErrorRateOverlimitMixin","WASmaxInWaffleIQErrorRequestTimeoutMixin","WASmaxInWaffleIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInWaffleIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:t.value});var n=o("WASmaxInWaffleIQErrorRequestTimeoutMixin").parseIQErrorRequestTimeoutMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorRequestTimeout",value:n.value});var r=o("WASmaxInWaffleIQErrorNotAllowedMixin").parseIQErrorNotAllowedMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"IQErrorNotAllowed",value:r.value});var a=o("WASmaxInWaffleIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(e);if(a.success)return o("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:a.value});var i=o("WASmaxInWaffleIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(e);if(i.success)return o("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:i.value});var l=o("WASmaxInWaffleIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(e);if(l.success)return o("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:l.value});var s=o("WASmaxInWaffleIQErrorFeatureNotImplementedMixin").parseIQErrorFeatureNotImplementedMixin(e);return s.success?o("WAResultOrError").makeResult({name:"IQErrorFeatureNotImplemented",value:s.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorBadRequest","IQErrorRequestTimeout","IQErrorNotAllowed","IQErrorInternalServerError","IQErrorRateOverlimit","IQErrorServiceUnavailable","IQErrorFeatureNotImplemented"],[t,n,r,a,i,l,s])}l.parseGetCertificateErrors=e}),98);
__d("WASmaxInWaffleIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","error");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQErrorResponseMixin=e}),98);
__d("WASmaxInWaffleGetCertificateResponseError",["WAResultOrError","WASmaxInWaffleGetCertificateErrors","WASmaxInWaffleIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInWaffleIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInWaffleGetCertificateErrors").parseGetCertificateErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorGetCertificateErrors:i.value})):i}l.parseGetCertificateResponseError=e}),98);
__d("WASmaxInWaffleGetCertificateResponseMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"encryption_pem");if(!t.success)return t;var n=o("WASmaxParseUtils").attrIntRange(e,"ttl",1,void 0);if(!n.success)return n;var r=o("WASmaxParseUtils").contentBytesRange(e,1,4092);return r.success?o("WAResultOrError").makeResult({ttl:n.value,elementValue:r.value}):r}function s(e){var t=o("WASmaxParseUtils").assertTag(e,"signature_pem");if(!t.success)return t;var n=o("WASmaxParseUtils").attrIntRange(e,"ttl",1,void 0);if(!n.success)return n;var r=o("WASmaxParseUtils").contentBytesRange(e,1,4092);return r.success?o("WAResultOrError").makeResult({ttl:n.value,elementValue:r.value}):r}function u(e){var t=o("WASmaxParseUtils").assertTag(e,"password_pem");if(!t.success)return t;var n=o("WASmaxParseUtils").attrIntRange(e,"ttl",1,void 0);if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(e,"key_id",1,void 0);if(!r.success)return r;var a=o("WASmaxParseUtils").contentBytesRange(e,1,4092);return a.success?o("WAResultOrError").makeResult({ttl:n.value,keyId:r.value,elementValue:a.value}):a}function c(t){var n=o("WASmaxParseUtils").optionalChildWithTag(t,"encryption_pem",e);if(!n.success)return n;var r=o("WASmaxParseUtils").optionalChildWithTag(t,"signature_pem",s);if(!r.success)return r;var a=o("WASmaxParseUtils").optionalChildWithTag(t,"password_pem",u);if(!a.success)return a;var i=o("WASmaxParseUtils").attrIntRange(t,"timestamp",1,void 0);return i.success?o("WAResultOrError").makeResult({timestamp:i.value,encryptionPem:n.value,signaturePem:r.value,passwordPem:a.value}):i}l.parseGetCertificateResponseEncryptionPem=e,l.parseGetCertificateResponseSignaturePem=s,l.parseGetCertificateResponsePasswordPem=u,l.parseGetCertificateResponseMixin=c}),98);
__d("WASmaxInWaffleIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQResultResponseMixin=e}),98);
__d("WASmaxInWaffleGetCertificateResponseSuccess",["WAResultOrError","WASmaxInWaffleGetCertificateResponseMixin","WASmaxInWaffleIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"reply");if(!r.success)return r;var a=o("WASmaxInWaffleGetCertificateResponseMixin").parseGetCertificateResponseMixin(r.value);if(!a.success)return a;var i=o("WASmaxInWaffleIQResultResponseMixin").parseIQResultResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({replyGetCertificateResponseMixin:a.value},i.value)):i}l.parseGetCertificateResponseSuccess=e}),98);
__d("WASmaxInWaffleIQErrorConflictMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","conflict");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",409);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorConflictMixin=e}),98);
__d("WASmaxInWaffleIQErrorNotAuthorizedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","not-authorized");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",401);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorNotAuthorizedMixin=e}),98);
__d("WASmaxInWaffleIQErrorPayloadEncDecMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","payload-enc-dec-failed");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",480);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorPayloadEncDecMixin=e}),98);
__d("WASmaxInWaffleIQErrorWFNotAuthorizedInvalidPasswordMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","wf-not-authorized-invalid-password");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",416);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorWFNotAuthorizedInvalidPasswordMixin=e}),98);
__d("WASmaxInWaffleIQErrorWFNotFoundMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","wf-not-found");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",483);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorWFNotFoundMixin=e}),98);
__d("WASmaxInWaffleIQErrorWFStateMismatchMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","wf-state-mismatch");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",485);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorWFStateMismatchMixin=e}),98);
__d("WASmaxInWaffleIQErrorWFSuspendedMixin",["WAResultOrError","WASmaxInWaffleEnums","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","wf-suspended");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",484);if(!r.success)return r;var a=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrStringEnum,e,"ndc",o("WASmaxInWaffleEnums").ENUM_FALSE_TRUE);if(!a.success)return a;var i=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrStringEnum,e,"npr",o("WASmaxInWaffleEnums").ENUM_FALSE_TRUE);return i.success?o("WAResultOrError").makeResult({text:n.value,code:r.value,ndc:a.value,npr:i.value}):i}l.parseIQErrorWFSuspendedMixin=e}),98);
__d("WASmaxInWaffleRSAEncryptionMetadataMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").flattenedChildWithTag(e,"encrypted_key");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"nonce");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"encrypted_data");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(e,"auth_tag");if(!a.success)return a;var i=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"version","1");if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"algorithm","rsa2048");if(!l.success)return l;var s=o("WASmaxParseUtils").contentBytesRange(t.value,1,2048);if(!s.success)return s;var u=o("WASmaxParseUtils").contentBytesRange(n.value,1,128);if(!u.success)return u;var c=o("WASmaxParseUtils").contentBytesRange(r.value,1,8192);if(!c.success)return c;var d=o("WASmaxParseUtils").contentBytesRange(a.value,1,128);return d.success?o("WAResultOrError").makeResult({version:i.value,algorithm:l.value,encryptedKeyElementValue:s.value,nonceElementValue:u.value,encryptedDataElementValue:c.value,authTagElementValue:d.value}):d}l.parseRSAEncryptionMetadataMixin=e}),98);
__d("WASmaxInWaffleRefreshAccessTokensErrors",["WAResultOrError","WASmaxInWaffleIQErrorBadRequestMixin","WASmaxInWaffleIQErrorConflictMixin","WASmaxInWaffleIQErrorInternalServerErrorMixin","WASmaxInWaffleIQErrorNotAllowedMixin","WASmaxInWaffleIQErrorNotAuthorizedMixin","WASmaxInWaffleIQErrorPayloadEncDecMixin","WASmaxInWaffleIQErrorRateOverlimitMixin","WASmaxInWaffleIQErrorRequestTimeoutMixin","WASmaxInWaffleIQErrorServiceUnavailableMixin","WASmaxInWaffleIQErrorWFNotAuthorizedInvalidPasswordMixin","WASmaxInWaffleIQErrorWFNotFoundMixin","WASmaxInWaffleIQErrorWFStateMismatchMixin","WASmaxInWaffleIQErrorWFSuspendedMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInWaffleIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:t.value});var n=o("WASmaxInWaffleIQErrorRequestTimeoutMixin").parseIQErrorRequestTimeoutMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorRequestTimeout",value:n.value});var r=o("WASmaxInWaffleIQErrorPayloadEncDecMixin").parseIQErrorPayloadEncDecMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"IQErrorPayloadEncDec",value:r.value});var a=o("WASmaxInWaffleIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(e);if(a.success)return o("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:a.value});var i=o("WASmaxInWaffleIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(e);if(i.success)return o("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:i.value});var l=o("WASmaxInWaffleIQErrorNotAuthorizedMixin").parseIQErrorNotAuthorizedMixin(e);if(l.success)return o("WAResultOrError").makeResult({name:"IQErrorNotAuthorized",value:l.value});var s=o("WASmaxInWaffleIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(e);if(s.success)return o("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:s.value});var u=o("WASmaxInWaffleIQErrorNotAllowedMixin").parseIQErrorNotAllowedMixin(e);if(u.success)return o("WAResultOrError").makeResult({name:"IQErrorNotAllowed",value:u.value});var c=o("WASmaxInWaffleIQErrorConflictMixin").parseIQErrorConflictMixin(e);if(c.success)return o("WAResultOrError").makeResult({name:"IQErrorConflict",value:c.value});var d=o("WASmaxInWaffleIQErrorWFNotFoundMixin").parseIQErrorWFNotFoundMixin(e);if(d.success)return o("WAResultOrError").makeResult({name:"IQErrorWFNotFound",value:d.value});var m=o("WASmaxInWaffleIQErrorWFSuspendedMixin").parseIQErrorWFSuspendedMixin(e);if(m.success)return o("WAResultOrError").makeResult({name:"IQErrorWFSuspended",value:m.value});var p=o("WASmaxInWaffleIQErrorWFStateMismatchMixin").parseIQErrorWFStateMismatchMixin(e);if(p.success)return o("WAResultOrError").makeResult({name:"IQErrorWFStateMismatch",value:p.value});var _=o("WASmaxInWaffleIQErrorWFNotAuthorizedInvalidPasswordMixin").parseIQErrorWFNotAuthorizedInvalidPasswordMixin(e);return _.success?o("WAResultOrError").makeResult({name:"IQErrorWFNotAuthorizedInvalidPassword",value:_.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorBadRequest","IQErrorRequestTimeout","IQErrorPayloadEncDec","IQErrorInternalServerError","IQErrorServiceUnavailable","IQErrorNotAuthorized","IQErrorRateOverlimit","IQErrorNotAllowed","IQErrorConflict","IQErrorWFNotFound","IQErrorWFSuspended","IQErrorWFStateMismatch","IQErrorWFNotAuthorizedInvalidPassword"],[t,n,r,a,i,l,s,u,c,d,m,p,_])}l.parseRefreshAccessTokensErrors=e}),98);
__d("WASmaxInWaffleRefreshAccessTokensResponseError",["WAResultOrError","WASmaxInWaffleIQErrorResponseMixin","WASmaxInWaffleRefreshAccessTokensErrors","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInWaffleIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInWaffleRefreshAccessTokensErrors").parseRefreshAccessTokensErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorRefreshAccessTokensErrors:i.value})):i}l.parseRefreshAccessTokensResponseError=e}),98);
__d("WASmaxInWaffleRefreshAccessTokensResponseSuccess",["WAResultOrError","WASmaxInWaffleIQResultResponseMixin","WASmaxInWaffleRSAEncryptionMetadataMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"encryption_metadata");if(!r.success)return r;var a=o("WASmaxInWaffleRSAEncryptionMetadataMixin").parseRSAEncryptionMetadataMixin(r.value);if(!a.success)return a;var i=o("WASmaxInWaffleIQResultResponseMixin").parseIQResultResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({encryptionMetadataRSAEncryptionMetadataMixin:a.value},i.value)):i}l.parseRefreshAccessTokensResponseSuccess=e}),98);
__d("WASmaxInWaffleStateExistsErrors",["WAResultOrError","WASmaxInWaffleIQErrorBadRequestMixin","WASmaxInWaffleIQErrorInternalServerErrorMixin","WASmaxInWaffleIQErrorNotAllowedMixin","WASmaxInWaffleIQErrorRateOverlimitMixin","WASmaxInWaffleIQErrorRequestTimeoutMixin","WASmaxInWaffleIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInWaffleIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:t.value});var n=o("WASmaxInWaffleIQErrorRequestTimeoutMixin").parseIQErrorRequestTimeoutMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorRequestTimeout",value:n.value});var r=o("WASmaxInWaffleIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:r.value});var a=o("WASmaxInWaffleIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(e);if(a.success)return o("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:a.value});var i=o("WASmaxInWaffleIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(e);if(i.success)return o("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:i.value});var l=o("WASmaxInWaffleIQErrorNotAllowedMixin").parseIQErrorNotAllowedMixin(e);return l.success?o("WAResultOrError").makeResult({name:"IQErrorNotAllowed",value:l.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorBadRequest","IQErrorRequestTimeout","IQErrorInternalServerError","IQErrorServiceUnavailable","IQErrorRateOverlimit","IQErrorNotAllowed"],[t,n,r,a,i,l])}l.parseStateExistsErrors=e}),98);
__d("WASmaxInWaffleStateExistsResponseError",["WAResultOrError","WASmaxInWaffleIQErrorResponseMixin","WASmaxInWaffleStateExistsErrors","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInWaffleIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInWaffleStateExistsErrors").parseStateExistsErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorStateExistsErrors:i.value})):i}l.parseStateExistsResponseError=e}),98);
__d("WASmaxInWaffleStateExistsResponseSuccess",["WAResultOrError","WASmaxInWaffleEnums","WASmaxInWaffleIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"suspended_state");if(!t.success)return t;var n=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrStringEnum,e,"npr",o("WASmaxInWaffleEnums").ENUM_FALSE_TRUE);return n.success?o("WAResultOrError").makeResult({npr:n.value}):n}function s(t,n){var r=o("WASmaxParseUtils").assertTag(t,"iq");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(t,"wf_state");if(!a.success)return a;var i=o("WASmaxParseUtils").optionalChildWithTag(t,"suspended_state",e);if(!i.success)return i;var l=o("WASmaxParseUtils").contentInt(a.value);if(!l.success)return l;var s=o("WASmaxInWaffleIQResultResponseMixin").parseIQResultResponseMixin(t,n);return s.success?o("WAResultOrError").makeResult(babelHelpers.extends({wfStateElementValue:l.value},s.value,{suspendedState:i.value})):s}l.parseStateExistsResponseSuccessSuspendedState=e,l.parseStateExistsResponseSuccess=s}),98);
__d("WASmaxInWaffleWfPingErrors",["WAResultOrError","WASmaxInWaffleIQErrorBadRequestMixin","WASmaxInWaffleIQErrorConflictMixin","WASmaxInWaffleIQErrorInternalServerErrorMixin","WASmaxInWaffleIQErrorNotAllowedMixin","WASmaxInWaffleIQErrorNotAuthorizedMixin","WASmaxInWaffleIQErrorPayloadEncDecMixin","WASmaxInWaffleIQErrorRateOverlimitMixin","WASmaxInWaffleIQErrorRequestTimeoutMixin","WASmaxInWaffleIQErrorServiceUnavailableMixin","WASmaxInWaffleIQErrorWFNotFoundMixin","WASmaxInWaffleIQErrorWFStateMismatchMixin","WASmaxInWaffleIQErrorWFSuspendedMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInWaffleIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:t.value});var n=o("WASmaxInWaffleIQErrorRequestTimeoutMixin").parseIQErrorRequestTimeoutMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorRequestTimeout",value:n.value});var r=o("WASmaxInWaffleIQErrorPayloadEncDecMixin").parseIQErrorPayloadEncDecMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"IQErrorPayloadEncDec",value:r.value});var a=o("WASmaxInWaffleIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(e);if(a.success)return o("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:a.value});var i=o("WASmaxInWaffleIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(e);if(i.success)return o("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:i.value});var l=o("WASmaxInWaffleIQErrorNotAuthorizedMixin").parseIQErrorNotAuthorizedMixin(e);if(l.success)return o("WAResultOrError").makeResult({name:"IQErrorNotAuthorized",value:l.value});var s=o("WASmaxInWaffleIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(e);if(s.success)return o("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:s.value});var u=o("WASmaxInWaffleIQErrorNotAllowedMixin").parseIQErrorNotAllowedMixin(e);if(u.success)return o("WAResultOrError").makeResult({name:"IQErrorNotAllowed",value:u.value});var c=o("WASmaxInWaffleIQErrorConflictMixin").parseIQErrorConflictMixin(e);if(c.success)return o("WAResultOrError").makeResult({name:"IQErrorConflict",value:c.value});var d=o("WASmaxInWaffleIQErrorWFNotFoundMixin").parseIQErrorWFNotFoundMixin(e);if(d.success)return o("WAResultOrError").makeResult({name:"IQErrorWFNotFound",value:d.value});var m=o("WASmaxInWaffleIQErrorWFSuspendedMixin").parseIQErrorWFSuspendedMixin(e);if(m.success)return o("WAResultOrError").makeResult({name:"IQErrorWFSuspended",value:m.value});var p=o("WASmaxInWaffleIQErrorWFStateMismatchMixin").parseIQErrorWFStateMismatchMixin(e);return p.success?o("WAResultOrError").makeResult({name:"IQErrorWFStateMismatch",value:p.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorBadRequest","IQErrorRequestTimeout","IQErrorPayloadEncDec","IQErrorInternalServerError","IQErrorServiceUnavailable","IQErrorNotAuthorized","IQErrorRateOverlimit","IQErrorNotAllowed","IQErrorConflict","IQErrorWFNotFound","IQErrorWFSuspended","IQErrorWFStateMismatch"],[t,n,r,a,i,l,s,u,c,d,m,p])}l.parseWfPingErrors=e}),98);
__d("WASmaxInWaffleWFPingResponseError",["WAResultOrError","WASmaxInWaffleIQErrorResponseMixin","WASmaxInWaffleWfPingErrors","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInWaffleIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInWaffleWfPingErrors").parseWfPingErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorWfPingErrors:i.value})):i}l.parseWFPingResponseError=e}),98);
__d("WASmaxInWaffleWFPingResponseSuccess",["WAResultOrError","WASmaxInWaffleIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"ping_interval");if(!r.success)return r;var a=o("WASmaxParseUtils").contentInt(r.value);if(!a.success)return a;var i=o("WASmaxInWaffleIQResultResponseMixin").parseIQResultResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({pingIntervalElementValue:a.value},i.value)):i}l.parseWFPingResponseSuccess=e}),98);
__d("WASmaxOutMessagePublishNewsletterPollVoteMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypePollVoteMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.voteElementValue,n=o("WASmaxJsx").smax("vote",null,t);return n}function s(t){var n=t.voteArgs,r=o("WASmaxOutMessagePublishContentTypePollVoteMixin").mergeContentTypePollVoteMixin(o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("votes",null,o("WASmaxChildren").REPEATED_CHILD(e,n,0,1e3))),t);return r}function u(e,t){var n=s(t);return o("WASmaxMixins").mergeStanzas(e,n)}l.makeNewsletterPollVoteVotesVote=e,l.mergeNewsletterPollVoteMixin=u}),98);
__d("WASmaxOutMessagePublishPayloadMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.plaintextElementValue,n=o("WASmaxJsx").smax("plaintext",null,t);return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergePayloadMixin=s}),98);
__d("WASmaxOutMessagePublishQuestionTypeResponseMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("meta",{questiontype:"response"}));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeQuestionTypeResponseMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterQuestionResponsePublishMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeTextMixin","WASmaxOutMessagePublishPayloadMixin","WASmaxOutMessagePublishQuestionTypeResponseMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.payloadMixinArgs,n=o("WASmaxOutMessagePublishQuestionTypeResponseMixin").mergeQuestionTypeResponseMixin(o("WASmaxOutMessagePublishContentTypeTextMixin").mergeContentTypeTextMixin(o("WASmaxJsx").smax("message",null,o("WASmaxOutMessagePublishPayloadMixin").mergePayloadMixin(o("WASmaxJsx").smax("plaintext",null),t))));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterQuestionResponsePublishMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterReactionMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeReactionMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.reactionCode,n=o("WASmaxOutMessagePublishContentTypeReactionMixin").mergeContentTypeReactionMixin(o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("reaction",{code:o("WAWap").CUSTOM_STRING(t)})));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterReactionMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterReactionRevokeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeReactionMixin","WASmaxOutMessagePublishRevokeMixin"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxOutMessagePublishContentTypeReactionMixin").mergeContentTypeReactionMixin(o("WASmaxOutMessagePublishRevokeMixin").mergeRevokeMixin(o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("reaction",null))));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeNewsletterReactionRevokeMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishNewsletterPollVoteMixin","WASmaxOutMessagePublishNewsletterQuestionResponsePublishMixin","WASmaxOutMessagePublishNewsletterReactionMixin","WASmaxOutMessagePublishNewsletterReactionRevokeMixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.newsletterQuestionResponsePublish)return o("WASmaxOutMessagePublishNewsletterQuestionResponsePublishMixin").mergeNewsletterQuestionResponsePublishMixin(e,t.newsletterQuestionResponsePublish);if(t.newsletterReaction)return o("WASmaxOutMessagePublishNewsletterReactionMixin").mergeNewsletterReactionMixin(e,t.newsletterReaction);if(t.isNewsletterReactionRevoke)return o("WASmaxOutMessagePublishNewsletterReactionRevokeMixin").mergeNewsletterReactionRevokeMixin(e);if(t.newsletterPollVote)return o("WASmaxOutMessagePublishNewsletterPollVoteMixin").mergeNewsletterPollVoteMixin(e,t.newsletterPollVote);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeNewsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroup=e}),98);
__d("WASmaxOutMessagePublishNewsletterClientAndServerIDMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishNewsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroup","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.messageId,n=e.messageServerId,r=e.newsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroupArgs,a=o("WASmaxOutMessagePublishNewsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroup").mergeNewsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroup(o("WASmaxJsx").smax("message",{id:o("WAWap").STANZA_ID(t),server_id:o("WAWap").INT(n)}),r);return a}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterClientAndServerIDMixin=s}),98);
__d("WASmaxOutMessagePublishAdminEditMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",{edit:"3"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeAdminEditMixin=s}),98);
__d("WASmaxOutMessagePublishMediaMetaMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.metaContenttype,n=o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("meta",{contenttype:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,t)}));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeMediaMetaMixin=s}),98);
__d("WASmaxOutMessagePublishWAMOSubMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("meta",{is_wamo_sub:"true"}));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeWAMOSubMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterMediaMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaMixin","WASmaxOutMessagePublishMediaMetaMixin","WASmaxOutMessagePublishMessageAssociationTypeMixin","WASmaxOutMessagePublishPayloadMixin","WASmaxOutMessagePublishWAMOSubMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.hasWAMOSub,n=e.messageAssociationTypeMixinArgs,r=e.mediaMetaMixinArgs,a=e.plaintextMediatype,i=e.payloadMixinArgs,l=o("WASmaxMixins").optionalMerge(o("WASmaxOutMessagePublishMediaMetaMixin").mergeMediaMetaMixin,o("WASmaxMixins").optionalMerge(o("WASmaxOutMessagePublishMessageAssociationTypeMixin").mergeMessageAssociationTypeMixin,o("WASmaxMixins").optionalMerge(o("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,o("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(o("WASmaxJsx").smax("message",null,o("WASmaxOutMessagePublishPayloadMixin").mergePayloadMixin(o("WASmaxJsx").smax("plaintext",{mediatype:o("WAWap").CUSTOM_STRING(a)}),i))),t),n),r);return l}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterMediaMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterTextMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeTextMixin","WASmaxOutMessagePublishPayloadMixin","WASmaxOutMessagePublishWAMOSubMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.hasWAMOSub,n=e.payloadMixinArgs,r=o("WASmaxMixins").optionalMerge(o("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,o("WASmaxOutMessagePublishContentTypeTextMixin").mergeContentTypeTextMixin(o("WASmaxJsx").smax("message",null,o("WASmaxOutMessagePublishPayloadMixin").mergePayloadMixin(o("WASmaxJsx").smax("plaintext",null),n))),t);return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterTextMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterTextOrMediaMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishNewsletterMediaMixin","WASmaxOutMessagePublishNewsletterTextMixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.newsletterText)return o("WASmaxOutMessagePublishNewsletterTextMixin").mergeNewsletterTextMixin(e,t.newsletterText);if(t.newsletterMedia)return o("WASmaxOutMessagePublishNewsletterMediaMixin").mergeNewsletterMediaMixin(e,t.newsletterMedia);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeNewsletterTextOrMediaMixinGroup=e}),98);
__d("WASmaxOutMessagePublishQuestionTypeReplyMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("meta",{questiontype:"reply"}));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeQuestionTypeReplyMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterQuestionReplyMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishNewsletterTextOrMediaMixinGroup","WASmaxOutMessagePublishQuestionTypeReplyMixin","WASmaxOutMessagePublishWAMOSubMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.hasWAMOSub,n=e.newsletterTextOrMediaMixinGroupArgs,r=o("WASmaxOutMessagePublishNewsletterTextOrMediaMixinGroup").mergeNewsletterTextOrMediaMixinGroup(o("WASmaxMixins").optionalMerge(o("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,o("WASmaxOutMessagePublishQuestionTypeReplyMixin").mergeQuestionTypeReplyMixin(o("WASmaxJsx").smax("message",null)),t),n);return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterQuestionReplyMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterQuestionReplyOrTextOrMediaMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishNewsletterMediaMixin","WASmaxOutMessagePublishNewsletterQuestionReplyMixin","WASmaxOutMessagePublishNewsletterTextMixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.newsletterQuestionReply)return o("WASmaxOutMessagePublishNewsletterQuestionReplyMixin").mergeNewsletterQuestionReplyMixin(e,t.newsletterQuestionReply);if(t.newsletterText)return o("WASmaxOutMessagePublishNewsletterTextMixin").mergeNewsletterTextMixin(e,t.newsletterText);if(t.newsletterMedia)return o("WASmaxOutMessagePublishNewsletterMediaMixin").mergeNewsletterMediaMixin(e,t.newsletterMedia);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeNewsletterQuestionReplyOrTextOrMediaMixinGroup=e}),98);
__d("WASmaxOutMessagePublishNewsletterEditMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishAdminEditMixin","WASmaxOutMessagePublishNewsletterQuestionReplyOrTextOrMediaMixinGroup","WASmaxOutMessagePublishWAMOSubMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.hasWAMOSub,n=e.newsletterQuestionReplyOrTextOrMediaMixinGroupArgs,r=o("WASmaxOutMessagePublishNewsletterQuestionReplyOrTextOrMediaMixinGroup").mergeNewsletterQuestionReplyOrTextOrMediaMixinGroup(o("WASmaxMixins").optionalMerge(o("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,o("WASmaxOutMessagePublishAdminEditMixin").mergeAdminEditMixin(o("WASmaxJsx").smax("message",null)),t),n);return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterEditMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterMediaPublishMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishNewsletterMediaMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.messageMediaId,n=o("WASmaxOutMessagePublishNewsletterMediaMixin").mergeNewsletterMediaMixin(o("WASmaxJsx").smax("message",{media_id:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,t)}),e);return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterMediaPublishMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterPollCreationMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypePollCreationMixin","WASmaxOutMessagePublishPayloadMixin","WASmaxOutMessagePublishWAMOSubMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.hasWAMOSub,n=e.payloadMixinArgs,r=o("WASmaxMixins").optionalMerge(o("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,o("WASmaxOutMessagePublishContentTypePollCreationMixin").mergeContentTypePollCreationMixin(o("WASmaxJsx").smax("message",null,o("WASmaxOutMessagePublishPayloadMixin").mergePayloadMixin(o("WASmaxJsx").smax("plaintext",null),n)),e),t);return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterPollCreationMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterPollResultSnapshotMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypePollResultSnapshotMixin","WASmaxOutMessagePublishPayloadMixin","WASmaxOutMessagePublishWAMOSubMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.hasWAMOSub,n=e.payloadMixinArgs,r=o("WASmaxMixins").optionalMerge(o("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,o("WASmaxOutMessagePublishContentTypePollResultSnapshotMixin").mergeContentTypePollResultSnapshotMixin(o("WASmaxJsx").smax("message",null,o("WASmaxOutMessagePublishPayloadMixin").mergePayloadMixin(o("WASmaxJsx").smax("plaintext",null),n))),t);return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterPollResultSnapshotMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterTextOrMediaPublishMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishNewsletterMediaPublishMixin","WASmaxOutMessagePublishNewsletterTextMixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.newsletterText)return o("WASmaxOutMessagePublishNewsletterTextMixin").mergeNewsletterTextMixin(e,t.newsletterText);if(t.newsletterMediaPublish)return o("WASmaxOutMessagePublishNewsletterMediaPublishMixin").mergeNewsletterMediaPublishMixin(e,t.newsletterMediaPublish);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeNewsletterTextOrMediaPublishMixinGroup=e}),98);
__d("WASmaxOutMessagePublishQuestionTypeQuestionMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("meta",{questiontype:"question"}));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeQuestionTypeQuestionMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterQuestionPublishMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishNewsletterTextOrMediaPublishMixinGroup","WASmaxOutMessagePublishQuestionTypeQuestionMixin","WASmaxOutMessagePublishWAMOSubMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.hasWAMOSub,n=e.newsletterTextOrMediaPublishMixinGroupArgs,r=o("WASmaxOutMessagePublishNewsletterTextOrMediaPublishMixinGroup").mergeNewsletterTextOrMediaPublishMixinGroup(o("WASmaxMixins").optionalMerge(o("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,o("WASmaxOutMessagePublishQuestionTypeQuestionMixin").mergeQuestionTypeQuestionMixin(o("WASmaxJsx").smax("message",null)),t),n);return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterQuestionPublishMixin=s}),98);
__d("WASmaxOutMessagePublishParentAndResponseServerIDMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.metaParentServerId,n=e.metaResponseServerId,r=o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("meta",{parent_server_id:o("WAWap").INT(t),response_server_id:o("WAWap").CUSTOM_STRING(n)}));return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeParentAndResponseServerIDMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterQuestionReplyPublishMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishNewsletterTextOrMediaPublishMixinGroup","WASmaxOutMessagePublishParentAndResponseServerIDMixin","WASmaxOutMessagePublishQuestionTypeReplyMixin","WASmaxOutMessagePublishWAMOSubMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.hasWAMOSub,n=e.newsletterTextOrMediaPublishMixinGroupArgs,r=o("WASmaxOutMessagePublishNewsletterTextOrMediaPublishMixinGroup").mergeNewsletterTextOrMediaPublishMixinGroup(o("WASmaxMixins").optionalMerge(o("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,o("WASmaxOutMessagePublishParentAndResponseServerIDMixin").mergeParentAndResponseServerIDMixin(o("WASmaxOutMessagePublishQuestionTypeReplyMixin").mergeQuestionTypeReplyMixin(o("WASmaxJsx").smax("message",null)),e),t),n);return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterQuestionReplyPublishMixin=s}),98);
__d("WASmaxOutMessagePublishContentTypeQuizCreationMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.metaContenttype,n=o("WASmaxJsx").smax("message",{type:"poll"},o("WASmaxJsx").smax("meta",{polltype:"quiz_creation",contenttype:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,t)}));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeContentTypeQuizCreationMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterQuizCreationMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeQuizCreationMixin","WASmaxOutMessagePublishPayloadMixin","WASmaxOutMessagePublishWAMOSubMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.hasWAMOSub,n=e.payloadMixinArgs,r=o("WASmaxMixins").optionalMerge(o("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,o("WASmaxOutMessagePublishContentTypeQuizCreationMixin").mergeContentTypeQuizCreationMixin(o("WASmaxJsx").smax("message",null,o("WASmaxOutMessagePublishPayloadMixin").mergePayloadMixin(o("WASmaxJsx").smax("plaintext",null),n)),e),t);return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterQuizCreationMixin=s}),98);
__d("WASmaxOutMessagePublishAdminRevokeMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",{edit:"8"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeAdminRevokeMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterRevokeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishAdminRevokeMixin","WASmaxOutMessagePublishContentTypeTextMixin","WASmaxOutMessagePublishWAMOSubMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.hasWAMOSub,n=o("WASmaxMixins").optionalMerge(o("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,o("WASmaxOutMessagePublishContentTypeTextMixin").mergeContentTypeTextMixin(o("WASmaxOutMessagePublishAdminRevokeMixin").mergeAdminRevokeMixin(o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("plaintext",null)))),t);return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterRevokeMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterClientIdContent",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishNewsletterEditMixin","WASmaxOutMessagePublishNewsletterMediaPublishMixin","WASmaxOutMessagePublishNewsletterPollCreationMixin","WASmaxOutMessagePublishNewsletterPollResultSnapshotMixin","WASmaxOutMessagePublishNewsletterQuestionPublishMixin","WASmaxOutMessagePublishNewsletterQuestionReplyPublishMixin","WASmaxOutMessagePublishNewsletterQuizCreationMixin","WASmaxOutMessagePublishNewsletterRevokeMixin","WASmaxOutMessagePublishNewsletterTextMixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.newsletterEdit)return o("WASmaxOutMessagePublishNewsletterEditMixin").mergeNewsletterEditMixin(e,t.newsletterEdit);if(t.newsletterQuestionPublish)return o("WASmaxOutMessagePublishNewsletterQuestionPublishMixin").mergeNewsletterQuestionPublishMixin(e,t.newsletterQuestionPublish);if(t.newsletterQuestionReplyPublish)return o("WASmaxOutMessagePublishNewsletterQuestionReplyPublishMixin").mergeNewsletterQuestionReplyPublishMixin(e,t.newsletterQuestionReplyPublish);if(t.newsletterText)return o("WASmaxOutMessagePublishNewsletterTextMixin").mergeNewsletterTextMixin(e,t.newsletterText);if(t.newsletterMediaPublish)return o("WASmaxOutMessagePublishNewsletterMediaPublishMixin").mergeNewsletterMediaPublishMixin(e,t.newsletterMediaPublish);if(t.newsletterRevoke)return o("WASmaxOutMessagePublishNewsletterRevokeMixin").mergeNewsletterRevokeMixin(e,t.newsletterRevoke);if(t.newsletterPollCreation)return o("WASmaxOutMessagePublishNewsletterPollCreationMixin").mergeNewsletterPollCreationMixin(e,t.newsletterPollCreation);if(t.newsletterPollResultSnapshot)return o("WASmaxOutMessagePublishNewsletterPollResultSnapshotMixin").mergeNewsletterPollResultSnapshotMixin(e,t.newsletterPollResultSnapshot);if(t.newsletterQuizCreation)return o("WASmaxOutMessagePublishNewsletterQuizCreationMixin").mergeNewsletterQuizCreationMixin(e,t.newsletterQuizCreation);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeNewsletterClientIdContent=e}),98);
__d("WASmaxOutMessagePublishSenderContentTypeMediaRCATMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.plaintextContentId,n=o("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("plaintext",{mediatype:"url",content_id:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,t)})));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeSenderContentTypeMediaRCATMixin=s}),98);
__d("WASmaxOutMessagePublishNewsletterClientIDMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishMsgMetaOriginMixin","WASmaxOutMessagePublishNewsletterClientIdContent","WASmaxOutMessagePublishSenderContentTypeMediaRCATMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.messageId,n=e.msgMetaOriginMixinArgs,r=e.senderContentTypeMediaRCATMixinArgs,a=e.newsletterClientIdContentArgs,i=o("WASmaxOutMessagePublishNewsletterClientIdContent").mergeNewsletterClientIdContent(o("WASmaxMixins").optionalMerge(o("WASmaxOutMessagePublishSenderContentTypeMediaRCATMixin").mergeSenderContentTypeMediaRCATMixin,o("WASmaxMixins").optionalMerge(o("WASmaxOutMessagePublishMsgMetaOriginMixin").mergeMsgMetaOriginMixin,o("WASmaxJsx").smax("message",{id:o("WAWap").STANZA_ID(t)}),n),r),a);return i}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterClientIDMixin=s}),98);
__d("WASmaxOutMessagePublishClientNewsletterAndServerOrNewsletterIDMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishNewsletterClientAndServerIDMixin","WASmaxOutMessagePublishNewsletterClientIDMixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.newsletterClientAndServerID)return o("WASmaxOutMessagePublishNewsletterClientAndServerIDMixin").mergeNewsletterClientAndServerIDMixin(e,t.newsletterClientAndServerID);if(t.newsletterClientID)return o("WASmaxOutMessagePublishNewsletterClientIDMixin").mergeNewsletterClientIDMixin(e,t.newsletterClientID);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeClientNewsletterAndServerOrNewsletterIDMixinGroup=e}),98);
__d("WASmaxOutMessagePublishNewsletterRequest",["WASmaxJsx","WASmaxOutMessagePublishClientNewsletterAndServerOrNewsletterIDMixinGroup","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.messageTo,n=e.clientNewsletterAndServerOrNewsletterIDMixinGroupArgs,r=o("WASmaxOutMessagePublishClientNewsletterAndServerOrNewsletterIDMixinGroup").mergeClientNewsletterAndServerOrNewsletterIDMixinGroup(o("WASmaxJsx").smax("message",{to:o("WAWap").JID(t)}),n);return r}l.makeNewsletterRequest=e}),98);
__d("WASmaxMessagePublishNewsletterRPC",["WAComms","WASmaxInMessagePublishNewsletterResponseNegative","WASmaxInMessagePublishNewsletterResponseSuccess","WASmaxOutMessagePublishNewsletterRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutMessagePublishNewsletterRequest").makeNewsletterRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInMessagePublishNewsletterResponseNegative").parseNewsletterResponseNegative(r,n);if(a.success)return{name:"NewsletterResponseNegative",value:a.value};var i=o("WASmaxInMessagePublishNewsletterResponseSuccess").parseNewsletterResponseSuccess(r,n);if(i.success)return{name:"NewsletterResponseSuccess",value:i.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("Newsletter",{Negative:a,Success:i}))}),s.apply(this,arguments)}l.sendNewsletterRPC=e}),98);
__d("WASmaxOutNewslettersNewsletterCreationTimeFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("metadata",null,o("WASmaxJsx").smax("creation_time",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeNewsletterCreationTimeFieldMixin=s}),98);
__d("WASmaxOutNewslettersNewsletterDescriptionFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("metadata",null,o("WASmaxJsx").smax("description",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeNewsletterDescriptionFieldMixin=s}),98);
__d("WASmaxOutNewslettersNewsletterHandleFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("metadata",null,o("WASmaxJsx").smax("handle",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeNewsletterHandleFieldMixin=s}),98);
__d("WASmaxOutNewslettersNewsletterIDFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("metadata",null,o("WASmaxJsx").smax("id",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeNewsletterIDFieldMixin=s}),98);
__d("WASmaxOutNewslettersNewsletterInviteLinkFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("metadata",null,o("WASmaxJsx").smax("invite",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeNewsletterInviteLinkFieldMixin=s}),98);
__d("WASmaxOutNewslettersNewsletterLinkedAccountsFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("metadata",null,o("WASmaxJsx").smax("linked_accounts",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeNewsletterLinkedAccountsFieldMixin=s}),98);
__d("WASmaxOutNewslettersNewsletterMembershipFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("metadata",null,o("WASmaxJsx").smax("membership",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeNewsletterMembershipFieldMixin=s}),98);
__d("WASmaxOutNewslettersNewsletterMutedFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("metadata",null,o("WASmaxJsx").smax("muted",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeNewsletterMutedFieldMixin=s}),98);
__d("WASmaxOutNewslettersNewsletterNameFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("metadata",null,o("WASmaxJsx").smax("name",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeNewsletterNameFieldMixin=s}),98);
__d("WASmaxOutNewslettersBaseNewsletterPictureFieldMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.pictureId,n=o("WASmaxJsx").smax("picture",{id:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,t),query:"direct_path"});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeBaseNewsletterPictureFieldMixin=s}),98);
__d("WASmaxOutNewslettersNewsletterPictureFieldMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersBaseNewsletterPictureFieldMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.pictureType,n=o("WASmaxOutNewslettersBaseNewsletterPictureFieldMixin").mergeBaseNewsletterPictureFieldMixin(o("WASmaxJsx").smax("picture",{type:o("WAWap").CUSTOM_STRING(t)}),e);return n}function s(t){var n=t.pictureArgs,r=o("WASmaxJsx").smax("metadata",null,o("WASmaxChildren").REPEATED_CHILD(e,n,0,2));return r}function u(e,t){var n=s(t);return o("WASmaxMixins").mergeStanzas(e,n)}l.makeNewsletterPictureFieldPicture=e,l.mergeNewsletterPictureFieldMixin=u}),98);
__d("WASmaxOutNewslettersNewsletterPrivacyFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("metadata",null,o("WASmaxJsx").smax("privacy",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeNewsletterPrivacyFieldMixin=s}),98);
__d("WASmaxOutNewslettersNewsletterStateFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("metadata",null,o("WASmaxJsx").smax("state",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeNewsletterStateFieldMixin=s}),98);
__d("WASmaxOutNewslettersNewsletterSubscribersFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("metadata",null,o("WASmaxJsx").smax("subscribers",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeNewsletterSubscribersFieldMixin=s}),98);
__d("WASmaxOutNewslettersNewsletterVerificationFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("metadata",null,o("WASmaxJsx").smax("verification",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeNewsletterVerificationFieldMixin=s}),98);
__d("WASmaxOutNewslettersAllNewsletterMetadataIQRequestPayloadMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersNewsletterCreationTimeFieldMixin","WASmaxOutNewslettersNewsletterDescriptionFieldMixin","WASmaxOutNewslettersNewsletterHandleFieldMixin","WASmaxOutNewslettersNewsletterIDFieldMixin","WASmaxOutNewslettersNewsletterInviteLinkFieldMixin","WASmaxOutNewslettersNewsletterLinkedAccountsFieldMixin","WASmaxOutNewslettersNewsletterMembershipFieldMixin","WASmaxOutNewslettersNewsletterMutedFieldMixin","WASmaxOutNewslettersNewsletterNameFieldMixin","WASmaxOutNewslettersNewsletterPictureFieldMixin","WASmaxOutNewslettersNewsletterPrivacyFieldMixin","WASmaxOutNewslettersNewsletterStateFieldMixin","WASmaxOutNewslettersNewsletterSubscribersFieldMixin","WASmaxOutNewslettersNewsletterVerificationFieldMixin"],(function(t,n,r,o,a,i,l){function e(e){var t,n=e.hasNewsletterCreationTimeField,r=e.hasNewsletterNameField,a=e.hasNewsletterDescriptionField,i=e.hasNewsletterInviteLinkField,l=e.hasNewsletterHandleField,s=e.hasNewsletterSubscribersField,u=e.hasNewsletterPrivacyField,c=e.hasNewsletterVerificationField,d=e.hasNewsletterLinkedAccountsField,m=e.hasNewsletterStateField,p=e.newsletterPictureFieldMixinArgs,_=e.hasNewsletterMembershipField,f=e.hasNewsletterMutedField,g=(t=o("WASmaxMixins")).optionalMerge(o("WASmaxOutNewslettersNewsletterMutedFieldMixin").mergeNewsletterMutedFieldMixin,t.optionalMerge(o("WASmaxOutNewslettersNewsletterMembershipFieldMixin").mergeNewsletterMembershipFieldMixin,t.optionalMerge(o("WASmaxOutNewslettersNewsletterPictureFieldMixin").mergeNewsletterPictureFieldMixin,t.optionalMerge(o("WASmaxOutNewslettersNewsletterStateFieldMixin").mergeNewsletterStateFieldMixin,t.optionalMerge(o("WASmaxOutNewslettersNewsletterLinkedAccountsFieldMixin").mergeNewsletterLinkedAccountsFieldMixin,t.optionalMerge(o("WASmaxOutNewslettersNewsletterVerificationFieldMixin").mergeNewsletterVerificationFieldMixin,t.optionalMerge(o("WASmaxOutNewslettersNewsletterPrivacyFieldMixin").mergeNewsletterPrivacyFieldMixin,t.optionalMerge(o("WASmaxOutNewslettersNewsletterSubscribersFieldMixin").mergeNewsletterSubscribersFieldMixin,t.optionalMerge(o("WASmaxOutNewslettersNewsletterHandleFieldMixin").mergeNewsletterHandleFieldMixin,t.optionalMerge(o("WASmaxOutNewslettersNewsletterInviteLinkFieldMixin").mergeNewsletterInviteLinkFieldMixin,t.optionalMerge(o("WASmaxOutNewslettersNewsletterDescriptionFieldMixin").mergeNewsletterDescriptionFieldMixin,t.optionalMerge(o("WASmaxOutNewslettersNewsletterNameFieldMixin").mergeNewsletterNameFieldMixin,t.optionalMerge(o("WASmaxOutNewslettersNewsletterCreationTimeFieldMixin").mergeNewsletterCreationTimeFieldMixin,o("WASmaxOutNewslettersNewsletterIDFieldMixin").mergeNewsletterIDFieldMixin(o("WASmaxJsx").smax("metadata",null)),n),r),a),i),l),s),u),c),d),m),p),_),f);return g}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeAllNewsletterMetadataIQRequestPayloadMixin=s}),98);
__d("WASmaxOutNewslettersSetNameMixinMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.nameElementValue,n=o("WASmaxJsx").smax("metadata",null,o("WASmaxJsx").smax("name",null,t));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeSetNameMixinMixin=s}),98);
__d("WASmaxOutNewslettersSetNewDescriptionMixinMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.descriptionElementValue,n=o("WASmaxJsx").smax("metadata",null,o("WASmaxJsx").smax("description",null,t));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeSetNewDescriptionMixinMixin=s}),98);
__d("WASmaxOutNewslettersSetNewPictureMixinMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.pictureElementValue,n=o("WASmaxJsx").smax("metadata",null,o("WASmaxJsx").smax("picture",null,t));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeSetNewPictureMixinMixin=s}),98);
__d("WASmaxOutNewslettersCreateRequestMixinMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersAllNewsletterMetadataIQRequestPayloadMixin","WASmaxOutNewslettersSetNameMixinMixin","WASmaxOutNewslettersSetNewDescriptionMixinMixin","WASmaxOutNewslettersSetNewPictureMixinMixin"],(function(t,n,r,o,a,i,l){function e(e){var t,n=e.setNameMixinMixinArgs,r=e.setNewDescriptionMixinMixinArgs,a=e.setNewPictureMixinMixinArgs,i=e.allNewsletterMetadataIQRequestPayloadMixinArgs,l=(t=o("WASmaxJsx")).smax("create",null,o("WASmaxMixins").optionalMerge(o("WASmaxOutNewslettersSetNewPictureMixinMixin").mergeSetNewPictureMixinMixin,o("WASmaxMixins").optionalMerge(o("WASmaxOutNewslettersSetNewDescriptionMixinMixin").mergeSetNewDescriptionMixinMixin,o("WASmaxOutNewslettersSetNameMixinMixin").mergeSetNameMixinMixin(t.smax("metadata",null),n),r),a),t.smax("query",null,o("WASmaxOutNewslettersAllNewsletterMetadataIQRequestPayloadMixin").mergeAllNewsletterMetadataIQRequestPayloadMixin(t.smax("metadata",null),i)));return l}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeCreateRequestMixinMixin=s}),98);
__d("WASmaxOutNewslettersBaseIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"set"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBaseIQSetRequestMixin=s}),98);
__d("WASmaxOutNewslettersSelfIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersBaseIQSetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxOutNewslettersBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(o("WASmaxJsx").smax("iq",{to:o("WAWap").S_WHATSAPP_NET,xmlns:"newsletter"}));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeSelfIQSetRequestMixin=s}),98);
__d("WASmaxOutNewslettersCreateRequest",["WASmaxJsx","WASmaxOutNewslettersCreateRequestMixinMixin","WASmaxOutNewslettersSelfIQSetRequestMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.createRequestMixinMixinArgs,n=o("WASmaxOutNewslettersSelfIQSetRequestMixin").mergeSelfIQSetRequestMixin(o("WASmaxJsx").smax("iq",null,o("WASmaxOutNewslettersCreateRequestMixinMixin").mergeCreateRequestMixinMixin(o("WASmaxJsx").smax("create",null),t)));return n}l.makeCreateRequest=e}),98);
__d("WASmaxNewslettersCreateRPC",["WAComms","WASmaxInNewslettersCreateResponseClientError","WASmaxInNewslettersCreateResponseServerError","WASmaxInNewslettersCreateResponseSuccess","WASmaxOutNewslettersCreateRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutNewslettersCreateRequest").makeCreateRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInNewslettersCreateResponseSuccess").parseCreateResponseSuccess(r,n);if(a.success)return{name:"CreateResponseSuccess",value:a.value};var i=o("WASmaxInNewslettersCreateResponseClientError").parseCreateResponseClientError(r,n);if(i.success)return{name:"CreateResponseClientError",value:i.value};var l=o("WASmaxInNewslettersCreateResponseServerError").parseCreateResponseServerError(r,n);if(l.success)return{name:"CreateResponseServerError",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("Create",{Success:a,ClientError:i,ServerError:l}))}),s.apply(this,arguments)}l.sendCreateRPC=e}),98);
__d("WASmaxOutNewslettersMessageUpdatesAfterMixinMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.messageUpdatesAfter,n=o("WASmaxJsx").smax("message_updates",{after:o("WAWap").INT(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeMessageUpdatesAfterMixinMixin=s}),98);
__d("WASmaxOutNewslettersMessageUpdatesBeforeMixinMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.messageUpdatesBefore,n=o("WASmaxJsx").smax("message_updates",{before:o("WAWap").INT(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeMessageUpdatesBeforeMixinMixin=s}),98);
__d("WASmaxOutNewslettersMessageUpdatesBeforeOrAfterMixinMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutNewslettersMessageUpdatesAfterMixinMixin","WASmaxOutNewslettersMessageUpdatesBeforeMixinMixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.messageUpdatesBeforeMixin)return o("WASmaxOutNewslettersMessageUpdatesBeforeMixinMixin").mergeMessageUpdatesBeforeMixinMixin(e,t.messageUpdatesBeforeMixin);if(t.messageUpdatesAfterMixin)return o("WASmaxOutNewslettersMessageUpdatesAfterMixinMixin").mergeMessageUpdatesAfterMixinMixin(e,t.messageUpdatesAfterMixin);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeMessageUpdatesBeforeOrAfterMixinMixinGroup=e}),98);
__d("WASmaxOutNewslettersBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"get"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBaseIQGetRequestMixin=s}),98);
__d("WASmaxOutNewslettersNewsletterIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersBaseIQGetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.iqTo,n=o("WASmaxOutNewslettersBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(o("WASmaxJsx").smax("iq",{to:o("WAWap").JID(t),xmlns:"newsletter"}));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterIQGetRequestMixin=s}),98);
__d("WASmaxOutNewslettersGetNewsletterMessageUpdatesRequest",["WASmaxAttrs","WASmaxJsx","WASmaxOutNewslettersMessageUpdatesBeforeOrAfterMixinMixinGroup","WASmaxOutNewslettersNewsletterIQGetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.messageUpdatesCount,n=e.messageUpdatesSince,r=e.messageUpdatesBeforeOrAfterMixinMixinGroupArgs,a=o("WASmaxOutNewslettersNewsletterIQGetRequestMixin").mergeNewsletterIQGetRequestMixin(o("WASmaxJsx").smax("iq",null,o("WASmaxOutNewslettersMessageUpdatesBeforeOrAfterMixinMixinGroup").mergeMessageUpdatesBeforeOrAfterMixinMixinGroup(o("WASmaxJsx").smax("message_updates",{count:o("WAWap").INT(t),since:o("WASmaxAttrs").OPTIONAL(o("WAWap").INT,n)}),r)),e);return a}l.makeGetNewsletterMessageUpdatesRequest=e}),98);
__d("WASmaxNewslettersGetNewsletterMessageUpdatesRPC",["WAComms","WASmaxInNewslettersGetNewsletterMessageUpdatesResponseClientError","WASmaxInNewslettersGetNewsletterMessageUpdatesResponseServerError","WASmaxInNewslettersGetNewsletterMessageUpdatesResponseSuccess","WASmaxOutNewslettersGetNewsletterMessageUpdatesRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutNewslettersGetNewsletterMessageUpdatesRequest").makeGetNewsletterMessageUpdatesRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInNewslettersGetNewsletterMessageUpdatesResponseSuccess").parseGetNewsletterMessageUpdatesResponseSuccess(r,n);if(a.success)return{name:"GetNewsletterMessageUpdatesResponseSuccess",value:a.value};var i=o("WASmaxInNewslettersGetNewsletterMessageUpdatesResponseClientError").parseGetNewsletterMessageUpdatesResponseClientError(r,n);if(i.success)return{name:"GetNewsletterMessageUpdatesResponseClientError",value:i.value};var l=o("WASmaxInNewslettersGetNewsletterMessageUpdatesResponseServerError").parseGetNewsletterMessageUpdatesResponseServerError(r,n);if(l.success)return{name:"GetNewsletterMessageUpdatesResponseServerError",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("GetNewsletterMessageUpdates",{Success:a,ClientError:i,ServerError:l}))}),s.apply(this,arguments)}l.sendGetNewsletterMessageUpdatesRPC=e}),98);
__d("WASmaxOutNewslettersAfterMixinMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.messagesAfter,n=o("WASmaxJsx").smax("messages",{after:o("WAWap").INT(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeAfterMixinMixin=s}),98);
__d("WASmaxOutNewslettersBeforeMixinMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.messagesBefore,n=o("WASmaxJsx").smax("messages",{before:o("WAWap").INT(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeBeforeMixinMixin=s}),98);
__d("WASmaxOutNewslettersMessageDirections",["WASmaxMixinGroupExhaustiveError","WASmaxOutNewslettersAfterMixinMixin","WASmaxOutNewslettersBeforeMixinMixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.beforeMixin)return o("WASmaxOutNewslettersBeforeMixinMixin").mergeBeforeMixinMixin(e,t.beforeMixin);if(t.afterMixin)return o("WASmaxOutNewslettersAfterMixinMixin").mergeAfterMixinMixin(e,t.afterMixin);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeMessageDirections=e}),98);
__d("WASmaxOutNewslettersNewsletterMessageRequestPayloadMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersMessageDirections","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.messagesCount,n=e.messageDirectionsArgs,r=o("WASmaxMixins").optionalMerge(o("WASmaxOutNewslettersMessageDirections").mergeMessageDirections,o("WASmaxJsx").smax("messages",{count:o("WAWap").INT(t)}),n);return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterMessageRequestPayloadMixin=s}),98);
__d("WASmaxOutNewslettersQueryNewsletterInviteParamsMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.anyKey,n=e.anyViewRole,r=o("WASmaxJsx").smax("smax$any",{type:"invite",key:o("WAWap").CUSTOM_STRING(t),view_role:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,n)});return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeQueryNewsletterInviteParamsMixin=s}),98);
__d("WASmaxOutNewslettersQueryNewsletterJIDParamsMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.anyJid,n=e.anyViewRole,r=o("WASmaxJsx").smax("smax$any",{type:"jid",jid:o("WAWap").JID(t),view_role:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,n)});return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeQueryNewsletterJIDParamsMixin=s}),98);
__d("WASmaxOutNewslettersQueryNewsletterParams",["WASmaxMixinGroupExhaustiveError","WASmaxOutNewslettersQueryNewsletterInviteParamsMixin","WASmaxOutNewslettersQueryNewsletterJIDParamsMixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.queryNewsletterJIDParams)return o("WASmaxOutNewslettersQueryNewsletterJIDParamsMixin").mergeQueryNewsletterJIDParamsMixin(e,t.queryNewsletterJIDParams);if(t.queryNewsletterInviteParams)return o("WASmaxOutNewslettersQueryNewsletterInviteParamsMixin").mergeQueryNewsletterInviteParamsMixin(e,t.queryNewsletterInviteParams);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeQueryNewsletterParams=e}),98);
__d("WASmaxOutNewslettersQueryNewsletterParamsMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersQueryNewsletterParams"],(function(t,n,r,o,a,i,l){function e(e){var t=e.queryNewsletterParamsArgs,n=o("WASmaxOutNewslettersQueryNewsletterParams").mergeQueryNewsletterParams(o("WASmaxJsx").smax("smax$any",null),t);return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeQueryNewsletterParamsMixin=s}),98);
__d("WASmaxOutNewslettersSelfIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersBaseIQGetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxOutNewslettersBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(o("WASmaxJsx").smax("iq",{to:o("WAWap").S_WHATSAPP_NET,xmlns:"newsletter"}));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeSelfIQGetRequestMixin=s}),98);
__d("WASmaxOutNewslettersNewsletterMessageRequestIQPayloadMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersNewsletterMessageRequestPayloadMixin","WASmaxOutNewslettersQueryNewsletterParamsMixin","WASmaxOutNewslettersSelfIQGetRequestMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.queryNewsletterParamsMixinArgs,n=e.newsletterMessageRequestPayloadMixinArgs,r=o("WASmaxOutNewslettersSelfIQGetRequestMixin").mergeSelfIQGetRequestMixin(o("WASmaxJsx").smax("iq",null,o("WASmaxOutNewslettersNewsletterMessageRequestPayloadMixin").mergeNewsletterMessageRequestPayloadMixin(o("WASmaxOutNewslettersQueryNewsletterParamsMixin").mergeQueryNewsletterParamsMixin(o("WASmaxJsx").smax("messages",null),t),n)));return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNewsletterMessageRequestIQPayloadMixin=s}),98);
__d("WASmaxOutNewslettersGetNewsletterMessagesRequest",["WASmaxJsx","WASmaxOutNewslettersNewsletterMessageRequestIQPayloadMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxOutNewslettersNewsletterMessageRequestIQPayloadMixin").mergeNewsletterMessageRequestIQPayloadMixin(o("WASmaxJsx").smax("iq",null),e);return t}l.makeGetNewsletterMessagesRequest=e}),98);
__d("WASmaxNewslettersGetNewsletterMessagesRPC",["WAComms","WASmaxInNewslettersGetNewsletterMessagesResponseClientError","WASmaxInNewslettersGetNewsletterMessagesResponseServerError","WASmaxInNewslettersGetNewsletterMessagesResponseSuccess","WASmaxOutNewslettersGetNewsletterMessagesRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutNewslettersGetNewsletterMessagesRequest").makeGetNewsletterMessagesRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInNewslettersGetNewsletterMessagesResponseSuccess").parseGetNewsletterMessagesResponseSuccess(r,n);if(a.success)return{name:"GetNewsletterMessagesResponseSuccess",value:a.value};var i=o("WASmaxInNewslettersGetNewsletterMessagesResponseClientError").parseGetNewsletterMessagesResponseClientError(r,n);if(i.success)return{name:"GetNewsletterMessagesResponseClientError",value:i.value};var l=o("WASmaxInNewslettersGetNewsletterMessagesResponseServerError").parseGetNewsletterMessagesResponseServerError(r,n);if(l.success)return{name:"GetNewsletterMessagesResponseServerError",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("GetNewsletterMessages",{Success:a,ClientError:i,ServerError:l}))}),s.apply(this,arguments)}l.sendGetNewsletterMessagesRPC=e}),98);
__d("WASmaxOutNewslettersMyAddOnsRequest",["WASmaxAttrs","WASmaxJsx","WASmaxOutNewslettersSelfIQGetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.myAddonsLimit,n=e.myAddonsJid,r=o("WASmaxOutNewslettersSelfIQGetRequestMixin").mergeSelfIQGetRequestMixin(o("WASmaxJsx").smax("iq",null,o("WASmaxJsx").smax("my_addons",{limit:o("WAWap").INT(t),jid:o("WASmaxAttrs").OPTIONAL(o("WAWap").JID,n)})));return r}l.makeMyAddOnsRequest=e}),98);
__d("WASmaxNewslettersMyAddOnsRPC",["WAComms","WASmaxInNewslettersMyAddOnsResponseClientError","WASmaxInNewslettersMyAddOnsResponseServerError","WASmaxInNewslettersMyAddOnsResponseSuccess","WASmaxOutNewslettersMyAddOnsRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutNewslettersMyAddOnsRequest").makeMyAddOnsRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInNewslettersMyAddOnsResponseSuccess").parseMyAddOnsResponseSuccess(r,n);if(a.success)return{name:"MyAddOnsResponseSuccess",value:a.value};var i=o("WASmaxInNewslettersMyAddOnsResponseClientError").parseMyAddOnsResponseClientError(r,n);if(i.success)return{name:"MyAddOnsResponseClientError",value:i.value};var l=o("WASmaxInNewslettersMyAddOnsResponseServerError").parseMyAddOnsResponseServerError(r,n);if(l.success)return{name:"MyAddOnsResponseServerError",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("MyAddOns",{Success:a,ClientError:i,ServerError:l}))}),s.apply(this,arguments)}l.sendMyAddOnsRPC=e}),98);
__d("WASmaxOutPreKeysFetchMissingPreKeysRequest",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxOutPreKeysClientRequestMixin","WASmaxOutPreKeysRegistrationIDMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.deviceId,n=o("WASmaxOutPreKeysRegistrationIDMixin").mergeRegistrationIDMixin(o("WASmaxJsx").smax("device",{id:o("WAWap").INT(t)}),e);return n}function s(t){var n=t.deviceArgs,r=t.userJid,a=t.hasUserReasonIdentity,i=o("WASmaxJsx").smax("user",{jid:o("WAWap").JID(r),reason:o("WASmaxAttrs").OPTIONAL_LITERAL("identity",a)},o("WASmaxChildren").REPEATED_CHILD(e,n,0,100));return i}function u(e){var t=e.userArgs,n=o("WASmaxOutPreKeysClientRequestMixin").mergeClientRequestMixin(o("WASmaxJsx").smax("iq",{type:"get"},o("WASmaxJsx").smax("key_fetch",null,o("WASmaxChildren").REPEATED_CHILD(s,t,1,1e5))));return n}l.makeFetchMissingPreKeysRequestKeyFetchUserDevice=e,l.makeFetchMissingPreKeysRequestKeyFetchUser=s,l.makeFetchMissingPreKeysRequest=u}),98);
__d("WASmaxOutPresencePrivacyTokenContentsMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.anyElementValue,n=o("WASmaxJsx").smax("smax$any",null,t);return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergePrivacyTokenContentsMixin=s}),98);
__d("WASmaxOutPresenceTCTokenMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutPresencePrivacyTokenContentsMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.tctokenT,n=e.privacyTokenContentsMixinArgs,r=o("WASmaxJsx").smax("smax$any",null,o("WASmaxOutPresencePrivacyTokenContentsMixin").mergePrivacyTokenContentsMixin(o("WASmaxJsx").smax("tctoken",{t:o("WASmaxAttrs").OPTIONAL(o("WAWap").INT,t)}),n));return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeTCTokenMixin=s}),98);
__d("WASmaxOutPresenceSubscribeRequest",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutPresenceTCTokenMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.presenceTo,n=e.presenceName,r=e.presenceContext,a=e.tCTokenMixinArgs,i=o("WASmaxMixins").optionalMerge(o("WASmaxOutPresenceTCTokenMixin").mergeTCTokenMixin,o("WASmaxJsx").smax("presence",{type:"subscribe",to:o("WAWap").JID(t),name:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,n),context:o("WASmaxAttrs").OPTIONAL(o("WAWap").GROUP_JID,r)}),a);return i}l.makeSubscribeRequest=e}),98);
__d("WASmaxOutPrivacyBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"get"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBaseIQGetRequestMixin=s}),98);
__d("WASmaxOutPrivacyCategoryNamesForContactBlacklistMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.anyName,n=o("WASmaxJsx").smax("smax$any",{name:o("WAWap").CUSTOM_STRING(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeCategoryNamesForContactBlacklistMixin=s}),98);
__d("WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistLIDMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutPrivacyCategoryNamesForContactBlacklistMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.categoryNamesForContactBlacklistMixinArgs,n=o("WASmaxJsx").smax("privacy",{addressing_mode:"lid"},o("WASmaxOutPrivacyCategoryNamesForContactBlacklistMixin").mergeCategoryNamesForContactBlacklistMixin(o("WASmaxJsx").smax("list",{value:"contact_blacklist"}),t));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeGetContactBlacklistGetContactBlacklistLIDMixin=s}),98);
__d("WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistPNMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutPrivacyCategoryNamesForContactBlacklistMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.categoryNamesForContactBlacklistMixinArgs,n=o("WASmaxJsx").smax("privacy",null,o("WASmaxOutPrivacyCategoryNamesForContactBlacklistMixin").mergeCategoryNamesForContactBlacklistMixin(o("WASmaxJsx").smax("list",{value:"contact_blacklist"}),t));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeGetContactBlacklistGetContactBlacklistPNMixin=s}),98);
__d("WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistLIDOrGetContactBlacklistPNMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistLIDMixin","WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistPNMixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.getContactBlacklistGetContactBlacklistLID)return o("WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistLIDMixin").mergeGetContactBlacklistGetContactBlacklistLIDMixin(e,t.getContactBlacklistGetContactBlacklistLID);if(t.getContactBlacklistGetContactBlacklistPN)return o("WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistPNMixin").mergeGetContactBlacklistGetContactBlacklistPNMixin(e,t.getContactBlacklistGetContactBlacklistPN);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeGetContactBlacklistGetContactBlacklistLIDOrGetContactBlacklistPNMixinGroup=e}),98);
__d("WASmaxOutPrivacyGetIQMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutPrivacyBaseIQGetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxOutPrivacyBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(o("WASmaxJsx").smax("iq",{to:o("WAWap").S_WHATSAPP_NET,xmlns:"privacy"}));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeGetIQMixin=s}),98);
__d("WASmaxOutPrivacyGetContactBlacklistRequest",["WASmaxJsx","WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistLIDOrGetContactBlacklistPNMixinGroup","WASmaxOutPrivacyGetIQMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.getContactBlacklistGetContactBlacklistLIDOrGetContactBlacklistPNMixinGroupArgs,n=o("WASmaxOutPrivacyGetIQMixin").mergeGetIQMixin(o("WASmaxJsx").smax("iq",null,o("WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistLIDOrGetContactBlacklistPNMixinGroup").mergeGetContactBlacklistGetContactBlacklistLIDOrGetContactBlacklistPNMixinGroup(o("WASmaxJsx").smax("privacy",null),t)));return n}l.makeGetContactBlacklistRequest=e}),98);
__d("WASmaxOutPsaBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"get"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBaseIQGetRequestMixin=s}),98);
__d("WASmaxOutPsaChatBlockGetRequest",["WASmaxJsx","WASmaxOutPsaBaseIQGetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxOutPsaBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(o("WASmaxJsx").smax("iq",{to:o("WAWap").S_WHATSAPP_NET,xmlns:"w:comms:chat"},o("WASmaxJsx").smax("query",null,o("WASmaxJsx").smax("blocking_status",null))));return e}l.makeChatBlockGetRequest=e}),98);
__d("WASmaxOutWaffleBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"get"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBaseIQGetRequestMixin=s}),98);
__d("WASmaxOutWaffleGetCertificateRequest",["WASmaxChildren","WASmaxJsx","WASmaxOutWaffleBaseIQGetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("payload_enc_certificates",null);return e}function s(){var e=o("WASmaxJsx").smax("password_pem",null);return e}function u(t){var n=t.hasPayloadEncCertificates,r=t.hasPasswordPem,a=t.timestampElementValue,i=o("WASmaxOutWaffleBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(o("WASmaxJsx").smax("iq",{xmlns:"waffle",smax_id:o("WAWap").INT(51),to:o("WAWap").S_WHATSAPP_NET},o("WASmaxJsx").smax("timestamp",null,o("WAWap").INT(a)),o("WASmaxChildren").HAS_OPTIONAL_CHILD(e,n),o("WASmaxChildren").HAS_OPTIONAL_CHILD(s,r)));return i}l.makeGetCertificateRequestPayloadEncCertificates=e,l.makeGetCertificateRequestPasswordPem=s,l.makeGetCertificateRequest=u}),98);
__d("WASmaxOutWaffleRSAEncryptionMetadataMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t,n=e.encryptedKeyElementValue,r=e.nonceElementValue,a=e.encryptedDataElementValue,i=e.authTagElementValue,l=(t=o("WASmaxJsx")).smax("smax$any",{version:"1",algorithm:"rsa2048"},t.smax("encrypted_key",null,n),t.smax("nonce",null,r),t.smax("encrypted_data",null,a),t.smax("auth_tag",null,i));return l}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeRSAEncryptionMetadataMixin=s}),98);
__d("WASmaxOutWaffleRefreshAccessTokensRequest",["WASmaxJsx","WASmaxOutWaffleBaseIQGetRequestMixin","WASmaxOutWaffleRSAEncryptionMetadataMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t,n=e.rSAEncryptionMetadataMixinArgs,r=e.timestampElementValue,a=e.fbidElementValue,i=o("WASmaxOutWaffleBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin((t=o("WASmaxJsx")).smax("iq",{xmlns:"waffle",smax_id:o("WAWap").INT(46),to:o("WAWap").S_WHATSAPP_NET},o("WASmaxOutWaffleRSAEncryptionMetadataMixin").mergeRSAEncryptionMetadataMixin(t.smax("encryption_metadata",null),n),t.smax("timestamp",null,o("WAWap").INT(r)),t.smax("fbid",null,a)));return i}l.makeRefreshAccessTokensRequest=e}),98);
__d("WASmaxOutWaffleStateExistsRequest",["WASmaxJsx","WASmaxOutWaffleBaseIQGetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.timestampElementValue,n=o("WASmaxOutWaffleBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(o("WASmaxJsx").smax("iq",{xmlns:"waffle",smax_id:o("WAWap").INT(142),to:o("WAWap").S_WHATSAPP_NET},o("WASmaxJsx").smax("timestamp",null,o("WAWap").INT(t))));return n}l.makeStateExistsRequest=e}),98);
__d("WASmaxOutWaffleWFPingRequest",["WASmaxJsx","WASmaxOutWaffleBaseIQGetRequestMixin","WASmaxOutWaffleRSAEncryptionMetadataMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t,n=e.rSAEncryptionMetadataMixinArgs,r=e.timestampElementValue,a=e.fbidElementValue,i=o("WASmaxOutWaffleBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin((t=o("WASmaxJsx")).smax("iq",{xmlns:"waffle",smax_id:o("WAWap").INT(83),to:o("WAWap").S_WHATSAPP_NET},o("WASmaxOutWaffleRSAEncryptionMetadataMixin").mergeRSAEncryptionMetadataMixin(t.smax("encryption_metadata",null),n),t.smax("timestamp",null,o("WAWap").INT(r)),t.smax("fbid",null,a)));return i}l.makeWFPingRequest=e}),98);
__d("WASmaxPreKeysFetchMissingPreKeysRPC",["WAComms","WASmaxInPreKeysFetchMissingPreKeysResponseRequestError","WASmaxInPreKeysFetchMissingPreKeysResponseServerError","WASmaxInPreKeysFetchMissingPreKeysResponseSuccess","WASmaxOutPreKeysFetchMissingPreKeysRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutPreKeysFetchMissingPreKeysRequest").makeFetchMissingPreKeysRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInPreKeysFetchMissingPreKeysResponseSuccess").parseFetchMissingPreKeysResponseSuccess(r,n);if(a.success)return{name:"FetchMissingPreKeysResponseSuccess",value:a.value};var i=o("WASmaxInPreKeysFetchMissingPreKeysResponseRequestError").parseFetchMissingPreKeysResponseRequestError(r,n);if(i.success)return{name:"FetchMissingPreKeysResponseRequestError",value:i.value};var l=o("WASmaxInPreKeysFetchMissingPreKeysResponseServerError").parseFetchMissingPreKeysResponseServerError(r,n);if(l.success)return{name:"FetchMissingPreKeysResponseServerError",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("FetchMissingPreKeys",{Success:a,RequestError:i,ServerError:l}))}),s.apply(this,arguments)}l.sendFetchMissingPreKeysRPC=e}),98);
__d("WASmaxPresenceSubscribeRPC",["WAComms","WASmaxOutPresenceSubscribeRequest","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WASmaxOutPresenceSubscribeRequest").makeSubscribeRequest(e);yield o("WAComms").castSmaxStanza(t)}),s.apply(this,arguments)}l.sendSubscribeRPC=e}),98);
__d("WASmaxPrivacyGetContactBlacklistRPC",["WAComms","WASmaxInPrivacyGetContactBlacklistResponseError","WASmaxInPrivacyGetContactBlacklistResponseSuccess","WASmaxInPrivacyGetContactBlacklistResponseSuccessLID","WASmaxOutPrivacyGetContactBlacklistRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutPrivacyGetContactBlacklistRequest").makeGetContactBlacklistRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInPrivacyGetContactBlacklistResponseSuccessLID").parseGetContactBlacklistResponseSuccessLID(r,n);if(a.success)return{name:"GetContactBlacklistResponseSuccessLID",value:a.value};var i=o("WASmaxInPrivacyGetContactBlacklistResponseSuccess").parseGetContactBlacklistResponseSuccess(r,n);if(i.success)return{name:"GetContactBlacklistResponseSuccess",value:i.value};var l=o("WASmaxInPrivacyGetContactBlacklistResponseError").parseGetContactBlacklistResponseError(r,n);if(l.success)return{name:"GetContactBlacklistResponseError",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("GetContactBlacklist",{SuccessLID:a,Success:i,Error:l}))}),s.apply(this,arguments)}l.sendGetContactBlacklistRPC=e}),98);
__d("WASmaxPsaChatBlockGetRPC",["WAComms","WASmaxInPsaChatBlockGetResponseServerError","WASmaxInPsaChatBlockGetResponseSuccess","WASmaxOutPsaChatBlockGetRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WASmaxOutPsaChatBlockGetRequest").makeChatBlockGetRequest(),n=yield o("WAComms").sendSmaxStanza(t,e),r=o("WASmaxInPsaChatBlockGetResponseSuccess").parseChatBlockGetResponseSuccess(n,t);if(r.success)return{name:"ChatBlockGetResponseSuccess",value:r.value};var a=o("WASmaxInPsaChatBlockGetResponseServerError").parseChatBlockGetResponseServerError(n,t);if(a.success)return{name:"ChatBlockGetResponseServerError",value:a.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("ChatBlockGet",{Success:r,ServerError:a}))}),s.apply(this,arguments)}l.sendChatBlockGetRPC=e}),98);
__d("WASmaxWaffleGetCertificateRPC",["WAComms","WASmaxInWaffleGetCertificateResponseError","WASmaxInWaffleGetCertificateResponseSuccess","WASmaxOutWaffleGetCertificateRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutWaffleGetCertificateRequest").makeGetCertificateRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInWaffleGetCertificateResponseSuccess").parseGetCertificateResponseSuccess(r,n);if(a.success)return{name:"GetCertificateResponseSuccess",value:a.value};var i=o("WASmaxInWaffleGetCertificateResponseError").parseGetCertificateResponseError(r,n);if(i.success)return{name:"GetCertificateResponseError",value:i.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("GetCertificate",{Success:a,Error:i}))}),s.apply(this,arguments)}l.sendGetCertificateRPC=e}),98);
__d("WASmaxWaffleRefreshAccessTokensRPC",["WAComms","WASmaxInWaffleRefreshAccessTokensResponseError","WASmaxInWaffleRefreshAccessTokensResponseSuccess","WASmaxOutWaffleRefreshAccessTokensRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutWaffleRefreshAccessTokensRequest").makeRefreshAccessTokensRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInWaffleRefreshAccessTokensResponseSuccess").parseRefreshAccessTokensResponseSuccess(r,n);if(a.success)return{name:"RefreshAccessTokensResponseSuccess",value:a.value};var i=o("WASmaxInWaffleRefreshAccessTokensResponseError").parseRefreshAccessTokensResponseError(r,n);if(i.success)return{name:"RefreshAccessTokensResponseError",value:i.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("RefreshAccessTokens",{Success:a,Error:i}))}),s.apply(this,arguments)}l.sendRefreshAccessTokensRPC=e}),98);
__d("WASmaxWaffleStateExistsRPC",["WAComms","WASmaxInWaffleStateExistsResponseError","WASmaxInWaffleStateExistsResponseSuccess","WASmaxOutWaffleStateExistsRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutWaffleStateExistsRequest").makeStateExistsRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInWaffleStateExistsResponseSuccess").parseStateExistsResponseSuccess(r,n);if(a.success)return{name:"StateExistsResponseSuccess",value:a.value};var i=o("WASmaxInWaffleStateExistsResponseError").parseStateExistsResponseError(r,n);if(i.success)return{name:"StateExistsResponseError",value:i.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("StateExists",{Success:a,Error:i}))}),s.apply(this,arguments)}l.sendStateExistsRPC=e}),98);
__d("WASmaxWaffleWFPingRPC",["WAComms","WASmaxInWaffleWFPingResponseError","WASmaxInWaffleWFPingResponseSuccess","WASmaxOutWaffleWFPingRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutWaffleWFPingRequest").makeWFPingRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInWaffleWFPingResponseSuccess").parseWFPingResponseSuccess(r,n);if(a.success)return{name:"WFPingResponseSuccess",value:a.value};var i=o("WASmaxInWaffleWFPingResponseError").parseWFPingResponseError(r,n);if(i.success)return{name:"WFPingResponseError",value:i.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("WFPing",{Success:a,Error:i}))}),s.apply(this,arguments)}l.sendWFPingRPC=e}),98);
__d("WAWebSyncdCryptoConst",[],(function(t,n,r,o,a,i){"use strict";var e="WhatsApp Mutation Keys",l=160,s=32,u=32,c=32,d=32,m=32,p=s,_=p+u,f=_+c,g=f+d,h=g+m,y="0x01",C="0x02",b=0,v=32,S=8,R=16;i.HKDF_INFO=e,i.DERIVED_KEY_LENGTH=l,i.INDEX_KEY_END=p,i.VALUE_ENCRYPTION_KEY_END=_,i.VALUE_MAC_KEY_END=f,i.SNAPSHOT_MAC_KEY_END=g,i.PATCH_MAC_KEY_END=h,i.OPERATION_SET_HEX=y,i.OPERATION_REMOVE_HEX=C,i.MAX_OF_MIN_DATA_LENGTH=b,i.MAC_LENGTH=v,i.OCTET_LENGTH=S,i.IV_LENGTH=R}),66);
__d("WAWebSyncdError",[],(function(t,n,r,o,a,i){"use strict";var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="SyncdMissingKeyError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),l=(function(e){function t(t,n){var r;return r=e.call(this,t)||this,r.name="SyncdRetryableError",r.backoff=n,r.message=t,r}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),s=(function(e){function t(t){var n;return n=e.call(this,t)||this,n.name="SyncdFatalError",n.message=t,n}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));i.SyncdMissingKeyError=e,i.SyncdRetryableError=l,i.SyncdFatalError=s}),66);
__d("WAWebSyncdDecode",["WALogger","WAWebProtobufSyncAction.pb","WAWebProtobufsServerSync.pb","WAWebSyncdError","WAWebSyncdMetricFatalError","decodeProtobuf"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d;function m(t,n){try{return o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsServerSync.pb").ExternalBlobReferenceSpec,n)}catch(n){o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.EXTERNAL_BLOB_REFERENCE_PROTOBUF_DESERIALIZATION_FAILED,{collection:t});var r=n instanceof Error?n.message:String(n);throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: external blob reference protobuf deserialization failed: ",""])),r),new(o("WAWebSyncdError")).SyncdFatalError("syncd: external blob reference protobuf deserialization failed: "+r)}}function p(e,t){try{return o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsServerSync.pb").SyncdSnapshotSpec,t)}catch(t){o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.SNAPSHOT_PROTOBUF_DESERIALIZATION_FAILED,{collection:e});var n=t instanceof Error?t.message:String(t);throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: snapshot protobuf deserialization failed: ",""])),n),new(o("WAWebSyncdError")).SyncdFatalError("syncd: snapshot protobuf deserialization failed: "+n)}}function _(e,t){try{return o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsServerSync.pb").SyncdPatchSpec,t)}catch(t){o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.PATCH_PROTOBUF_DESERIALIZATION_FAILED,{collection:e});var n=t instanceof Error?t.message:String(t);throw o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: patch protobuf deserialization failed: ",""])),n),new(o("WAWebSyncdError")).SyncdFatalError("syncd: patch protobuf deserialization failed: "+n)}}function f(e,t){try{return o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsServerSync.pb").SyncdMutationsSpec,t)}catch(t){o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MUTATIONS_PROTOBUF_DESERIALIZATION_FAILED,{collection:e});var n=t instanceof Error?t.message:String(t);throw o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["syncd: mutations protobuf deserialization failed: ",""])),n),new(o("WAWebSyncdError")).SyncdFatalError("syncd: mutations protobuf deserialization failed: "+n)}}function g(e,t){try{return o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,t)}catch(t){o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.ACTION_DATA_PROTOBUF_DESERIALIZATION_FAILED,{collection:e});var n=t instanceof Error?t.message:String(t);throw o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["syncd: data protobuf deserialization failed: ",""])),n),new(o("WAWebSyncdError")).SyncdFatalError("syncd: data protobuf deserialization failed: "+n)}}l.decodeExternalBlobReference=m,l.decodeSyncdSnapshot=p,l.decodeSyncdPatch=_,l.decodeSyncdMutations=f,l.decodeSyncActionData=g}),98);
__d("WAWebSyncdRequestEncode",["WAWebProtobufSyncAction.pb","WAWebProtobufsServerSync.pb","WAWebSyncdError","WAWebSyncdMetricFatalError","encodeProtobuf"],(function(t,n,r,o,a,i,l){"use strict";function e(e){try{return o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsServerSync.pb").SyncdPatchSpec,e).readBuffer()}catch(e){throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.PATCH_PROTOBUF_SERIALIZATION_FAILED),new(o("WAWebSyncdError")).SyncdFatalError("patch protobuf serialization failed")}}function s(e){try{return o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsServerSync.pb").SyncdMutationsSpec,e).readBuffer()}catch(e){throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MUTATIONS_PROTOBUF_SERIALIZATION_FAILED),new(o("WAWebSyncdError")).SyncdFatalError("mutations protobuf serialization failed")}}function u(e){try{return o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,e).readBuffer()}catch(e){throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.ACTION_DATA_PROTOBUF_SERIALIZATION_FAILED),new(o("WAWebSyncdError")).SyncdFatalError("action data protobuf serialization failed")}}l.encodeSyncdPatch=e,l.encodeSyncdMutations=s,l.encodeSyncActionData=u}),98);
__d("WAWebSyncdValidateSyncActionProtobuf",["WAWebSyncdError","WAWebSyncdMetricFatalError"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(){}return e.validateSyncActionDataProtobuf=function(t,n){var e=n.index,r=n.value,a=n.padding,i=n.version;if(!e)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_ACTION_INDEX,{collection:t}),new(o("WAWebSyncdError")).SyncdFatalError("missing action index");if(i==null)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_ACTION_VERSION,{collection:t}),new(o("WAWebSyncdError")).SyncdFatalError("missing action version");return{index:e,value:r,padding:a,version:i}},e})();l.default=e}),98);
__d("kotlin-kotlin-stdlib",[],(function(t,n,r,o,a,i){typeof Math.imul=="undefined"&&(Math.imul=function(t,n){return(t&4294901760)*(n&65535)+(t&65535)*(n|0)|0}),typeof ArrayBuffer.isView=="undefined"&&(ArrayBuffer.isView=function(e){return e!=null&&e.__proto__!=null&&e.__proto__.__proto__===Int8Array.prototype.__proto__}),typeof Array.prototype.fill=="undefined"&&Object.defineProperty(Array.prototype,"fill",{value:function(t){if(this==null)throw new TypeError("this is null or not defined");for(var e=Object(this),n=e.length>>>0,r=arguments[1],o=r>>0,a=o<0?Math.max(n+o,0):Math.min(o,n),i=arguments[2],l=i===void 0?n:i>>0,s=l<0?Math.max(n+l,0):Math.min(l,n);a<s;)e[a]=t,a++;return e}}),[Int8Array,Int16Array,Uint16Array,Int32Array,Float32Array,Float64Array].forEach(function(e){typeof e.prototype.fill=="undefined"&&Object.defineProperty(e.prototype,"fill",{value:Array.prototype.fill})}),typeof Math.clz32=="undefined"&&(Math.clz32=(function(e,t){return function(n){var r=n>>>0;return r===0?32:31-(e(r)/t|0)|0}})(Math.log,Math.LN2));var e=Math.imul,l=ArrayBuffer.isView,s=Math.clz32;_n(d,"CharSequence"),dn(m,"Number"),dn(N,"Char"),_n(w,"Collection"),_n(M,"List",Dn,Dn,[w]),yn(A);function u(){return st(this)}_n(B,"Set",Dn,Dn,[w]),_n(W,"Entry"),_n(q,"Map"),yn(U),dn(G,"Enum"),yn(j),dn(X,"Long",Dn,m),_n(ne,"FunctionAdapter"),dn(mt,"JsSetView",mt,Set),pn(Wn,"Digit"),_n(Vn,"Comparator"),pn(zn,"Unit"),dn(Ba,"AbstractCollection",Dn,Dn,[w]),dn(er,"AbstractMutableCollection",Dn,Ba,[Ba,w]),dn(tr,"IteratorImpl"),dn(nr,"AbstractMutableList",Dn,er,[er,M,w]),dn(rr,"AbstractMutableSet",Dn,er,[er,B,w]),yn(lr),dn(gr,"ArrayList",dr,nr,[nr,M,w]),dn(Rr,"HashSet",Cr,rr,[rr,B,w]),yn(jr),dn(Xr,"Itr"),dn(Yr,"KeysItr",Dn,Xr),dn(Jr,"EntriesItr",Dn,Xr),dn(Zr,"EntryRef",Dn,Dn,[W]);function c(e){var t;e:{var n;if(En(e,w)?n=e.j():n=!1,n){t=!0;break e}for(var r=e.f();r.g();){var o=r.h(),a=o,i;if(a!=null&&En(a,W)?i=this.t3(a):i=!1,!i){t=!1;break e}}t=!0}return t}_n(to,"InternalMap"),dn(eo,"InternalHashMap",Tr,Dn,[to]),pn(uo,"EmptyHolder"),dn(po,"LinkedHashSet",ro,Rr,[Rr,B,w]),dn(yo,"Exception",fo,Error),dn(Ao,"RuntimeException",No,yo),dn(Ro,"IllegalArgumentException",bo,Ao),dn(To,"IllegalStateException",Eo,Ao),dn($o,"UnsupportedOperationException",xo,Ao),dn(Bo,"NoSuchElementException",Oo,Ao),dn(Ho,"IndexOutOfBoundsException",qo,Ao),dn(Qo,"NumberFormatException",zo,Ro),dn(ea,"ConcurrentModificationException",Yo,Ao),dn(ra,"NullPointerException",na,Ao),dn(ia,"NoWhenBranchMatchedException",aa,Ao),dn(ua,"ClassCastException",sa,Ao),dn(_a,"CharacterCodingException",pa,yo),dn(Ca,"StringBuilder",ya,Dn,[d]),dn(Ia,"sam$kotlin_Comparator$0",Dn,Dn,[Vn,ne]),dn(Wa,"IteratorImpl"),yn(qa),dn(Ha,"AbstractList",Dn,Ba,[Ba,M]),yn(Ga),pn(Xa,"EmptyIterator"),pn(Za,"EmptyList",Dn,Dn,[M]),pn(oi,"EmptySet",Dn,Dn,[B]),dn(ui,"EnumEntriesList",Dn,Ha,[M,Ha]);function d(){}function m(){}function p(e){switch(e.length){case 0:return ri();case 1:return Yn(e[0]);default:return f(e,io(e.length))}}function _(e,t){if(!(t>=0)){var n="Requested element count "+t+" is less than zero.";throw So(Ot(n))}if(t===0)return Qa();var r=e.length;if(t>=r)return g(e);if(t===1)return Xn(e[r-1|0]);var o=pr(t),a=r-t|0;if(a<r)do{var i=a;a=a+1|0,o.d(e[i])}while(a<r);return o}function f(e,t){for(var n=0,r=e.length;n<r;){var o=e[n];n=n+1|0,t.d(o)}return t}function g(e){switch(e.length){case 0:return Qa();case 1:return Xn(e[0]);default:return h(e)}}function h(e){for(var t=pr(e.length),n=0,r=e.length;n<r;){var o=e[n];n=n+1|0,t.d(o)}return t}function y(e,t){if(t==null){var n=0,r=e.length-1|0;if(n<=r)do{var o=n;if(n=n+1|0,e[o]==null)return o}while(n<=r)}else{var a=0,i=e.length-1|0;if(a<=i)do{var l=a;if(a=a+1|0,At(t,e[l]))return l}while(a<=i)}return-1}function C(e,t,n,r,o,a,i){return t=t===Dn?", ":t,n=n===Dn?"":n,r=r===Dn?"":r,o=o===Dn?-1:o,a=a===Dn?"...":a,i=i===Dn?null:i,b(e,ya(),t,n,r,o,a,i).toString()}function b(e,t,n,r,o,a,i,l){n=n===Dn?", ":n,r=r===Dn?"":r,o=o===Dn?"":o,a=a===Dn?-1:a,i=i===Dn?"...":i,l=l===Dn?null:l,t.e(r);var s=0,u=0,c=e.length;e:for(;u<c;){var d=e[u];if(u=u+1|0,s=s+1|0,s>1&&t.e(n),a<0||s<=a)ci(t,d,l);else break e}return a>=0&&s>a&&t.e(i),t.e(o),t}function v(e,t){return 0<=t&&t<=(e.length-1|0)?e[t]:null}function S(e,t,n,r,o,a,i){return t=t===Dn?", ":t,n=n===Dn?"":n,r=r===Dn?"":r,o=o===Dn?-1:o,a=a===Dn?"...":a,i=i===Dn?null:i,R(e,ya(),t,n,r,o,a,i).toString()}function R(e,t,n,r,o,a,i,l){n=n===Dn?", ":n,r=r===Dn?"":r,o=o===Dn?"":o,a=a===Dn?-1:a,i=i===Dn?"...":i,l=l===Dn?null:l,t.e(r);var s=0,u=e.f();e:for(;u.g();){var c=u.h();if(s=s+1|0,s>1&&t.e(n),a<0||s<=a)ci(t,c,l);else break e}return a>=0&&s>a&&t.e(i),t.e(o),t}function L(e){for(var t=new Int8Array(e.i()),n=0,r=e.f();r.g();){var o=r.h(),a=n;n=a+1|0,t[a]=o}return t}function E(e,t){return e<t?t:e}function k(e,t){return e>t?t:e}function I(e){return e}function T(e){return e}function D(e,t){return e-t|0}function x(e,t){return e-t|0}function $(e){return e}function P(e){return String.fromCharCode(e)}function N(){}function M(){}function w(){}Yt(A).fromJsSet=function(e){return pt(e)};function A(){}var F;function O(){return F}function B(){}function W(){}function q(){}function U(){}var V;function H(){return V}function G(e,t){this.q_1=e,this.r_1=t}Yt(G).s=function(){return this.q_1},Yt(G).t=function(){return this.r_1},Yt(G).u=function(e){return It(this.r_1,e.r_1)},Yt(G).v=function(e){return this.u(e instanceof G?e:an())},Yt(G).equals=function(e){return this===e},Yt(G).hashCode=function(){return $t(this)},Yt(G).toString=function(){return this.q_1};function z(e){var t=e==null?null:Ot(e);return t==null?"null":t}function j(){K=this,this.w_1=new X(0,-2147483648),this.x_1=new X(-1,2147483647),this.y_1=8,this.z_1=64}var K;function Q(){return K==null&&new j,K}function X(e,t){Q(),m.call(this),this.a1_1=e,this.b1_1=t}Yt(X).c1=function(e){return De(this,e)},Yt(X).v=function(e){return this.c1(e instanceof X?e:an())},Yt(X).toString=function(){return qe(this,10)},Yt(X).equals=function(e){var t;return e instanceof X?t=Ue(this,e):t=!1,t},Yt(X).hashCode=function(){return Ve(this)},Yt(X).valueOf=function(){return We(this)};function Y(e){var t;return e<0?t=-e:t=e,t}function J(e){for(var t=1,n=[],r=0,o=e.length;r<o;){var a=e[r];r=r+1|0;var i=t,l=a.prototype.$imask$,s=l==null?a.$imask$:l;s!=null&&(n.push(s),i=s.length);var u=a.$metadata$.iid,c;u==null?c=null:c=Z(u);var d=c;d!=null&&(n.push(d),i=Math.max(i,d.length)),i>t&&(t=i)}return ee(t,n)}function Z(e){var t=e>>5,n=new Int32Array(t+1|0),r=e&31,o=1<<r;return n[t]=n[t]|o,n}function ee(e,t){for(var n=0,r=new Int32Array(e);n<e;){for(var o=n,a=0,i=0,l=t.length;i<l;){var s=t[i];i=i+1|0,o<s.length&&(a=a|s[o])}r[o]=a,n=n+1|0}return r}function te(e,t){var n=t>>5;if(n>e.length)return!1;var r=t&31,o=1<<r;return(e[n]&o)!==0}function ne(){}function re(){return ge(),oe}var oe;function ae(){return ge(),ie}var ie,le;function se(){return ge(),ue}var ue;function ce(){return ge(),de}var de;function me(){return ge(),pe}var pe;function _e(t){return ge(),(t|0)===t?vn(t):(ae()[0]=t,e(se()[me()],31)+se()[ce()]|0)}var fe;function ge(){fe||(fe=!0,oe=new ArrayBuffer(8),ie=new Float64Array(re()),le=new Float32Array(re()),ue=new Int32Array(re()),ae()[0]=-1,de=se()[0]!==0?1:0,pe=1-ce()|0)}function he(){return tt(),ye}var ye;function Ce(){return tt(),be}var be;function ve(){return tt(),Se}var Se;function Re(){return tt(),Le}var Le;function Ee(){return tt(),ke}var ke;function Ie(){return tt(),Te}var Te;function De(e,t){if(tt(),Ue(e,t))return 0;var n=Ge(e),r=Ge(t);return n&&!r?-1:!n&&r?1:Ge($e(e,t))?-1:1}function xe(e,t){tt();var n=e.b1_1>>>16|0,r=e.b1_1&65535,o=e.a1_1>>>16|0,a=e.a1_1&65535,i=t.b1_1>>>16|0,l=t.b1_1&65535,s=t.a1_1>>>16|0,u=t.a1_1&65535,c=0,d=0,m=0,p=0;return p=p+(a+u|0)|0,m=m+(p>>>16|0)|0,p=p&65535,m=m+(o+s|0)|0,d=d+(m>>>16|0)|0,m=m&65535,d=d+(r+l|0)|0,c=c+(d>>>16|0)|0,d=d&65535,c=c+(n+i|0)|0,c=c&65535,new X(m<<16|p,c<<16|d)}function $e(e,t){return tt(),xe(e,Ke(t))}function Pe(t,n){if(tt(),ze(t))return he();if(ze(n))return he();if(Ue(t,Ee()))return je(n)?Ee():he();if(Ue(n,Ee()))return je(t)?Ee():he();if(Ge(t)){var r;return Ge(n)?r=Pe(Ke(t),Ke(n)):r=Ke(Pe(Ke(t),n)),r}else if(Ge(n))return Ke(Pe(t,Ke(n)));if(Qe(t,Ie())&&Qe(n,Ie()))return Xe(We(t)*We(n));var o=t.b1_1>>>16|0,a=t.b1_1&65535,i=t.a1_1>>>16|0,l=t.a1_1&65535,s=n.b1_1>>>16|0,u=n.b1_1&65535,c=n.a1_1>>>16|0,d=n.a1_1&65535,m=0,p=0,_=0,f=0;return f=f+e(l,d)|0,_=_+(f>>>16|0)|0,f=f&65535,_=_+e(i,d)|0,p=p+(_>>>16|0)|0,_=_&65535,_=_+e(l,c)|0,p=p+(_>>>16|0)|0,_=_&65535,p=p+e(a,d)|0,m=m+(p>>>16|0)|0,p=p&65535,p=p+e(i,c)|0,m=m+(p>>>16|0)|0,p=p&65535,p=p+e(l,u)|0,m=m+(p>>>16|0)|0,p=p&65535,m=m+(((e(o,d)+e(a,c)|0)+e(i,u)|0)+e(l,s)|0)|0,m=m&65535,new X(_<<16|f,m<<16|p)}function Ne(e,t){if(tt(),ze(t))throw ho("division by zero");if(ze(e))return he();if(Ue(e,Ee())){if(Ue(t,Ce())||Ue(t,ve()))return Ee();if(Ue(t,Ee()))return Ce();var n=we(e,1),r=Me(Ne(n,t),1);if(Ue(r,he()))return Ge(t)?Ce():ve();var o=$e(e,Pe(t,r));return xe(r,Ne(o,t))}else if(Ue(t,Ee()))return he();if(Ge(e)){var a;return Ge(t)?a=Ne(Ke(e),Ke(t)):a=Ke(Ne(Ke(e),t)),a}else if(Ge(t))return Ke(Ne(e,Ke(t)));for(var i=he(),l=e;Je(l,t);){for(var s=We(l)/We(t),u=Math.max(1,Math.floor(s)),c=Math.ceil(Math.log(u)/Math.LN2),d=c<=48?1:Math.pow(2,c-48),m=Xe(u),p=Pe(m,t);Ge(p)||Ye(p,l);)u=u-d,m=Xe(u),p=Pe(m,t);ze(m)&&(m=Ce()),i=xe(i,m),l=$e(l,p)}return i}function Me(e,t){tt();var n=t&63;return n===0?e:n<32?new X(e.a1_1<<n,e.b1_1<<n|(e.a1_1>>>(32-n|0)|0)):new X(0,e.a1_1<<(n-32|0))}function we(e,t){tt();var n=t&63;return n===0?e:n<32?new X(e.a1_1>>>n|0|e.b1_1<<(32-n|0),e.b1_1>>n):new X(e.b1_1>>(n-32|0),e.b1_1>=0?0:-1)}function Ae(e,t){return tt(),new X(e.a1_1&t.a1_1,e.b1_1&t.b1_1)}function Fe(e){return tt(),new X(~e.a1_1,~e.b1_1)}function Oe(e){return tt(),bn(e.a1_1)}function Be(e){return tt(),e.a1_1}function We(e){return tt(),e.b1_1*4294967296+Ze(e)}function qe(e,t){if(tt(),ze(e))return"0";if(Ge(e))if(Ue(e,Ee())){var n=He(t),r=Ne(e,n),o=Be($e(Pe(r,n),e)),a=qe(r,t);return a+o.toString(t)}else return"-"+qe(Ke(e),t);for(var i=t===2?31:t<=10?9:t<=21?7:t<=35?6:5,l=Xe(Math.pow(t,i)),s=e,u="";;){var c=Ne(s,l),d=Be($e(s,Pe(c,l))),m=d.toString(t);if(s=c,ze(s))return m+u;for(;m.length<i;)m="0"+m;u=m+u}}function Ue(e,t){return tt(),e.b1_1===t.b1_1&&e.a1_1===t.a1_1}function Ve(e){return tt(),e.a1_1^e.b1_1}function He(e){return tt(),new X(e,e<0?-1:0)}function Ge(e){return tt(),e.b1_1<0}function ze(e){return tt(),e.b1_1===0&&e.a1_1===0}function je(e){return tt(),(e.a1_1&1)===1}function Ke(e){return tt(),xe(Fe(e),new X(1,0))}function Qe(e,t){return tt(),De(e,t)<0}function Xe(e){if(tt(),Hn(e))return he();if(e<=-9223372036854776e3)return Ee();if(e+1>=9223372036854776e3)return Re();if(e<0)return Ke(Xe(-e));var t=4294967296,n=e%t|0,r=e/t|0;return new X(n,r)}function Ye(e,t){return tt(),De(e,t)>0}function Je(e,t){return tt(),De(e,t)>=0}function Ze(e){return tt(),e.a1_1>=0?e.a1_1:4294967296+e.a1_1}var et;function tt(){et||(et=!0,ye=He(0),be=He(1),Se=He(-1),Le=new X(-1,2147483647),ke=new X(0,-2147483648),Te=He(16777216))}function nt(e,t){return e.charCodeAt(t)}function rt(e,t){var n=e,r=t;if(n===r)return!0;if(n==null||r==null||!Rn(r)||n.length!=r.length)return!1;var o=0,a=n.length;if(o<a)do{var i=o;if(o=o+1|0,!At(n[i],r[i]))return!1}while(o<a);return!0}function ot(t){var n=t;if(n==null)return 0;var r=1,o=0,a=n.length;if(o<a)do{var i=o;o=o+1|0,r=e(r,31)+Ft(n[i])|0}while(o<a);return r}function at(e){return C(e,", ","[","]",Dn,Dn,it)}function it(e){return Ot(e)}function lt(){throw xo()}function st(e){var t=_t(e),n=ft(),r=gt(),o=ht(),a=yt(e),i=Ct(e),l=vt(e);return ut(t,n,r,o,a,i,l,St)}function ut(e,t,n,r,o,a,i,l){var s=Mt(Yt(mt));s[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]=a,wt(s,"size",e,Dn,!0);var u=s;return Object.assign(u,{add:function(n){return t(n),this},delete:n,clear:r,has:o,keys:a,values:a,entries:i,forEach:function(t,n){l(t,u,n)}})}function ct(e,t){var n;t===Dn?n=Rt:n=t,t=n;var r=Lt(e),o=Et(e),a={next:function(){var e={done:!o()};return e.done||(e.value=t(r())),e}};return a[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]=function(){return this},a}function dt(e,t,n){n=n===Dn?void 0:n;for(var r=t.entries(),o=r.next();!o.done;){var a=o.value;e.call(n,a[1],a[0],t),o=r.next()}}function mt(){Set.call(this)}function pt(e){var t=ro();return dt(kt(t),e),t.f1()}function _t(e){return function(){return e.i()}}function ft(){var e=function(){return lt(),jn};return e.callableName="UNSUPPORTED_OPERATION",e}function gt(){var e=function(){return lt(),jn};return e.callableName="UNSUPPORTED_OPERATION",e}function ht(){var e=function(){return lt(),jn};return e.callableName="UNSUPPORTED_OPERATION",e}function yt(e){return function(t){return e.k(t)}}function Ct(e){return function(){return ct(e.f())}}function bt(e){return[e,e]}function vt(e){return function(){var t=e.f();return ct(t,bt)}}function St(e,t,n){return dt(e,t,n),jn}function Rt(e){return e}function Lt(e){return function(){return e.h()}}function Et(e){return function(){return e.g()}}function kt(e){return function(t,n,r){return e.d(n),jn}}function It(e,t){var n;switch(typeof e){case"number":var r;typeof t=="number"?r=Tt(e,t):t instanceof X?r=Tt(e,We(t)):r=Dt(e,t),n=r;break;case"string":case"boolean":case"bigint":n=Dt(e,t);break;default:n=xt(e,t);break}return n}function Tt(e,t){var n;if(e<t)n=-1;else if(e>t)n=1;else if(e===t){var r;if(e!==0)r=0;else{var o=1/e,a;o===1/t?a=0:o<0?a=-1:a=1,r=a}n=r}else e!==e?n=t!==t?0:1:n=-1;return n}function Dt(e,t){return e<t?-1:e>t?1:0}function xt(e,t){return e.v(t)}function $t(e){return Pt(e)}function Pt(e){if(!("kotlinHashCodeValue$"in e)){var t=Nt(),n=new Object;n.value=t,n.enumerable=!1,Object.defineProperty(e,"kotlinHashCodeValue$",n)}return e.kotlinHashCodeValue$}function Nt(){return Math.random()*4294967296|0}function Mt(e){return e=e===Dn?null:e,Object.create(e)}function wt(e,t,n,r,o){return Object.defineProperty(e,t,{configurable:!0,get:n,set:r,enumerable:o})}function At(e,t){if(e==null)return t==null;if(t==null)return!1;if(typeof e=="object"&&typeof e.equals=="function")return e.equals(t);if(e!==e)return t!==t;if(typeof e=="number"&&typeof t=="number"){var n;if(e===t){var r;if(e!==0)r=!0;else{var o=1/e;r=o===1/t}n=r}else n=!1;return n}return e===t}function Ft(e){if(e==null)return 0;var t=typeof e,n;switch(t){case"object":n=typeof e.hashCode=="function"?e.hashCode():Pt(e);break;case"function":n=Pt(e);break;case"number":n=_e(e);break;case"boolean":n=Bt(e);break;case"string":n=Wt(String(e));break;case"bigint":n=qt(e);break;case"symbol":n=Ut(e);break;default:n=(function(){throw new Error("Unexpected typeof `"+t+"`")})();break}return n}function Ot(e){var t;return e==null?t="null":Rn(e)?t="[...]":typeof e.toString!="function"?t=Vt(e):t=e.toString(),t}function Bt(e){return e?1231:1237}function Wt(t){var n=0,r=t.length,o=0,a=r-1|0;if(o<=a)do{var i=o;o=o+1|0;var l=t.charCodeAt(i);n=e(n,31)+l|0}while(i!==a);return n}function qt(t){var n=BigInt(32),r=BigInt(4294967295),o=Y(t),a=0,i;t<0?i=-1:i=1;var l=i;e:for(;;){if(o==0)break e;var s=o&r,u=Number(s);a=e(31,a)+u|0,o=o>>n}return e(a,l)}function Ut(e){var t=Ht(e)?Gt():zt(),n=t.get(e);if(n!==Dn)return n;var r=Nt();return t.set(e,r),r}function Vt(e){return Object.prototype.toString.call(e)}function Ht(e){return(typeof Symbol=="function"?Symbol.keyFor:"@@keyFor")(e)!=Dn}function Gt(){return jt===Dn&&(jt=new Map),jt}function zt(){return Kt===Dn&&(Kt=new WeakMap),Kt}var jt,Kt;function Qt(e){var t="Should be lowered";throw Io(Ot(t))}function Xt(e,t){Error.captureStackTrace!=null?Error.captureStackTrace(e,t):e.stack=new Error().stack}function Yt(e){return e.prototype}function Jt(e,t){var n;if(Zt(e)){var r;if(Zt(t))r=e;else{var o=t==null?null:t.toString();r=o==null?Dn:o}n=r}else n=e==null?Dn:e;return n}function Zt(e){return e===Dn}function en(e,t,n){tn(e,"message",Jt(t,n)),tn(e,"cause",n),tn(e,"name",Object.getPrototypeOf(e).constructor.name)}function tn(e,t,n){Object.defineProperty(e,t,{configurable:!0,writable:!0,value:n})}function nn(e){var t;return e==null?rn():t=e,t}function rn(){throw na()}function on(){throw aa()}function an(){throw sa()}function ln(e){throw So(e)}function sn(e,t,n,r,o,a){var i=Dn,l=e==="interface"?un():Dn;return{kind:e,simpleName:t,associatedObjectKey:r,associatedObjects:o,suspendArity:a,$kClass$:i,defaultConstructor:n,iid:l}}function un(){return cn===Dn&&(cn=0),cn=cn+1|0,cn}var cn;function dn(e,t,n,r,o,a,i,l){var s="class";mn(s,e,t,n,r,o,a,i,l)}function mn(e,t,n,r,o,a,i,l,s){o!=null&&(t.prototype=Object.create(o.prototype),t.prototype.constructor=t);var u=sn(e,n,r,l,s,i);if(t.$metadata$=u,a!=null){var c=At(u.iid,Dn)?t.prototype:t;c.$imask$=J(a)}}function pn(e,t,n,r,o,a,i,l){var s="object";mn(s,e,t,n,r,o,a,i,l)}function _n(e,t,n,r,o,a,i,l){var s="interface";mn(s,e,t,n,r,o,a,i,l)}function fn(e,t,n,r){dn(e,"Lambda",Dn,t,n,r,Dn,Dn)}function gn(e,t,n,r){dn(e,"Coroutine",Dn,t,n,r,Dn,Dn)}function hn(e,t,n,r){dn(e,"FunctionReference",Dn,t,n,r,Dn,Dn)}function yn(e,t,n,r){pn(e,"Companion",Dn,t,n,r,Dn,Dn)}function Cn(e){var t=0,n=0,r=e.length-1|0;if(n<=r)do{var o=n;n=n+1|0;var a=t;t=a+e[o].length|0}while(o!==r);var i=e[0],l=new i.constructor(t);i.$type$!=null&&(l.$type$=i.$type$),t=0;var s=0,u=e.length-1|0;if(s<=u)do{var c=s;s=s+1|0;var d=e[c],m=0,p=d.length-1|0;if(m<=p)do{var _=m;m=m+1|0;var f=t;t=f+1|0,l[f]=d[_]}while(_!==p)}while(c!==u);return l}function bn(e){return e<<24>>24}function vn(e){var t;return e instanceof X?t=Be(e):t=Sn(e),t}function Sn(e){var t;return e>2147483647?t=2147483647:e<-2147483648?t=-2147483648:t=e|0,t}function Rn(e){return Ln(e)||l(e)}function Ln(e){return Array.isArray(e)}function En(e,t){return kn(e,t.$metadata$.iid)}function kn(e,t){var n=e.$imask$,r;if(n==null)return!1;r=n;var o=r;return te(o,t)}function In(e){return typeof e=="string"||En(e,d)}function Tn(){return $n(),Dn}var Dn,xn;function $n(){xn||(xn=!0,Dn=void 0)}function Pn(e,t){return rt(e,t)}function Nn(e){return ot(e)}function Mn(e,t,n){return Ua.h1(t,n,e.length),e.slice(t,n)}function wn(e,t){if(!(t>=0)){var n="Invalid new array size: "+t+".";throw So(Ot(n))}return ca(e,new Int8Array(t))}function An(e,t){if(!(t>=0)){var n="Invalid new array size: "+t+".";throw So(Ot(n))}return ca(e,new Int32Array(t))}function Fn(e,t){if(!(t>=0)){var n="Invalid new array size: "+t+".";throw So(Ot(n))}return da(e,t,null)}function On(e){var t=$(e),n=Bn(Un().i1_1,t),r=t-Un().i1_1[n]|0;return r<10?r:-1}function Bn(e,t){for(var n=0,r=e.length-1|0,o=-1,a=0;n<=r;)if(o=(n+r|0)/2|0,a=e[o],t>a)n=o+1|0;else{if(t===a)return o;r=o-1|0}return o-(t<a?1:0)|0}function Wn(){qn=this;var e=this;e.i1_1=new Int32Array([48,1632,1776,1984,2406,2534,2662,2790,2918,3046,3174,3302,3430,3558,3664,3792,3872,4160,4240,6112,6160,6470,6608,6784,6800,6992,7088,7232,7248,42528,43216,43264,43472,43504,43600,44016,65296])}var qn;function Un(){return qn==null&&new Wn,qn}function Vn(){}function Hn(e){return e!==e}function Gn(e){var t;return e===0?t=0:t=1<<(31-s(e)|0),t}function zn(){}Yt(zn).toString=function(){return"kotlin.Unit"};var jn;function Kn(){return jn}function Qn(e){return Ka(e)}function Xn(e){var t=[e];return new gr(t)}function Yn(e){return li([e])}function Jn(e){return e}function Zn(e,t,n,r,o){Ua.h1(r,o,e.length);var a=o-r|0;if(Ua.h1(n,n+a|0,t.length),l(t)&&l(e)){var i=e.subarray(r,o);t.set(i,n)}else if(e!==t||n<=r){var s=0;if(s<a)do{var u=s;s=s+1|0,t[n+u|0]=e[r+u|0]}while(s<a)}else{var c=a-1|0;if(0<=c)do{var d=c;c=c+-1|0,t[n+d|0]=e[r+d|0]}while(0<=c)}}function er(){Ba.call(this)}Yt(er).toJSON=function(){return this.toArray()},Yt(er).j1=function(){};function tr(e){this.m1_1=e,this.k1_1=0,this.l1_1=-1}Yt(tr).g=function(){return this.k1_1<this.m1_1.i()},Yt(tr).h=function(){if(!this.g())throw Oo();var e=this,t=this.k1_1;return this.k1_1=t+1|0,e.l1_1=t,this.m1_1.l(this.l1_1)};function nr(){er.call(this),this.n1_1=0}Yt(nr).d=function(e){return this.j1(),this.o1(this.i(),e),!0},Yt(nr).f=function(){return new tr(this)},Yt(nr).k=function(e){return this.p1(e)>=0},Yt(nr).p1=function(e){var t;e:{for(var n=0,r=this.f();r.g();){var o=r.h();if(At(o,e)){t=n;break e}n=n+1|0}t=-1}return t},Yt(nr).equals=function(e){return e===this?!0:e!=null&&En(e,M)?Ua.q1(this,e):!1},Yt(nr).hashCode=function(){return Ua.r1(this)};function rr(){er.call(this)}Yt(rr).equals=function(e){return e===this?!0:e!=null&&En(e,B)?za.s1(this,e):!1},Yt(rr).hashCode=function(){return za.t1(this)};function or(e){if(!(e>=0)){var t="capacity must be non-negative.";throw So(Ot(t))}return Array(e)}function ar(e,t,n){e.fill(null,t,n)}function ir(e,t){return Fn(e,t)}function lr(){sr=this;var e=this,t=pr(0);t.c_1=!0,e.u1_1=t}var sr;function ur(){return sr==null&&new lr,sr}function cr(e){var t=[];return gr.call(e,t),e}function dr(){return cr(Mt(Yt(gr)))}function mr(e,t){var n=[];if(gr.call(t,n),!(e>=0)){var r="Negative initial capacity: "+e;throw So(Ot(r))}return t}function pr(e){return mr(e,Mt(Yt(gr)))}function _r(e,t){return Ua.v1(t,e.i()),t}function fr(e,t){return Ua.w1(t,e.i()),t}function gr(e){ur(),nr.call(this),this.b_1=e,this.c_1=!1}Yt(gr).i=function(){return this.b_1.length},Yt(gr).l=function(e){var t=this.b_1[_r(this,e)];return t==null||t!=null?t:an()},Yt(gr).d=function(e){return this.j1(),this.b_1.push(e),this.n1_1=this.n1_1+1|0,!0},Yt(gr).o1=function(e,t){this.j1(),this.b_1.splice(fr(this,e),0,t),this.n1_1=this.n1_1+1|0},Yt(gr).p1=function(e){return y(this.b_1,e)},Yt(gr).toString=function(){return at(this.b_1)},Yt(gr).x1=function(){return[].slice.call(this.b_1)},Yt(gr).toArray=function(){return this.x1()},Yt(gr).j1=function(){if(this.c_1)throw xo()};function hr(e,t){return rr.call(t),Rr.call(t),t.y1_1=e,t}function yr(e){return hr(Tr(),e),e}function Cr(){return yr(Mt(Yt(Rr)))}function br(e,t,n){return hr(Pr(e,t),n),n}function vr(e,t){return br(e,1,t),t}function Sr(e){return vr(e,Mt(Yt(Rr)))}Yt(Rr).d=function(e){return this.y1_1.z1(e,!0)==null},Yt(Rr).k=function(e){return this.y1_1.a2(e)},Yt(Rr).j=function(){return this.y1_1.i()===0},Yt(Rr).f=function(){return this.y1_1.b2()},Yt(Rr).i=function(){return this.y1_1.i()};function Rr(){}function Lr(t,n){return Gn(e(E(n,1),3))}function Er(e,t){return s(t)+1|0}function kr(e){if(e.m2_1.j2_1!==e.o2_1)throw Zo("The backing map has been modified after this entry was obtained.")}function Ir(e){return Dr(8,e),e}function Tr(){return Ir(Mt(Yt(eo)))}function Dr(e,t){return eo.call(t,or(e),null,new Int32Array(e),new Int32Array(Lr(Kr,e)),2,0),t}function xr(e){return Dr(e,Mt(Yt(eo)))}function $r(e,t,n){if(Dr(e,n),!(t>0)){var r="Non-positive load factor: "+t;throw So(Ot(r))}return n}function Pr(e,t){return $r(e,t,Mt(Yt(eo)))}function Nr(e){return e.c2_1.length}function Mr(e){return e.f2_1.length}function wr(e){e.j2_1=e.j2_1+1|0}function Ar(e,t){Fr(e,t)?qr(e,!0):Or(e,e.h2_1+t|0)}function Fr(e,t){var n=Nr(e)-e.h2_1|0,r=e.h2_1-e.i()|0;return n<t&&(r+n|0)>=t&&r>=(Nr(e)/4|0)}function Or(e,t){if(t<0)throw wo("too many elements");if(t>Nr(e)){var n=Ua.p2(Nr(e),t);e.c2_1=ir(e.c2_1,n);var r=e,o=e.d2_1;r.d2_1=o==null?null:ir(o,n),e.e2_1=An(e.e2_1,n);var a=Lr(Kr,n);a>Mr(e)&&Ur(e,a)}}function Br(e){var t=e.d2_1;if(t!=null)return t;var n=or(Nr(e));return e.d2_1=n,n}function Wr(t,n){return n==null?0:e(Ft(n),-1640531527)>>>t.i2_1|0}function qr(e,t){for(var n=0,r=0,o=e.d2_1;n<e.h2_1;){var a=e.e2_1[n];a>=0&&(e.c2_1[r]=e.c2_1[n],o!=null&&(o[r]=o[n]),t&&(e.e2_1[r]=a,e.f2_1[a]=r+1|0),r=r+1|0),n=n+1|0}ar(e.c2_1,r,e.h2_1),o==null||ar(o,r,e.h2_1),e.h2_1=r}function Ur(e,t){wr(e),e.h2_1>e.k2_1&&qr(e,!1),e.f2_1=new Int32Array(t),e.i2_1=Er(Kr,t);for(var n=0;n<e.h2_1;){var r=n;if(n=r+1|0,!Vr(e,r))throw Io("This cannot happen with fixed magic multiplier and grow-only hash array. Have object hashCodes changed?")}}function Vr(e,t){for(var n=Wr(e,e.c2_1[t]),r=e.g2_1;;){var o=e.f2_1[n];if(o===0)return e.f2_1[n]=t+1|0,e.e2_1[t]=n,!0;if(r=r-1|0,r<0)return!1;var a=n;n=a-1|0,a===0&&(n=Mr(e)-1|0)}}function Hr(e,t){for(var n=Wr(e,t),r=e.g2_1;;){var o=e.f2_1[n];if(o===0)return-1;if(o>0&&At(e.c2_1[o-1|0],t))return o-1|0;if(r=r-1|0,r<0)return-1;var a=n;n=a-1|0,a===0&&(n=Mr(e)-1|0)}}function Gr(t,n){t.q2();e:for(;;)for(var r=Wr(t,n),o=k(e(t.g2_1,2),Mr(t)/2|0),a=0;;){var i=t.f2_1[r];if(i<=0){if(t.h2_1>=Nr(t)){Ar(t,1);continue e}var l=t.h2_1;t.h2_1=l+1|0;var s=l;return t.c2_1[s]=n,t.e2_1[s]=r,t.f2_1[r]=s+1|0,t.k2_1=t.k2_1+1|0,wr(t),a>t.g2_1&&(t.g2_1=a),s}if(At(t.c2_1[i-1|0],n))return-i|0;if(a=a+1|0,a>o){Ur(t,e(Mr(t),2));continue e}var u=r;r=u-1|0,u===0&&(r=Mr(t)-1|0)}}function zr(e,t){return e.k2_1===t.i()&&e.r2(t.p())}function jr(){this.s2_1=-1640531527,this.t2_1=8,this.u2_1=2,this.v2_1=-1}var Kr;function Qr(){return Kr}function Xr(e){this.w2_1=e,this.x2_1=0,this.y2_1=-1,this.z2_1=this.w2_1.j2_1,this.a3()}Yt(Xr).a3=function(){for(;this.x2_1<this.w2_1.h2_1&&this.w2_1.e2_1[this.x2_1]<0;)this.x2_1=this.x2_1+1|0},Yt(Xr).g=function(){return this.x2_1<this.w2_1.h2_1},Yt(Xr).b3=function(){if(this.w2_1.j2_1!==this.z2_1)throw Yo()};function Yr(e){Xr.call(this,e)}Yt(Yr).h=function(){if(this.b3(),this.x2_1>=this.w2_1.h2_1)throw Oo();var e=this,t=this.x2_1;this.x2_1=t+1|0,e.y2_1=t;var n=this.w2_1.c2_1[this.y2_1];return this.a3(),n};function Jr(e){Xr.call(this,e)}Yt(Jr).h=function(){if(this.b3(),this.x2_1>=this.w2_1.h2_1)throw Oo();var e=this,t=this.x2_1;this.x2_1=t+1|0,e.y2_1=t;var n=new Zr(this.w2_1,this.y2_1);return this.a3(),n},Yt(Jr).k3=function(){if(this.x2_1>=this.w2_1.h2_1)throw Oo();var e=this,t=this.x2_1;this.x2_1=t+1|0,e.y2_1=t;var n=this.w2_1.c2_1[this.y2_1],r=n==null?null:Ft(n),o=r==null?0:r,a=nn(this.w2_1.d2_1)[this.y2_1],i=a==null?null:Ft(a),l=o^(i==null?0:i);return this.a3(),l},Yt(Jr).l3=function(e){if(this.x2_1>=this.w2_1.h2_1)throw Oo();var t=this,n=this.x2_1;this.x2_1=n+1|0,t.y2_1=n;var r=this.w2_1.c2_1[this.y2_1];At(r,this.w2_1)?e.o3("(this Map)"):e.n3(r),e.p3(61);var o=nn(this.w2_1.d2_1)[this.y2_1];At(o,this.w2_1)?e.o3("(this Map)"):e.n3(o),this.a3()};function Zr(e,t){this.m2_1=e,this.n2_1=t,this.o2_1=this.m2_1.j2_1}Yt(Zr).n=function(){return kr(this),this.m2_1.c2_1[this.n2_1]},Yt(Zr).o=function(){return kr(this),nn(this.m2_1.d2_1)[this.n2_1]},Yt(Zr).equals=function(e){var t,n;return e!=null&&En(e,W)?n=At(e.n(),this.n()):n=!1,n?t=At(e.o(),this.o()):t=!1,t},Yt(Zr).hashCode=function(){var e=this.n(),t=e==null?null:Ft(e),n=t==null?0:t,r=this.o(),o=r==null?null:Ft(r);return n^(o==null?0:o)},Yt(Zr).toString=function(){return z(this.n())+"="+z(this.o())};function eo(e,t,n,r,o,a){this.c2_1=e,this.d2_1=t,this.e2_1=n,this.f2_1=r,this.g2_1=o,this.h2_1=a,this.i2_1=Er(Kr,Mr(this)),this.j2_1=0,this.k2_1=0,this.l2_1=!1}Yt(eo).i=function(){return this.k2_1},Yt(eo).q3=function(){this.q2(),this.l2_1=!0},Yt(eo).a2=function(e){return Hr(this,e)>=0},Yt(eo).z1=function(e,t){var n=Gr(this,e),r=Br(this);if(n<0){var o=r[(-n|0)-1|0];return r[(-n|0)-1|0]=t,o}else return r[n]=t,null},Yt(eo).equals=function(e){var t;if(e===this)t=!0;else{var n;e!=null&&En(e,q)?n=zr(this,e):n=!1,t=n}return t},Yt(eo).hashCode=function(){for(var e=0,t=this.r3();t.g();)e=e+t.k3()|0;return e},Yt(eo).toString=function(){var t=ga(2+e(this.k2_1,3)|0);t.o3("{");for(var n=0,r=this.r3();r.g();)n>0&&t.o3(", "),r.l3(t),n=n+1|0;return t.o3("}"),t.toString()},Yt(eo).q2=function(){if(this.l2_1)throw xo()},Yt(eo).s3=function(e){var t=Hr(this,e.n());return t<0?!1:At(nn(this.d2_1)[t],e.o())},Yt(eo).t3=function(e){return this.s3(En(e,W)?e:an())},Yt(eo).b2=function(){return new Yr(this)},Yt(eo).r3=function(){return new Jr(this)};function to(){}function no(e){return yr(e),po.call(e),e}function ro(){return no(Mt(Yt(po)))}function oo(e,t,n){return br(e,t,n),po.call(n),n}function ao(e,t){return oo(e,1,t),t}function io(e){return ao(e,Mt(Yt(po)))}function lo(e,t){return hr(e,t),po.call(t),t}function so(e){return lo(e,Mt(Yt(po)))}function uo(){co=this;var e=this,t=xr(0);t.q3(),e.u3_1=so(t)}var co;function mo(){return co==null&&new uo,co}Yt(po).f1=function(){return this.y1_1.q3(),this.i()>0?this:mo().u3_1};function po(){}function _o(e){return en(e),yo.call(e),e}function fo(){var e=_o(Mt(Yt(yo)));return Xt(e,fo),e}function go(e,t){return en(t,e),yo.call(t),t}function ho(e){var t=go(e,Mt(Yt(yo)));return Xt(t,ho),t}function yo(){Xt(this,yo)}function Co(e){return Po(e),Ro.call(e),e}function bo(){var e=Co(Mt(Yt(Ro)));return Xt(e,bo),e}function vo(e,t){return Mo(e,t),Ro.call(t),t}function So(e){var t=vo(e,Mt(Yt(Ro)));return Xt(t,So),t}function Ro(){Xt(this,Ro)}function Lo(e){return Po(e),To.call(e),e}function Eo(){var e=Lo(Mt(Yt(To)));return Xt(e,Eo),e}function ko(e,t){return Mo(e,t),To.call(t),t}function Io(e){var t=ko(e,Mt(Yt(To)));return Xt(t,Io),t}function To(){Xt(this,To)}function Do(e){return Po(e),$o.call(e),e}function xo(){var e=Do(Mt(Yt($o)));return Xt(e,xo),e}function $o(){Xt(this,$o)}function Po(e){return _o(e),Ao.call(e),e}function No(){var e=Po(Mt(Yt(Ao)));return Xt(e,No),e}function Mo(e,t){return go(e,t),Ao.call(t),t}function wo(e){var t=Mo(e,Mt(Yt(Ao)));return Xt(t,wo),t}function Ao(){Xt(this,Ao)}function Fo(e){return Po(e),Bo.call(e),e}function Oo(){var e=Fo(Mt(Yt(Bo)));return Xt(e,Oo),e}function Bo(){Xt(this,Bo)}function Wo(e){return Po(e),Ho.call(e),e}function qo(){var e=Wo(Mt(Yt(Ho)));return Xt(e,qo),e}function Uo(e,t){return Mo(e,t),Ho.call(t),t}function Vo(e){var t=Uo(e,Mt(Yt(Ho)));return Xt(t,Vo),t}function Ho(){Xt(this,Ho)}function Go(e){return Co(e),Qo.call(e),e}function zo(){var e=Go(Mt(Yt(Qo)));return Xt(e,zo),e}function jo(e,t){return vo(e,t),Qo.call(t),t}function Ko(e){var t=jo(e,Mt(Yt(Qo)));return Xt(t,Ko),t}function Qo(){Xt(this,Qo)}function Xo(e){return Po(e),ea.call(e),e}function Yo(){var e=Xo(Mt(Yt(ea)));return Xt(e,Yo),e}function Jo(e,t){return Mo(e,t),ea.call(t),t}function Zo(e){var t=Jo(e,Mt(Yt(ea)));return Xt(t,Zo),t}function ea(){Xt(this,ea)}function ta(e){return Po(e),ra.call(e),e}function na(){var e=ta(Mt(Yt(ra)));return Xt(e,na),e}function ra(){Xt(this,ra)}function oa(e){return Po(e),ia.call(e),e}function aa(){var e=oa(Mt(Yt(ia)));return Xt(e,aa),e}function ia(){Xt(this,ia)}function la(e){return Po(e),ua.call(e),e}function sa(){var e=la(Mt(Yt(ua)));return Xt(e,sa),e}function ua(){Xt(this,ua)}function ca(e,t){for(var n=e.length,r=t.length,o=0,a=t;o<n&&o<r;){var i=o,l=o;o=l+1|0,a[i]=e[l]}return t}function da(e,t,n){var r=e.slice(0,t);e.$type$!==void 0&&(r.$type$=e.$type$);var o=e.length;if(t>o)for(r.length=t;o<t;){var a=o;o=a+1|0,r[a]=n}return r}function ma(e){return _a.call(e,null),e}function pa(){var e=ma(Mt(Yt(_a)));return Xt(e,pa),e}function _a(e){go(e,this),Xt(this,_a)}function fa(e,t){return ha(t),t}function ga(e){return fa(e,Mt(Yt(Ca)))}function ha(e){return Ca.call(e,""),e}function ya(){return ha(Mt(Yt(Ca)))}function Ca(e){this.m3_1=e}Yt(Ca).p3=function(e){return this.m3_1=this.m3_1+P(e),this},Yt(Ca).e=function(e){return this.m3_1=this.m3_1+z(e),this},Yt(Ca).n3=function(e){return this.m3_1=this.m3_1+z(e),this},Yt(Ca).o3=function(e){var t=this,n=this.m3_1;return t.m3_1=n+(e==null?"null":e),this},Yt(Ca).toString=function(){return this.m3_1};function ba(e){var t=P(e).toUpperCase();return t.length>1?e:nt(t,0)}function va(e){if(!(2<=e&&e<=36))throw So("radix "+e+" was not in valid range 2..36");return e}function Sa(e){var t=di(e),n;return t==null?mi(e):n=t,n}function Ra(e,t){var n=D(e,48)>=0&&D(e,57)<=0?x(e,48):D(e,65)>=0&&D(e,90)<=0?x(e,65)+10|0:D(e,97)>=0&&D(e,122)<=0?x(e,97)+10|0:D(e,128)<0?-1:D(e,65313)>=0&&D(e,65338)<=0?x(e,65313)+10|0:D(e,65345)>=0&&D(e,65370)<=0?x(e,65345)+10|0:On(e);return n>=t?-1:n}var La;function Ea(e,t,n){if(n=n===Dn?!1:n,xa(),n){var r=e.length,o=t.length,a=Math.min(r,o);if(a===0)return r-o|0;var i=0;if(i<a)do{var l=i;i=i+1|0;var s=nt(e,l),u=nt(t,l);if(s!==u&&(s=ba(s),u=ba(u),s!==u)){var c=s,d=P(c).toLowerCase();s=nt(d,0);var m=u,p=P(m).toLowerCase();if(u=nt(p,0),s!==u)return D(s,u)}}while(i<a);return r-o|0}else return It(e,t)}function ka(e){return xa(),Na(e,0,e.length,!1)}function Ia(e){this.x3_1=e}Yt(Ia).y3=function(e,t){return this.x3_1(e,t)},Yt(Ia).compare=function(e,t){return this.y3(e,t)},Yt(Ia).d1=function(){return this.x3_1},Yt(Ia).equals=function(e){var t;if(e!=null&&En(e,Vn)){var n;e!=null&&En(e,ne)?n=At(this.d1(),e.d1()):n=!1,t=n}else t=!1;return t},Yt(Ia).hashCode=function(){return Ft(this.d1())};function Ta(e,t){return xa(),Ea(e,t,!0)}var Da;function xa(){if(!Da){Da=!0;var e=Ta;La=new Ia(e)}}function $a(){return Fa(),Pa}var Pa;function Na(t,n,r,o){if(Fa(),!(n>=0&&r<=t.length&&n<=r)){var a="Failed requirement.";throw So(Ot(a))}for(var i=new Int8Array(e(r-n|0,3)),l=0,s=n;s<r;){var u=s;s=u+1|0;var c=nt(t,u),d=$(c);if(d<128){var m=l;l=m+1|0,i[m]=bn(d)}else if(d<2048){var p=l;l=p+1|0,i[p]=bn(d>>6|192);var _=l;l=_+1|0,i[_]=bn(d&63|128)}else if(d<55296||d>=57344){var f=l;l=f+1|0,i[f]=bn(d>>12|224);var g=l;l=g+1|0,i[g]=bn(d>>6&63|128);var h=l;l=h+1|0,i[h]=bn(d&63|128)}else{var y=Ma(t,d,s,r,o);if(y<=0){var C=l;l=C+1|0,i[C]=$a()[0];var b=l;l=b+1|0,i[b]=$a()[1];var v=l;l=v+1|0,i[v]=$a()[2]}else{var S=l;l=S+1|0,i[S]=bn(y>>18|240);var R=l;l=R+1|0,i[R]=bn(y>>12&63|128);var L=l;l=L+1|0,i[L]=bn(y>>6&63|128);var E=l;l=E+1|0,i[E]=bn(y&63|128),s=s+1|0}}}return i.length===l?i:wn(i,l)}function Ma(e,t,n,r,o){if(Fa(),!(55296<=t&&t<=56319)||n>=r)return wa(0,n,o);var a=nt(e,n),i=$(a);return 56320<=i&&i<=57343?65536+((t&1023)<<10)|0|i&1023:wa(0,n,o)}function wa(e,t,n){if(Fa(),n)throw new _a("Malformed sequence starting at "+(t-1|0));return-e|0}var Aa;function Fa(){Aa||(Aa=!0,Pa=new Int8Array([-17,-65,-67]))}function Oa(e){return function(t){return t===e?"(this Collection)":z(t)}}function Ba(){}Yt(Ba).k=function(e){var t;e:{var n;if(En(this,w)?n=this.j():n=!1,n){t=!1;break e}for(var r=this.f();r.g();){var o=r.h();if(At(o,e)){t=!0;break e}}t=!1}return t},Yt(Ba).m=function(e){var t;e:{var n;if(En(e,w)?n=e.j():n=!1,n){t=!0;break e}for(var r=e.f();r.g();){var o=r.h();if(!this.k(o)){t=!1;break e}}t=!0}return t},Yt(Ba).j=function(){return this.i()===0},Yt(Ba).toString=function(){return S(this,", ","[","]",Dn,Dn,Oa(this))},Yt(Ba).toArray=function(){return Qn(this)};function Wa(e){this.a4_1=e,this.z3_1=0}Yt(Wa).g=function(){return this.z3_1<this.a4_1.i()},Yt(Wa).h=function(){if(!this.g())throw Oo();var e=this.z3_1;return this.z3_1=e+1|0,this.a4_1.l(e)};function qa(){this.g1_1=2147483639}Yt(qa).v1=function(e,t){if(e<0||e>=t)throw Vo("index: "+e+", size: "+t)},Yt(qa).w1=function(e,t){if(e<0||e>t)throw Vo("index: "+e+", size: "+t)},Yt(qa).h1=function(e,t,n){if(e<0||t>n)throw Vo("fromIndex: "+e+", toIndex: "+t+", size: "+n);if(e>t)throw So("fromIndex: "+e+" > toIndex: "+t)},Yt(qa).p2=function(e,t){var n=e+(e>>1)|0;return(n-t|0)<0&&(n=t),(n-2147483639|0)>0&&(n=t>2147483639?2147483647:2147483639),n},Yt(qa).r1=function(t){for(var n=1,r=t.f();r.g();){var o=r.h(),a=e(31,n),i=o==null?null:Ft(o);n=a+(i==null?0:i)|0}return n},Yt(qa).q1=function(e,t){if(e.i()!==t.i())return!1;for(var n=t.f(),r=e.f();r.g();){var o=r.h(),a=n.h();if(!At(o,a))return!1}return!0};var Ua;function Va(){return Ua}function Ha(){Ba.call(this)}Yt(Ha).f=function(){return new Wa(this)},Yt(Ha).equals=function(e){return e===this?!0:e!=null&&En(e,M)?Ua.q1(this,e):!1},Yt(Ha).hashCode=function(){return Ua.r1(this)};function Ga(){}Yt(Ga).t1=function(e){for(var t=0,n=e.f();n.g();){var r=n.h(),o=t,a=r==null?null:Ft(r);t=o+(a==null?0:a)|0}return t},Yt(Ga).s1=function(e,t){return e.i()!==t.i()?!1:e.m(t)};var za;function ja(){return za}function Ka(e){if(e.j())return[];for(var t=e.i(),n=Array(t),r=e.f(),o=0;r.g();){var a=o;o=a+1|0,n[a]=r.h()}return n}function Qa(){return ti()}function Xa(){}Yt(Xa).g=function(){return!1},Yt(Xa).h=function(){throw Oo()};var Ya;function Ja(){return Ya}function Za(){ei=this,this.b4_1=new X(-1478467534,-1720727600)}Yt(Za).equals=function(e){var t;return e!=null&&En(e,M)?t=e.j():t=!1,t},Yt(Za).hashCode=function(){return 1},Yt(Za).toString=function(){return"[]"},Yt(Za).i=function(){return 0},Yt(Za).j=function(){return!0},Yt(Za).f=function(){return Ya};var ei;function ti(){return ei==null&&new Za,ei}function ni(e){return p(e)}function ri(){return ii()}function oi(){ai=this,this.c4_1=new X(1993859828,793161749)}Yt(oi).equals=function(e){var t;return e!=null&&En(e,B)?t=e.j():t=!1,t},Yt(oi).hashCode=function(){return 0},Yt(oi).toString=function(){return"[]"},Yt(oi).i=function(){return 0},Yt(oi).j=function(){return!0},Yt(oi).d4=function(e){return!1},Yt(oi).k=function(e){return!1;var t},Yt(oi).e4=function(e){return e.j()},Yt(oi).m=function(e){return this.e4(e)},Yt(oi).f=function(){return Ya};var ai;function ii(){return ai==null&&new oi,ai}function li(e){return f(e,Sr(e.length))}function si(e){return new ui(e)}function ui(e){Ha.call(this),this.f4_1=e}Yt(ui).i=function(){return this.f4_1.length},Yt(ui).l=function(e){return Ua.v1(e,this.f4_1.length),this.f4_1[e]},Yt(ui).g4=function(e){if(e===null)return!1;var t=v(this.f4_1,e.r_1);return t===e},Yt(ui).k=function(e){return e instanceof G?this.g4(e instanceof G?e:an()):!1};function ci(e,t,n){n!=null?e.e(n(t)):t==null||In(t)?e.e(t):t instanceof N?e.p3(t.h4_1):e.e(Ot(t))}function di(e){return pi(e,10)}function mi(e){throw Ko("Invalid number format: '"+e+"'")}function pi(e,t){va(t);var n=e.length;if(n===0)return null;var r,o,a,i=nt(e,0);if(D(i,48)<0){if(n===1)return null;if(r=1,i===45)o=!0,a=new X(0,-2147483648);else if(i===43)o=!1,a=new X(1,-2147483648);else return null}else r=0,o=!1,a=new X(1,-2147483648);var l=new X(1,-2147483648),s=Ne(l,He(36)),u=s,c=new X(0,0),d=r;if(d<n)do{var m=d;d=d+1|0;var p=Ra(nt(e,m),t);if(p<0)return null;if(De(c,u)<0)if(Ue(u,s)){var _=a;if(u=Ne(_,He(t)),De(c,u)<0)return null}else return null;var f=c;c=Pe(f,He(t));var g=c,h=a,y=xe(h,He(p));if(De(g,y)<0)return null;var C=c;c=$e(C,He(p))}while(d<n);return o?c:Ke(c)}Yt(rr).asJsReadonlySetView=u,Yt(eo).r2=c,Yt(oi).asJsReadonlySetView=u,F=new A,V=new U,jn=new zn,Kr=new jr,Ua=new qa,za=new Ga,Ya=new Xa;var _i={getInstance:O};i.KtSet=_i,i.primitiveArrayConcatwxgknw08pmlb=Cn,i.VOID3gxj6tk5isa35=Dn,i.Exception_init_$Init$7nmtst2tre47=_o,i.IllegalArgumentException_init_$Create$3ewkh27kzt8z8=So,i.RuntimeException_init_$Create$17ncyu0a6xfek=wo,i.Unit_instance1fbcbse1fwigr=jn,i.arrayCopytctsywo3h7gj=Zn,i.contentEquals1cdp6c846cfdi=Pn,i.contentHashCode25jw6rgkgywwr=Nn,i.copyOfRange3alro60z4hhf8=Mn,i.setOf45ia9pnfhe90=ni,i.takeLast725nefakqsdr=_,i.toByteArray3caw0hip00os=L,i.toSet1glep2u1u9tcb=p,i.enumEntries20mr21zbe3az4=si,i.bitwiseAnd2g7wmsfd45l12=Ae,i.convertToByte1epqhkuyxuz5a=Oe,i.fromInt1lka3ktyu79a4=He,i.shiftRight2cr6y79ufiihy=we,i.captureStack1fzi4aczwc4hg=Xt,i.defineProp3ur6h3slcvq4x=wt,i.initMetadataForClassbxx6q50dy2s7=dn,i.initMetadataForCompanion1wyw17z38v6ac=yn,i.initMetadataForInterface1egvbzx539z91=_n,i.objectCreate1ve4bgxiu4x98=Mt,i.protoOf180f3jzyo7rfj=Yt,i.encodeToByteArray1onwao0uakjfh=ka,i.toLongkk4waq8msp1k=Sa,i.Enum3alwj03lh1n41=G,i.Exceptiondt2hlxn7j7vw=yo,i.Long2qws0ah9gnpki=X,i.THROW_IAE23kobfj9wdoxr=ln,i.noWhenBranchMatchedException2a6r7ubxgky5j=on}),66);
__d("wa-kmp-syncd-engine-interfaces",["kotlin-kotlin-stdlib"],(function(t,n,r,o,a,i,l){var e;(e=o("kotlin-kotlin-stdlib")).initMetadataForCompanion1wyw17z38v6ac(f),e.initMetadataForClassbxx6q50dy2s7(E,"KmpSyncdCollectionName",e.VOID3gxj6tk5isa35,e.Enum3alwj03lh1n41);function s(e){var t;try{t=this.getForInternal(e)}catch(e){var n;if(e instanceof o("kotlin-kotlin-stdlib").Exceptiondt2hlxn7j7vw){var r=e;throw new ie(r)}else throw e}return t}e.initMetadataForInterface1egvbzx539z91($,"KmpDerivedSyncdKeysProvider"),e.initMetadataForClassbxx6q50dy2s7(P,"KmpSyncdCryptoActionData"),e.initMetadataForClassbxx6q50dy2s7(N,"KmpSyncdCryptoDerivedKeys"),e.initMetadataForCompanion1wyw17z38v6ac(A),e.initMetadataForClassbxx6q50dy2s7(B,"KmpSyncdCryptoEncryptedData"),e.initMetadataForClassbxx6q50dy2s7(W,"KmpSyncdCryptoMutationData"),e.initMetadataForClassbxx6q50dy2s7(q,"KmpSyncdCryptoMutationKey"),e.initMetadataForClassbxx6q50dy2s7(U,"KmpSyncdCryptoMutationKeyId"),e.initMetadataForClassbxx6q50dy2s7(Q,"KmpSyncdCryptoMutationOperation",e.VOID3gxj6tk5isa35,e.Enum3alwj03lh1n41),e.initMetadataForInterface1egvbzx539z91(J,"KmpSyncdCryptoProvider");function u(e,t,n,r){return this.createInternal(e,t,n,r)}e.initMetadataForInterface1egvbzx539z91(Z,"KmpSyncdMutationDataFactory"),e.initMetadataForInterface1egvbzx539z91(ee,"KmpSyncdEncryptionProtobufProvider"),e.initMetadataForInterface1egvbzx539z91(te,"KmpSyncdProtobufProvider",e.VOID3gxj6tk5isa35,e.VOID3gxj6tk5isa35,[ee]),e.initMetadataForCompanion1wyw17z38v6ac(ne),e.initMetadataForClassbxx6q50dy2s7(ae,"KmpSyncdCipherException",ae,e.Exceptiondt2hlxn7j7vw),e.initMetadataForClassbxx6q50dy2s7(ie,"KmpSyncdKeyException",e.VOID3gxj6tk5isa35,e.Exceptiondt2hlxn7j7vw),e.initMetadataForClassbxx6q50dy2s7(le,"KmpSyncdMutationException",e.VOID3gxj6tk5isa35,e.Exceptiondt2hlxn7j7vw),e.initMetadataForCompanion1wyw17z38v6ac(_e),e.initMetadataForClassbxx6q50dy2s7(Le,"KmpSyncdMutationExceptionReason",e.VOID3gxj6tk5isa35,e.Enum3alwj03lh1n41),e.initMetadataForCompanion1wyw17z38v6ac($e),e.initMetadataForClassbxx6q50dy2s7(Me,"KmpSyncdParseException",e.VOID3gxj6tk5isa35,e.Exceptiondt2hlxn7j7vw),e.initMetadataForClassbxx6q50dy2s7(qe,"OpMode",e.VOID3gxj6tk5isa35,e.Enum3alwj03lh1n41),e.initMetadataForClassbxx6q50dy2s7(Ke,"MacAlgo",e.VOID3gxj6tk5isa35,e.Enum3alwj03lh1n41),e.initMetadataForClassbxx6q50dy2s7(Ze,"JsKmpDerivedSyncdKeysProviderImpl",e.VOID3gxj6tk5isa35,e.VOID3gxj6tk5isa35,[$]),e.initMetadataForClassbxx6q50dy2s7(et,"JsKmpSyncdCryptoProviderImpl",e.VOID3gxj6tk5isa35,e.VOID3gxj6tk5isa35,[J]),e.initMetadataForClassbxx6q50dy2s7(tt,"JsKmpSyncdMutationDataFactoryImpl",e.VOID3gxj6tk5isa35,e.VOID3gxj6tk5isa35,[Z]),e.initMetadataForClassbxx6q50dy2s7(nt,"JsKmpSyncdProtobufProviderImpl",e.VOID3gxj6tk5isa35,e.VOID3gxj6tk5isa35,[te]),e.initMetadataForClassbxx6q50dy2s7(at,"KmpResult"),e.initMetadataForCompanion1wyw17z38v6ac(it),e.initMetadataForClassbxx6q50dy2s7(ut,"KmpSyncdCryptoMutationKeyData"),e.initMetadataForClassbxx6q50dy2s7(mt,"KmpLong");var c,d,m,p,_;function f(){g=this;var e=this,t=y();e.i4_1=o("kotlin-kotlin-stdlib").toSet1glep2u1u9tcb(t),this.j4_1=o("kotlin-kotlin-stdlib").setOf45ia9pnfhe90([D(),x()])}e.protoOf180f3jzyo7rfj(f).k4=function(e){var t=y(),n;e:{for(var r=0,a=t.length;r<a;){var i=t[r];if(r=r+1|0,i.value===e){n=i;break e}}n=null}var l=n,s;if(l==null)throw o("kotlin-kotlin-stdlib").IllegalArgumentException_init_$Create$3ewkh27kzt8z8("Unknown collection name: "+e);return s=l,s},e.protoOf180f3jzyo7rfj(f).n4=function(){return this.i4_1},e.protoOf180f3jzyo7rfj(f).o4=function(){return this.j4_1};var g;function h(){return L(),g==null&&new f,g}function y(){return[k(),I(),T(),D(),x()]}function C(e){switch(e){case"Regular":return k();case"RegularLow":return I();case"RegularHigh":return T();case"CriticalBlock":return D();case"CriticalUnblockLow":return x();default:L(),o("kotlin-kotlin-stdlib").THROW_IAE23kobfj9wdoxr("No enum constant com.whatsapp.kmp.syncd.syncdengine.core.model.KmpSyncdCollectionName."+e);break}}function b(e){return h().k4(e)}function v(){return h().i4_1}function S(){return h().j4_1}var R;function L(){if(R)return o("kotlin-kotlin-stdlib").Unit_instance1fbcbse1fwigr;R=!0,c=new E("Regular",0,"regular"),d=new E("RegularLow",1,"regular_low"),m=new E("RegularHigh",2,"regular_high"),p=new E("CriticalBlock",3,"critical_block"),_=new E("CriticalUnblockLow",4,"critical_unblock_low"),h()}function E(e,t,n){o("kotlin-kotlin-stdlib").Enum3alwj03lh1n41.call(this,e,t),this.value=n}e.protoOf180f3jzyo7rfj(E).o=function(){return this.value},e.protoOf180f3jzyo7rfj(E).toWamSyncdCollectionType=function(){var e;switch(this.r_1){case 0:e=1;break;case 1:e=2;break;case 2:e=3;break;case 3:e=4;break;case 4:e=5;break;default:o("kotlin-kotlin-stdlib").noWhenBranchMatchedException2a6r7ubxgky5j();break}return e},e.protoOf180f3jzyo7rfj(E).toString=function(){return o("kotlin-kotlin-stdlib").protoOf180f3jzyo7rfj(o("kotlin-kotlin-stdlib").Enum3alwj03lh1n41).toString.call(this)};function k(){return L(),c}function I(){return L(),d}function T(){return L(),m}function D(){return L(),p}function x(){return L(),_}function $(){}function P(e){this.syncdActionData=e}e.protoOf180f3jzyo7rfj(P).p4=function(){return this.syncdActionData},e.protoOf180f3jzyo7rfj(P).toByteArray=function(){return this.syncdActionData};function N(e,t,n,r,o){this.indexKey=e,this.valueEncryptionKey=t,this.valueMacKey=n,this.snapshotMacKey=r,this.patchMacKey=o}e.protoOf180f3jzyo7rfj(N).q4=function(){return this.indexKey},e.protoOf180f3jzyo7rfj(N).r4=function(){return this.valueEncryptionKey},e.protoOf180f3jzyo7rfj(N).s4=function(){return this.valueMacKey},e.protoOf180f3jzyo7rfj(N).t4=function(){return this.snapshotMacKey},e.protoOf180f3jzyo7rfj(N).u4=function(){return this.patchMacKey};function M(e,t,n,r,a){var i;if(r.length>32)i=o("kotlin-kotlin-stdlib").toByteArray3caw0hip00os(o("kotlin-kotlin-stdlib").takeLast725nefakqsdr(r,32));else{var l=new Int8Array(32),s=32-r.length|0,u=r.length,c=r;o("kotlin-kotlin-stdlib").arrayCopytctsywo3h7gj(c,l,s,0,u),i=l}return B.call(a,e,t,n,r,i),a}function w(e,t,n,r){return M(e,t,n,r,o("kotlin-kotlin-stdlib").objectCreate1ve4bgxiu4x98(o("kotlin-kotlin-stdlib").protoOf180f3jzyo7rfj(B)))}function A(){this.v4_1=32}var F;function O(){return F}function B(e,t,n,r,o){this.keyId=e,this.indexHash=t,this.operation=n,this.indexAndValueCipherText=r,this.mutationMac=o}e.protoOf180f3jzyo7rfj(B).w4=function(){return this.keyId},e.protoOf180f3jzyo7rfj(B).x4=function(){return this.indexHash},e.protoOf180f3jzyo7rfj(B).y4=function(){return this.operation},e.protoOf180f3jzyo7rfj(B).z4=function(){return this.indexAndValueCipherText},e.protoOf180f3jzyo7rfj(B).a5=function(){return this.mutationMac};function W(e,t,n,r,o,a){this.index=e,this.version=t,this.keyId=n,this.operation=r,this.value=o,this.mutationMac=a}e.protoOf180f3jzyo7rfj(W).b5=function(){return this.index},e.protoOf180f3jzyo7rfj(W).c5=function(){return this.version},e.protoOf180f3jzyo7rfj(W).w4=function(){return this.keyId},e.protoOf180f3jzyo7rfj(W).y4=function(){return this.operation},e.protoOf180f3jzyo7rfj(W).o=function(){return this.value},e.protoOf180f3jzyo7rfj(W).a5=function(){return this.mutationMac};function q(e,t){this.keyId=e,this.keyData=t}e.protoOf180f3jzyo7rfj(q).w4=function(){return this.keyId},e.protoOf180f3jzyo7rfj(q).d5=function(){return this.keyData};function U(e){this.bytes=e}e.protoOf180f3jzyo7rfj(U).e5=function(){return this.bytes},e.protoOf180f3jzyo7rfj(U).equals=function(e){var t;return e instanceof U?t=o("kotlin-kotlin-stdlib").contentEquals1cdp6c846cfdi(e.bytes,this.bytes):t=!1,t},e.protoOf180f3jzyo7rfj(U).hashCode=function(){return o("kotlin-kotlin-stdlib").contentHashCode25jw6rgkgywwr(this.bytes)};var V,H;function G(){return[X(),Y()]}function z(e){switch(e){case"Set":return X();case"Remove":return Y();default:K(),o("kotlin-kotlin-stdlib").THROW_IAE23kobfj9wdoxr("No enum constant com.whatsapp.kmp.syncd.syncdengine.cryptomanager.KmpSyncdCryptoMutationOperation."+e);break}}var j;function K(){if(j)return o("kotlin-kotlin-stdlib").Unit_instance1fbcbse1fwigr;j=!0,V=new Q("Set",0,1),H=new Q("Remove",1,2)}function Q(e,t,n){o("kotlin-kotlin-stdlib").Enum3alwj03lh1n41.call(this,e,t),this.h5_1=n}e.protoOf180f3jzyo7rfj(Q).asBytes=function(){return new Int8Array([this.h5_1])};function X(){return K(),V}function Y(){return K(),H}function J(){}function Z(){}function ee(){}function te(){}function ne(){this.i5_1="Data mac corrupt",this.j5_1="Index hash corrupt"}e.protoOf180f3jzyo7rfj(ne).k5=function(){return this.i5_1},e.protoOf180f3jzyo7rfj(ne).l5=function(){return this.j5_1};var re;function oe(){return re}function ae(e,t){e=e===o("kotlin-kotlin-stdlib").VOID3gxj6tk5isa35?null:e,t=t===o("kotlin-kotlin-stdlib").VOID3gxj6tk5isa35?null:t,o("kotlin-kotlin-stdlib").Exception_init_$Init$7nmtst2tre47(this),o("kotlin-kotlin-stdlib").captureStack1fzi4aczwc4hg(this,ae),this.m5_1=e,this.n5_1=t,delete this.message,delete this.cause}e.protoOf180f3jzyo7rfj(ae).v3=function(){return this.m5_1},e.protoOf180f3jzyo7rfj(ae).w3=function(){return this.n5_1};function ie(e){o("kotlin-kotlin-stdlib").Exception_init_$Init$7nmtst2tre47(this),o("kotlin-kotlin-stdlib").captureStack1fzi4aczwc4hg(this,ie),this.o5_1=e,delete this.cause}e.protoOf180f3jzyo7rfj(ie).w3=function(){return this.o5_1};function le(e,t,n){t=t===o("kotlin-kotlin-stdlib").VOID3gxj6tk5isa35?"MalformedMutationException with reason="+e.toString():t,n=n===o("kotlin-kotlin-stdlib").VOID3gxj6tk5isa35?null:n,o("kotlin-kotlin-stdlib").Exception_init_$Init$7nmtst2tre47(this),o("kotlin-kotlin-stdlib").captureStack1fzi4aczwc4hg(this,le),this.reason=e,this.p5_1=t,this.q5_1=n,delete this.message,delete this.cause}e.protoOf180f3jzyo7rfj(le).r5=function(){return this.reason},e.protoOf180f3jzyo7rfj(le).v3=function(){return this.p5_1},e.protoOf180f3jzyo7rfj(le).w3=function(){return this.q5_1};var se,ue,ce,de,me,pe;function _e(){}e.protoOf180f3jzyo7rfj(_e).s5=function(e){var t=Ce(),n;e:{for(var r=t.f();r.g();){var a=r.h();if(a.code===e){n=a;break e}}n=null}var i=n,l;if(i==null)throw o("kotlin-kotlin-stdlib").IllegalArgumentException_init_$Create$3ewkh27kzt8z8("Unknown mutation exception reason: "+e);return l=i,l};var fe;function ge(){return fe}function he(){return[Ee(),ke(),Ie(),Te(),De(),xe()]}function ye(e){switch(e){case"UNPARSABLE":return Ee();case"MISSING_INDEX":return ke();case"MISSING_VALUE":return Ie();case"MISSING_VERSION":return Te();case"INVALID_INDEX_FORMAT":return De();case"MISSING_ACTION_TIMESTAMP":return xe();default:Se(),o("kotlin-kotlin-stdlib").THROW_IAE23kobfj9wdoxr("No enum constant com.whatsapp.kmp.syncd.syncdengine.exception.KmpSyncdMutationExceptionReason."+e);break}}function Ce(){return Re==null&&(Re=o("kotlin-kotlin-stdlib").enumEntries20mr21zbe3az4(he())),Re}function be(e){return fe.s5(e)}var ve;function Se(){if(ve)return o("kotlin-kotlin-stdlib").Unit_instance1fbcbse1fwigr;ve=!0,se=new Le("UNPARSABLE",0,0),ue=new Le("MISSING_INDEX",1,1),ce=new Le("MISSING_VALUE",2,2),de=new Le("MISSING_VERSION",3,3),me=new Le("INVALID_INDEX_FORMAT",4,4),pe=new Le("MISSING_ACTION_TIMESTAMP",5,7)}var Re;function Le(e,t,n){o("kotlin-kotlin-stdlib").Enum3alwj03lh1n41.call(this,e,t),this.code=n}e.protoOf180f3jzyo7rfj(Le).v5=function(){return this.code};function Ee(){return Se(),se}function ke(){return Se(),ue}function Ie(){return Se(),ce}function Te(){return Se(),de}function De(){return Se(),me}function xe(){return Se(),pe}function $e(){this.w5_1="Cipher text too short"}e.protoOf180f3jzyo7rfj($e).x5=function(){return this.w5_1};var Pe;function Ne(){return Pe}function Me(e){o("kotlin-kotlin-stdlib").Exception_init_$Init$7nmtst2tre47(this),o("kotlin-kotlin-stdlib").captureStack1fzi4aczwc4hg(this,Me),this.y5_1=e,delete this.message}e.protoOf180f3jzyo7rfj(Me).v3=function(){return this.y5_1};var we,Ae;function Fe(){return[Qe(),Xe()]}function Oe(e){switch(e){case"ENCRYPT":return Qe();case"DECRYPT":return Xe();default:We(),o("kotlin-kotlin-stdlib").THROW_IAE23kobfj9wdoxr("No enum constant com.whatsapp.kmp.syncd.syncdengine.utils.primitives.OpMode."+e);break}}var Be;function We(){if(Be)return o("kotlin-kotlin-stdlib").Unit_instance1fbcbse1fwigr;Be=!0,we=new qe("ENCRYPT",0),Ae=new qe("DECRYPT",1)}function qe(e,t){o("kotlin-kotlin-stdlib").Enum3alwj03lh1n41.call(this,e,t)}var Ue,Ve;function He(){return[Ye(),Je()]}function Ge(e){switch(e){case"HMAC_SHA_256":return Ye();case"HMAC_SHA_512":return Je();default:je(),o("kotlin-kotlin-stdlib").THROW_IAE23kobfj9wdoxr("No enum constant com.whatsapp.kmp.syncd.syncdengine.utils.primitives.MacAlgo."+e);break}}var ze;function je(){if(ze)return o("kotlin-kotlin-stdlib").Unit_instance1fbcbse1fwigr;ze=!0,Ue=new Ke("HMAC_SHA_256",0),Ve=new Ke("HMAC_SHA_512",1)}function Ke(e,t){o("kotlin-kotlin-stdlib").Enum3alwj03lh1n41.call(this,e,t)}function Qe(){return We(),we}function Xe(){return We(),Ae}function Ye(){return je(),Ue}function Je(){return je(),Ve}function Ze(e){this.d6_1=e}e.protoOf180f3jzyo7rfj(Ze).getForInternal=function(e){return this.d6_1.getForInternal(e)};function et(e){this.e6_1=e}e.protoOf180f3jzyo7rfj(et).createCipherText=function(e,t,n,r){return this.e6_1.createCipherText(e,t,n,r)},e.protoOf180f3jzyo7rfj(et).mac=function(e,t,n){return this.e6_1.mac(e,t,n)},e.protoOf180f3jzyo7rfj(et).generateRandomBytes=function(e){return this.e6_1.generateRandomBytes(e)},e.protoOf180f3jzyo7rfj(et).bytesToHexString=function(e){return this.e6_1.bytesToHexString(e)};function tt(e){this.f6_1=e}e.protoOf180f3jzyo7rfj(tt).createInternal=function(e,t,n,r){return this.f6_1.createInternal(e,t,n,r)};function nt(e){this.g6_1=e}e.protoOf180f3jzyo7rfj(nt).encodeMutationDataToSyncdActionData=function(e,t){return this.g6_1.encodeMutationDataToSyncdActionData(e,t)};function rt(e){return function(t){return e(t).toPromise()}}function ot(e){return e}function at(e){this.h6_1=e}e.protoOf180f3jzyo7rfj(at).i6=function(e){var t=this.h6_1.then(e);return new at(t)},e.protoOf180f3jzyo7rfj(at).j6=function(e){var t=this.h6_1.then(rt(e)),n=ot,r=t.then(n);return new at(r)},e.protoOf180f3jzyo7rfj(at).toPromise=function(){return this.h6_1};function it(){}var lt;function st(){return lt}function ut(e){this.keyData=e}e.protoOf180f3jzyo7rfj(ut).d5=function(){return this.keyData};function ct(e,t){return mt.call(t),t.k6_1=o("kotlin-kotlin-stdlib").toLongkk4waq8msp1k(e),t}function dt(e){return ct(e,o("kotlin-kotlin-stdlib").objectCreate1ve4bgxiu4x98(o("kotlin-kotlin-stdlib").protoOf180f3jzyo7rfj(mt)))}e.protoOf180f3jzyo7rfj(mt).o=function(){return this.k6_1},e.protoOf180f3jzyo7rfj(mt).toDecimalString=function(){return this.k6_1.toString()};function mt(){}e.defineProp3ur6h3slcvq4x(e.protoOf180f3jzyo7rfj(E),"name",e.protoOf180f3jzyo7rfj(E).s),e.defineProp3ur6h3slcvq4x(e.protoOf180f3jzyo7rfj(E),"ordinal",e.protoOf180f3jzyo7rfj(E).t),e.defineProp3ur6h3slcvq4x(e.protoOf180f3jzyo7rfj(Q),"name",e.protoOf180f3jzyo7rfj(Q).s),e.defineProp3ur6h3slcvq4x(e.protoOf180f3jzyo7rfj(Q),"ordinal",e.protoOf180f3jzyo7rfj(Q).t),e.defineProp3ur6h3slcvq4x(e.protoOf180f3jzyo7rfj(ae),"message",function(){return this.v3()}),e.defineProp3ur6h3slcvq4x(e.protoOf180f3jzyo7rfj(ae),"cause",function(){return this.w3()}),e.defineProp3ur6h3slcvq4x(e.protoOf180f3jzyo7rfj(ie),"cause",function(){return this.w3()}),e.defineProp3ur6h3slcvq4x(e.protoOf180f3jzyo7rfj(le),"message",function(){return this.v3()}),e.defineProp3ur6h3slcvq4x(e.protoOf180f3jzyo7rfj(le),"cause",function(){return this.w3()}),e.defineProp3ur6h3slcvq4x(e.protoOf180f3jzyo7rfj(Le),"name",e.protoOf180f3jzyo7rfj(Le).s),e.defineProp3ur6h3slcvq4x(e.protoOf180f3jzyo7rfj(Le),"ordinal",e.protoOf180f3jzyo7rfj(Le).t),e.defineProp3ur6h3slcvq4x(e.protoOf180f3jzyo7rfj(Me),"message",function(){return this.v3()}),e.defineProp3ur6h3slcvq4x(e.protoOf180f3jzyo7rfj(qe),"name",e.protoOf180f3jzyo7rfj(qe).s),e.defineProp3ur6h3slcvq4x(e.protoOf180f3jzyo7rfj(qe),"ordinal",e.protoOf180f3jzyo7rfj(qe).t),e.defineProp3ur6h3slcvq4x(e.protoOf180f3jzyo7rfj(Ke),"name",e.protoOf180f3jzyo7rfj(Ke).s),e.defineProp3ur6h3slcvq4x(e.protoOf180f3jzyo7rfj(Ke),"ordinal",e.protoOf180f3jzyo7rfj(Ke).t),e.protoOf180f3jzyo7rfj(Ze).getFor=s,e.protoOf180f3jzyo7rfj(tt).create=u,F=new A,re=new ne,fe=new _e,Pe=new $e,lt=new it,E.values=y,E.valueOf=C,E.fromString=b,e.defineProp3ur6h3slcvq4x(E,"Regular",k,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(E,"RegularLow",I,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(E,"RegularHigh",T,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(E,"CriticalBlock",D,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(E,"CriticalUnblockLow",x,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(E,"ALL_COLLECTIONS",v,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(E,"ALL_CRITICAL_COLLECTIONS",S,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(E,"Companion",h,e.VOID3gxj6tk5isa35,!0),B.createAndCalculateMutationMac=w,e.defineProp3ur6h3slcvq4x(B,"Companion",O,e.VOID3gxj6tk5isa35,!0),Q.values=G,Q.valueOf=z,e.defineProp3ur6h3slcvq4x(Q,"Set",X,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(Q,"Remove",Y,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(ae,"Companion",oe,e.VOID3gxj6tk5isa35,!0),Le.values=he,Le.valueOf=ye,Le.fromInt=be,e.defineProp3ur6h3slcvq4x(Le,"UNPARSABLE",Ee,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(Le,"MISSING_INDEX",ke,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(Le,"MISSING_VALUE",Ie,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(Le,"MISSING_VERSION",Te,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(Le,"INVALID_INDEX_FORMAT",De,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(Le,"MISSING_ACTION_TIMESTAMP",xe,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(Le,"Companion",ge,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(Me,"Companion",Ne,e.VOID3gxj6tk5isa35,!0),qe.values=Fe,qe.valueOf=Oe,e.defineProp3ur6h3slcvq4x(qe,"ENCRYPT",Qe,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(qe,"DECRYPT",Xe,e.VOID3gxj6tk5isa35,!0),Ke.values=He,Ke.valueOf=Ge,e.defineProp3ur6h3slcvq4x(Ke,"HMAC_SHA_256",Ye,e.VOID3gxj6tk5isa35,!0),e.defineProp3ur6h3slcvq4x(Ke,"HMAC_SHA_512",Je,e.VOID3gxj6tk5isa35,!0),mt.fromDecimalString=dt,l.KmpSyncdCollectionName=E,l.KmpSyncdCryptoActionData=P,l.KmpSyncdCryptoDerivedKeys=N,l.KmpSyncdCryptoEncryptedData=B,l.KmpSyncdCryptoMutationData=W,l.KmpSyncdCryptoMutationKey=q,l.KmpSyncdCryptoMutationKeyId=U,l.KmpSyncdCryptoMutationOperation=Q,l.KmpSyncdCipherException=ae,l.KmpSyncdKeyException=ie,l.KmpSyncdMutationException=le,l.KmpSyncdMutationExceptionReason=Le,l.KmpSyncdParseException=Me,l.OpMode=qe,l.MacAlgo=Ke,l.JsKmpDerivedSyncdKeysProviderImpl=Ze,l.JsKmpSyncdCryptoProviderImpl=et,l.JsKmpSyncdMutationDataFactoryImpl=tt,l.JsKmpSyncdProtobufProviderImpl=nt,l.KmpResult=at,l.KmpSyncdCryptoMutationKeyData=ut,l.KmpLong=mt,l.KmpSyncdCryptoEncryptedData2qzy9qni0hrm2=B,l.KmpSyncdCipherException1yr5ole70ur3d=ae,l.KmpSyncdParseException1owflwptcaobs=Me,l.MacAlgo_HMAC_SHA_256_getInstance3mchsdvnjagj8=Ye,l.MacAlgo_HMAC_SHA_512_getInstances0w60r7tu8vg=Je,l.OpMode_DECRYPT_getInstance1ub7qnw77sd5o=Xe,l.OpMode_ENCRYPT_getInstance1dfeme89me53k=Qe}),98);
__d("wa-kmp-syncd-engine",["kotlin-kotlin-stdlib","wa-kmp-syncd-engine-interfaces"],(function(t,n,r,o,a,i,l){var e;(e=o("kotlin-kotlin-stdlib")).initMetadataForCompanion1wyw17z38v6ac(d),e.initMetadataForClassbxx6q50dy2s7(E,"KmpSyncdEncryptionManager"),e.initMetadataForClassbxx6q50dy2s7(k,"KmpSyncdMutationDataWithPlaintext");function s(e){var t;return new Int8Array([(t=o("kotlin-kotlin-stdlib")).convertToByte1epqhkuyxuz5a(t.bitwiseAnd2g7wmsfd45l12(t.shiftRight2cr6y79ufiihy(e,56),new t.Long2qws0ah9gnpki(255,0))),t.convertToByte1epqhkuyxuz5a(t.bitwiseAnd2g7wmsfd45l12(t.shiftRight2cr6y79ufiihy(e,48),new t.Long2qws0ah9gnpki(255,0))),t.convertToByte1epqhkuyxuz5a(t.bitwiseAnd2g7wmsfd45l12(t.shiftRight2cr6y79ufiihy(e,40),new t.Long2qws0ah9gnpki(255,0))),t.convertToByte1epqhkuyxuz5a(t.bitwiseAnd2g7wmsfd45l12(t.shiftRight2cr6y79ufiihy(e,32),new t.Long2qws0ah9gnpki(255,0))),t.convertToByte1epqhkuyxuz5a(t.bitwiseAnd2g7wmsfd45l12(t.shiftRight2cr6y79ufiihy(e,24),new t.Long2qws0ah9gnpki(255,0))),t.convertToByte1epqhkuyxuz5a(t.bitwiseAnd2g7wmsfd45l12(t.shiftRight2cr6y79ufiihy(e,16),new t.Long2qws0ah9gnpki(255,0))),t.convertToByte1epqhkuyxuz5a(t.bitwiseAnd2g7wmsfd45l12(t.shiftRight2cr6y79ufiihy(e,8),new t.Long2qws0ah9gnpki(255,0))),t.convertToByte1epqhkuyxuz5a(t.bitwiseAnd2g7wmsfd45l12(e,new t.Long2qws0ah9gnpki(255,0)))])}function u(e,t,n,r,a){var i,l=t.bytes,u=(i=o("kotlin-kotlin-stdlib")).primitiveArrayConcatwxgknw08pmlb([n,l]),c=s(i.fromInt1lka3ktyu79a4(u.length)),d=o("wa-kmp-syncd-engine-interfaces").MacAlgo_HMAC_SHA_512_getInstances0w60r7tu8vg(),m=i.primitiveArrayConcatwxgknw08pmlb([u,a]),p=i.primitiveArrayConcatwxgknw08pmlb([m,c]),_=e.n6_1.mac(d,p,r);return _.i6(L)}function c(e,t,n){var r=(0-t|0)-n|0,o=Math.max(0,r);return e.n6_1.generateRandomBytes(o)}function d(){this.p6_1=16,this.q6_1=0,this.r6_1=32}e.protoOf180f3jzyo7rfj(d).s6=function(){throw o("kotlin-kotlin-stdlib").RuntimeException_init_$Create$17ncyu0a6xfek("This is a test crash from KMP - WASyncDEngine")};var m;function p(){return m}function _(e,t,n){return function(r){return new(o("wa-kmp-syncd-engine-interfaces")).KmpSyncdCryptoEncryptedData2qzy9qni0hrm2(e.keyId,r,t.operation,n,o("kotlin-kotlin-stdlib").copyOfRange3alro60z4hhf8(n,n.length-32|0,n.length))}}function f(e,t,n,r,a,i){return function(l){var s=e,u=o("kotlin-kotlin-stdlib").primitiveArrayConcatwxgknw08pmlb([s,l]),c=t.n6_1.mac(o("wa-kmp-syncd-engine-interfaces").MacAlgo_HMAC_SHA_256_getInstance3mchsdvnjagj8(),n,r.indexKey);return c.i6(_(a,i,u))}}function g(e,t,n,r,a,i){return function(l){var s=e,c=o("kotlin-kotlin-stdlib").primitiveArrayConcatwxgknw08pmlb([s,l]),d=u(t,n.keyId,r.operation.asBytes(),a.valueMacKey,c);return d.j6(f(c,t,i,a,n,r))}}function h(e,t,n){return function(r){var a=o("kotlin-kotlin-stdlib").encodeToByteArray1onwao0uakjfh(e.index),i=e.value,l;i==null?l=new Int8Array([]):l=i;var s=l,u=t.n6_1.generateRandomBytes(16),d=c(t,a.length,s.length),m=t.o6_1.encodeMutationDataToSyncdActionData(e,d).toByteArray(),p=t.n6_1.createCipherText(o("wa-kmp-syncd-engine-interfaces").OpMode_ENCRYPT_getInstance1dfeme89me53k(),u,m,r.valueEncryptionKey);return p.j6(g(u,t,n,e,r,a))}}function y(e,t,n){return function(r){var a;if(!o("kotlin-kotlin-stdlib").contentEquals1cdp6c846cfdi(e.indexHash,r))throw new(o("wa-kmp-syncd-engine-interfaces")).KmpSyncdCipherException1yr5ole70ur3d("Index hash corrupt");return new k(t,n)}}function C(e,t,n){return function(r){var a=e.m6_1.create(t.keyId,t.operation,r,t.mutationMac),i=e.n6_1.mac(o("wa-kmp-syncd-engine-interfaces").MacAlgo_HMAC_SHA_256_getInstance3mchsdvnjagj8(),o("kotlin-kotlin-stdlib").encodeToByteArray1onwao0uakjfh(a.index),n.indexKey);return i.i6(y(t,a,r))}}function b(e,t,n,r,a,i){return function(l){var s;if(!o("kotlin-kotlin-stdlib").contentEquals1cdp6c846cfdi(e,l))throw new(o("wa-kmp-syncd-engine-interfaces")).KmpSyncdCipherException1yr5ole70ur3d("Data mac corrupt");var u=t.n6_1.createCipherText(o("wa-kmp-syncd-engine-interfaces").OpMode_DECRYPT_getInstance1ub7qnw77sd5o(),n,r,a.valueEncryptionKey);return u.j6(C(t,i,a))}}function v(e,t,n,r,a,i){return function(l){var s=e,c=t,d=o("kotlin-kotlin-stdlib").primitiveArrayConcatwxgknw08pmlb([s,c]),m=n.operation.asBytes(),p=u(r,a.keyId,m,l.valueMacKey,d);return p.j6(b(i,r,e,t,l,n))}}function S(e,t,n,r){return function(a){var i=o("wa-kmp-syncd-engine-interfaces").MacAlgo_HMAC_SHA_256_getInstance3mchsdvnjagj8(),l=t,u=s(n.k6_1),c=o("kotlin-kotlin-stdlib").primitiveArrayConcatwxgknw08pmlb([l,u]),d=o("kotlin-kotlin-stdlib").encodeToByteArray1onwao0uakjfh(r),m=o("kotlin-kotlin-stdlib").primitiveArrayConcatwxgknw08pmlb([c,d]);return e.n6_1.mac(i,m,a.snapshotMacKey)}}function R(e,t,n,r,a){return function(i){var l,u=o("wa-kmp-syncd-engine-interfaces").MacAlgo_HMAC_SHA_256_getInstance3mchsdvnjagj8(),c=t,d=n,m=(l=o("kotlin-kotlin-stdlib")).primitiveArrayConcatwxgknw08pmlb([c,d]),p=s(r.k6_1),_=l.primitiveArrayConcatwxgknw08pmlb([m,p]),f=l.encodeToByteArray1onwao0uakjfh(a),g=l.primitiveArrayConcatwxgknw08pmlb([_,f]);return e.n6_1.mac(u,g,i.patchMacKey)}}function L(e){return o("kotlin-kotlin-stdlib").copyOfRange3alro60z4hhf8(e,0,32)}function E(e,t,n,r){this.l6_1=e,this.m6_1=t,this.n6_1=n,this.o6_1=r}e.protoOf180f3jzyo7rfj(E).encrypt=function(e,t){var n=this.l6_1.getFor(e.keyData);return n.j6(h(t,this,e))},e.protoOf180f3jzyo7rfj(E).decrypt=function(e,t){var n=t.indexAndValueCipherText;if(n.length<48)throw new(o("wa-kmp-syncd-engine-interfaces")).KmpSyncdParseException1owflwptcaobs("Cipher text too short");var r=[o("kotlin-kotlin-stdlib").copyOfRange3alro60z4hhf8(n,0,16),o("kotlin-kotlin-stdlib").copyOfRange3alro60z4hhf8(n,16,n.length-32|0),o("kotlin-kotlin-stdlib").copyOfRange3alro60z4hhf8(n,n.length-32|0,n.length)],a=r[0],i=r[1],l=r[2],s=this.l6_1.getFor(e.keyData);return s.j6(v(a,i,t,this,e,l))},e.protoOf180f3jzyo7rfj(E).calculateSnapshotMac=function(e,t,n,r){var o=this.l6_1.getFor(r);return o.j6(S(this,n,t,e))},e.protoOf180f3jzyo7rfj(E).calculatePatchMac=function(e,t,n,r,o){var a=this.l6_1.getFor(n);return a.j6(R(this,o,r,t,e))};function k(e,t){this.mutation=e,this.plaintext=t}e.protoOf180f3jzyo7rfj(k).t6=function(){return this.mutation},e.protoOf180f3jzyo7rfj(k).u6=function(){return this.plaintext},m=new d,e.defineProp3ur6h3slcvq4x(E,"Companion",p,e.VOID3gxj6tk5isa35,!0),l.KmpSyncdEncryptionManager=E,l.KmpSyncdMutationDataWithPlaintext=k}),98);
__d("wa-kmp-syncd-engine-api",["kotlin-kotlin-stdlib","wa-kmp-syncd-engine","wa-kmp-syncd-engine-interfaces"],(function(t,n,r,o,a,i){var e,l=importNamespace("wa-kmp-syncd-engine").KmpSyncdEncryptionManager,s=importNamespace("wa-kmp-syncd-engine").KmpSyncdMutationDataWithPlaintext,u=(e=importNamespace("wa-kmp-syncd-engine-interfaces")).JsKmpDerivedSyncdKeysProviderImpl,c=e.JsKmpSyncdCryptoProviderImpl,d=e.JsKmpSyncdMutationDataFactoryImpl,m=e.JsKmpSyncdProtobufProviderImpl,p=e.KmpLong,_=e.KmpResult,f=e.KmpSyncdCipherException,g=e.KmpSyncdCollectionName,h=e.KmpSyncdCryptoActionData,y=e.KmpSyncdCryptoDerivedKeys,C=e.KmpSyncdCryptoEncryptedData,b=e.KmpSyncdCryptoMutationData,v=e.KmpSyncdCryptoMutationKey,S=e.KmpSyncdCryptoMutationKeyData,R=e.KmpSyncdCryptoMutationKeyId,L=e.KmpSyncdCryptoMutationOperation,E=e.KmpSyncdKeyException,k=e.KmpSyncdMutationException,I=e.KmpSyncdMutationExceptionReason,T=e.KmpSyncdParseException,D=e.MacAlgo,x=e.OpMode,$=importNamespace("kotlin-kotlin-stdlib").KtSet;i.KmpSyncdEncryptionManager=l,i.KmpSyncdMutationDataWithPlaintext=s,i.JsKmpDerivedSyncdKeysProviderImpl=u,i.JsKmpSyncdCryptoProviderImpl=c,i.JsKmpSyncdMutationDataFactoryImpl=d,i.JsKmpSyncdProtobufProviderImpl=m,i.KmpLong=p,i.KmpResult=_,i.KmpSyncdCipherException=f,i.KmpSyncdCollectionName=g,i.KmpSyncdCryptoActionData=h,i.KmpSyncdCryptoDerivedKeys=y,i.KmpSyncdCryptoEncryptedData=C,i.KmpSyncdCryptoMutationData=b,i.KmpSyncdCryptoMutationKey=v,i.KmpSyncdCryptoMutationKeyData=S,i.KmpSyncdCryptoMutationKeyId=R,i.KmpSyncdCryptoMutationOperation=L,i.KmpSyncdKeyException=E,i.KmpSyncdMutationException=k,i.KmpSyncdMutationExceptionReason=I,i.KmpSyncdParseException=T,i.MacAlgo=D,i.OpMode=x,i.KtSet=$}),66);
__d("WASyncdKmpConversion",["WAArrayBufferUtils","WASyncdKeyTypes","WAWebProtobufSyncAction.pb","WAWebProtobufsServerSync.pb","WAWebSyncdCryptoConst","WAWebSyncdDecode","WAWebSyncdRequestEncode","WAWebSyncdValidateSyncActionProtobuf","decodeProtobuf","encodeProtobuf","wa-kmp-syncd-engine-api"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return new(o("wa-kmp-syncd-engine-api")).KmpSyncdCryptoMutationKeyId(new Int8Array(o("WASyncdKeyTypes").fromSyncKeyId(e)))}function s(e){return new(o("wa-kmp-syncd-engine-api")).KmpSyncdCryptoMutationKeyData(new Int8Array(o("WASyncdKeyTypes").fromSyncKeyData(e)))}function u(e){switch(e){case o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET:return o("wa-kmp-syncd-engine-api").KmpSyncdCryptoMutationOperation.Set;case o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE:return o("wa-kmp-syncd-engine-api").KmpSyncdCryptoMutationOperation.Remove}}function c(t,n){return new(o("wa-kmp-syncd-engine-api")).KmpSyncdCryptoMutationKey(e(t),s(n))}function d(t,n){var r=n.index,a=n.binarySyncAction,i=n.operation,l=n.version,s=n.action;return new(o("wa-kmp-syncd-engine-api")).KmpSyncdCryptoMutationData(r,l,e(t),u(i),new Int8Array(a),null)}function m(e,t,n,a){var i=o("WAWebSyncdDecode").decodeSyncActionData(null,n.buffer),l=r("WAWebSyncdValidateSyncActionProtobuf").validateSyncActionDataProtobuf(null,i),s=l.version,u=l.value,c=o("WAArrayBufferUtils").arrayBufferToString(l.index);return new(o("wa-kmp-syncd-engine-api")).KmpSyncdCryptoMutationData(c,s,e,t,u?new Int8Array(o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionValueSpec,u).readBuffer()):null,a)}function p(t,n,r){var a=new Int8Array(r.index.blob),i=new Int8Array(r.value.blob),l=i.slice(-o("WAWebSyncdCryptoConst").MAC_LENGTH);return new(o("wa-kmp-syncd-engine-api")).KmpSyncdCryptoEncryptedData(e(t),a,u(n),i,l)}function _(e,t){var n;return new(o("wa-kmp-syncd-engine-api")).KmpSyncdCryptoActionData(new Int8Array(o("WAWebSyncdRequestEncode").encodeSyncActionData({index:o("WAArrayBufferUtils").stringToArrayBuffer(e.index),value:o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionValueSpec,(n=e.value)==null?void 0:n.buffer),padding:t.buffer,version:e.version})))}l.toKmpSyncdMutationKeyData=s,l.toKmpSyncdMutationKey=c,l.toKmpSyncdMutationDataForEncryption=d,l.toKmpSyncdMutationDataForDecryption=m,l.toKmpSyncdEncryptedData=p,l.toKmpSyncdActionData=_}),98);
__d("WAWebKmpSyncdCryptoProvider",["WACryptoAesCbc","WACryptoDependencies","WACryptoHmac","asyncToGeneratorRuntime","err","wa-kmp-syncd-engine-api"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a=yield o("WACryptoAesCbc").aesCbcEncrypt(n,t,e);e.length!==16&&r("err")("IV must be 16 bytes");var i=a.slice(e.length);return new Int8Array(i)}),s.apply(this,arguments)}function u(e,t,n){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield o("WACryptoAesCbc").aesCbcDecrypt(n,e,t);return new Int8Array(r)}),c.apply(this,arguments)}function d(t,n,a,i){switch(t){case o("wa-kmp-syncd-engine-api").OpMode.ENCRYPT:return new(o("wa-kmp-syncd-engine-api")).KmpResult(e(n,a,i));case o("wa-kmp-syncd-engine-api").OpMode.DECRYPT:return new(o("wa-kmp-syncd-engine-api")).KmpResult(u(n,a,i));default:throw r("err")("Invalid mode: "+t.name+")")}}function m(e,t,n){var r=e===o("wa-kmp-syncd-engine-api").MacAlgo.HMAC_SHA_256?o("WACryptoHmac").hmacSha256:o("WACryptoHmac").hmacSha512;return new(o("wa-kmp-syncd-engine-api")).KmpResult(r(n,t).then(function(e){return new Int8Array(e)}))}function p(e){var t=new Int8Array(e);return o("WACryptoDependencies").getCrypto().getRandomValues(t)}var _=Array.from({length:256},function(e,t){return t.toString(16).padStart(2,"0")});function f(e){for(var t="",n=0;n<e.length;n++)t+=_[e[n]];return t}var g=new(o("wa-kmp-syncd-engine-api")).JsKmpSyncdCryptoProviderImpl({createCipherText:d,mac:m,generateRandomBytes:p,bytesToHexString:f});l.default=g}),98);
__d("WAWebKmpSyncdProtobufEncoder",["WASyncdKmpConversion","wa-kmp-syncd-engine-api"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return o("WASyncdKmpConversion").toKmpSyncdActionData(e,t)}var s=new(o("wa-kmp-syncd-engine-api")).JsKmpSyncdProtobufProviderImpl({encodeMutationDataToSyncdActionData:e});l.default=s}),98);
__d("WAWebSyncdCryptoHelper",["WACryptoHkdf","WASyncdKeyTypes","WAWebSyncdCryptoConst","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=yield u(e);return{indexKey:n.slice(0,(t=o("WAWebSyncdCryptoConst")).INDEX_KEY_END),valueEncryptionKey:n.slice(t.INDEX_KEY_END,t.VALUE_ENCRYPTION_KEY_END),valueMacKey:n.slice(t.VALUE_ENCRYPTION_KEY_END,t.VALUE_MAC_KEY_END),snapshotMacKey:n.slice(t.VALUE_MAC_KEY_END,t.SNAPSHOT_MAC_KEY_END),patchMacKey:n.slice(t.SNAPSHOT_MAC_KEY_END,t.PATCH_MAC_KEY_END)}}),s.apply(this,arguments)}function u(e){return o("WACryptoHkdf").extractAndExpand(o("WASyncdKeyTypes").fromSyncKeyData(e),o("WAWebSyncdCryptoConst").HKDF_INFO,o("WAWebSyncdCryptoConst").DERIVED_KEY_LENGTH)}l.generateEncryptionKeysUnmemoized=e}),98);
__d("WAWebSyncdCrypto",["WABase64","WACryptoHmac","WAMemoizeCache","WASyncdKeyTypes","WAWebSyncdCryptoConst","WAWebSyncdCryptoHelper"],(function(t,n,r,o,a,i,l){"use strict";var e=o("WAMemoizeCache").memoizeWithArgs(o("WAWebSyncdCryptoHelper").generateEncryptionKeysUnmemoized,function(e){return o("WABase64").encodeB64(o("WASyncdKeyTypes").fromSyncKeyData(e))});function s(e,t){return o("WACryptoHmac").hmacSha256(new Uint8Array(e),new Uint8Array(t))}function u(e){var t=e.byteLength;return new Uint8Array(e).slice(t-o("WAWebSyncdCryptoConst").MAC_LENGTH).buffer}l.generateEncryptionKeys=e,l.generateIndexMac=s,l.valueMacFromIndexAndValueCipherText=u}),98);
__d("WASyncdKmpEncryptionManager",["WAArrayBufferUtils","WALogger","WASyncdKeyTypes","WASyncdKmpConversion","WAWebKmpSyncdCryptoProvider","WAWebKmpSyncdProtobufEncoder","WAWebSyncdCrypto","WAWebSyncdCryptoUtils","WAWebSyncdError","WAWebSyncdMetricFatalError","asyncToGeneratorRuntime","nullthrows","wa-kmp-syncd-engine-api"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_;function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebSyncdCrypto").generateEncryptionKeys(o("WASyncdKeyTypes").toSyncKeyData(e.keyData.buffer));return new(o("wa-kmp-syncd-engine-api")).KmpSyncdCryptoDerivedKeys(new Int8Array(t.indexKey),new Int8Array(t.valueEncryptionKey),new Int8Array(t.valueMacKey),new Int8Array(t.snapshotMacKey),new Int8Array(t.patchMacKey))}),g.apply(this,arguments)}var h=new(o("wa-kmp-syncd-engine-api")).JsKmpDerivedSyncdKeysProviderImpl({getForInternal:function(t){return new(o("wa-kmp-syncd-engine-api")).KmpResult(f(t))}}),y=new(o("wa-kmp-syncd-engine-api")).JsKmpSyncdMutationDataFactoryImpl({createInternal:function(t,n,r,a){return o("WASyncdKmpConversion").toKmpSyncdMutationDataForDecryption(t,n,r,a)}}),C=new(o("wa-kmp-syncd-engine-api")).KmpSyncdEncryptionManager(h,y,r("WAWebKmpSyncdCryptoProvider"),r("WAWebKmpSyncdProtobufEncoder"));function b(e,t,n){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd:kmp: encrypting mutation"])));try{var a=o("WASyncdKmpConversion").toKmpSyncdMutationKey(n,r),i=o("WASyncdKmpConversion").toKmpSyncdMutationDataForEncryption(n,t),l=C.encrypt(a,i),c=yield l.toPromise();return{indexMac:c.indexHash.buffer,indexAndValueCipherText:c.indexAndValueCipherText.buffer}}catch(e){throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.ENCRYPTION_FAILED,{collection:t.collection}),e instanceof Error?(o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd:kmp: encryption failed: ",""])),e.message),new(o("WAWebSyncdError")).SyncdFatalError(e.message)):(o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd:kmp: encryption failed"]))),e)}}),v.apply(this,arguments)}function S(e,t,n,r,o){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a,i){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["syncd:kmp: decrypting mutation"])));try{var l,s=o("WASyncdKmpConversion").toKmpSyncdEncryptedData(t,a,i),u=yield C.decrypt(o("WASyncdKmpConversion").toKmpSyncdMutationKey(t,n),s).toPromise(),p=u.mutation,_=u.plaintext,f=r("nullthrows")(p.mutationMac,"SyncdMutation decryption returned a null mutationMac, this should not happen").buffer,g=o("WAArrayBufferUtils").stringToArrayBuffer(p.index);return{version:p.version,index:g,indexMac:s.indexHash.buffer,value:(l=p.value)==null?void 0:l.buffer,valueMac:f,plaintext:_.buffer}}catch(t){throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.DECRYPTION_FAILED,{collection:e}),t instanceof Error?(o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["syncd:kmp: decryption failed: ",""])),t.message),new(o("WAWebSyncdError")).SyncdFatalError(t.message)):(o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd:kmp: decryption failed"]))),t)}}),R.apply(this,arguments)}function L(e,t,n,r,o){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["syncd:kmp: generating patch mac"])));var i=yield C.calculatePatchMac(a,o("wa-kmp-syncd-engine-api").KmpLong.fromDecimalString(r.toString()),o("WASyncdKmpConversion").toKmpSyncdMutationKeyData(e),new Int8Array(o("WAWebSyncdCryptoUtils").combine(n)),new Int8Array(t)).toPromise();return i.buffer}),E.apply(this,arguments)}function k(e,t,n,r){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["syncd:kmp: generating snapshot mac"])));var a=yield C.calculateSnapshotMac(r,o("wa-kmp-syncd-engine-api").KmpLong.fromDecimalString(n.toString()),new Int8Array(t),o("WASyncdKmpConversion").toKmpSyncdMutationKeyData(e)).toPromise();return a.buffer}),I.apply(this,arguments)}var T={encryptMutation:b,decryptMutation:S,generatePatchMac:L,generateSnapshotMac:k};l.WASyncdKmpEncryptionManager=T}),98);
__d("WAWebABPropsInternalNumber",["WAWebABProps"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WAWebABProps").getABPropConfigValue("system_msg_numbers_fb_branded").split(","),n=o("WAWebABProps").getABPropConfigValue("system_msg_numbers_fb_inc").split(",");return t.includes(e)||n.includes(e)}function s(e){var t=o("WAWebABProps").getABPropConfigValue("system_msg_numbers_fb_branded").split(",");return t.includes(e)}l.getIsInternalNumber=e,l.getFbBrandedNumber=s}),98);
__d("WAWebAPIParser",["WALogger"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e){var t=e.encryptedKeyElementValue,n=e.nonceElementValue,r=e.authTagElementValue,o=e.encryptedDataElementValue;return{key:t,nonce:n,tag:r,data:o}}function d(e){var t,n,r,o,a,i,l={is_eligible_to_link_to_linked_fb:(t=e.is_eligible_to_link_to_linked_fb)!=null?t:!1,is_eligible_to_link_to_linked_ig:(n=e.is_eligible_to_link_to_linked_ig)!=null?n:!1,is_eligible_to_link_to_linked_rl:(r=e.is_eligible_to_link_to_linked_rl)!=null?r:!1,is_eligible_to_link_to_unlinked_fb:(o=e.is_eligible_to_link_to_unlinked_fb)!=null?o:!1,is_eligible_to_link_to_unlinked_ig:(a=e.is_eligible_to_link_to_unlinked_ig)!=null?a:!1,is_eligible_to_link_to_unlinked_rl:(i=e.is_eligible_to_link_to_unlinked_rl)!=null?i:!1};return l}function m(e){var t=null,n=null;for(var r of e)r.waffle_da==="F"&&(t=r.waffle_di),r.waffle_da==="I"&&(n=r.waffle_di);return{fbCrosspostingDestinationId:t,igCrosspostingDestinationId:n}}function p(t){var n,r=(n=t.waffle_fx_service_data)==null?void 0:n.services,a=r==null?void 0:r.foa_to_wa_link_eligibility;if(a==null){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] foAToWALinkEligibility is null"])));return}var i=d(babelHelpers.extends({},a)),l=r==null?void 0:r.waffle_sxs;if(l==null){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] destinationList is null"])));return}var c=m(l),p=c.fbCrosspostingDestinationId,_=c.igCrosspostingDestinationId;if(p==null||_==null){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] Parsing service data failed"])));return}return{fbCrosspostingDestinationId:p,igCrosspostingDestinationId:_,foAToWALinkEligibility:i}}l.parseRSAEncryptionMetadataMixin=c,l.parseServiceData=p}),98);
__d("WAWebAddonSendMsgData",["WALogger","WAWebAck","WAWebAddonConstants","WAWebAddonCrossWindowUtils","WAWebAddonEncryptAddonMsgData","WAWebAddonInfraError","WAWebAddonPluginProcessor","WAWebAddonProcessMsgs","WAWebAddonProcessMsgsUtils","WAWebAddonRetryRequestUtils","WAWebAddonSelectUtils","WAWebAddonUpdateDataUtils","WAWebHandleMsgError","WAWebMsgType","WAWebReferentialMsgKey","WAWebSendMsgJob","WAWebSendMsgTypes","WAWebUserPrefsMeUser","WAWebWid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WAWebAddonEncryptAddonMsgData").createDualEncryptionHelper(e,t),r=n?yield n.decrypt():e,a=o("WAWebAddonSelectUtils").getAddonTableMode(e);yield o("WAWebAddonUpdateDataUtils").updateAddonsInTableMode({processMode:o("WAWebAddonConstants").AddonProcessMode.SetAck,tableMode:a},{add:[r]})}),m.apply(this,arguments)}var p=function(t){var e=t.id,n=e.remote;return e.fromMe&&o("WAWebUserPrefsMeUser").isMePrimary(n)?o("WAWebAck").ACK.READ:o("WAWebAck").ACK.SENT},_=new Set([o("WAWebAddonConstants").AddonProcessMode.Send,o("WAWebAddonConstants").AddonProcessMode.SendRetry,o("WAWebAddonConstants").AddonProcessMode.SendRevoke]),f=new Set([o("WAWebMsgType").MSG_TYPE.REACTION,o("WAWebMsgType").MSG_TYPE.REACTION_ENC]);function g(e){return f.has(e.type)?!0:new Set(["reaction","poll_update","comment","event_response"]).has(e.type)}function h(e,t){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var a=o("WAWebAddonConstants").AddonProcessMode.Send;t.kind===o("WAWebMsgType").MsgKind.ProtocolAddonRevoke&&(a=o("WAWebAddonConstants").AddonProcessMode.SendRevoke),t.ack===o("WAWebAck").ACK.FAILED&&(a=o("WAWebAddonConstants").AddonProcessMode.SendRetry);var i;try{var l;if(!_.has(a))throw new(o("WAWebAddonInfraError")).AddonInfraError(o("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError);var m=o("WAWebAddonProcessMsgsUtils").getParentMsgKey(t);if(g(t))i=yield o("WAWebAddonProcessMsgs").processOutgoingMsgOptimisticUpdate(a,t);else{var f;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[addon-infra]: sending "," (",") addon, id: ",", parent: ",", isParentLid: ",""])),o("WAWebAddonCrossWindowUtils").getAddonProcessorType(t),t.type,t.id.id,m.id,(f=m.participant)==null?void 0:f.isLid());var h=yield o("WAWebAddonProcessMsgsUtils").queryAddonParentMsgs([t],a),y=h[0],C=h[1];if(i={encryptedMsgData:C[0],decryptedMsgData:C[0],parent:o("WAWebAddonSelectUtils").createAddonParentSelector(y).getForAddon(C[0])},a===o("WAWebAddonConstants").AddonProcessMode.SendRetry&&t.type===o("WAWebMsgType").MSG_TYPE.COMMENT){var b=o("WAWebAddonPluginProcessor").getAddonProcessor(i.decryptedMsgData);b.convert.toDualEncryptedMsgData!=null&&(i.encryptedMsgData=yield b.convert.toDualEncryptedMsgData(i.decryptedMsgData,i.parent))}(a===o("WAWebAddonConstants").AddonProcessMode.Send||a===o("WAWebAddonConstants").AddonProcessMode.SendRetry)&&(yield o("WAWebAddonProcessMsgs").processOutgoingMsg(a,i.encryptedMsgData,y,n))}yield o("WAWebAddonRetryRequestUtils").storeSelfMessageTypeRow(i.decryptedMsgData);var v=i.parent.broadcastId!=null&&r("WAWebWid").isWid(i.parent.broadcastId)&&!!((l=i.parent.broadcastId)!=null&&l.isBroadcastList());if(v){var S=o("WAWebReferentialMsgKey").getReferentialMsgKey(i.parent);i.encryptedMsgData=o("WAWebAddonProcessMsgsUtils").updateMsgParentKeyValue(i.encryptedMsgData,S)}var R=yield o("WAWebSendMsgJob").encryptAndSendMsg({type:o("WAWebSendMsgTypes").SendMessageRecordType.Addon,data:i.encryptedMsgData},n),L=R.count,E=R.t,k=R.error;if(v&&(i.encryptedMsgData=o("WAWebAddonProcessMsgsUtils").updateMsgParentKeyValue(i.encryptedMsgData,i.parent.id)),k!=null)throw new(o("WAWebHandleMsgError")).MessageSentAckError(k);return yield d(babelHelpers.extends({},i.decryptedMsgData,{ack:p(i.encryptedMsgData)}),i.parent),o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[addon-infra]: sent "," addon, id: ",""])),i.decryptedMsgData.type,i.decryptedMsgData.id.id),{t:parseInt(E,10),count:L}}catch(e){throw i==null?(o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["sendAddonMsgData: failure, parent msg "," for addon "," is not found"])),o("WAWebAddonProcessMsgsUtils").getParentMsgKey(t),t.id.toString()).tags("messaging","addons").sendLogs("sendAddonMsgData: undefined parent"),e):(yield d(babelHelpers.extends({},i.decryptedMsgData,{ack:o("WAWebAck").ACK.FAILED}),i.parent),o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["sendAddonMsgData: failure, msg: ",""])),t.id.toString()).devConsole(i),e)}}),y.apply(this,arguments)}l.isOptimisticAddonSendSupported=g,l.sendAddonProcess=h}),98);
__d("WAWebPonyfillsFetch",["WAWebHttpExtendedFetch"],(function(t,n,r,o,a,i,l){var e=function(){},s="fetch"in self?self.fetch:u;function u(t,n){return n===void 0&&(n={}),o("WAWebHttpExtendedFetch").sharedFetch(t,babelHelpers.extends({},n,{onProgress:e}))}l.default=s}),98);
__d("WAWebXControllerFetchUtils",["URI","WALogger","WAWebPonyfillsFetch","asyncToGeneratorRuntime","getAsyncHeaders","getAsyncParams"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=t.method,o=t.additionalHeaders,a=o===void 0?{}:o,i=new(s||(s=r("URI")))(e),l=r("getAsyncParams")(n),u=r("getAsyncHeaders")(i),c=new URLSearchParams;Object.entries(l).forEach(function(e){var t=e[0],n=e[1];n!=null&&c.append(t,n.toString())});var d=babelHelpers.extends({},u,a,{"Content-Type":"application/x-www-form-urlencoded"});return yield r("WAWebPonyfillsFetch")(e,{method:n,headers:d,body:c})}),c.apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){try{var n=yield t.text(),r=n.replace(/^for\s*\(\s*;;\s*\)\s*;\s*/,"");return JSON.parse(r)}catch(t){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[vc-auth] Failed to parse JSON response: ",""])),t),null}}),m.apply(this,arguments)}l.fetchFromXController=u,l.extractJsonFromResponse=d}),98);
__d("WAXWhatsAppWebAuthControllerRouteBuilder",["jsRouteBuilder"],(function(t,n,r,o,a,i,l){var e=r("jsRouteBuilder")("/auth/token/",Object.freeze({}),void 0),s=e;l.default=s}),98);
__d("WAWebViewerContextAuthUtils",["WABase64","WABinary","WACryptoAesGcm","WACryptoHkdfSync","WALogger","WAWebAdvSignatureApi","WAWebUserPrefsInfoStore","WAWebXControllerFetchUtils","WAXWhatsAppWebAuthControllerRouteBuilder","asyncToGeneratorRuntime","nullthrows"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_=!1;function f(){_=!0}function g(){_&&self.location.reload()}function h(e){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){try{var t=v(e),n=t.iv,a=t.tag,i=t.data,l=yield o("WAWebUserPrefsInfoStore").waNoiseInfo.get(),s=r("nullthrows")(l).staticKeyPair.pubKey,c=yield o("WAWebAdvSignatureApi").getADVSecretKey(),d=b(new Uint8Array(o("WABase64").decodeB64(c)),new Uint8Array(s)),m=S(i,a);return yield o("WACryptoAesGcm").gcmDecrypt(d,n,m)}catch(e){return o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[vc-auth] Error while decrypting nonce: ",""])),e),null}}),y.apply(this,arguments)}function C(t){try{var n=new TextDecoder("utf-8").decode(t),r=JSON.parse(n),a=r.nonce,i=r.fbid,l=r.timestamp;return a==null||i==null?(o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[vc-auth] Nonce payload missing required fields"]))),null):{nonce:a,fbid:i,timestamp:l}}catch(e){return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[vc-auth] Error while parsing nonce payload: ",""])),e).sendLogs("vc-auth-error"),null}}function b(e,t){return o("WACryptoHkdfSync").hkdf(e,t,o("WABinary").Binary.build("Canonical Ent Companion Nonce Encrypt").readByteArrayView(),32)}function v(e){var t=e.encryptedKeyElementValue,n=e.nonceElementValue,r=e.authTagElementValue,o=e.encryptedDataElementValue;return{key:t,iv:n,tag:r,data:o}}function S(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function R(e){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[vc-auth] Exchanging nonce for token"])));var t=e.userId,n=e.deviceId,a=e.nonce,i=r("WAXWhatsAppWebAuthControllerRouteBuilder").buildUri({nonce:a,user_id:t,device_id:n});try{var l,s=yield o("WAWebXControllerFetchUtils").fetchFromXController(i.toString(),{method:"POST"});if(!s.ok)return o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[vc-auth] Failed to exchange nonce: HTTP ",""])),s.status),!1;var u=yield o("WAWebXControllerFetchUtils").extractJsonFromResponse(s);if(u==null||((l=u.payload)==null?void 0:l.status)!=="success"){var _,f;return o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[vc-auth] Failed to exchange nonce: ",""])),(_=u==null||(f=u.payload)==null?void 0:f.status)!=null?_:"invalid response").sendLogs("vc-auth-error"),!1}return!0}catch(e){return o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[vc-auth] Failed to exchange nonce: ",""])),e).sendLogs("vc-auth-error"),!1}}),L.apply(this,arguments)}l.setViewerContextReady=f,l.maybeReloadBeforeLogin=g,l.decryptNonce=h,l.parseNoncePayload=C,l.exchangeNonceForToken=R}),98);
__d("WAWebCompanionRegUtils",["WALogger","WAShiftTimer","WATimeUtils","WAWebAdvSignatureApi","WAWebAppTracker","WAWebCmd","WAWebLogoutReasonConstants","WAWebSocketLogoutJob","WAWebSocketModel","WAWebUserPrefsIsLoggedIn","WAWebViewerContextAuthUtils","WAWebWamDeviceLinkReporter","WAWebWamEnumMdLinkDeviceCompanionStage","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c=!1,d=!1,m=1e3,p=6e4*3;function _(){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["logout due to initial history sync timeout"]))),o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.CriticalSync),o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.HistorySyncTimeout)}function f(){c=!1,d=!1}function g(){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){c||d||(yield o("WAWebWamDeviceLinkReporter").setDeviceLinkPairStage(o("WAWebWamEnumMdLinkDeviceCompanionStage").MD_LINK_DEVICE_COMPANION_STAGE.FIRST_CONNECT),c=!0,yield o("WAWebAdvSignatureApi").clearADVSecretKey(),o("WAWebUserPrefsIsLoggedIn").setIsConnectedAsRegistered(!0),o("WAWebViewerContextAuthUtils").maybeReloadBeforeLogin())}),h.apply(this,arguments)}function y(){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){c||d||(d=!0,yield o("WAWebSocketModel").Socket.clearCredentialsAndStoredData(),yield o("WAWebAdvSignatureApi").clearADVSecretKey())}),C.apply(this,arguments)}function b(){new(o("WAShiftTimer")).ShiftTimer(function(){y()}).onOrAfter(m)}var v;function S(){v==null&&(v=self.setTimeout(_,p),o("WAWebCmd").Cmd.on("on_initial_chat_synced",function(){self.clearTimeout(v)}))}function R(){var e=o("WATimeUtils").unixTimeMs();o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync][reg] begin device pairing latency measurement"]))),o("WAWebCmd").Cmd.on("on_critical_sync_done",function(){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[history sync][reg] main screen unblocked in ","ms"])),o("WATimeUtils").unixTimeMs()-e)})}l.resetCompanionReg=f,l.startLogin=g,l.startLogout=y,l.logoutAfterValidationFail=b,l.startInitialHistorySyncTimeout=S,l.initDevicePairingLatencyMeasurement=R}),98);
__d("WAWebAdvStoredTimestampExpiredWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({AdvStoredTimestampExpired:[3036,{advExpireTimeInHours:[1,o("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,1],"regular"]},{AdvStoredTimestampExpired:[]});l.AdvStoredTimestampExpiredWamEvent=e}),98);
__d("WAWebAdvDeviceInfoCheckJob",["Promise","WAJids","WALogger","WATimeUtils","WAWebABProps","WAWebAdvStoredTimestampExpiredWamEvent","WAWebApiDeviceList","WAWebApiPendingDeviceSync","WAWebApiTasksScheduledTime","WAWebCurrentUser","WAWebIdentityUpdateDeviceTableApi","WAWebLastADVCheckTimeApi","WAWebLogoutReasonConstants","WAWebSocketLogoutJob","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h=25*o("WATimeUtils").HOUR_SECONDS,y=(function(){function t(e){this.advToSystemBridge=e}var r=t.prototype;return r.run=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["adv: running device info check with t=",""])),t).tags("automated-device-verification");var n=this.advToSystemBridge,r=yield n.getUsersForExpiration(t),a=r.usersExpired,i=r.usersCloseToExpiration;o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["adv: removing companions: ",""])),Array.from(a.entries()).map(function(e){var t=e[0],n=e[1];return"\n	"+t.toString()+" (t="+n.timestamp+")"})).tags("automated-device-verification"),n.removeCompanions(a),n.sendADVStoredTimestampExpiredEvents(a,t);var l=Array.from(a.keys()).concat(Array.from(i.keys())).filter(function(e){return!n.canRemoveUserDevices(e)});return n.sendOrQueueDeviceUsyncQuery(l).catch(function(e){return o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["adv: error sending usync query: ",""])),e).tags("automated-device-verification")}),n.recordLocalTimestamp()});function r(e){return t.apply(this,arguments)}return r})(),t})(),C=(function(){function e(){}var t=e.prototype;return t.getNumDaysKeyIndexListExpiration=function(){return o("WAWebABProps").getABPropConfigValue("num_days_key_index_list_expiration")},t.getNumDaysBeforeDeviceExpiryCheck=function(){return o("WAWebABProps").getABPropConfigValue("num_days_before_device_expiry_check")},t.getUsersForExpiration=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this,n=yield o("WAWebApiDeviceList").getAllDeviceLists(),r=yield o("WAWebLastADVCheckTimeApi").getLastADVDeviceInfoCheckTime(),a=this.getNumDaysKeyIndexListExpiration()*o("WATimeUtils").DAY_SECONDS,i=new Map,l=new Map;return n.forEach(function(n){n.deleted||k(n)||(I(e,a,n,r)?i.set(o("WAWebWidFactory").createUserWidOrThrow(n.id),n):T(e,a-t.getNumDaysBeforeDeviceExpiryCheck()*o("WATimeUtils").DAY_SECONDS,n)&&l.set(o("WAWebWidFactory").createUserWidOrThrow(n.id),n))}),{usersExpired:i,usersCloseToExpiration:l}});function t(t){return e.apply(this,arguments)}return t})(),t.sendADVStoredTimestampExpiredEvents=function(t,n){var e=this;t.forEach(function(t){var r=n-(t.timestamp+e.getNumDaysKeyIndexListExpiration()*o("WATimeUtils").DAY_SECONDS);if(!(r<0)){var a=Math.round(r/o("WATimeUtils").HOUR_SECONDS);new(o("WAWebAdvStoredTimestampExpiredWamEvent")).AdvStoredTimestampExpiredWamEvent({advExpireTimeInHours:a}).commit()}})},t.sendOrQueueDeviceUsyncQuery=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["adv_device_info_check: sending usync query"]))),yield o("WAWebApiPendingDeviceSync").addUserToPendingDeviceSync(e.map(function(e){return e.toString()})),o("WAWebApiPendingDeviceSync").doPendingDeviceSync()});function t(t){return e.apply(this,arguments)}return t})(),t.canRemoveUserDevices=function(t){return!1},t.removeCompanions=function(t){var e=Array.from(t.entries()),r=e.some(function(e){var t=e[0],n=e[1];return t.user===o("WAWebUserPrefsMeUser").getMePnUserOrThrow().user});return r&&o("WAWebABProps").getABPropConfigValue("web_adv_logout_on_self_device_list_expired")?(o("WAWebCurrentUser").isEmployee()?o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Logging out due to own expired device"]))).sendLogs("web-own-device-list-expired"):o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Logging out due to own expired device"]))),o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.InvalidAdvStatus),(g||(g=n("Promise"))).resolve()):(g||(g=n("Promise"))).all(Array.from(t.entries()).map(function(e){var t=e[0],n=e[1];return o("WAWebIdentityUpdateDeviceTableApi").clearDeviceRecord(t,n.devices)}))},t.recordLocalTimestamp=function(){return(g||(g=n("Promise"))).resolve()},e})(),b="advDeviceInfoCheck",v;function S(){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){v!=null&&(self.clearTimeout(v),v=null);var e=o("WATimeUtils").unixTimeWithoutClockSkewCorrection(),t=yield o("WAWebLastADVCheckTimeApi").getLastADVDeviceInfoCheckTime(),r=0,a=function(){return(g||(g=n("Promise"))).resolve()};t!=null?(r=Math.max(o("WATimeUtils").DAY_SECONDS-(e-t),0),a=function(){return E()},o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["scheduled in "," seconds"])),r).tags("automated-device-verification")):o("WALogger").DEV(_||(_=babelHelpers.taggedTemplateLiteralLoose(["skip first run"]))).tags("automated-device-verification"),v=self.setTimeout(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{yield a()}catch(e){o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["error running the adv device check job"]))).tags("automated-device-verification")}v=null;var e=o("WATimeUtils").unixTimeWithoutClockSkewCorrection();o("WAWebLastADVCheckTimeApi").setLastADVDeviceInfoCheckTime(e),o("WAWebApiTasksScheduledTime").updateTaskScheduledTime(b,o("WATimeUtils").castToUnixTime(e)),S()}),r*1e3)}),R.apply(this,arguments)}var L;function E(){return L==null&&(L=new y(new C)),L.run(o("WATimeUtils").unixTimeWithoutClockSkewCorrection())}function k(e){return e.devices.length===1&&e.devices[0].id===o("WAJids").DEFAULT_DEVICE_ID}function I(e,t,n,r){return e-n.timestamp>=t?!0:n.expectedTsUpdateTs!=null?e-n.expectedTsUpdateTs>=h&&n.expectedTsLastDeviceJobTs!==r:!1}function T(e,t,n){return e-n.timestamp>=t?!0:n.expectedTs!=null?n.expectedTs>n.timestamp:!1}l.AdvToSystemBridgeImpl=C,l.scheduleAdvDeviceInfoCheck=S,l.runAdvDeviceInfoCheck=E}),98);
__d("WAWebBackgroundSyncAction",["WALogger","WATimeUtils","WAWebABProps","WAWebPushNotificationsGatingUtils","WAWebPwaDocumentMetadataUtils","WAWebSetWorkerLocalStorage","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g="background-sync";function h(e){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){t===void 0&&(t=!1);try{var n,r;if(!o("WAWebPushNotificationsGatingUtils").canSupportPeriodicBackgroundSync()||!o("WAWebPwaDocumentMetadataUtils").isCurrentWebSessionInsidePwa())return;var a=yield(n=window.navigator.serviceWorker)==null?void 0:n.ready;if(!("periodicSync"in(a!=null?a:[])))return;var i=a==null?void 0:a.periodicSync;if(!i)return;var l=yield i.getTags==null?void 0:i.getTags();if(!l)return;var h=yield(r=window.navigator.permissions)==null||r.query==null?void 0:r.query({name:"background-sync"});if((h==null?void 0:h.state)!=="granted")return;var y=o("WAWebABProps").getABPropConfigValue("web_pwa_background_sync");if(!t&&y)if(yield o("WAWebSetWorkerLocalStorage").setWorkerLocalStorage(),l.includes(g))o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["pwa background sync is already registered"])));else{o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Start pwa background sync registration"]))),yield i.register==null?void 0:i.register(g,{minInterval:o("WAWebABProps").getABPropConfigValue("web_pwa_background_sync_min_interval_hours")*o("WATimeUtils").HOUR_MILLISECONDS});var C=yield i.getTags==null?void 0:i.getTags();C!=null&&C.includes!=null&&C.includes(g)?o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["pwa background sync registered successfully"]))):o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["pwa background sync failed to register"])))}else if(l.includes(g)){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Start pwa background sync unregistration"]))),yield i.unregister==null?void 0:i.unregister(g);var b=yield i.getTags==null?void 0:i.getTags();b!=null&&b.includes!=null&&b.includes(g)?o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["pwa background sync failed to unregister"]))):o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["pwa background sync unregistered successfully"])))}else o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["pwa background sync is already unregistered"])))}catch(e){o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["pwa-background-sync-registration-update-failure: ",""])),e.stack).devConsole(e).sendLogs("pwa-background-sync-registration-update-failure")}}),y.apply(this,arguments)}l.updatePeriodicBackgroundSyncRegistration=h}),98);
__d("WAWebUserPrefsCartLidMigration",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){function e(e){r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").UserPrefs.CartDbLidMigrationComplete,e)}function s(){return r("WAWebUserPrefsStore").get(o("WAWebUserPrefsKeys").UserPrefs.CartDbLidMigrationComplete)===!0}l.setCartLidMigrationValue=e,l.isCartLidMigrationComplete=s}),98);
__d("WAWebCartDbLidMigration",["WALogger","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebModelStorageUtils","WAWebUserPrefsCartLidMigration","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d;function m(){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!(!o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()||o("WAWebUserPrefsCartLidMigration").isCartLidMigrationComplete()))try{yield o("WAWebModelStorageUtils").getStorage().lock(["cart"],(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t[0];o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["cartDbLidMigration: start migration"])));var r=yield n.all(),a=[],i=r.map(function(e){var t=e.id,n=o("WAWebWidFactory").createUserWidOrThrow(t);if(n.isLid())return null;var r=o("WAWebLidMigrationUtils").toPn(n),i=o("WAWebLidMigrationUtils").toLid(n);return i==null||(r==null?void 0:r.user)==null?null:(e.id=i.toString(),a.push(t.toString()),{id:i.toString(),message:e.message,total:e.total,currency:e.currency,itemCount:e.itemCount,products:e.products})}).filter(Boolean);if(i.length===0){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["cartDbLidMigration: end migration with no records"]))),o("WAWebUserPrefsCartLidMigration").setCartLidMigrationValue(!0);return}o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["cartDbLidMigration: updated records: ",""])),i.length),yield n.bulkCreateOrReplace(i),yield n.bulkRemove(a),o("WAWebUserPrefsCartLidMigration").setCartLidMigrationValue(!0),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["cartDbLidMigration: migration success"])))});return function(e){return t.apply(this,arguments)}})())}catch(e){o("WAWebUserPrefsCartLidMigration").setCartLidMigrationValue(!1),o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[LID] Failed to migrate cart db : ",""])),e).sendLogs("lid-cart-migration")}}),p.apply(this,arguments)}l.migrateCartDbLid=m}),98);
__d("WAWebUserPrefsFavoritesLidMigration",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){function e(){r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").UserPrefs.FavoritesLidTableMigrationComplete,!0)}function s(){return r("WAWebUserPrefsStore").get(o("WAWebUserPrefsKeys").UserPrefs.FavoritesLidTableMigrationComplete)===!0}l.setFavoritesMigrationAsComplete=e,l.isFavoritesMigrationComplete=s}),98);
__d("WAWebDBFavoriteDatabaseMigrationToLid",["WALogger","WAWebApiContact","WAWebLid1X1MigrationGating","WAWebModelStorageUtils","WAWebUserPrefsFavoritesLidMigration","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L;function E(){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebUserPrefsFavoritesLidMigration").isFavoritesMigrationComplete()){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: migration already complete"])));return}if(!o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: 1-1 threads are not migrated to lid"]))).sendLogs("migrateFavoritesDatabaseToLid-1-1-not-migrated");return}var t=!1;yield o("WAWebModelStorageUtils").getStorage().lock(["favorite","chat"],(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n=e[0],a=e[1],i=n,l=a;try{o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: start migration"])));var s=yield i.all(),L=[],E=new Set;if(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: loaded "," favorites"])),s.length),s.forEach(function(e){var t=e.id,n=o("WAWebWidFactory").createWid(t);if(n.isRegularUser()){if(n.isLid()){E.add(t);return}L.push(e)}}),L.length===0){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: no favorites to migrate"]))),t=!0;return}o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: found "," favorites to migrate"])),L.length);var k=L.map(function(e){return e.id}),I=yield l.bulkGet(k),T=0,D=0,x=0,$=[],P=[];L.forEach(function(e,t){var n=null,r=I[t];if(r!=null?n=r.accountLid:T++,n==null){var a;if(n=(a=o("WAWebApiContact").getCurrentLid(o("WAWebWidFactory").createUserWidOrThrow(k[t])))==null?void 0:a.toString(),n==null){r!=null&&D++;return}}if(E.has(n)){x++,$.push(e.id);return}$.push(e.id),P.push(babelHelpers.extends({},e,{id:n}))}),o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: not found chat rows: ",""])),T),o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: deduped favourites: ",""])),x),D>0&&o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: not found account lids: ",""])),D).sendLogs("migrateFavoritesDatabaseToLid-not-found-account-lids"),yield i.bulkRemove($);var N=(yield i.bulkGet(P.map(function(e){return e.id}))).filter(Boolean);if(N.length>0){var M=N.filter(function(e){return E.has(e.id)});o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: existing favorites that are not expected to be in the database: ",". In Lid set: ",""])),N.length,M.length).sendLogs("migrateFavoritesDatabaseToLid-existing-favorites");var w=new Set(N.map(function(e){return e.id}));P=P.filter(function(e){return!w.has(e.id)})}else o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: no existing favorites that are not expected to be in the database"])));var A=new Map(P.map(function(e){return[e.id,e]}));A.size!==P.length?(o("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: duplicate favorites in favoritesToAdd array: ",""])),P.length-A.size).sendLogs("migrateFavoritesDatabaseToLid-duplicate-favorites"),P=Array.from(A.values())):o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: no duplicate favorites in favoritesToAdd array"]))),o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: adding "," favorites"])),P.length),yield i.bulkCreate(P);var F=yield i.count();if(o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: all favorites after migration: ",""])),F),F!==s.length-x)throw o("WALogger").ERROR(S||(S=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: all favorites after migration: "," does not match all favorites: "," minus deduped ",""])),F,s.length,x).sendLogs("migrateFavoritesDatabaseToLid-all-favorites-after-migration-mismatch"),r("err")("migrateFavoritesDatabaseToLid: mismatch after migration");t=D===0}catch(e){throw o("WALogger").ERROR(R||(R=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: migration error: ",""])),e.message).sendLogs("migrateFavoritesDatabaseToLid-error"),e}});return function(t){return e.apply(this,arguments)}})()),t&&(o("WALogger").LOG(L||(L=babelHelpers.taggedTemplateLiteralLoose(["migrateFavoritesDatabaseToLid: migration complete, success"]))),o("WAWebUserPrefsFavoritesLidMigration").setFavoritesMigrationAsComplete())}),k.apply(this,arguments)}l.migrateFavoritesDatabaseToLid=E}),98);
__d("WAWebDBLabelAssociationDatabaseMigrationToLid",["WALogger","WAWebApiContact","WAWebLid1X1MigrationGating","WAWebModelStorageUtils","WAWebSchemaLabelAssociation","WAWebUserPrefsLabelAssociationsLidMigration","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C;function b(){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebUserPrefsLabelAssociationsLidMigration").isLabelAssociationsMigrationComplete()){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["migrateLabelAssociationsDatabaseToLid: migration already complete"])));return}if(!o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["migrateLabelAssociationsDatabaseToLid: 1-1 threads are not migrated to lid"]))).sendLogs("migrateLabelAssociationsDatabaseToLid-1-1-not-migrated");return}var t=!1;yield o("WAWebModelStorageUtils").getStorage().lock(["label-association","chat"],(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n=e[0],a=e[1],i=n,l=a;try{o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["migrateLabelAssociationsDatabaseToLid: start migration"])));var s=yield i.all(),C=[],b=new Set;if(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["migrateLabelAssociationsDatabaseToLid: loaded "," associations"])),s.length),s.forEach(function(e){var t=e.associationId,n=e.type;if(n===o("WAWebSchemaLabelAssociation").LabelAssociationType.Jid){var r=o("WAWebWidFactory").createWid(t);if(r.isRegularUser()){if(r.isLid()){b.add(t);return}C.push(e)}}}),C.length===0){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["migrateLabelAssociationsDatabaseToLid: no associations to migrate"]))),t=!0;return}o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["migrateLabelAssociationsDatabaseToLid: found "," associations to migrate"])),C.length);var v=C.map(function(e){return e.associationId}),S=yield l.bulkGet(v),R=0,L=0,E=0,k=[],I=[];C.forEach(function(e,t){var n=null,r=S[t];if(r!=null?n=r.accountLid:R++,n==null){var a;if(n=(a=o("WAWebApiContact").getCurrentLid(o("WAWebWidFactory").createUserWidOrThrow(v[t])))==null?void 0:a.toString(),n==null){r!=null&&L++;return}}if(b.has(n)){E++,k.push(o("WAWebSchemaLabelAssociation").createLabelAssociationPrimaryKey(e));return}k.push(o("WAWebSchemaLabelAssociation").createLabelAssociationPrimaryKey(e)),I.push(babelHelpers.extends({},e,{associationId:n}))}),o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["migrateLabelAssociationsDatabaseToLid: not found chat rows: ",""])),R),o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["migrateLabelAssociationsDatabaseToLid: deduped associations: ",""])),E),L>0&&o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["migrateLabelAssociationsDatabaseToLid: not found account lids: ",""])),L).sendLogs("migrateLabelAssociationsDatabaseToLid-not-found-account-lids"),yield i.bulkRemove(k),yield i.bulkCreate(I);var T=yield i.count();if(o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["migrateLabelAssociationsDatabaseToLid: all associations after migration: ",""])),T),T!==s.length-E)throw o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["migrateLabelAssociationsDatabaseToLid: all associations after migration: "," does not match all LabelAssociations: "," minus deduped ",""])),T,s.length,E).sendLogs("migrateLabelAssociationsDatabaseToLid-all-associations-after-migration-mismatch"),r("err")("migrateLabelAssociationsDatabaseToLid: mismatch after migration");t=L===0}catch(e){throw o("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["migrateLabelAssociationsDatabaseToLid: migration error: ",""])),e.message).sendLogs("migrateLabelAssociationsDatabaseToLid-error"),e}});return function(t){return e.apply(this,arguments)}})()),t&&(o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["migrateLabelAssociationsDatabaseToLid: migration complete, success"]))),o("WAWebUserPrefsLabelAssociationsLidMigration").setLabelAssociationsMigrationAsComplete())}),v.apply(this,arguments)}l.migrateLabelAssociationsDatabaseToLid=b}),98);
__d("WAWebDBPnhThreadMigrationToGeneralLid",["Promise","WALogger","WAWebBackendApi","WAWebContactSystemMsg","WAWebHandleSingleMsg","WAWebLid1X1MigrationGating","WAWebLidAwareContactsDB","WAWebModelStorageUtils","WAWebMsgType","WAWebPrivacyGatingUtils","WAWebSchemaChat","WAWebUserPrefsPhoneNumberHidingThreadPromotionMigration","WAWebUsernameTypes","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k;function I(e){return o("WAWebContactSystemMsg").genNotificationMsg(e,{type:"notification_template",kind:o("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"pnh_thread_promotion",templateParams:[]})}function T(e){return D.apply(this,arguments)}function D(){return D=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=yield t.allPrimaryKeys();o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: loaded "," chat ids"])),n.length);var a=n.filter(function(e){return r("WAWebWid").isStringLid(e)});o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: found "," LID chat ids"])),a.length);var i=yield t.anyOf(["id"],a,{shouldDecrypt:!1});return i.filter(function(e){return e.lidOriginType===o("WAWebUsernameTypes").LidOriginType.PNH_CTWA})}),D.apply(this,arguments)}function x(){return $.apply(this,arguments)}function $(){return $=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!o("WAWebPrivacyGatingUtils").isPhoneNumberHidingThreadPromotionToGeneralLidEnabled()){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: feature not enabled"])));return}var e=o("WAWebUserPrefsPhoneNumberHidingThreadPromotionMigration").getPhoneNumberHidingThreadPromotionMigrationState();if(e==="migrated"){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: migration already complete"])));return}if(!o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()){o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: 1-1 threads are not migrated to lid"]))).sendLogs("migratePhoneNumberHidingThreadsToGeneralLid-1-1-not-migrated");return}e!=="migration_started"&&o("WAWebUserPrefsPhoneNumberHidingThreadPromotionMigration").setPhoneNumberHidingThreadPromotionMigrationState("migration_started");var t=!1,a=[],i=[];if(yield o("WAWebModelStorageUtils").getStorage().lock(["chat","contact"],(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n=e[0],l=e[1],s=n;try{o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: start migration"])));var u=yield T(s);if(u.length===0){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: no chats found with CTWA lidOriginType"]))),t=!0;return}o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: found "," chats to migrate from CTWA to GENERAL"])),u.length);var c=u.map(function(e){return babelHelpers.extends({},e,{lidOriginType:o("WAWebUsernameTypes").LidOriginType.GENERAL})});yield s.bulkCreateOrMerge(c),o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: successfully updated "," chats from CTWA to GENERAL"])),c.length),a=u.map(function(e){return e.id}),o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: checking shareOwnPn status for "," affected chats"])),a.length);var d=yield r("WAWebLidAwareContactsDB").bulkGet(a);i=a.filter(function(e,t){var n=d[t];return(n==null?void 0:n.shareOwnPn)!==!0}),o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: filtered to "," chats where shareOwnPn is not true"])),i.length),t=!0}catch(e){throw o("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: migration error: ",""])),String(e)).sendLogs("migratePhoneNumberHidingThreadsToGeneralLid-error"),e}});return function(t){return e.apply(this,arguments)}})()),t){if(a.length>0){o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: propagating lid origin type changes to frontend for "," chats"])),a.length);var l=a.map(function(e){return{id:o("WAWebWidFactory").createWid(e),lidOriginType:o("WAWebUsernameTypes").LidOriginType.GENERAL}});o("WAWebBackendApi").frontendFireAndForget("chatCollectionUpdate",{updates:l}),o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: frontend propagation complete"])))}if(i.length>0){o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: generating system messages for "," chats where shareOwnPn is not true"])),i.length);var s=i.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){try{var t=o("WAWebWidFactory").createWid(e),n=I(t);yield o("WAWebHandleSingleMsg").handleSingleMsg({chatId:t,newMsg:n,handleSingleMsgOrigin:"generatePhnThreadPromotionMessage"})}catch(t){o("WALogger").ERROR(S||(S=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: failed to generate system message for chat ",": ",""])),e,String(t)).sendLogs("migratePhoneNumberHidingThreadsToGeneralLid-system-msg-error")}});return function(t){return e.apply(this,arguments)}})());yield(k||(k=n("Promise"))).all(s),o("WALogger").LOG(R||(R=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: system message generation complete"])))}var D=yield T(o("WAWebSchemaChat").getChatTable());D.length===0?(o("WALogger").LOG(L||(L=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: migration complete, success"]))),o("WAWebUserPrefsPhoneNumberHidingThreadPromotionMigration").setPhoneNumberHidingThreadPromotionMigrationState("migrated")):o("WALogger").WARN(E||(E=babelHelpers.taggedTemplateLiteralLoose(["migratePhoneNumberHidingThreadsToGeneralLid: migration complete, but some chats still need to be updated"])))}}),$.apply(this,arguments)}l.migratePhoneNumberHidingThreadsToGeneralLid=x}),98);
__d("WAWebEventsWaitForMain",["Promise","WAWebCmd","WAWebEventsWaitForBbEvent"],(function(t,n,r,o,a,i,l){var e;function s(){return o("WAWebCmd").Cmd.isMainLoaded?(e||(e=n("Promise"))).resolve():r("WAWebEventsWaitForBbEvent")(o("WAWebCmd").Cmd,"main_loaded")}l.default=s}),98);
__d("WAWebFtsClientMessageIdResolver",["WAWebDBMessageSerialization","WAWebSchemaMessage"],(function(t,n,r,o,a,i,l){function e(e){var t=e.map(function(e){return+e.id}),n=new Map(e.map(function(e){return[+e.id,e]}));return o("WAWebSchemaMessage").getMessageTable().anyOf(["rowId"],t).then(function(e){var t=[];e.forEach(function(e){var r=o("WAWebDBMessageSerialization").messageFromDbRow(e),a=n.get(r.rowId);a!=null&&a.id===String(r.rowId)&&a.timestamp===r.t&&a.chatId===r.id.remote.toString()&&(t.push(r),n.delete(r.rowId))});var r=Array.from(n.keys(),function(e){return String(e)});return t.sort(function(e,t){return t.t-e.t}),{resolved:t,unresolved:r}})}l.resolveMsgIds=e}),98);
__d("WAWebFtsGenRequestId",[],(function(t,n,r,o,a,i){var e=0;function l(){return e++}i.default=l}),66);
__d("WAWebBrokerMainConnect",["WAWebBrokerConnectionManager","WAWebBrokerProtocolHandshake","WAWebInvocationDispatcher","WAWebInvocationHandler"],(function(t,n,r,o,a,i,l){function e(e){var t=new MessageChannel,n=t.port1,a=t.port2;r("WAWebInvocationHandler").respondTo(n),r("WAWebBrokerConnectionManager").init(),r("WAWebInvocationDispatcher").setConnectionManager(r("WAWebBrokerConnectionManager")),r("WAWebBrokerConnectionManager").connectVia(n),e.postMessage(o("WAWebBrokerProtocolHandshake").buildHandshakePayload(a),[a])}l.default=e}),98);
__d("WAWebFtsWorkerAdapter",["WANullthrows","WAWebBrokerMainConnect","WAWebFtsWorkerResource","WorkerBundleResource"],(function(t,n,r,o,a,i,l){var e=null,s=(function(){function e(){this.worker=null}var t=e.prototype;return t.initialize=function(t,n){this.worker=o("WorkerBundleResource").createDedicatedWebWorker(r("WAWebFtsWorkerResource")),r("WANullthrows")(this.worker).onmessage=function(e){t(e.data.message)},r("WANullthrows")(this.worker).onerror=n,r("WAWebBrokerMainConnect")(this)},t.postMessage=function(t,n){var e={type:"message",message:t};r("WANullthrows")(this.worker).postMessage(e,n)},t.terminate=function(){r("WANullthrows")(this.worker).terminate()},e})();function u(t,n){return e||(e=new s,e.initialize(t,n)),e}l.getFtsWorker=u}),98);
__d("WAWebFtsClient",["Promise","WALogger","WANullthrows","WAWebEnvironment","WAWebFtsClientMessageIdResolver","WAWebFtsGenRequestId","WAWebFtsWorkerAdapter","asyncToGeneratorRuntime","cr:1274","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=(e=n("cr:1274"))!=null?e:{},m=d.FtsSQLiteClient,p=(function(){function e(){this.$2=new Map}var t=e.prototype;return t.initialize=function(){var e=this;if(!this.$1){var t=function(n){e.$3(n)},n=function(n){return e.$4(n)},r=o("WAWebFtsWorkerAdapter").getFtsWorker(t,n);this.$1=r}},t.$4=function(t){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[fts][client] worker error: ",""])),t)},t.$3=function(t){var e=t.reqId,n=this.$2.get(e);n&&(t.error?(o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[fts][client] worker completed job "," with error"])),n.command.operation),n.reject(r("err")("FTS worker error"))):n.resolve(t.result),this.$5(e))},t.startIndexer=function(){return this.$6({operation:"start-indexer"})},t.indexFull=function(t){return this.$6({operation:"run"})},t.index=function(){return this.$6({operation:"consume"})},t.purge=function(t){return this.$6({operation:"purge",ids:t})},t.purgeRange=function(t){return this.$6(babelHelpers.extends({operation:"purge-range"},t))},t.reInit=function(){return this.$6({operation:"re-init"})},t.initExternalStorage=function(){return(c||(c=n("Promise"))).resolve()},t.destroyExternalStorage=function(){return(c||(c=n("Promise"))).resolve()},t.clearInitializationPromises=function(){return this.$6({operation:"clear-init"})},t.search=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this.$6({operation:"find",query:e,queryOptions:t});return this.$7(n)});function t(t,n){return e.apply(this,arguments)}return t})(),t.$7=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(Array.isArray(e)||typeof e=="boolean")return{canceled:!1,eof:!0,status:404,messages:[]};var t=yield o("WAWebFtsClientMessageIdResolver").resolveMsgIds(e.messages),n=t.resolved,r=t.unresolved,a=e.eof,i=e.status;return r.length>0&&this.purge(r),{canceled:!1,eof:a,status:i,messages:n}});function t(t){return e.apply(this,arguments)}return t})(),t.$6=function(t){var e=this;this.initialize();var o=r("WAWebFtsGenRequestId")();return new(c||(c=n("Promise")))(function(n,r){var a={command:t,reqId:o};e.$2.set(o,{resolve:n,reject:r,command:t}),e.$8(a)}).finally(function(){e.$5(o)})},t.$5=function(t){this.$2.delete(t)},t.$8=function(t){r("WANullthrows")(this.$1).postMessage(t)},e})(),_=m!=null&&r("WAWebEnvironment").isWindows?new m:new p;l.ftsClient=_}),98);
__d("WAWebHistorySyncProgress",["Promise","WALogger","WAWebBackendApi","WAWebCmd","WAWebProtobufsHistorySync.pb","WAWebUserPrefsHistorySync","WAWebUserPrefsTypes","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g=120,h=3,y=null;function C(){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[history sync] clearing history sync paused timeout"]))),y!=null&&self.clearTimeout(y)}function b(){C(),o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync] setting history sync paused timeout to ","s"])),g),y=self.setTimeout(function(){o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[history sync] ","s have passed without chunk uploads from phone, setting paused state..."])),g),I(!0)},g*1e3)}var v=0;function S(e){v=e?0:v+1,v===0&&b(),I(v>=3)}function R(){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var e=yield(f||(f=n("Promise"))).all([E(),o("WAWebUserPrefsHistorySync").getHistorySyncStatus()]),t=e[0],r=e[1],a=(r==null?void 0:r.recentCompleted)!==!0;o("WAWebBackendApi").frontendFireAndForget("setHistorySyncProgress",{incomplete:a}),t!=null&&o("WAWebBackendApi").frontendFireAndForget("setHistorySyncProgress",{progress:t})}catch(e){o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["updateProgressModel: error computing progress"])))}}),L.apply(this,arguments)}function E(){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebUserPrefsHistorySync").getChunkCountForEndOfRecentHistorySync();if(!(e===0&&(e=yield o("WAWebUserPrefsHistorySync").getEstimatedChunkCountForEndOfRecentHistorySync(),e===0))){var t=yield o("WAWebUserPrefsHistorySync").getLastHistorySyncedChunk();if(t!=null){var n=t.split("_").map(function(e){return parseInt(e,10)}),r=n[0],a=n[1];if(r===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT){var i=Math.floor(a/e*100);return o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history sync] computeProgress: compute progress when the last processed history sync chunk is completed"]))),Math.min(100,i)}}return T(e)}}),k.apply(this,arguments)}function I(e){o("WAWebBackendApi").frontendFireAndForget("setHistorySyncPaused",{paused:e})}function T(e){return D.apply(this,arguments)}function D(){return D=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=(t=yield o("WAWebUserPrefsHistorySync").getRecentSyncSingleChunkStatus())==null?void 0:t[1];if(n==null||[o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.RECEIVED,o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.NOTIFICATION_STORED,o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DOWNLOADING].includes(n))return null;o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[history sync] computeProgress: compute progress when the first history sync chunk is downloaded"])));var r=Math.floor(1/e/h*100);return Math.min(100,r)}),D.apply(this,arguments)}o("WAWebCmd").Cmd.on("on_critical_sync_done",function(){o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[history sync] initial sync complete, starting paused timer"]))),b()}),o("WAWebCmd").Cmd.on("on_recent_chat_history_synced",function(){o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[history sync] sync complete, clearing paused timer "]))),C(),I(!1),o("WAWebBackendApi").frontendFireAndForget("setHistorySyncProgress",{progress:100,incomplete:!1})}),l.handleChunkProgress=S,l.updateHistorySyncProgressModel=R}),98);
__d("WAWebInboxFiltersGatingUtils",["WAWebABProps","WAWebMobilePlatforms","WAWebPrimaryFeatures"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebMobilePlatforms").isSMB()?o("WAWebABProps").getABPropConfigValue("inbox_filters_smb_enabled"):!0}function s(){return e()&&o("WAWebPrimaryFeatures").primaryFeatureEnabled("primary_favorites_sync_support")}function u(){return o("WAWebMobilePlatforms").isSMB()&&o("WAWebABProps").getABPropConfigValue("inbox_filters_smb_enabled")&&o("WAWebABProps").getABPropConfigValue("inbox_filters_custom_smb_enabled")}l.inboxFiltersEnabled=e,l.inboxFavoritesEnabled=s,l.inboxCustomFiltersEnabled=u}),98);
__d("WAWebJestE2ELogUtils",["gkx"],(function(t,n,r,o,a,i,l){function e(e){r("gkx")("26256")}l.maybeLogToJestE2eJSConsole=e}),98);
__d("WAWebLid1x1MigrationManager",["Promise","WALogger","WAWebLid1X1MigrationGating","WAWebLid1X1ThreadAccountMigrations","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m=(function(){function t(){this.$1=[]}var r=t.prototype;return r.addDependentMigrationTask=function(n){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Lid1x1ThreadMigrationManager: register dependant migration task"]))),this.$1.push(n)},r.executeMigrationIfNeeded=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebLid1X1ThreadAccountMigrations").shouldMigrateNow()&&!o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&(yield o("WAWebLid1X1ThreadAccountMigrations").migrate1x1Chats()),this.$1.length===0){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Lid1x1ThreadMigrationManager: no dependant migration tasks"])));return}var e=o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated();try{e&&(yield(d||(d=n("Promise"))).all(this.$1.map(function(e){return e()})),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Lid1x1ThreadMigrationManager: executed all {","} dependent migration tasks"])),this.$1.length))}catch(e){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Lid1x1ThreadMigrationManager: executeMigrationTasks failed: error: ",""])),e)}});function t(){return e.apply(this,arguments)}return t})(),t})(),p=new m;l.ThreadMigrationManager=p}),98);
__d("WAWebLid1x1MigrationTimeoutUtils",["WALogger","WASyncdConst","WATimeUtils","WAWebABProps","WAWebLid1X1MigrationGating","WAWebLid1X1ThreadAccountMigrations","WAWebLid1X1ThreadAccountMigrations.flow","WAWebProtobufSyncAction.pb","WAWebSyncdDb","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","decodeProtobuf"],(function(t,n,r,o,a,i,l){var e,s,u,c,d;function m(){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e,t='["'+o("WASyncdConst").Actions.DeviceCapabilities+'","'+o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().user+':0@s.whatsapp.net"]',n=yield o("WAWebSyncdDb").getSyncAction(t);if((n==null?void 0:n.binarySyncData)==null)return null;var r=(e=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,n.binarySyncData).value)==null||(e=e.deviceCapabilities)==null||(e=e.lidMigration)==null?void 0:e.chatDbMigrationTimestamp;return r==null?null:o("WATimeUtils").castLongIntToUnixTime(r)}),p.apply(this,arguments)}function _(){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[lid][timeout] checking if we need to logout due to missing peer message"])));var t=o("WAWebABProps").getABPropConfigValue("lid_one_on_one_migration_peer_sync_timeout_in_seconds");if(t===0)return{shouldScheduleTimeout:!1};if(o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated())return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[lid][timeout] already migrated"]))),{shouldScheduleTimeout:!1};var n=o("WAWebLid1X1ThreadAccountMigrations").getLidThreadMigrationStatus().state;if([o("WAWebLid1X1ThreadAccountMigrations.flow").LidThreadMigrationStatus.COMPLETE,o("WAWebLid1X1ThreadAccountMigrations.flow").LidThreadMigrationStatus.IN_PROGRESS,o("WAWebLid1X1ThreadAccountMigrations.flow").LidThreadMigrationStatus.READY].includes(n))return o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[lid][timeout] already got peer mapping"]))),{shouldScheduleTimeout:!1};var r=yield m();if(r==null)return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[lid][timeout] primary did not migrate"]))),{shouldScheduleTimeout:!1};var a=o("WATimeUtils").unixTime(),i=o("WATimeUtils").timeoutForAt(a,r,t);return o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[lid][timeout] logout should be in "," seconds.\n      allowed delay: "," primary migration time: "," local time: ","\n      migration state: ","\n  "])),i/1e3,t,r,a,n),{shouldScheduleTimeout:!0,timeoutUntilLogout:i}}),f.apply(this,arguments)}l.getPrimaryMigrationTime=m,l.shouldScheduleTimeoutForMissingPeerMessage=_}),98);
__d("WAWebLid1x1MigrationTimeout",["WAAsyncSleep","WALogger","WAWebEventsWaitForOfflineDeliveryEnd","WAWebLid11MigrationLifecycleWamEvent","WAWebLid1X1MigrationGating","WAWebLid1x1MigrationTimeoutUtils","WAWebLogoutReasonConstants","WAWebSocketLogoutJob","WAWebUserPrefsIndexedDBStorage","WAWebWamEnumMigrationStageEnum","WAWebWamEnumStageFailureReasonEnum","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_=null;function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(_!=null){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[lid][timeout] already scheduled logout. is offline: ",""])),o("WAWebEventsWaitForOfflineDeliveryEnd").isOfflineDeliveryEnd());return}o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[lid][timeout] start check lid migration timeout. source: ",". is offline: ",""])),t,o("WAWebEventsWaitForOfflineDeliveryEnd").isOfflineDeliveryEnd());var r=yield o("WAWebLid1x1MigrationTimeoutUtils").shouldScheduleTimeoutForMissingPeerMessage(),a=r.shouldScheduleTimeout,i=r.timeoutUntilLogout;a&&(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[lid][timeout] setting logout timeout. is offline: ",""])),o("WAWebEventsWaitForOfflineDeliveryEnd").isOfflineDeliveryEnd()),_=self.setTimeout(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[lid][timeout] running logout check. is offline: ",""])),o("WAWebEventsWaitForOfflineDeliveryEnd").isOfflineDeliveryEnd());var e=yield o("WAWebLid1x1MigrationTimeoutUtils").shouldScheduleTimeoutForMissingPeerMessage(),t=e.shouldScheduleTimeout;o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[lid][timeout] should logout in second check: ",". is offline: ",""])),t,o("WAWebEventsWaitForOfflineDeliveryEnd").isOfflineDeliveryEnd()),t&&(h()?yield b():yield y())}),i))}),g.apply(this,arguments)}function h(){return!o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WAIsAccountLidFieldMigrated")===!0}function y(){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[lid][timeout] logging out since did not receive peer mappings"]))).sendLogs("lid-migration-did-not-receive-mapping"),yield o("WAAsyncSleep").asyncSleep(5e3),o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[lid][timeout] will logout. is offline: ",""])),o("WAWebEventsWaitForOfflineDeliveryEnd").isOfflineDeliveryEnd()),yield new(o("WAWebLid11MigrationLifecycleWamEvent")).Lid11MigrationLifecycleWamEvent({migrationStage:o("WAWebWamEnumMigrationStageEnum").MIGRATION_STAGE_ENUM.COMPANION_LOCAL_MIGRATION_FAILED,stageFailureReason:o("WAWebWamEnumStageFailureReasonEnum").STAGE_FAILURE_REASON_ENUM.COMPANION_TIMEOUT_BASED_ON_DEVICE_CAPABILITY,isLocally1x1MigratedFromDb:o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()}).commitAndWaitForFlush(!0);var e=yield o("WAWebLid1x1MigrationTimeoutUtils").shouldScheduleTimeoutForMissingPeerMessage(),t=e.shouldScheduleTimeout;t&&(yield o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.LidMigrationPeerMappingsNotReceived))}),C.apply(this,arguments)}function b(){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield o("WAAsyncSleep").asyncSleep(5e3),yield new(o("WAWebLid11MigrationLifecycleWamEvent")).Lid11MigrationLifecycleWamEvent({migrationStage:o("WAWebWamEnumMigrationStageEnum").MIGRATION_STAGE_ENUM.COMPANION_LOCAL_MIGRATION_FAILED,stageFailureReason:o("WAWebWamEnumStageFailureReasonEnum").STAGE_FAILURE_REASON_ENUM.COMPANION_UNSUPPORTED_VERSION,isLocally1x1MigratedFromDb:o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WAIsAccountLidFieldMigrated")===!0,peerMappingBytesLength:-1}).commitAndWaitForFlush(!0);var e=yield o("WAWebLid1x1MigrationTimeoutUtils").shouldScheduleTimeoutForMissingPeerMessage(),t=e.shouldScheduleTimeout;t&&(yield o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.LidMigrationStateDiscrepancy))}),v.apply(this,arguments)}l.scheduleLogoutIfNeeded=f}),98);
__d("WAWebMediaHost",["WAWebMmsMediaTypes"],(function(t,n,r,o,a,i,l){var e=new Set(o("WAWebMmsMediaTypes").MEDIA_TYPE_VALUES),s=Object.freeze({PRIMARY:"primary",FALLBACK:"fallback"}),u=(function(){function e(t){this.hostname=t.hostname,this.ips=t.ips||[],this.type=t.type,this.class=t.class;var n=c(t.rules),r=n.downloadBuckets,o=n.supportedDownloadTypes,a=n.supportedUploadTypes;this.downloadBuckets=r,this.$1=o,this.$2=a,this.fallback=t.fallback!=null?new e(babelHelpers.extends({},t,t.fallback,{type:"fallback",fallback:void 0})):null}var t=e.prototype;return t.equals=function(t){return this.hostname===(t==null?void 0:t.hostname)},t.isFallback=function(){return this.type===s.FALLBACK},t.supportsDownloadMediaType=function(t){return this.$1.has(d(t))},t.supportsUploadMediaType=function(t){return this.$2.has(m(t))},t.setSelectedBucket=function(t){this.selectedBucket=t},e})();function c(t){var n=t||[],r,o,a;for(var i of n){if(i.download){r=r!=null?r:new Set;for(var l of i.download)r.add(l)}if(i.upload){o=o!=null?o:new Set;for(var s of i.upload)o.add(s)}i.downloadBuckets&&(a=i.downloadBuckets.map(function(e){return parseInt(e,10)}))}return{supportedDownloadTypes:r!=null?r:e,supportedUploadTypes:o!=null?o:e,downloadBuckets:a}}function d(e){return e==="ptv"||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTV?o("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO:e}function m(e){switch(e){case"ptv":return o("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO;case"product-catalog-image":return o("WAWebMmsMediaTypes").MEDIA_TYPES.PRODUCT;default:return e}}l.HOST_TYPE=s,l.MediaHost=u}),98);
__d("WAWebMediaHostsErrors",["WACustomError"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WACustomError").customError("NoMediaHostsError"));l.NoMediaHostsError=e}),98);
__d("WAWebMediaHostsRouteSelection",["WABase64Modulo","WAWebABProps"],(function(t,n,r,o,a,i,l){var e={DOWNLOAD:"DOWNLOAD",UPLOAD:"UPLOAD"};function s(t){var n=t.encFilehash,a=t.hosts,i=t.operation,l=t.type,s=t.maxBuckets;if(!a.length)return{selectedHost:null,fallbackHost:null};var c;if(i===e.DOWNLOAD){var d,m=o("WAWebABProps").getABPropConfigValue("mms_vcache_aggregation_enabled"),p;n==null?p=0:m&&s!=null&&(p=r("WABase64Modulo")(n,s)+100);var _=u(a),f=p==null?null:_.get(p),g=_.get(0);f!=null&&f.supportsDownloadMediaType(l)?c=f:g!=null&&g.supportsDownloadMediaType(l)&&(c=g),(d=c)==null||d.setSelectedBucket(p)}var h=a.find(function(e){return e.isFallback()});return c=c!=null?c:a.find(function(t){return i===e.UPLOAD?t.supportsUploadMediaType(l):t.supportsDownloadMediaType(l)}),{selectedHost:c!=null?c:null,fallbackHost:h!=null?h:null}}function u(e){var t=new Map;return e.forEach(function(e){var n;(n=e.downloadBuckets)==null||n.forEach(function(n){t.set(n,e)})}),t}l.OPERATIONS=e,l.routeSelection=s}),98);
__d("WAWebQueryMediaConnsJob",["WADeprecatedSendIq","WALogger","WAMediaConnParser","WAPromiseRaceAbort","WATimeUtils","WAWap","WAWebBackendErrors","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p;function _(e){switch(e){case"kyc-id":case"novi-image":case"novi-video":case"thumbnail-gif":case"xma-image":return null;default:return e}}function f(e){return{hostname:e.domain,class:e.class,ips:[{ip4:e.ip4,ip6:e.ip6}]}}function g(e){var t=function(t){var e=[],n=t.downloadable.map(_).filter(Boolean);n.length>0&&e.push({download:n});var r=t.uploadable.map(_).filter(Boolean);r.length>0&&e.push({upload:r});var o=t.downloadBuckets.map(function(e){return e.toString()});return o!=null&&o.length>0&&e.push({downloadBuckets:o}),e};return{hosts:e.hosts.map(function(e){return babelHelpers.extends({},f(e),{fallback:e.fallback!=null?f(e.fallback):void 0,type:e.isFallback?"fallback":"primary",rules:t(e)})}),auth:e.authToken,authTTL:e.authTokenExpiryTs,ttl:e.routesExpiryTs,maxBuckets:e.maxBuckets}}function h(t){var n,a=new Date,i=o("WATimeUtils").unixTime(),l=(n=o("WAWap")).wap("iq",{to:n.S_WHATSAPP_NET,xmlns:"w:m",type:"set",id:n.generateId()},n.wap("media_conn",null)),_=o("WADeprecatedSendIq").deprecatedSendIq(l,o("WAMediaConnParser").mediaConnParser).then(function(t){if(t.success){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["backend:queryMediaConn: got "," hosts"])),t.result.hosts.length);var n=g(t.result),l=n.auth,_=n.authTTL,f=n.ttl,h=n.hosts,y=n.maxBuckets;if(!l||f==null||!h||h.length===0)throw o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["backend:queryMediaConnections: auth exists ",""])),String(!!l)),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["backend:queryMediaConnections: ttl exists ",""])),String(!!f)),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["backend:queryMediaConnections: hosts exists ",""])),String(!!h)),h&&o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["backend:queryMediaConnections: hosts.length ",""])),h.length),o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("backend:queryMediaConnections unexpected mediaConn"),r("err")("Invalid mediaConn");return{queryStartTime:a,auth:l,hosts:h,ttl:f-i,maxBuckets:y,authTTL:_-i}}else throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["response: "," ",""])),t.errorCode,t.errorText).sendLogs("backend:queryMediaConn: fail"),t.errorCode===507?new(o("WAWebBackendErrors")).E507(t.errorText,t.errorBackoff):new(o("WAWebBackendErrors")).ServerStatusCodeError(t.errorCode,t.errorText)});return r("WAPromiseRaceAbort")(_,t)}l.mapParsedMediaConn=g,l.queryMediaConn=h}),98);
__d("WAWebQueryMediaConnsBridge",["WABackoffDelay","WAPromiseBackoffs","WAWebBackendErrors","WAWebQueryMediaConnsJob","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=1e3,s=900*1e3,u=o("WAPromiseBackoffs").createTimer({algo:{type:"fibonacci",first:0,second:1},max:s,jitter:.25});function c(t){return o("WABackoffDelay").backoff({delay:function(n){var t=n.taskDuration,r=e*u();return Math.max(r-t,0)},signal:t},(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n=o("WAWebQueryMediaConnsJob").queryMediaConn(t);try{var r=yield n,a=r.ttl,i=r.authTTL;return i*=1e3,a*=1e3,babelHelpers.extends({},r,{authTTL:i,ttl:a})}catch(t){if(t instanceof o("WAWebBackendErrors").E507)throw t;if(t instanceof o("WAWebBackendErrors").ServerStatusCodeError&&t.status>=500)return e(t);throw t}});return function(t){return e.apply(this,arguments)}})())}l.sendQueryMediaConn=c}),98);
__d("WAWebMediaHosts",["Promise","WAAbortError","WALogger","WAMemoizeConcurrent","WAWebBackendErrors","WAWebMediaHost","WAWebMediaHostsErrors","WAWebMediaHostsRouteSelection","WAWebNormalizeStack","WAWebQueryMediaConnsBridge","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=["forceRefresh"],s=["name","message","stack"],u,c,d,m,p,_,f=(function(){function t(){var e=this;this._locked=!1,this._fetch=r("WAMemoizeConcurrent")(function(){return"all"},(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=t.signal;try{var a=yield o("WAWebQueryMediaConnsBridge").sendQueryMediaConn(r);e._data=e._createMediaConnData(a),o("WAWebUserPrefsMultiDevice").setMms4Conn(a),e._err=null}catch(t){var i=t;if(i instanceof o("WAWebBackendErrors").E507){var l;e._data=e._previousData,e._previousData=null,e._locked=!0,self.setTimeout(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield e._refreshIfStale({signal:r}),e._locked=!1}),(l=i.backoff)!=null?l:void 0);return}if(e._data=null,e._err=i,i.name===o("WAAbortError").ABORT_ERROR){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["mediaHosts.sendQueryMediaConn aborted"])));return}o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["mediaHosts.sendQueryMediaConn error: ",""])),h(i)).verbose(),o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).devConsole(i).sendLogs("Error fetching mms hosts")}});return function(e){return t.apply(this,arguments)}})()),this._reset()}var a=t.prototype;return a.forceRefresh=function(t){if(this._locked)return(_||(_=n("Promise"))).resolve(!1);var e={signal:t,forceRefresh:!0};return this._refreshIfStale(e)},a.getCachedHostsInfo=function(t){var e=this;if(!this._locked){var r={signal:t.signal||new AbortController().signal,forceRefresh:!1};self.setTimeout(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield e._refreshIfStale(r),e._locked=!1}),0)}return this._getPreferredHostsInfo(t)},a.maybeLoadMediaConnFromStorage=function(){var e=o("WAWebUserPrefsMultiDevice").getMms4Conn();if(e!=null)try{this._data=this._createMediaConnData(e)}catch(e){o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Failed to init media conn from storage: ",""])),e).sendLogs("media-conn-failed-to-load")}},a.getHostsInfo=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.directPath,n=e.encFilehash,r=e.operation,o=e.type,a=e.signal,i=e.forceRefresh,l=i===void 0?!1:i;if(!this._locked){var s={signal:a||new AbortController().signal,forceRefresh:l};yield this._refreshIfStale(s)}return this._getPreferredHostsInfo({directPath:t,encFilehash:n,operation:r,type:o})});function t(t){return e.apply(this,arguments)}return t})(),a.getHostsInfoByBucket=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.preferredBuckets,n=e.signal,r=e.forceRefresh,a=r===void 0?!1:r;if(!this._locked){var i={signal:n||new AbortController().signal,forceRefresh:a};yield this._refreshIfStale(i)}if(!this._data)throw new(o("WAWebMediaHostsErrors")).NoMediaHostsError("no fetched data");var l=this._data,s=l.auth,u=l.hosts;if(!u.length)throw new(o("WAWebMediaHostsErrors")).NoMediaHostsError("no selected host");var c=new Map(t.map(function(e){return[e,null]}));u.forEach(function(e){var t,n=(t=e.downloadBuckets)==null?void 0:t.find(function(e){return c.has(e)});n!=null&&c.set(n,e)});var d,m;for(var p of c.values())if(p!=null){if(!d)d=p;else if(!m){m=p;break}}if(!d&&!m?(d=u[0],m=u[1]):m||(m=u[0]),!d)throw new(o("WAWebMediaHostsErrors")).NoMediaHostsError("no selected host");return{auth:s,selectedHost:d,fallbackHost:m}});function t(t){return e.apply(this,arguments)}return t})(),a._createMediaConnData=function(t){var e=new Date(t.queryStartTime);return{auth:t.auth,authExpirationTime:new Date(e.getTime()+t.authTTL),authTTL:t.authTTL,hosts:t.hosts.map(function(e){return new(o("WAWebMediaHost")).MediaHost(e)}),hostsRefreshTime:new Date(e.getTime()+t.ttl),queryStartTime:e,maxBuckets:t.maxBuckets}},a._isExpiredOrMissing=function(){if(!this._data)return!0;var e=this._data;return new Date>=e.authExpirationTime},a._getPreferredHostsInfo=function(t){if(!this._data)throw new(o("WAWebMediaHostsErrors")).NoMediaHostsError("no fetched data");var e=t.encFilehash,n=t.operation,r=t.type,a=this._data,i=a.auth,l=a.hosts,s=a.maxBuckets,u=o("WAWebMediaHostsRouteSelection").routeSelection({encFilehash:e,hosts:l,operation:n,type:r,maxBuckets:s}),c=u.selectedHost,d=u.fallbackHost;if(!c)throw new(o("WAWebMediaHostsErrors")).NoMediaHostsError("no selected host");return{auth:i,selectedHost:c,fallbackHost:d}},a._needsRefresh=function(){if(!this._data)return!0;var e=this._data;if(new Date>=e.hostsRefreshTime)return!0;var t=e.authTTL,n=e.queryStartTime,r=Math.floor(t*.8),o=new Date(n.getTime()+r);return new Date>=o},a._refreshIfStale=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.forceRefresh,r=babelHelpers.objectWithoutPropertiesLoose(t,e);return this._isExpiredOrMissing()||n?(this._reset(),yield this._fetch(r),!0):(this._needsRefresh()&&this._fetch(r).catch(function(){o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[media-hosts] failed to refresh and fetch"]))).sendLogs("media-hosts-failed-to-refresh-and-fetch",{sampling:.01})}),!1)});function r(e){return t.apply(this,arguments)}return r})(),a._reset=function(){this._previousData=this._data,this._data=null,this._err=null},t})(),g=new f;function h(e){var t=e.name,n=e.message,r=e.stack,a=babelHelpers.objectWithoutPropertiesLoose(e,s),i=o("WAWebNormalizeStack").normalizeStack(e),l=i.slice(i.indexOf("\n")+1),u=Object.keys(a).length===0?"":" "+JSON.stringify(a,function(e,t){return e&&typeof t=="object"?String(t):t});return(e.name||"Error")+": "+e.message+u+"\n"+l}l.mediaHosts=g}),98);
__d("WAWebQplAbpropsConfigValueProvider",["WAWebABProps"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebABProps").getABPropConfigValue("qpl_enabled")}function s(){return o("WAWebABProps").getABPropConfigValue("qpl_upload_delay")*60}function u(){return o("WAWebABProps").getABPropConfigValue("qpl_sampling_as_string")}function c(){return o("WAWebABProps").getABPropConfigValue("qpl_initial_upload_delay")*60}l.isQplEnabled=e,l.getUploadIntervalInSeconds=s,l.getEventSampling=u,l.getInitialUploadDelayInSeconds=c}),98);
__d("WAWebQplConfig",["WALogger","WAQplConfigTypes","WAWebQplHealthLogger","WAWebQplQuickPerformanceLoggerModule","gkx"],(function(t,n,r,o,a,i,l){var e,s={sampleRate:0,samplingMethod:o("WAQplConfigTypes").QplSampleMethod.EVENT_BASED_SAMPLING},u={sampleRate:1,samplingMethod:o("WAQplConfigTypes").QplSampleMethod.EVENT_BASED_SAMPLING},c,d,m;function p(){return m.isQplEnabled()}function _(){return m.getUploadIntervalInSeconds()}function f(){return m.getInitialUploadDelayInSeconds()}function g(e){if(r("gkx")("26256"))return u;var t=o("WAWebQplQuickPerformanceLoggerModule").convertMarkerIdOrEvent(e),n=c.get(t);return n||s}function h(){try{var e=m.getEventSampling();e.indexOf("json:")===0&&(e=e.slice(5));var t=JSON.parse(e),n=t.sampling;n.forEach(function(e){var t=e[0],n=e[1],r=Math.max(e[2],0);c.set(t,{sampleRate:r,samplingMethod:n})})}catch(e){o("WAWebQplHealthLogger").errorParsingConfig(e)}}function y(t,n){return n===void 0&&(n=!1),!d||n===!0?(c=new Map,m=t,h(),d={isQplEnabled:p,uploadInterval:_,getEventDetails:g,uploadDelay:f}):o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["QPL Config has already been initialized"]))).tags("qpl"),d}l.config=y}),98);
__d("WAWebQplInitMd",["Promise","WALogger","WAQplNetwork","WAQplUploader","WAWebApiQplEvents","WAWebQplAbpropsConfigValueProvider","WAWebQplConfig","WAWebQplHealthLogger","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebQplStorageApi","WAWebQplValuesConfig","WAWebWaUlCookieUtils","WAWebXHR","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d={post:r("WAWebXHR").post};function m(){o("WAQplNetwork").defaultQplNetwork({restInterface:d,isDev:0,qplAccessToken:o("WAWebQplValuesConfig").qplConfigs.accessToken,qplAppId:o("WAWebQplValuesConfig").qplConfigs.appId,qplEndpoint:o("WAWebQplValuesConfig").qplConfigs.endpoint,waul_cookie:o("WAWebWaUlCookieUtils").getWaUlCookieIfLoggedOut()});var t=o("WAWebQplConfig").config(o("WAWebQplAbpropsConfigValueProvider"));if(t.isQplEnabled()){if(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["QPL is being initialized"]))),r("gkx")("26256")){var a=new URLSearchParams(window.location.search).get("e2etestname");o("WAQplUploader").start({sendEvents:function(t){t.forEach(function(e){a!=null&&(e.annotations?e.annotations.e2etestname=a:e.annotations={e2etestname:a})});var e=window.__je2e_recordQPLMarker;return e!=null&&typeof e=="function"&&t.forEach(e),o("WAQplNetwork").defaultQplNetwork().sendEventsOverNetwork(t)},isQplEnabled:function(){return!0},intervalInSeconds:t.uploadInterval(),startDelayInSeconds:t.uploadDelay()},{storageApi:new(o("WAWebQplStorageApi")).QplStorageApi,healthLogger:o("WAWebQplHealthLogger")})}else o("WAQplUploader").start({isQplEnabled:t.isQplEnabled,sendEvents:function(t){return o("WAQplNetwork").defaultQplNetwork().sendEventsOverNetwork(t)},intervalInSeconds:t.uploadInterval(),startDelayInSeconds:t.uploadDelay()},{storageApi:new(o("WAWebQplStorageApi")).QplStorageApi,healthLogger:o("WAWebQplHealthLogger")});o("WAWebQplQuickPerformanceLoggerModule").QPL.init(function(e,t){return o("WAWebApiQplEvents").add([e]),(c||(c=n("Promise"))).resolve()},t.getEventDetails,t.isQplEnabled)}else o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["QPL is disabled, throwing Killswitch, will clear database"]))),o("WAWebQplQuickPerformanceLoggerModule").QPL.throwKillswitch(!0),o("WAWebQplQuickPerformanceLoggerModule").QPL.clearStorage()}l.startQPL=m}),98);
__d("WAWebStickerDownloadGatingUtils",["WAWebABProps"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebABProps").getABPropConfigValue("web_sticker_download_m1")}l.isStickerDownloadM1Enabled=e}),98);
__d("WAWebAdvMetadataCreationFailureWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({AdvMetadataCreationFailure:[3048,{advMetadataIsMe:[1,o("WAWebWamCodegenUtils").TYPES.BOOLEAN]},[1,1,1],"regular"]},{AdvMetadataCreationFailure:[]});l.AdvMetadataCreationFailureWamEvent=e}),98);
__d("WAWebCommunityHomeActionWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({CommunityHomeAction:[3494,{communityHomeGroupDiscoveries:[1,e.TYPES.INTEGER],communityHomeGroupJoins:[2,e.TYPES.INTEGER],communityHomeGroupNavigations:[3,e.TYPES.INTEGER],communityHomeId:[4,e.TYPES.STRING],communityHomeViews:[5,e.TYPES.INTEGER]},[1,1,1],"regular"]},{CommunityHomeAction:[]});l.CommunityHomeActionWamEvent=s}),98);
__d("WAWebCommunityTabActionWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({CommunityTabAction:[3496,{communityNoActionTabViews:[4,e.TYPES.INTEGER],communityTabGroupNavigations:[1,e.TYPES.INTEGER],communityTabToHomeViews:[2,e.TYPES.INTEGER],communityTabViews:[3,e.TYPES.INTEGER],communityTabViewsViaContextMenu:[5,e.TYPES.INTEGER]},[1,1,1],"regular"]},{CommunityTabAction:[]});l.CommunityTabActionWamEvent=s}),98);
__d("WAWebWamEnumBackupEncryptionMethod",[],(function(t,n,r,o,a,i){var e=Object.freeze({NOT_E2EE:1,E2EE_PASSWORD:2,E2EE_64DIGIT:3,E2EE_PASSKEY:4});i.BACKUP_ENCRYPTION_METHOD=e}),66);
__d("WAWebWamEnumBackupNetworkSetting",[],(function(t,n,r,o,a,i){var e=Object.freeze({WIFI_ONLY:0,WIFI_OR_CELLULAR:1});i.BACKUP_NETWORK_SETTING=e}),66);
__d("WAWebWamEnumBackupSchedule",[],(function(t,n,r,o,a,i){var e=Object.freeze({OFF:0,DAILY:1,WEEKLY:2,MONTHLY:3,MANUAL:4});i.BACKUP_SCHEDULE=e}),66);
__d("WAWebWamEnumContactsPermissionAuthorizationStatusType",[],(function(t,n,r,o,a,i){var e=Object.freeze({NOT_DETERMINED:1,RESTRICTED:2,DENIED:3,AUTHORIZED:4,LIMITED:5});i.CONTACTS_PERMISSION_AUTHORIZATION_STATUS_TYPE=e}),66);
__d("WAWebWamEnumEmailState",[],(function(t,n,r,o,a,i){var e=Object.freeze({NOT_ADDED:1,UNVERIFIED:2,VERIFIED:3,UNCONFIRMED:4});i.EMAIL_STATE=e}),66);
__d("WAWebWamEnumGalleryPermissionState",[],(function(t,n,r,o,a,i){var e=Object.freeze({FULL:1,PARTIAL:2,NONE:3});i.GALLERY_PERMISSION_STATE=e}),66);
__d("WAWebWamEnumMediaQuality",[],(function(t,n,r,o,a,i){var e=Object.freeze({AUTO:0,DATA_SAVER:1,HIGH_QUALITY:2,HIGHEST_QUALITY:3});i.MEDIA_QUALITY=e}),66);
__d("WAWebWamEnumMetaAiModelTierType",[],(function(t,n,r,o,a,i){var e=Object.freeze({BASE:0,PREMIUM:1});i.META_AI_MODEL_TIER_TYPE=e}),66);
__d("WAWebWamEnumNotificationSettingType",[],(function(t,n,r,o,a,i){var e=Object.freeze({ALLOWED:1,BLOCKED:2,UNKNOWN:3});i.NOTIFICATION_SETTING_TYPE=e}),66);
__d("WAWebWamEnumPrivacySettingsContactsBuckets",[],(function(t,n,r,o,a,i){var e=Object.freeze({B0:1,B1:2,B5:3,B10:4,B15:5,B20:6,B30:7,B40:8,B50:9,B60:10,B70:11,B80:12,B90:13,B100:14});i.PRIVACY_SETTINGS_CONTACTS_BUCKETS=e}),66);
__d("WAWebWamEnumPrivacySettingsValueType",[],(function(t,n,r,o,a,i){var e=Object.freeze({NOBODY:1,ONLY_SHARE_WITH:2,MY_CONTACTS:3,MY_CONTACTS_EXCEPT:4,EVERYONE:5,KNOWN:6,CLOSE_FRIENDS:7});i.PRIVACY_SETTINGS_VALUE_TYPE=e}),66);
__d("WAWebDailyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAndroidKeystoreStateType","WAWebWamEnumBackupEncryptionMethod","WAWebWamEnumBackupNetworkSetting","WAWebWamEnumBackupSchedule","WAWebWamEnumContactsPermissionAuthorizationStatusType","WAWebWamEnumEmailState","WAWebWamEnumGalleryPermissionState","WAWebWamEnumMediaQuality","WAWebWamEnumMetaAiModelTierType","WAWebWamEnumNotificationSettingType","WAWebWamEnumPrivacySettingsContactsBuckets","WAWebWamEnumPrivacySettingsValueType"],(function(t,n,r,o,a,i,l){var e,s,u,c=(e=o("WAWebWamCodegenUtils")).defineEvents({Daily:[1158,{accessibilityVoiceover:[108,e.TYPES.BOOLEAN],addressbookSize:[11,e.TYPES.INTEGER],addressbookWhatsappSize:[12,e.TYPES.INTEGER],aiMemorySavedCnt:[223,e.TYPES.INTEGER],aiWidgetInstalled:[210,e.TYPES.BOOLEAN],androidAdvertisingId:[135,e.TYPES.STRING],androidKeystoreState:[139,o("WAWebWamEnumAndroidKeystoreStateType").ANDROID_KEYSTORE_STATE_TYPE],appCodeHash:[103,e.TYPES.STRING],appLastOpenTimestamp:[212,e.TYPES.INTEGER],appStandbyBucket:[121,e.TYPES.INTEGER],autoDlAudioCellular:[90,e.TYPES.BOOLEAN],autoDlAudioRoaming:[91,e.TYPES.BOOLEAN],autoDlAudioWifi:[89,e.TYPES.BOOLEAN],autoDlDocCellular:[96,e.TYPES.BOOLEAN],autoDlDocRoaming:[97,e.TYPES.BOOLEAN],autoDlDocWifi:[95,e.TYPES.BOOLEAN],autoDlImageCellular:[87,e.TYPES.BOOLEAN],autoDlImageRoaming:[88,e.TYPES.BOOLEAN],autoDlImageWifi:[86,e.TYPES.BOOLEAN],autoDlVideoCellular:[93,e.TYPES.BOOLEAN],autoDlVideoRoaming:[94,e.TYPES.BOOLEAN],autoDlVideoWifi:[92,e.TYPES.BOOLEAN],backupEncryptionMethod:[231,o("WAWebWamEnumBackupEncryptionMethod").BACKUP_ENCRYPTION_METHOD],backupNetworkSetting:[10,o("WAWebWamEnumBackupNetworkSetting").BACKUP_NETWORK_SETTING],backupRestoreEncryptionVersion:[138,e.TYPES.INTEGER],backupSchedule:[9,o("WAWebWamEnumBackupSchedule").BACKUP_SCHEDULE],canonicalEntLastValidationTsMs:[241,e.TYPES.INTEGER],channelsMediaFolderSize:[186,e.TYPES.INTEGER],chatDatabaseSize:[19,e.TYPES.INTEGER],chatLockFolderCount:[168,e.TYPES.INTEGER],contactsCreatedOnWhatsappSize:[200,e.TYPES.INTEGER],contactsPermissionAuthorizationStatus:[201,o("WAWebWamEnumContactsPermissionAuthorizationStatusType").CONTACTS_PERMISSION_AUTHORIZATION_STATUS_TYPE],contactsRequiringSyncBeforeDisplaySize:[238,e.TYPES.INTEGER],count1on1Threads:[216,e.TYPES.INTEGER],countEphemeralThreads:[181,e.TYPES.INTEGER],countEphemeralThreadsEnabledByMe:[182,e.TYPES.INTEGER],countGroupThreads:[217,e.TYPES.INTEGER],countLimitSharing1on1Threads:[218,e.TYPES.INTEGER],countLimitSharingGroupThreads:[219,e.TYPES.INTEGER],dbAddressbookTableSize:[206,e.TYPES.INTEGER],defaultDisappearingDuration:[140,e.TYPES.INTEGER],defenseMode:[214,e.TYPES.INTEGER],deprecatedContactsSize:[228,e.TYPES.INTEGER],deviceLanguage:[153,e.TYPES.STRING],emailState:[174,o("WAWebWamEnumEmailState").EMAIL_STATE],entSecurityNotificationsEnabled:[134,e.TYPES.BOOLEAN],experimentTmoPreloadGroupDaily:[166,e.TYPES.INTEGER],favoritedAnimatedStickerCount:[113,e.TYPES.INTEGER],favoritedFirstPartyStickerCount:[112,e.TYPES.INTEGER],favoritedTotalStickerCount:[111,e.TYPES.INTEGER],galleryPermission:[164,o("WAWebWamEnumGalleryPermissionState").GALLERY_PERMISSION_STATE],hasTextstatusEmojiModified24h:[175,e.TYPES.BOOLEAN],hasTextstatusModified24h:[176,e.TYPES.BOOLEAN],hasTextstatusTextModified24h:[177,e.TYPES.BOOLEAN],hasUsername:[187,e.TYPES.BOOLEAN],hasUsernamePin:[222,e.TYPES.BOOLEAN],inNetworkContactsSize:[190,e.TYPES.INTEGER],installedAnimatedStickerPackCount:[116,e.TYPES.INTEGER],installedAnimatedThirdPartyStickerPackCount:[137,e.TYPES.INTEGER],installedFirstPartyStickerPackCount:[115,e.TYPES.INTEGER],installedTotalStickerPackCount:[114,e.TYPES.INTEGER],isCanonicalEntPresent:[234,e.TYPES.BOOLEAN],isContactSyncToOsDefaultOn:[202,e.TYPES.BOOLEAN],isDefaultDisappearingMessagingUser:[183,e.TYPES.BOOLEAN],isEphemeralMessagingUser:[184,e.TYPES.BOOLEAN],isProfilePhotoSet:[195,e.TYPES.BOOLEAN],keyboardLanguage:[154,e.TYPES.STRING],languageCode:[5,e.TYPES.STRING],lastBackupTimestamp:[63,e.TYPES.INTEGER],lastCloudBackupSize:[185,e.TYPES.INTEGER],locationCode:[6,e.TYPES.STRING],lockFolderHidden:[171,e.TYPES.BOOLEAN],lowestAppStandbyBucket:[160,e.TYPES.INTEGER],mdPairTime:[124,e.TYPES.INTEGER],mediaFolderFileCount:[21,e.TYPES.INTEGER],mediaFolderSize:[20,e.TYPES.INTEGER],mediaQualitySetting:[188,o("WAWebWamEnumMediaQuality").MEDIA_QUALITY],mediaSizeCacheAgeSeconds:[239,e.TYPES.INTEGER],metaAiModelActual:[198,o("WAWebWamEnumMetaAiModelTierType").META_AI_MODEL_TIER_TYPE],metaAiModelSelected:[199,o("WAWebWamEnumMetaAiModelTierType").META_AI_MODEL_TIER_TYPE],metaAiVoiceDefaultOn:[220,e.TYPES.BOOLEAN],metaAiVoiceSelection:[221,e.TYPES.STRING],modifiedInternalProps:[155,e.TYPES.BOOLEAN],nativeContactsGlobalSettingEnabled:[205,e.TYPES.BOOLEAN],networkIsRoaming:[7,e.TYPES.BOOLEAN],networkOperatorName:[159,e.TYPES.STRING],numAccounts:[163,e.TYPES.INTEGER],numContactsWithTextstatus24h:[178,e.TYPES.INTEGER],numContactsWithTextstatusEmoji24h:[179,e.TYPES.INTEGER],numContactsWithTextstatusText24h:[180,e.TYPES.INTEGER],osBuildNumber:[4,e.TYPES.STRING],osNotificationSetting:[118,o("WAWebWamEnumNotificationSettingType").NOTIFICATION_SETTING_TYPE],outOfNetworkContactsSize:[191,e.TYPES.INTEGER],packageName:[102,e.TYPES.STRING],passkeyExists:[165,e.TYPES.BOOLEAN],paymentsIsEnabled:[100,e.TYPES.BOOLEAN],peripheralConnected:[209,e.TYPES.STRING],peripheralLinkedProductLine:[229,e.TYPES.STRING],permissionAccessCoarseLocation:[57,e.TYPES.INTEGER],permissionAccessFineLocation:[58,e.TYPES.INTEGER],permissionCamera:[56,e.TYPES.INTEGER],permissionContacts:[104,e.TYPES.BOOLEAN],permissionReadExternalStorage:[53,e.TYPES.INTEGER],permissionRecordAudio:[55,e.TYPES.INTEGER],phoneCores:[156,e.TYPES.INTEGER],phoneyid:[162,e.TYPES.STRING],preloadsAppManagerId:[224,e.TYPES.STRING],preloadsAttributionJson:[227,e.TYPES.STRING],privacySettingsAbout:[141,(s=o("WAWebWamEnumPrivacySettingsValueType")).PRIVACY_SETTINGS_VALUE_TYPE],privacySettingsAboutExceptNum:[142,(u=o("WAWebWamEnumPrivacySettingsContactsBuckets")).PRIVACY_SETTINGS_CONTACTS_BUCKETS],privacySettingsCoverPhoto:[235,s.PRIVACY_SETTINGS_VALUE_TYPE],privacySettingsGroups:[143,s.PRIVACY_SETTINGS_VALUE_TYPE],privacySettingsGroupsExceptNum:[144,u.PRIVACY_SETTINGS_CONTACTS_BUCKETS],privacySettingsLastSeen:[145,s.PRIVACY_SETTINGS_VALUE_TYPE],privacySettingsLastSeenExceptNum:[146,u.PRIVACY_SETTINGS_CONTACTS_BUCKETS],privacySettingsProfileLinks:[225,s.PRIVACY_SETTINGS_VALUE_TYPE],privacySettingsProfileLinksExceptNum:[226,u.PRIVACY_SETTINGS_CONTACTS_BUCKETS],privacySettingsProfilePhoto:[147,s.PRIVACY_SETTINGS_VALUE_TYPE],privacySettingsProfilePhotoExceptNum:[148,u.PRIVACY_SETTINGS_CONTACTS_BUCKETS],privacySettingsStatus:[150,s.PRIVACY_SETTINGS_VALUE_TYPE],privacySettingsStatusExceptNum:[151,u.PRIVACY_SETTINGS_CONTACTS_BUCKETS],privacySettingsStatusShareNum:[152,u.PRIVACY_SETTINGS_CONTACTS_BUCKETS],profileLinksCount:[211,e.TYPES.INTEGER],receiptsEnabled:[8,e.TYPES.BOOLEAN],secretCodeActive:[172,e.TYPES.BOOLEAN],showMetaAiButtonSetting:[173,e.TYPES.BOOLEAN],simMcc:[2,e.TYPES.INTEGER],simMnc:[3,e.TYPES.INTEGER],storageAvailSize:[31,e.TYPES.INTEGER],storageAvailSizeWithCache:[136,e.TYPES.INTEGER],storageTotalSize:[32,e.TYPES.INTEGER],supportedDecoders:[169,e.TYPES.STRING],supportedEncoders:[170,e.TYPES.STRING],syncedInNetworkContactsSize:[192,e.TYPES.INTEGER],totalCountInNetworkUniquePhoneNumber:[193,e.TYPES.INTEGER],totalCountSyncedInNetworkUniquePhoneNumber:[194,e.TYPES.INTEGER],totalMissedCalls:[232,e.TYPES.INTEGER],totalUnreadMessages:[233,e.TYPES.INTEGER],traceIdInt:[240,e.TYPES.INTEGER],trafficAnonymization:[215,e.TYPES.INTEGER],uniquePhoneNumberContactsSizeWithUsername:[236,e.TYPES.INTEGER],unreadBadgeFrequency:[213,e.TYPES.INTEGER],usernameOnlyContactsSize:[237,e.TYPES.INTEGER],videoFolderFileCount:[23,e.TYPES.INTEGER],videoFolderSize:[22,e.TYPES.INTEGER],webcContactsTableSize:[207,e.TYPES.INTEGER],webcFilteredContactsSize:[208,e.TYPES.INTEGER]},[1,1,1],"regular"]},{Daily:[]});l.DailyWamEvent=c}),98);
__d("WAWebWamEnumRetryRejectReason",[],(function(t,n,r,o,a,i){var e=Object.freeze({OTHER:0,DOUBLE_CHECKMARK:1,IDENTITY_CHANGE:2,MESSAGE_NOT_EXIST:3,HIGH_RETRY_COUNT:4});i.RETRY_REJECT_REASON=e}),66);
__d("WAWebE2eRetryRejectWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumDeviceType","WAWebWamEnumInvisibleMessageCategoryType","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWamEnumRetryRejectReason"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({E2eRetryReject:[3578,{invisibleMessageCategory:[6,o("WAWebWamEnumInvisibleMessageCategoryType").INVISIBLE_MESSAGE_CATEGORY_TYPE],isPq:[8,e.TYPES.BOOLEAN],mediaType:[7,o("WAWebWamEnumMediaType").MEDIA_TYPE],messageType:[1,o("WAWebWamEnumMessageType").MESSAGE_TYPE],msgRetryCount:[2,e.TYPES.INTEGER],retryRejectReason:[3,o("WAWebWamEnumRetryRejectReason").RETRY_REJECT_REASON],retryRevoke:[4,e.TYPES.BOOLEAN],senderDeviceType:[5,o("WAWebWamEnumDeviceType").DEVICE_TYPE]},[1,1,1],"regular"]},{E2eRetryReject:[]});l.E2eRetryRejectWamEvent=s}),98);
__d("WAWebWamEnumForwardOrigin",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNKNOWN:1,CHAT:2,STATUS:3,CHANNELS:4,META_AI:5});i.FORWARD_ORIGIN=e}),66);
__d("WAWebWamEnumForwardPickerOrigin",[],(function(t,n,r,o,a,i){var e=Object.freeze({STATUS_VIEWER:1});i.FORWARD_PICKER_ORIGIN=e}),66);
__d("WAWebWamEnumMessageBizType",[],(function(t,n,r,o,a,i){var e=Object.freeze({NOT_BIZ_MSG:0,API_MARKETING:1,API_UTILITY:2,OTHER_API_BIZ_MSG:3,SMB_BIZ_MSG:4});i.MESSAGE_BIZ_TYPE=e}),66);
__d("WAWebForwardSendWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumDisappearingChatInitiatorType","WAWebWamEnumE2eCiphertextType","WAWebWamEnumEphemeralityInitiatorType","WAWebWamEnumEphemeralityTriggerActionType","WAWebWamEnumForwardOrigin","WAWebWamEnumForwardPickerOrigin","WAWebWamEnumMediaType","WAWebWamEnumMessageBizType","WAWebWamEnumMessageType","WAWebWamEnumTypeOfGroupEnum"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({ForwardSend:[1728,{disappearingChatInitiator:[21,o("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE],e2eCiphertextType:[12,o("WAWebWamEnumE2eCiphertextType").E2E_CIPHERTEXT_TYPE],e2eCiphertextVersion:[11,e.TYPES.INTEGER],ephemeralityDuration:[18,e.TYPES.INTEGER],ephemeralityInitiator:[24,o("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE],ephemeralityTriggerAction:[25,o("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE],fastForwardEnabled:[5,e.TYPES.BOOLEAN],forwardOrigin:[28,o("WAWebWamEnumForwardOrigin").FORWARD_ORIGIN],forwardPickerOrigin:[27,o("WAWebWamEnumForwardPickerOrigin").FORWARD_PICKER_ORIGIN],isForwardedForward:[22,e.TYPES.BOOLEAN],isFrequentlyForwarded:[14,e.TYPES.BOOLEAN],mediaCaptionPresent:[10,e.TYPES.BOOLEAN],messageBizType:[26,o("WAWebWamEnumMessageBizType").MESSAGE_BIZ_TYPE],messageForwardAgeT:[4,e.TYPES.TIMER],messageIsFanout:[6,e.TYPES.BOOLEAN],messageIsFastForward:[3,e.TYPES.BOOLEAN],messageIsInternational:[9,e.TYPES.BOOLEAN],messageMediaType:[2,o("WAWebWamEnumMediaType").MEDIA_TYPE],messageSendT:[13,e.TYPES.TIMER],messageType:[1,o("WAWebWamEnumMessageType").MESSAGE_TYPE],receiverDefaultDisappearingDuration:[20,e.TYPES.INTEGER],resendCount:[8,e.TYPES.INTEGER],retryCount:[7,e.TYPES.INTEGER],senderDefaultDisappearingDuration:[19,e.TYPES.INTEGER],typeOfGroup:[23,o("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM],wouldBeFrequentlyForwardedAt3:[16,e.TYPES.BOOLEAN],wouldBeFrequentlyForwardedAt4:[17,e.TYPES.BOOLEAN]},[1,1,1],"regular"]},{ForwardSend:[]});l.ForwardSendWamEvent=s}),98);
__d("WAWebKeepInChatNotifWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({KeepInChatNotif:[3484,{kicGroupNotificationTaps:[3,e.TYPES.INTEGER],kicGroupNotifications:[4,e.TYPES.INTEGER],kicNotificationTaps:[5,e.TYPES.INTEGER],kicNotifications:[6,e.TYPES.INTEGER]},[1,1,1],"regular"]},{KeepInChatNotif:[]});l.KeepInChatNotifWamEvent=s}),98);
__d("WAWebMdAppStateDirtyBitsWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({MdAppStateDirtyBits:[2520,{dirtyBitsFalsePositive:[2,o("WAWebWamCodegenUtils").TYPES.BOOLEAN]},[1,20,1e3],"regular"]},{MdAppStateDirtyBits:[]});l.MdAppStateDirtyBitsWamEvent=e}),98);
__d("WAWebWamEnumMdAppStateKeyRotationReasonCode",[],(function(t,n,r,o,a,i){var e=Object.freeze({APP_STATE_SYNC_KEY_EXPIRY:1,DEVICE_DEREGISTERATION:2,NO_KEYS:3});i.MD_APP_STATE_KEY_ROTATION_REASON_CODE=e}),66);
__d("WAWebMdAppStateKeyRotationWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMdAppStateKeyRotationReasonCode"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MdAppStateKeyRotation:[2518,{appSessionId:[2,e.TYPES.STRING],companionSessionIds:[3,e.TYPES.STRING],mdAppStateKeyRotationReason:[1,o("WAWebWamEnumMdAppStateKeyRotationReasonCode").MD_APP_STATE_KEY_ROTATION_REASON_CODE],oldSyncdKeyhash:[6,e.TYPES.STRING],oldSyncdKeyid:[7,e.TYPES.STRING],seqNumber:[8,e.TYPES.INTEGER],syncdKeyhashAfterRotation:[9,e.TYPES.STRING],syncdKeyidAfterRotation:[10,e.TYPES.STRING]},[1,20,1e3],"regular"]},{MdAppStateKeyRotation:[]});l.MdAppStateKeyRotationWamEvent=s}),98);
__d("WAWebMdAppStateMessageRangeWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({MdAppStateMessageRange:[2522,{additionalMessagesCount:[1,o("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,20,1e3],"regular"]},{MdAppStateMessageRange:[]});l.MdAppStateMessageRangeWamEvent=e}),98);
__d("WAWebMdAppStateSyncDailyWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MdAppStateSyncDaily:[2300,{crossIndexConflictCount:[11,e.TYPES.INTEGER],invalidActionCount:[4,e.TYPES.INTEGER],keyRotationRemoveCount:[12,e.TYPES.INTEGER],missingKeyCount:[9,e.TYPES.INTEGER],mutationCount:[1,e.TYPES.INTEGER],storedMutationCount:[7,e.TYPES.INTEGER],unsetActionCount:[8,e.TYPES.INTEGER],unsupportedActionCount:[5,e.TYPES.INTEGER],uploadConflictCount:[10,e.TYPES.INTEGER]},[1,1,1],"regular"]},{MdAppStateSyncDaily:[]});l.MdAppStateSyncDailyWamEvent=s}),98);
__d("WAWebWamEnumMutationCountBucket",[],(function(t,n,r,o,a,i){var e=Object.freeze({ZERO:1,ONE:2,LT10:3,LT100:4,LT500:5,LT1K:6,LT5K:7,GTE5K:8});i.MUTATION_COUNT_BUCKET=e}),66);
__d("WAWebMdAppStateSyncMutationStatsWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMutationCountBucket"],(function(t,n,r,o,a,i,l){var e,s=o("WAWebWamCodegenUtils").defineEvents({MdAppStateSyncMutationStats:[3180,{applied:[1,(e=o("WAWebWamEnumMutationCountBucket")).MUTATION_COUNT_BUCKET],failed:[2,e.MUTATION_COUNT_BUCKET],invalid:[3,e.MUTATION_COUNT_BUCKET],orphan:[4,e.MUTATION_COUNT_BUCKET],syncdAction:[5,o("WAWebWamCodegenUtils").TYPES.STRING],unsupported:[6,e.MUTATION_COUNT_BUCKET]},[1,1,100],"private",0]},{MdAppStateSyncMutationStats:[]});l.MdAppStateSyncMutationStatsWamEvent=s}),98);
__d("WAWebWamEnumBootstrapAppStateDataStageCode",[],(function(t,n,r,o,a,i){var e=Object.freeze({REQUEST_BUILT:1,RESPONSE_RECEIVED:2,RESPONSE_PARSED_VALID:3,MISSING_KEYS_REQUESTED:4,MISSING_KEYS_RECEIVED:5,MUTATIONS_DECRYPTED:6,ABOUT_TO_APPLY_MUTATIONS:7,APPLIED_MUTATIONS:8,PUSHNAME_APPLIED:9,PUSHNAME_INVALID:10,ENTERED_RETRY_MODE:11});i.BOOTSTRAP_APP_STATE_DATA_STAGE_CODE=e}),66);
__d("WAWebWamEnumMdBootstrapPayloadType",[],(function(t,n,r,o,a,i){var e=Object.freeze({CRITICAL:1,NON_CRITICAL:2});i.MD_BOOTSTRAP_PAYLOAD_TYPE=e}),66);
__d("WAWebMdBootstrapAppStateCriticalDataProcessingWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumBootstrapAppStateDataStageCode","WAWebWamEnumMdBootstrapPayloadType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MdBootstrapAppStateCriticalDataProcessing:[3164,{bootstrapAppStateDataStage:[1,o("WAWebWamEnumBootstrapAppStateDataStageCode").BOOTSTRAP_APP_STATE_DATA_STAGE_CODE],mdBootstrapPayloadType:[2,o("WAWebWamEnumMdBootstrapPayloadType").MD_BOOTSTRAP_PAYLOAD_TYPE],mdRegAttemptId:[3,e.TYPES.STRING],mdSessionId:[4,e.TYPES.STRING],mdTimestamp:[5,e.TYPES.INTEGER]},[1,1,1],"regular"]},{MdBootstrapAppStateCriticalDataProcessing:[]});l.MdBootstrapAppStateCriticalDataProcessingWamEvent=s}),98);
__d("WAWebWamEnumMdBootstrapHistoryPayloadType",[],(function(t,n,r,o,a,i){var e=Object.freeze({INITIAL:1,RECENT_HISTORY:2,FULL_HISTORY:3,PUSHNAME:4,STATUS_V3:5,NON_BLOCKING_DATA:6,ON_DEMAND:7});i.MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE=e}),66);
__d("WAWebWamEnumMdBootstrapStepResult",[],(function(t,n,r,o,a,i){var e=Object.freeze({SUCCESS:1,FAILURE:2});i.MD_BOOTSTRAP_STEP_RESULT=e}),66);
__d("WAWebMdBootstrapAppStateDataDownloadedWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumApplicationState","WAWebWamEnumMdBootstrapHistoryPayloadType","WAWebWamEnumMdBootstrapPayloadType","WAWebWamEnumMdBootstrapStepResult"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MdBootstrapAppStateDataDownloaded:[2294,{appContext:[14,e.TYPES.STRING],appContextBitfield:[15,e.TYPES.INTEGER],applicationState:[13,o("WAWebWamEnumApplicationState").APPLICATION_STATE],historySyncRetryRequestId:[16,e.TYPES.STRING],mdBootstrapContactsCount:[5,e.TYPES.INTEGER],mdBootstrapHistoryPayloadType:[11,o("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE],mdBootstrapPayloadSize:[4,e.TYPES.INTEGER],mdBootstrapPayloadType:[2,o("WAWebWamEnumMdBootstrapPayloadType").MD_BOOTSTRAP_PAYLOAD_TYPE],mdBootstrapStepDuration:[6,e.TYPES.INTEGER],mdBootstrapStepResult:[7,o("WAWebWamEnumMdBootstrapStepResult").MD_BOOTSTRAP_STEP_RESULT],mdRegAttemptId:[10,e.TYPES.STRING],mdSessionId:[1,e.TYPES.STRING],mdStorageQuotaBytes:[8,e.TYPES.INTEGER],mdStorageQuotaUsedBytes:[9,e.TYPES.INTEGER],mdTimestamp:[3,e.TYPES.INTEGER]},[1,1,1],"regular"]},{MdBootstrapAppStateDataDownloaded:[]});l.MdBootstrapAppStateDataDownloadedWamEvent=s}),98);
__d("WAWebWamEnumMdBootstrapSource",[],(function(t,n,r,o,a,i){var e=Object.freeze({APP_STATE:1,HISTORY:2});i.MD_BOOTSTRAP_SOURCE=e}),66);
__d("WAWebMdBootstrapDataAppliedWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumApplicationState","WAWebWamEnumCollection","WAWebWamEnumMdBootstrapHistoryPayloadType","WAWebWamEnumMdBootstrapPayloadType","WAWebWamEnumMdBootstrapSource","WAWebWamEnumMdBootstrapStepResult"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MdBootstrapDataApplied:[2298,{appContext:[22,e.TYPES.STRING],appContextBitfield:[23,e.TYPES.INTEGER],applicationState:[21,o("WAWebWamEnumApplicationState").APPLICATION_STATE],chunkChatsApplied:[15,e.TYPES.INTEGER],chunkMsgsApplied:[16,e.TYPES.INTEGER],collection:[5,o("WAWebWamEnumCollection").COLLECTION],historySyncChunkOrder:[14,e.TYPES.INTEGER],historySyncRetryRequestId:[24,e.TYPES.STRING],historySyncStageProgress:[11,e.TYPES.INTEGER],mdBootstrapChatsCount:[17,e.TYPES.INTEGER],mdBootstrapContactsCount:[8,e.TYPES.INTEGER],mdBootstrapHistoryPayloadType:[10,o("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE],mdBootstrapMessagesCount:[18,e.TYPES.INTEGER],mdBootstrapPayloadType:[3,o("WAWebWamEnumMdBootstrapPayloadType").MD_BOOTSTRAP_PAYLOAD_TYPE],mdBootstrapSource:[2,o("WAWebWamEnumMdBootstrapSource").MD_BOOTSTRAP_SOURCE],mdBootstrapStepDuration:[6,e.TYPES.INTEGER],mdBootstrapStepResult:[12,o("WAWebWamEnumMdBootstrapStepResult").MD_BOOTSTRAP_STEP_RESULT],mdDroppedMsgType:[19,e.TYPES.STRING],mdRegAttemptId:[9,e.TYPES.STRING],mdSessionId:[1,e.TYPES.STRING],mdSyncFailureReason:[20,e.TYPES.STRING],mdTimestamp:[4,e.TYPES.INTEGER],sentViaMms:[13,e.TYPES.BOOLEAN],usedSnapshot:[7,e.TYPES.BOOLEAN]},[1,1,1],"regular"]},{MdBootstrapDataApplied:[]});l.MdBootstrapDataAppliedWamEvent=s}),98);
__d("WAWebMdBootstrapHistoryDataDownloadedWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumApplicationState","WAWebWamEnumMdBootstrapHistoryPayloadType","WAWebWamEnumMdBootstrapPayloadType","WAWebWamEnumMdBootstrapStepResult"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MdBootstrapHistoryDataDownloaded:[2296,{appContext:[18,e.TYPES.STRING],appContextBitfield:[19,e.TYPES.INTEGER],applicationState:[17,o("WAWebWamEnumApplicationState").APPLICATION_STATE],historySyncChunkOrder:[15,e.TYPES.INTEGER],historySyncRetryRequestId:[20,e.TYPES.STRING],historySyncStageProgress:[14,e.TYPES.INTEGER],mdBootstrapChatsCount:[6,e.TYPES.INTEGER],mdBootstrapHistoryPayloadType:[13,o("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE],mdBootstrapMessagesCount:[5,e.TYPES.INTEGER],mdBootstrapPayloadSize:[4,e.TYPES.INTEGER],mdBootstrapPayloadThumbnailsSize:[21,e.TYPES.INTEGER],mdBootstrapPayloadType:[2,o("WAWebWamEnumMdBootstrapPayloadType").MD_BOOTSTRAP_PAYLOAD_TYPE],mdBootstrapStepDuration:[7,e.TYPES.INTEGER],mdBootstrapStepResult:[8,o("WAWebWamEnumMdBootstrapStepResult").MD_BOOTSTRAP_STEP_RESULT],mdHsOldestMessageTimestamp:[11,e.TYPES.INTEGER],mdRegAttemptId:[12,e.TYPES.STRING],mdSessionId:[1,e.TYPES.STRING],mdStorageQuotaBytes:[9,e.TYPES.INTEGER],mdStorageQuotaUsedBytes:[10,e.TYPES.INTEGER],mdSyncFailureReason:[16,e.TYPES.STRING],mdTimestamp:[3,e.TYPES.INTEGER]},[1,1,1],"regular"]},{MdBootstrapHistoryDataDownloaded:[]});l.MdBootstrapHistoryDataDownloadedWamEvent=s}),98);
__d("WAWebMdBootstrapHistoryDataStartDownloadingWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMdBootstrapHistoryPayloadType","WAWebWamEnumMdBootstrapPayloadType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MdBootstrapHistoryDataStartDownloading:[4650,{historySyncChunkOrder:[1,e.TYPES.INTEGER],historySyncRetryRequestId:[9,e.TYPES.STRING],historySyncStageProgress:[2,e.TYPES.INTEGER],mdBootstrapHistoryPayloadType:[3,o("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE],mdBootstrapPayloadSize:[4,e.TYPES.INTEGER],mdBootstrapPayloadType:[5,o("WAWebWamEnumMdBootstrapPayloadType").MD_BOOTSTRAP_PAYLOAD_TYPE],mdBootstrapStepDuration:[6,e.TYPES.INTEGER],mdSessionId:[7,e.TYPES.STRING],mdTimestamp:[8,e.TYPES.INTEGER]},[1,1,1],"regular"]},{MdBootstrapHistoryDataStartDownloading:[]});l.MdBootstrapHistoryDataStartDownloadingWamEvent=s}),98);
__d("WAWebWamEnumActiveTimeAfterPairing",[],(function(t,n,r,o,a,i){var e=Object.freeze({MINS_10:1,MINS_20:2,MINS_40:3,MINS_60:4,MINS_5:5});i.ACTIVE_TIME_AFTER_PAIRING=e}),66);
__d("WAWebWamEnumMdHistorySyncStatusResult",[],(function(t,n,r,o,a,i){var e=Object.freeze({SUCCESS:1,UNFINISHED:2,FAIL_TO_DOWNLOAD:3,MISSING_CHUNK:4,PROTOBUF_ERROR:5,FAIL_TO_STORE:6,OTHER_ERROR:7,IN_PROGRESS:8,FAIL_TO_RECEIVE:9,FAIL_TO_STORE_CHUNK:10,FAIL_TO_FETCH:11,FAIL_TO_PREPROCESS:12,FAIL_TO_ENCRYPT:13});i.MD_HISTORY_SYNC_STATUS_RESULT=e}),66);
__d("WAWebMdBootstrapHistorySyncStatusAfterPairingWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumActiveTimeAfterPairing","WAWebWamEnumMdBootstrapHistoryPayloadType","WAWebWamEnumMdHistorySyncStatusResult"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MdBootstrapHistorySyncStatusAfterPairing:[4652,{activeTimeAfterPairing:[1,o("WAWebWamEnumActiveTimeAfterPairing").ACTIVE_TIME_AFTER_PAIRING],isLoopRunning:[12,e.TYPES.BOOLEAN],lastProcessedNotificationChunkOrder:[2,e.TYPES.INTEGER],lastProcessedNotificationChunkProgress:[3,e.TYPES.INTEGER],mdBootstrapHistoryPayloadType:[4,o("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE],mdHistorySyncStatusResult:[5,o("WAWebWamEnumMdHistorySyncStatusResult").MD_HISTORY_SYNC_STATUS_RESULT],mdSessionId:[6,e.TYPES.STRING],mdTimestamp:[7,e.TYPES.INTEGER],missingNotificationCount:[8,e.TYPES.INTEGER],nextNotificationChunkOrder:[9,e.TYPES.INTEGER],totalProcessedMessageCount:[10,e.TYPES.INTEGER],unprocessedNotificationCount:[11,e.TYPES.INTEGER]},[1,1,1],"regular"]},{MdBootstrapHistorySyncStatusAfterPairing:[]});l.MdBootstrapHistorySyncStatusAfterPairingWamEvent=s}),98);
__d("WAWebMdDeviceSyncAckWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAddressingMode","WAWebWamEnumInvisibleMessageCategoryType","WAWebWamEnumMessageChatType","WAWebWamEnumTypeOfGroupEnum"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({MdDeviceSyncAck:[2180,{chatType:[1,o("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE],invisibleMessageCategory:[7,o("WAWebWamEnumInvisibleMessageCategoryType").INVISIBLE_MESSAGE_CATEGORY_TYPE],isLid:[3,o("WAWebWamCodegenUtils").TYPES.BOOLEAN],localAddressingMode:[5,o("WAWebWamEnumAddressingMode").ADDRESSING_MODE],revoke:[2,o("WAWebWamCodegenUtils").TYPES.BOOLEAN],serverAddressingMode:[6,o("WAWebWamEnumAddressingMode").ADDRESSING_MODE],typeOfGroup:[4,o("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM]},[1,1,1],"regular"]},{MdDeviceSyncAck:[]});l.MdDeviceSyncAckWamEvent=e}),98);
__d("WAWebWamEnumMdCompanionDeviceAccountType",[],(function(t,n,r,o,a,i){var e=Object.freeze({E2EE_DEVICE:1,HOSTED_DEVICE:2});i.MD_COMPANION_DEVICE_ACCOUNT_TYPE=e}),66);
__d("WAWebWamEnumMdSyncdFatalErrorCode",[],(function(t,n,r,o,a,i){var e=Object.freeze({TOO_MANY_INTERNAL_SERVER_ERRORS_IN_7D:1,SERVER_DATA_MISMATCH:2,PROTOBUF_DESERIALIZATION_FAILED:3,EXTERNAL_PATCH_EXPIRED:4,MISSING_OR_EMPTY_INDEX:5,SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_PATCH:6,DECRYPTION_FAILED:7,MISSING_PATCH_VERSION:8,DUPLICATE_PATCH_VERSION_IN_COLLECTION:9,ENCRYPTION_FAILED:10,MISSING_MUTATION_VERSION:11,MISSING_MUTATION_VALUE:12,INVALID_MUTATION_INDEX:13,PATCH_WITH_BOTH_INLINE_AND_EXTERNAL_MUTATIONS:14,MISSING_MUTATION_OPERATION:15,MISSING_MUTATION_RECORD:16,MISSING_MUTATION_KEY_ID:17,PATCH_PROTOBUF_DESERIALIZATION_FAILED:18,ACTION_DATA_PROTOBUF_DESERIALIZATION_FAILED:19,MISSING_MUTATION_INDEX:20,MISSING_ACTION_INDEX:21,INVALID_ACTION_INDEX:22,MISSING_ACTION_VALUE:23,MISSING_ACTION_VERSION:24,MISSING_ACTION_TIMESTAMP:25,MUTATIONS_PROTOBUF_DESERIALIZATION_FAILED:26,MUTATIONS_PROTOBUF_SERIALIZATION_FAILED:27,PATCH_PROTOBUF_SERIALIZATION_FAILED:28,ACTION_DATA_PROTOBUF_SERIALIZATION_FAILED:29,MISSING_KEY_ON_ALL_CLIENTS:30,TIMEOUT_WHILE_WAITING_FOR_MISSING_KEY:31,MAC_MISMATCH_SNAPSHOT:33,MAC_MISMATCH_PATCH:34,DB_STORE_NOT_READY:35,TERMINAL_PATCH_MISSING_DATA:36,TERMINAL_PATCH_DESERIALIZATION_ERROR:37,TERMINAL_PATCH_UNKNOWN:38,CYCLIC_MUTATION_DEPENDENCY_IN_PATCH:39,MISSING_SNAPSHOT_VERSION:45,MISSING_SNAPSHOT_MAC:46,MISSING_PATCH_SNAPSHOT_MAC:47,MISSING_PATCH_MAC:48,MISSING_EXTERNAL_BLOB_REFERENCE_MEDIA_KEY:49,MISSING_EXTERNAL_BLOB_REFERENCE_DIRECT_PATH:50,MISSING_EXTERNAL_BLOB_REFERENCE_FILE_SHA256:51,MISSING_EXTERNAL_BLOB_REFERENCE_FILE_ENC_SHA256:52,INVALID_KEY_SHARE_KEY_ID:53,MISSING_PATCH_KEY_ID:56,INVALID_KEY_SHARE_KEY_DATA:57,SNAPSHOT_EXPIRED:58,MISSING_SNAPSHOT_KEY_ID:59,SNAPSHOT_MAC_MISMATCH_IN_PATCH:60,SNAPSHOT_MAC_MISMATCH_IN_SNAPSHOT:61,XMPP_BAD_REQUEST_FOR_COLLECTION:62,XMPP_NOT_FOUND_FOR_COLLECTION:63,XMPP_BAD_REQUEST_GLOBAL_ERROR:64,XMPP_NOT_FOUND_GLOBAL_ERROR:65,XMPP_BAD_METHOD_GLOBAL_ERROR:66,XMPP_NOT_ACCEPTABLE_GLOBAL_ERROR:67,SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_SNAPSHOT:68,EXTERNAL_BLOB_REFERENCE_PROTOBUF_DESERIALIZATION_FAILED:69,SNAPSHOT_PROTOBUF_DESERIALIZATION_FAILED:70,REQUESTING_MISSING_KEY_WITH_NO_CLIENTS:71,DB_STORE_NOT_READY_LOW_DISK_SPACE:72,SERVER_DID_NOT_SEND_ALL_PATCHES:73,SERVER_SENT_EARLIER_PATCH:74,MISSING_KEY_FOR_MUTATION_IN_LOCAL_SNAPSHOT:75,MISSING_ACTIVE_KEY_AFTER_ROTATION:76,MISSING_ACTIVE_KEY_FOR_ENCRYPTION:77,MISSING_CURRENT_EPOCH_FOR_ACTIVE_KEY_VALIDATION:78,SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_OUTGOING_PATCH:79,INVALID_SNAPSHOT_RECORDS:80,MISSING_EXTERNAL_BLOB_REFERENCE_HANDLE:81,INVALID_EXTERNAL_BLOB_REFERENCE_UPLOADED:82,INVALID_PATCH_KEY_ID_SIZE:83,INVALID_PATCH_MAC_SIZE:84,INVALID_PATCH_SNAPSHOT_MAC_SIZE:85,INVALID_COLLECTION_SNAPSHOT_HASH_SIZE:86,MISSING_COLLECTION_SNAPSHOT_HASH:87,INVALID_PATCH_KEY_ID_DEVICE_ID:88,INVALID_PATCH_KEY_ID_EPOCH:89,DECRYPTION_FAILED_KEY_ID_MISMATCH:90,DECRYPTION_FAILED_VALUE_MAC_MISMATCH:91,DECRYPTION_FAILED_INDEX_MAC_MISMATCH:92,EXTERNAL_PATCH_MISSING_BLOB:93,COLLECTION_PULL_REQUEST_RECEIVED_PUSH_RESPONSE_WITH_UPDATED_VERSION:94,COLLECTION_PUSH_REQUEST_RECEIVED_RESPONSE_WITH_VERSION_MISMATCH:95,MMS_ERROR_INVALID_FILEHASH:96,UNKNOWN:97,MALFORMED_MUTATION_CLEAR_CHAT:98,MALFORMED_MUTATION_DELETE_CHAT:99,FAILED_MUTATION_CLEAR_CHAT:100,FAILED_MUTATION_DELETE_CHAT:101,CHAT_DB_CORRUPTION:102,LID_BLOCKLIST_PN_WHEN_MIGRATED:103});i.MD_SYNCD_FATAL_ERROR_CODE=e}),66);
__d("WAWebWamEnumMdSyncdFatalErrorSource",[],(function(t,n,r,o,a,i){var e=Object.freeze({SNAPSHOT:1,EXTERNAL_PATCH:2,INLINE_PATCH:3});i.MD_SYNCD_FATAL_ERROR_SOURCE=e}),66);
__d("WAWebMdFatalErrorWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCollection","WAWebWamEnumIsPureSyncdSessionEnum","WAWebWamEnumLidMigrationStageEnum","WAWebWamEnumMdCompanionDeviceAccountType","WAWebWamEnumMdSyncdFatalErrorCode","WAWebWamEnumMdSyncdFatalErrorSource","WAWebWamEnumRecoveryStatusEnum"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MdFatalError:[2304,{appContext:[46,e.TYPES.STRING],appContextBitfield:[47,e.TYPES.INTEGER],appSessionId:[41,e.TYPES.STRING],collection:[2,o("WAWebWamEnumCollection").COLLECTION],companionSessionIds:[42,e.TYPES.STRING],currentPrimaryAppVersion:[14,e.TYPES.STRING],daysSinceLastPeriodicSync:[11,e.TYPES.INTEGER],didBootstrapFromSnapshot:[38,e.TYPES.BOOLEAN],hoursSinceFirstFiniteFailure:[12,e.TYPES.INTEGER],isBootstrap:[3,e.TYPES.BOOLEAN],isFatal:[16,e.TYPES.BOOLEAN],isPatchSenderPrimary:[23,e.TYPES.BOOLEAN],isPreviousPatchAnIncomingPatch:[24,e.TYPES.BOOLEAN],isPreviousPatchSenderPrimary:[25,e.TYPES.BOOLEAN],isPureSyncdSession:[48,o("WAWebWamEnumIsPureSyncdSessionEnum").IS_PURE_SYNCD_SESSION_ENUM],isSenderIndexSameAsPreviousSenderIndex:[39,e.TYPES.BOOLEAN],isThereAnotherSyncdCompanion:[40,e.TYPES.BOOLEAN],isWebLthashConsistent:[17,e.TYPES.BOOLEAN],lidMigrationStage:[49,o("WAWebWamEnumLidMigrationStageEnum").LID_MIGRATION_STAGE_ENUM],macFatalCollectionNameMismatch:[18,e.TYPES.BOOLEAN],macFatalCurrentLthashMismatch:[19,e.TYPES.BOOLEAN],macFatalDidPreviousPatchFailPostSaveValidation:[26,e.TYPES.BOOLEAN],macFatalDidUseMacFetchFallback:[36,e.TYPES.BOOLEAN],macFatalFirstTwoBytesFromAHashOfSnapshotMacKeyMismatch:[20,e.TYPES.BOOLEAN],macFatalHasMissingRemove:[37,e.TYPES.BOOLEAN],macFatalNewLthashMismatch:[21,e.TYPES.BOOLEAN],macFatalNewLthashSubtractMismatch:[27,e.TYPES.BOOLEAN],macFatalNumberAddMismatch:[28,e.TYPES.BOOLEAN],macFatalNumberHasOverrideMutation:[29,e.TYPES.BOOLEAN],macFatalNumberNumAddMutation:[30,e.TYPES.INTEGER],macFatalNumberNumRemoveMutation:[31,e.TYPES.INTEGER],macFatalNumberOverrideMismatch:[32,e.TYPES.BOOLEAN],macFatalNumberRemoveMismatch:[33,e.TYPES.BOOLEAN],macFatalPatchVersionMismatch:[22,e.TYPES.BOOLEAN],macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash:[34,e.TYPES.BOOLEAN],macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:[35,e.TYPES.BOOLEAN],mailboxAgeDays:[13,e.TYPES.INTEGER],mdCompanionDeviceAccountType:[43,o("WAWebWamEnumMdCompanionDeviceAccountType").MD_COMPANION_DEVICE_ACCOUNT_TYPE],mdFatalErrorCode:[1,o("WAWebWamEnumMdSyncdFatalErrorCode").MD_SYNCD_FATAL_ERROR_CODE],mdRegAttemptId:[44,e.TYPES.STRING],patchSnapshotMutationCount:[9,e.TYPES.INTEGER],patchVersion:[5,e.TYPES.INTEGER],recoveryRequestDurationMs:[50,e.TYPES.INTEGER],recoveryStatus:[51,o("WAWebWamEnumRecoveryStatusEnum").RECOVERY_STATUS_ENUM],seqNumber:[45,e.TYPES.INTEGER],sessionStartPrimaryAppVersion:[15,e.TYPES.STRING],sourceType:[10,o("WAWebWamEnumMdSyncdFatalErrorSource").MD_SYNCD_FATAL_ERROR_SOURCE],timeSincePairingMs:[6,e.TYPES.INTEGER],timeSinceRefreshMs:[7,e.TYPES.INTEGER],timeSinceTabTakeoverMs:[8,e.TYPES.INTEGER]},[1,1,1],"regular"]},{MdFatalError:[]});l.MdFatalErrorWamEvent=s}),98);
__d("WAWebMdGroupParticipantMissAckWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumClientGroupSizeBucket","WAWebWamEnumTypeOfGroupEnum"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MdGroupParticipantMissAck:[4146,{groupSizeBucket:[1,o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET],isLid:[2,e.TYPES.BOOLEAN],messageIsRevoke:[3,e.TYPES.BOOLEAN],participantAddCount:[4,e.TYPES.INTEGER],participantRemoveCount:[5,e.TYPES.INTEGER],typeOfGroup:[6,o("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM]},[1,1,1],"regular"]},{MdGroupParticipantMissAck:[]});l.MdGroupParticipantMissAckWamEvent=s}),98);
__d("WAWebMdRetryFromUnknownDeviceWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumDeviceType"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({MdRetryFromUnknownDevice:[2178,{offline:[2,o("WAWebWamCodegenUtils").TYPES.BOOLEAN],senderType:[1,o("WAWebWamEnumDeviceType").DEVICE_TYPE]},[1,1,1],"regular"]},{MdRetryFromUnknownDevice:[]});l.MdRetryFromUnknownDeviceWamEvent=e}),98);
__d("WAWebWamEnumMdFeatureCode",[],(function(t,n,r,o,a,i){var e=Object.freeze({PIN_MUTATION:1,UNPIN_4TH_CHAT_MUTATION:2,DELETE_MUTATION:3,CLEAR_CHAT_REMOVE_STARRED_MUTATION:4,CLEAR_CHAT_KEEP_STARRED_MUTATION:5});i.MD_FEATURE_CODE=e}),66);
__d("WAWebMdSyncdDogfoodingFeatureUsageWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMdFeatureCode"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({MdSyncdDogfoodingFeatureUsage:[3016,{mdSyncdDogfoodingFeature:[1,o("WAWebWamEnumMdFeatureCode").MD_FEATURE_CODE]},[1,1,1],"regular"]},{MdSyncdDogfoodingFeatureUsage:[]});l.MdSyncdDogfoodingFeatureUsageWamEvent=e}),98);
__d("WAWebWamEnumPeerDataRequestType",[],(function(t,n,r,o,a,i){var e=Object.freeze({UPLOAD_STICKER:0,SEND_RECENT_STICKER_BOOTSTRAP:1,GENERAL_LINK_PREVIEW:2,HISTORY_SYNC_ON_DEMAND:3,PLACEHOLDER_MESSAGE_RESEND:4,WAFFLE_LINKING_NONCE_FETCH:5,SYNCD_SNAPSHOT_RECOVERY:6,HISTORY_SYNC_CHUNK_RETRY:7,GALAXY_FLOW_ACTION:8});i.PEER_DATA_REQUEST_TYPE=e}),66);
__d("WAWebWamEnumPeerDataResponseResultType",[],(function(t,n,r,o,a,i){var e=Object.freeze({SUCCESS:1,OTHER_ERROR:2,REQUEST_TARGET_NOT_FOUND:3,REQUEST_INVALID:4,FAIL_TO_UPLOAD:5,FAIL_TO_SEND_RESPONSE:6,REQUEST_TOO_OLD:7});i.PEER_DATA_RESPONSE_RESULT_TYPE=e}),66);
__d("WAWebNonMessagePeerDataMediaUploadWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPeerDataRequestType","WAWebWamEnumPeerDataResponseResultType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({NonMessagePeerDataMediaUpload:[3902,{peerDataErrorCount:[1,e.TYPES.INTEGER],peerDataExistingDataNoUploadCount:[2,e.TYPES.INTEGER],peerDataNotFoundCount:[3,e.TYPES.INTEGER],peerDataRequestCount:[4,e.TYPES.INTEGER],peerDataRequestSessionId:[5,e.TYPES.STRING],peerDataRequestType:[6,o("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE],peerDataResponseResult:[8,o("WAWebWamEnumPeerDataResponseResultType").PEER_DATA_RESPONSE_RESULT_TYPE],peerDataSuccessInlineNoUploadCount:[9,e.TYPES.INTEGER],peerDataSuccessUploadCount:[7,e.TYPES.INTEGER]},[1,1,1],"regular"]},{NonMessagePeerDataMediaUpload:[]});l.NonMessagePeerDataMediaUploadWamEvent=s}),98);
__d("WAWebWamEnumPeerDataRequestErrorCode",[],(function(t,n,r,o,a,i){var e=Object.freeze({NOT_SUPPORTED:0,GENERATION_ERROR:1,CHUNK_CONSUMED:2,TIMEOUT:3,SESSION_EXHAUSTED:4,CHUNK_EXHAUSTED:5,DUPLICATE_REQUEST:6});i.PEER_DATA_REQUEST_ERROR_CODE=e}),66);
__d("WAWebWamEnumPeerDataResponseApplyResultType",[],(function(t,n,r,o,a,i){var e=Object.freeze({SUCCESS:1,OTHER_ERROR:2,INVALID_RESPONSE:3,FAIL_TO_DOWNLOAD:4,REQUEST_TIMEOUT:5});i.PEER_DATA_RESPONSE_APPLY_RESULT_TYPE=e}),66);
__d("WAWebNonMessagePeerDataOperationResponseWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPeerDataRequestErrorCode","WAWebWamEnumPeerDataRequestType","WAWebWamEnumPeerDataResponseApplyResultType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({NonMessagePeerDataOperationResponse:[3904,{peerDataErrorCount:[1,e.TYPES.INTEGER],peerDataNotFoundCount:[2,e.TYPES.INTEGER],peerDataRequestErrorCode:[9,o("WAWebWamEnumPeerDataRequestErrorCode").PEER_DATA_REQUEST_ERROR_CODE],peerDataRequestSessionId:[3,e.TYPES.STRING],peerDataRequestType:[4,o("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE],peerDataResponseApplyResult:[8,o("WAWebWamEnumPeerDataResponseApplyResultType").PEER_DATA_RESPONSE_APPLY_RESULT_TYPE],peerDataResponseCount:[5,e.TYPES.INTEGER],peerDataSuccessProcessCount:[6,e.TYPES.INTEGER],peerDataSuccessResponseCount:[7,e.TYPES.INTEGER]},[1,1,1],"regular"]},{NonMessagePeerDataOperationResponse:[]});l.NonMessagePeerDataOperationResponseWamEvent=s}),98);
__d("WAWebNonMessagePeerDataRequestWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPeerDataRequestErrorCode","WAWebWamEnumPeerDataRequestType"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({NonMessagePeerDataRequest:[3906,{peerDataRequestCount:[1,o("WAWebWamCodegenUtils").TYPES.INTEGER],peerDataRequestErrorCode:[4,o("WAWebWamEnumPeerDataRequestErrorCode").PEER_DATA_REQUEST_ERROR_CODE],peerDataRequestSessionId:[2,o("WAWebWamCodegenUtils").TYPES.STRING],peerDataRequestType:[3,o("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE]},[1,1,1],"regular"]},{NonMessagePeerDataRequest:[]});l.NonMessagePeerDataRequestWamEvent=e}),98);
__d("WAWebWamEnumNotificationActionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({SHOW:1,REMOVE:2});i.NOTIFICATION_ACTION_TYPE=e}),66);
__d("WAWebWamEnumNotificationDestinationType",[],(function(t,n,r,o,a,i){var e=Object.freeze({INDIVIDUAL:1,GROUP:2,OTHER:3,CHANNEL:4,INTEROP:5,STATUS:6});i.NOTIFICATION_DESTINATION_TYPE=e}),66);
__d("WAWebWamEnumNotificationSourceType",[],(function(t,n,r,o,a,i){var e=Object.freeze({PUSH_TRIGGERED:1,MAIN_APP:2,IN_APP:3});i.NOTIFICATION_SOURCE_TYPE=e}),66);
__d("WAWebWamEnumNotificationTypeEnum",[],(function(t,n,r,o,a,i){var e=Object.freeze({TEXT_MESSAGE:1,VOICE_MESSAGE:2,FILE_MESSAGE:3,PHOTO_MESSAGE:4,VIDEO_MESSAGE:5,MISSED_VOICE_CALL:6,MISSED_VIDEO_CALL:7,STICKER_MESSAGE:8,REACTION_MESSAGE:9,GROUP_INVITE_MESSAGE:10,REQUEST_MEDIA_REUPLOAD:11,WEB_CLIENT_LOGIN:12,BACKUP:13,KEEP_IN_CHAT:14,PAYMENT:15,POLL_MESSAGE:16,LOCATION_MESSAGE:17,WEB_PAGE_MESSAGE:18,FAILED_UPLOAD:19,GDPR_REPORT:20,INCOMING_VOICE_CALL:21,INCOMING_VIDEO_CALL:22,VIDEO_CALL_UPGRADE:23,WAFFLE:24,XPLAT_MIGRATION:25,OTHER:26,INVITE_JOINED:27,SCHEDULED_CALL_LOCAL_REMINDER:28,PTV_MESSAGE:29,STATUS_MENTION:30,STATUS_REACTION:31,STICKER_PACK_MESSAGE:32,POLL_RESULT_SNAPSHOT_MESSAGE:33,CALL_LINK_CREATOR:34,STATUS_PROMPT_RESPONSE:35,LINK_CREATOR_CALL_STARTED:36,LINK_CREATOR_CALL_CONNECTED:37,LINK_CREATOR_CALL_MISSED:38,STATUS_POST_RESHARE:39,STATUS_QUESTION_ANSWER_POST_RESHARE:40,EVENT_MESSAGE:41,CONTACT_MESSAGE:42,GIF_MESSAGE:43});i.NOTIFICATION_TYPE_ENUM=e}),66);
__d("WAWebWamEnumPeripheralDeviceType",[],(function(t,n,r,o,a,i){var e=Object.freeze({APPLE_WATCH:1,GRAPEVINE:6,STARFISH:7,HAMMERHEAD:8,GREATHAMMERHEAD:9,GREATWHITE:10,COLADA:11,SWIFTLET:12,MAKO:13,SILVERTIP:14,ZEBRA:15,LAGER:16,PYLADES:17,DIAMOND:18,UNKNOWN:19,WAG:20,CARPLAY:21});i.PERIPHERAL_DEVICE_TYPE=e}),66);
__d("WAWebNotificationDeliveryWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumNotificationActionType","WAWebWamEnumNotificationDestinationType","WAWebWamEnumNotificationSourceType","WAWebWamEnumNotificationTypeEnum","WAWebWamEnumPeripheralDeviceType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({NotificationDelivery:[3748,{clientMessageId:[1,e.TYPES.STRING],isSilenced:[11,e.TYPES.BOOLEAN],notificationAction:[2,o("WAWebWamEnumNotificationActionType").NOTIFICATION_ACTION_TYPE],notificationDeliveryT:[3,e.TYPES.INTEGER],notificationDestination:[4,o("WAWebWamEnumNotificationDestinationType").NOTIFICATION_DESTINATION_TYPE],notificationId:[5,e.TYPES.STRING],notificationSource:[6,o("WAWebWamEnumNotificationSourceType").NOTIFICATION_SOURCE_TYPE],peripheralDeviceOrigin:[9,o("WAWebWamEnumPeripheralDeviceType").PERIPHERAL_DEVICE_TYPE],pushToNotifT:[10,e.TYPES.TIMER],threadId:[7,e.TYPES.STRING],triggeredByOfflineMessage:[12,e.TYPES.BOOLEAN],uiNotificationType:[8,o("WAWebWamEnumNotificationTypeEnum").NOTIFICATION_TYPE_ENUM]},[1,1,1],"regular"]},{NotificationDelivery:[]});l.NotificationDeliveryWamEvent=s}),98);
__d("WAWebWamEnumGroupTypeClient",[],(function(t,n,r,o,a,i){var e=Object.freeze({REGULAR_GROUP:1,SUB_GROUP:2,DEFAULT_SUB_GROUP:3,PARENT_GROUP:4});i.GROUP_TYPE_CLIENT=e}),66);
__d("WAWebNotificationEngagementWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumClientGroupSizeBucket","WAWebWamEnumGroupTypeClient"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({NotificationEngagement:[3796,{avgNotifEngagementT:[1,e.TYPES.TIMER],groupSizeBucket:[2,o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET],groupTypeClient:[3,o("WAWebWamEnumGroupTypeClient").GROUP_TYPE_CLIENT],isAGroup:[4,e.TYPES.BOOLEAN],isWebBackgroundSyncNotif:[18,e.TYPES.BOOLEAN],threadId:[5,e.TYPES.STRING],totalLinkReshareMessageNotifShown:[19,e.TYPES.INTEGER],totalLinkReshareMessageNotifShownFb:[21,e.TYPES.INTEGER],totalLinkReshareMessageNotifShownIg:[22,e.TYPES.INTEGER],totalLinkReshareMessageNotifTapToOpen:[20,e.TYPES.INTEGER],totalLinkReshareMessageNotifTapToOpenFb:[23,e.TYPES.INTEGER],totalLinkReshareMessageNotifTapToOpenIg:[24,e.TYPES.INTEGER],totalMessageReminderNotifShown:[16,e.TYPES.INTEGER],totalMessageReminderNotifTapToOpen:[17,e.TYPES.INTEGER],totalNotifMarkAsRead:[6,e.TYPES.INTEGER],totalNotifMissedCallVoipCallback:[7,e.TYPES.INTEGER],totalNotifMissedCallVoipMessage:[8,e.TYPES.INTEGER],totalNotifOthers:[9,e.TYPES.INTEGER],totalNotifReply:[10,e.TYPES.INTEGER],totalNotifRtcVoipAccept:[11,e.TYPES.INTEGER],totalNotifRtcVoipDecline:[12,e.TYPES.INTEGER],totalNotifShowPreview:[13,e.TYPES.INTEGER],totalNotifShown:[14,e.TYPES.INTEGER],totalNotifTapToOpen:[15,e.TYPES.INTEGER]},[1,1,1],"regular"]},{NotificationEngagement:[]});l.NotificationEngagementWamEvent=s}),98);
__d("WAWebSyncdKeyCountWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({SyncdKeyCount:[3978,{keysUsedInSnapshotCount:[1,e.TYPES.INTEGER],p80MuationsPerKey:[2,e.TYPES.INTEGER],p95MuationsPerKey:[3,e.TYPES.INTEGER],syncdSessionLengthDays:[4,e.TYPES.INTEGER],totalKeyCount:[5,e.TYPES.INTEGER]},[1,1,1],"regular"]},{SyncdKeyCount:[]});l.SyncdKeyCountWamEvent=s}),98);
__d("WAWebWaOldCodeWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({WaOldCode:[3940,{deviceId:[1,o("WAWebWamCodegenUtils").TYPES.STRING]},[1,1,1],"regular"]},{WaOldCode:[]});l.WaOldCodeWamEvent=e}),98);
__d("WAWebWebDbVersionNonAnonymousWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebDbNameType"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({WebDbVersionNonAnonymous:[4816,{webDbName:[1,o("WAWebWamEnumWebDbNameType").WEB_DB_NAME_TYPE],webDbVersionNumber:[2,o("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,20],"regular"]},{WebDbVersionNonAnonymous:[]});l.WebDbVersionNonAnonymousWamEvent=e}),98);
__d("WAWebWebcLinkPreviewResponseHandleWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WebcLinkPreviewResponseHandle:[3860,{didRespondHqPreview:[5,e.TYPES.BOOLEAN],isPreviewSuccess:[2,e.TYPES.BOOLEAN],previewDurationMs:[4,e.TYPES.INTEGER],previewSessionId:[3,e.TYPES.STRING]},[1,1,1],"regular"]},{WebcLinkPreviewResponseHandle:[]});l.WebcLinkPreviewResponseHandleWamEvent=s}),98);
__d("WAWebWebcPageResumeWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({WebcPageResume:[884,{webcResumeCount:[1,o("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,1],"regular"]},{WebcPageResume:[]});l.WebcPageResumeWamEvent=e}),98);
__d("WAWebWamEnumWebcStreamModeCode",[],(function(t,n,r,o,a,i){var e=Object.freeze({QR:0,MAIN:1,SYNCING:2,OFFLINE:3,CONFLICT:4,PROXYBLOCK:5,TOS_BLOCK:6,SMB_TOS_BLOCK:7,DEPRECATED_VERSION:8,LOCK:9});i.WEBC_STREAM_MODE_CODE=e}),66);
__d("WAWebWebcStreamModeChangeWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebcStreamModeCode"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({WebcStreamModeChange:[770,{webcStreamMode:[1,o("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE]},[1,1,1],"regular"]},{WebcStreamModeChange:[]});l.WebcStreamModeChangeWamEvent=e}),98);
__d("WAWebWamProcessWorkerData",["WALogger","WAShiftTimer","WAWebAdvMetadataCreationFailureWamEvent","WAWebAdvStoredTimestampExpiredWamEvent","WAWebChatMessageCountsWamEvent","WAWebClockSkewDifferenceTWamEvent","WAWebCommunityHomeActionWamEvent","WAWebCommunityTabActionWamEvent","WAWebDailyWamEvent","WAWebE2eMessageRecvWamEvent","WAWebE2eMessageSendWamEvent","WAWebE2eRetryRejectWamEvent","WAWebForwardSendWamEvent","WAWebGatedMessageReceivedWamEvent","WAWebGraphqlCatalogRequestWamEvent","WAWebGroupJoinCWamEvent","WAWebIncomingMessageDropWamEvent","WAWebKeepInChatNotifWamEvent","WAWebMdAppStateDirtyBitsWamEvent","WAWebMdAppStateKeyRotationWamEvent","WAWebMdAppStateMessageRangeWamEvent","WAWebMdAppStateSyncDailyWamEvent","WAWebMdAppStateSyncMutationStatsWamEvent","WAWebMdBadDeviceSentMessageWamEvent","WAWebMdBootstrapAppStateCriticalDataProcessingWamEvent","WAWebMdBootstrapAppStateDataDownloadedWamEvent","WAWebMdBootstrapDataAppliedWamEvent","WAWebMdBootstrapHistoryDataDownloadedWamEvent","WAWebMdBootstrapHistoryDataStartDownloadingWamEvent","WAWebMdBootstrapHistorySyncStatusAfterPairingWamEvent","WAWebMdCriticalEventWamEvent","WAWebMdDeviceSyncAckWamEvent","WAWebMdFatalErrorWamEvent","WAWebMdGroupParticipantMissAckWamEvent","WAWebMdRetryFromUnknownDeviceWamEvent","WAWebMdSyncdDogfoodingFeatureUsageWamEvent","WAWebMessageReceiveWamEvent","WAWebMessageSecretErrorsWamEvent","WAWebMessageSendWamEvent","WAWebMexEventV2WamEvent","WAWebMexEventWamEvent","WAWebNonMessagePeerDataMediaUploadWamEvent","WAWebNonMessagePeerDataOperationResponseWamEvent","WAWebNonMessagePeerDataRequestWamEvent","WAWebNotificationDeliveryWamEvent","WAWebNotificationEngagementWamEvent","WAWebOfflineCountTooHighWamEvent","WAWebOfflineResumeWamEvent","WAWebPlaceholderActivityWamEvent","WAWebPsBufferUploadWamEvent","WAWebPsFmxActionWamEvent","WAWebReceiptStanzaReceiveWamEvent","WAWebSignCredentialWamEvent","WAWebSyncdKeyCountWamEvent","WAWebWaOldCodeWamEvent","WAWebWamStorage","WAWebWebDbLoadFromVersionFailureNonAnonymousWamEvent","WAWebWebDbTableUsageWamEvent","WAWebWebDbVersionNonAnonymousWamEvent","WAWebWebcDbOpenWamEvent","WAWebWebcJobInfoWamEvent","WAWebWebcLinkPreviewResponseHandleWamEvent","WAWebWebcOfflineNotificationProcessWamEvent","WAWebWebcPageResumeWamEvent","WAWebWebcRawPlatformsWamEvent","WAWebWebcStreamModeChangeWamEvent"],(function(t,n,r,o,a,i,l){var e,s,u=2e4,c=1e4;function d(t){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["processWorkerWamData ",""])),t?"start":"run"),m();var n=new(o("WAShiftTimer")).ShiftTimer(function(){r("WAWebWamStorage").processWorkerWamData().then(function(e){e&&d(!1)}).catch(function(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Failed to process worker wam data: ",""])),e).verbose().devConsole(e)})});n.onOrAfter(t?u:c)}function m(){n("WAWebOfflineResumeWamEvent").OfflineResumeWamEvent,n("WAWebMessageSecretErrorsWamEvent").MessageSecretErrorsWamEvent,n("WAWebMessageSendWamEvent").MessageSendWamEvent,n("WAWebForwardSendWamEvent").ForwardSendWamEvent,n("WAWebMexEventV2WamEvent").MexEventV2WamEvent,n("WAWebWaOldCodeWamEvent").WaOldCodeWamEvent,n("WAWebChatMessageCountsWamEvent").ChatMessageCountsWamEvent,n("WAWebNotificationDeliveryWamEvent").NotificationDeliveryWamEvent,n("WAWebGroupJoinCWamEvent").GroupJoinCWamEvent,n("WAWebMdAppStateDirtyBitsWamEvent").MdAppStateDirtyBitsWamEvent,n("WAWebMdBadDeviceSentMessageWamEvent").MdBadDeviceSentMessageWamEvent,n("WAWebPlaceholderActivityWamEvent").PlaceholderActivityWamEvent,n("WAWebGatedMessageReceivedWamEvent").GatedMessageReceivedWamEvent,n("WAWebMessageReceiveWamEvent").MessageReceiveWamEvent,n("WAWebOfflineCountTooHighWamEvent").OfflineCountTooHighWamEvent,n("WAWebReceiptStanzaReceiveWamEvent").ReceiptStanzaReceiveWamEvent,n("WAWebMdRetryFromUnknownDeviceWamEvent").MdRetryFromUnknownDeviceWamEvent,n("WAWebE2eRetryRejectWamEvent").E2eRetryRejectWamEvent,n("WAWebMdBootstrapHistoryDataDownloadedWamEvent").MdBootstrapHistoryDataDownloadedWamEvent,n("WAWebMdBootstrapHistoryDataStartDownloadingWamEvent").MdBootstrapHistoryDataStartDownloadingWamEvent,n("WAWebClockSkewDifferenceTWamEvent").ClockSkewDifferenceTWamEvent,n("WAWebGraphqlCatalogRequestWamEvent").GraphqlCatalogRequestWamEvent,n("WAWebSignCredentialWamEvent").SignCredentialWamEvent,n("WAWebMdBootstrapHistorySyncStatusAfterPairingWamEvent").MdBootstrapHistorySyncStatusAfterPairingWamEvent,n("WAWebWebcJobInfoWamEvent").WebcJobInfoWamEvent,n("WAWebPsFmxActionWamEvent").PsFmxActionWamEvent,n("WAWebE2eMessageSendWamEvent").E2eMessageSendWamEvent,n("WAWebMdDeviceSyncAckWamEvent").MdDeviceSyncAckWamEvent,n("WAWebMdGroupParticipantMissAckWamEvent").MdGroupParticipantMissAckWamEvent,n("WAWebMexEventWamEvent").MexEventWamEvent,n("WAWebAdvStoredTimestampExpiredWamEvent").AdvStoredTimestampExpiredWamEvent,n("WAWebSyncdKeyCountWamEvent").SyncdKeyCountWamEvent,n("WAWebMdAppStateSyncMutationStatsWamEvent").MdAppStateSyncMutationStatsWamEvent,n("WAWebNonMessagePeerDataMediaUploadWamEvent").NonMessagePeerDataMediaUploadWamEvent,n("WAWebNonMessagePeerDataOperationResponseWamEvent").NonMessagePeerDataOperationResponseWamEvent,n("WAWebNonMessagePeerDataRequestWamEvent").NonMessagePeerDataRequestWamEvent,n("WAWebWebcLinkPreviewResponseHandleWamEvent").WebcLinkPreviewResponseHandleWamEvent,n("WAWebE2eMessageRecvWamEvent").E2eMessageRecvWamEvent,n("WAWebIncomingMessageDropWamEvent").IncomingMessageDropWamEvent,n("WAWebAdvMetadataCreationFailureWamEvent").AdvMetadataCreationFailureWamEvent,n("WAWebWebcRawPlatformsWamEvent").WebcRawPlatformsWamEvent,n("WAWebWebcPageResumeWamEvent").WebcPageResumeWamEvent,n("WAWebWebcStreamModeChangeWamEvent").WebcStreamModeChangeWamEvent,n("WAWebPsBufferUploadWamEvent").PsBufferUploadWamEvent,n("WAWebWebDbTableUsageWamEvent").WebDbTableUsageWamEvent,n("WAWebWebDbVersionNonAnonymousWamEvent").WebDbVersionNonAnonymousWamEvent,n("WAWebWebDbLoadFromVersionFailureNonAnonymousWamEvent").WebDbLoadFromVersionFailureNonAnonymousWamEvent,n("WAWebWebcDbOpenWamEvent").WebcDbOpenWamEvent,n("WAWebMdBootstrapAppStateCriticalDataProcessingWamEvent").MdBootstrapAppStateCriticalDataProcessingWamEvent,n("WAWebMdCriticalEventWamEvent").MdCriticalEventWamEvent,n("WAWebMdSyncdDogfoodingFeatureUsageWamEvent").MdSyncdDogfoodingFeatureUsageWamEvent,n("WAWebMdAppStateMessageRangeWamEvent").MdAppStateMessageRangeWamEvent,n("WAWebMdBootstrapDataAppliedWamEvent").MdBootstrapDataAppliedWamEvent,n("WAWebMdBootstrapAppStateDataDownloadedWamEvent").MdBootstrapAppStateDataDownloadedWamEvent,n("WAWebMdFatalErrorWamEvent").MdFatalErrorWamEvent,n("WAWebMdAppStateKeyRotationWamEvent").MdAppStateKeyRotationWamEvent,n("WAWebMdAppStateSyncDailyWamEvent").MdAppStateSyncDailyWamEvent,n("WAWebCommunityHomeActionWamEvent").CommunityHomeActionWamEvent,n("WAWebCommunityTabActionWamEvent").CommunityTabActionWamEvent,n("WAWebDailyWamEvent").DailyWamEvent,n("WAWebKeepInChatNotifWamEvent").KeepInChatNotifWamEvent,n("WAWebNotificationEngagementWamEvent").NotificationEngagementWamEvent,n("WAWebWebcOfflineNotificationProcessWamEvent").WebcOfflineNotificationProcessWamEvent}l.processWorkerWamData=d}),98);
__d("WAWebStartBackend",["Promise","WAAsyncSleep","WABase64","WAComms","WAGzip","WALogger","WAPromiseTimeout","WAWebABPropsWamGlobals","WAWebAdvDeviceInfoCheckJob","WAWebApiContact","WAWebBackendApi","WAWebBackgroundSyncAction","WAWebBackgroundSyncReporter","WAWebBizAgentAction","WAWebBizChatAssignmentAction","WAWebBizGatingUtils","WAWebBizUpdateContactsWithVerifiedNamesAction","WAWebBootstrapPremiumMessages","WAWebBuildConstants","WAWebCartDbLidMigration","WAWebChatThreadLogging","WAWebCmd","WAWebCommonCTWADataSharing","WAWebCommsConfig","WAWebCommsHandleStanza","WAWebCrashlog","WAWebCryptoEncKeyHelper","WAWebDBCreateLidPnMappings","WAWebDBFavoriteDatabaseMigrationToLid","WAWebDBLabelAssociationDatabaseMigrationToLid","WAWebDBPnhThreadMigrationToGeneralLid","WAWebDbEncryptionKey","WAWebDeleteStatusAction","WAWebEventsWaitForMain","WAWebEventsWaitForOfflineDeliveryEnd","WAWebFeatureDetectionSwSupport","WAWebFtsClient","WAWebGetReachoutTimelockJob","WAWebHistorySyncNotificationUtils","WAWebHistorySyncProgress","WAWebInboxFiltersGatingUtils","WAWebInitFavoritesFromStorage","WAWebInitFromStorage","WAWebInitWaitForEvents","WAWebInitializeBots","WAWebJestE2ELogUtils","WAWebL10NCountryCodes","WAWebL10NHelpers","WAWebLid1X1ThreadAccountMigrations","WAWebLid1x1MigrationManager","WAWebLid1x1MigrationTimeout","WAWebLogoutReason","WAWebLogoutReasonConstants","WAWebMediaHosts","WAWebMessageQueue","WAWebModelStorage","WAWebNewsletterGatingUtils","WAWebNewsletterMetadataInitFromStorage","WAWebOffdStorage","WAWebOfflineHandler","WAWebOfflineResumeMainThread","WAWebOfflineResumeUtils","WAWebPageLoadLogging","WAWebPassiveModeManager","WAWebPersistedJobManager","WAWebPremiumAccessEngine","WAWebPrimaryFeatures","WAWebPushNotificationsGatingUtils","WAWebQplInitMd","WAWebRegisterPassiveTasks","WAWebSWBus","WAWebSWBusActions","WAWebSignalStoreApi","WAWebSocketModel","WAWebStatusCollection","WAWebStickerDownloadGatingUtils","WAWebStoreSpecialAbProps","WAWebSubscribePushManagerAction","WAWebSubscriptions","WAWebSyncBootstrap","WAWebSyncContactsJob","WAWebSyncdCoreApi","WAWebTasksDefinitions","WAWebTimeSpentLoggingSession","WAWebTos","WAWebUserPrefsGeneral","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsKeys","WAWebUserPrefsLocales","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebWamGlobals","WAWebWamOfflineResumeReporter","WAWebWamProcessWorkerData","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","cr:10195","cr:10196","cr:17219"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S=(e=n("cr:17219"))==null?void 0:e.getWindowsBridge();o("WAWebCmd").Cmd.once("offline_delivery_end",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[StartBackend]: start initial setup"]))),yield N(),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[StartBackend]: complete initial setup"])))}catch(e){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[StartBackend] initial setup failed:"]))).devConsole(e)}})),o("WAWebCmd").Cmd.on("storage_initialization_error",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){!o("WAWebUserPrefsMultiDevice").isRegistered()&&o("WAWebLogoutReason").getPrevLogoutReasonCode()===o("WAWebLogoutReasonConstants").LOGOUT_REASON_CODE.CLIENT_FATAL||(o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["storage initialization error, logging out"]))),yield o("WAWebSocketModel").Socket.clearCredentialsAndStoredData(o("WAWebLogoutReasonConstants").LogoutReason.WebFailStorageInitialization),o("WAWebJestE2ELogUtils").maybeLogToJestE2eJSConsole("logging out due to storage initialization error"),o("WAWebCmd").Cmd.logout())})),o("WAWebCmd").Cmd.on("open_socket_stream",function(){o("WAWebCmd").Cmd.isOfflineDeliveryEnd&&o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.resetEvent(),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logSocketConnectT()});var R=function(){r("WAWebCommonCTWADataSharing").fetchDataSharingSettingAndUpdateModel()};function L(){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WAWebPageLoadLogging").startPageLoadQplMeasure("startBackend");var e=yield k();return o("WAWebPageLoadLogging").endPageLoadQplMeasure("startBackend"),e}),E.apply(this,arguments)}function k(){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebSignalStoreApi").waSignalStore.getRegistrationInfo();if(!e){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["startBackendRegistered: chatd user not registered"])));return}o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[startBackend]: connected as ",""])),o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow());try{yield o("WAWebApiContact").warmUpAllLidPnMappings(),yield o("WAPromiseTimeout").promiseTimeout(o("WAWebModelStorage").initialize(),20*1e3),yield o("WAPromiseTimeout").promiseTimeout(o("WAWebOffdStorage").initialize(),20*1e3),o("WAWebCrashlog").registerCrashlogUploadIsUserInExternalBetaFunction(o("WAWebUserPrefsGeneral").getWhatsAppWebExternalBetaJoinedIdb)}catch(e){o("WAWebCmd").Cmd.storageInitializationError()}if(o("WAWebLid1X1ThreadAccountMigrations").checkIfMigrationEnabled(),o("WAWebInitWaitForEvents").initOfflineResumeWaitForEvents(),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.setLastPushCompleteTimestamp(),w(),yield o("WAWebPrimaryFeatures").loadPrimaryFeatures(),o("WAWebMediaHosts").mediaHosts.maybeLoadMediaConnFromStorage(),yield F(),x(),o("WAWebABPropsWamGlobals").setAbPropDependingGlobalWamAttributes(),o("WAWebL10NHelpers").isLocalLanguageOverrideEnabled()&&(yield o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(o("WAWebUserPrefsKeys").KEYS.LANG_FROM_USER,o("WAWebUserPrefsLocales").getUserLangPref()||"en")),yield o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(o("WAWebUserPrefsKeys").KEYS.LANG_FROM_PHONE,o("WAWebUserPrefsLocales").getPhoneLangPref()||"en"),o("WAWebTimeSpentLoggingSession").restoreTimeSpentSession(),yield o("WAWebChatThreadLogging").initChatThreadLogging(),yield o("WAWebPersistedJobManager").startWebPersistedJobManager(),o("WAWebOfflineResumeMainThread").setupMainThreadResume(o("WAWebOfflineHandler").OfflineMessageHandler),o("WAWebBuildConstants").WINDOWS_OFFLINE){var t,n=yield S==null||(t=S.serverEncKeySaltBridge)==null?void 0:t.getServerEncKeySalt();if(n==null)o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[_startBackend] encodedServerEncKeySalt is not available"])));else{var a=new TextDecoder,i=o("WABase64").decodeB64(n),l=a.decode(i);yield o("WAWebDbEncryptionKey").DbEncKeyStore.generateFinalDbEncryptionAndFtsKey(l),yield o("WAWebCryptoEncKeyHelper").generateFinalDbEncryptionAndFtsKeyForInvoker(l)}o("WAWebCmd").Cmd.offlineDeliveryEnd(),yield o("WAWebDbEncryptionKey").DbEncKeyStore.waitForFinalDbMsgEncKey(),o("WAWebOfflineResumeUtils").loadMainScreen({})}else yield o("WAComms").startHandlingRequests(),yield o("WAWebDbEncryptionKey").DbEncKeyStore.waitForFinalDbMsgEncKey();o("WAWebLid1x1MigrationManager").ThreadMigrationManager.addDependentMigrationTask(o("WAWebDBFavoriteDatabaseMigrationToLid").migrateFavoritesDatabaseToLid),o("WAWebLid1x1MigrationManager").ThreadMigrationManager.addDependentMigrationTask(o("WAWebDBLabelAssociationDatabaseMigrationToLid").migrateLabelAssociationsDatabaseToLid),o("WAWebLid1x1MigrationManager").ThreadMigrationManager.addDependentMigrationTask(o("WAWebCartDbLidMigration").migrateCartDbLid),o("WAWebLid1x1MigrationManager").ThreadMigrationManager.addDependentMigrationTask(o("WAWebDBPnhThreadMigrationToGeneralLid").migratePhoneNumberHidingThreadsToGeneralLid),yield o("WAWebLid1x1MigrationManager").ThreadMigrationManager.executeMigrationIfNeeded(),yield o("WAWebPassiveModeManager").PassiveTaskManager.waitForPassiveTaskEnd(),yield o("WAWebSyncdCoreApi").initialize();var s=!(yield r("WAWebSyncBootstrap").isCriticalDataSynced());s?yield r("WAWebSyncBootstrap").syncCriticalData():o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap] need to sync critical data: false"]))),o("WAWebBackendApi").frontendFireAndForget("handleDeferredMessages",{}),yield $(),o("WAWebTos").TosManager.run(),o("WAWebQplInitMd").startQPL(),yield o("WAWebPremiumAccessEngine").initialize(o("WAWebBizGatingUtils").getBillingPremiumAccessConfig()),o("WAWebSubscriptions").runSubscriptionsManager(),o("WAWebSubscribePushManagerAction").updatePushManager(),o("WAWebBackgroundSyncAction").updatePeriodicBackgroundSyncRegistration(),R(),o("WAWebInitializeBots").initializeBots(),o("WAWebStoreSpecialAbProps").storeSpecialAbProps(),o("WAComms").startHandlingRequests()}),I.apply(this,arguments)}function T(e){return D.apply(this,arguments)}function D(){return D=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){e===void 0&&(e={passive:!1,pull:!0}),o("WAWebPageLoadLogging").startPageLoadQplMeasure("startWebComms");var t=o("WAWebCommsConfig").getCommsConfig(e);yield r("WAWebEventsWaitForMain")();var a=!o("WAWebBuildConstants").WINDOWS_OFFLINE;o("WAComms").startComms(r("WAWebCommsHandleStanza"),t,function(e){return(v||(v=n("Promise"))).resolve(o("WAGzip").inflate(e))},a),a&&(yield o("WAComms").waitForConnection()),o("WAWebPageLoadLogging").endPageLoadQplMeasure("startWebComms")}),D.apply(this,arguments)}function x(){var e,t=(e=o("WAWebUserPrefsMeUser").getMaybeMePnUser())==null?void 0:e.user;t!=null&&o("WAWebWamGlobals").Global.set({psCountryCode:o("WAWebL10NCountryCodes").getCountryShortcodeByPhone(t)})}function $(){return P.apply(this,arguments)}function P(){return P=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e;o("WAWebBizUpdateContactsWithVerifiedNamesAction").applyContactBusinessProps(),(e=o("WAWebInitFromStorage")).restoreLabels(),e.restoreQuickReplies(),e.restoreLabelAssociations(),e.restoreCarts(),o("WAWebBootstrapPremiumMessages").restorePremiumMessages(),o("WAWebBootstrapPremiumMessages").bindPremiumMessageListeners(),e.restoreDataSharing3pdLid(),yield e.restoreArchiveV2Settings(),yield e.restoreAgents().then(o("WAWebBizAgentAction").initializeAgentLog),o("WAWebBizChatAssignmentAction").checkOrphanAssignments(),e.restoreChatAssignments()}),P.apply(this,arguments)}function N(){return M.apply(this,arguments)}function M(){return M=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WAWebDBCreateLidPnMappings").flushLidPnMappingsToDb(),o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] start backend"]))),r("WAWebSyncBootstrap").continueProgressiveHistorySyncProcessingV2(o("WAWebHistorySyncNotificationUtils").HistorySyncScheduleSource.BackendStart),o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["init worker: startIndexer from initialSetup"]))),o("WAWebFtsClient").ftsClient.startIndexer().catch(function(e){o("WALogger").WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["init worker: error while calling startIndexer from initialSetup: ",""])),e)}),o("WAWebStatusCollection").StatusCollection.sync().then(function(){o("WAWebDeleteStatusAction").clearStatusForRemovedContact()}),o("WAWebTasksDefinitions").registerTasks(),o("WAWebPushNotificationsGatingUtils").canSupportOfflineNotifications()&&(o("WAWebBackgroundSyncReporter").setPushNotificationInteractionStatus(),o("WAWebWamProcessWorkerData").processWorkerWamData(!0)),o("WAWebMessageQueue").waitForOnlineMessageQueue().then(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield o("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd(),yield o("WAWebMessageQueue").waitForOnlineMessageQueue(),yield o("WAAsyncSleep").asyncSleep(1e4),o("WAWebLid1x1MigrationTimeout").scheduleLogoutIfNeeded("offline")})),yield o("WAWebSyncContactsJob").runSyncDirtyContactsJob(),o("WAWebInitFromStorage").restoreRecentStickers(),o("WAWebInitFromStorage").restoreFavoriteStickers(),o("WAWebAdvDeviceInfoCheckJob").scheduleAdvDeviceInfoCheck(),o("WAWebInitFromStorage").restoreCommunityActivity(),o("WAWebHistorySyncProgress").updateHistorySyncProgressModel(),o("WAWebInitFromStorage").restoreMediaUploadResult(),o("WAWebInitFromStorage").restoreUnjoinedSubgroups(),o("WAWebNewsletterGatingUtils").isNewsletterEnabled()&&o("WAWebNewsletterMetadataInitFromStorage").restoreNewsletterMetadata(),o("WAWebInboxFiltersGatingUtils").inboxFavoritesEnabled()&&o("WAWebInitFavoritesFromStorage").restoreFavorites(),o("WAWebStickerDownloadGatingUtils").isStickerDownloadM1Enabled()&&o("WAWebInitFromStorage").restoreStickerDownload(),o("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("restoreCTWASuggestions"),o("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("restoreNewMessageCappingData"),o("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("loadQuickPromotions",{trigger:"app-launch"}),o("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("fetchAdEntryPointsConfiguration",{trigger:"app-launch"}),o("WAWebGetReachoutTimelockJob").fetchReachoutTimelock()}),M.apply(this,arguments)}function w(){return A.apply(this,arguments)}function A(){return A=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebPushNotificationsGatingUtils").canSupportOfflineNotifications()&&r("WAWebFeatureDetectionSwSupport").supported){var e,t;(e=window.navigator.serviceWorker)!=null&&e.controller&&(yield r("WAWebSWBus").request(window.navigator.serviceWorker.controller,r("WAWebSWBusActions").STOP_COMMS).catch(function(e){o("WALogger").WARN(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] Failed to request stopComms for service worker, error: ",""])),e)})),(t=window.navigator.serviceWorker)==null||(t=t.ready)==null||t.then((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=(t=yield e==null||e.getNotifications==null?void 0:e.getNotifications())!=null?t:[];n.forEach(function(e){return e.close()})});return function(t){return e.apply(this,arguments)}})()).catch(function(e){o("WALogger").WARN(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] Failed to close existing notifications, error: ",""])),e)})}}),A.apply(this,arguments)}function F(){return O.apply(this,arguments)}function O(){return O=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e={pull:!0};yield o("WAWebRegisterPassiveTasks").registerPassiveTaskForStartUp(),yield T(e)}),O.apply(this,arguments)}l.startBackend=L,l.startWebComms=T}),98);
__d("WAWebMexGetUsernameJobQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{alias:null,args:null,concreteType:"XWA2UsernameGetResponse",kind:"LinkedField",name:"xwa2_username_get",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"WAWebMexGetUsernameJobQuery",selections:e,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"WAWebMexGetUsernameJobQuery",selections:e},params:{id:"9587446314672913",metadata:{},name:"WAWebMexGetUsernameJobQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebMexGetUsernameJob",["WALogger","WAWebMexClient","WAWebMexGetUsernameJobQuery.graphql","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t,r=e!==void 0?e:e=n("WAWebMexGetUsernameJobQuery.graphql"),a=yield o("WAWebMexClient").fetchQuery(r,{});return o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MEX][USERNAME] Successfully fetched latest username via mex"]))).tags("GQL","MEX").devConsole({response:a}),(t=a.xwa2_username_get)==null?void 0:t.username}),c.apply(this,arguments)}l.mexGetUsernameQueryJob=u}),98);
__d("WAWebMexSetUsernameKeyJobMutation.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"pin"}],t=[{alias:null,args:[{kind:"Variable",name:"pin",variableName:"pin"}],concreteType:"XWA2UsernamePinSetMutationResponse",kind:"LinkedField",name:"xwa2_username_pin_set",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebMexSetUsernameKeyJobMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebMexSetUsernameKeyJobMutation",selections:t},params:{id:"9749436995157074",metadata:{},name:"WAWebMexSetUsernameKeyJobMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("WAWebMexSetUsernameKeyJob",["WALogger","WAWebMexClient","WAWebMexSetUsernameKeyJobMutation.graphql","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r,a={pin:t},i=e!==void 0?e:e=n("WAWebMexSetUsernameKeyJobMutation.graphql"),l=yield o("WAWebMexClient").fetchQuery(i,t!=null?a:{});return o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MEX][USERNAME] Successfully fetched set username KEY mutation via mex"]))).tags("GQL","MEX").devConsole({response:l}),((r=l.xwa2_username_pin_set)==null?void 0:r.result)==="SUCCESS"}),c.apply(this,arguments)}l.mexSetUsernameKeyQueryJob=u}),98);
__d("WAWebSetUsernameKeyQueryJob",["WAJobOrchestratorTypes","WAWebBackendApi","WAWebLidAwareContactsDB","WAWebMexSetUsernameKeyJob","WAWebModelStorageUtils","WAWebOrchestratorNonPersistedJob","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("setUsernameKeyQueryJob",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield o("WAWebMexSetUsernameKeyJob").mexSetUsernameKeyQueryJob(e);return t?(e!=null?yield s(e):yield c(),!0):!1}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),a=t.toJid(),i={id:a,usernameKey:e!=null?e:void 0};yield o("WAWebModelStorageUtils").getStorage().lock(["contact"],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return r("WAWebLidAwareContactsDB").createOrMerge(a,babelHelpers.extends({},i))})),yield o("WAWebBackendApi").frontendSendAndReceive("updateUsernameKey",{id:a,usernameKey:e})}),u.apply(this,arguments)}function c(){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield s(null)}),d.apply(this,arguments)}l.setUsernameKeyQueryJob=e,l.setUsernameKeyJob=s,l.deleteUsernameKeyJob=c}),98);
__d("WAWebGetUsernameQueryJob",["WAJobOrchestratorTypes","WALogger","WAWebMexGetUsernameJob","WAWebMexUsync","WAWebOrchestratorNonPersistedJob","WAWebSetUsernameJob","WAWebSetUsernameKeyQueryJob","WAWebUserPrefsMeUser","WAWebUsernameGatingUtils","WAWebUsernameTypes","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getUsernameQueryJob",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t,n;if(o("WAWebUsernameGatingUtils").mexUsyncUsernameQueryEnabled()){var r=yield u();t=r==null?void 0:r.username;var a=r==null?void 0:r.pin;a!=null&&(o("WAWebUsernameTypes").isUsernameKey(a)?n=a:o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getUsernameJob: invalid username key received from MEX"]))).sendLogs("getUsernameJob-invalid-username-key"))}else t=yield o("WAWebMexGetUsernameJob").mexGetUsernameQueryJob();var i=o("WAWebUserPrefsMeUser").getMePnUserOrThrow();return yield o("WAWebSetUsernameJob").setUsernamesJob([t!=null?{userId:i,username:t}:{userId:i,deleteUsername:!0}]),n!=null?yield o("WAWebSetUsernameKeyQueryJob").setUsernameKeyJob(n):yield o("WAWebSetUsernameKeyQueryJob").deleteUsernameKeyJob(),t}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebMexUsync").mexUsyncQuery({users:[{jid:o("WAWebUserPrefsMeUser").getMePnUserOrThrow().toString()}],telemetry:{context:"INTERACTIVE"},fetch:{username:!0}}),t=e.response;if(t!=null)return t[0].username_info}),c.apply(this,arguments)}l.getUsernameJob=s}),98);
__d("WAWebMetricsAttributionActions",["WAWebAppTracker","WAWebProtobufsHistorySync.pb"],(function(t,n,r,o,a,i,l){"use strict";function e(e){switch(o("WAWebAppTracker").AppTracker.start(o("WAWebAppTracker").AppTrackerType.HistorySync),e){case o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP:o("WAWebAppTracker").AppTracker.start(o("WAWebAppTracker").AppTrackerType.CriticalSync);break;case o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT:o("WAWebAppTracker").AppTracker.start(o("WAWebAppTracker").AppTrackerType.RecentSync);break;case o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.FULL:o("WAWebAppTracker").AppTracker.start(o("WAWebAppTracker").AppTrackerType.FullSync);break;case o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND:o("WAWebAppTracker").AppTracker.start(o("WAWebAppTracker").AppTrackerType.OnDemandSync);break;default:break}}function s(e){switch(e){case o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP:o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.CriticalSync);break;case o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT:o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.RecentSync);break;case o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.FULL:o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.FullSync);break;case o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND:o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.OnDemandSync);break;default:break}}function u(){var e,t=[(e=o("WAWebAppTracker")).AppTrackerType.HistorySync,e.AppTrackerType.CriticalSync,e.AppTrackerType.RecentSync,e.AppTrackerType.FullSync,e.AppTrackerType.OnDemandSync];t.forEach(function(e){o("WAWebAppTracker").AppTracker.stop(e)})}l.startHistorySyncAttributionTracking=e,l.stopHistorySyncAttributionTracking=s,l.stopAllHistorySyncAttributionTracking=u}),98);
__d("WAWebApiBlocklist",["WAWebModelStorageUtils","WAWebSchemaBlocklist","WAWebWidFactory"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebSchemaBlocklist").getBlocklistTable().all().then(function(e){var t=e.map(function(e){return o("WAWebWidFactory").createUserWidOrThrow(e.id)});return t})}function s(e){var t=e.map(function(e){return{id:e.toString()}});return o("WAWebModelStorageUtils").getStorage().lock(["blocklist"],function(e){var n=e[0];return n.clear().then(function(){return n.bulkCreate(t).then(function(){return!0})})})}l.getBlocklist=e,l.updateBlocklist=s}),98);
__d("WAWebBlocklistMigration",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){"use strict";function e(){return r("WAWebUserPrefsStore").get(o("WAWebUserPrefsKeys").UserPrefs.BlocklistMigrated)===!0}function s(){r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").UserPrefs.BlocklistMigrated,!0)}function u(){r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").UserPrefs.BlocklistMigrated,!1)}l.isBlocklistMigrated=e,l.setBlocklistMigrated=s,l.setBlocklistUnmigrated=u}),98);
__d("WAWebWamEnumCrashlogType",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNKNOWN:0,ZERO_EVENT_EXPECTED:1,TRACKING:2});i.CRASHLOG_TYPE=e}),66);
__d("WAWebCriticalEventWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCrashApplicationState","WAWebWamEnumCrashlogType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({CriticalEvent:[1684,{context:[2,e.TYPES.STRING],crashApplicationState:[8,o("WAWebWamEnumCrashApplicationState").CRASH_APPLICATION_STATE],crashlogType:[6,o("WAWebWamEnumCrashlogType").CRASHLOG_TYPE],debug:[3,e.TYPES.STRING],extraDebug:[7,e.TYPES.STRING],mobileBuildId:[5,e.TYPES.STRING],name:[1,e.TYPES.STRING]},[1,1,1],"regular"]},{CriticalEvent:[]});l.CriticalEventWamEvent=s}),98);
__d("WAWebGetBlocklistJob",["WALogger","WASmaxBlocklistsGetBlockListRPC","WAWebJidToWid","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(t,n){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["fetchBlocklist failed: code "," text ",""])),t,n).sendLogs("getBlocklist")}function c(){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebUserPrefsMultiDevice").getBlocklistHash(),t=babelHelpers.extends({},e!=null&&{itemArgs:{itemDhash:e}}),n=yield o("WASmaxBlocklistsGetBlockListRPC").sendGetBlockListRPC(t);switch(n.name){case"GetBlockListResponseInternalServerError":{var r=n.value.errorServerErrors.value,a=r.code,i=r.text;return u(Number(a),i),{errorCode:Number(a),errorText:i}}case"GetBlockListResponseInvalidRequest":{var l=n.value.errorGetBlocklistErrors.value,c=l.code,d=l.text;return u(Number(c),d),{errorCode:Number(c),errorText:d}}case"GetBlockListResponseSuccessWithMatch":return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["fetchBlocklist: GetBlockListResponseSuccessWithMatch ",""])),n.value.type),{type:"match"};case"GetBlockListResponseSuccessWithMismatch":{var m=n.value.listDhash,_=n.value.listItem.map(function(e){var t;return{wid:o("WAWebJidToWid").userJidToUserWid(e.jid),displayName:(t=e.displayNameMixin)==null?void 0:t.displayName}});return{type:"mismatch",dhash:m,list:{items:_,addressingMode:"pn"}}}default:{n.name;var f=n.value.listDhash,g=n.value.listItem.map(function(e){var t=e.jid,n=o("WAWebJidToWid").lidUserJidToUserLid(t);return babelHelpers.extends({},p(e.blocklistIds),{active:e.active==="true",lid:n})});return{type:"mismatch",dhash:f,list:{items:g,addressingMode:"lid"}}}}}),d.apply(this,arguments)}function m(e){return e.addressingMode==="pn"?e.items.map(function(e){return e.wid}):e.items.map(function(e){return e.lid})}function p(e){switch(e.name){case"Username":return{username:e.value.username};case"DisplayName":return{displayName:e.value.displayName};case"PnJid":return{pn:o("WAWebJidToWid").userJidToUserWid(e.value.pnJid)};case"UnknownIdentifier":return null}}l.getBlocklist=c,l.extractWids=m}),98);
__d("WAWebQueryBlockListJob",["WAArrayUtils","WALogger","WASmaxPsaChatBlockGetRPC","WAWebApiBlocklist","WAWebBackendApi","WAWebBlocklistMigration","WAWebCriticalEventWamEvent","WAWebDBCreateLidPnMappings","WAWebGetBlocklistJob","WAWebLid1X1MigrationGating","WAWebLidAwareContactsDB","WAWebLogoutReasonConstants","WAWebSetUsernameJob","WAWebSocketLogoutJob","WAWebUpdateLidMetadataJob","WAWebUserPrefsMultiDevice","WAWebWid","asyncToGeneratorRuntime","partitionArray"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p;function _(){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[blocklist] fetch blocklist"])));var t=yield o("WAWebGetBlocklistJob").getBlocklist();if(t.errorCode!=null)return t;if(t.type==="mismatch"){var n=o("WAWebBlocklistMigration").isBlocklistMigrated(),r=t.list;o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[blocklist] updating blocklist with "," contact(s)"])),r.items.length),yield o("WAWebUserPrefsMultiDevice").setBlocklistHash(t.dhash);var a=o("WAWebGetBlocklistJob").extractWids(r);if(yield o("WAWebApiBlocklist").updateBlocklist(a),o("WAWebBackendApi").frontendFireAndForget("replaceBlocklist",{wids:a}),r.addressingMode==="pn"){n&&(yield E("LidBlocklistUnexpectedPnBlocklist"),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[blocklist] received a pn-based blocklist on a migrated device, unmigrating it"]))),o("WAWebBlocklistMigration").setBlocklistUnmigrated());var i=r.items.map(function(e){var t=e.wid,n=e.displayName;if(n==null||!t.isLid())return null;var r={};return n!=null&&(r.displayNameLID=n),{lid:t,data:r}}).filter(Boolean);yield o("WAWebUpdateLidMetadataJob").updateLidMetadataJob(i)}else r.addressingMode,o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()||(yield E("LidBlocklistUnmigratedChatDb"),yield o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.LidBlocklistChatDbUnmigrated)),yield y(r.items),n||(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[blocklist] received a lid-based blocklist, marking the device as migrated"]))),o("WAWebBlocklistMigration").setBlocklistMigrated())}else o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[blocklist] no change in blocklist, skip update"])));return t}),f.apply(this,arguments)}function g(){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WASmaxPsaChatBlockGetRPC").sendChatBlockGetRPC();switch(e.name){case"ChatBlockGetResponseServerError":{var t=e.value.errorChatBlockError.value,n=t.code,r=t.text;return o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["getBlockingStatusForPSAUser: server response with ",", ",""])),n,r),{errorCode:Number(n),errorText:r}}default:return e.name,e.value.blockingStatus==="blocked"}}),h.apply(this,arguments)}function y(e){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=[],n=[];for(var r of e)r.pn!=null&&t.push(r),(r.username!=null||r.displayName!=null)&&n.push(r);yield b(t),yield S(n)}),C.apply(this,arguments)}function b(e){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAArrayUtils").groupBy(e,function(e){return e.pn.toString()}),n=[],a=[];for(var i of t.values()){var l=r("partitionArray")(i,function(e){return e.active}),s=l[0],u=l[1],c=u.sort(function(e,t){return r("WAWebWid").compare(e.lid,t.lid)}).reverse();n.push.apply(n,L(c)),s.length>1&&o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[blocklist] multiple active LIDs for the same PN"]))).sendLogs("blocklist-multiple-active-lids"),a.push.apply(a,L(s))}yield o("WAWebDBCreateLidPnMappings").createLidPnMappings({mappings:n,flushImmediately:!1,identityChangeHandlingEnabled:!1,learningSource:"blocklist-inactive"}),yield o("WAWebDBCreateLidPnMappings").createLidPnMappings({mappings:a,flushImmediately:!1,identityChangeHandlingEnabled:!1,learningSource:"blocklist-active"}),yield o("WAWebDBCreateLidPnMappings").flushLidPnMappingsToDb()}),v.apply(this,arguments)}function S(e){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){for(var t=[],n=[],a=yield r("WAWebLidAwareContactsDB").bulkGet(e.map(function(e){return e.lid.toString()})),i=0;i<e.length;i++){var l=e[i],s=a[i];l.username!=null?(s==null||s.username==null&&s.phoneNumber==null)&&t.push({userId:l.lid,username:l.username}):(l.displayName,(s==null||s.displayNameLID==null)&&n.push({lid:l.lid,data:{displayNameLID:l.displayName}}))}yield o("WAWebSetUsernameJob").setUsernamesJob(t),yield o("WAWebUpdateLidMetadataJob").updateLidMetadataJob(n)}),R.apply(this,arguments)}function L(e){return e.map(function(e){return{lid:e.lid,pn:e.pn}})}function E(e){var t=new(o("WAWebCriticalEventWamEvent")).CriticalEventWamEvent({name:e,debug:"{fetch}"});return t.commitAndWaitForFlush()}l.fetchAndUpdateBlocklist=_,l.getBlockingStatusForPSAUser=g,l.learnIdentifiers=y}),98);
__d("WAWebSyncBootstrap",["$InternalEnum","Promise","WAAsyncSleep","WAJobOrchestratorTypes","WALogger","WAPromiseDelays","WASyncdConst","WATimeUtils","WAWebAccountSyncJob","WAWebApiHistorySyncNotification","WAWebAppTracker","WAWebBootstrapNewsletter","WAWebBrokerGlobalAppState","WAWebClientFeatureFlags","WAWebCmd","WAWebDbEncryptionKey","WAWebEnvironment","WAWebGetUsernameQueryJob","WAWebHandleAccountSyncNotification","WAWebHandleHistorySyncChunk","WAWebHandleWorkerCompatibleRecentSyncChunk","WAWebHistorySyncNotificationUtils","WAWebJestE2ELogUtils","WAWebJobOrchestrator","WAWebLogoutReasonConstants","WAWebMdBootstrapDataAppliedWamEvent","WAWebMetricsAttributionActions","WAWebNonAddressBookContactsJob","WAWebOrchestratorNonPersistedJob","WAWebProtobufsHistorySync.pb","WAWebQueryAndUpdateGroupMetadataJob","WAWebQueryBlockListJob","WAWebSchemaHistorySyncNotification","WAWebSocketLogoutJob","WAWebSyncContactJob","WAWebSyncDeviceAdvDeviceListJob","WAWebSyncd","WAWebSyncdDb","WAWebSyncdMdSyncFieldstatMeta","WAWebUserPrefsAppStateSync","WAWebUserPrefsHistorySync","WAWebUsernameGatingUtils","WAWebWamEnumMdBootstrapPayloadType","WAWebWamEnumMdBootstrapSource","WAWebWamEnumWebcScenarioType","WAWebWamMemoryStat","WAWebWamUtils","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","cr:17219"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x,$,P,N,M,w,A,F,O,B,W,q,U,V,H,G,z,j,K,Q,X,Y,J,Z,ee,te,ne=(e=n("cr:17219"))==null?void 0:e.getWindowsBridge(),re=40,oe=20,ae=180,ie=n("$InternalEnum").Mirrored(["NotStarted","InProcess","Completed"]),le={initialChatHistory:!1,readReceipts:!1,syncdCritical:!1},se={initialChatHistoryTotalMsg:-1,initialChatHistoryTotalChats:-1},ue=20,ce=(function(){function e(){this.$1={},this.$2=se,this.$6=!1,this.$7=null,this.$8=null,this.$9=null,this.$10=!1,this.initState()}var t=e.prototype;return t.initState=function(){this.$1=babelHelpers.extends({},le),this.$2=babelHelpers.extends({},se),this.$3=ie.NotStarted,this.$4=ie.NotStarted,this.$5=ie.NotStarted},t._isCriticalSyncDoneThisSession=function(){for(var e in this.$1)if(!this.$1[e])return!1;return!0},t._setSynced=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap][history sync] completed sync for ",""])),e),this.$1[e]=!0,this._isCriticalSyncDoneThisSession()&&(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap][history sync] critical sync done"]))),yield o("WAWebUserPrefsAppStateSync").setAllCriticalDataSynced(),o("WAWebCmd").Cmd.criticalSyncDone(),r("WAWebBrokerGlobalAppState").initOrUpdateTracking(o("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.INITIAL_PAIRING),o("WAWebWamMemoryStat").setCurrentMemoryScenario(o("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.IDLE),this.syncNonCriticalData())});function t(t){return e.apply(this,arguments)}return t})(),t._syncContactsInChunks=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["start contact sync for "," chunks of contacts during the initial sync"])),e?t.length+1:0).tags("contact-sync"),e!=null&&(yield o("WAWebSyncContactJob").syncContactListJob(Array.from(e),!1,"query"));for(var n=0;n<t.length;n++){var r=Array.from(t[n]);yield o("WAPromiseDelays").delayMs(oe*1e3),yield o("WAWebSyncContactJob").syncContactListJob(r,!0,"query")}o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["initial contact sync completes"]))).tags("contact-sync")});function t(t,n){return e.apply(this,arguments)}return t})(),t._syncDeviceList=function(t){if(t==null)return o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncMostRecentDevices has no contact to sync during bootstrap"]))).tags("contact-sync"),(te||(te=n("Promise"))).resolve();o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["sync "," contacts for device info during the initial sync"])),t.size).tags("contact-sync");var e=Array.from(t);return o("WAWebSyncDeviceAdvDeviceListJob").syncDeviceListJob(e,null,null).catch(function(e){o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Sync device failed"]))).verbose().sendLogs("Sync device failed: "+e)})},t.setReadReceiptsSynced=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield this._setSynced("readReceipts")});function t(){return e.apply(this,arguments)}return t})(),t.setInitialChatHistorySynced=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield this._setSynced("initialChatHistory"),o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] initial chat history synced."]))),de.continueProgressiveHistorySyncProcessingV2(o("WAWebHistorySyncNotificationUtils").HistorySyncScheduleSource.InitialSyncComplete)});function t(){return e.apply(this,arguments)}return t})(),t.setSyncDCriticalSynced=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){this.$3=ie.Completed,!this.$1.syncdCritical&&(yield this._setSynced("syncdCritical"))});function t(){return e.apply(this,arguments)}return t})(),t.syncNonCriticalData=function(){var e=this,t=[];this.$5=ie.InProcess,o("WAWebQueryAndUpdateGroupMetadataJob").queryAndUpdateAllGroupMetadata({isHistorySyncInProgress:!0}).then(function(){t=o("WAWebNonAddressBookContactsJob").getAllContactsFromChatCollectionIntoChunks(),e._syncDeviceList(t[0]),o("WAWebNonAddressBookContactsJob").getAndUpdateNonAddressBookContacts()}).then(function(){self.setTimeout(function(){e._syncContactsInChunks(t[0],t.slice(1,t.length))},re*1e3)}).finally(function(){e.$5=ie.Completed}),o("WAWebHandleAccountSyncNotification").getAndUpdateStatus(),o("WAWebAccountSyncJob").getAndUpdateProfilePicture(),o("WAWebQueryBlockListJob").fetchAndUpdateBlocklist(),o("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("updateOptOutList"),o("WAWebBootstrapNewsletter").bootstrapNewsletterBackend(),o("WAWebUsernameGatingUtils").usernameCreationEnabled()||o("WAWebUsernameGatingUtils").username1on1ChatCreationEnabled()?o("WAWebGetUsernameQueryJob").getUsernameJob():o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap][history sync] username creation and 1on1 chat disabled, skipping get username query"]))),this.$4=ie.InProcess,o("WAWebSyncd").markCollectionsForSync([o("WASyncdConst").CollectionName.Regular,o("WASyncdConst").CollectionName.RegularLow,o("WASyncdConst").CollectionName.RegularHigh]).then(function(){var t;e.$4=ie.Completed,ne==null||(t=ne.contacts)==null||t.initialize()})},t.markInitialHistorySyncCountDebugStats=function(t,n){this.$2={initialChatHistoryTotalMsg:t,initialChatHistoryTotalChats:n}},t.isSyncDCriticalDataSyncInProcess=function(){return this.$3===ie.InProcess},t.isSyncDBootstrapInProcess=function(){return this.$3===ie.InProcess||this.$4===ie.InProcess},t.isSyncDBootstrapGroupMetadataQueryInProcess=function(){return this.$5===ie.InProcess},t.$11=function(){var e=this;this.$7==null&&(o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap][history sync] setting critical data syncd timeout (",")"])),ae),this.$7=self.setTimeout(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){(yield e.$12())||(o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap] syncd critical data timeout exceeded, logging out"]))),o("WAWebMetricsAttributionActions").stopAllHistorySyncAttributionTracking(),o("WAWebWamUtils").forceFlushAllWamAndQplBuffers(),o("WAWebJestE2ELogUtils").maybeLogToJestE2eJSConsole("syncd critical data timeout exceeded, logging out"),yield o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.SyncdTimeout));var t=yield o("WAWebUserPrefsHistorySync").getInitialHistorySyncComplete();t!==!0&&(o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap][history sync] history sync critical data timeout exceeded, logging out"]))),o("WAWebWamUtils").forceFlushAllWamAndQplBuffers(),o("WAWebJestE2ELogUtils").maybeLogToJestE2eJSConsole("history sync critical data timeout exceeded, logging out"),yield o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.HistorySyncTimeout)),o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap][history sync] all critical data synced within timeout period"])))}),ae*1e3))},t.$12=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebSyncdDb").getSyncActionsRows(["action"],[o("WASyncdConst").Actions.SettingPushName]);return e.length>0&&e.find(function(e){return e.actionState===o("WASyncdConst").SyncActionState.Success})!=null});function t(){return e.apply(this,arguments)}return t})(),t.setSyncDCriticalDataSyncCompleted=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){this.$7!=null&&(yield new(o("WAWebMdBootstrapDataAppliedWamEvent")).MdBootstrapDataAppliedWamEvent({mdBootstrapPayloadType:o("WAWebWamEnumMdBootstrapPayloadType").MD_BOOTSTRAP_PAYLOAD_TYPE.CRITICAL,mdBootstrapSource:o("WAWebWamEnumMdBootstrapSource").MD_BOOTSTRAP_SOURCE.APP_STATE,mdSessionId:yield o("WAWebSyncdMdSyncFieldstatMeta").MdSyncFieldStatsMeta.getMdSessionId(),mdTimestamp:o("WATimeUtils").unixTimeMs()}).commitAndWaitForFlush(!0))});function t(){return e.apply(this,arguments)}return t})(),t.getCriticalSyncDebugSummary=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(yield this.isCriticalDataSynced())return"-------\nAll critical data synced\n-------\n\n";var e=yield o("WAWebUserPrefsHistorySync").getHistorySyncStatus();return"-------\n Initial history sync complete: "+(e?"true":this.$1.initialChatHistory.toString())+"\n Initial msgs: "+this.$2.initialChatHistoryTotalMsg+", initial chats: "+this.$2.initialChatHistoryTotalChats+"\n Receipt sync complete: "+this.$1.readReceipts.toString()+" \n "+("Critical collection sync complete: "+this.$1.syncdCritical.toString()+" \n-------\n")});function t(){return e.apply(this,arguments)}return t})(),t.isCriticalDataSynced=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return this.$6=this.$6||(yield o("WAWebUserPrefsAppStateSync").getAllCriticalDataSynced()),this.$6});function t(){return e.apply(this,arguments)}return t})(),t.syncCriticalData=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=this;r("WAWebBrokerGlobalAppState").initOrUpdateTracking(o("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.INITIAL_PAIRING),o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap][history sync] need to sync critical data: true"])));var t=yield this.getCriticalSyncDebugSummary();o("WALogger").LOG(S||(S=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap][history sync] ",""])),t),o("WALogger").LOG(R||(R=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap] syncing my device list"]))).tags("history-sync");var a=o("WAWebSyncDeviceAdvDeviceListJob").syncMyDeviceListJob(),i=new(te||(te=n("Promise")))(function(t,n){o("WAWebAccountSyncJob").updatePrivacySettings().then(function(){return e.setReadReceiptsSynced()}).then(t).catch(n)}).catch(function(e){o("WALogger").ERROR(L||(L=babelHelpers.taggedTemplateLiteralLoose(["failed to sync privacy settings ",""])),e.stack).verbose().devConsole(e).sendLogs("failed to update privacy settings from privacy request to server"),o("WAWebJestE2ELogUtils").maybeLogToJestE2eJSConsole("failed to sync privacy settings, logging out"),o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.AccountSyncError)});this.$11(),this.$3=ie.InProcess;var l=a.then(function(){return o("WAWebSyncd").markCollectionsForSync([o("WASyncdConst").CollectionName.CriticalBlock,o("WASyncdConst").CollectionName.CriticalUnblockLow])}).then(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){e.$1.syncdCritical||(yield e.$12())&&(yield e.setSyncDCriticalSynced(),yield e.setSyncDCriticalDataSyncCompleted())})),s=yield o("WAWebUserPrefsHistorySync").getInitialHistorySyncComplete();s===!0&&(yield this.setInitialChatHistorySynced());var u=o("WAWebAccountSyncJob").updateDefaultDisappearingMode().catch(function(e){o("WALogger").ERROR(E||(E=babelHelpers.taggedTemplateLiteralLoose(["failed to sync default disappearing mode ",""])),e.stack).verbose().devConsole(e).sendLogs("failed initial sync of default disappearing mode")});yield te.all([i,l,u])});function t(){return e.apply(this,arguments)}return t})(),t.$13=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!o("WAWebCmd").Cmd.isMainStreamReadyMd){o("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] Skip processLoop, until main is loaded"]))).tags("history-sync");return}var e=yield o("WAWebApiHistorySyncNotification").fetchNextHistorySyncChunkForProcessing();if(!e){o("WALogger").LOG(I||(I=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] no chunk found"]))).tags("history-sync");return}if(o("WALogger").LOG(T||(T=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] processLoop picked up chunk"]))),e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT&&e.chunkOrder!=null){var t=e.msgKey;o("WAWebApiHistorySyncNotification").recentSyncChunkHandlingTriedCount[t]!=null?(o("WAWebApiHistorySyncNotification").recentSyncChunkHandlingTriedCount[t]++,o("WAWebApiHistorySyncNotification").recentSyncChunkHandlingTriedCount[t]>ue&&o("WALogger").ERROR(D||(D=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] recent sync chunk handling retry limit reached"]))).sendLogs("history-sync-recent-sync-chunk-handling-retry-limit")):o("WAWebApiHistorySyncNotification").recentSyncChunkHandlingTriedCount[t]=1}e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT?yield o("WAWebHandleWorkerCompatibleRecentSyncChunk").handleWorkerCompatibleRecentSyncChunk(e):yield o("WAWebHandleHistorySyncChunk").handleHistorySyncChunk(e)});function t(){return e.apply(this,arguments)}return t})(),t.$14=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(x||(x=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] job starts"])));try{yield o("WAWebDbEncryptionKey").DbEncKeyStore.waitForFinalDbMsgEncKey(),yield this.$13()}catch(e){o("WALogger").ERROR($||($=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] _progressiveHistorySyncRun failed with ",", stack: ",""])),e==null?void 0:e.message,e==null?void 0:e.stack)}o("WALogger").LOG(P||(P=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] finish main flow"])));var e=yield o("WAWebUserPrefsHistorySync").getHistorySyncStatus();if((e==null?void 0:e.recentCompleted)===!0){var t=!0;o("WALogger").LOG(N||(N=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] recent sync finishes, check remaining on demand sync notifications"])));var n=yield o("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().equals(["processed","syncType"],[0,o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND],{shouldDecrypt:!1});if(n.length>0?(t=!1,this.continueProgressiveHistorySyncProcessingV2(o("WAWebHistorySyncNotificationUtils").HistorySyncScheduleSource.LastProcessedNotification)):o("WALogger").LOG(M||(M=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] skip scheduling the next run as no on demand notifications"]))),o("WAWebClientFeatureFlags").isFeatureEnabled("debug_1_year_history_sync")){o("WALogger").LOG(w||(w=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] recent sync finishes, check remaining full sync notifications"])));var a=yield o("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().equals(["processed","syncType"],[0,o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.FULL],{shouldDecrypt:!1});a.length>0?(t=!1,this.continueProgressiveHistorySyncProcessingV2(o("WAWebHistorySyncNotificationUtils").HistorySyncScheduleSource.LastProcessedNotification)):o("WALogger").LOG(A||(A=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] skip scheduling the next run as no on full sync notifications"])))}t&&o("WAWebMetricsAttributionActions").stopAllHistorySyncAttributionTracking();return}o("WALogger").LOG(F||(F=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] recent sync is incompleted, check remaining recent sync notifications"])));var i=yield o("WAWebHistorySyncNotificationUtils").getUnprocessedRecentSyncNotifications();if(i.length===0){o("WALogger").LOG(O||(O=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] skip scheduling the next run as no recent notifications"])));return}var l=i[0].chunkOrder;if(l==null){o("WALogger").LOG(B||(B=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] skip scheduling the next run as first recent notification doesn't have chunk order"])));return}var s=yield o("WAWebUserPrefsHistorySync").getLastHistoryRecentSyncedChunk();if(o("WALogger").LOG(W||(W=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] next unprocessed recent notification has chunk order: ",", last chunk order: ",""])),l,s==null?void 0:s.chunkOrder),s!=null&&s.chunkOrder+1!==l&&l!==1){o("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] skip scheduling the next run as no recent notifications with correct chunk order"])));return}if(r("WAWebEnvironment").isWindows===!0&&(s==null?void 0:s.chunkOrder)===this.$8&&l===this.$9){this.$10||(this.$10=!0,o("WALogger").ERROR(U||(U=babelHelpers.taggedTemplateLiteralLoose(["[history sync] loop detected, unexpected last chunk order"]))).sendLogs("history-sync-unexpected-chunk-order")),yield o("WAAsyncSleep").asyncSleep(5e3);return}if(this.$8=s==null?void 0:s.chunkOrder,this.$9=l,o("WAWebApiHistorySyncNotification").recentSyncChunkHandlingTriedCount[i[0].msgKey]>ue){o("WALogger").LOG(V||(V=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] skip scheduling the next run as recent notification with order "," fails too many times"])),l);return}o("WALogger").LOG(H||(H=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] init next run"]))),this.continueProgressiveHistorySyncProcessingV2(o("WAWebHistorySyncNotificationUtils").HistorySyncScheduleSource.LastProcessedNotification)});function t(){return e.apply(this,arguments)}return t})(),t.continueProgressiveHistorySyncProcessingV2=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this;if(!this.$6&&this.$1.initialChatHistory!==!0)return o("WALogger").LOG(G||(G=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] Skip job scheduling as initial chat sync is incomplete"]))),(te||(te=n("Promise"))).resolve();if(e===o("WAWebHistorySyncNotificationUtils").HistorySyncScheduleSource.BackendStart){var r=yield o("WAWebUserPrefsHistorySync").getHistorySyncStatus();if((r==null?void 0:r.recentCompleted)===!0)return o("WALogger").LOG(z||(z=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] Skip job scheduling as recent sync is complete when starting backend"]))),(te||(te=n("Promise"))).resolve()}return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("continueProgressiveHistorySyncProcessingV2",(function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){return o("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] job is scheduled, source: ",""])),e),t.$14()});return function(e){return r.apply(this,arguments)}})(),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC,maxTimeoutMs:12e4}).waitUntilCompleted().catch(function(e){o("WALogger").ERROR(K||(K=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] error while running job: ",""])),e)})});function t(t){return e.apply(this,arguments)}return t})(),t.getIsHistorySyncRunning=function(){var e=o("WAWebJobOrchestrator").getInstance(),t=e.getSnapshot(o("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC);return t!=null&&t.continueProgressiveHistorySyncProcessingV2!=null?t.continueProgressiveHistorySyncProcessingV2>0:!1},e})(),de=new ce;o("WAWebCmd").Cmd.on("on_initial_chat_synced",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.CriticalSync),yield de.setInitialChatHistorySynced()})),o("WAWebCmd").Cmd.on("logout",function(){de.initState()}),o("WAWebCmd").Cmd.on("on_recent_chat_history_synced",function(){var e=o("WAWebJobOrchestrator").getInstance();o("WALogger").DEV(Q||(Q=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] finish recent sync, before clearing: ",""])),JSON.stringify(e.getSnapshot(o("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC))),o("WALogger").LOG(X||(X=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] clearing bucket queue for type ",""])),o("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC),e.clearQueueByPriority(o("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC),o("WALogger").DEV(Y||(Y=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] finish recent sync, after clearing: ",""])),JSON.stringify(e.getSnapshot(o("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC)))}),o("WAWebCmd").Cmd.on("on_full_chat_history_synced",function(){var e=o("WAWebJobOrchestrator").getInstance();o("WALogger").DEV(J||(J=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] finish full sync, before clearing: ",""])),JSON.stringify(e.getSnapshot(o("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC))),o("WALogger").LOG(Z||(Z=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] clearing bucket queue for type ",""])),o("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC),e.clearQueueByPriority(o("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC),o("WALogger").DEV(ee||(ee=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] finish full sync, after clearing: ",""])),JSON.stringify(e.getSnapshot(o("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC)))});var me=de;l.default=me}),98);
__d("WAWebBizCreateOrderJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWapDeprecatedSmaxID","WAWebBackendErrors","WAWebCommsWapMd","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=new(r("WADeprecatedWapParser"))("createOrderResponse",function(e){e.assertTag("iq"),e.assertFromServer();var t=e.child("order"),n=t.attrString("id"),r=t.attrString("token"),o=t.maybeChild("price"),a={},i=o==null?void 0:o.maybeChild("subtotal");i&&(a.subtotal=i.contentString());var l=o==null?void 0:o.maybeChild("total");l&&(a.total=l.contentString());var s=o==null?void 0:o.maybeChild("currency");s&&(a.currency=s.contentString());var u=o==null?void 0:o.maybeChild("price_status");return u&&(a.price_status=u.contentString()),{id:n,token:r,price:a}});function s(e){var t,n=e.priceAmount1000!=null?o("WAWap").wap("price",null,e.priceAmount1000.toString()):void 0,r=e.currency?o("WAWap").wap("currency",null,e.currency):void 0,a=e.variantProperties?o("WAWap").wap("variant_info",null,o("WAWap").wap("properties",null,(t=e.variantProperties)==null?void 0:t.map(function(e){var t=e.name,n=e.value;return o("WAWap").wap("property",{name:o("WAWap").MAYBE_CUSTOM_STRING(t!=null?t:""),value:o("WAWap").MAYBE_CUSTOM_STRING(n!=null?n:"")})}))):void 0;return o("WAWap").wap("product",null,o("WAWap").wap("id",null,e.id),o("WAWap").wap("name",null,e.name),n,r,o("WAWap").wap("quantity",null,e.quantity.toString()),a)}function u(e,t,n){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a){a===void 0&&(a=null);var i=o("WAWap").wap("iq",{to:o("WAWap").S_WHATSAPP_NET,smax_id:o("WAWap").SMAX_ID(r("WAWapDeprecatedSmaxID").CreateOrder),xmlns:"fb:thrift_iq",id:o("WAWap").generateId(),type:"set"},o("WAWap").wap("order",{op:o("WAWap").CUSTOM_STRING("create"),biz_jid:o("WAWebCommsWapMd").USER_JID(t)},n.map(function(e){return s(e)}).concat(a!=null?o("WAWap").wap("direct_connection_encrypted_info",null,a):[]))),l=yield o("WADeprecatedSendIq").deprecatedSendIq(i,e);if(l.success)return l.result;throw l.errorCode===451?new(o("WAWebBackendErrors")).E451:new(o("WAWebBackendErrors")).ServerStatusCodeError(l.errorCode)}),c.apply(this,arguments)}l.createOrderResponse=e,l.createOrderMD=u}),98);
__d("WAWebBizQueryOrderJobQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"request"}],t=[{kind:"Variable",name:"request",variableName:"request"}],n={alias:null,args:null,kind:"ScalarField",name:"creation_time_stamp",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},l={alias:null,args:null,concreteType:"XWACatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:[o,{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null},s={alias:null,args:null,concreteType:"XWAProductCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null}],storageKey:null}],storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"quantity",storageKey:null},c={alias:null,args:null,concreteType:"XWACheckoutPriceDetails",kind:"LinkedField",name:"price_details",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"subtotal",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebBizQueryOrderJobQuery",selections:[{alias:null,args:t,concreteType:"XWACheckoutGetOrderInfoResponseSuccess",kind:"LinkedField",name:"xwa_checkout_get_order_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACheckoutGetOrderInfoResponseSuccessOrder",kind:"LinkedField",name:"order",plural:!1,selections:[n,{alias:null,args:null,concreteType:"XWACatalogProduct",kind:"LinkedField",name:"products",plural:!0,selections:[{kind:"RequiredField",field:r,action:"THROW"},{kind:"RequiredField",field:o,action:"THROW"},a,i,l,s,u],storageKey:null},c],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebBizQueryOrderJobQuery",selections:[{alias:null,args:t,concreteType:"XWACheckoutGetOrderInfoResponseSuccess",kind:"LinkedField",name:"xwa_checkout_get_order_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACheckoutGetOrderInfoResponseSuccessOrder",kind:"LinkedField",name:"order",plural:!1,selections:[n,{alias:null,args:null,concreteType:"XWACatalogProduct",kind:"LinkedField",name:"products",plural:!0,selections:[r,o,a,i,l,s,u],storageKey:null},c],storageKey:null}],storageKey:null}]},params:{id:"27500063212935409",metadata:{},name:"WAWebBizQueryOrderJobQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebBizQueryOrderJob",["Promise","WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WAWap","WAWapDeprecatedSmaxID","WAWebBackendErrors","WAWebBizGatingUtils","WAWebBizQueryOrderJobQuery.graphql","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c=e!==void 0?e:e=n("WAWebBizQueryOrderJobQuery.graphql"),d=new(r("WADeprecatedWapParser"))("queryOrderResponse",function(e){e.assertTag("iq"),e.assertFromServer();var t=e.child("order"),n=t.hasAttr("creation_ts")?t.attrTime("creation_ts"):null,r=t.maybeChild("price"),o=r==null?void 0:r.maybeChild("subtotal"),a=o?parseInt(o.contentString(),10):null,i=r==null?void 0:r.maybeChild("currency"),l=i?i.contentString():null,s=r==null?void 0:r.maybeChild("tax"),u=s?parseInt(s.contentString(),10):null,c=r==null?void 0:r.maybeChild("total"),d=c?parseInt(c.contentString(),10):null,m=[];return t.forEachChildWithTag("product",function(e){var t=e.child("id"),n=t.contentString(),r=e.child("name"),o=r.contentString(),a=e.maybeChild("price"),i=a?parseInt(a.contentString(),10):null,l=e.maybeChild("quantity"),s=l?parseInt(l.contentString(),10):null,u=e.maybeChild("variant_info"),c=u?u.maybeChild("properties"):null,d=[];c==null||c.forEachChildWithTag("property",function(e){var t=e.attrString("name"),n=e.attrString("value");t!=null&&n!=null&&d.push([t,n])});var p=e.maybeChild("currency"),_=p?p.contentString():null,f=null,g=null,h=e.maybeChild("image");if(h!=null){var y=h.maybeChild("url");g=y&&y.hasContent()?y.contentString():null;var C=h.maybeChild("id");f=C&&C.hasContent()?C.contentString():null}m.push({id:n,price:i,thumbnailId:f,thumbnailUrl:g,currency:_,name:o,quantity:s,properties:d})}),{currency:l,createdAt:n,products:m,subtotal:a,total:d,tax:u}});function m(e,t,n,r,o){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,a,i){return i===void 0&&(i=null),o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions()?(u||(u=n("Promise"))).reject(new(o("WAWebBackendErrors")).E451):o("WAWebBizGatingUtils").graphQLForGetOrderInfoEnabled()?_(e,t,r,a,i):g(e,t,r,a,i)}),p.apply(this,arguments)}function _(e,t,n,r,o){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a,i){i===void 0&&(i=null);try{var l,u,d,m,p;yield r("WAWebNetworkStatus").waitIfOffline();var _=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),f=yield o("WAWebRelayClient").fetchQuery(c,{request:{order:{jid:_.toString(),token:{sensitive_string_value:a},id:e,image_dimensions:{height:n,width:t},direct_connection_encrypted_info:i}}},{environmentType:"whatsapp_catalog"});if((f==null||(l=f.xwa_checkout_get_order_info)==null?void 0:l.order)==null)throw new(o("WAWebBackendErrors")).ServerStatusCodeError(500);var g=f.xwa_checkout_get_order_info.order,h=((u=g.products)!=null?u:[]).map(function(e){var t,n,r,o=[];return(t=e.variant_info)==null||(t=t.variant_properties)==null||t.forEach(function(e){e.name!=null&&e.value!=null&&o.push([e.name,e.value])}),{id:e.id,name:e.name,price:e.price!=null?parseInt(e.price,10):null,currency:e.currency,quantity:e.quantity!=null?parseInt(e.quantity,10):null,thumbnailId:(n=e.media)==null||(n=n.images)==null||(n=n.at(0))==null?void 0:n.id,thumbnailUrl:(r=e.media)==null||(r=r.images)==null||(r=r.at(0))==null?void 0:r.request_image_url,properties:o}});return{createdAt:g.creation_time_stamp!=null?Number(g.creation_time_stamp):null,currency:(d=g.price_details)==null?void 0:d.currency,subtotal:((m=g.price_details)==null?void 0:m.subtotal)!=null?parseInt(g.price_details.subtotal,10):null,tax:null,total:((p=g.price_details)==null?void 0:p.total)!=null?parseInt(g.price_details.total,10):null,products:h}}catch(e){if(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["WAWebBizQueryOrderJob: GraphQL queryOrder failed"]))).devConsole(e),e instanceof o("WAWebGraphQLServerError").GraphQLServerError){var y,C=(y=e.source.errors[0])==null?void 0:y.code;throw C===451?new(o("WAWebBackendErrors")).E451:new(o("WAWebBackendErrors")).ServerStatusCodeError(C!=null?C:500)}throw e}}),f.apply(this,arguments)}function g(e,t,n,r,o){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a,i){i===void 0&&(i=null);var l=o("WAWap").wap("iq",{to:o("WAWap").S_WHATSAPP_NET,smax_id:o("WAWap").SMAX_ID(r("WAWapDeprecatedSmaxID").QueryOrder),xmlns:"fb:thrift_iq",id:o("WAWap").generateId(),type:"get"},o("WAWap").wap("order",{op:o("WAWap").CUSTOM_STRING("get"),id:o("WAWap").CUSTOM_STRING(e)},o("WAWap").wap("image_dimensions",null,o("WAWap").wap("width",null,t.toString()),o("WAWap").wap("height",null,n.toString())),o("WAWap").wap("token",null,a),i!=null?o("WAWap").wap("direct_connection_encrypted_info",null,i):null)),s=yield o("WADeprecatedSendIq").deprecatedSendIq(l,d);if(s.success)return s.result;throw s.errorCode===451?new(o("WAWebBackendErrors")).E451:new(o("WAWebBackendErrors")).ServerStatusCodeError(s.errorCode)}),h.apply(this,arguments)}l.queryOrderResponse=d,l.queryOrder=m}),98);
__d("WAWebBizOrderBridge",["Promise","WAWebBackendErrors","WAWebBizCreateOrderJob","WAWebBizGatingUtils","WAWebBizLogQplEvents","WAWebBizQueryOrderJob","WAWebBusinessDirectConnectionBridge"],(function(t,n,r,o,a,i,l){var e;function s(t,r,a,i,l){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())return(e||(e=n("Promise"))).reject(new(o("WAWebBackendErrors")).E451);o("WAWebBizLogQplEvents").qplPointOrderView("datasource_start");var s=o("WAWebBusinessDirectConnectionBridge").attemptWithDirectConnectionRetry(t,function(e){return o("WAWebBizQueryOrderJob").queryOrder(r,a,i,l,e)});return s.then(function(e){return o("WAWebBizLogQplEvents").qplPointOrderView("datasource_end"),e})}function u(t,r){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())return(e||(e=n("Promise"))).reject(new(o("WAWebBackendErrors")).E451);o("WAWebBizLogQplEvents").qplPointOrderCreate("datasource_start");var a=o("WAWebBusinessDirectConnectionBridge").attemptWithOrderDirectConnectionRetry(t,function(e){return o("WAWebBizCreateOrderJob").createOrderMD(t,r,e)});return a.then(function(e){return o("WAWebBizLogQplEvents").qplPointOrderCreate("datasource_end"),e})}l.queryOrder=s,l.createOrder=u}),98);
__d("WAWebBizCatalogManagementAddProductMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="24249359867999500"}),null);
__d("WAWebBizCatalogManagementAddProductMutation.graphql",["WAWebBizCatalogManagementAddProductMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{kind:"Variable",name:"request",variableName:"input"}],r={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},d=[l,c],m=[{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},r,o,{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[o,a,i],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[o,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},l,s,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null},s,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null}],storageKey:null},u,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},u],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:d,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[l,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[c,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[o,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},a,i],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:d,storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementAddProductMutation",selections:[{alias:null,args:t,concreteType:"XFBWhatsAppCatalogProductMutationResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_add_product",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"product",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebBizCatalogManagementParseProductGraphql_product",selections:m,args:null,argumentDefinitions:[]}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebBizCatalogManagementAddProductMutation",selections:[{alias:null,args:t,concreteType:"XFBWhatsAppCatalogProductMutationResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_add_product",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"product",plural:!1,selections:m,storageKey:null}],storageKey:null}]},params:{id:n("WAWebBizCatalogManagementAddProductMutation_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementAddProductMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("WAWebBizCatalogManagementAddProduct",["Promise","WALogger","WAWebBizCatalogManagementAddProductMutation.graphql","WAWebBizCatalogManagementParseProductGraphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m={type:"error"},p=e!==void 0?e:e=n("WAWebBizCatalogManagementAddProductMutation.graphql");function _(e){return o("WAWebBizGatingUtils").graphQLForAddProductEnabled()?f(e).then(function(e){return e.type==="success"?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["addProduct: success"]))),e):(e.type,o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(['addProduct: failed as "','"'])),e.type),e)}):(d||(d=n("Promise"))).resolve({type:"not-enabled"})}function f(e){return o("WAWebFetchAdAccountToken").fetchToken().then(function(t){return t.type==="success"?g(t.token,e).then(function(e){return e.type!=="success"&&e.type==="auth-failure"?o("WAWebFetchAdAccountToken").markTokenAsInvalid():e.type,e}):(t.type,t)})}function g(e,t){var n;return r("WAWebNetworkStatus").waitIfOffline().then(function(){return o("WAWebRelayClient").commitMutation(p,{input:t},{environmentType:"facebook",accessToken:e,getInlineDataReader:function(t){n=t}})}).then(function(e){var t;if(e==null)return m;var r=(t=e.xfb_whatsapp_catalog_add_product)==null?void 0:t.product;if(r==null)return m;var a=o("WAWebBizCatalogManagementParseProductGraphql").parseProductGraphQL(n(o("WAWebBizCatalogManagementParseProductGraphql").PARSE_PRODUCT_FRAGMENT,r));return{type:"success",productResult:a}}).catch(function(e){return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["addProductWithToken: failed with error"]))).devConsole(e),o("WAWebFetchAdAccountToken").hasGraphQLAuthError(e)?{type:"auth-failure"}:e instanceof o("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:e}:m})}l.addProduct=_}),98);
__d("WAWebCommonParsersCustomErrors",["WADeprecatedWapParser"],(function(t,n,r,o,a,i,l){var e=new(r("WADeprecatedWapParser"))("parseErrorFields",function(e){var t=[];return e.forEachChildWithTag("field",function(e){var n=e.hasAttr("detail")?e.maybeAttrString("detail"):null;t.push({name:e.attrString("name"),reason:e.attrString("reason"),detail:n})}),t});l.parseErrorFields=e}),98);
__d("WAWebBizCatalogAddProductJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebBizCatalogManagementAddProduct","WAWebBizCatalogManagementParseProductGraphql","WAWebBizCatalogParseProduct","WAWebBizGatingUtils","WAWebCommonParsersCustomErrors","WAWebMaybeThrowCatalogErrors","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e=new(r("WADeprecatedWapParser"))("addProductResponse",function(e){e.assertTag("iq"),e.assertFromServer();var t=e.child("product_catalog_add"),n=t.child("product");return o("WAWebBizCatalogParseProduct").parseProductNode(n)});function s(e,t,n){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){var a,i=(a=o("WAWap")).wap("iq",{id:a.generateId(),to:a.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog"},a.wap("product_catalog_add",{v:"1"},o("WAWebBizCatalogParseProduct").productModelToNode(t),a.wap("width",null,n.toString()),a.wap("height",null,r.toString()))),l=yield o("WADeprecatedSendIq").deprecatedSendIqErrorParser(i,e,o("WAWebCommonParsersCustomErrors").parseErrorFields);if(l.success)return l.result;throw l.errorCode===451?new(o("WAWebBackendErrors")).E451:l.customError!=null?new(o("WAWebBackendErrors")).CatalogEditServerError(l.errorCode,l.customError):new(o("WAWebBackendErrors")).ServerStatusCodeError(l.errorCode)}),u.apply(this,arguments)}function c(e,t,n){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a=o("WAWebUserPrefsMeUser").getMaybeMePnUser();if(a==null)throw r("err")("addProductGraphQL: meUser is null");var i=yield o("WAWebBizCatalogManagementAddProduct").addProduct({product:{biz_jid:a.toJid(),width:t,height:n,product_info:o("WAWebBizCatalogManagementParseProductGraphql").productModelToGraphQLInput(e)}});if(i.type==="success")return i.productResult;if(i.type==="graphql-error")o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(i.error);else{if(i.type==="recovery-required")return s(e,t,n);i.type}throw r("err")("addProductGraphQL: error handling flow not implemented for "+JSON.stringify(i))}),d.apply(this,arguments)}function m(e,t,n){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(o("WAWebBackendErrors")).E451;return o("WAWebBizGatingUtils").graphQLForAddProductEnabled()?c(e,t,n):s(e,t,n)}),p.apply(this,arguments)}l.addProductResponse=e,l.addProductMD=m}),98);
__d("WAWebBizCatalogManagementAppealProductMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="29276343172013990"}),null);
__d("WAWebBizCatalogManagementAppealProductMutation.graphql",["WAWebBizCatalogManagementAppealProductMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"input"}],concreteType:"XFBWhatsAppCatalogAppealProductResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_appeal_product",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"success",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementAppealProductMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebBizCatalogManagementAppealProductMutation",selections:t},params:{id:n("WAWebBizCatalogManagementAppealProductMutation_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementAppealProductMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("WAWebBizCatalogManagementAppealProduct",["Promise","WALogger","WAWebBizCatalogManagementAppealProductMutation.graphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m={type:"error"},p=e!==void 0?e:e=n("WAWebBizCatalogManagementAppealProductMutation.graphql");function _(e){return o("WAWebBizGatingUtils").graphQLForAppealProductEnabled()?f(e).then(function(e){return e.type==="success"?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["appealProduct: success"]))),e):(e.type,o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(['appealProduct: failed as "','"'])),e.type),e)}):(d||(d=n("Promise"))).resolve({type:"not-enabled"})}function f(e){return o("WAWebFetchAdAccountToken").fetchToken().then(function(t){return t.type==="success"?g(t.token,e).then(function(e){return e.type!=="success"&&e.type==="auth-failure"?o("WAWebFetchAdAccountToken").markTokenAsInvalid():e.type,e}):(t.type,t)})}function g(e,t){return r("WAWebNetworkStatus").waitIfOffline().then(function(){return o("WAWebRelayClient").commitMutation(p,{input:t},{environmentType:"facebook",accessToken:e})}).then(function(e){if(e==null)return m;var t=e.xfb_whatsapp_catalog_appeal_product;return(t==null?void 0:t.success)==null?m:{type:"success",result:t.success}}).catch(function(e){return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["appealProductWithToken: failed with error"]))).devConsole(e),o("WAWebFetchAdAccountToken").hasGraphQLAuthError(e)?{type:"auth-failure"}:e instanceof o("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:e}:m})}l.appealProduct=_}),98);
__d("WAWebBizCatalogAppealProductJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebBizCatalogManagementAppealProduct","WAWebBizGatingUtils","WAWebMaybeThrowCatalogErrors","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e=new(r("WADeprecatedWapParser"))("appealProductResponse",function(e){e.assertTag("iq"),e.assertFromServer();var t=e.child("response"),n=t.child("success");return n.contentString()==="true"});function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r,a=(r=o("WAWap")).wap("iq",{id:r.generateId(),to:r.S_WHATSAPP_NET,type:"set",xmlns:"fb:thrift_iq"},r.wap("request",{type:"appeal_product"},r.wap("reason",null,n),r.wap("id",null,t))),i=yield o("WADeprecatedSendIq").deprecatedSendIq(a,e);if(i.success)return i.result;throw i.errorCode===451?new(o("WAWebBackendErrors")).E451:new(o("WAWebBackendErrors")).ServerStatusCodeError(i.errorCode)}),u.apply(this,arguments)}function c(e,t){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WAWebUserPrefsMeUser").getMaybeMePnUser();if(n==null)throw r("err")("appealProductGraphQL: meUser is null");var a=yield o("WAWebBizCatalogManagementAppealProduct").appealProduct({jid:n.toJid(),product_id:e,reason:t});if(a.type==="success")return a.result;if(a.type==="graphql-error")o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(a.error);else{if(a.type==="recovery-required")return s(e,t);a.type}throw r("err")("appealProductGraphQL: error handling flow not implemented for "+JSON.stringify(a))}),d.apply(this,arguments)}function m(e,t){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(o("WAWebBackendErrors")).E451;return o("WAWebBizGatingUtils").graphQLForAppealProductEnabled()?c(e,t):s(e,t)}),p.apply(this,arguments)}l.appealProductMD=m}),98);
__d("WAWebBizCatalogManagementDeleteProductMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9376108569185474"}),null);
__d("WAWebBizCatalogManagementDeleteProductMutation.graphql",["WAWebBizCatalogManagementDeleteProductMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"input"}],concreteType:"XFBWhatsAppCatalogDeleteProductResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_delete_product",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"deleted_count",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementDeleteProductMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebBizCatalogManagementDeleteProductMutation",selections:t},params:{id:n("WAWebBizCatalogManagementDeleteProductMutation_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementDeleteProductMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("WAWebBizCatalogManagementDeleteProduct",["Promise","WALogger","WAWebBizCatalogManagementDeleteProductMutation.graphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m={type:"error"},p=e!==void 0?e:e=n("WAWebBizCatalogManagementDeleteProductMutation.graphql");function _(e){return o("WAWebBizGatingUtils").graphQLForDeleteProductEnabled()?f(e).then(function(e){return e.type==="success"?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["deleteProduct: success"]))),e):(e.type,o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(['deleteProduct: failed as "','"'])),e.type),e)}):(d||(d=n("Promise"))).resolve({type:"not-enabled"})}function f(e){return o("WAWebFetchAdAccountToken").fetchToken().then(function(t){return t.type==="success"?g(t.token,e).then(function(e){return e.type!=="success"&&e.type==="auth-failure"?o("WAWebFetchAdAccountToken").markTokenAsInvalid():e.type,e}):(t.type,t)})}function g(e,t){return r("WAWebNetworkStatus").waitIfOffline().then(function(){return o("WAWebRelayClient").commitMutation(p,{input:t},{environmentType:"facebook",accessToken:e})}).then(function(e){var t;if(e==null)return m;var n=(t=e.xfb_whatsapp_catalog_delete_product)==null?void 0:t.deleted_count;return n==null?m:{type:"success",deleteResult:{deletedCount:n}}}).catch(function(e){return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["deleteProductWithToken: failed with error"]))).devConsole(e),o("WAWebFetchAdAccountToken").hasGraphQLAuthError(e)?{type:"auth-failure"}:e instanceof o("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:e}:m})}l.deleteProduct=_}),98);
__d("WAWebBizCatalogDeleteProductsJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebBizCatalogManagementDeleteProduct","WAWebBizGatingUtils","WAWebMaybeThrowCatalogErrors","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e=new(r("WADeprecatedWapParser"))("productDeleteResponse",function(e){e.assertTag("iq"),e.assertFromServer();var t=e.child("product_catalog_delete"),n=t.attrInt("deleted_count");return{deletedCount:n}});function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n,r=(n=o("WAWap")).wap("iq",{id:n.generateId(),to:n.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog"},n.wap("product_catalog_delete",{v:"1"},t.map(function(e){return o("WAWap").wap("product",null,o("WAWap").wap("id",null,e))}))),a=yield o("WADeprecatedSendIq").deprecatedSendIq(r,e);if(a.success)return a.result;throw a.errorCode===451?new(o("WAWebBackendErrors")).E451:new(o("WAWebBackendErrors")).ServerStatusCodeError(a.errorCode)}),u.apply(this,arguments)}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebUserPrefsMeUser").getMaybeMePnUser();if(t==null)throw r("err")("deleteProductsGraphQL: meUser is null");var n=yield o("WAWebBizCatalogManagementDeleteProduct").deleteProduct({biz_jid:t.toJid(),product_ids:e});if(n.type==="success")return n.deleteResult;if(n.type==="graphql-error")o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(n.error);else{if(n.type==="recovery-required")return s(e);n.type}throw r("err")("deleteProductsGraphQL: error handling flow not implemented for "+JSON.stringify(n))}),d.apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(o("WAWebBackendErrors")).E451;return o("WAWebBizGatingUtils").graphQLForDeleteProductEnabled()?c(e):s(e)}),p.apply(this,arguments)}l.deleteProductsMD=m}),98);
__d("WAWebBizCatalogManagementEditProductMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9889773371084956"}),null);
__d("WAWebBizCatalogManagementEditProductMutation.graphql",["WAWebBizCatalogManagementEditProductMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{kind:"Variable",name:"request",variableName:"input"}],r={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},d=[l,c],m=[{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},r,o,{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[o,a,i],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[o,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},l,s,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null},s,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null}],storageKey:null},u,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},u],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:d,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[l,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[c,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[o,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},a,i],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:d,storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementEditProductMutation",selections:[{alias:null,args:t,concreteType:"XFBWhatsAppCatalogProductMutationResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_edit_product",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"product",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebBizCatalogManagementParseProductGraphql_product",selections:m,args:null,argumentDefinitions:[]}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebBizCatalogManagementEditProductMutation",selections:[{alias:null,args:t,concreteType:"XFBWhatsAppCatalogProductMutationResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_edit_product",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"product",plural:!1,selections:m,storageKey:null}],storageKey:null}]},params:{id:n("WAWebBizCatalogManagementEditProductMutation_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementEditProductMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("WAWebBizCatalogManagementEditProduct",["Promise","WALogger","WAWebBizCatalogManagementEditProductMutation.graphql","WAWebBizCatalogManagementParseProductGraphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m={type:"error"},p=e!==void 0?e:e=n("WAWebBizCatalogManagementEditProductMutation.graphql");function _(e){return o("WAWebBizGatingUtils").graphQLForEditProductEnabled()?f(e).then(function(e){return e.type==="success"?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["editProduct: success"]))),e):(e.type,o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(['editProduct: failed as "','"'])),e.type),e)}):(d||(d=n("Promise"))).resolve({type:"not-enabled"})}function f(e){return o("WAWebFetchAdAccountToken").fetchToken().then(function(t){return t.type==="success"?g(t.token,e).then(function(e){return e.type!=="success"&&e.type==="auth-failure"?o("WAWebFetchAdAccountToken").markTokenAsInvalid():e.type,e}):(t.type,t)})}function g(e,t){var n;return r("WAWebNetworkStatus").waitIfOffline().then(function(){return o("WAWebRelayClient").commitMutation(p,{input:t},{environmentType:"facebook",accessToken:e,getInlineDataReader:function(t){n=t}})}).then(function(e){var t;if(e==null)return m;var r=(t=e.xfb_whatsapp_catalog_edit_product)==null?void 0:t.product;if(r==null)return m;var a=o("WAWebBizCatalogManagementParseProductGraphql").parseProductGraphQL(n(o("WAWebBizCatalogManagementParseProductGraphql").PARSE_PRODUCT_FRAGMENT,r));return{type:"success",productResult:a}}).catch(function(e){return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["editProductWithToken: failed with error"]))).devConsole(e),o("WAWebFetchAdAccountToken").hasGraphQLAuthError(e)?{type:"auth-failure"}:e instanceof o("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:e}:m})}l.editProduct=_}),98);
__d("WAWebBizCatalogEditProductJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebBizCatalogManagementEditProduct","WAWebBizCatalogManagementParseProductGraphql","WAWebBizCatalogParseProduct","WAWebBizGatingUtils","WAWebCommonParsersCustomErrors","WAWebMaybeThrowCatalogErrors","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e=new(r("WADeprecatedWapParser"))("editProductResponse",function(e){e.assertTag("iq"),e.assertFromServer();var t=e.child("product_catalog_edit"),n=t.child("product");return o("WAWebBizCatalogParseProduct").parseProductNode(n)});function s(e,t,n){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){var a,i=(a=o("WAWap")).wap("iq",{id:a.generateId(),to:a.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog"},a.wap("product_catalog_edit",{v:"1"},o("WAWebBizCatalogParseProduct").productModelToNode(t),a.wap("width",null,n.toString()),a.wap("height",null,r.toString()))),l=yield o("WADeprecatedSendIq").deprecatedSendIqErrorParser(i,e,o("WAWebCommonParsersCustomErrors").parseErrorFields);if(l.success)return l.result;throw l.errorCode===451?new(o("WAWebBackendErrors")).E451:l.customError?new(o("WAWebBackendErrors")).CatalogEditServerError(l.errorCode,l.customError):new(o("WAWebBackendErrors")).ServerStatusCodeError(l.errorCode)}),u.apply(this,arguments)}function c(e,t,n){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a=o("WAWebUserPrefsMeUser").getMaybeMePnUser();if(a==null)throw r("err")("editProductGraphQL: meUser is null");var i=yield o("WAWebBizCatalogManagementEditProduct").editProduct({product:{biz_jid:a.toJid(),product_id:e.id.toString(),width:t,height:n,product_info:o("WAWebBizCatalogManagementParseProductGraphql").productModelToGraphQLInput(e)}});if(i.type==="success")return i.productResult;if(i.type==="graphql-error")o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(i.error);else{if(i.type==="recovery-required")return s(e,t,n);i.type}throw r("err")("editProductGraphQL: error handling flow not implemented for "+JSON.stringify(i))}),d.apply(this,arguments)}function m(e,t,n){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(o("WAWebBackendErrors")).E451;return o("WAWebBizGatingUtils").graphQLForEditProductEnabled()?c(e,t,n):s(e,t,n)}),p.apply(this,arguments)}l.default=m}),98);
__d("WAWebBizCatalogManagementUpdateProductVisibilityMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9665162096898581"}),null);
__d("WAWebBizCatalogManagementUpdateProductVisibilityMutation.graphql",["WAWebBizCatalogManagementUpdateProductVisibilityMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"input"}],concreteType:"XFBWhatsAppCatalogProductVisibilityUpdateResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_product_visibility_update",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"success",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementUpdateProductVisibilityMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebBizCatalogManagementUpdateProductVisibilityMutation",selections:t},params:{id:n("WAWebBizCatalogManagementUpdateProductVisibilityMutation_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementUpdateProductVisibilityMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("WAWebBizCatalogManagementUpdateProductVisibility",["Promise","WALogger","WAWebBizCatalogManagementUpdateProductVisibilityMutation.graphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m={type:"error"},p=e!==void 0?e:e=n("WAWebBizCatalogManagementUpdateProductVisibilityMutation.graphql");function _(e){return o("WAWebBizGatingUtils").graphQLForUpdateProductVisibilityEnabled()?f(e).then(function(e){return e.type==="success"?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["updateProductVisibility: success"]))),e):(e.type,o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(['updateProductVisibility: failed as "','"'])),e.type),e)}):(d||(d=n("Promise"))).resolve({type:"not-enabled"})}function f(e){return o("WAWebFetchAdAccountToken").fetchToken().then(function(t){return t.type==="success"?g(t.token,e).then(function(e){return e.type!=="success"&&e.type==="auth-failure"?o("WAWebFetchAdAccountToken").markTokenAsInvalid():e.type,e}):(t.type,t)})}function g(e,t){return r("WAWebNetworkStatus").waitIfOffline().then(function(){return o("WAWebRelayClient").commitMutation(p,{input:t},{environmentType:"facebook",accessToken:e})}).then(function(e){if(e==null)return m;var t=e.xfb_whatsapp_catalog_product_visibility_update;return t==null||(t==null?void 0:t.success)==null?m:{type:"success",result:t.success}}).catch(function(e){return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["updateProductVisibilityWithToken: failed with error"]))).devConsole(e),o("WAWebFetchAdAccountToken").hasGraphQLAuthError(e)?{type:"auth-failure"}:e instanceof o("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:e}:m})}l.updateProductVisibility=_}),98);
__d("WAWebBizCatalogProductVisibilitySetJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWapDeprecatedSmaxID","WAWebBackendErrors","WAWebBizCatalogManagementUpdateProductVisibility","WAWebBizGatingUtils","WAWebMaybeThrowCatalogErrors","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e=new(r("WADeprecatedWapParser"))("visibilitySetResponse",function(e){e.assertTag("iq"),e.assertFromServer()});function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var a,i=(a=o("WAWap")).wap("iq",{to:a.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog",smax_id:a.SMAX_ID(r("WAWapDeprecatedSmaxID").SetCatalogVisibility),id:a.generateId()},a.wap("product_visibility_update",{v:"1"},a.wap("product",{is_hidden:n?"true":"false"},o("WAWap").wap("id",null,t)))),l=yield o("WADeprecatedSendIq").deprecatedSendIq(i,e);if(l.success)return l.result;throw l.errorCode===451?new(o("WAWebBackendErrors")).E451:new(o("WAWebBackendErrors")).ServerStatusCodeError(l.errorCode)}),u.apply(this,arguments)}function c(e){throw r("err")("updateProductVisibilityGraphQL: error handling flow not implemented for "+JSON.stringify(e))}function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WAWebUserPrefsMeUser").getMaybeMePnUser();if(n==null)throw r("err")("updateProductVisibilityGraphQL: meUser is null");var a=yield o("WAWebBizCatalogManagementUpdateProductVisibility").updateProductVisibility({jid:n.toJid(),products:[{product_id:e,is_hidden:t}]});if(a.type==="success")return a.result===!0?void 0:c(a);if(a.type==="graphql-error")o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(a.error);else return a.type==="recovery-required"?s(e,t):(a.type,c(a))}),m.apply(this,arguments)}function p(e,t){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(o("WAWebBackendErrors")).E451;return o("WAWebBizGatingUtils").graphQLForUpdateProductVisibilityEnabled()?d(e,t):s(e,t)}),_.apply(this,arguments)}l.default=p}),98);
__d("WAWebBizCatalogManagementCreateCatalogMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="29232780583035464"}),null);
__d("WAWebBizCatalogManagementCreateCatalogMutation.graphql",["WAWebBizCatalogManagementCreateCatalogMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"input"}],concreteType:"XFBWhatsAppCatalogCreateResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_create",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"success",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementCreateCatalogMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebBizCatalogManagementCreateCatalogMutation",selections:t},params:{id:n("WAWebBizCatalogManagementCreateCatalogMutation_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementCreateCatalogMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("WAWebBizCatalogManagementCreateCatalog",["Promise","WALogger","WAWebBizCatalogManagementCreateCatalogMutation.graphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m={type:"error"},p=e!==void 0?e:e=n("WAWebBizCatalogManagementCreateCatalogMutation.graphql");function _(e){return o("WAWebBizGatingUtils").graphQLForCreateProductCatalogEnabled()?f(e).then(function(e){return e.type==="success"?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["createCatalog: success"]))),e):(e.type,o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(['createCatalog: failed as "','"'])),e.type),e)}):(d||(d=n("Promise"))).resolve({type:"not-enabled"})}function f(e){return o("WAWebFetchAdAccountToken").fetchToken().then(function(t){return t.type==="success"?g(t.token,e).then(function(e){return e.type!=="success"&&e.type==="auth-failure"?o("WAWebFetchAdAccountToken").markTokenAsInvalid():e.type,e}):(t.type,t)})}function g(e,t){return r("WAWebNetworkStatus").waitIfOffline().then(function(){return o("WAWebRelayClient").commitMutation(p,{input:t},{environmentType:"facebook",accessToken:e})}).then(function(e){var t;if(e==null)return m;var n=(t=e.xfb_whatsapp_catalog_create)==null?void 0:t.success;return n==null?m:{type:"success",createResult:n}}).catch(function(e){return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["createCatalogWithToken: failed with error"]))).devConsole(e),o("WAWebFetchAdAccountToken").hasGraphQLAuthError(e)?{type:"auth-failure"}:e instanceof o("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:e}:m})}l.createCatalog=_}),98);
__d("WAWebBizCreateProductCatalogJob",["WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WAWap","WAWebBackendErrors","WAWebBizCatalogManagementCreateCatalog","WAWebBizGatingUtils","WAWebMaybeThrowCatalogErrors","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s=new(r("WADeprecatedWapParser"))("productCatalogCreateResponse",function(e){e.assertTag("iq"),e.assertFromServer(),e.child("product_catalog_create")});function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e,t=(e=o("WAWap")).wap("iq",{id:e.generateId(),to:e.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog"},e.wap("product_catalog_create",{version:"1"})),n=yield o("WADeprecatedSendIq").deprecatedSendIq(t,s);if(n.success)return n.result;throw n.errorCode===451?new(o("WAWebBackendErrors")).E451:new(o("WAWebBackendErrors")).ServerStatusCodeError(n.errorCode)}),c.apply(this,arguments)}function d(){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=o("WAWebUserPrefsMeUser").getMaybeMePnUser();if(t==null)throw r("err")("createProductCatalogGraphQL: meUser is null");var n=yield o("WAWebBizCatalogManagementCreateCatalog").createCatalog({product_catalog:{biz_jid:t.toJid()},platform:"WEB"});if(n.type!=="success")return n.type==="graphql-error"?o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(n.error):n.type,o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["createProductCatalogGraphQL: error handling flow not implemented for ",""])),JSON.stringify(n)),u()}),m.apply(this,arguments)}function p(){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(o("WAWebBackendErrors")).E451;return o("WAWebBizGatingUtils").graphQLForCreateProductCatalogEnabled()?d():u()}),_.apply(this,arguments)}l.productCatalogCreateResponse=s,l.createProductCatalog=p}),98);
__d("WAWebBizCatalogManagementFetchCatalogQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9957894520961099"}),null);
__d("WAWebBizCatalogManagementFetchCatalogQuery.graphql",["WAWebBizCatalogManagementFetchCatalogQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"request"}],t=[{kind:"Variable",name:"request",variableName:"request"}],r={alias:null,args:null,kind:"ScalarField",name:"catalog_type",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"catalog_id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"catalog_name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},_=[c,p],f=[{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},i,l,{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[l,s,u],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},c,d,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null},d,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null}],storageKey:null},m,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},m],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:_,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[c,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[p,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[l,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},s,u],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:_,storageKey:null}],storageKey:null}],g={alias:null,args:null,concreteType:"XFBWhatsAppCatalogPagingInfo",kind:"LinkedField",name:"paging",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"before",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"after",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementFetchCatalogQuery",selections:[{alias:null,args:t,concreteType:"XFBWhatsAppCatalogGetResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogGetResponseProductCatalog",kind:"LinkedField",name:"product_catalog",plural:!1,selections:[r,o,a,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"products",plural:!0,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebBizCatalogManagementParseProductGraphql_product",selections:f,args:null,argumentDefinitions:[]}],storageKey:null},g],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebBizCatalogManagementFetchCatalogQuery",selections:[{alias:null,args:t,concreteType:"XFBWhatsAppCatalogGetResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogGetResponseProductCatalog",kind:"LinkedField",name:"product_catalog",plural:!1,selections:[r,o,a,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"products",plural:!0,selections:f,storageKey:null},g],storageKey:null}],storageKey:null}]},params:{id:n("WAWebBizCatalogManagementFetchCatalogQuery_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementFetchCatalogQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebBizCatalogManagementFetchCatalog",["Promise","WALogger","WAWebBizCatalogManagementFetchCatalogQuery.graphql","WAWebBizCatalogManagementParseProductGraphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m={type:"error"},p=e!==void 0?e:e=n("WAWebBizCatalogManagementFetchCatalogQuery.graphql");function _(e){return o("WAWebBizGatingUtils").graphQLForGetProductCatalogEnabled()?f(e).then(function(e){return e.type==="success"?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["fetchCatalog: success"]))),e):(e.type,o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(['fetchCatalog: failed as "','"'])),e.type),e)}):(d||(d=n("Promise"))).resolve({type:"not-enabled"})}function f(e){return o("WAWebFetchAdAccountToken").fetchToken().then(function(t){return t.type==="success"?g(t.token,e).then(function(e){return e.type!=="success"&&e.type==="auth-failure"?o("WAWebFetchAdAccountToken").markTokenAsInvalid():e.type,e}):(t.type,t)})}function g(e,t){var n;return r("WAWebNetworkStatus").waitIfOffline().then(function(){return o("WAWebRelayClient").fetchQuery(p,{request:t},{environmentType:"facebook",accessToken:e,getInlineDataReader:function(t){n=t}})}).then(function(e){var t,r,a;if(e==null)return m;var i=(t=e.xfb_whatsapp_catalog)==null?void 0:t.product_catalog;if(i==null)return m;var l=i.products,s=i.paging,u=(r=s==null?void 0:s.before)!=null?r:"",c=(a=s==null?void 0:s.after)!=null?a:"",d=l.map(function(e){return n(o("WAWebBizCatalogManagementParseProductGraphql").PARSE_PRODUCT_FRAGMENT,e)}).map(o("WAWebBizCatalogManagementParseProductGraphql").parseProductGraphQL);return{type:"success",catalog:{data:d,catalog_id:i.catalog_id,catalog_name:i.catalog_name,catalog_type:i.catalog_type,paging:{cursors:{before:u,after:c}}}}}).catch(function(e){return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["fetchCatalogWithToken: failed with error"]))).devConsole(e),o("WAWebFetchAdAccountToken").hasGraphQLAuthError(e)?{type:"auth-failure"}:e instanceof o("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:e}:m})}l.fetchCatalog=_}),98);
__d("WAWebQueryCatalogQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"request"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},s=[n,l],u=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"request"}],concreteType:"XWAProductCatalogGetResponseSuccess",kind:"LinkedField",name:"xwa_product_catalog_get_product_catalog",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogGetResponseSuccessProductCatalog",kind:"LinkedField",name:"product_catalog",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogProduct",kind:"LinkedField",name:"products",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},n,r,{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},o,{alias:null,args:null,concreteType:"XWAProductCatalogProductStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[o,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[t,a,i],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XWAVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:s,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[n,{alias:null,args:null,concreteType:"XWACatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[l,{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[t,{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},a,i],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:s,storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogPaging",kind:"LinkedField",name:"paging",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"before",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"after",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebQueryCatalogQuery",selections:u,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebQueryCatalogQuery",selections:u},params:{id:"9916553288394782",metadata:{},name:"WAWebQueryCatalogQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebQueryCatalog",["WALogger","WAWebBackendErrors","WAWebBizCatalogManagementFetchCatalog","WAWebBizGatingUtils","WAWebBizParseProductGraphql","WAWebCatalogEventLogger","WAWebGraphQLServerError","WAWebMaybeThrowCatalogErrors","WAWebQueryCatalogQuery.graphql","WAWebRelayClient","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(o("WAWebBackendErrors")).E451;try{var r,a,i,l=t.catalogWid,u=t.afterCursor,c=t.limit,d=t.width,m=t.height,p=t.checkmarkCollectionId,_=t.allowShopSource,f=t.directConnectionEncryptedInfo,g=t.variantInfoFields,h=t.variantThumbnailHeight,y=t.variantThumbnailWidth,C=yield o("WAWebRelayClient").fetchQuery(e!==void 0?e:e=n("WAWebQueryCatalogQuery.graphql"),{request:{product_catalog:{jid:l.toString(),allow_shop_source:_?"ALLOWSHOPSOURCE_TRUE":"ALLOWSHOPSOURCE_FALSE",width:String(d),height:String(m),direct_connection_encrypted_info:f,limit:String(c),after:u,catalog_session_id:p,variant_info_fields:g,variant_thumbnail_height:h!=null?String(h):null,variant_thumbnail_width:y!=null?String(y):null}}},{eventLogger:o("WAWebCatalogEventLogger").createCatalogEventLogger(o("WAWebCatalogEventLogger").GRAPHQL_CATALOG_ENDPOINT.GET_CATALOG)}),b=C==null||(r=C.xwa_product_catalog_get_product_catalog)==null?void 0:r.product_catalog;if(b==null)return{data:[],catalog_id:null,catalog_name:null,catalog_type:null,paging:{cursors:{after:"",before:""}}};var v=b.paging,S=b.products;return{data:S.map(o("WAWebBizParseProductGraphql").parseProductGraphQL),catalog_id:null,catalog_name:null,catalog_type:null,paging:{cursors:{before:(a=v==null?void 0:v.before)!=null?a:"",after:(i=v==null?void 0:v.after)!=null?i:""}}}}catch(e){throw e instanceof o("WAWebGraphQLServerError").GraphQLServerError&&o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(e),o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["GraphQL: Failed fetching xwa_product_catalog_get_product_catalog query."]))),new(o("WAWebBackendErrors")).CatalogUnknownError}});return function(n){return t.apply(this,arguments)}})(),d=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.catalogWid,n=e.afterCursor,r=e.limit,a=e.width,i=e.height,l=e.checkmarkCollectionId,s=e.allowShopSource,c=e.directConnectionEncryptedInfo,d=c===void 0?null:c,m=e.variantInfoFields,p=e.variantThumbnailHeight,_=e.variantThumbnailWidth;if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(o("WAWebBackendErrors")).E451;var f=yield o("WAWebBizCatalogManagementFetchCatalog").fetchCatalog({product_catalog:{jid:t.toJid(),after:n,limit:String(r),width:String(a),height:String(i),belongs_to:{collection_id:l},allow_shop_source:s,direct_connection_encrypted_info:d,variant_info_fields:m,variant_thumbnail_height:p!=null?String(p):null,variant_thumbnail_width:_!=null?String(_):null},platform:"WEB"});if(f.type==="success")return f.catalog;throw f.type==="graphql-error"?o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(f.error,o("WAWebMaybeThrowCatalogErrors").ErrorSourceForCatalogQuery.GET_PRODUCT_CATALOG_OWNER_GRAPHQL):f.type,f.type==="recovery-required"&&o("WAWebBizGatingUtils").catalogTokenRecoveryEnabled()?new(o("WAWebBackendErrors")).AdAccountRecoveryRequiredError(f.emailMask):f.type==="incorrect-nonce"&&o("WAWebBizGatingUtils").catalogTokenRecoveryEnabled()?new(o("WAWebBackendErrors")).CatalogIncorrectNonceError:(o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["queryCatalogGraphQLByOwner: error handling flow not implemented for ",""])),JSON.stringify(f)),new(o("WAWebBackendErrors")).CatalogUnknownError)});return function(n){return e.apply(this,arguments)}})(),m=function(t){var e=o("WAWebUserPrefsMeUser").getMaybeMePnUser();return e!=null&&e.equals(t.catalogWid)?d(t):c(t)},p=m;l.default=p}),98);
__d("WAWebQueryCatalogHasCategoriesQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"request"}],t=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"request"}],concreteType:"XWAProductCatalogGetCategoriesResponseSuccess",kind:"LinkedField",name:"xwa_product_catalog_get_categories",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogGetCategoriesResponseSuccessCategoryWithSubCategories",kind:"LinkedField",name:"categories",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebQueryCatalogHasCategoriesQuery",selections:t,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebQueryCatalogHasCategoriesQuery",selections:t},params:{id:"9759957480718978",metadata:{},name:"WAWebQueryCatalogHasCategoriesQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebQueryCatalogHasCategories",["errorCode","WALogger","WAWebCatalogEventLogger","WAWebGraphQLServerError","WAWebMaybeThrowCatalogErrors","WAWebQueryCatalogHasCategoriesQuery.graphql","WAWebRelayClient","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l,s){var e,u,c=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=t.catalogWid,a=t.directConnectionEncryptedInfo,i=t.imageDimensions,l=i===void 0?{width:100,height:100}:i,s=t.sessionId;try{var c,d=yield o("WAWebRelayClient").fetchQuery(e!==void 0?e:e=n("WAWebQueryCatalogHasCategoriesQuery.graphql"),{request:{categories:{biz_jid:r.toString(),direct_connection_encrypted_info:a,image_dimensions:l,catalog_session_id:s}}},{eventLogger:o("WAWebCatalogEventLogger").createCatalogEventLogger(o("WAWebCatalogEventLogger").GRAPHQL_CATALOG_ENDPOINT.GET_CATEGORIES)});return!!(!(d==null||(c=d.xwa_product_catalog_get_categories)==null)&&c.categories.length)}catch(e){if(e instanceof o("WAWebGraphQLServerError").GraphQLServerError){var m=e.source.errors||[],p=m[0];if((p==null?void 0:p.code)===2498052)return!1;o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(e)}return o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["GraphQL: Failed fetching xwa_product_catalog_get_categories query."]))),!1}});return function(n){return t.apply(this,arguments)}})();l.queryCatalogHasCategories=c}),98);
__d("WAWebBizCatalogManagementFetchProductQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="24529100180014015"}),null);
__d("WAWebBizCatalogManagementFetchProductQuery.graphql",["WAWebBizCatalogManagementFetchProductQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"request"}],t=[{kind:"Variable",name:"request",variableName:"request"}],r={alias:null,args:null,kind:"ScalarField",name:"catalog_id",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"catalog_type",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},p=[u,m],_=[{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},a,i,{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[i,l,s],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},u,c,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null},c,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null}],storageKey:null},d,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},d],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:p,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[u,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[m,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[i,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},l,s],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:p,storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementFetchProductQuery",selections:[{alias:null,args:t,concreteType:"XFBWhatsAppCatalogGetProductResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_product",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogGetProductResponseProductCatalog",kind:"LinkedField",name:"product_catalog",plural:!1,selections:[r,o,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"product",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebBizCatalogManagementParseProductGraphql_product",selections:_,args:null,argumentDefinitions:[]}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebBizCatalogManagementFetchProductQuery",selections:[{alias:null,args:t,concreteType:"XFBWhatsAppCatalogGetProductResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_product",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogGetProductResponseProductCatalog",kind:"LinkedField",name:"product_catalog",plural:!1,selections:[r,o,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"product",plural:!1,selections:_,storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:n("WAWebBizCatalogManagementFetchProductQuery_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementFetchProductQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebBizCatalogManagementFetchProduct",["Promise","WALogger","WAWebBizCatalogManagementFetchProductQuery.graphql","WAWebBizCatalogManagementParseProductGraphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m={type:"error"},p=e!==void 0?e:e=n("WAWebBizCatalogManagementFetchProductQuery.graphql");function _(e){return o("WAWebBizGatingUtils").graphQLForGetProductEnabled()?f(e).then(function(e){return e.type==="success"?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["fetchProduct: success"]))),e):(e.type,o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(['fetchProduct: failed as "','"'])),e.type),e)}):(d||(d=n("Promise"))).resolve({type:"not-enabled"})}function f(e){return o("WAWebFetchAdAccountToken").fetchToken().then(function(t){return t.type==="success"?g(t.token,e).then(function(e){return e.type!=="success"&&e.type==="auth-failure"?o("WAWebFetchAdAccountToken").markTokenAsInvalid():e.type,e}):(t.type,t)})}function g(e,t){var n;return r("WAWebNetworkStatus").waitIfOffline().then(function(){return o("WAWebRelayClient").fetchQuery(p,{request:t},{environmentType:"facebook",accessToken:e,getInlineDataReader:function(t){n=t}})}).then(function(e){var t,r,a;if(e==null)return m;var i=(t=e.xfb_whatsapp_catalog_product)==null||(t=t.product_catalog)==null?void 0:t.product;if(i==null)return m;var l=o("WAWebBizCatalogManagementParseProductGraphql").parseProductGraphQL(n(o("WAWebBizCatalogManagementParseProductGraphql").PARSE_PRODUCT_FRAGMENT,i));return{type:"success",productResult:{data:l,catalog_id:(r=e.xfb_whatsapp_catalog_product)==null||(r=r.product_catalog)==null?void 0:r.catalog_id,catalog_type:(a=e.xfb_whatsapp_catalog_product)==null||(a=a.product_catalog)==null?void 0:a.catalog_type}}}).catch(function(e){return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["fetchProductWithToken: failed with error"]))).devConsole(e),o("WAWebFetchAdAccountToken").hasGraphQLAuthError(e)?{type:"auth-failure"}:e instanceof o("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:e}:m})}l.fetchProduct=_}),98);
__d("WAWebQueryCatalogProductQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"request"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},s=[n,l],u=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"request"}],concreteType:"XWAProductCatalogGetProductResponseSuccess",kind:"LinkedField",name:"xwa_product_catalog_get_product",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogGetProductResponseSuccessProductCatalog",kind:"LinkedField",name:"product_catalog",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogProduct",kind:"LinkedField",name:"product",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},n,r,{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},o,{alias:null,args:null,concreteType:"XWAProductCatalogProductStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[o,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[t,a,i],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XWAVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:s,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[n,{alias:null,args:null,concreteType:"XWACatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[l,{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[t,{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},a,i],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:s,storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebQueryCatalogProductQuery",selections:u,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebQueryCatalogProductQuery",selections:u},params:{id:"9647868451963105",metadata:{},name:"WAWebQueryCatalogProductQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebQueryCatalogProduct",["errorCode","WALogger","WANullthrows","WAWebBackendErrors","WAWebBizCatalogManagementFetchProduct","WAWebBizGatingUtils","WAWebBizParseProductGraphql","WAWebCatalogEventLogger","WAWebGraphQLServerError","WAWebMaybeThrowCatalogErrors","WAWebQueryCatalogProductQuery.graphql","WAWebRelayClient","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l,s){var e,u,c,d=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(o("WAWebBackendErrors")).E451;for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];var l=a[0],s=a[1],c=a[2],d=a[3],m=a[4],p=m===void 0?!1:m,_=a[5],f=_===void 0?null:_,g=a[6],h=a[7],y=a[8];try{var C,b=yield o("WAWebRelayClient").fetchQuery(e!==void 0?e:e=n("WAWebQueryCatalogProductQuery.graphql"),{request:{product:{jid:l.toString(),product_id:s,width:String(c),height:String(d),fetch_compliance_info:String(p),direct_connection_encrypted_info:f,variant_info_fields:g,variant_thumbnail_height:h!=null?String(h):null,variant_thumbnail_width:y!=null?String(y):null}}},{eventLogger:o("WAWebCatalogEventLogger").createCatalogEventLogger(o("WAWebCatalogEventLogger").GRAPHQL_CATALOG_ENDPOINT.GET_PRODUCT)}),v=r("WANullthrows")(b==null||(C=b.xwa_product_catalog_get_product)==null||(C=C.product_catalog)==null?void 0:C.product);return{data:o("WAWebBizParseProductGraphql").parseProductGraphQL(v),catalog_id:null,catalog_type:null}}catch(e){if(e instanceof o("WAWebGraphQLServerError").GraphQLServerError){var S,R=((S=e.source)==null?void 0:S.errors)||[],L=R[0];if((L==null?void 0:L.code)===2498052)return{error:"NOT_FOUND"};o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(e)}throw o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["GraphQL: Failed fetching xwa_product_catalog_get_product query."]))),new(o("WAWebBackendErrors")).CatalogUnknownError}});return function(){return t.apply(this,arguments)}})(),m=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(o("WAWebBackendErrors")).E451;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],a=t[1],i=t[2],l=t[3],s=t[4],u=s===void 0?!1:s,d=t[5],m=d===void 0?null:d,p=t[6],_=t[7],f=t[8],g=yield o("WAWebBizCatalogManagementFetchProduct").fetchProduct({product:{jid:r.toJid(),product_id:a,width:String(i),height:String(l),direct_connection_encrypted_info:m,fetch_compliance_info:String(u),variant_info_fields:p,variant_thumbnail_height:_!=null?String(_):null,variant_thumbnail_width:f!=null?String(f):null}});if(g.type==="success")return g.productResult;if(g.type==="graphql-error"){var h,y=(h=g.error.source)==null?void 0:h.errors,C=y[0];if((C==null?void 0:C.code)===2498052)return{error:"NOT_FOUND"};o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(g.error)}else if(g.type==="recovery-required"){if(o("WAWebBizGatingUtils").catalogTokenRecoveryEnabled())throw new(o("WAWebBackendErrors")).AdAccountRecoveryRequiredError(g.emailMask)}else if(g.type==="incorrect-nonce"){if(o("WAWebBizGatingUtils").catalogTokenRecoveryEnabled())throw new(o("WAWebBackendErrors")).CatalogIncorrectNonceError}else g.type;throw o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["queryCatalogProductGraphQLByOwner: error handling flow not implemented for ",""])),JSON.stringify(g)),new(o("WAWebBackendErrors")).CatalogUnknownError});return function(){return e.apply(this,arguments)}})(),p=function(){for(var e=o("WAWebUserPrefsMeUser").getMaybeMePnUser(),t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=n[0];return e!=null&&e.equals(a)?m.apply(void 0,n):d.apply(void 0,n)},_=p;l.default=_}),98);
__d("WAWebReportProductJobMutation.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"input"}],concreteType:"XWAWhatsAppCatalogReportProductResponse",kind:"LinkedField",name:"xwa_whatsapp_catalog_report_product",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"success",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebReportProductJobMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebReportProductJobMutation",selections:t},params:{id:"WAWebReportProductJobMutation",metadata:{},name:"WAWebReportProductJobMutation",operationKind:"mutation",text:null}}})();e.hash="a344b224fc28492489aa97287055b47e",a.exports=e}),null);
__d("WAWebReportProductJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebBizGatingUtils","WAWebCommsWapMd","WAWebGraphQLServerError","WAWebMaybeThrowCatalogErrors","WAWebRelayClient","WAWebReportProductJobMutation.graphql","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=new(r("WADeprecatedWapParser"))("reportProductResponse",function(e){e.assertTag("iq"),e.assertAttr("type","result")});function u(e,t,n){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r,a=(r=o("WAWap")).wap("iq",{to:r.S_WHATSAPP_NET,xmlns:"fb:thrift_iq",type:"set",id:r.generateId()},r.wap("request",{type:"report_product",biz_jid:o("WAWebCommsWapMd").USER_JID(e)},n?o("WAWap").wap("reason",null,n):void 0,o("WAWap").wap("id",null,t))),i=yield o("WADeprecatedSendIq").deprecatedSendIq(a,s);if(!i.success)throw i.errorCode===451?new(o("WAWebBackendErrors")).E451:new(o("WAWebBackendErrors")).ServerStatusCodeError(i.errorCode)}),c.apply(this,arguments)}var d=e!==void 0?e:e=n("WAWebReportProductJobMutation.graphql");function m(e,t,n){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r={jid:e.toJid(),product_id:t};return n!==""&&(r.reason=n),o("WAWebRelayClient").commitMutation(d,{input:r}).then(function(e){var t,n=e==null||(t=e.xwa_whatsapp_catalog_report_product)==null?void 0:t.success;if(n!==!0)throw new(o("WAWebBackendErrors")).ServerStatusCodeError(500)}).catch(function(e){e instanceof o("WAWebGraphQLServerError").GraphQLServerError&&o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(e)})}),p.apply(this,arguments)}function _(e,t,n){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(o("WAWebBackendErrors")).E451;return o("WAWebBizGatingUtils").graphQLForReportProductEnabled()?m(e,t,n):u(e,t,n)}),f.apply(this,arguments)}l.default=_}),98);
__d("WAWebBizProductCatalogBridge",["Promise","WALogger","WAWeb-moment","WAWebBackendErrors","WAWebBizCatalogAddProductJob","WAWebBizCatalogAppealProductJob","WAWebBizCatalogDeleteProductsJob","WAWebBizCatalogEditProductJob","WAWebBizCatalogProductVisibilitySetJob","WAWebBizCreateProductCatalogJob","WAWebBizGatingUtils","WAWebBizLogQplEvents","WAWebBusinessDirectConnectionBridge","WAWebNoop","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebProductTypes.flow","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebQueryCatalog","WAWebQueryCatalogHasCategories","WAWebQueryCatalogProduct","WAWebReportProductJob","WAWebWidFactory"],(function(t,n,r,o,a,i,l){var e,s,u,c,d;function m(e,t,n,a,i,l,s,u,c){l===!0&&o("WAWebBizLogQplEvents").qplPointProductView("datasource_start");var d=o("WAWebBusinessDirectConnectionBridge").attemptWithDirectConnectionRetry(e,function(o){return r("WAWebQueryCatalogProduct")(e,t,n,a,i,o,s,u,c)});return d.then(function(){return l===!0&&o("WAWebBizLogQplEvents").qplPointProductView("datasource_end")}).catch(r("WAWebNoop")),o("WAWebBackendErrors").attachErrorLogger(d,"Query product failed")}function p(t,a,i,l,u,c,m,p,_,f){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())return(d||(d=n("Promise"))).reject(new(o("WAWebBackendErrors")).E451);var g=o("WAWebBusinessDirectConnectionBridge").attemptWithDirectConnectionRetry(t,function(e){return r("WAWebQueryCatalog")({catalogWid:t,afterCursor:a,limit:i,width:l,height:u,checkmarkCollectionId:c,allowShopSource:m,directConnectionEncryptedInfo:e,variantInfoFields:p,variantThumbnailHeight:_,variantThumbnailWidth:f})});return g.catch(function(t){throw t instanceof o("WAWebBackendErrors").ServerStatusCodeError&&t.statusCode===404?t:t.errorCode===451?(o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Query catalog failed, error: 451"]))).verbose().sendLogs("Query catalog failed, commerce-features-disabled"),new(o("WAWebBackendErrors")).E451):(o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Query catalog failed, error: ",""])),t).verbose().devConsole(t).sendLogs("Query catalog failed"),t)})}function _(e,t,r,a,i){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())return(d||(d=n("Promise"))).reject(new(o("WAWebBackendErrors")).E451);i&&o("WAWebBizLogQplEvents").qplPointPLMDetailsView("datasource_start");var l=o("WAWebBusinessDirectConnectionBridge").attemptWithDirectConnectionRetry(e,function(n){return o("WAWebPersistedJobManager").getJobManager().waitUntilCompleted(o("WAWebPersistedJobDefinitions").jobSerializers.queryProductList(e,t,n,r,a))});return l.then(function(){return i&&o("WAWebBizLogQplEvents").qplPointPLMDetailsView("datasource_end")}).catch(function(e){if(e.errorCode===451)throw new(o("WAWebBackendErrors")).E451}),l}function f(e){return o("WAWebBusinessDirectConnectionBridge").attemptWithDirectConnectionRetry(e,function(t){return o("WAWebQueryCatalogHasCategories").queryCatalogHasCategories({catalogWid:e,directConnectionEncryptedInfo:t})})}function g(e,t,n){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_REPORT,"datasource_start");var a=r("WAWebReportProductJob")(e,t,n);return a.then(function(){return o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_REPORT,"datasource_end")}).catch(r("WAWebNoop")),o("WAWebBackendErrors").attachErrorLogger(a,"Report product failed")}function h(e,t){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_APPEAL,"datasource_start");var n=o("WAWebBizCatalogAppealProductJob").appealProductMD(e,t);return n.then(function(){return o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_APPEAL,"datasource_end")}).catch(r("WAWebNoop")),o("WAWebBackendErrors").attachErrorLogger(n,"Appeal product failed")}function y(){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_CATALOG_CREATE,"datasource_start");var e=o("WAWebBizCreateProductCatalogJob").createProductCatalog();return e.then(function(){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_CATALOG_CREATE,"datasource_end")}).catch(r("WAWebNoop")),o("WAWebBackendErrors").attachErrorLogger(e,"Create catalog failed")}function C(e,t,n){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,"datasource_start");var a=o("WAWebBizCatalogAddProductJob").addProductMD(e,t,n);return a.then(function(){return o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,"datasource_end")}).catch(r("WAWebNoop")),a.then(L).catch(function(e){throw e instanceof o("WAWebBackendErrors").ServerStatusCodeError&&e.statusCode===406||e instanceof o("WAWebBackendErrors").CatalogEditServerError&&e.statusCode===406||o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Add product failed, error: ",""])),e).verbose().devConsole(e).sendLogs("Add product failed"),e})}function b(e,t,n){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,"datasource_start");var a=r("WAWebBizCatalogEditProductJob")(e,t,n);return a.then(function(e){return o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,"datasource_end")}).catch(r("WAWebNoop")),a.then(L).catch(function(e){throw e instanceof o("WAWebBackendErrors").ServerStatusCodeError&&e.statusCode===406||e instanceof o("WAWebBackendErrors").CatalogEditServerError&&e.statusCode===406||o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Edit product failed, error: ",""])),e).verbose().devConsole(e).sendLogs("Edit product failed"),e})}function v(e){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_DELETE,"datasource_start");var t=o("WAWebBizCatalogDeleteProductsJob").deleteProductsMD(e),n=t.then(function(e){return o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_DELETE,"datasource_end"),e});return o("WAWebBackendErrors").attachErrorLogger(n,"Delete product failed")}function S(e){return e==null?null:parseInt(e,10)}function R(e){return e!=null&&e!==""?r("WAWeb-moment").utc(e,r("WAWeb-moment").ISO_8601).valueOf():null}function L(e,t){var n,r,a,i=((n=e.capability_to_review_status[0])==null?void 0:n.value)||"APPROVED",l={catalogWid:t,id:e.id,isHidden:e.is_hidden||!1,isSanctioned:e.is_sanctioned||!1,url:e.url||"",name:e.name,description:e.description||"",availability:(r=o("WAWebProductTypes.flow").ProductAvailability.cast(e.availability))!=null?r:o("WAWebProductTypes.flow").ProductAvailability.UNKNOWN,maxAvailable:e.max_available,additionalImageCdnUrl:e.additional_image_cdn_urls.map(function(e){return e[1].value}),additionalImageHashes:e.image_hashes_for_whatsapp.slice(1),imageCdnUrl:e.image_cdn_urls[1].value,imageHash:e.image_hashes_for_whatsapp[0],reviewStatus:i,currency:e.currency,priceAmount1000:S(e.price),salePriceAmount1000:S(e.sale_price),salePriceStartDate:R(e.sale_start_date),salePriceEndDate:R(e.sale_end_date),retailerId:e.retailer_id||"",productMsgMediaData:null,imageCount:e.additional_image_cdn_urls.length+1,fetchedFromServer:!0,videos:(a=e.videos)==null?void 0:a.map(function(e){return{thumbnail_url:e.thumbnail_url,original_video_url:e.original_video_url,id:e.id}}),t:Date.now()/1e3,old:!1,canAppeal:e.whatsapp_product_can_appeal,checkmark:e.checkmark,importerInformationExempt:!!e.importer_information_exempt,variantInfo:e.variant_info,displayPriority:0};return e.compliance_info&&(l.complianceInfo=I(e.compliance_info)),e.signedShimmedUrl!=null&&(l.signedShimmedUrl=e.signedShimmedUrl),l}function E(e){var t;return e.businessOwnerJid!=null&&e.businessOwnerJid!==""&&(t=o("WAWebWidFactory").createWid(e.businessOwnerJid)),{catalogWid:t,id:e.productId||"",url:e.url,name:e.title,description:e.description,imageCdnUrl:e.mediaData.renderableUrl,reviewStatus:"",currency:e.currencyCode,priceAmount1000:e.priceAmount1000,salePriceAmount1000:e.salePriceAmount1000,retailerId:e.retailerId,productMsgMediaData:e.mediaData,imageCount:e.productImageCount!=null&&e.productImageCount!==0?e.productImageCount:1,fetchedFromServer:!1,t:e.t,isHidden:!1}}function k(e,t){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_SET_VISIBLE,"datasource_start");var n=r("WAWebBizCatalogProductVisibilitySetJob")(e,t);return n.then(function(){return o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_SET_VISIBLE,"datasource_end")}).catch(r("WAWebNoop")),o("WAWebBackendErrors").attachErrorLogger(n,"Product visibility change failed")}function I(e){var t={countryCodeOrigin:e.country_code_origin};return e.importer_name!=null&&e.importer_name!==""&&(t.importerName=e.importer_name),e.importer_address&&(t.importerAddress=T(e.importer_address)),t}function T(e){var t={street1:e.street1,city:e.city,countryCode:e.country_code};return e.street2!=null&&e.street2!==""&&(t.street2=e.street2),e.postal_code!=null&&e.postal_code!==""&&(t.postalCode=e.postal_code),e.region!=null&&e.region!=="null"&&(t.region=e.region),e.country_code&&(t.countryCode=e.country_code),t}l.queryProduct=m,l.queryCatalog=p,l.queryProductList=_,l.queryCatalogHasCategories=f,l.reportProduct=g,l.appealProduct=h,l.createCatalog=y,l.addProduct=C,l.editProduct=b,l.deleteProducts=v,l.parseDateValue=R,l.mapProductResponseToModel=L,l.mapMsgToProductModel=E,l.productVisibilitySet=k}),98);
__d("WAWebDirectConnectionCypher",["$InternalEnum","WAArrayBufferUtils","WALogger","WAWebDirectConnectionX509","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=n("$InternalEnum").Mirrored(["PhoneNumberAndPostcode","Postcode"]);function u(e){return e}function c(e){return e}function d(e,t,n){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield o("WAWebDirectConnectionX509").getEngine(),a=r.subtle;return a.encrypt({name:"AES-GCM",iv:new Uint8Array(o("WAWebDirectConnectionX509").base64ToArrayBuffer(t)),tagLength:128},e,o("WAWebDirectConnectionX509").stringToArrayBuffer(n))}),m.apply(this,arguments)}function p(e,t,n){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield o("WAWebDirectConnectionX509").getEngine(),a=r.subtle,i=yield a.importKey("raw",e,{name:"AES-GCM"},!1,["decrypt"]);return a.decrypt({name:"AES-GCM",iv:new Uint8Array(o("WAWebDirectConnectionX509").base64ToArrayBuffer(n)),tagLength:128},i,o("WAWebDirectConnectionX509").base64ToArrayBuffer(t))}),_.apply(this,arguments)}function f(e,t,n){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){return o("WAArrayBufferUtils").arrayBufferToString(yield p(e,t,n))}),g.apply(this,arguments)}function h(e,t){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r=o("WAWebDirectConnectionX509").arrayBufferToBase64(yield o("WAWebDirectConnectionX509").getRandomValues(new Uint8Array(16)));try{var a=yield o("WAWebDirectConnectionX509").getEngine(),i=a.subtle,l=yield i.generateKey({name:"AES-GCM",length:256},!0,["encrypt"]),s=o("WAWebDirectConnectionX509").arrayBufferToBase64(yield d(l,r,JSON.stringify(n))),u=yield i.exportKey("raw",l),c=yield o("WAWebDirectConnectionX509").encryptWithPublicKey(t,u);return{cypher:"AesKey="+c+";IV="+r+";Data="+s,exportedAesKey:u,iv:r}}catch(t){return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] cypher creation failed with ",""])),t.toString()),null}}),y.apply(this,arguments)}l.CypherType=s,l.stringToCypherString=u,l.cypherStringToString=c,l.decryptDataWithSymmetricKey=p,l.decryptDataWithSymmetricKeyToString=f,l.genCypher=h}),98);
__d("WAWebBusinessDirectConnectionBridge",["Promise","WALogger","WAWebABProps","WAWebBusinessDirectConnectionCollection","WAWebBusinessDirectUtils","WAWebDirectConnectionCypher","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e,t){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a){if(!(yield o("WAWebBusinessDirectUtils").isCypherNeeded(t)))return a();var i=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){e===void 0&&(e=!1);var n=(yield r("WAWebBusinessDirectConnectionCollection").getCypher(t,{forceRenew:e})).cypher;return a(n)});return function(n){return e.apply(this,arguments)}})();try{return yield i()}catch(t){return o("WAWebBusinessDirectUtils").errorIsDirectConnectionCypherError421(t)?(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] Received 421 from Direct Connection request. Renewing certificate and retrying."]))),i(!0)):(u||(u=n("Promise"))).reject(t)}}),d.apply(this,arguments)}function m(e,t){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(!o("WAWebABProps").getABPropConfigValue("share_phone_number_on_cart_send_to_direct_connection_biz_enabled"))return c(e,t);if(!(yield o("WAWebBusinessDirectUtils").isCypherNeeded(e)))return t();var a=(function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var n,a=(n=yield r("WAWebBusinessDirectConnectionCollection").genNewCypher(e,o("WAWebDirectConnectionCypher").CypherType.PhoneNumberAndPostcode,{forceRenew:!0}))==null?void 0:n.cypher;return t(a)});return function(){return a.apply(this,arguments)}})(),i=(function(){var i=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var n=yield r("WAWebBusinessDirectConnectionCollection").getCypher(e);return n.cypherType===o("WAWebDirectConnectionCypher").CypherType.PhoneNumberAndPostcode?t(n.cypher):a()});return function(){return i.apply(this,arguments)}})();try{return yield i()}catch(e){return o("WAWebBusinessDirectUtils").errorIsDirectConnectionCypherError421(e)?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] Received 421 from Direct Connection request. Renewing certificate and retrying."]))),a()):(u||(u=n("Promise"))).reject(e)}}),p.apply(this,arguments)}l.attemptWithDirectConnectionRetry=c,l.attemptWithOrderDirectConnectionRetry=m}),98);
__d("WAWebEditLabelAssociationBridge",["Promise","WALogger","WAWebBizGatingUtils","WAWebContactModel","WAWebDBLabelAssociationDatabaseApi","WAWebLabelJidSync","WAWebListsGatingUtils","WAWebMsgModel","WAWebSchemaLabelAssociation","WAWebSyncdCoreApi","WAWebSyncdUtils","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(t,n){var a=n.some(function(e){return e instanceof r("WAWebContactModel")});a&&o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["contact model is invalid for editLabelAssociation"]))).sendLogs("contact model is invalid for editLabelAssociation");var i=m(t,n.map(function(e){return e instanceof o("WAWebMsgModel").Msg?{labelAssociationType:o("WAWebSchemaLabelAssociation").LabelAssociationType.Message,modelId:e.id.toString(),mutationIndexSegments:o("WAWebSyncdUtils").constructMsgKeySegments(e)}:{labelAssociationType:o("WAWebSchemaLabelAssociation").LabelAssociationType.Jid,modelId:e.id.toString(),mutationIndexSegments:[e.id.toString({legacy:!0})]}}));return i}function m(e,t){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(!(o("WAWebBizGatingUtils").canEditLabelAssociation()||o("WAWebListsGatingUtils").isListsEnabled()))return(c||(c=n("Promise"))).reject(r("err")("editLabelAssociation is not supported"));var a=yield r("WAWebLabelJidSync").createLabelAssociationMutations(e,t);return o("WAWebSyncdCoreApi").lockForSync(["label-association","chat"],a,function(){return _(e,t)})}),p.apply(this,arguments)}function _(e,t){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var a=[],i=[];e.forEach(function(e){var n=e.id,r=e.type;t.map(function(e){var t=e.modelId,l=e.labelAssociationType;r==="add"?a.push({labelId:n,associationId:t,type:l}):i.push(o("WAWebSchemaLabelAssociation").createLabelAssociationPrimaryKey({labelId:n,associationId:t,type:l}))})}),yield(c||(c=n("Promise"))).all([o("WAWebDBLabelAssociationDatabaseApi").addOrEditLabelAssociations(a).catch(function(e){throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["addOrEditLabelAssociations into label association table failed"]))).verbose().devConsole(e).sendLogs("editLocalLabelAssociationMD-add-or-edit-label-associations-failed"),r("err")("addOrEditLabelAssociations into label association table failed")}),o("WAWebDBLabelAssociationDatabaseApi").removeLabelAssociations(i).catch(function(e){throw o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["removeLabelAssociations from label association table failed"]))).verbose().devConsole(e).sendLogs("editLocalLabelAssociationMD-remove-label-associations-failed"),r("err")("removeLabelAssociations form label association table failed")})])}),f.apply(this,arguments)}l.editLabelAssociation=d,l.editLocalLabelAssociationMD=_}),98);
__d("WAWebNonMessageDataRequestHistorySyncOnDemandUtils",["WALogger","WAShiftTimer","WATimeUtils","WAWebABProps","WAWebBackendApi","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebSchemaMessage","WAWebUserPrefsHistorySync","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=new Map,m={disableRequestSending:!1,failureCount:0};function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebDBMessageUtils").beginningOfChat(e),n=o("WAWebDBMessageUtils").endOfChat(e),r=yield o("WAWebSchemaMessage").getMessageTable().between(["internalId"],t,n,{limit:1,reverse:!1,shouldDecrypt:!1});return r.length===0?null:r[0]}),_.apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield p(e);return t!=null?o("WAWebDBMessageSerialization").messageFromDbRow(t):null}),g.apply(this,arguments)}function h(e){o("WAWebBackendApi").frontendFireAndForget("successHistorySyncOd",{chatId:e}),C()}function y(t){o("WAWebBackendApi").frontendFireAndForget("errorHistorySyncOd",{chatId:t});var n=o("WATimeUtils").unixTime(),r=m.firstFailureRequestTimeStampSec;r==null&&(m.firstFailureRequestTimeStampSec=n),m.failureCount+=1;var a=o("WAWebABProps").getABPropConfigValue("history_sync_on_demand_failure_limit"),i=o("WAWebABProps").getABPropConfigValue("history_sync_on_demand_cooldown_sec");if(m.failureCount>=a&&r!=null&&n-r<i){m.disableRequestSending=!0;var l=1e3*i;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[rdu] disable history sync on demand for ","ms."])),l),new(o("WAShiftTimer")).ShiftTimer(function(){m.disableRequestSending&&(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[rdu] re-enable history sync on demand."]))),C())}).onOrAfter(l)}}function C(){m.disableRequestSending=!1,m.failureCount=0,m.firstFailureRequestTimeStampSec=void 0}function b(e){var t=o("WAWebUserPrefsHistorySync").getHistoryInitialSyncBoundary();if(t==null||Object.keys(t).length===0||(t==null?void 0:t[e.toJid()])==null){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[rdu] cannot delete chat "," from initial sync boundary."])),e.toLogString());return}o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[rdu] delete chat "," from initial sync boundary"])),e.toLogString()),delete t[e.toJid()],o("WAWebUserPrefsHistorySync").setHistoryInitialSyncBoundary(t)}l.inFlightHistorySyncOnDemandRequests=d,l.historySyncOnDemandRequestsFailureRecord=m,l.getOldestMsgInChatFromDB=f,l.handleHistorySyncOnDemandSuccess=h,l.handleHistorySyncOnDemandFailure=y,l.deleteChatFromInitialSyncBoundary=b}),98);
__d("WAWebThreadMetadataJob",["Promise","WAJobOrchestratorTypes","WANullthrows","WATimeUtils","WAWebAiThreadTypeUtils","WAWebOrchestratorNonPersistedJob","WAWebSchemaThreadsMetadata","WAWebThreadId","WAWebThreadUtils","WAWebThreadsMetadataIdUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e){var t=e.threadId;return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getAiThreadMetadata",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebSchemaThreadsMetadata").getThreadsMetadataTable().get(t);return e==null||e.aiThreadInfo==null?null:{internalId:e.internalId,creationTimestamp:e.creationTimestamp,lastMessageTimestamp:e.lastMessageTimestamp,aiThreadInfo:e.aiThreadInfo,pinThreadTimestamp:e.pinThreadTimestamp}}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getAllAiThreadsFromChatId",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=o("WAWebThreadsMetadataIdUtils").craftThreadsMetadataInternalIdPrefixForChatAndThreadType(e,o("WAWebThreadUtils").ThreadType.AiThread),n=yield o("WAWebSchemaThreadsMetadata").getThreadsMetadataTable().startsWithAnyOf(["internalId"],[t]),a=n.filter(function(e){return e.aiThreadInfo!=null}).map(function(e){var t=o("WAWebAiThreadTypeUtils").getAiThreadInfoFromType(e.aiThreadInfo.title,e.aiThreadInfo.aiThreadType);return{threadId:r("WAWebThreadId").from(e.id),aiThreadInfo:t,lastMessageTimestamp:o("WATimeUtils").castToUnixTime(e.lastMessageTimestamp)}});return a}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}),c.apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("deleteAllThreadsForChat",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var r=o("WAWebThreadsMetadataIdUtils").craftThreadsMetadataInternalIdPrefixForChatAndThreadType(t,o("WAWebThreadUtils").ThreadType.AiThread),a=o("WAWebThreadsMetadataIdUtils").craftThreadsMetadataInternalIdPrefixForChatAndThreadType(t,o("WAWebThreadUtils").ThreadType.ViewAllReplies),i=yield(e||(e=n("Promise"))).all([o("WAWebSchemaThreadsMetadata").getThreadsMetadataTable().startsWithAnyOf(["internalId"],[r]),o("WAWebSchemaThreadsMetadata").getThreadsMetadataTable().startsWithAnyOf(["internalId"],[a])]),l=i[0],s=i[1],u=l.concat(s),c=u.map(function(e){return e.id});return yield o("WAWebSchemaThreadsMetadata").getThreadsMetadataTable().bulkRemove(c),e.resolve()}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}),m.apply(this,arguments)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getLatestAiThreadForChat",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=o("WAWebThreadsMetadataIdUtils").craftThreadsMetadataInternalIdPrefixForChatAndThreadType(e,o("WAWebThreadUtils").ThreadType.AiThread),n=yield o("WAWebSchemaThreadsMetadata").getThreadsMetadataTable().startsWithAnyOf(["internalId"],[t]),a=n.filter(function(e){return e.aiThreadInfo!=null});if(a.length===0)return null;var i=r("WANullthrows")(a.pop());return{threadId:r("WAWebThreadId").from(i.id),aiThreadInfo:o("WAWebAiThreadTypeUtils").getAiThreadInfoFromType(i.aiThreadInfo.title,i.aiThreadInfo.aiThreadType),lastMessageTimestamp:o("WATimeUtils").castToUnixTime(i.lastMessageTimestamp)}}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.HIGH}).waitUntilCompleted()}),_.apply(this,arguments)}l.getAiThreadMetadata=s,l.getAllAiThreadsFromChatId=u,l.deleteAllThreadsForChat=d,l.getLatestAiThreadForChat=p}),98);
__d("WAWebChatDeleteBridge",["Promise","WALogger","WASyncdConst","WATimeUtils","WAWebABProps","WAWebApiActiveMessageRanges","WAWebApiChat","WAWebApiOrphanTcToken","WAWebBizChatAssignmentAction","WAWebBizGatingUtils","WAWebDBLabelAssociationDatabaseApi","WAWebDBQueryAndRemoveMessageHistory","WAWebDeleteChatSync","WAWebEditLabelAssociationBridge","WAWebFtsClient","WAWebLabelJidSync","WAWebListsGatingUtils","WAWebMessageRangeUtils","WAWebModelStorageUtils","WAWebMuteChatSync","WAWebNonMessageDataRequestHistorySyncOnDemandUtils","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebPinChatSync","WAWebSchemaChat","WAWebSchemaGroupMetadata","WAWebSchemaLabelAssociation","WAWebSyncdDb","WAWebThreadMetadataJob","WAWebUpdateLastAddOnPreviewChatAction","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(t){return o("WAWebModelStorageUtils").getStorage().lock(["chat","label-association","message-association","message","chat-assignment","orphan-tc-token","sync-actions","thread-metadata"],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebDBQueryAndRemoveMessageHistory").getBoundsForChat(t),r=yield o("WAWebSchemaChat").getChatTable().get(t.toString()),a=yield(s||(s=n("Promise"))).all([o("WAWebSchemaChat").getChatTable().remove(t.toString()),o("WAWebDBQueryAndRemoveMessageHistory").queryAndRemoveMessageHistory(t),c(t),o("WAWebBizChatAssignmentAction").removeChatAssignmentsForChat(t),m(t,r==null?void 0:r.tcToken,r==null?void 0:r.tcTokenTimestamp),b(t,(r==null?void 0:r.accountLid)!=null?o("WAWebWidFactory").createWid(r.accountLid):null),t.isNewsletter()?(s||(s=n("Promise"))).resolve():o("WAWebThreadMetadataJob").deleteAllThreadsForChat(o("WAWebWidToJid").widToChatJid(t))]),i=a[0],l=a[1],u=a[2];return{chatBoundaries:e,deletedMsgIds:l}})).then((function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){var r=n.chatBoundaries,a=n.deletedMsgIds;r?(o("WAWebFtsClient").ftsClient.purgeRange(babelHelpers.extends({chatId:t.toString()},r)),o("WAWebUpdateLastAddOnPreviewChatAction").deleteModelsForLastAddOnPreview(a),yield o("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(o("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(t.toString(),a))):o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["sendConversationDelete: chat boundaries was null"])))});return function(e){return r.apply(this,arguments)}})())}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(o("WAWebBizGatingUtils").canEditLabelAssociation()||o("WAWebListsGatingUtils").isListsEnabled()){var t=yield _(e),n=t.labelsToUpdate,r=t.modelRecords;yield o("WAWebEditLabelAssociationBridge").editLocalLabelAssociationMD(n,r)}}),d.apply(this,arguments)}function m(e,t,n){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){return o("WAWebABProps").getABPropConfigValue("enable_spam_report_iq_with_privacy_token")&&t!=null&&r!=null?o("WAWebApiOrphanTcToken").createOrUpdateOrphanTcToken(e,{tcToken:t,tcTokenTimestamp:r}):(s||(s=n("Promise"))).resolve()}),p.apply(this,arguments)}function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebDBLabelAssociationDatabaseApi").queryLocalLabelAssociations([{associationId:e.toString(),type:o("WAWebSchemaLabelAssociation").LabelAssociationType.Jid}]);return{labelsToUpdate:t.map(function(e){var t=e.labelId;return{id:t,type:"remove"}}),modelRecords:[{labelAssociationType:o("WAWebSchemaLabelAssociation").LabelAssociationType.Jid,modelId:e.toString(),mutationIndexSegments:[e.toString({legacy:!0})]}]}}),f.apply(this,arguments)}function g(e,t,n,r,o){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,i,l){a===void 0&&(a=!1);var u=o("WATimeUtils").unixTimeMs(),d=yield(s||(s=n("Promise"))).all([r("WAWebDeleteChatSync").getDeleteChatMutation(u,e,!a),o("WAWebPinChatSync").PinChatSync.getPinMutation(u,!1,e),y(e)]),p=d[0],_=d[1],f=d[2],g=[].concat(f,[_]);t&&g.push(p);var h;return yield o("WAWebMessageRangeUtils").lockForMessageRangeSync(["message","chat","label-association","message-association","group-metadata","orphan-tc-token","sync-actions","thread-metadata"],g,n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield o("WAWebApiActiveMessageRanges").addActiveMessageRange(e.toString(),o("WAWebApiActiveMessageRanges").getActiveRangeAction("deleteChat",{deleteMedia:!a}),p.binarySyncAction),h=yield o("WAWebDBQueryAndRemoveMessageHistory").queryAndRemoveMessageHistory(e);var t=yield o("WAWebApiChat").getChatRecord(e);yield(s||(s=n("Promise"))).all([o("WAWebSchemaChat").getChatTable().remove(e.toString()),o("WAWebSchemaGroupMetadata").getGroupMetadataTable().remove(e.toString()),c(e),m(e,i,l),b(e,(t==null?void 0:t.accountLid)!=null?o("WAWebWidFactory").createWid(t.accountLid):null),o("WAWebThreadMetadataJob").deleteAllThreadsForChat(o("WAWebWidToJid").widToChatJid(e))])})),{status:200,result:h}}),h.apply(this,arguments)}function y(e){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!(o("WAWebBizGatingUtils").canEditLabelAssociation()||o("WAWebListsGatingUtils").isListsEnabled()))return[];var t=yield _(e),n=t.labelsToUpdate,a=t.modelRecords;return r("WAWebLabelJidSync").createLabelAssociationMutations(n,a)}),C.apply(this,arguments)}function b(e,t){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var a=[JSON.stringify([r("WAWebMuteChatSync").getAction(),e.toJid()])];t!=null&&a.push(JSON.stringify([r("WAWebMuteChatSync").getAction(),t.toJid()]));var i=(yield(s||(s=n("Promise"))).all(a.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebSyncdDb").getSyncAction(e);if(!(t==null||t.actionState===o("WASyncdConst").SyncActionState.Orphan))return e});return function(t){return e.apply(this,arguments)}})()))).filter(Boolean);yield o("WAWebSyncdDb").updateSyncActionRows(i.map(function(t){return{index:t,actionState:o("WASyncdConst").SyncActionState.Orphan,modelType:o("WASyncdConst").SyncModelType.Chat,modelId:e.toString()}}))}),v.apply(this,arguments)}function S(e,t,r){return g(e,!0,!1,t,r).then((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(t.result!=null&&t.result.length>0){var n=t.result;return o("WAWebUpdateLastAddOnPreviewChatAction").deleteModelsForLastAddOnPreview(n),o("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").deleteChatFromInitialSyncBoundary(e),yield o("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(o("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(e.toString(),n)),t}return t});return function(e){return t.apply(this,arguments)}})())}l.deleteFromStorage=u,l.sendConversationDelete=S}),98);
__d("WAWebChatFindBridge",["WAWebApiHydrateWidsUtil","WAWebSchemaChat","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebSchemaChat").getChatTable().get(e,!1);return t?o("WAWebApiHydrateWidsUtil").hydrateWids(t):null}),s.apply(this,arguments)}l.findLocal=e}),98);
__d("WAWebChatGetExistingBridge",["WAWebChatCollection","WAWebChatFindBridge","WAWebNewsletterCollection","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebChatCollection").ChatCollection.get(e);if(t&&!t.stale)return t;var n=e.isNewsletter();if(n){var a=r("WAWebNewsletterCollection").get(e);if(a!=null&&!a.stale)return r("WAWebNewsletterCollection").get(e)}var i=yield o("WAWebChatFindBridge").findLocal(e.toString());return i?n?r("WAWebNewsletterCollection").gadd(i):o("WAWebChatCollection").ChatCollection.gadd(i):null}),s.apply(this,arguments)}l.getExisting=e}),98);
__d("WAWebChatMuteBridge",["WAWebMuteChatSync","WAWebSyncdCoreApi","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t,n){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a=yield r("WAWebMuteChatSync").generateMuteMutation(e,t),i=o("WAWebSyncdCoreApi").lockForSync(["chat"],[a],function(n){var r=n[0];return r.merge(e.toString(),{muteExpiration:t})}).then(function(){return{status:200}});return i}),s.apply(this,arguments)}l.sendConversationMute=e}),98);
__d("WAWebSyncdWamAppState",["WAPREList","WAPREMetrics","WAShiftTimer"],(function(t,n,r,o,a,i,l){"use strict";var e=d(),s=new(o("WAShiftTimer")).ShiftTimer(f),u=1e3*60*5;function c(){s.isScheduled()&&s.forceRunNow()}function d(){return{mutationCount:0,invalidActionCount:0,unsupportedActionCount:0,keyRotationRemoveCount:0,storedMutationCount:0,uploadConflictCount:0,unsetActionCount:0,missingKeyCount:0}}function m(){e=d()}function p(e){return{int:babelHelpers.extends({},e)}}function _(e){var t,n,r,o,a,i,l,s;return{mutationCount:(e==null||(t=e.int)==null?void 0:t.mutationCount)||0,invalidActionCount:(e==null||(n=e.int)==null?void 0:n.invalidActionCount)||0,unsupportedActionCount:(e==null||(r=e.int)==null?void 0:r.unsupportedActionCount)||0,keyRotationRemoveCount:(e==null||(o=e.int)==null?void 0:o.keyRotationRemoveCount)||0,storedMutationCount:(e==null||(a=e.int)==null?void 0:a.storedMutationCount)||0,uploadConflictCount:(e==null||(i=e.int)==null?void 0:i.uploadConflictCount)||0,unsetActionCount:(e==null||(l=e.int)==null?void 0:l.unsetActionCount)||0,missingKeyCount:(e==null||(s=e.int)==null?void 0:s.missingKeyCount)||0}}function f(){var t=p(e);m(),o("WAPREMetrics").startMetric(o("WAPREList").PRE_METRIC.APP_STATE_SYNC_DAILY).endSuccess(t)}function g(){s.onOrBefore(u)}function h(t){t!==0&&(e.mutationCount+=t,g())}function y(t){e.invalidActionCount=t,g()}function C(t){e.unsupportedActionCount=t,g()}function b(t){t!==0&&(e.keyRotationRemoveCount+=t,g())}function v(t){e.storedMutationCount=t,g()}function S(){e.uploadConflictCount++,g()}function R(t){t!==0&&(e.unsetActionCount+=t,g())}function L(t){e.missingKeyCount=t,g()}l.forceCommitAppState=c,l.clear=m,l.convertAppStateSyncDailyFromAnnotations=_,l.addMutationCount=h,l.setInvalidActionCount=y,l.setUnsupportedActionCount=C,l.addKeyRotationRemoveCount=b,l.setStoredMutationCount=v,l.incConflict=S,l.addUnsetActionCount=R,l.setMissingKeyCount=L}),98);
__d("WAWebChatPinBridge",["WAWebPinChatSync","WAWebSyncdCoreApi","WAWebSyncdWamAppState","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t,n,r){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=t!==0,i=yield o("WAWebPinChatSync").PinChatSync.getMutationsForPin(r,a,e);return a||o("WAWebSyncdWamAppState").addUnsetActionCount(1),o("WAWebSyncdCoreApi").lockForSync(["chat"],i,function(n){var r=n[0];return r.merge(e.toString(),{pin:t})}).then(function(){return{status:200}})}),s.apply(this,arguments)}function u(){return o("WAWebPinChatSync").PinChatSync.getLocalChatPins().then(function(e){return e.length})}function c(){return o("WAWebPinChatSync").PinChatSync.getLocalNewsletterPins().then(function(e){return e.length})}function d(e){return e.isNewsletter()?c():u()}function m(e){return e.isNewsletter()?o("WAWebPinChatSync").MAX_PINNED_NEWSLETTERS:o("WAWebPinChatSync").MAX_PINNED_CHATS}function p(e){return e.isNewsletter()?o("WAWebPinChatSync").PinChatSync.unpinAllNewsletters():o("WAWebPinChatSync").PinChatSync.unpinAllChats()}l.setPin=e,l.getNumNewslettersPinned=c,l.getNumConversationsPinned=d,l.getPinLimit=m,l.unpinAllConversations=p}),98);
__d("WAWebChatSeenBridge",["WALogger","WATimeUtils","WAWebApiActiveMessageRanges","WAWebApiChat","WAWebMarkChatAsReadSync","WAWebMessageRangeUtils","WAWebMiscErrors","WAWebSchemaChat","WAWebSendReadReceiptJob","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t,n){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a=o("WATimeUtils").unixTimeMs();if(n===-1){var i=yield r("WAWebMarkChatAsReadSync").getMarkChatAsReadMutation(a,!0,e.id),l=e.id.toString();o("WAWebMessageRangeUtils").lockForMessageRangeSync([],[i],function(){return o("WAWebApiActiveMessageRanges").addActiveMessageRange(e.id.toString(),"markChatAsRead",i.binarySyncAction)}),yield o("WAWebApiChat").updateChatForMarkAsReadSync(l)}else yield o("WAWebSendReadReceiptJob").markChatRead(e,t)}),c.apply(this,arguments)}function d(e,t){var n=o("WATimeUtils").unixTimeMs();return r("WAWebMarkChatAsReadSync").getMarkChatAsReadMutation(n,!1,e).then(function(t){return o("WAWebMessageRangeUtils").lockForMessageRangeSync([],[t],function(){return o("WAWebApiActiveMessageRanges").addActiveMessageRange(e.toString(),"markChatAsRead",t.binarySyncAction)})})}function m(t,n){return o("WAWebSchemaChat").getChatTable().merge(t.toString(),{unreadCount:n,unreadDividerOffset:0}).catch(function(t){throw t instanceof o("WAWebMiscErrors").DbOnLogoutAbort?t:(o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["update chat table failed"]))).verbose().devConsole(t).sendLogs("update chat table failed when mark conversation seen"),r("err")("update chat table failed"))})}function p(e){return o("WAWebSchemaChat").getChatTable().merge(e.toString(),{unreadCount:-1,unreadDividerOffset:0}).catch(function(e){throw e instanceof o("WAWebMiscErrors").DbOnLogoutAbort?e:(o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["update chat table failed"]))).verbose().devConsole(e).sendLogs("update chat table failed when mark conversation as unseen"),r("err")("update chat table failed"))})}l.sendConversationSeen=u,l.sendConversationUnseen=d,l.markConversationSeen=m,l.markConversationUnseen=p}),98);
__d("WAWebChatSendStarMsgsBridge",["WALogger","WAWebDBProcessMessage","WAWebStarMessageSync","WAWebSyncdCoreApi","WAWebSyncdWamAppState","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t,n){return d(t,n)}function c(e,t){return d(e,!1)}function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){n||o("WAWebSyncdWamAppState").addUnsetActionCount(t.length);var a=yield r("WAWebStarMessageSync").getStarMessageMutations(t.map(function(e){return e.id}),n);return o("WAWebSyncdCoreApi").lockForSync(["message","message-association"],a,function(){return n?o("WAWebDBProcessMessage").starMessages(t.map(function(e){return e.id.toString()})).catch(function(t){throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["star messages failed"]))).verbose().devConsole(t).sendLogs("star messages failed"),r("err")("star messages failed")}):o("WAWebDBProcessMessage").unstarMessages(t.map(function(e){return e.id.toString()})).catch(function(e){throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["unstar messages failed"]))).verbose().devConsole(e).sendLogs("unstar messages failed"),r("err")("unstar messages failed")})})}),m.apply(this,arguments)}l.sendStarMsgs=u,l.sendUnstarAll=c}),98);
__d("WAWebDBBulkPersistProfilePic",["WABatcher","WALogger","WAWebSchemaProfilePicThumb","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u=o("WABatcher").batch({delayMs:3e3},(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return yield d(e),[]});return function(t){return e.apply(this,arguments)}})());function c(e){return u(e)}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["bulkPersistProfilePicChanges processing "," records"])),t.length);var n=Array.from(t.reduce(function(e,t){return e.set(t.id,t),e},new Map).values());yield o("WAWebSchemaProfilePicThumb").getProfilePicThumbTable().bulkCreateOrMerge(n),o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["bulkPersistProfilePicChanges persisted "," records"])),n.length)}),m.apply(this,arguments)}l.persistProfilePicBatched=c,l.bulkPersistProfilePicChanges=d}),98);
__d("WAWebGroupGetProfilePicsJob",["WALogger","WASmaxGroupsGetGroupProfilePicturesRPC","WAWebBackendErrors","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=Object.freeze({IMAGE:"image",PREVIEW:"preview"}),u=Object.freeze({BLOB:"blob",URL:"url"});function c(e,t,n){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=n.subgroupHintId,a=n.type,i=a===void 0?s.PREVIEW:a,l=n.query,c=l===void 0?u.URL:l,d={profilePictureTypeMixinArgs:{pictureType:i},profilePictureQueryMixinArgs:{pictureQuery:c}},p=e.map(function(e){var t=e.groupId,n=e.photoId,r=e.isParentGroup,a=r===void 0?!1:r,i=a?{parentGroup:{anyParentGroupJid:o("WAWebWidToJid").widToGroupJid(t)}}:{subGroup:{anySubGroupJid:o("WAWebWidToJid").widToGroupJid(t)}};return babelHelpers.extends({parentOrSubGroupMixinGroupArgs:i,profilePictureIdMixinArgs:n!=null?{pictureId:n}:void 0},d)}),_=yield o("WASmaxGroupsGetGroupProfilePicturesRPC").sendGetGroupProfilePicturesRPC({pictureArgs:p,subGroupHintMixinArgs:r?{anyLinkedGroupsMembershipHint:o("WAWebWidToJid").widToGroupJid(r)}:void 0,baseGetGroupOrServerMixinGroupArgs:{baseGetGroup:{iqTo:o("WAWebWidToJid").widToGroupJid(t)}}});switch(_.name){case"GetGroupProfilePicturesResponseSuccessGroupPictures":{var f=_.value.picturesPicture.map(function(e){var t;switch(e.parentOrSubGroupMixinGroup.name==="SubGroup"?t=o("WAWebWidFactory").createWid(e.parentOrSubGroupMixinGroup.value.subGroupJid):t=o("WAWebWidFactory").createWid(e.parentOrSubGroupMixinGroup.value.parentGroupJid),e.getGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup.name){case"GetGroupProfilePicturesSuccessProfilePictureResponse":{var n,r,a=e.getGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup.value;return{id:t,tag:a.id,eurl:(n=a.profilePictureUrlOrBlobResponseMixinGroup)==null?void 0:n.value.url,directPath:(r=a.profilePictureUrlOrBlobResponseMixinGroup)==null?void 0:r.value.directPath,type:a.type,updatePicture:!0}}case"GetGroupProfilePicturesPartialProfilePictureResponse":{var i,l=!1;return((i=e.getGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup.value.pictureDidNotChangeOrPictureNotFoundOrBadServerProfilePictureErrorOrBadLinkedGroupProfilePictureErrorMixinGroup)==null?void 0:i.name)==="PictureNotFound"&&(l=!0),{id:t,tag:null,eurl:null,directPath:null,type:null,updatePicture:l}}}});return f}case"GetGroupProfilePicturesResponseClientError":{var g=_.value.errorGetGroupProfilePictureClientErrors.value.code,h=_.value.errorGetGroupProfilePictureClientErrors.value.text;return m(g,h)}case"GetGroupProfilePicturesResponseServerError":{var y=_.value.errorServerErrors.value.code,C=_.value.errorServerErrors.value.text;return m(y,C)}}}),d.apply(this,arguments)}function m(t,n){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getGroupProfilePics failed: ",":",""])),t,n).tags("non-sad").sendLogs("pictures-error",{sampling:.01}),Promise.reject(new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(t),n))}l.ProfilePicsTypeEnum=s,l.ProfilePicsQueryEnum=u,l.getProfilePics=c}),98);
__d("WAWebFetchCommunityProfilePicAction",["Promise","WAWebGroupGetProfilePicsJob","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t,n){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r,a){var i,l,s,u,c,d={id:t},m={groupId:t,photoId:a!=null?String(a):null,isParentGroup:t.equals(r)},p=yield(e||(e=n("Promise"))).all([o("WAWebGroupGetProfilePicsJob").getProfilePics([m],r,{type:o("WAWebGroupGetProfilePicsJob").ProfilePicsTypeEnum.IMAGE}),o("WAWebGroupGetProfilePicsJob").getProfilePics([m],r,{type:o("WAWebGroupGetProfilePicsJob").ProfilePicsTypeEnum.PREVIEW})]),_=p[0],f=p[1];return!f[0]||!f[0].updatePicture||!_[0]||!_[0].updatePicture?d:babelHelpers.extends({},d,{eurl:(i=_[0].eurl)!=null?i:void 0,fullDirectPath:(l=_[0].directPath)!=null?l:void 0,previewEurl:(s=f[0].eurl)!=null?s:void 0,previewDirectPath:(u=f[0].directPath)!=null?u:void 0,tag:(c=_[0].tag)!=null?c:void 0,timestamp:Date.now(),eurlStale:!1,stale:!1})}),u.apply(this,arguments)}l.fetchCommunityProfilePic=s}),98);
__d("WAWebSendProfilePictureJob",["Promise","WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebCommsWapMd","WAWebWid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=new(r("WADeprecatedWapParser"))("photoResponseParser",function(e){if(e.assertAttr("type","result"),e.hasChild("picture")){var t=e.child("picture");return{id:t.attrInt("id")}}return{id:null}});function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a){var i=yield o("WADeprecatedSendIq").deprecatedSendIq(o("WAWap").wap("iq",{to:o("WAWap").S_WHATSAPP_NET,target:r("WAWebWid").isGroup(t)?o("WAWebCommsWapMd").CHAT_JID(t):o("WAWap").DROP_ATTR,type:"set",xmlns:"w:profile:picture",id:o("WAWap").generateId()},a?o("WAWap").wap("picture",{type:"image"},a):null),s);return i.success?{id:i.result.id}:(e||(e=n("Promise"))).reject(new(o("WAWebBackendErrors")).ServerStatusCodeError(i.errorCode,i.errorText))}),c.apply(this,arguments)}l.default=u}),98);
__d("WAWebContactProfilePicThumbBridge",["Promise","WABase64","WAFilteredCatch","WALogger","WAWebBackendErrors","WAWebChangeProfilePicThumb","WAWebDBBulkPersistProfilePic","WAWebFetchCommunityProfilePicAction","WAWebFetchNewsletterProfilePicAction","WAWebGetProfilePicJob","WAWebProfilePicConstants","WAWebSendProfilePictureJob","WAWebURLUtils","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p;function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=r("WAWebSendProfilePictureJob")(e,null).then(function(){return{status:200}}),n=yield t;return o("WAWebChangeProfilePicThumb").changeProfilePicThumb(e,o("WAWebProfilePicConstants").ProfilePicCommand.Remove),n}),f.apply(this,arguments)}function g(e,t,n){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a){var i=r("WAWebURLUtils").parseDataURL(a).data,l=o("WABase64").decodeB64(i),s=r("WAWebSendProfilePictureJob")(e,l).then(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield o("WAWebGetProfilePicJob").getProfilePic(e,{preview:!1});return{tag:t.tag,eurl:t.eurl,fullDirectPath:t.directPath,filehash:t.filehash,status:200}})),u=yield s;return o("WAWebChangeProfilePicThumb").changeProfilePicThumb(e,o("WAWebProfilePicConstants").ProfilePicCommand.Set),u}),h.apply(this,arguments)}function y(e,t){var n,r,o,a,i,l;return{id:e.toString(),eurl:(n=t==null?void 0:t.eurl)!=null?n:null,previewEurl:(r=t==null?void 0:t.previewEurl)!=null?r:null,tag:(o=t==null?void 0:t.tag)!=null?o:null,previewDirectPath:(a=t==null?void 0:t.previewDirectPath)!=null?a:null,fullDirectPath:(i=t==null?void 0:t.fullDirectPath)!=null?i:null,filehash:(l=t==null?void 0:t.filehash)!=null?l:null,timestamp:Date.now()}}function C(e,t){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=y(e,t);yield o("WAWebDBBulkPersistProfilePic").persistProfilePicBatched(n)}),b.apply(this,arguments)}function v(e,t){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var r=(p||(p=n("Promise"))).all([o("WAWebGetProfilePicJob").getProfilePic(e,babelHelpers.extends({},t,{preview:!1})),o("WAWebGetProfilePicJob").getProfilePic(e,babelHelpers.extends({},t,{preview:!0}))]).then(function(e){var t,n=e[0],r=e[1],o={eurl:n.eurl,tag:n.tag,previewEurl:r.eurl,previewDirectPath:r.directPath,fullDirectPath:n.directPath},a=(t=r.filehash)!=null?t:n.filehash;return a!=null&&(o.filehash=a),o});try{var a=yield r;C(e,a).catch(function(e){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["persistProfilePicToDB failed with error ",""])),e.message).devConsole(e)}),E(e,a.eurl)}catch(t){E(e),R(e,t).catch(function(e){o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["ProfilePicFind:Catch persistProfilePicToDB failed with error ",""])),e.message).devConsole(e)})}return r}),S.apply(this,arguments)}function R(e,t){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(t instanceof o("WAWebBackendErrors").ServerStatusCodeError){var n=t.status;n===500||n===501||n===503?o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["profilePicFind failed with serverCode: ",""])),n):n===404?yield C(e):n===401&&!e.isGroup()&&(yield C(e))}}),L.apply(this,arguments)}function E(e,t){e.equals(o("WAWebUserPrefsMeUser").getMaybeMePnUser())&&o("WAWebUserPrefsMultiDevice").setCachedProfilePicEURL(t!=null?t:"")}function k(t){return(p||(p=n("Promise"))).all(t.map((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){try{var n=yield v(t.id);return{id:t.id,eurl:n.eurl,tag:n.tag,previewEurl:n.previewEurl,previewDirectPath:n.previewDirectPath,fullDirectPath:n.fullDirectPath,filehash:n.filehash,stale:!1,eurlStale:!1,timestamp:Date.now()}}catch(n){if(n instanceof o("WAWebBackendErrors").ServerStatusCodeError)switch(n.status){case 401:case 404:return{tag:"",id:t.id,stale:!1,eurlStale:!1,timestamp:Date.now()};default:return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["ProfilePicThumb:resyncPictures error - ",", ",""])),n.status,n.message),{id:t.id,stale:!1,eurlStale:!1,timestamp:Date.now()}}throw n}});return function(e){return t.apply(this,arguments)}})()))}function I(e,t,n,r){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,a){try{if(e.isNewsletter()){var i=yield o("WAWebFetchNewsletterProfilePicAction").fetchNewsletterProfilePic(o("WAWebWidFactory").asNewsletterWidOrThrow(e));return C(e,i).catch(function(e){o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["persistProfilePicToDB failed with error ",""])),e.message).devConsole(e)}),i}if(t!=null){var l=yield o("WAWebFetchCommunityProfilePicAction").fetchCommunityProfilePic(e,t);return C(e,l).catch(function(e){o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["persistProfilePicToDB failed with error ",""])),e.message).devConsole(e)}),l}var s=yield v(e,{tcToken:r,commonGid:a}),u=babelHelpers.extends({},s,{id:e,timestamp:Date.now(),eurlStale:!1,stale:!1});return u}catch(t){return o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").ServerStatusCodeError,function(t){var r={id:e};switch(t.status){case 401:case 404:r.tag="",r.timestamp=Date.now(),r.eurlStale=!1,r.stale=!1;break;case 423:r.stale=!0;break;case 429:r.stale=!0;break;default:r.eurlStale=!1;break}return(p||(p=n("Promise"))).resolve(r)})(t)}}),T.apply(this,arguments)}l.requestDeletePicture=_,l.sendSetPicture=g,l.mapProfilePictureToProfilePicThumbRowType=y,l.persistProfilePicToDB=C,l.profilePicResync=k,l.requestProfilePicFromServer=I}),98);
__d("WAWebMexFetchAboutStatusJobQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"user"}],t=[{kind:"Literal",name:"updates",value:["STATUS"]},{items:[{kind:"Variable",name:"users.0",variableName:"user"}],kind:"ListValue",name:"users"}],n={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],type:"XWA2UserStatusUpdate",abstractKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebMexFetchAboutStatusJobQuery",selections:[{alias:null,args:t,concreteType:"XWA2UserUpdate",kind:"LinkedField",name:"xwa2_users_updates_since",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"updates",plural:!0,selections:[n],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebMexFetchAboutStatusJobQuery",selections:[{alias:null,args:t,concreteType:"XWA2UserUpdate",kind:"LinkedField",name:"xwa2_users_updates_since",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"updates",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},n],storageKey:null}],storageKey:null}]},params:{id:"24535500086059408",metadata:{},name:"WAWebMexFetchAboutStatusJobQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebMexFetchAboutStatusJob",["Promise","WALogger","WAWebBackendErrors","WAWebMexClient","WAWebMexFetchAboutStatusJobQuery.graphql","WAWebPrivacyGatingUtils","WAWebTrustedContactsUtils","WAWebWid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=t.wid,i=t.tcToken;if(!r("WAWebWid").isWid(a)||!a.isUser())return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[mex][about_status] this method should only take user wid, instead it received: ",""])),a).tags("mex","about_status").devConsole({wid:a}).sendLogs("mex-about-status-wrong-wid"),(c||(c=n("Promise"))).resolve({id:a});var l=e!==void 0?e:e=n("WAWebMexFetchAboutStatusJobQuery.graphql"),d={user_id:a.user};i!=null&&o("WAWebPrivacyGatingUtils").isProfileScrappingProtectionInMexFetchEnabled()&&(d.privacy_token={tctoken:o("WAWebTrustedContactsUtils").encodeTcTokenForMex(i)});var m={user:d};try{var p,_,f=yield o("WAWebMexClient").fetchQuery(l,m),g=(p=f.xwa2_users_updates_since)==null?void 0:p[0];g==null&&o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[mex][about_status] empty return list"]))).tags("mex","about_status").devConsole({response:f}).sendLogs("mex-about-status-empty-return-list");var h=g==null||(_=g.updates)==null||(_=_[0])==null?void 0:_.text;return{id:a,status:h}}catch(e){if(e instanceof o("WAWebBackendErrors").ServerStatusCodeError){var y=e.statusCode;return y===401?{id:a,status:""}:{id:a,error:{errorCode:y,errorText:e.message}}}throw e}}),m.apply(this,arguments)}l.mexGetAbout=d}),98);
__d("WAWebGetAboutQueryJob",["Promise","WALogger","WAWebMexFetchAboutStatusJob","WAWebUsync","WAWebUsyncUser","WAWebWid","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.wid;if(!t.isLid()){var n=yield o("WAWebMexFetchAboutStatusJob").mexGetAbout(e);return n}return p(e)}),m.apply(this,arguments)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=t.wid,i=t.tcToken;if(!r("WAWebWid").isWid(a)||!a.isUser())return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getAbout: this method should only take user wid, instead it received: ",""])),a),(c||(c=n("Promise"))).resolve({id:a});var l=new(o("WAWebUsyncUser")).USyncUser().withId(a);i!=null&&(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["getAbout: adding tcToken to usync query"]))),l.withTcToken(i));var d=new(o("WAWebUsync")).USyncQuery().withContext("interactive").withMode("query").withStatusProtocol().withUser(l),m=yield d.execute();if(m.error.all||m.error.status){var p=m.error.all||m.error.status;return o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["getAbout: failed "," : ",""])),p.errorCode,p.errorText),{id:a,error:p}}var _=m.list;return _.length?{id:a,status:_[0].status}:(c||(c=n("Promise"))).reject(r("err")("no status data returned for user"))}),_.apply(this,arguments)}l.getAbout=d}),98);
__d("WAWebMexUsersGetAboutStatus",["$InternalEnum","WAWebMexUsync","WAWebPrivacyGatingUtils","WAWebTrustedContactsUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=n("$InternalEnum").Mirrored(["EMPTY","NOT_ALLOWED","NO_CHANGE"]);function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.wid,r=t.tcToken,a={jid:n.toJid()};r!=null&&o("WAWebPrivacyGatingUtils").isProfileScrappingProtectionInUsyncEnabled()&&(a.privacy_token={tctoken:o("WAWebTrustedContactsUtils").encodeTcTokenForMex(r)});var i=yield o("WAWebMexUsync").mexUsyncQuery({users:[a],telemetry:{context:"INTERACTIVE"},fetch:{about_status:!0}}),l=i.response;if(l!=null){var s,u,c=(s=l[0].about_status_info)==null?void 0:s.text,d=e.cast((u=l[0].about_status_info)==null?void 0:u.status);return d==null?{status:c,state:null}:d===e.NOT_ALLOWED?{status:"",state:null}:d===e.EMPTY?{status:null,state:null}:{state:d}}return{state:e.EMPTY}}),u.apply(this,arguments)}l.getMexUsersAboutStatus=s}),98);
__d("WAWebContactStatusBridge",["WALogger","WAWebABProps","WAWebAck","WAWebApiStatus","WAWebGetAboutQueryJob","WAWebMexUsersGetAboutStatus","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebSendReadReceiptJob","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.wid;if(o("WAWebABProps").getABPropConfigValue("mex_usync_about_status")){var r=yield o("WAWebMexUsersGetAboutStatus").getMexUsersAboutStatus(t),a=r.status,i=r.state;return i==null?{id:n,status:a}:{id:n,stale:!0,status:null}}return o("WAWebGetAboutQueryJob").getAbout(t).then(function(t){return t.error?(o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getStatus: failed "," : ",""])),t.error.errorCode,t.error.errorText),{id:t.id,stale:!0,status:""}):{id:t.id,status:t.status}})}),u.apply(this,arguments)}function c(e){return o("WAWebPersistedJobManager").getJobManager().waitUntilCompleted(o("WAWebPersistedJobDefinitions").jobSerializers.setAbout(e))}function d(){return o("WAWebApiStatus").getAllStatuses()}function m(e,t,n){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){try{return yield o("WAWebSendReadReceiptJob").markStatusRead(e,t,n),e.ack=o("WAWebAck").ACK.READ,!0}catch(e){return!1}}),p.apply(this,arguments)}l.getStatus=s,l.setMyStatus=c,l.queryStatusAll=d,l.sendReadStatus=m}),98);
__d("WAWebContactSyncBridge",["WAWebLidAwareContactsDB","WAWebSyncContactJob","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield r("WAWebLidAwareContactsDB").allPrimaryKeys();if(t.length>0){var n=t.map(o("WAWebWidFactory").createWid).filter(function(e){return e.isEligibleForUSync()});return o("WAWebSyncContactJob").syncContactListInChunksJob(n,e,"full")}}),s.apply(this,arguments)}l.doFullContactSync=e}),98);
__d("WAWebRequestMediaReuploadBridge",["WAWebProtobufsMmsRetry.pb","WAWebRequestMediaReuploadManager"],(function(t,n,r,o,a,i,l){function e(e){if(e!=null)switch(e){case o("WAWebProtobufsMmsRetry.pb").MediaRetryNotification$ResultType.SUCCESS:return 200;case o("WAWebProtobufsMmsRetry.pb").MediaRetryNotification$ResultType.NOT_FOUND:case o("WAWebProtobufsMmsRetry.pb").MediaRetryNotification$ResultType.DECRYPTION_ERROR:return 404;case o("WAWebProtobufsMmsRetry.pb").MediaRetryNotification$ResultType.GENERAL_ERROR:return 500}return 500}function s(t){return o("WAWebRequestMediaReuploadManager").RequestMediaReuploadManager.requestMediaReupload(t).then(function(t){var n=t.result,r=t.directPath;return{status:e(n),directPath:r,isMD:!0}})}l.default=s}),98);
__d("WAWebDBUpdateMessageTable",["WALogger","WAWebSchemaMessage"],(function(t,n,r,o,a,i,l){var e;function s(t,n){return o("WAWebSchemaMessage").getMessageTable().merge(t.toString(),n).catch(function(t){throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["updateMessageTable: failed to update in storage"]))).verbose().devConsole(t).sendLogs("updateMessageTable failed"),t})}l.updateMessageTable=s}),98);
__d("WAWebMsgReactionsBridge",["Promise","WALogger","WAWebAck","WAWebDBGetReactions","WAWebDBUpdateMessageTable","WAWebLidMigrationUtils","WAWebMsgCollection","WAWebMsgKey","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var r=o("WAWebMsgCollection").MsgCollection.get(e);if(r&&r.hasReaction!==t){var a={hasReaction:t};yield o("WAWebDBUpdateMessageTable").updateMessageTable(r.id,a),r.set(a)}return(s||(s=n("Promise"))).resolve()}),c.apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n;try{if(n=yield o("WAWebDBGetReactions").getReactions(t.id.toString()),n.reactions.length===0&&t.id.remote.isStatus()){var a=o("WAWebLidMigrationUtils").getAlternateMsgKey(t.id);a&&(n=yield o("WAWebDBGetReactions").getReactions(a.toString()))}}catch(t){throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getReactions: failed with error: "," message: ",""])),t.name,t.message).verbose().devConsole(t).sendLogs("getReactions failed"),t}var i=n.reactions.map(function(e){var t=e.senders.map(function(e){return babelHelpers.extends({},e,{id:r("WAWebMsgKey").fromString(e.msgKey),isSendFailure:o("WAWebUserPrefsMeUser").isSerializedWidMe(e.senderUserJid)&&e.ack===o("WAWebAck").ACK.CLOCK})});return babelHelpers.extends({},e,{hasReactionByMe:e.hasReactionByMe,id:e.aggregateEmoji,senders:t})}),l=i.length>0;return yield u(t.id.toString(),l),babelHelpers.extends({},n,{id:t.id,reactions:i})}),m.apply(this,arguments)}l.updateHasReactionInParent=u,l.sendQueryReactions=d}),98);
__d("WAWebMsgUtilsBridge",["WALogger","WATimeUtils","WAWebABProps","WAWebBackendApi","WAWebChatThreadLogging","WAWebChatThreadLoggingUtils","WAWebContactCollection","WAWebDBMsgUtils","WAWebDBProcessReplyMsgs","WAWebEphemeralityResolver","WAWebForwardSendWamEvent","WAWebMsgGetters","WAWebMsgType","WAWebWamGroupMetadataMetricUtils","asyncToGeneratorRuntime","justknobx"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=!!t.caption;t.type===o("WAWebMsgType").MSG_TYPE.DOCUMENT&&(n=t.isCaptionByUser);var r={messageType:t.getWamMessageType(),messageMediaType:t.getWamMediaType(),mediaCaptionPresent:n,fastForwardEnabled:!0,messageIsFanout:!0,isFrequentlyForwarded:!!o("WAWebMsgGetters").getIsFrequentlyForwarded(t),isForwardedForward:o("WAWebMsgGetters").getNumTimesForwarded(t)>1};if(t.ephemeralDuration!=null&&(r.ephemeralityDuration=t.ephemeralDuration),o("WAWebABProps").getABPropConfigValue("dm_initiator_trigger")){var a=o("WAWebMsgGetters").getWamDisappearingModeTrigger(t);a!=null&&(r.ephemeralityTriggerAction=a);var i=o("WAWebMsgGetters").getWamDisappearingModeInitiatedByMe(t);i!=null&&(r.ephemeralityInitiator=i)}if(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["createMessageForwardMetric"]))),!o("WAWebMsgGetters").getIsGroupMsg(t)){var l=o("WAWebEphemeralityResolver").getEphemeralDurationForUser(o("WAWebContactCollection").ContactCollection.getMeContact());l!=null&&(r.senderDefaultDisappearingDuration=l);var s=o("WAWebEphemeralityResolver").getEphemeralDurationForUser(o("WAWebContactCollection").ContactCollection.get(t.to));s!=null&&(r.receiverDefaultDisappearingDuration=s)}var u=t.getWamDisappearingModeInitiator();u!=null&&(r.disappearingChatInitiator=u);var c=yield o("WAWebWamGroupMetadataMetricUtils").getGroupTypeFromChatWid(t.to);return c!=null&&(r.typeOfGroup=c),new(o("WAWebForwardSendWamEvent")).ForwardSendWamEvent(r)}),u.apply(this,arguments)}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t;return((t=e.quotedMsg)==null?void 0:t.type)!==o("WAWebMsgType").MSG_TYPE.PRODUCT||!o("WAWebMsgGetters").getIsSentByMe(e)?!1:o("WAWebBackendApi").frontendSendAndReceive("isMessageSentToBusiness",{msgKey:e.id})}),d.apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(o("WAWebChatThreadLoggingUtils").shouldIncrementMsgSendAndReceive(e)){if(r("justknobx")._("2641")&&o("WAWebABProps").getABPropConfigValue("group_status_receiver_enabled")){var t=o("WAWebDBProcessReplyMsgs").createQuotedMsgKey(e);if(t!=="missing-stanza-id"){var n=yield o("WAWebDBMsgUtils").getMsgByMsgKey(t);if(n!=null&&o("WAWebMsgGetters").getIsGroupStatus(n)){var a=o("WAWebMsgGetters").getIsSentByMe(n),i=o("WAWebMsgGetters").getIsReply(e);return o("WAWebChatThreadLogging").handleActivitiesForChatThreadLogging([{activityType:"groupStatusMsgSend",chatId:e.id.remote,ts:o("WATimeUtils").unixTime(),isGroupStatusReplyOwnToOwn:i&&a,isGroupStatusReplyOwnToOthers:i&&!a}])}}}o("WAWebChatThreadLogging").handleActivitiesForChatThreadLogging([{activityType:"msgSend",chatId:e.id.remote,ts:o("WATimeUtils").unixTime(),isViewOnce:!!e.isViewOnce,isReaction:o("WAWebMsgGetters").getIsReaction(e),isForwarded:o("WAWebMsgGetters").getIsForwarded(e),isCommerceMessage:o("WAWebChatThreadLoggingUtils").isCommerceMessage(e),isPdpInquiry:yield c(e),isReply:o("WAWebMsgGetters").getIsReply(e),isEdit:o("WAWebMsgGetters").getIsEditProtocolMsg(e),isBot:o("WAWebMsgGetters").getIsBotQuery(e),isEventCreation:e.type===o("WAWebMsgType").MSG_TYPE.EVENT_CREATION,isEventResponse:e.type===o("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE}])}}),p.apply(this,arguments)}function _(e){e.markMessageSendT(),e.commit()}l.createMessageForwardMetric=s,l.logMessageSendForChatThreadLogging=m,l.logMessageMetric=_}),98);
__d("WAWebErrorType",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["NoError","EditWindowExpired","UserReachedMaxMonthlyLimitForNewMessages"]);i.SendFailureErrorCode=e}),66);
__d("WAWebWamEnumMessageCappingActionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({CLICK:0,VIEW:1,API:2,ENTER:3,DEBUG:4});i.MESSAGE_CAPPING_ACTION_TYPE=e}),66);
__d("WAWebMessageCappingWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMessageCappingActionType","WAWebWamEnumSurfaceType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MessageCapping:[6854,{extraAttributes:[2,e.TYPES.STRING],messageCappingActionType:[6,o("WAWebWamEnumMessageCappingActionType").MESSAGE_CAPPING_ACTION_TYPE],messageCappingEntryPoint:[9,o("WAWebWamEnumSurfaceType").SURFACE_TYPE],messageCappingSequence:[7,e.TYPES.INTEGER],messageCappingSession:[8,e.TYPES.STRING],surface:[4,o("WAWebWamEnumSurfaceType").SURFACE_TYPE],userActionTarget:[5,e.TYPES.STRING]},[1,1,1],"regular"]},{MessageCapping:[]});l.MessageCappingWamEvent=s}),98);
__d("WAWebSendMsgRecordBridge",["WALogger","WAWebAck","WAWebAddOnsUpdateSendStatesAction","WAWebBackendApi","WAWebCreateNackFromStanza","WAWebDBUpdateMessageTable","WAWebErrorType","WAWebHandleMsgError","WAWebIndividualNewChatMessageCappingLimitGatingUtils","WAWebIndividualNewChatMessageCappingLimitUtils","WAWebMessageCappingWamEvent","WAWebMsgUtilsBridge","WAWebSendMsgJob","WAWebSendMsgTypes","WAWebUserPrefsTypes","WAWebWamEnumMessageCappingActionType","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r;t.isForwarded&&(r=o("WAWebMsgUtilsBridge").createMessageForwardMetric(t));try{var a=yield o("WAWebSendMsgJob").encryptAndSendMsg({type:o("WAWebSendMsgTypes").SendMessageRecordType.Message,data:t},n);if(r&&r.then(o("WAWebMsgUtilsBridge").logMessageMetric),a.error!=null)throw new(o("WAWebHandleMsgError")).MessageSentAckError(a.error);return{t:parseInt(a.t,10),count:a.count}}catch(n){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["sendMsgRecord: send failure, msg: ",""])),t.id.toString()).tags("messaging").devConsole(t.type);var i={isSendFailure:!0};throw n instanceof o("WAWebHandleMsgError").MessageSentAckError&&(i=babelHelpers.extends({},i,{ack:o("WAWebAck").ACK.FAILED}),n.ackErrorCode===o("WAWebCreateNackFromStanza").NackReason.NewChatMessagesCapped&&(i=babelHelpers.extends({},i,{errorCode:o("WAWebErrorType").SendFailureErrorCode.UserReachedMaxMonthlyLimitForNewMessages}),o("WAWebIndividualNewChatMessageCappingLimitGatingUtils").isIndividualNewChatMessageCappingEnabled()&&(yield o("WAWebIndividualNewChatMessageCappingLimitUtils").resetCappingStatus(o("WAWebUserPrefsTypes").NewChatMessageCappingStatusType.CAPPED),o("WAWebBackendApi").frontendFireAndForget("individualNewChatMessageCappingStateChange",{}),new(o("WAWebMessageCappingWamEvent")).MessageCappingWamEvent({messageCappingActionType:o("WAWebWamEnumMessageCappingActionType").MESSAGE_CAPPING_ACTION_TYPE.API,userActionTarget:"nack_received",extraAttributes:JSON.stringify(o("WAWebIndividualNewChatMessageCappingLimitUtils").getCappingData()||{})}).commit()))),o("WAWebDBUpdateMessageTable").updateMessageTable(t.id,i),t.set(i),o("WAWebAddOnsUpdateSendStatesAction").updateAddOnSendStatesForMsgAction(t,i),n}}),u.apply(this,arguments)}l.sendMsgRecord=s}),98);
__d("WAWebCommsHandleStanza",["WALogger","WAWap","WAWebCommsHandleWorkerCompatibleStanza","WAWebHandlePairDevice","WAWebHandlePairSuccess","WAWebOfflineHandler","asyncToGeneratorRuntime","cr:12278","err"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t,n){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){var a=e.attrs;if(a.offline){var i=parseInt(a.t,10),l=parseInt(a.offline,10);o("WAWebOfflineHandler").OfflineMessageHandler.newOfflineStanza(i,r,l)}if(e.tag==="iq")return p(e);var s=o("WAWebCommsHandleWorkerCompatibleStanza").handleWorkerCompatibleStanza(e);return s!=null?s:n("cr:12278").handleLoggedInStanza(e,t)}),c.apply(this,arguments)}function d(e,t,n){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){r===void 0&&(r=0);try{var a=yield u(t,n,r);if(a!=null)return a}catch(n){var i,l;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[handleStanza] exception for tag:"," type:"," id:",""])),t.tag,(i=t.attrs)==null?void 0:i.type,(l=t.attrs)==null?void 0:l.id),o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[handleStanza] ",""])),n.stack).sendLogs("handle-stanza")}return"NO_ACK"}),m.apply(this,arguments)}function p(e){var t=e.attrs,n=e.content;if(t.xmlns==="urn:xmpp:ping")return o("WAWap").wap("iq",{type:"result",to:t.from});if(t.xmlns==="md"){if(!Array.isArray(n)||!n.length)return;var a=n[0].tag;switch(a){case"pair-device":return r("WAWebHandlePairDevice")(e);case"pair-success":return r("WAWebHandlePairSuccess")(e)}}else throw r("err")("handleIq unrecognized "+e.toString())}l.default=d}),98);
__d("WAWebDBGetEventMessagesForChat",["Promise","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebSchemaMessage"],(function(t,n,r,o,a,i,l){var e;function s(t,r,a){return(e||(e=n("Promise"))).resolve().then(function(){if(a!=null)return o("WAWebSchemaMessage").getMessageTable().get(a.toString())}).then(function(e){var n=e==null?[o("WAWebDBMessageUtils").endOfChat(t),1/0]:[e.internalId,e.isEventMsg],a=[o("WAWebDBMessageUtils").beginningOfChat(t),0];return o("WAWebSchemaMessage").getMessageTable().between(["internalId","isEventMsg"],a,n,{lowerInclusive:!1,upperInclusive:!1,reverse:!0,limit:r}).then(function(e){return e.map(function(e){return o("WAWebDBMessageSerialization").messageFromDbRow(e)})})})}l.getEventMessagesForChat=s}),98);
__d("WAWebDBMessageFindLocal",["Promise","WAFilteredCatch","WALogger","WATimeUtils","WAWebCallLogMsgData.flow","WAWebDBGetEventMessagesForChat","WAWebDBGetStarredMessagesForChat","WAWebDBMessageSerialization","WAWebDBMessageStoreUtils","WAWebDBMessageUtils","WAWebFtsClient","WAWebMediaHubGating","WAWebModelStorageUtils","WAWebModelStorageVersions","WAWebMsgKey","WAWebMsgType","WAWebSchemaMessage","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime","err","justknobx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p=20,_=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="NoAnchorMessageError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));function f(t,a){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["msgFindQuery: id:"," chat:"," type:",""])),a.id,a.chat,t).devConsole(a);var i=function(){return a.msgKey instanceof r("WAWebMsgKey")?a.msgKey:a.id==null?void 0:new(r("WAWebMsgKey"))(a)};if(a.label!=null)return(m||(m=n("Promise"))).resolve([]);if(t==="before")return B(a,a.count).catch(o("WAFilteredCatch").filteredCatch(_,function(){return{status:404}}));if(t==="after")return q(a,a.count).catch(o("WAFilteredCatch").filteredCatch(_,function(){return{status:404}}));if(t==="star"){var l=a.id==null?void 0:new(r("WAWebMsgKey"))(a);return a.chat!=null?o("WAWebDBGetStarredMessagesForChat").getStarredMessagesForChat(a.chat,a.count,l):C(a.count,l)}else if(t==="call_log"){var u=a.id==null?void 0:new(r("WAWebMsgKey"))(a);return R(a.count,u)}else if(t==="event"){var c=a.id==null?void 0:new(r("WAWebMsgKey"))(a),d=o("WAWebModelStorageUtils").getStorage();return a.chat!=null&&d.doesLocalSchemaIncludeVersion(d.versions.version(152))?o("WAWebDBGetEventMessagesForChat").getEventMessagesForChat(a.chat,a.count,c):F(a.count,c)}else if(t==="search"){var p={};return a.remote&&(p.remote=a.remote.toString()),a.count&&a.page>=0&&(p.limit=a.count,p.page=a.page),o("WAWebFtsClient").ftsClient.search(a.searchTerm,p)}else if(t==="media"){var f=a.remote,g=i(),h=a.media;switch(h){case"allDocs":return w(a.count,g,a.direction);case"allLinks":return N(a.count,g,a.direction);case"allMedia":return $(a.count,g,a.direction);case"url":return y(f,a.count,a.direction,"hasLink",g).then(function(e){return e.map(function(e){return o("WAWebDBMessageSerialization").messageFromDbRow(e)})});case"document":return y(f,a.count,a.direction,"isDocMsg",g).then(function(e){return e.map(function(e){return o("WAWebDBMessageSerialization").messageFromDbRow(e)})});default:return(m||(m=n("Promise"))).all(["isMediaMsg","isDocMsg","hasLink","isCarouselMsg"].map(function(e){return y(f,a.count,a.direction,e,g).then(function(e){return e.map(function(e){return o("WAWebDBMessageSerialization").messageFromDbRow(e)})})})).then(function(e){var t=e[0],n=e[1],r=e[2],o=e[3],a=[t,r,n,o].flat();return{docCount:n.length,linkCount:r.length,mediaCount:t.length,messages:a}})}}return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Message query type "," not implemented."])),t),(m||(m=n("Promise"))).reject(r("err")("Message query type "+t+" not implemented."))}function g(e){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebSchemaMessage").getMessageTable().equals(["vcardWAids"],e.toString()).then(function(e){return e.map(function(e){return o("WAWebDBMessageSerialization").messageFromDbRow(e)})})}),h.apply(this,arguments)}function y(e,t,r,a,i){var l=i==null?(m||(m=n("Promise"))).resolve(void 0):o("WAWebSchemaMessage").getMessageTable().equals(["id"],i.toString());return l.then(function(n){if(i&&n!=null&&n.length===0)throw o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Anchor message "," does not exist in message table"])),i&&i.toString()),new _;var l=n==null?void 0:n[0],s,c,d=!1;return r==="before"?(s=o("WAWebDBMessageUtils").beginningOfChat(e),c=l==null?o("WAWebDBMessageUtils").endOfChat(e):o("WAWebDBMessageUtils").craftInternalId(e.toString(),o("WAWebDBMessageUtils").getInChatMsgId(l.internalId||"")),d=!0):(s=l==null?o("WAWebDBMessageUtils").beginningOfChat(e):o("WAWebDBMessageUtils").craftInternalId(e.toString(),o("WAWebDBMessageUtils").getInChatMsgId(l.internalId||"")),c=o("WAWebDBMessageUtils").endOfChat(e)),o("WAWebSchemaMessage").getMessageTable().between(["internalId",a],[s,0],[c,1/0],{lowerInclusive:!1,upperInclusive:!1,limit:t,reverse:d})})}function C(e,t){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield v(t,function(e){return e==null?void 0:e.isStarred}),r=n[0],a=n[1],i=0;return o("WAWebSchemaMessage").getMessageTable().between(["isStarred"],i,a,{lowerInclusive:!1,upperInclusive:!1,reverse:!0,limit:e}).then(function(e){return e.map(function(e){return o("WAWebDBMessageSerialization").messageFromDbRow(e)})})}),b.apply(this,arguments)}function v(e,t,n,r){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){n===void 0&&(n="before"),r===void 0&&(r=-1/0);var a=null;e!=null&&(a=yield o("WAWebSchemaMessage").getMessageTable().get(e.toString()));var i=a==null?void 0:t(a);return n==="before"?[r,i!=null?i:1/0]:[i!=null?i:r,1/0]}),S.apply(this,arguments)}function R(e,t){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield v(t,function(e){return e==null?void 0:e.isCallLogMsg}),r=n[0],a=n[1],i=yield o("WAWebSchemaMessage").getMessageTable().between(["isCallLogMsg"],r,a,{lowerInclusive:!1,upperInclusive:!0,reverse:!0,limit:e});return i.map(function(e){return o("WAWebDBMessageSerialization").messageFromDbRow(e)})}),L.apply(this,arguments)}function E(){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebSchemaMessage").getMessageTable().equals(["callOutcome"],o("WAWebCallLogMsgData.flow").CallOutcome.Ongoing);return e.map(function(e){return o("WAWebDBMessageSerialization").messageFromDbRow(e)})}),k.apply(this,arguments)}function I(){var e,t=(e=o("WAWebUserPrefsMultiDevice").getPairingTimestamp())!=null?e:o("WATimeUtils").unixTime();return t-o("WATimeUtils").DAY_SECONDS*o("WAWebMediaHubGating").getMaxDaysInMediaHub()}function T(){var e=r("justknobx")._("2155"),t=o("WAWebModelStorageUtils").getStorage(),n=t.doesLocalSchemaIncludeVersion(o("WAWebModelStorageVersions").messageAddMediaRelatedIndex()),a=o("WAWebMediaHubGating").isFilesMediaHubComponentEnabled();return e&&n&&a}function D(e,t,n,r,o,a){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a,i){n===void 0&&(n="before");var l=T(),s=n==="before",u=yield v(t,function(e){return l?e==null?void 0:e.t:e==null?void 0:e[a]},n,r),c=u[0],d=u[1],m=[];if(l){var p=function(t){return[[t,c],[t,d]]};m=yield o("WAWebSchemaMessage").getMessageTable().inAnyRange(["typeFlag","t"],i.map(function(e){return p(e)}),{reverse:s,limit:e})}else m=yield o("WAWebSchemaMessage").getMessageTable().between(["internalId",a],["0",c],["_g",d],{lowerInclusive:!1,upperInclusive:!0,reverse:!0,limit:e}),m=m.filter(function(e){return e.t>(r!=null?r:0)});return m}),x.apply(this,arguments)}function $(e,t,n,r){return P.apply(this,arguments)}function P(){return P=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){r===void 0&&(r=I());var a=T(),i=yield D(e,t,n,a?r:I(),"isMediaMsg",[o("WAWebMsgType").MESSAGE_TYPE_FLAGS.MEDIA_MSG,o("WAWebMsgType").MESSAGE_TYPE_FLAGS.MEDIA_MSG|o("WAWebMsgType").MESSAGE_TYPE_FLAGS.HAS_LINK]);return i.map(function(e){return o("WAWebDBMessageSerialization").messageFromDbRow(e)})}),P.apply(this,arguments)}function N(e,t,n,r){return M.apply(this,arguments)}function M(){return M=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=T(),i=yield D(e,t,n,a?r:void 0,"hasLink",[o("WAWebMsgType").MESSAGE_TYPE_FLAGS.HAS_LINK,o("WAWebMsgType").MESSAGE_TYPE_FLAGS.MEDIA_MSG|o("WAWebMsgType").MESSAGE_TYPE_FLAGS.HAS_LINK,o("WAWebMsgType").MESSAGE_TYPE_FLAGS.DOC_MSG|o("WAWebMsgType").MESSAGE_TYPE_FLAGS.HAS_LINK]);return i.map(function(e){return o("WAWebDBMessageSerialization").messageFromDbRow(e)})}),M.apply(this,arguments)}function w(e,t,n,r){return A.apply(this,arguments)}function A(){return A=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=T(),i=yield D(e,t,n,a?r:void 0,"isDocMsg",[o("WAWebMsgType").MESSAGE_TYPE_FLAGS.DOC_MSG,o("WAWebMsgType").MESSAGE_TYPE_FLAGS.DOC_MSG|o("WAWebMsgType").MESSAGE_TYPE_FLAGS.HAS_LINK]);return i.map(function(e){return o("WAWebDBMessageSerialization").messageFromDbRow(e)})}),A.apply(this,arguments)}function F(e,t){return O.apply(this,arguments)}function O(){return O=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield v(t,function(e){return e==null?void 0:e.isEventMsg}),r=n[0],a=n[1],i=0;return o("WAWebSchemaMessage").getMessageTable().between(["isEventMsg"],i,a,{lowerInclusive:!1,upperInclusive:!1,reverse:!0,limit:e}).then(function(e){return e.map(function(e){return o("WAWebDBMessageSerialization").messageFromDbRow(e)})})}),O.apply(this,arguments)}function B(e,t){return W.apply(this,arguments)}function W(){return W=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(t===void 0&&(t=p),!e.remote)return(m||(m=n("Promise"))).resolve([]);var a=e.remote.toString(),i=void 0;if(e instanceof r("WAWebMsgKey")){var l=yield o("WAWebSchemaMessage").getMessageTable().equals(["id"],e.toString());if(l.length===0)throw o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Anchor message "," does not exist in message table"])),e.toString()),new _;i=l[0]}var s=o("WAWebDBMessageUtils").beginningOfChat(e.remote),u=o("WAWebDBMessageUtils").endOfChat(e.remote);if(i){var c=o("WAWebDBMessageUtils").getInChatMsgId(i.internalId||""),f=Math.max(0,c-t);u=o("WAWebDBMessageUtils").craftInternalId(a,c),s=o("WAWebDBMessageUtils").craftInternalId(a,f)}var g={lowerInclusive:!0,upperInclusive:!1};s=o("WAWebDBMessageUtils").beginningOfChat(e.remote);var h=yield o("WAWebDBMessageStoreUtils").queryChatVisibleMessageHelper(s,u,babelHelpers.extends({},g,{reverse:!0}),t);return h.reverse().map(function(e){return o("WAWebDBMessageSerialization").messageFromDbRow(e)})}),W.apply(this,arguments)}function q(e,t){if(t===void 0&&(t=p),e instanceof r("WAWebMsgKey")){var a=e.remote.toString();return o("WAWebSchemaMessage").getMessageTable().equals(["id"],e.toString()).then(function(n){if(n.length===0)throw o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Anchor message "," does not exist in message table"])),e.toString()),new _;var r=n[0],i=o("WAWebDBMessageUtils").getInChatMsgId(r.internalId||""),l=i+t,s=o("WAWebDBMessageUtils").craftInternalId(a,i),u=o("WAWebDBMessageUtils").craftInternalId(a,l),d={lowerInclusive:!1,upperInclusive:!0};return u=o("WAWebDBMessageUtils").endOfChat(e.remote),o("WAWebDBMessageStoreUtils").queryChatVisibleMessageHelper(s,u,d,t).then(function(e){return e.map(function(e){return o("WAWebDBMessageSerialization").messageFromDbRow(e)})})})}return(m||(m=n("Promise"))).resolve([])}l.msgFindQuery=f,l.queryVcard=g,l.queryMessageType=y,l.getVoipOngoingCallLogMessages=E,l.getMediaAvailableMsgBoundary=I,l.libraryIsChunkEnabled=T,l.getAllMediaMessages=$}),98);
__d("WAWebDBMessageRange",["Promise","WALogger","WALongInt","WANullthrows","WATimeUtils","WAWebDBDeleteAssociatedMsgsByMsgKey","WAWebDBMessageStoreUtils","WAWebDBMessageUtils","WAWebE2EProtoUtils","WAWebLidMigrationUtils","WAWebMessageAssociationGatingUtils","WAWebModelStorageUtils","WAWebMsgKey","WAWebMsgType","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=1e3;function m(e){return o("WAWebSchemaMessage").getMessageTable().between(["messageRangeIndex"],o("WAWebDBMessageStoreUtils").beginningOfMessageRange(e,o("WAWebDBMessageUtils").MessagePropertyType.IncomingChatMessage),o("WAWebDBMessageStoreUtils").endOfMessageRange(e,o("WAWebDBMessageUtils").MessagePropertyType.IncomingChatMessage),{lowerInclusive:!0,reverse:!0,limit:1,shouldDecrypt:!1}).then(function(e){var t;return o("WAWebDBMessageStoreUtils").extractC2STimestampFromMessageRangeIndex((t=e[0])==null?void 0:t.messageRangeIndex)})}function p(e){return o("WAWebSchemaMessage").getMessageTable().between(["messageRangeIndex"],o("WAWebDBMessageStoreUtils").beginningOfMessageRange(e,o("WAWebDBMessageUtils").MessagePropertyType.SystemMessage),o("WAWebDBMessageStoreUtils").endOfMessageRange(e,o("WAWebDBMessageUtils").MessagePropertyType.SystemMessage),{lowerInclusive:!0,reverse:!0,limit:1,shouldDecrypt:!1}).then(function(e){var t;return o("WAWebDBMessageStoreUtils").extractC2STimestampFromMessageRangeIndex((t=e[0])==null?void 0:t.messageRangeIndex)})}function _(e){return o("WAWebSchemaMessage").getMessageTable().between(["messageRangeIndex"],o("WAWebDBMessageStoreUtils").beginningOfMessageRange(e,o("WAWebDBMessageUtils").MessagePropertyType.SystemMessage),o("WAWebDBMessageStoreUtils").endOfMessageRange(e,o("WAWebDBMessageUtils").MessagePropertyType.SystemMessage),{lowerInclusive:!0,reverse:!1,limit:1,shouldDecrypt:!1}).then(function(e){var t;return o("WAWebDBMessageStoreUtils").extractC2STimestampFromMessageRangeIndex((t=e[0])==null?void 0:t.messageRangeIndex)})}function f(e,t){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var a,i,l=o("WAWebSchemaMessage").getMessageTable().between(["messageRangeIndex"],(a=o("WAWebDBMessageStoreUtils")).beginningOfMessageRange(e,(i=o("WAWebDBMessageUtils")).MessagePropertyType.Outgoing,t),a.endOfMessageRange(e,i.MessagePropertyType.Outgoing),{reverse:!0,shouldDecrypt:!1}),s=o("WAWebSchemaMessage").getMessageTable().anyOf(["messageRangeIndex"],[a.beginningOfMessageRange(e,i.MessagePropertyType.IncomingChatMessage,t),a.beginningOfMessageRange(e,i.MessagePropertyType.Outgoing,t),a.beginningOfMessageRange(e,i.MessagePropertyType.Outgoing)],{reverse:!0,shouldDecrypt:!1}),u=yield(c||(c=n("Promise"))).all([l,s]).then(function(e){var t=e[0],n=e[1],a=function(t){return!(t.ack===-1&&t.isSendFailure===!0||t.type===o("WAWebMsgType").MSG_TYPE.AUTOMATED_GREETING_MESSAGE)},i=t.concat(n).filter(a),l=function(t){var e,n=r("WAWebMsgKey").fromString(t.id),a=(e=o("WAWebDBMessageStoreUtils").extractC2STimestampFromMessageRangeIndex(t.messageRangeIndex))!=null?e:void 0,i={key:o("WAWebE2EProtoUtils").msgKeyToProtobuf(n),timestamp:a};return i};return i.map(l)}),m=h(u,d),p=m.messages,_=m.newLastMessageTimestamp;return{messages:p,newLastMessageTimestamp:_}}),g.apply(this,arguments)}function h(e,t){var n=[],a=[];if(e.forEach(function(e){e.timestamp!=null?n.push(e):a.push(e)}),n.length<t)return{messages:e};var i=n.sort(y).slice(0,t),l=i[i.length-1];return E(l.timestamp,"smallestTimestampMessage"),{messages:i.concat(a),newLastMessageTimestamp:o("WALongInt").numberOrThrowIfTooLarge(r("WANullthrows")(l.timestamp))}}function y(e,t){var n=[e,t].map(function(e){return o("WALongInt").numberOrThrowIfTooLarge(r("WANullthrows")(e.timestamp))}),a=n[0],i=n[1];return i-a}function C(e,t,n,r){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=yield o("WAWebSchemaMessage").getMessageTable().between(["messageRangeIndex"],o("WAWebDBMessageStoreUtils").beginningOfMessageRange(e,n),o("WAWebDBMessageStoreUtils").beginningOfMessageRange(e,n,o("WALongInt").numberOrThrowIfTooLarge(t)),{lowerInclusive:!0,upperInclusive:!0,shouldDecrypt:!1});if(n===o("WAWebDBMessageUtils").MessagePropertyType.SystemMessage&&(a=a.filter(function(e){return!o("WAWebDBMessageStoreUtils").isInitialEncryptionMessage(e)})),(r==null?void 0:r.forceDeleteAllMessagesExceptInitialEncryption)===!0)return a.map(function(e){return e.id});if(n===o("WAWebDBMessageUtils").MessagePropertyType.SystemMessage&&(r==null?void 0:r.skipRecentSystemMessages)!==!1&&(a=a.filter(function(e){return!(o("WAWebDBMessageStoreUtils").isSecuritySensitiveMessage(e)&&e.t>o("WATimeUtils").unixTime()-o("WATimeUtils").DAY_SECONDS)})),(r==null?void 0:r.skipStarred)!==!1&&(a=a.filter(function(e){return e.isStarred===void 0})),n===o("WAWebDBMessageUtils").MessagePropertyType.SystemMessage){for(var i,l=a.length-1;l>=0;l--)if(o("WAWebDBMessageStoreUtils").isBizBotDisclosureMessage(a[l])){i=a[l].id;break}i!=null&&(a=a.filter(function(e){return e.id!==i}))}return a.map(function(e){return e.id})}),b.apply(this,arguments)}function v(e,t,n){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a=t.map(function(e){return o("WAWebE2EProtoUtils").protobufToMsgKey(r("WANullthrows")(e.key)).toString()}),i=[];e.isGroup()&&a.forEach(function(e){var t=r("WAWebMsgKey").fromString(e);if(t.fromMe){var n=o("WAWebLidMigrationUtils").getAlternateMsgKey(t);n&&i.push(n.toString())}});var l=yield o("WAWebSchemaMessage").getMessageTable().bulkGet(a.concat(i)),s=[];return l.forEach(function(e){e!=null&&((n==null?void 0:n.skipStarred)!==!1&&e.isStarred!=null||s.push(e.id))}),s}),S.apply(this,arguments)}function R(e,t,r){var a=t.lastMessageTimestamp,i=t.lastSystemMessageTimestamp,l=t.messages;return o("WAWebModelStorageUtils").getStorage().lock(["message","message-association"],(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var s,u=t[0],d=[],m=[];a!=null&&(m.push(C(e,a,o("WAWebDBMessageUtils").MessagePropertyType.IncomingChatMessage,r)),m.push(C(e,a,o("WAWebDBMessageUtils").MessagePropertyType.Outgoing,r)));var p=i!=null?i:a;p!=null&&m.push(C(e,p,o("WAWebDBMessageUtils").MessagePropertyType.SystemMessage,r)),m.push(v(e,l,r));var _=yield(c||(c=n("Promise"))).all(m);d=(s=d).concat.apply(s,_);var f=r==null?void 0:r.skipMessages;f&&(d=d.filter(function(e){return!f.has(e)}));var g=[u.bulkRemove(d)];return o("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&g.push(o("WAWebDBDeleteAssociatedMsgsByMsgKey").bulkDeleteMessagesByMsgKeys(d)),yield c.all(g),d});return function(e){return t.apply(this,arguments)}})())}function L(t){var n,r,a=t.messages,i={messages:a,lastMessageTimestamp:t.lastMessageTimestamp};if(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: additionalMessages length: ",""])),a.length),a.length>d){var l=h(a,d),s=l.messages,u=l.newLastMessageTimestamp;u!=null&&(i.lastMessageTimestamp=u,E(i.lastMessageTimestamp,"resultantRange")),i.messages=s}return o("WALongInt").numberOrThrowIfTooLarge((n=t.lastSystemMessageTimestamp)!=null?n:0)>o("WALongInt").numberOrThrowIfTooLarge((r=i.lastMessageTimestamp)!=null?r:0)&&(i.lastSystemMessageTimestamp=t.lastSystemMessageTimestamp),i}function E(e,t){try{o("WALongInt").numberOrThrowIfTooLarge(e!=null?e:0)/o("WATimeUtils").unixTime()>10&&o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: large timestamp: "," returned a large timestamp: ",""])),t,e).sendLogs("syncd: "+t+" returned a large timestamp")}catch(t){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: error reporting logMaybeMillisecondTimestamp for ",": ",""])),e,t)}}var k={limitAdditionalMessages:h};l.getLastMessageTimestamp=m,l.getLastSystemMessageTimestamp=p,l.getFirstSystemMessageTimestamp=_,l.getAdditionalMessages=f,l.timestampComparison=y,l.deleteMessagesInMessageRange=R,l.fixMessageRange=L,l.logMaybeMillisecondTimestamp=E,l._test=k}),98);
__d("WAWebReparseRichResponseMsgs",["Promise","WAWebBackendApi","WAWebBotGating","WAWebCmd","WAWebDBMessageSerialization","WAWebMessageProcessDBPipeline","WAWebRichResponse.flow","WAWebRichResponseParseUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(o("WAWebBotGating").isRichStructuredResponseReceiverEnabled()){var r=t.map(function(e){var t=o("WAWebDBMessageSerialization").messageFromDbRow(e),n=t.richResponse;if(n==null||n.parseState===o("WAWebRichResponse.flow").RichResponseParseState.Parsed)return null;var r=o("WAWebRichResponseParseUtils").parseRichResponse(n);return r.parseState===o("WAWebRichResponse.flow").RichResponseParseState.Unparsed?null:babelHelpers.extends({},t,{richResponse:r})}).filter(Boolean);r.length!==0&&(yield o("WAWebMessageProcessDBPipeline").processMsgDataDBPipeline(r,!0),o("WAWebCmd").Cmd.isMainStreamReadyMd&&(yield(e||(e=n("Promise"))).all(r.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebBackendApi").frontendSendAndReceive("updateMessageUI",{chatId:e.id.remote,msg:e})});return function(t){return e.apply(this,arguments)}})()))))}}),u.apply(this,arguments)}l.reparseRichResponseMsgs=s}),98);
__d("WAWebDBMessageStoreUtils",["WALogger","WAWebABProps","WAWebAck","WAWebAddonGatingUtils","WAWebApiMessageInfoStore","WAWebBotGating","WAWebDBAddOnProviders","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebFutureproofReparseMsgsAction","WAWebGroupMetadataCollection","WAWebGroupUtils","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebPerformanceUtils","WAWebReparseRichResponseMsgs","WAWebRichResponse.flow","WAWebSchemaMessage","WAWebViewMode.flow","WAWebViewModeUtils","WAWebWid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=["limit"],s,u,c,d,m,p,_,f,g=10,h=1e9;function y(e){var t=e.toString(16);return(t.length-1).toString(16)+t}function C(e){if(e==null||e.length<3)return null;var t=e.split("_")[2];return t?o("WAWebDBMessageUtils").undoOrderPreservingHex(t):null}function b(e,t,n){var r=n!=null?y(n):"";return e.toString()+"_"+t+"_"+r}function v(e,t){return e.toString()+"_"+t+"_g"}function S(e,t,n){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield o("WAWebSchemaMessage").getMessageTable().between(["internalId"],e,t,n),a=r.filter(function(e){return $(e)});return yield P(a),a}),R.apply(this,arguments)}function L(){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebSchemaMessage").getMessageTable().startsWithAnyOf(["internalId"],[o("WAWebDBMessageUtils").InternalIdPrefix.GroupStatus]);return e}),E.apply(this,arguments)}function k(e){if(!o("WAWebGroupUtils").INVALID_CAG_NON_ADMIN_SYSTEM_MSG_SUBTYPES.has(e.subtype)||!r("WAWebWid").isGroup(e.from))return!1;var t=r("WAWebGroupMetadataCollection").get(e.from);if(t==null||!t.isCag)return!1;var n=t.participants.iAmAdmin();return!n}function I(e,t,n,r,o){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r,a,i){i===void 0&&(i=[]);var l=r.limit,s=babelHelpers.objectWithoutPropertiesLoose(r,e),u=o("WAWebABProps").getABPropConfigValue("web_init_chat_max_unread_message_count"),c=[],f=[],g=0,h=0,y=function(t){return h++,a!=null&&g===a?!0:($(t,i)&&(o("WAWebViewModeUtils").isViewModeVisibleInSurface(o("WAWebViewMode.flow").ViewModeSurface.CHAT,t.viewMode)&&g++,g>u&&o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["queryChatVisibleMessageHelper: visibleMsgsCount exceeds the threshold"])))),!1)},C=self.performance.now(),b=yield o("WAWebSchemaMessage").getMessageTable().between(["internalId"],t,n,s,y);o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["queryChatVisibleMessageHelper: took ",", visit ",", visiable ",""])),o("WAWebPerformanceUtils").getElapsedTimeMs(C),h,g);var v=b.filter(function(e){if(D(e)){var t=o("WAWebDBMessageSerialization").messageFromDbRow(e),n=o("WAWebDBAddOnProviders").getAddOnProviderForFutureproofMsg(t);e.futureproofReparsed!==!0&&(!n||n!=null&&n.canRenderInUi(t)&&!i.includes(e.id.toString()))&&c.push(e)}else x(e)&&o("WAWebBotGating").isRichStructuredResponseReceiverEnabled()&&f.push(e);return!(!$(e,i)||k(e))});return yield P(v),c.length&&(o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["queryChatVisibleMessageHelper: starting process "," futureproofedMessages"])),c.length),o("WAWebFutureproofReparseMsgsAction").processFutureproof(c)),f.length&&(o("WALogger").DEV(_||(_=babelHelpers.taggedTemplateLiteralLoose(["queryChatVisibleMessageHelper: starting process "," unparsedRichResponseMessages"])),f.length),o("WAWebReparseRichResponseMsgs").reparseRichResponseMsgs(f)),v}),T.apply(this,arguments)}function D(e){return e.type===o("WAWebMsgType").MSG_TYPE.UNKNOWN}function x(e){var t;return e.type===o("WAWebMsgType").MSG_TYPE.RICH_RESPONSE&&((t=e.richResponse)==null?void 0:t.parseState)!==o("WAWebRichResponse.flow").RichResponseParseState.Parsed}function $(e,t){t===void 0&&(t=[]);var n=o("WAWebDBMessageSerialization").messageFromDbRow(e),r=A(e),a=o("WAWebDBAddOnProviders").getAddOnProviderForFutureproofMsg(n);return!(r||D(e)&&e.futureproofReparsed===!0||a&&a.canRenderInUi(n)&&!t.includes(e.id.toString())||e.type===o("WAWebMsgType").MSG_TYPE.DEBUG||!o("WAWebBotGating").isBizBot1pEnabled()&&e.type===o("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&e.subtype==="biz_bot_1p_disclosure")}function P(e){return N.apply(this,arguments)}function N(){return N=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=M(e);if(t.length!==0){var n=yield o("WAWebApiMessageInfoStore").getHighestMsgAcks(t.map(function(e){return r("WAWebMsgKey").from(e.id)})),a=[];t.forEach(function(e){var t=e.ack,r=e.id,i=n.get(r);i!=null&&(i>t&&(a.push({id:r,ack:i}),e.ack=i),a.length>0&&(o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["maybeUpdateMsgAck: storing ack updates ",""])),JSON.stringify(a)).tags("message-store"),o("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(a)))})}}),N.apply(this,arguments)}function M(e){return e.filter(function(e){if(!o("WAWebMsgGetters").getIsUnreadType(e)||e.type===o("WAWebMsgType").MSG_TYPE.CIPHERTEXT||e.type===o("WAWebMsgType").MSG_TYPE.UNKNOWN||e.ack<=o("WAWebAck").ACK.CLOCK)return!1;var t=r("WAWebMsgKey").fromString(e.id);if(!t.fromMe)return!1;if(t.remote.isGroup()&&(e.rowId!=null&&e.rowId<h||e.count==null))return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["getMsgMayNeedAckUpdate: skip update for history group message ",""])),e.id).tags("message-store"),!1;if(o("WAWebMsgGetters").getIsAckPlayable(e)){if(e.ack===o("WAWebAck").ACK.PLAYED)return!1}else if(e.ack===o("WAWebAck").ACK.READ)return!1;return!0})}function w(e,t){var n,r=self.performance.now(),a=o("WAWebABProps").getABPropConfigValue("web_init_chat_max_unread_message_count"),i,l=e.unreadCount,s=(n=e.unreadDividerOffset)!=null?n:0,d=void 0,m=void 0,p=void 0,_=0,f=[],h=0,y=function(r){if(k(r)||(_++,r.type===o("WAWebMsgType").MSG_TYPE.PROTOCOL))return!1;var n=o("WAWebDBMessageSerialization").messageFromDbRow(r),c=A(r);if(c)return!1;if(D(r)){var y=o("WAWebDBAddOnProviders").getAddOnProviderForFutureproofMsg(n);if(r.futureproofReparsed===!0)return!1;if(!t)f.push(r);else if(y!=null&&y.canRenderInUi(n))return a!==0&&h>=a?(p==null&&(p=r.id),m||(o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage] getKeyMsgsFromChatHistory: Exceeded limit "," to find a non futureproof reaction message"])),a),m=r),!0):(h++,!1)}if(p==null&&(p=r.id),m||(m=r),!d&&!c&&r.botPluginReferenceIndex==null&&o("WAWebViewModeUtils").isViewModeVisibleInSurface(o("WAWebViewMode.flow").ViewModeSurface.CHAT_LIST,r.viewMode)&&![o("WAWebMsgType").MSG_TYPE.E2E_NOTIFICATION,o("WAWebMsgType").MSG_TYPE.PROTOCOL,o("WAWebMsgType").MSG_TYPE.DEBUG].includes(r.type)&&(d=r),!t&&(d!=null||_>g))return!0;if(l===0&&s>0)if(r.type===o("WAWebMsgType").MSG_TYPE.REVOKED){if(s-=1,s===0)return i=r.id.toString(),!0}else return!0;return!!((l===0&&s===0||a!==0&&e.unreadCount>=a)&&d||l>0&&o("WAWebMsgGetters").getIsUnreadType(r)&&(l-=1,l===0&&(i=r.id.toString(),s===0)))};return o("WAWebSchemaMessage").getMessageTable().between(["internalId"],e.id+"_/",e.id+"_g",{reverse:!0},y).then(function(){return o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage] getKeyMsgsFromChatHistory: ",", chatId: ",", isActiveChat: ",", count: ",", chatUnread: ",", unreadMsgCounter: ",""])),o("WAWebPerformanceUtils").getElapsedTimeMs(r),e.id,t,_,e.unreadCount,l),f.length&&o("WAWebFutureproofReparseMsgsAction").processFutureproof(f),{anchor:i,previewMsg:d||m,lastReceivedKey:p}})}function A(e){if(e.type===o("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT)return!0;var t=e.futureproofType;return t!=null?o("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(t):o("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(e.type)}function F(e){var t,n=new Map([[o("WAWebMsgType").MSG_TYPE.GP2,["remove","add","ephemeral","invite","leave"]],[o("WAWebMsgType").MSG_TYPE.E2E_NOTIFICATION,["encrypt","encrypt_now","e2e_identity_unavailable","identity","device","chat_psa"]],[o("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE,["change_number","masked_thread_created","cag_masked_thread_created","verified_initial_unknown","verified_initial_low","verified_initial_high","verified_transition_any_to_none","verified_transition_any_to_high","verified_transition_high_to_low","verified_transition_high_to_unknown","verified_transition_unknown_to_low","verified_transition_low_to_unknown","verified_transition_none_to_low","verified_transition_none_to_unknown","payment_transaction_status_update_failed","payment_transaction_status_update_refunded","payment_transaction_status_update_refund_failed","payment_transaction_status_receiver_pending_setup","payment_transaction_status_receiver_success_after_hiccup","payment_transaction_request_cancelled","payment_action_account_setup_reminder","payment_action_send_payment_reminder","payment_action_send_payment_invitation","payment_action_request_declined","payment_action_request_expired","biz_bot_1p_disclosure","biz_bot_3p_disclosure","bot_init"]]]);return((t=n.get(e.type))==null?void 0:t.includes(e.subtype))||!1}function O(e,t){return o("WAWebSchemaMessage").getMessageTable().between(["internalId"],e+"_/",e+"_g",{reverse:!0},t)}function B(e){return e.type===o("WAWebMsgType").MSG_TYPE.E2E_NOTIFICATION&&e.subtype==="encrypt"||e.type===o("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&e.subtype==="biz_privacy_mode_init_fb"||e.type===o("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&e.subtype==="biz_me_account_type_is_hosted"||e.type===o("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&e.subtype==="biz_me_account_type_is_hosted_transition"||e.type===o("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&e.subtype==="biz_account_type_is_hosted"||e.type===o("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&e.subtype==="biz_account_type_changed_to_hosted"}function W(e){return e.type===o("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&(e.subtype==="biz_bot_1p_disclosure"||e.subtype==="biz_bot_3p_disclosure")}l.extractC2STimestampFromMessageRangeIndex=C,l.beginningOfMessageRange=b,l.endOfMessageRange=v,l.queryChatMessageHelper=S,l.queryGroupStatusMsgsHelper=L,l.queryChatVisibleMessageHelper=I,l.shouldRenderInUI=$,l.getKeyMsgsFromChatHistory=w,l.isSecuritySensitiveMessage=F,l.getMessagesBefore=O,l.isInitialEncryptionMessage=B,l.isBizBotDisclosureMessage=W}),98);
__d("WAWebGroupUnreadMessageType",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["NEW_MESSAGE","PERSISTANCE_LOAD","HISTORYC_SYNC_CHUNK"]);i.UnreadMessageType=e}),66);
__d("WAWebUnreadMentionModel",["WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.timestamp=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="unreadMention";var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebDBProcessInitialHistorySyncMessage",["Promise","WALogger","WAPromiseReduce","WATimeUtils","WAWeb-dexie","WAWebApiChat","WAWebApiGroupInviteV4Store","WAWebChatCollection","WAWebDBEncryptMultipleMsgs","WAWebDBGroupHistoryPreProcessor","WAWebDBReportingTokenUtils","WAWebDBStoreMessage","WAWebDbEncryptionKey","WAWebFtsClient","WAWebGroupUnreadMessageType","WAWebLinkify","WAWebMessageAssociationGatingUtils","WAWebMsgGetters","WAWebMsgType","WAWebNoop","WAWebSchemaFtsIndexingQueue","WAWebSchemaMessage","WAWebSchemaMessageAssociation","WAWebThreadCommonModelUtils","WAWebThreadMetadataBulkJob","WAWebThreadMsgUtils","WAWebUnreadMentionModel","WAWebWidFactory","asyncToGeneratorRuntime","lodash"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f=1e9;function g(e){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){yield o("WAWebDbEncryptionKey").DbEncKeyStore.waitForFinalDbMsgEncKey();var a=0;r("lodash").forOwn(t,function(e){var t=e.msgs;return a+=t.length});var i=new Map,l=new Map;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[history sync] start storing initial sync messages."])));var g=yield o("WAPromiseReduce").promiseReduce(Object.keys(t),(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,n){var r=e.nextRowId,a=b(t,n),l=yield y(t[n].chatInfo.unreadCount||0,t[n].msgs),c=l.pendingUnreadIds,d=l.unreadMentions;d.length&&i.set(n,d);for(var m=[],p=a,_=0;_<t[n].msgs.length;_++){var f=t[n].msgs[_];try{var g=yield o("WAWebDBEncryptMultipleMsgs").processAndEncryptSingleMsgRow(f);r++,p=p+1+o("WAWebDBGroupHistoryPreProcessor").getBumpIdCountForGroupJoin(f),f.isMdHistoryMsg=!0;var h=o("WAWebDBStoreMessage").addMsgMetadataToMsgRow({msg:g[0],chatId:o("WAWebWidFactory").createWid(n).toString(),hasLink:o("WAWebLinkify").hasHttpLink(f),rowId:r,inChatMsgId:p,pendingReadReceipt:c.has(String(f.id))});m.push(h)}catch(e){var C,v;if(e instanceof o("WAWebDBEncryptMultipleMsgs").DroppingMsgRowDueToLogout)throw e;o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["storeInitialSyncMessages failed for msg: "," from ",""])),(C=f.id)==null?void 0:C.id,(v=f.id)==null?void 0:v.remote).tags("message-store-optimized"),o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["storeInitialSyncMessages failed with error: ",", message: ",", stack: ",""])),e.name,e.message,e.stack).tags("message-store-optimized").devConsole(e)}}return{nextRowId:r,messages:e.messages.concat(m)}});return function(t,n){return e.apply(this,arguments)}})(),{nextRowId:f-a,messages:[]}),h=[],C=[];g.messages.forEach(function(e){e.type===o("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE&&o("WAWebApiGroupInviteV4Store").persistGroupInviteV4Msg(e.id.toString(),{id:e.id.toString(),from:e.from.toString(),to:e.to.toString(),groupId:e.inviteGrp,expiration:parseInt(e.inviteCodeExp,10),expired:o("WATimeUtils").unixTime()>=parseInt(e.inviteCodeExp,10)}),e.associationType!=null&&o("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&h.push({msgKey:e.id.toString(),parentMsgKey:e.parentMsgKey.toString(),associationType:e.associationType,msgKeyInternalId:e.internalId}),o("WAWebThreadMsgUtils").isThreadMsg(e)&&C.push(e)});var v=[o("WAWebSchemaMessage").getMessageTable().bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(g.messages)];if(h.length&&v.push(o("WAWebSchemaMessageAssociation").getMessageAssociationTable().bulkCreate(h)),C.length){var S=o("WAWebThreadCommonModelUtils").getAggregatedThreadDetailUpdatesFromMessages(C);v.push(o("WAWebThreadMetadataBulkJob").bulkCreateOrUpdateThreadsMetadata(S))}return o("WAWebDBReportingTokenUtils").handleHistorySyncedReportingInfo(g.messages),i.size&&(i.forEach(function(e,t){var n,a,i=o("WAWebChatCollection").ChatCollection.get(o("WAWebWidFactory").createWid(t)),s=e.map(function(e){var t=e.id,n=e.timestamp;return new(r("WAWebUnreadMentionModel"))({id:t,timestamp:n})}),u=i==null||(n=i.groupMetadata)==null?void 0:n.unreadMentionMetadata,c=(a=u==null?void 0:u.pendingUnreadMentionCount)!=null?a:0;u!=null&&u.pendingUnreadMentionCount&&(u.pendingUnreadMentionCount=Math.max(c-s.length,0),l.set(t,u.pendingUnreadMentionCount)),u==null||u.addUnreadMentions(s,o("WAWebGroupUnreadMessageType").UnreadMessageType.HISTORYC_SYNC_CHUNK)}),o("WAWebApiChat").addUnreadMentionChat(i,l)),(_||(_=n("Promise"))).all(v).catch(function(e){if(o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Error storing initial sync messages with error "," with optimization"])),e),e instanceof r("WAWeb-dexie").BulkError||e instanceof r("WAWeb-dexie").ConstraintError)return o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Retrying initial sync bulk add on error"]))).tags("history-sync-initial-sync-optimized"),o("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(g.messages);throw e}).then(function(){r("WAWeb-dexie").ignoreTransaction(function(){o("WAWebSchemaFtsIndexingQueue").getFtsIndexingQueueTable().bulkCreateOrReplace(g.messages.map(function(e){return{id:String(e.rowId)}})).then(function(){o("WAWebFtsClient").ftsClient.index().catch(r("WAWebNoop"))})})}).catch(function(e){o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Error storing initial sync messages with error "," after retry"])),e).devConsole(e);var t=g.messages.map(function(e){return e.id.toString()});o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history sync] additional information: messages length: ",", ids: ",""])),t.length,t).devConsole(e)})}),h.apply(this,arguments)}function y(e,t){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){for(var n=e,r=new Set,a=[],i=t.length-1;i>=0&&!(n<=0);i--){var l=t[i],s=o("WAWebDBStoreMessage").isPendingUnreadReceipt(l.id,l);if(s&&(n--,r.add(String(l.id)),o("WAWebMsgGetters").getIsImportantMessage(l))){var u={id:String(l.id),timestamp:l.t};a.push(u)}}return{pendingUnreadIds:r,unreadMentions:a}}),C.apply(this,arguments)}function b(e,t){var n=e[t].msgs.reduce(function(e,t){return e+o("WAWebDBGroupHistoryPreProcessor").getBumpIdCountForGroupJoin(t)},0);return f-e[t].msgs.length-n}l.storeInitialSyncMessages=g}),98);
__d("WAWebDBQueryAndRemoveMessageHistory",["Promise","WAWebDBDeleteAssociatedMsgsByMsgKey","WAWebDBMessageRange","WAWebDBMessageUtils","WAWebFtsClient","WAWebMessageAssociationGatingUtils","WAWebNoop","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebDBMessageUtils").beginningOfChat(e),n=o("WAWebDBMessageUtils").endOfChat(e),r=yield o("WAWebSchemaMessage").getMessageTable().between(["internalId"],t,n,{lowerInclusive:!1,upperInclusive:!1,limit:1});if(r.length===0)return null;var a=r[0].rowId,i=yield o("WAWebSchemaMessage").getMessageTable().between(["internalId"],t,n,{lowerInclusive:!1,upperInclusive:!1,limit:1,reverse:!0});if(i.length===0)return null;var l=i[0].rowId,s=i[0].t;return a==null||l==null?null:{startRowId:a,endRowId:l,tsOfLastMessage:s}}),u.apply(this,arguments)}function c(e,t,n){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a=yield o("WAWebDBMessageRange").deleteMessagesInMessageRange(e,t,n);return o("WAWebFtsClient").ftsClient.purge(a).catch(r("WAWebNoop")),a}),d.apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=o("WAWebDBMessageUtils").beginningOfChat(t),a=o("WAWebDBMessageUtils").endOfChat(t),i=yield o("WAWebSchemaMessage").getMessageTable().between(["internalId"],r,a,{lowerInclusive:!1,upperInclusive:!1,returnKeyType:"primary_key"}),l=[o("WAWebSchemaMessage").getMessageTable().bulkRemove(i)];return o("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&l.push(o("WAWebDBDeleteAssociatedMsgsByMsgKey").bulkDeleteMessagesByMsgKeys(i)),yield(e||(e=n("Promise"))).all(l),i}),p.apply(this,arguments)}l.getBoundsForChat=s,l.queryAndRemoveMessagesInMessageRange=c,l.queryAndRemoveMessageHistory=m}),98);
__d("WAWebGroupsPrivacyTokenUtils",["WAWebSchemaChat","WAWebTrustedContactsUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.tcToken,n=e.tcTokenTimestamp;return t==null||n==null||o("WAWebTrustedContactsUtils").isTokenExpired(n,o("WAWebTrustedContactsUtils").TcTokenMode.Receiver)?null:{anyElementValue:new Uint8Array(t)}}function s(t,n){var r=new Map;return n.map(function(n){var o=t.find(function(e){return(e==null?void 0:e.id)===n.toString()});o!=null&&r.set(n,e(o))}),r}function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebSchemaChat").getChatTable().bulkGet(e.map(function(e){return e.toString()}),!0);return s(t,e)}),c.apply(this,arguments)}l.getPermissionTokenMap=s,l.getPermissionTokenMapForChatIds=u}),98);
__d("WAWebMexFetchTextStatusListJobQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"XWA2TextStatus",kind:"LinkedField",name:"xwa2_text_status_list",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"jid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"last_update_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ephemeral_duration_sec",storageKey:null},{alias:null,args:null,concreteType:"XWA2TextStatusEmoji",kind:"LinkedField",name:"emoji",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebMexFetchTextStatusListJobQuery",selections:t,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebMexFetchTextStatusListJobQuery",selections:t},params:{id:"24072923595647473",metadata:{},name:"WAWebMexFetchTextStatusListJobQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebMexFetchTextStatusListJob",["WALogger","WAWebGroupsPrivacyTokenUtils","WAWebMexClient","WAWebMexFetchTextStatusListJobQuery.graphql","WAWebPrivacyGatingUtils","WAWebTrustedContactsUtils","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e,t){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a){if(!r("WAWebWid").isWid(t)||!t.isUser())throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MEX][TEXT-STATUS] this method should only take user wid, instead it received: ",""])),t.toLogString()).sendLogs("mex-text-status-list-invalid-wid"),r("err")("[MEX][TEXT-STATUS] this method should only take user wid, instead it received: "+t.toLogString());var i={jid:t.toJid(),last_update_time:a==null?void 0:a.toString()};if(o("WAWebPrivacyGatingUtils").isProfileScrappingProtectionInMexFetchEnabled()){var l,c=yield o("WAWebGroupsPrivacyTokenUtils").getPermissionTokenMapForChatIds([t]),d=(l=c.get(t))==null?void 0:l.anyElementValue;d!=null&&(i.privacy_token={tctoken:o("WAWebTrustedContactsUtils").encodeTcTokenForMex(d.buffer)})}var p=e!==void 0?e:e=n("WAWebMexFetchTextStatusListJobQuery.graphql"),_={input:[i]},f=yield o("WAWebMexClient").fetchQuery(p,_),g=f.xwa2_text_status_list,h=g[0],y=h==null?void 0:h.text;o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[MEX][TEXT-STATUS] fetched text status for ",""])),h.jid).tags("GQL","MEX").devConsole(y,f);var C=m(h);return{id:C.id,text:C.textStatusString,emoji:C.textStatusEmoji,lastUpdateTime:C.textStatusLastUpdateTime,ephemeralDurationSeconds:C.textStatusEphemeralDuration}}),d.apply(this,arguments)}function m(e){var t;return{id:o("WAWebWidFactory").createWid(e.jid),textStatusString:e.text,textStatusEmoji:(t=e.emoji)==null?void 0:t.content,textStatusEphemeralDuration:e.ephemeral_duration_sec,textStatusLastUpdateTime:Number(e.last_update_time)}}l.mexGetTextStatusList=c,l.parseTextStatusServerResponse=m}),98);
__d("WAWebContactTextStatusBridge",["WALogger","WAWebMexFetchTextStatusListJob","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){try{var r=yield o("WAWebMexFetchTextStatusListJob").mexGetTextStatusList(t,n);return{id:r.id,text:r.text,emoji:r.emoji,lastUpdateTime:r.lastUpdateTime,ephemeralDurationSeconds:r.ephemeralDurationSeconds}}catch(n){return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getTextStatus: failed "," : ",""])),n.statusCode,n.message),{id:t,error:n,text:""}}}),u.apply(this,arguments)}function c(e,t,n,r){return o("WAWebPersistedJobManager").getJobManager().waitUntilCompleted(o("WAWebPersistedJobDefinitions").jobSerializers.setTextStatus(e,t,n,r))}l.getTextStatus=s,l.setTextStatus=c}),98);
__d("WAWebGetDisappearingModeJob",["Promise","WALogger","WAWebUsync","WAWebUsyncUser","WAWebWid","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(!r("WAWebWid").isWid(t)||!t.isUser())return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getDisappearingMode: this method should only take user wid, instead it received: ",""])),t),(u||(u=n("Promise"))).resolve({id:t});var a=new(o("WAWebUsync")).USyncQuery().withContext("interactive").withMode("query").withDisappearingModeProtocol().withUser(new(o("WAWebUsyncUser")).USyncUser().withId(t)),i=yield a.execute();if(i.error.all||i.error.status){var l=i.error.all||i.error.status;return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["getDisappearingMode: failed "," : ",""])),l.errorCode,l.errorText),{id:t,error:l}}var c=i.list;if(c.length===0||c[0].disappearing_mode==null)return(u||(u=n("Promise"))).reject(r("err")("no disappearing_mode data returned for user"));var d=c[0].disappearing_mode,m=d.duration,p=d.t;return{id:t,disappearingModeDuration:m,disappearingModeSettingTimestamp:p}}),d.apply(this,arguments)}l.getDisappearingMode=c}),98);
__d("WAWebTextStatusGatingUtils",["WAWebABProps","WAWebPrimaryFeatures"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebABProps").getABPropConfigValue("evolve_about_m1_receiver_enabled")}function s(){return e()&&o("WAWebABProps").getABPropConfigValue("evolve_about_m1_receiver_for_new_surfaces_enabled")}function u(){return o("WAWebABProps").getABPropConfigValue("web_evolve_about_send_enabled")&&o("WAWebPrimaryFeatures").primaryFeatureEnabled("text_status_creation_support")}l.receiveTextStatusEnabled=e,l.receiveTextStatusForNewSurfacesEnabled=s,l.sendTextStatusEnabled=u}),98);
__d("WAWebDBUpdateContactTable",["WAJids","WAWebLidAwareContactsDB"],(function(t,n,r,o,a,i,l){function e(e,t){var n=e.isLid()?o("WAJids").toLidUserJid(e.user):o("WAJids").toPhoneUserJid(e.user);return r("WAWebLidAwareContactsDB").merge(n,t)}l.updateContactTable=e}),98);
__d("WAWebUpdateDisappearingModeForContact",["WALogger","WAWebApiContact","WAWebBackendApi","WAWebDBUpdateContactTable","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t,n){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){var a=o("WAWebWidFactory").createUserWidOrThrow(t.user,t.server),i=yield o("WAWebApiContact").getContactRecord(a);if(i){var l=i.disappearingModeSettingTimestamp;if(l==null&&r!==0||l!=null&&l<r){var s={disappearingModeDuration:n,disappearingModeSettingTimestamp:r};yield o("WAWebDBUpdateContactTable").updateContactTable(a,s),o("WAWebBackendApi").frontendFireAndForget("updateDisappearingMode",babelHelpers.extends({},s,{contactId:a})),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["updateDisappearingMode: Contact="," updated, new duration="," t=","."])),a.toLogString(),n,r).tags("DM","DDM")}}}),u.apply(this,arguments)}l.updateDisappearingModeForContact=s}),98);
__d("WAWebTextStatusUtils",["WATimeUtils","WAWebTextStatusGatingUtils","fbs"],(function(t,n,r,o,a,i,l){var e=-1,s=5,u=0,c=null,d=null,m=null,p=-1;function _(e,t,n,r,a){var i=a===p||r!=null&&o("WATimeUtils").unixTime()<r,l=!!e||!!t,s=n!==u;return s&&i&&l}function f(t,n,r,a,i){return!(!o("WAWebTextStatusGatingUtils").receiveTextStatusEnabled()||r===e||!_(t,n,r,a,i))}var g="",h=" ";function y(e){return e.status===void 0}function C(e){var t=r("fbs")._(/*BTDS*/"\u00a1Hola! Estoy usando WhatsApp.").toString();return e.status!==g&&e.status!==void 0&&e.status!==h&&e.status!==t}l.TEXT_STATUS_NOT_FETCHED=e,l.SUGGESTIONS_MAX_COUNT=s,l.CLEAR_TEXT_STATUS_LAST_UPDATE_TIME_VAL=u,l.CLEAR_TEXT_STATUS_STRING_VAL=c,l.CLEAR_TEXT_STATUS_EMOJI_VAL=d,l.CLEAR_TEXT_STATUS_EPHEMERAL_DURATION_VAL=m,l.TEXT_STATUS_DURATION_INFINITE=p,l.hasTextStatusSet=_,l.shouldDisplayTextStatus=f,l.EMPTY_ABOUT=g,l.EMPTY_MIGRATED_ABOUT=h,l.isLegacyAboutNotFetched=y,l.hasCustomAboutSet=C}),226);
__d("WAWebUpdateTextStatusForContact",["WAWebApiContact","WAWebBackendApi","WAWebDBUpdateContactTable","WAWebTextStatusUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t,n,r,o){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a){var i=o("WAWebWidFactory").createUserWidOrThrow(e.user,e.server),l=yield o("WAWebApiContact").getContactRecord(i);if(l){var s=l.textStatusLastUpdateTime;if(a==null||s!=null&&a!==o("WAWebTextStatusUtils").CLEAR_TEXT_STATUS_LAST_UPDATE_TIME_VAL&&a<s)return;var u;r!=null&&r>0&&a!==o("WAWebTextStatusUtils").CLEAR_TEXT_STATUS_LAST_UPDATE_TIME_VAL&&(u=Number(a)+Number(r));var c={textStatusString:t,textStatusEmoji:n,textStatusEphemeralDuration:r,textStatusLastUpdateTime:a,textStatusExpiryTs:u};yield o("WAWebDBUpdateContactTable").updateContactTable(i,babelHelpers.extends({},c)),o("WAWebBackendApi").frontendFireAndForget("updateTextStatus",babelHelpers.extends({},c,{contactId:i}))}}),s.apply(this,arguments)}l.updateTextStatusForContact=e}),98);
__d("WAWebHandleAccountSyncNotification",["Promise","WADeprecatedWapParser","WAJids","WALogger","WATimeUtils","WAWap","WAWebABProps","WAWebAccountSyncJob","WAWebAdvHandlerApi","WAWebApiPendingDeviceSync","WAWebBackendApi","WAWebBizCoexGatingUtils","WAWebBizCoexUtils","WAWebCmd","WAWebCommsWapMd","WAWebContactTextStatusBridge","WAWebGetAboutQueryJob","WAWebGetDisappearingModeJob","WAWebJidToWid","WAWebMarketingMessagesUserFeedbackGatingUtils","WAWebMexFetchTextStatusListJob","WAWebMexUsersGetAboutStatus","WAWebOfflineDeviceCache","WAWebOfflineHandler","WAWebPDFNTypes","WAWebQueryBlockListJob","WAWebSetUsernameJob","WAWebSignalCommonUtils","WAWebSignalStoreApi","WAWebTextStatusGatingUtils","WAWebUpdateDisappearingModeForContact","WAWebUpdateTextStatusForContact","WAWebUserDisclosureCollection","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebUsernameGatingUtils","WAWebWidFactory","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p=function(t){var e=t.maybeChild("key-index-list"),n=e==null?null:{ts:e.attrTime("ts"),signedKeyIndexBytes:e.hasContent()?e.contentBytes():null,expectedTs:e.hasAttr("expected_ts")?e.attrTime("expected_ts"):void 0},r=t.mapChildrenWithTag("device",function(e){var n,r=e.attrDeviceJid("jid");if(o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(r!=null&&r.endsWith("@hosted")||r!=null&&r.endsWith("@hosted.lid"))){var a,i=(a=o("WAWebWidFactory").createHostedDeviceWidOrThrow(r))==null?void 0:a.device;if(i==null||i!==o("WAWebBizCoexUtils").HOSTED_DEVICE_ID)throw t.createParseError("invalid hosted device jid");return{id:i,keyIndex:e.hasAttr("key-index")?e.attrInt("key-index"):null,isHosted:!0}}return{id:(n=o("WAWebWidFactory").createWid(e.attrDeviceJid("jid")).device)!=null?n:o("WAJids").DEFAULT_DEVICE_ID,keyIndex:e.hasAttr("key-index")?e.attrInt("key-index"):null}});return o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()||(r=r.filter(function(e){return e.id!==o("WAWebBizCoexUtils").HOSTED_DEVICE_ID})),r.length===0?null:{deviceList:r,keyIndex:n}},_=new(r("WADeprecatedWapParser"))("incomingAccountSyncNotification",function(e){e.assertTag("notification");var t={stanzaId:e.attrString("id"),ts:e.attrTime("t"),from:o("WAWebJidToWid").deviceJidToDeviceWid(e.attrDeviceJid("from"))};if(e.hasChild("status")){var n=e.child("status"),r=n.hasAttr("action")?n.attrString("action"):void 0;return babelHelpers.extends({type:o("WAWebAccountSyncJob").AccountSyncType.STATUS,action:r},t)}else if(e.hasChild("text_status")){var a=e.child("text_status"),i=a.hasAttr("action")?a.attrString("action"):void 0,l=a.hasAttr("text")?a.attrString("text"):void 0,s=a.hasChild("emoji")?a.child("emoji"):void 0,u=s!=null&&s.hasAttr("content")?s==null?void 0:s.attrString("content"):void 0,c=a.hasAttr("ephemeral_duration_sec")?a.attrInt("ephemeral_duration_sec"):void 0,d=a.hasAttr("last_update_time")?a.attrString("last_update_time"):void 0;return babelHelpers.extends({type:o("WAWebAccountSyncJob").AccountSyncType.TEXT_STATUS,action:i,text:l,emoji:u,ephemeralDurationSeconds:c,lastUpdateTime:d},t)}else{if(e.hasChild("privacy"))return babelHelpers.extends({type:o("WAWebAccountSyncJob").AccountSyncType.PRIVACY},t);if(e.hasChild("devices"))return babelHelpers.extends({type:o("WAWebAccountSyncJob").AccountSyncType.DEVICES,devices:p(e.child("devices"))},t);if(e.hasChild("blocklist")){var m=e.child("blocklist"),_=[];return o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&m.forEachChildWithTag("item",function(e){var t=e.maybeAttrString("username"),n=o("WAWebJidToWid").userJidToUserWid(e.attrUserJid("jid"));t!=null&&_.push({userId:n,username:t})}),babelHelpers.extends({type:o("WAWebAccountSyncJob").AccountSyncType.BLOCKLIST,usernames:_},t)}else{if(e.hasChild("picture"))return babelHelpers.extends({type:o("WAWebAccountSyncJob").AccountSyncType.PICTURE},t);if(e.hasChild("tos")){var f=e.child("tos"),g=[];return f.forEachChildWithTag("notice",function(e){var t=e.maybeAttrString("state")!=="false",n=e.attrString("id");g.push({id:n,state:t})}),babelHelpers.extends({type:o("WAWebAccountSyncJob").AccountSyncType.TOS,notices:g},t)}else if(e.hasChild("disappearing_mode")){var h=e.child("disappearing_mode"),y,C,b;return h.hasAttr("action")?y=h.attrString("action"):(C=h.attrInt("duration"),b=h.attrInt("t")),babelHelpers.extends({},t,{type:o("WAWebAccountSyncJob").AccountSyncType.DISAPPEARING_MODE,action:y,disappearingModeDuration:C,disappearingModeSettingTimestamp:b})}else if(e.hasChild("notice")){var v=e.child("notice");return babelHelpers.extends({type:o("WAWebAccountSyncJob").AccountSyncType.NOTICE,noticeId:v.attrString("id"),noticeStage:v.maybeAttrString("stage"),noticeVersion:v.maybeAttrString("version"),noticeTimestamp:v.attrInt("t")},t)}else if(e.hasChild("user")){var S=e.child("user"),R=S.maybeAttrString("state")==="AI available";return babelHelpers.extends({type:o("WAWebAccountSyncJob").AccountSyncType.USER,isAiAvailable:R},t)}else if(e.hasChild("biz_opt_out_list")){var L=e.child("biz_opt_out_list"),E=L.mapChildren(function(e){return{action:e.attrString("action"),biz_jid:e.attrUserJid("biz_jid")}}),k=L.maybeAttrString("dhash"),I=L.maybeAttrString("prev_dhash");return babelHelpers.extends({type:o("WAWebAccountSyncJob").AccountSyncType.OPTOUTLIST,list:E,dhash:k,prevDhash:I},t)}}}throw e.createParseError("notification type not supported")});function f(){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),r;if(o("WAWebABProps").getABPropConfigValue("mex_usync_about_status")){var a=yield o("WAWebMexUsersGetAboutStatus").getMexUsersAboutStatus({wid:t,tcToken:null}),i=a.status,l=a.state;l==null&&(r=i)}else{var s=yield o("WAWebGetAboutQueryJob").getAbout({wid:t,tcToken:null});if(s.error)return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getStatus failed for ",": failed "," : ",""])),t,s.error.errorCode,s.error.errorText),(m||(m=n("Promise"))).reject(s.error.errorText);r=s.status}r!==""&&(yield o("WAWebBackendApi").frontendSendAndReceive("setMyStatus",{status:r}))}),g.apply(this,arguments)}function h(){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow(),t=yield o("WAWebContactTextStatusBridge").getTextStatus(e);if(t.error)return(m||(m=n("Promise"))).reject(t.error.message);var r=t.id,a=t.text,i=t.emoji,l=t.ephemeralDurationSeconds,s=t.lastUpdateTime,u=o("WAWebMexFetchTextStatusListJob").parseTextStatusServerResponse({text:a,emoji:i!=null?{content:i}:null,ephemeral_duration_sec:l,last_update_time:s.toString(),jid:r.toJid()});return o("WAWebUpdateTextStatusForContact").updateTextStatusForContact(u.id,u.textStatusString,u.textStatusEmoji,u.textStatusEphemeralDuration,u.textStatusLastUpdateTime)}),y.apply(this,arguments)}function C(e){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.wid,n=e.devices,r=o("WAWebUserPrefsMeUser").getMeLidUserOrThrow(),a=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),i={wid:t,devices:n};if(!t.isSameAccountAndAddressingMode(a))return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["wid-is-not-self"]))).sendLogs("wid-is-not-self"),[i];var l=yield o("WAWebSignalStoreApi").waSignalStore.bulkGetIdentity([o("WAWebSignalCommonUtils").createSignalAddress(a),o("WAWebSignalCommonUtils").createSignalAddress(r)]),u=l[0],c=l[1];return c==null&&u!=null&&(yield o("WAWebSignalStoreApi").waSignalStore.putIdentity(o("WAWebSignalCommonUtils").createSignalAddress(r).toString(),u)),[i,{wid:r,devices:n}]}),b.apply(this,arguments)}function v(e){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=_.parse(e);if(t.error)return o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["error while parsing: ",""])),e.toString()),o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Parsing Error: ",""])),t.error.toString()),(m||(m=n("Promise"))).reject(t.error);var r=t.success,a=o("WAWap").wap("ack",{id:o("WAWap").CUSTOM_STRING(r.stanzaId),to:o("WAWebCommsWapMd").JID(r.from),class:"notification",type:"account_sync"});switch(r.type){case o("WAWebAccountSyncJob").AccountSyncType.STATUS:yield f();break;case o("WAWebAccountSyncJob").AccountSyncType.TEXT_STATUS:if(!o("WAWebTextStatusGatingUtils").receiveTextStatusEnabled())break;if(r.action==="modify")yield h();else{var i=r.text,l=r.emoji,s=r.ephemeralDurationSeconds,p=r.lastUpdateTime,g=o("WAWebWidFactory").asUserWidOrThrow(r.from);yield o("WAWebUpdateTextStatusForContact").updateTextStatusForContact(g,i,l,s,p!=null?Number(p):void 0)}break;case o("WAWebAccountSyncJob").AccountSyncType.DEVICES:{if(o("WAWebOfflineHandler").OfflineMessageHandler.isResumeFromRestartComplete()){if(o("WAWebOfflineHandler").OfflineMessageHandler.isResumeOnSocketDisconnectInProgress())return yield o("WAWebApiPendingDeviceSync").addUserToPendingDeviceSync([r.from.toString()]),a}else return o("WAWebOfflineDeviceCache").OfflinePendingDeviceCache.addOfflinePendingDevice(r.from.toString(),a),"NO_ACK";var y=r.devices;if(y){var b=yield C({wid:o("WAWebWidFactory").asUserWidOrThrow(r.from),devices:y});yield o("WAWebAdvHandlerApi").handleADVDeviceSyncResult(b)}else yield o("WAWebAccountSyncJob").getDevices("notification");break}case o("WAWebAccountSyncJob").AccountSyncType.PICTURE:yield o("WAWebAccountSyncJob").getAndUpdateProfilePicture();break;case o("WAWebAccountSyncJob").AccountSyncType.PRIVACY:o("WAWebCmd").Cmd.onAccountSyncForPrivacy(yield o("WAWebAccountSyncJob").updatePrivacySettings());break;case o("WAWebAccountSyncJob").AccountSyncType.BLOCKLIST:o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&r.usernames!=null&&(yield o("WAWebSetUsernameJob").setUsernamesJob(r.usernames)),o("WAWebQueryBlockListJob").fetchAndUpdateBlocklist();break;case o("WAWebAccountSyncJob").AccountSyncType.OPTOUTLIST:{var v=o("WAWebUserPrefsMultiDevice").getOptOutListHash(),S=r.dhash,R=r.prevDhash,L=r.list;if(o("WAWebMarketingMessagesUserFeedbackGatingUtils").isMMOptOutListServerSyncEnabled()&&v!==R){o("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("updateOptOutList");break}else S!=null&&(L==null||L.forEach((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.action,n=e.biz_jid,r=t==="block",a=o("WAWebJidToWid").userJidToUserWid(n);yield o("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("updateOptOutListModelInCollection",{targetWid:a,isBlocked:r})});return function(t){return e.apply(this,arguments)}})()),yield o("WAWebUserPrefsMultiDevice").setOptOutlistHash(S));break}case o("WAWebAccountSyncJob").AccountSyncType.TOS:r.notices&&o("WAWebAccountSyncJob").updateTosStateFromAccountSync(r.notices);break;case o("WAWebAccountSyncJob").AccountSyncType.DISAPPEARING_MODE:{var E=r.action,k=r.from,I=r.disappearingModeDuration,T=r.disappearingModeSettingTimestamp;if(E==="modify"){var D=yield o("WAWebGetDisappearingModeJob").getDisappearingMode(k);D.error==null&&D.disappearingModeDuration!=null&&D.disappearingModeSettingTimestamp!=null&&(I=D.disappearingModeDuration,T=D.disappearingModeSettingTimestamp)}I!=null&&T!=null&&(yield o("WAWebUpdateDisappearingModeForContact").updateDisappearingModeForContact(k,I,T));break}case o("WAWebAccountSyncJob").AccountSyncType.NOTICE:{var x=r.noticeId,$=r.noticeStage,P=r.noticeVersion,N=r.noticeTimestamp;if(x!=null&&x!==""&&$!=null&&P!=null&&N!=null){var M=$===o("WAWebPDFNTypes").NOTICE_STAGES.PDFN_ACCEPTED;yield o("WAWebUserDisclosureCollection").UserDisclosureCollection.updateNoticeStage({id:x,accepted:M,policyVersion:P}),o("WAWebAccountSyncJob").updateTosStateFromAccountSync([{id:x,state:M,timestamp:o("WATimeUtils").castToUnixTime(N)}])}break}case o("WAWebAccountSyncJob").AccountSyncType.USER:{r.isAiAvailable===!0&&o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Receieved account sync notification for Ai Available"])));break}}return a}),S.apply(this,arguments)}l.getAndUpdateStatus=f,l.getDeviceSyncInputs=C,l.handleAccountSyncNotification=v}),98);
__d("WAWebHandlePairDevice",["Promise","WABinary","WALogger","WAShiftTimer","WASmaxMdSetToCompanionRPC","WAWebAdvSignatureApi","WAWebConnModel","WAWebNetworkStatus","WAWebSocketConstants","WAWebSocketModel","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u=6e4,c=20*1e3,d=[],m=null;function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r;try{r=o("WASmaxMdSetToCompanionRPC").receiveSetToCompanionRPC(t)}catch(t){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["handlePairDevice: error: ",""])),t.toString()),(s||(s=n("Promise"))).reject(t)}var a=r,i=a.parsedRequest,l=a.makeSetToCompanionResponseClientResponse,u=i.pairDeviceRef.map(function(e){var t=new(o("WABinary")).Binary(e.elementValue);return t.readString(t.size())});return f(u),l()}),_.apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield o("WAWebAdvSignatureApi").generateADVSecretKey(),d=e,m||(m=new(o("WAShiftTimer")).ShiftTimer(function(){if(o("WAWebUserPrefsMultiDevice").isRegistered()||!r("WAWebNetworkStatus").online)m&&m.cancel(),m=null;else if(!d||!d.length)m&&m.cancel(),m=null,o("WAWebSocketModel").Socket.state=o("WAWebSocketConstants").SOCKET_STATE.UNPAIRED_IDLE;else{var e=d.length===6?u:c,t=d.shift();o("WAWebConnModel").Conn.set({ref:t,refTTL:e}),o("WAWebSocketModel").Socket.state=o("WAWebSocketConstants").SOCKET_STATE.UNPAIRED,m&&m.onOrAfter(e)}})),m.forceRunNow()}),g.apply(this,arguments)}l.default=p}),98);
__d("WAWebMdClientSessionIdUtils",["WABase64","WABinary","WACryptoSha256","WALogger","WAWebAltDeviceLinkingApi","WAWebConnModel","WAWebUserPrefsInfoStore","asyncToGeneratorRuntime","justknobx"],(function(t,n,r,o,a,i,l){var e,s;function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebAltDeviceLinkingApi").getPairingType();return t===o("WAWebAltDeviceLinkingApi").PairingType.ALT_DEVICE_LINKING&&r("justknobx")._("527")?d():p(e)}),c.apply(this,arguments)}function d(){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["genMdClientSessionId for ADL flow"])));var t=o("WAWebAltDeviceLinkingApi").getCurrentRef(),n=o("WAWebAltDeviceLinkingApi").getCurrentHelloCached();if(t==null||(n==null?void 0:n.linkCodePairingWrappedCompanionEphemeralPub)==null)return null;var r=n.linkCodePairingWrappedCompanionEphemeralPub;if(r.byteLength===0||t.byteLength===0)return null;var a=new(o("WABinary")).Binary;a.writeBuffer(r),a.writeByteArray(t);var i=a.readByteArrayView(),l=yield o("WACryptoSha256").sha256(i);return o("WABase64").encodeB64(l)}),m.apply(this,arguments)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t;o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["genMdClientSessionId for QR Code flow (or ADL flow if jk is disabled)"])));var n=yield o("WAWebUserPrefsInfoStore").waNoiseInfo.get();if(!n)return null;var r=n==null||(t=n.staticKeyPair)==null?void 0:t.pubKey,a=o("WAWebConnModel").Conn.ref;if(!a||a.length===0||e.byteLength===0||r.byteLength===0)return null;var i=new(o("WABinary")).Binary;i.writeBuffer(e),i.writeBuffer(r);for(var l=0;l<a.length;l++)i.write(a.charCodeAt(l));var u=i.readByteArrayView(),c=yield o("WACryptoSha256").sha256(u);return o("WABase64").encodeB64(c)}),_.apply(this,arguments)}l.genMdClientSessionId=u}),98);
__d("WAWebQrDeviceLinkingQpl",["WAQplTypes","WAWebAltDeviceLinkingApi","WAWebAutoLogoutGating","WAWebLinkDeviceExperience","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","justknobx"],(function(t,n,r,o,a,i,l){var e,s=(e=r("justknobx")._("4967"))!=null?e:3e5,u=function(t){return window.addEventListener("beforeunload",t),function(){window.removeEventListener("beforeunload",t)}},c=(function(){function e(){}var t=e.prototype;return t.$4=function(t){var e,n;(e=this.$1)==null||e.end(t),this.$1=null,window.clearTimeout(this.$2),(n=this.$3)==null||n.call(this)},t.initialize=function(t){var e=this;this.$1!=null&&this.$4(o("WAQplTypes").QuickLogActionType.ABORTED),r("justknobx")._("4836")&&(this.$1=o("WAWebQplQuickPerformanceLoggerModule").QPL.markerStart(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.COMPANION_DEVICE_LINKING_SCREEN,{trackedForLoss:!0,cancelOnUnload:!0,annotations:{bool:{in_auto_logout_iframe:o("WAWebAutoLogoutGating").isRunningInAutoLogoutIframe()},int:{md_link_device_experience_id:o("WAWebLinkDeviceExperience").getWebCompanionLinkDeviceExperienceId(t)},string:{code_type:o("WAWebAltDeviceLinkingApi").PairingType.QR_CODE}}})),this.$2=window.setTimeout(function(){var t;(t=e.$1)==null||t.addPoint("timeout_expired_2min"),e.$4(o("WAQplTypes").QuickLogActionType.TIMEOUT)},s),this.$3=u(function(){var t;(t=e.$1)==null||t.addPoint("before_unload"),e.$4(o("WAQplTypes").QuickLogActionType.CANCEL_UNLOAD)})},t.switchToPhoneNumber=function(){var e;(e=this.$1)==null||e.addPoint("switch_to_phone_number"),this.$4(o("WAQplTypes").QuickLogActionType.ABORTED)},t.qrCodeInitialised=function(){var e;(e=this.$1)==null||e.addPoint("qr_code_initialised")},t.qrCodeRefreshed=function(){var e;(e=this.$1)==null||e.addPoint("qr_code_refreshed")},t.qrCodeRegRefreshed=function(){var e;(e=this.$1)==null||e.addPoint("qr_code_reg_refreshed")},t.qrCodeExpired=function(){var e;(e=this.$1)==null||e.addPoint("qr_code_expired")},t.qrCodeReloaded=function(){var e;(e=this.$1)==null||e.addPoint("qr_code_reloaded")},t.regRefreshNotificationReceived=function(){var e;(e=this.$1)==null||e.addPoint("companion_reg_refresh_notification_received")},t.pairStarted=function(){var e;(e=this.$1)==null||e.addPoint("pair_started")},t.pairSuccess=function(){var e;(e=this.$1)==null||e.addPoint("pair_success"),this.$4(o("WAQplTypes").QuickLogActionType.SUCCESS)},t.pairFailed=function(){var e;(e=this.$1)==null||e.addPoint("pair_failed"),this.$4(o("WAQplTypes").QuickLogActionType.FAIL)},t.stayLoggedInToggleClicked=function(t){var e;(e=this.$1)==null||e.addPoint(t?"stay_logged_in_enabled":"stay_logged_in_disabled"),this.$4(o("WAQplTypes").QuickLogActionType.ABORTED)},e})(),d=new c;l.companionDeviceLinkingScreenQpl=d}),98);
__d("WAWebSyncdSnapshotRecoveryGatingUtils",["WASyncdConst","WAWebABProps","WAWebSyncdError","WAWebUserPrefsIndexedDBStorage","WAWebWamEnumRecoveryStatusEnum","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(){return o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WAPrimaryDeviceSupportsSyncdRecovery")===!0}function s(){return e()?o("WAWebABProps").getABPropConfigValue("enable_peer_snapshot_recovery"):!1}function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set("WAPrimaryDeviceSupportsSyncdRecovery",e)}),c.apply(this,arguments)}function d(t,n,r){if(!(r instanceof o("WAWebSyncdError").SyncdFatalError))return{shouldPerformRecovery:!1,reason:o("WAWebWamEnumRecoveryStatusEnum").RECOVERY_STATUS_ENUM.NOT_FATAL};if(!s())return{shouldPerformRecovery:!1,reason:e()?o("WAWebWamEnumRecoveryStatusEnum").RECOVERY_STATUS_ENUM.ABPROP_OFF:o("WAWebWamEnumRecoveryStatusEnum").RECOVERY_STATUS_ENUM.PRIMARY_UNSUPPORTED};if(t===o("WASyncdConst").CollectionName.CriticalBlock)return{shouldPerformRecovery:!1,reason:o("WAWebWamEnumRecoveryStatusEnum").RECOVERY_STATUS_ENUM.COLLECTION_UNSUPPORTED};var a=o("WAWebABProps").getABPropConfigValue("max_mutations_for_sync_recovery");return n>a?{shouldPerformRecovery:!1,reason:o("WAWebWamEnumRecoveryStatusEnum").RECOVERY_STATUS_ENUM.MUTATION_COUNT_TOO_HIGH}:{shouldPerformRecovery:!0}}l.syncdSnapshotRecoveryEnabled=s,l.updatePrimaryDeviceSupportsSyncdRecovery=u,l.shouldPreformSnapshotRecovery=d}),98);
__d("WAWebHandlePairSuccess",["invariant","Promise","WABase64","WABinary","WACryptoHmac","WAJids","WALogger","WANullthrows","WAQplTypes","WASmaxMdSetRegRPC","WATimeUtils","WAWebAdvSignatureApi","WAWebAltDeviceLinkingApi","WAWebAppTracker","WAWebBizAgentAction","WAWebBizCoexGatingUtils","WAWebCompanionRegUtils","WAWebConnModel","WAWebCryptoCurve25519","WAWebE2ETestPairingConstants","WAWebEnvironment","WAWebFtsClient","WAWebJidToWid","WAWebLid11MigrationLifecycleWamEvent","WAWebLid1X1MigrationGating","WAWebLocalStorage","WAWebLogoutReasonConstants","WAWebMdClientSessionIdUtils","WAWebMobilePlatforms","WAWebProtobufsAdv.pb","WAWebProtobufsCompanionReg.pb","WAWebQrDeviceLinkingQpl","WAWebSignalCommonUtils","WAWebSignalStoreApi","WAWebSocketLogoutJob","WAWebSyncdSnapshotRecoveryGatingUtils","WAWebUserPrefsHistorySync","WAWebUserPrefsInfoStore","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebUserPrefsTypes","WAWebViewerContextAuthUtils","WAWebWamDeviceLinkReporter","WAWebWamEnumMdLinkDeviceCompanionStage","WAWebWamEnumMigrationStageEnum","WAWebWidFactory","asyncToGeneratorRuntime","cr:1064","cr:17219","decodeProtobuf","encodeProtobuf","gkx"],(function(t,n,r,o,a,i,l,s){var e,u,c,d,m,p,_,f=!1;function g(e){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(r("gkx")("26256")&&(r("WAWebLocalStorage")==null||r("WAWebLocalStorage").removeItem(o("WAWebE2ETestPairingConstants").PAIRING_ATTEMPT_ONGOING_KEY)),!(f||o("WAWebUserPrefsMultiDevice").isRegistered())){f=!0;var a=o("WATimeUtils").unixTimeWithoutClockSkewCorrection(),i=null;try{i=o("WASmaxMdSetRegRPC").receiveSetRegRPC(t)}catch(r){return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["error while parsing: ",""])),t.toString()),o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Parsing Error: ",""])),r.toString()),f=!1,(_||(_=n("Promise"))).reject(r)}var l=i,d=l.parsedRequest,m=l.makeSetRegResponseClientResponse,p=l.makeSetRegResponseError;try{if(o("WAWebCompanionRegUtils").resetCompanionReg(),o("WAWebUserPrefsMultiDevice").setPairingTimestamp(a),o("WAWebAppTracker").AppTracker.start(o("WAWebAppTracker").AppTrackerType.Registration),o("WAWebAltDeviceLinkingApi").getPairingType()===o("WAWebAltDeviceLinkingApi").PairingType.ALT_DEVICE_LINKING){var g,h;(g=o("WAWebAltDeviceLinkingApi").getCurrentMarker())==null||g.addPoint("alt_linking_pair_success"),(h=o("WAWebAltDeviceLinkingApi").getCurrentMarker())==null||h.end(o("WAQplTypes").QuickLogActionType.SUCCESS)}else o("WAWebAltDeviceLinkingApi").getPairingType()===o("WAWebAltDeviceLinkingApi").PairingType.QR_CODE&&o("WAWebQrDeviceLinkingQpl").companionDeviceLinkingScreenQpl.pairStarted();var C=d.pairSuccessDeviceJid,v=d.pairSuccessDeviceIdentityElementValue,S=d.pairSuccessPlatformName,R=d.pairSuccessDeviceLid,L=d.pairSuccessClientProps,E=d.pairSuccessEncryptionMetadata;o("WAWebConnModel").Conn.blockStoreAdds=!1,o("WAWebConnModel").Conn.platform=S,yield o("WAWebMobilePlatforms").setMobilePlatform(S),o("WAWebUserPrefsMeUser").setMe(o("WAWebJidToWid").deviceJidToDeviceWid(C)),R!=null&&o("WAWebUserPrefsMeUser").setMeLid(o("WAWebJidToWid").deviceJidToDeviceWid(R)),L&&(yield y(L));var k=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsAdv.pb").ADVSignedDeviceIdentityHMACSpec,v),I=k.details,T=k.hmac;I!=null&&T!=null||s(0,56299);var D=new(o("WABinary")).Binary(I).readByteArrayView();o("WAWebBizCoexGatingUtils").smbHostedPrimaryPairingAllowed()&&k.accountType===o("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(yield o("WAWebUserPrefsMultiDevice").setIsHostedMeAccount(),D=o("WABinary").Binary.build(o("WAWebAdvSignatureApi").ADV_HOSTED_PREFIX_DEVICE_IDENTITY_ACCOUNT_SIGNATURE,r("WANullthrows")(I)).readByteArrayView());var x=yield o("WAWebAdvSignatureApi").getADVSecretKey(),$=yield o("WACryptoHmac").hmacSha256(x,D),P=o("WABase64").encodeB64($),N=o("WABase64").encodeB64(T);if(P!==N)return o("WAWebCompanionRegUtils").logoutAfterValidationFail(),f=!1,o("WAWebQrDeviceLinkingQpl").companionDeviceLinkingScreenQpl.pairFailed(),p();var M=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsAdv.pb").ADVSignedDeviceIdentitySpec,I),w=M.accountSignatureKey;w!=null||s(0,56344);var A=M.accountSignature;A!=null||s(0,56295);var F=yield o("WAWebSignalStoreApi").waSignalStore.getRegistrationInfo();F!=null||s(0,56296);var O=yield o("WAWebWamDeviceLinkReporter").initDeviceLinkEvent(w,F.identityKeyPair.pubKey,a),B=yield o("WAWebMdClientSessionIdUtils").genMdClientSessionId(w);yield o("WAWebWamDeviceLinkReporter").setDeviceLinkPairStage(o("WAWebWamEnumMdLinkDeviceCompanionStage").MD_LINK_DEVICE_COMPANION_STAGE.PAIR_SUCCESS_RECEIVED),o("WAWebCompanionRegUtils").initDevicePairingLatencyMeasurement();var W=o("WAWebAdvSignatureApi").verifyDeviceIdentityAccountSignature(M,F.identityKeyPair.pubKey,null);if(!W)return yield o("WAWebWamDeviceLinkReporter").commitDeviceLinkEvent(401),o("WAWebCompanionRegUtils").logoutAfterValidationFail(),f=!1,o("WAWebQrDeviceLinkingQpl").companionDeviceLinkingScreenQpl.pairFailed(),p();M.deviceSignature=yield o("WAWebAdvSignatureApi").generateDeviceSignature(M,F.identityKeyPair,w),yield o("WAWebSignalStoreApi").waSignalStore.putIdentity(o("WAWebSignalCommonUtils").createSignalAddress(o("WAWebWidFactory").asUserWidOrThrow(o("WAWebJidToWid").deviceJidToDeviceWid(C))).toString(),o("WAWebSignalCommonUtils").bufferToStr(o("WAWebCryptoCurve25519").toSignalCurvePubKey(w))),yield o("WAWebAdvSignatureApi").setADVSignedIdentity(M);var q=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsAdv.pb").ADVDeviceIdentitySpec,M.details),U=q.keyIndex;U!=null||s(0,56297),M.accountSignatureKey=void 0;var V=o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsAdv.pb").ADVSignedDeviceIdentitySpec,M).readByteArrayView(),H=m({deviceIdentityElementValue:V,deviceIdentityKeyIndex:U});if(r("WAWebEnvironment").isWindows){var G,z,j=yield o("WAWebUserPrefsInfoStore").waNoiseInfo.get(),K=j==null||(G=j.staticKeyPair)==null?void 0:G.privKey,Q=K!=null?o("WABase64").encodeB64(K):"";yield n("cr:17219")==null||(z=n("cr:17219").getWindowsBridge())==null||(z=z.getClientKeyBridge())==null?void 0:z.setClientKey(Q),yield o("WAWebFtsClient").ftsClient.initExternalStorage()}yield o("WAWebWamDeviceLinkReporter").setDeviceLinkPairStage(o("WAWebWamEnumMdLinkDeviceCompanionStage").MD_LINK_DEVICE_COMPANION_STAGE.PAIR_DEVICE_SIGN_SENT);var X=yield o("WAWebUserPrefsHistorySync").getInitialHistorySyncComplete();return X!==!0&&o("WAWebCompanionRegUtils").startInitialHistorySyncTimeout(),f=!1,o("WAWebBizAgentAction").setShouldLogAgentLogin({loginTimestamp:a}),o("WAWebQrDeviceLinkingQpl").companionDeviceLinkingScreenQpl.pairSuccess(),n("cr:1064")==null||n("cr:1064").setMdSessionId(O),B!=null&&(n("cr:1064")==null||n("cr:1064").setMdClientSessionId(B)),n("cr:1064")==null||n("cr:1064").trigger("post_pair_success"),r("gkx")("20050")&&(yield b(E,R!=null?R:C)),H}catch(e){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["error in handlePairSuccess, ",""])),e).verbose().devConsole(e).sendLogs("error in handlePairSuccess"),o("WAWebQrDeviceLinkingQpl").companionDeviceLinkingScreenQpl.pairFailed(),yield o("WAWebWamDeviceLinkReporter").commitDeviceLinkEvent(-1),yield o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.UnknownCompanion)}finally{o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.Registration)}}}),h.apply(this,arguments)}function y(e){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsCompanionReg.pb").ClientPairingPropsSpec,e.elementValue),n=t.isChatDbLidMigrated,r=t.isSyncdSnapshotRecoveryEnabled,a=t.isSyncdPureLidSession;n===!0&&(yield o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.setIsLidMigrated(!0,o("WAWebUserPrefsTypes").LidMigrationSource.HISTORY,a),new(o("WAWebLid11MigrationLifecycleWamEvent")).Lid11MigrationLifecycleWamEvent({migrationStage:o("WAWebWamEnumMigrationStageEnum").MIGRATION_STAGE_ENUM.COMPANION_MIGRATED_ON_NEW_PAIRING,webClientDidPairingStanzaIndicated1x1MigrationThisSession:!0,isLocally1x1MigratedFromDb:o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()}).commit()),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[syncd snapshot recovery] isSyncdSnapshotRecoveryEnabled: ",""])),r),yield o("WAWebSyncdSnapshotRecoveryGatingUtils").updatePrimaryDeviceSupportsSyncdRecovery(r===!0)}),C.apply(this,arguments)}function b(e,t){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[vc-auth] begin viewer context auth process"])));try{if(e==null||t==null)return;var n=yield o("WAWebViewerContextAuthUtils").decryptNonce(e);if(n==null)return;var r=o("WAWebViewerContextAuthUtils").parseNoncePayload(n);if(r==null)return;var a=o("WAJids").extractDeviceId(t),i=yield o("WAWebViewerContextAuthUtils").exchangeNonceForToken({userId:r.fbid,deviceId:a,nonce:r.nonce});i&&o("WAWebViewerContextAuthUtils").setViewerContextReady()}catch(e){o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[vc-auth] unexpected error in viewer context auth process: ",""])),String(e)).sendLogs("vc-auth-error")}}),v.apply(this,arguments)}l.default=g}),98);
__d("WAWebHandleBusinessNameChangeLidHelpers",["Promise","WAWebBizGatingUtils","WAWebHandleBusinessRemoval","WAWebLidMigrationUtils","WAWebModelStorageUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return e.map(function(e){var t=o("WAWebBizGatingUtils").isLidMigrationForVnameEnabled()?o("WAWebLidMigrationUtils").getPnAndLidToUpdate(e.id):[e.id];return t.map(function(t){return babelHelpers.extends({},e,{id:t})})}).reduce(function(e,t){return e.concat(t)},[])}function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){return o("WAWebModelStorageUtils").getStorage().lock(["contact","verified-business-name"],function(r){var a=r[0],i=r[1],l=o("WAWebBizGatingUtils").isLidMigrationForVnameEnabled()?o("WAWebLidMigrationUtils").getPnAndLidToUpdate(t):[t];return(e||(e=n("Promise"))).all([].concat(l.map(o("WAWebHandleBusinessRemoval").removeBusinessPropsFromContact),l.map(function(e){return o("WAWebHandleBusinessRemoval").removeVerifiedName(i,e)})))})}),c.apply(this,arguments)}l.getVerifiedNamesToUpdateLidAware=s,l.removeVerifiedNameFromTableLidAware=u}),98);
__d("WAWebHandleBusinessRemoval",["WAWebApiContact","WAWebBackendApi","WAWebContactCollection","WAWebHandleBusinessNameChangeLidHelpers","WAWebLidAwareContactsDB","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.toString(),n=yield r("WAWebLidAwareContactsDB").get(t);if(n!=null)return n.isBusiness=!1,n.verifiedLevel=0,n.verifiedName="",r("WAWebLidAwareContactsDB").merge(t,n)}),s.apply(this,arguments)}function u(e,t){return e.remove(t.isLid()?t.toString():t.user)}var c={isBusiness:!1};function d(e,t,n){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=o("WAWebContactCollection").ContactCollection.get(e),a=r?{isBusiness:r.isBusiness,privacyMode:r.privacyMode}:c;yield o("WAWebHandleBusinessNameChangeLidHelpers").removeVerifiedNameFromTableLidAware(e);var i=o("WAWebContactCollection").ContactCollection.get(e);i!=null&&i.set({isBusiness:!1,verifiedLevel:null,verifiedName:null}),o("WAWebBackendApi").frontendFireAndForget("generateAndUpdatePrivacySystemMessages",{wid:e,previousState:a,currentState:c})}),m.apply(this,arguments)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e.type!=="remove_hash")throw r("err")("Invalid notification type");var t=yield o("WAWebApiContact").getContactRecordByHash(e.hash);if(t==null)return!1;var n=o("WAWebWidFactory").createUserWidOrThrow(t.id);return yield d(n,e.stanzaId,e.ts),!0}),_.apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e.type!=="remove_jid")throw r("err")("Invalid notification type");yield d(e.jid,e.stanzaId,e.ts)}),g.apply(this,arguments)}l.removeBusinessPropsFromContact=e,l.removeVerifiedName=u,l.handleBusinessRemoval=d,l.handleBusinessRemovalNotificationHash=p,l.handleBusinessRemovalNotificationContact=f}),98);
__d("WAWebHistorySyncDynamicThrottlingManager",["WAWebDynamicThrottlingManager"],(function(t,n,r,o,a,i,l){var e=new(o("WAWebDynamicThrottlingManager")).DynamicThrottlingManager({targetTimeMs:150,maxDelayTimeMs:3e3,minBatchSize:1,maxBatchSize:500,defaultBatchSize:50});l.historySyncDynamicThrottlingManager=e}),98);
__d("WAWebHistorySyncWorkerCompatibleNotificationUtils",["WALogger","WAWebBackendApi","WAWebChatConstants","WAWebProtobufsHistorySync.pb","WAWebSchemaChat","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t,n){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){r===void 0&&(r=!1);var a=c(n),i={id:t,endOfHistoryTransferType:a};o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[history sync] update chat "," end of history transfer type to ",""])),t.toLogString(),a),r&&(i.t=0),yield o("WAWebSchemaChat").getChatTable().merge(t.toString(),{endOfHistoryTransferType:a}),yield o("WAWebBackendApi").frontendSendAndReceive("chatCollectionAdd",{things:[i],options:{merge:!0,add:!1}})}),u.apply(this,arguments)}function c(e){switch(e){case o("WAWebProtobufsHistorySync.pb").Conversation$EndOfHistoryTransferType.COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY:return o("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY;case o("WAWebProtobufsHistorySync.pb").Conversation$EndOfHistoryTransferType.COMPLETE_AND_NO_MORE_MESSAGE_REMAIN_ON_PRIMARY:return o("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.COMPLETE_AND_NO_MORE_MESSAGE_REMAIN_ON_PRIMARY;case o("WAWebProtobufsHistorySync.pb").Conversation$EndOfHistoryTransferType.COMPLETE_ON_DEMAND_SYNC_BUT_MORE_MSG_REMAIN_ON_PRIMARY:return o("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.COMPLETE_ON_DEMAND_SYNC_BUT_MORE_MSG_REMAIN_ON_PRIMARY;case o("WAWebProtobufsHistorySync.pb").Conversation$EndOfHistoryTransferType.COMPLETE_ON_DEMAND_SYNC_WITH_MORE_MSG_ON_PRIMARY_BUT_NO_ACCESS:return o("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.COMPLETE_ON_DEMAND_SYNC_WITH_MORE_MSG_ON_PRIMARY_BUT_NO_ACCESS}}l.updateEndOfHistorySync=s}),98);
__d("WAWebMmsClientErrors",["WAWebHttpErrors"],(function(t,n,r,o,a,i,l){var e,s=(function(e){function t(t,n){var r;return r=e.call(this,404,t)||this,r.name="MediaNotFoundError",r}return babelHelpers.inheritsLoose(t,e),t})((e=o("WAWebHttpErrors")).HttpStatusCodeError),u=(function(e){function t(t,n){var r;return r=e.call(this,413,t)||this,r.name="MediaTooLargeError",r}return babelHelpers.inheritsLoose(t,e),t})(e.HttpStatusCodeError),c=(function(e){function t(t,n){var r;return r=e.call(this,415,t)||this,r.name="MediaInvalidError",r}return babelHelpers.inheritsLoose(t,e),t})(e.HttpStatusCodeError),d=(function(e){function t(t,n){var r;return r=e.call(this,401,t)||this,r.name="MMSUnauthorizedError",r}return babelHelpers.inheritsLoose(t,e),t})(e.HttpStatusCodeError),m=(function(e){function t(t,n){var r;return r=e.call(this,403,t)||this,r.name="MMSForbiddenError",r}return babelHelpers.inheritsLoose(t,e),t})(e.HttpStatusCodeError),p=(function(e){function t(t,n){var r;return r=e.call(this,507,t)||this,r.name="MMSThrottleError",r}return babelHelpers.inheritsLoose(t,e),t})(e.HttpStatusCodeError);l.MediaNotFoundError=s,l.MediaTooLargeError=u,l.MediaInvalidError=c,l.MMSUnauthorizedError=d,l.MMSForbiddenError=m,l.MMSThrottleError=p}),98);
__d("WAWebMmsClientIsErrorRetryable",["WAWebHttpErrors","WAWebMediaHostsErrors","WAWebMmsClientErrors"],(function(t,n,r,o,a,i,l){function e(e){return e===408?!0:e===507?!1:e>=500}function s(e){return e instanceof o("WAWebMmsClientErrors").MMSThrottleError?!1:e instanceof o("WAWebMediaHostsErrors").NoMediaHostsError||e instanceof o("WAWebHttpErrors").HttpNetworkError||e instanceof o("WAWebMmsClientErrors").MMSUnauthorizedError||e instanceof o("WAWebHttpErrors").HttpStatusCodeError&&e.status>=500}l.isRetriableStatusCode=e,l.isErrorRetryable=s}),98);
__d("WAWebMmsClientMmsBackoffOptions",[],(function(t,n,r,o,a,i){var e={minTimeout:1e3,retries:3},l=e;i.default=l}),66);
__d("WAWebMmsClientFormatHashUrl",["WABase64UrlSafe","WANullthrows","WAWebMmsMediaTypes","WAWebPonyfillsUrlSearchParams"],(function(t,n,r,o,a,i,l){var e,s,u=(e={audio:"/mms/audio",document:"/mms/document",gif:"/mms/gif",image:"/mms/image",ppic:"/pps/photo",product:"/mms/image",ptt:"/mms/ptt",sticker:"/mms/sticker","thumbnail-document":"/mms/thumbnail-document","thumbnail-link":"/mms/thumbnail-link",video:"/mms/video","md-app-state":"/mms/md-app-state","md-msg-hist":"/mms/md-msg-hist","product-catalog-image":"/product/image","biz-cover-photo":"/pps/biz-cover-photo","thumbnail-image":"/mms/thumbnail-image","thumbnail-video":"/mms/thumbnail-video"},e[(s=o("WAWebMmsMediaTypes")).MEDIA_TYPES.NEWSLETTER_AUDIO]="/newsletter/newsletter-audio",e[s.MEDIA_TYPES.NEWSLETTER_IMAGE]="/newsletter/newsletter-image",e[s.MEDIA_TYPES.NEWSLETTER_DOCUMENT]="/newsletter/newsletter-document",e[s.MEDIA_TYPES.NEWSLETTER_IMAGE]="/newsletter/newsletter-image",e[s.MEDIA_TYPES.NEWSLETTER_GIF]="/newsletter/newsletter-gif",e[s.MEDIA_TYPES.NEWSLETTER_PTT]="/newsletter/newsletter-ptt",e[s.MEDIA_TYPES.NEWSLETTER_PTV]="/newsletter/newsletter-ptv",e[s.MEDIA_TYPES.NEWSLETTER_STICKER]="/newsletter/newsletter-sticker",e[s.MEDIA_TYPES.NEWSLETTER_STICKER_PACK]="/newsletter/newsletter-sticker-pack",e[s.MEDIA_TYPES.NEWSLETTER_THUMBNAIL_LINK]="/newsletter/newsletter-thumbnail-link",e[s.MEDIA_TYPES.NEWSLETTER_VIDEO]="/newsletter/newsletter-video",e[s.MEDIA_TYPES.NATIVE_AD_IMAGE]="/mms/ads-image",e[s.MEDIA_TYPES.NATIVE_AD_VIDEO]="/mms/ads-video",e[s.MEDIA_TYPES.STICKER_PACK]="/mms/sticker-pack",e[s.MEDIA_TYPES.THUMBNAIL_STICKER_PACK]="/mms/thumbnail-sticker-pack",e[s.MEDIA_TYPES.MUSIC_ARTWORK]="/mms/music-artwork",e[s.MEDIA_TYPES.NEWSLETTER_MUSIC_ARTWORK]="/mms/newsletter-music-artwork",e[s.MEDIA_TYPES.GROUP_HISTORY]="/mms/group-history",e[s.MEDIA_TYPES.WAFFLE_VIDEO]="/mms/waffle-video",e[s.MEDIA_TYPES.WAFFLE_IMAGE]="/mms/waffle-image",e);function c(e){var t=e.hostname,n=e.type,a=e.encFilehash,i=e.query,l=r("WANullthrows")(u[n]),s=new URL("https://"+t+l+"/"+o("WABase64UrlSafe").urlSafeBase64(a)),c={};i&&Object.keys(i).forEach(function(e){i[e]!=null&&(c[e]=i[e])});var d=new(r("WAWebPonyfillsUrlSearchParams"))(c).toString();return d&&(d="?"+d),"https://"+s.host+s.pathname+d}l.default=c}),98);
__d("WAWebMmsClientFormatUploadUrl",["WABase64UrlSafe","WAWebABProps","WAWebMmsClientFormatHashUrl"],(function(t,n,r,o,a,i,l){function e(e){var t,n,a=e.auth,i=e.encFilehash,l=e.hostname,s=e.query,u=e.type,c=e.byteRange,d=e.mediaId,m=e.token,p=s==null?void 0:s.final_hash;return r("WAWebMmsClientFormatHashUrl")({encFilehash:i,hostname:l,type:u,query:{auth:a,token:o("WABase64UrlSafe").urlSafeBase64(m),resume:s==null||(t=s.resume)==null?void 0:t.toString(10),stream:s==null||(n=s.stream)==null?void 0:n.toString(10),final_hash:p!=null?o("WABase64UrlSafe").urlSafeBase64(p):void 0,bytestart:c==null?void 0:c.start.toString(10),byteend:c==null?void 0:c.end.toString(10),media_id:d.toString(10),server_thumb_gen:(s==null?void 0:s.server_thumb_gen)!=null?"1":void 0,server_transcode:u==="newsletter-video"&&o("WAWebABProps").getABPropConfigValue("web_channel_video_server_transcode_upload")?"1":void 0}})}l.default=e}),98);
__d("WAWebMmsClientMmsLogError",["WAAbortError","WALogger","WAWebMmsClientErrors"],(function(t,n,r,o,a,i,l){var e,s,u;function c(t,n,r,a){a===void 0&&(a=!0),n instanceof o("WAWebMmsClientErrors").MediaNotFoundError&&a?o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["",": expected error"])),t).devConsole(r,n):typeof n=="object"&&(n==null?void 0:n.name)===o("WAAbortError").ABORT_ERROR?o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["",": canceled"])),t).devConsole(r,n):o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["",": ",""])),t,n).devConsole(r,n)}l.mmsLogError=c}),98);
__d("WAWebMmsClientMmsGetUploadProgress",["WALogger","WAWebHttpErrors","WAWebHttpExtendedFetch","WAWebMmsClientErrors","WAWebMmsClientFormatUploadUrl","WAWebMmsClientMmsLogError","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.auth,a=t.encFilehash,i=t.hostname,l=t.signal,u=t.type,c=t.onProgress,d=t.mediaId,m=t.token,p=t.generateThumbnailOnServer,_=r("WAWebMmsClientFormatUploadUrl")({auth:n,encFilehash:a,hostname:i,query:{resume:1,server_thumb_gen:p===!0?1:void 0},type:u,mediaId:d,token:m}),f={encFilehash:a,type:u,url:_};o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["mmsGetUploadProgress: start"]))).devConsole(f);try{var g=yield o("WAWebHttpExtendedFetch").extendedFetch(_,{method:"post",signal:l,onProgress:c});if(!g.ok)switch(g.status){case 401:throw new(o("WAWebMmsClientErrors")).MMSUnauthorizedError("mmsGetUploadProgress",{url:_});case 404:throw new(o("WAWebMmsClientErrors")).MediaNotFoundError("mmsGetUploadProgress",{url:_});default:throw new(o("WAWebHttpErrors")).HttpStatusCodeError(g.status,"mmsGetUploadProgress",{url:_})}var h=yield g.json();if(!h.resume)throw new(o("WAWebHttpErrors")).HttpInvalidResponseError("mmsGetUploadProgress: missing resume",{url:_});return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["mmsGetUploadProgress: success"]))).devConsole(f),{directPath:h.direct_path,resume:h.resume,url:h.url,handle:h.handle}}catch(e){throw o("WAWebMmsClientMmsLogError").mmsLogError("mmsUpload",e,f),e}}),c.apply(this,arguments)}l.default=u}),98);
__d("WAWebMmsClientMmsCheckIfUploadExists",["WALogger","WAWebHttpErrors","WAWebMmsClientErrors","WAWebMmsClientMmsGetUploadProgress","WAWebMmsClientMmsLogError","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c="complete";function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n={encFilehash:t.encFilehash,type:t.type};o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["mmsCheckIfUploadExists: start"]))).devConsole(n);try{var a=yield r("WAWebMmsClientMmsGetUploadProgress")(t),i=a.directPath,l=a.url,d=a.handle,m=a.resume;if(m===c){if(i==null||i==="")throw new(o("WAWebHttpErrors")).HttpInvalidResponseError("mmsCheckIfUploadExists: missing directPath");if(l==null||l==="")throw new(o("WAWebHttpErrors")).HttpInvalidResponseError("mmsCheckIfUploadExists: missing url");return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["mmsCheckIfUploadExists: success"]))).devConsole(n),{directPath:i,url:l,handle:d,complete:!0}}var p=parseInt(m,10);if(p===0)throw new(o("WAWebMmsClientErrors")).MediaNotFoundError("mmsCheckIfUploadExists");if(Number.isNaN(p))throw o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["mmsCheckIfUploadExists: resume is NaN, resume=",""])),p).sendLogs("upload-offset-is-NaN"),new(o("WAWebHttpErrors")).HttpInvalidResponseError("mmsCheckIfUploadExists: invalid resume");return{complete:!1,resume:p}}catch(e){throw o("WAWebMmsClientMmsLogError").mmsLogError("mmsCheckIfUploadExists",e,n),e}}),m.apply(this,arguments)}l.default=d}),98);
__d("WAWebMmsClientMmsDeleteMdHistorySyncBlob",["WABase64","WABase64UrlSafe","WAWebHttpErrors","WAWebMmsClientFormatHashUrl","WAWebMmsMediaTypes","WAWebPonyfillsFetch","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.directPath,n=e.encFilehash,a=e.hostname,i=e.auth,l=e.encHandle,s=e.companionUserSecret,u=t.split("?")[0],c=new TextEncoder().encode(u),d=o("WABase64").encodeB64UrlSafe(c),m=o("WAWebMmsMediaTypes").MEDIA_TYPES.HISTORY_SYNC,p=r("WAWebMmsClientFormatHashUrl")({encFilehash:n,hostname:a,type:m,query:{token:o("WABase64UrlSafe").urlSafeBase64(n),d_md:d,auth:i,e_handle:l}}),_={};l!=null&&s!=null&&(_.Companion_User_Secret=s);var f=yield r("WAWebPonyfillsFetch")(p,{method:"DELETE",headers:_});if(!f.ok)throw new(o("WAWebHttpErrors")).HttpStatusCodeError(f.status,"MMS Delete error")}),s.apply(this,arguments)}l.default=e}),98);
__d("WAWebMmsCdnUrlValidationUtils",["WATimeUtils"],(function(t,n,r,o,a,i,l){var e={OE:"oe"};function s(t){var n=t instanceof URL?t.searchParams:new URL(t).searchParams,r=n.get(e.OE),a=r==null?void 0:o("WATimeUtils").convertHexToDate(r);return{expirationDate:a}}l.parseCdnUrlParams=s}),98);
__d("WAWebMmsClientFormatDownloadUrl",["WABase64UrlSafe","WALogger","WAWebABProps","WAWebMmsClientFormatHashUrl","WAWebPonyfillsUrlSearchParams","WAWebSharedConstants","err","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){var e,s;function u(t){var n,a=t.directPath,i=t.encFilehash,l=t.hostname,s=t.type,u=t.mode,d=t.byteRange,m=t.downloadBucket;if(!r("isStringNullOrEmpty")(a)){var p;return c({encFilehash:i,hostname:l,directPath:a,query:(p={mode:u,bytestart:d==null?void 0:d.start.toString(),byteend:d==null?void 0:d.end.toString()},p[o("WAWebSharedConstants").MMS_URL_MEDIA_TYPE_SEARCH_PARAM]=s,p[o("WAWebSharedConstants").IS_MMS_URL_SEARCH_PARAM]="",p),downloadBucket:m,type:s})}if(o("WAWebABProps").getABPropConfigValue("web_deprecate_mms4_hash_based_download"))throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[mms] missing direct path, media type: ",""])),s).sendLogs("media-fault: missing direct path"),r("err")("No direct path is available for download, abort");return r("WAWebMmsClientFormatHashUrl")({hostname:l,type:s,encFilehash:i,query:(n={mode:u},n[o("WAWebSharedConstants").IS_MMS_URL_SEARCH_PARAM]="",n)})}function c(e){var t=e.directPath,n=e.encFilehash,a=e.hostname,i=e.query,l=e.downloadBucket,u=e.type,c=new URL(t,"https://"+a);if(c.hostname!==a)throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["url.hostname: ",", hostname: ",", directPath: ",""])),c.hostname,a,t).sendLogs("malicious directPath"),r("err")("malicious directPath");var d=c.searchParams||new(r("WAWebPonyfillsUrlSearchParams"))(c.search);d.set("hash",o("WABase64UrlSafe").urlSafeBase64(n)),l!=null&&d.set("_nc_cat",l.toString());var m=o("WAWebABProps").getABPropConfigValue("low_cache_hit_rate_media_types");if(m!=null){var p=m.split(",");p.includes(u)&&d.set("_nc_map","whatsapp-nofna")}return Object.keys(i).forEach(function(e){var t=i[e];t!=null&&d.set(e,t)}),"https://"+c.host+c.pathname+"?"+d.toString()}l.default=u}),98);
__d("WAWebMmsClientMmsDownload",["WALogger","WAMediaCalculateFilehash","WATimeUtils","WAWebHttpErrors","WAWebHttpExtendedFetch","WAWebMiscErrors","WAWebMmsCdnUrlValidationUtils","WAWebMmsClientErrors","WAWebMmsClientFormatDownloadUrl","WAWebMmsClientMmsLogError","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.url,r=t.signal,a=t.onHeadersReceived,i=t.onProgress,l=t.onData,c=t.debug,d=t.debugString,m=t.ciphertextValidator;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["mmsDownload: [","] start"])),d).devConsole(c);try{var p=yield o("WAWebHttpExtendedFetch").extendedFetch(n,{signal:r,onProgress:i,onData:l,onHeadersReceived:a});yield h({response:p,functionName:"mmsDownload",url:n});var _=yield p.arrayBuffer();if(m&&!(yield m(_)))throw o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["download hash mismatch error. downloaded size: ",""])),_.byteLength),new(o("WAWebHttpErrors")).MmsDownloadFilehashMismatchError({url:n});return o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["mmsDownload: [","] success"])),d).devConsole(c),_}catch(e){throw o("WAWebMmsClientMmsLogError").mmsLogError("mmsDownload",e,c),e instanceof TypeError?new(o("WAWebHttpErrors")).HttpNetworkError(e.message):e}}),d.apply(this,arguments)}function m(e){var t=e.directPath,a=e.encFilehash,i=e.staticUrl,l=e.hostname,s=e.type,u=e.signal,d=e.onProgress,m=e.onData,p=e.onHeadersReceived,_=e.mode,f=e.byteRange,g=e.debugString,h=e.downloadBucket,y=i||r("WAWebMmsClientFormatDownloadUrl")({directPath:t,encFilehash:a,hostname:l,type:s,mode:_,byteRange:f,downloadBucket:h}),C=f?null:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return(yield o("WAMediaCalculateFilehash").calculateFilehash(e))===a});return function(t){return e.apply(this,arguments)}})();return c({url:y,signal:u,onHeadersReceived:p,onProgress:d,onData:m,ciphertextValidator:C,debugString:g,debug:{encFilehash:a,type:s,url:y}})}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.directPath,n=e.encFilehash,r=e.hostname,o=e.type,a=e.signal;yield C({directPath:t,encFilehash:n,hostname:r,type:o,signal:a,functionName:"mmsCheckExistence"})}),_.apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.directPath,n=e.encFilehash,r=e.hostname,a=e.type,i=e.signal,l=yield C({directPath:t,encFilehash:n,hostname:r,type:a,signal:i,functionName:"mmsGetEncryptedMediaSize"}),s=l.headers.get("content-length");if(!s)throw new(o("WAWebMiscErrors")).UnableToGetContentLengthError;return parseInt(s,10)}),g.apply(this,arguments)}function h(e){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.response,n=e.url,r=e.functionName;if(!t.ok)switch(t.status){case 401:throw new(o("WAWebMmsClientErrors")).MMSUnauthorizedError(r,{url:n});case 403:{var a=yield t.text();if(a.includes("URL signature expired"))throw new(o("WAWebMmsClientErrors")).MediaNotFoundError(r,{url:n,status:t.status});var i=o("WAWebMmsCdnUrlValidationUtils").parseCdnUrlParams(n),l=i.expirationDate;throw l!=null&&o("WATimeUtils").toDate(o("WATimeUtils").unixTime())>=l?new(o("WAWebMmsClientErrors")).MediaNotFoundError(r,{url:n,status:t.status}):new(o("WAWebMmsClientErrors")).MMSForbiddenError(r,{url:n})}case 404:case 410:throw new(o("WAWebMmsClientErrors")).MediaNotFoundError(r,{url:n,status:t.status});case 507:throw new(o("WAWebMmsClientErrors")).MMSThrottleError(r,{url:n});default:throw new(o("WAWebHttpErrors")).HttpStatusCodeError(t.status,r,{url:n})}}),y.apply(this,arguments)}function C(e){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.directPath,n=e.encFilehash,a=e.hostname,i=e.type,l=e.signal,s=e.functionName,u=r("WAWebMmsClientFormatDownloadUrl")({directPath:t,encFilehash:n,hostname:a,type:i,mode:"auto"}),c=yield o("WAWebHttpExtendedFetch").extendedFetch(u,{method:"HEAD",signal:l});return yield h({response:c,functionName:s,url:u}),c}),b.apply(this,arguments)}l.mms4Download=m,l.mmsCheckExistence=p,l.mmsGetEncryptedMediaSize=f,l.validateMmsResponse=h}),98);
__d("WAWebMmsClientMmsUpload",["WALogger","WAWebHttpErrors","WAWebHttpExtendedFetch","WAWebMmsClientErrors","WAWebMmsClientFormatUploadUrl","WAWebMmsClientMmsLogError","WAWebMmsMediaTypes","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e){var t,n;if(e.direct_path==null||e.direct_path==="")throw new(o("WAWebHttpErrors")).HttpInvalidResponseError("mmsUpload: missing direct_path");if(e.url==null||e.url==="")throw new(o("WAWebHttpErrors")).HttpInvalidResponseError("mmsUpload: missing url");return{directPath:e.direct_path,url:e.url,handle:e.handle,thumbnailDirectPath:(t=e.thumbnail_info)==null?void 0:t.thumbnail_direct_path,thumbnailSha256:(n=e.thumbnail_info)==null?void 0:n.thumbnail_sha256,metadataUrl:e.metadata_url}}function c(e){if(e.ts==null)throw new(o("WAWebHttpErrors")).HttpInvalidResponseError("mmsUpload: missing ts (timestamp)");if(e.meta_hmac==null)throw new(o("WAWebHttpErrors")).HttpInvalidResponseError("mmsUpload: missing meta_hmac");if(e.fbid==null)throw new(o("WAWebHttpErrors")).HttpInvalidResponseError("mmsUpload: missing fbid");return{directPath:"",url:"",ts:e.ts,metaHmac:e.meta_hmac,fbid:e.fbid}}function d(e){if(e.direct_path==null||e.direct_path==="")throw new(o("WAWebHttpErrors")).HttpInvalidResponseError("mmsUpload: missing direct_path");if(e.url==null||e.url==="")throw new(o("WAWebHttpErrors")).HttpInvalidResponseError("mmsUpload: missing url");if(e.fbid==null)throw new(o("WAWebHttpErrors")).HttpInvalidResponseError("mmsUpload: missing fbid");return{directPath:e.direct_path,url:e.url,fbid:e.fbid}}function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.auth,a=t.ciphertextHmac,i=t.encFilehash,l=t.hostname,m=t.type,p=t.signal,_=t.onProgress,f=t.byteRange,g=t.mediaId,h=t.generateThumbnailOnServer,y=r("WAWebMmsClientFormatUploadUrl")({auth:n,encFilehash:i,hostname:l,type:m,byteRange:f,mediaId:g,token:t.token,query:{server_thumb_gen:h===!0?1:void 0}}),C={encFilehash:i,type:m,url:y};o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["mmsUpload: start"]))).devConsole(C);try{var b;switch(m){case o("WAWebMmsMediaTypes").MEDIA_TYPES.NATIVE_AD_IMAGE:case o("WAWebMmsMediaTypes").MEDIA_TYPES.NATIVE_AD_VIDEO:b=d;break;case o("WAWebMmsMediaTypes").MEDIA_TYPES.BIZ_COVER_PHOTO:b=c;break;default:b=u;break}var v=yield o("WAWebHttpExtendedFetch").extendedFetch(y,{method:"post",body:a,signal:p,onProgress:_}).then(function(e){if(!e.ok)switch(e.status){case 401:throw new(o("WAWebMmsClientErrors")).MMSUnauthorizedError("mmsUpload",{url:y});case 413:throw new(o("WAWebMmsClientErrors")).MediaTooLargeError("mmsUpload",{url:y});case 415:throw new(o("WAWebMmsClientErrors")).MediaInvalidError("mmsUpload: hash mismatch",{url:y});case 507:throw new(o("WAWebMmsClientErrors")).MMSThrottleError("mmsUpload",{url:y});default:throw new(o("WAWebHttpErrors")).HttpStatusCodeError(e.status,"mmsUpload",{url:y})}return e.json()}).then(b);return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["mmsUpload: success"]))).devConsole(C),v}catch(e){throw o("WAWebMmsClientMmsLogError").mmsLogError("mmsUpload",e,C,!1),e}}),p.apply(this,arguments)}l.default=m}),98);
__d("WAWebMediaHostsMaybeSwitchHost",["WAWebMediaHost"],(function(t,n,r,o,a,i,l){var e=52428800;function s(e,t,n){return e.equals(t)&&n!=null&&t!=null&&!t.equals(n)}function u(t,n,r,a){var i=n.selectedHost,l=n.fallbackHost,u=r.selectedHost,c=r.fallbackHost;if(a<e)return{changed:!1,host:t};switch(t.type){case o("WAWebMediaHost").HOST_TYPE.PRIMARY:{if(!t.equals(u))return{changed:!0,host:u};break}case o("WAWebMediaHost").HOST_TYPE.FALLBACK:if(i.equals(u)){if(s(t,l,c)||s(t,i.fallback,u.fallback))return{changed:!0,host:i}}else return{changed:!0,host:u};break}return{changed:!1,host:t}}l.THRESHOLD=e,l.maybeSwitchHost=u}),98);
__d("WAWebMmsClientPollMediaHosts",["Promise","WAPromiseDelays","WARetryPromise","WAWebMediaHostsMaybeSwitchHost","WAWebMmsMediaTypes","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=3e5;function u(e,t){return e===o("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT&&t>o("WAWebMediaHostsMaybeSwitchHost").THRESHOLD}function c(e,t){return e===o("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT&&(t!=null?t:0)>o("WAWebMediaHostsMaybeSwitchHost").THRESHOLD}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=t.connectionBlock;return yield o("WAPromiseDelays").delayMs(s,t.signal),r("WARetryPromise")(function(r){var i=r.retry;return new(e||(e=n("Promise")))(function(e){return t.getMediaHosts().then(function(n){var r=n.selectedHost,l=n.fallbackHost,u={selectedHost:r,fallbackHost:l},c=t.getRemainingBytes();if(c==null)return i(s);var d=o("WAWebMediaHostsMaybeSwitchHost").maybeSwitchHost(t.getHost(),a,u,c),m=d.changed,p=d.host;return a=u,m?e(p):i(s)})})},t.signal)}),m.apply(this,arguments)}l.SERVER_POLLING_INTERVAL=s,l.shouldPollUploadHosts=u,l.shouldPollDownloadHosts=c,l.pollMediaHosts=d}),98);
__d("WAWebMmsClientSelectHost",[],(function(t,n,r,o,a,i){var e=4;function l(t){var n=t.selectedHost,r=t.fallbackHost,o=t.attemptCount,a=t.lastHostUsed,i=t.lastFetchMadeProgress;return i&&a?a:o<=1?n:o===e-1&&r?r:a!=null&&a.equals(n)&&n.fallback!=null?n.fallback:r!=null?r:n}i.default=l}),66);
__d("WAWebMmsClientMmsUploadStream",["WALogger","WAWebHttpErrors","WAWebHttpExtendedFetch","WAWebMmsClientErrors","WAWebMmsClientFormatUploadUrl","WAWebMmsClientMmsLogError","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t,n){switch(e){case 401:throw new(o("WAWebMmsClientErrors")).MMSUnauthorizedError(t,{url:n});case 413:throw new(o("WAWebMmsClientErrors")).MediaTooLargeError(t,{url:n});case 415:throw new(o("WAWebMmsClientErrors")).MediaInvalidError(t+": hash mismatch",{url:n});case 507:throw new(o("WAWebMmsClientErrors")).MMSThrottleError("mmsUploadStreamFinalize",{url:n});default:throw new(o("WAWebHttpErrors")).HttpStatusCodeError(e,t,{url:n})}}function c(e){var t=e.auth,n=e.encFilehash,a=e.type,i=e.hostname,l=e.byteStart,s=e.byteEnd,c=e.chunk,d=e.signal,m=e.onProgress,p=e.mediaId,_=e.token,f=e.generateThumbnailOnServer,g=r("WAWebMmsClientFormatUploadUrl")({auth:t,encFilehash:n,type:a,hostname:i,query:{stream:1,server_thumb_gen:f===!0?1:void 0},byteRange:{start:l,end:s},mediaId:p,token:_});return o("WAWebHttpExtendedFetch").extendedFetch(g,{method:"post",body:c,signal:d,onProgress:m}).then(function(e){e.ok||u(e.status,"mmsUploadStream",g)})}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.auth,a=t.encFilehash,i=t.type,l=t.hostname,c=t.finalHash,d=t.signal,m=t.mediaId,p=t.generateThumbnailOnServer,_=r("WAWebMmsClientFormatUploadUrl")({auth:n,encFilehash:a,type:i,hostname:l,query:{stream:1,final_hash:c,server_thumb_gen:p===!0?1:void 0},mediaId:m,token:a}),f={encFilehash:a,type:i,url:_};o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["mmsUploadStreamFinalize: start"]))).devConsole(f);try{var g=yield o("WAWebHttpExtendedFetch").extendedFetch(_,{method:"post",signal:d}).then(function(e){return e.ok||u(e.status,"mmsUploadStreamFinalize",_),e.json()}).then(function(e){if(e.direct_path==null||e.direct_path==="")throw new(o("WAWebHttpErrors")).HttpInvalidResponseError("mmsUploadStreamFinalize: missing direct_path");if(e.url==null||e.url==="")throw new(o("WAWebHttpErrors")).HttpInvalidResponseError("mmsUploadStreamFinalize: missing url");return{directPath:e.direct_path,url:e.url,handle:e.handle}});return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["mmsUploadStreamFinalize: success"]))).devConsole(f),g}catch(e){throw o("WAWebMmsClientMmsLogError").mmsLogError("mmsUpload",e,f,!1),e}}),m.apply(this,arguments)}l.mmsUploadStream=c,l.mmsUploadStreamFinalize=d}),98);
__d("WAWebWamEnumOverallLastUploadRetryPhaseType",[],(function(t,n,r,o,a,i){var e=Object.freeze({RESUME_CHECK:1,UPLOAD:2,FINALIZE:3});i.OVERALL_LAST_UPLOAD_RETRY_PHASE_TYPE=e}),66);
__d("WAWebMmsClientUploadStreamer",["Promise","WAExponentialBackoff","WALogger","WARaceSignal","WARetryPromise","WAWebHttpErrors","WAWebMediaHosts","WAWebMediaHostsRouteSelection","WAWebMmsClientIsErrorRetryable","WAWebMmsClientMmsBackoffOptions","WAWebMmsClientMmsUploadStream","WAWebMmsClientPollMediaHosts","WAWebMmsClientSelectHost","WAWebMmsMediaTypes","WAWebNetworkStatus","WAWebWamEnumOverallLastUploadRetryPhaseType","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=["auth"],s,u,c,d;function m(e,t){var n=g(t);return t===o("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT&&n>0&&e>n}var p=(function(){function t(e){var t,r;this.$2=Date.now(),this.$3=0,this.$4=0,this.$9=(d||(d=n("Promise"))).resolve(),this.$6=e.encFilehash,this.$5=e.type,this.$7=e.signal,this.$3=(t=e.byteOffset)!=null?t:0,this.$1=e.encFilehash.slice(0,10),this.$11=e.token,this.$12=(r=e.generateThumbnailOnServer)!=null?r:!1,this.$13=e.onUploadHostFound,this.$14=e.onUploadAttemptSuccess,this.$15=e.onUploadAttemptError,this.$16=e.onProgress,this.$17=e.onFinalize,this.$18=e.onStreamUploadStart,this.$10=e.mediaId}var a=t.prototype;return a.uploadCompleteFile=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n,a=e.ciphertextHmac,i=new Uint8Array(a);this.$8=i.byteLength;var l=g(this.$5),u=l===0?i.byteLength:l;(t=this.$18)==null||t.call(this),o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["uploadStreamer: [","] start upload"])),this.$1),yield r("WAWebNetworkStatus").waitIfOffline();for(var c=Math.ceil((i.byteLength-this.$3)/u),d=0;d<c;d++){this.$19(d,c);var m=this.$3+d*u,p=m+u,_=i.subarray(m,p);yield this.$20(_,m),this.$4+=_.byteLength}var f=yield this.$21(this.$6);return(n=this.$14)==null||n.call(this,Date.now()-this.$2),f});function t(t){return e.apply(this,arguments)}return t})(),a.startUploadFromClient=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e;yield r("WAWebNetworkStatus").waitIfOffline(),(e=this.$18)==null||e.call(this)});function t(){return e.apply(this,arguments)}return t})(),a.uploadChunkFromClient=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this;this.$9=this.$9.then(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield t.$20(e,t.$3),t.$4+=e.byteLength,t.$3+=e.byteLength})),yield this.$9});function t(t){return e.apply(this,arguments)}return t})(),a.finalizeUploadFromClient=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this,n,r=yield this.$9.then(function(){return t.$21(e)});return(n=this.$14)==null||n.call(this,Date.now()-this.$2),r});function t(t){return e.apply(this,arguments)}return t})(),a.$22=function(){this.$2=Date.now()},a.$23=function(){return Date.now()-this.$2},a.$24=function(){if(this.$8!=null)return this.$8-this.$4},a.$19=function(t,n){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["uploadStreamer: [","] uploading chunk ","/",""])),this.$1,t+1,n)},a.$20=function(t,a){var e=this;return o("WAExponentialBackoff").exponentialBackoff(babelHelpers.extends({},r("WAWebMmsClientMmsBackoffOptions"),{signal:this.$7}),(function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n,r){try{yield e.$25(t,a,r)}catch(t){if(_(t,r))return e.$15==null||e.$15(t,e.$23(),r,o("WAWebWamEnumOverallLastUploadRetryPhaseType").OVERALL_LAST_UPLOAD_RETRY_PHASE_TYPE.UPLOAD),e.$22(),n(t);throw t}});return function(e,t){return r.apply(this,arguments)}})())},a.$21=function(t){var e=this;return o("WAExponentialBackoff").exponentialBackoff(babelHelpers.extends({},r("WAWebMmsClientMmsBackoffOptions"),{signal:this.$7}),(function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n,r){try{return e.$17==null||e.$17(),yield e.$26(t,r)}catch(t){if(f(t,r))return e.$15==null||e.$15(t,e.$23(),r,o("WAWebWamEnumOverallLastUploadRetryPhaseType").OVERALL_LAST_UPLOAD_RETRY_PHASE_TYPE.FINALIZE),e.$22(),n(t);throw t}});return function(e,t){return r.apply(this,arguments)}})())},a.$25=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i){var l=this,s=null,u=!1;yield r("WAWebNetworkStatus").waitIfOffline();var c=yield this.$27(i),m=c.auth,p=babelHelpers.objectWithoutPropertiesLoose(c,e),_=s=r("WAWebMmsClientSelectHost")({selectedHost:p.selectedHost,fallbackHost:p.fallbackHost,lastHostUsed:s,lastFetchMadeProgress:u,attemptCount:i}),f=function(t){u=!0,l.$16==null||l.$16(t,a)};return r("WARetryPromise")((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var u=e.retry,c=new AbortController,g=c.signal,h=yield r("WARaceSignal")([g,l.$7],function(e){var r=l.$8!=null&&o("WAWebMmsClientPollMediaHosts").shouldPollUploadHosts(l.$5,l.$8)?o("WAWebMmsClientPollMediaHosts").pollMediaHosts({connectionBlock:p,signal:e,getHost:function(){return _},getMediaHosts:function(){return l.$27(i,!0)},getRemainingBytes:function(){return l.$24()}}).then(function(e){return{host:e,kind:"host-changed"}}):null,s=o("WAWebMmsClientMmsUploadStream").mmsUploadStream({auth:m,encFilehash:l.$6,type:l.$5,hostname:_.hostname,byteStart:a,byteEnd:a+t.byteLength,chunk:t,signal:e,onProgress:f,mediaId:l.$10,token:l.$11,generateThumbnailOnServer:l.$12}).then(function(){return{kind:"upload-completed"}});return(d||(d=n("Promise"))).race([s,r].filter(Boolean)).finally(function(){return c.abort()})});if(h.kind==="host-changed")return s=_,_=h.host,u()});return function(t){return e.apply(this,arguments)}})())});function a(e,n,r){return t.apply(this,arguments)}return a})(),a.$26=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){yield r("WAWebNetworkStatus").waitIfOffline();var n=yield this.$27(t),a=n.auth,i=n.selectedHost;return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["uploadStreamer: [","] finalizing"])),this.$1),o("WAWebMmsClientMmsUploadStream").mmsUploadStreamFinalize({auth:a,hostname:i.hostname,encFilehash:this.$6,finalHash:e,type:this.$5,signal:this.$7,mediaId:this.$10,generateThumbnailOnServer:this.$12})});function t(t,n){return e.apply(this,arguments)}return t})(),a.$27=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n;t===void 0&&(t=!1);var r=yield o("WAWebMediaHosts").mediaHosts.getHostsInfo({operation:o("WAWebMediaHostsRouteSelection").OPERATIONS.UPLOAD,encFilehash:this.$6,type:this.$5,signal:this.$7,forceRefresh:t});return(n=this.$13)==null||n.call(this,{failCount:e,hostName:r.selectedHost.hostname,hostClass:r.selectedHost.class}),r});function t(t,n){return e.apply(this,arguments)}return t})(),t})();function _(e,t){return o("WAWebMmsClientIsErrorRetryable").isErrorRetryable(e)&&t<r("WAWebMmsClientMmsBackoffOptions").retries}function f(e,t){return e instanceof o("WAWebHttpErrors").HttpStatusCodeError&&e.status>=500?!1:_(e,t)}function g(e){return e===o("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT?50*1024*1024:0}l.shouldUseStreamingUpload=m,l.UploadStreamer=p}),98);
__d("WAWebMmsOperationsConst",[],(function(t,n,r,o,a,i){var e={DOWNLOAD:"DOWNLOAD",UPLOAD:"UPLOAD"},l=e;i.default=l}),66);
__d("WAWebMmsClient",["Promise","WAExponentialBackoff","WALogger","WANullthrows","WARaceSignal","WARetryPromise","WAWebMediaHosts","WAWebMmsClientIsErrorRetryable","WAWebMmsClientMmsBackoffOptions","WAWebMmsClientMmsCheckIfUploadExists","WAWebMmsClientMmsDeleteMdHistorySyncBlob","WAWebMmsClientMmsDownload","WAWebMmsClientMmsLogError","WAWebMmsClientMmsUpload","WAWebMmsClientPollMediaHosts","WAWebMmsClientSelectHost","WAWebMmsClientUploadStreamer","WAWebMmsMediaTypes","WAWebMmsOperationsConst","WAWebNetworkStatus","WAWebWamEnumOverallLastUploadRetryPhaseType","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=["ciphertextHmac"],s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E;function k(e){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.encFilehash,a=e.signal,i=e.type,l=e.mediaId,s=e.generateThumbnailOnServer,u=!1,c={encFilehash:e.encFilehash,type:e.type};o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.checkIfUploadExists: start"]))).devConsole(c);try{var d=null,f=yield o("WAExponentialBackoff").exponentialBackoff(babelHelpers.extends({},r("WAWebMmsClientMmsBackoffOptions"),{signal:a}),(function(){var m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n,m){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.checkIfUploadExists: attempt #",""])),m+1).devConsole(c),yield r("WAWebNetworkStatus").waitIfOffline();try{var _=yield o("WAWebMediaHosts").mediaHosts.getHostsInfo({operation:r("WAWebMmsOperationsConst").UPLOAD,encFilehash:t,type:i,signal:a}),f=_.auth,g=_.selectedHost,h=_.fallbackHost,y=r("WAWebMmsClientSelectHost")({selectedHost:g,fallbackHost:h,lastHostUsed:d,attemptCount:m,lastFetchMadeProgress:u});return d=y,yield r("WAWebMmsClientMmsCheckIfUploadExists")({auth:f,encFilehash:t,hostname:y.hostname,type:i,signal:a,onProgress:function(){u=!0},mediaId:l,token:e.token,generateThumbnailOnServer:s})}catch(e){if(o("WAWebMmsClientIsErrorRetryable").isErrorRetryable(e))return n(e);throw e}});return function(e,t){return m.apply(this,arguments)}})());return o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.checkIfUploadExists: success"]))).devConsole(c),f}catch(e){throw o("WAWebMmsClientMmsLogError").mmsLogError("mmsClient.checkIfUploadExists",e,c),e}}),I.apply(this,arguments)}function T(e){return D.apply(this,arguments)}function D(){return D=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.encFilehash,a=t.type,i=t.onUploadAttemptSuccess,l={encFilehash:n,type:a};o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.upload: start"]))).devConsole(l);try{if(o("WAWebMmsClientUploadStreamer").shouldUseStreamingUpload(t.ciphertextHmac.byteLength,t.type)){var s=t.ciphertextHmac,u=babelHelpers.objectWithoutPropertiesLoose(t,e),c=new(o("WAWebMmsClientUploadStreamer")).UploadStreamer(u);return yield c.uploadCompleteFile({ciphertextHmac:s})}var d=yield q(t),m=d.response,p=d.retryStartTime;return i(Date.now()-p),o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.upload: success"]))).devConsole(l),r("WANullthrows")(m)}catch(e){throw o("WAWebMmsClientMmsLogError").mmsLogError("mmsClient.upload",e,l,!1),e}}),D.apply(this,arguments)}function x(e){return $.apply(this,arguments)}function $(){return $=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.directPath,n=e.filehash,r=e.type,a=e.debugString,i=e.staticUrl,l=e.onDownloadAttemptSuccess,s={directPath:t,filehash:n,type:r,staticUrl:i};o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.download: [","] start"])),a).devConsole(s);try{var u=yield F(e),c=u.response,d=u.retryStartTime;return l(Date.now()-d),o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.download: [","] success"])),a).devConsole(s),c}catch(e){throw o("WAWebMmsClientMmsLogError").mmsLogError("mmsClient.download",e,s),e}}),$.apply(this,arguments)}function P(e){return M(function(t){return o("WAWebMmsClientMmsDownload").mmsCheckExistence(babelHelpers.extends({},e,{hostname:t}))},e)}function N(e){return M(function(t){return o("WAWebMmsClientMmsDownload").mmsGetEncryptedMediaSize(babelHelpers.extends({},e,{hostname:t}))},e)}function M(e,t){var a=t.directPath,i=t.encFilehash,l=t.type,c=t.signal,d={directPath:a,type:l};return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["runTaskWithBackoff: start"]))).devConsole(d),o("WAExponentialBackoff").exponentialBackoff(babelHelpers.extends({},r("WAWebMmsClientMmsBackoffOptions"),{signal:c}),(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["runMmsTaskWithBackoff: attempt #",""])),n+1).devConsole(d);try{var s=yield w({operation:r("WAWebMmsOperationsConst").DOWNLOAD,directPath:a,encFilehash:i,type:l,signal:c,failCount:n}),m=yield e(s);return m}catch(e){if(o("WAWebMmsClientIsErrorRetryable").isErrorRetryable(e))return t(e);throw e}});return function(e,n){return t.apply(this,arguments)}})())}function w(e){return A.apply(this,arguments)}function A(){return A=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.failCount,n=e.operation,r=e.directPath,a=e.encFilehash,i=e.type,l=e.signal,s=yield o("WAWebMediaHosts").mediaHosts.getHostsInfo({operation:n,directPath:r,encFilehash:a,type:i,signal:l}),u=s.selectedHost,c=s.fallbackHost,d=t>=2&&c?c:u;return d.hostname}),A.apply(this,arguments)}function F(e){return O.apply(this,arguments)}function O(){return O=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.debugString,a=e.signal,i=e.directPath,l=e.filehash,s=e.staticUrl,u=e.type,c=e.onDownloadHostFound,d=e.mode,m=e.byteRange,p=e.onDownloadAttemptError,_=e.onData,f=e.onProgress,g=Date.now(),h=!1,y={directPath:i,filehash:l,type:u,staticUrl:s},S=null,R=yield o("WAExponentialBackoff").exponentialBackoff(babelHelpers.extends({},r("WAWebMmsClientMmsBackoffOptions"),{signal:a}),(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,R){g=Date.now(),o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.download: [","] attempt #",""])),t,R+1).devConsole(y);var L=function(t){return o("WAWebMediaHosts").mediaHosts.getHostsInfo({operation:r("WAWebMmsOperationsConst").DOWNLOAD,directPath:i,encFilehash:l,type:u,signal:a,forceRefresh:t})};try{var k=yield L(),I=k.selectedHost,T=k.fallbackHost,D=r("WAWebMmsClientSelectHost")({selectedHost:I,fallbackHost:T,attemptCount:R,lastHostUsed:S,lastFetchMadeProgress:h});S=D,c({hostName:D.hostname,hostClass:D.class,failCount:R});var x=0,$=null,P={selectedHost:I,fallbackHost:T},N=function(n){if(n!=null&&$==null){var e=n.get("Content-Length"),r=parseInt(e,10);$=Number.isNaN(r)?null:r,o("WALogger").DEV(b||(b=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.download: [","] Content-Length "," bytes"])),t,$)}};return yield r("WARetryPromise")((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var c=e.retry,p=e.failCount,g=function(t){f==null||f(t),h=!0,t.lengthComputable&&(x=t.loaded)};x=0;var y=new AbortController,C=y.signal,b=yield r("WARaceSignal")([a,C],function(e){var r=o("WAWebMmsClientMmsDownload").mms4Download({directPath:i,encFilehash:l,staticUrl:s,hostname:D.hostname,type:u,signal:e,mode:d,byteRange:m,debugString:t,onHeadersReceived:N,onProgress:g,onData:_,downloadBucket:D.selectedBucket}).then(function(e){return{kind:"download-completed",arrayBuffer:e}}),a=o("WAWebMmsClientPollMediaHosts").shouldPollDownloadHosts(u,$)?o("WAWebMmsClientPollMediaHosts").pollMediaHosts({connectionBlock:P,getHost:function(){return D},getMediaHosts:function(){return L(!0)},getRemainingBytes:function(){return $!=null?$-x:null},signal:e}).then(function(e){return{kind:"host-changed",host:e}}):null;return(E||(E=n("Promise"))).race([r,a].filter(Boolean)).finally(function(){return y.abort()})});return b.kind==="host-changed"?(D=b.host,S=D,o("WALogger").DEV(v||(v=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.download: [","] switch to new host"])),t).devConsole(D),c()):b.arrayBuffer});return function(t){return e.apply(this,arguments)}})())}catch(t){h=!1;var M=o("WAWebMmsClientIsErrorRetryable").isErrorRetryable(t),w=!M||R===r("WAWebMmsClientMmsBackoffOptions").retries;if(w||p({error:t,overallT:Date.now()-g,failCount:R}),M)return e(t);throw t}});return function(t,n){return e.apply(this,arguments)}})());return{response:r("WANullthrows")(R),retryStartTime:g}}),O.apply(this,arguments)}function B(e){return W.apply(this,arguments)}function W(){return W=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.auth,n=e.encFilehash,a=e.hostname,i=e.type,l=e.signal,s=e.byteLength,u=e.byteOffset,c=e.failCount,d=e.mediaId,m=e.token,p=e.generateThumbnailOnServer;if(u!=null&&c===0)return u;if(!o("WAWebMmsClientPollMediaHosts").shouldPollUploadHosts(i,s))return 0;try{var _=yield r("WAWebMmsClientMmsCheckIfUploadExists")({auth:t,encFilehash:n,hostname:a,type:i,signal:l,mediaId:d,token:m,generateThumbnailOnServer:p});if(_.complete)return 0;var f=_.resume;return f>=s?0:f}catch(e){return o("WALogger").ERROR(S||(S=babelHelpers.taggedTemplateLiteralLoose(["Failed to compute upload offset"]))).verbose().devConsole(e).sendLogs("upload-offset-failed"),0}}),W.apply(this,arguments)}function q(e){return U.apply(this,arguments)}function U(){return U=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.ciphertextHmac,a=e.encFilehash,i=e.type,l=e.signal,s=e.onUploadHostFound,u=e.onUploadAttemptError,c=e.onProgress,d=e.byteOffset,m=e.mediaId,p=e.generateThumbnailOnServer,_=!1,f=Date.now(),g={encFilehash:a,type:i},h=null,y=yield o("WAExponentialBackoff").exponentialBackoff(babelHelpers.extends({},r("WAWebMmsClientMmsBackoffOptions"),{signal:l}),(function(){var y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(y,C){var b=function(t){return o("WAWebMediaHosts").mediaHosts.getHostsInfo({operation:r("WAWebMmsOperationsConst").UPLOAD,encFilehash:a,type:i,signal:l,forceRefresh:t})};f=Date.now(),o("WALogger").LOG(R||(R=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.upload: attempt #",""])),C+1).devConsole(g);try{yield r("WAWebNetworkStatus").waitIfOffline();var v=yield b(),S=v.auth,k=v.selectedHost,I=v.fallbackHost,T={selectedHost:k,fallbackHost:I},D=r("WAWebMmsClientSelectHost")({selectedHost:k,fallbackHost:I,attemptCount:C,lastHostUsed:h,lastFetchMadeProgress:_});return h=D,s({hostName:D.hostname,hostClass:D.class,failCount:C}),yield r("WARetryPromise")((function(){var s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(s){var u=s.retry,f=yield B({auth:S,encFilehash:a,byteLength:t.byteLength,hostname:D.hostname,type:i,signal:l,byteOffset:d,failCount:C,mediaId:m,token:e.token,generateThumbnailOnServer:p}),g=new AbortController,y=g.signal,v=yield r("WARaceSignal")([l,y],function(s){var u=o("WAWebMmsClientPollMediaHosts").shouldPollUploadHosts(i,t.byteLength)?o("WAWebMmsClientPollMediaHosts").pollMediaHosts({connectionBlock:T,getHost:function(){return D},getMediaHosts:function(){return b(!0)},getRemainingBytes:function(){return t.byteLength},signal:s}).then(function(e){return{kind:"host-changed",host:e}}):null,d=r("WAWebMmsClientMmsUpload")({auth:S,ciphertextHmac:f>0?new Uint8Array(t).subarray(f):t,hostname:D.hostname,encFilehash:a,type:i,signal:l,onProgress:function(t){_=!0,c(t,f)},byteRange:f>0?{start:f,end:t.byteLength}:void 0,mediaId:m,token:e.token,generateThumbnailOnServer:p}).then(function(e){return{kind:"upload-completed",value:e}});return(E||(E=n("Promise"))).race([d,u].filter(Boolean)).finally(function(){return g.abort()})});return v.kind==="host-changed"?(D=v.host,h=D,o("WALogger").DEV(L||(L=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.upload: switch to new host"]))).devConsole(D),u()):v.value});return function(e){return s.apply(this,arguments)}})())}catch(e){_=!1;var x=o("WAWebMmsClientIsErrorRetryable").isErrorRetryable(e),$=!x||C===r("WAWebMmsClientMmsBackoffOptions").retries;if($||u(e,Date.now()-f,C,o("WAWebWamEnumOverallLastUploadRetryPhaseType").OVERALL_LAST_UPLOAD_RETRY_PHASE_TYPE.UPLOAD),x)return y(e);throw e}});return function(e,t){return y.apply(this,arguments)}})());return{response:y,retryStartTime:f}}),U.apply(this,arguments)}function V(e){var t=e.directPath,n=e.encFilehash,a=e.encHandle,i=e.companionUserSecret;return H(function(e,o){return r("WAWebMmsClientMmsDeleteMdHistorySyncBlob")({directPath:t,hostname:e,encFilehash:n,auth:o,encHandle:a,companionUserSecret:i})},babelHelpers.extends({},e,{type:o("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE,operation:r("WAWebMmsOperationsConst").UPLOAD}))}function H(e,t){var a=t.directPath,i=t.encFilehash,l=t.type,s=t.signal,u=t.operation,m={directPath:a,type:l};return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["runTaskWithBackoff: start"]))).devConsole(m),o("WAExponentialBackoff").exponentialBackoff(babelHelpers.extends({},r("WAWebMmsClientMmsBackoffOptions"),{signal:s}),(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["runMmsTaskWithBackoff: attempt #",""])),n+1).devConsole(m);try{var r=yield G({operation:u,directPath:a,encFilehash:i,type:l,signal:s,failCount:n}),c=r.hostname,p=r.auth,_=yield e(c,p);return _}catch(e){if(o("WAWebMmsClientIsErrorRetryable").isErrorRetryable(e))return t(e);throw e}});return function(e,n){return t.apply(this,arguments)}})())}function G(e){return z.apply(this,arguments)}function z(){return z=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.failCount,n=e.operation,r=e.directPath,a=e.encFilehash,i=e.type,l=e.signal,s=yield o("WAWebMediaHosts").mediaHosts.getHostsInfo({operation:n,directPath:r,encFilehash:a,type:i,signal:l}),u=s.selectedHost,c=s.fallbackHost,d=s.auth,m=t>=2&&c?c:u;return{hostname:m.hostname,auth:d}}),z.apply(this,arguments)}var j={download:x,upload:T,checkExistence:P,getEncryptedMediaSize:N,checkIfUploadExists:k,deleteMdHistorySyncBlob:V},K=j;l.default=K}),98);
__d("WAWebNonMessageDataRequestLoggingUtils",["WALogger","WATimeUtils","WAWebNonMessagePeerDataMediaUploadWamEvent","WAWebNonMessagePeerDataOperationResponseWamEvent","WAWebNonMessagePeerDataRequestWamEvent","WAWebProtobufsE2E.pb","WAWebWamEnumPeerDataRequestType","WAWebWebcLinkPreviewResponseHandleWamEvent","err"],(function(t,n,r,o,a,i,l){var e,s=new Map;function u(t,n,r){var a=void 0,i=o("WATimeUtils").unixTimeMs();if(t!=null){var l=s.get(t);l!=null&&(a=i-l)}o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["link preview: session id: ",", is success: ",", durationMs: ",""])),t,n,a),new(o("WAWebWebcLinkPreviewResponseHandleWamEvent")).WebcLinkPreviewResponseHandleWamEvent({previewSessionId:t,isPreviewSuccess:n,previewDurationMs:a!=null?a:void 0,didRespondHqPreview:r}).commit(),t!=null&&s.delete(t)}function c(e,t){var n=m(e);new(o("WAWebNonMessagePeerDataRequestWamEvent")).NonMessagePeerDataRequestWamEvent({peerDataRequestCount:d(e,t),peerDataRequestType:n,peerDataRequestSessionId:t.id.id}).commit()}function d(e,t){switch(e){case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.SEND_RECENT_STICKER_BOOTSTRAP:return 1;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.WAFFLE_LINKING_NONCE_FETCH:return 1;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.FULL_HISTORY_SYNC_ON_DEMAND:return 1;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER:{var n,r,a=(n=t.peerDataOperationRequestMessage)==null?void 0:n.requestStickerReupload;return(r=a==null?void 0:a.length)!=null?r:0}case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.GENERATE_LINK_PREVIEW:{var i,l,s=(i=t.peerDataOperationRequestMessage)==null?void 0:i.requestStickerReupload;return(l=s==null?void 0:s.length)!=null?l:0}case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_ON_DEMAND:return 1;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.PLACEHOLDER_MESSAGE_RESEND:{var u,c,d=(u=t.peerDataOperationRequestMessage)==null?void 0:u.placeholderMessageResendRequest;return(c=d==null?void 0:d.length)!=null?c:0}case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_META_NONCE_FETCH:return 1;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_CANONICAL_USER_NONCE_FETCH:return 1;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_SYNCD_SNAPSHOT_FATAL_RECOVERY:return 1;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_CHUNK_RETRY:return 1;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.GALAXY_FLOW_ACTION:return 1}}function m(e){switch(e){case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER:return o("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.UPLOAD_STICKER;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.SEND_RECENT_STICKER_BOOTSTRAP:return o("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.SEND_RECENT_STICKER_BOOTSTRAP;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.GENERATE_LINK_PREVIEW:return o("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.GENERAL_LINK_PREVIEW;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_ON_DEMAND:return o("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.HISTORY_SYNC_ON_DEMAND;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.PLACEHOLDER_MESSAGE_RESEND:return o("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.PLACEHOLDER_MESSAGE_RESEND;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.WAFFLE_LINKING_NONCE_FETCH:return o("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.WAFFLE_LINKING_NONCE_FETCH;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.FULL_HISTORY_SYNC_ON_DEMAND:throw r("err")("full history sync on demand is not supported in web");case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_META_NONCE_FETCH:throw r("err")("companion meta nonce fetch is not supported in web");case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_CANONICAL_USER_NONCE_FETCH:throw r("err")("companion canonical user nonce fetch is not supported in web");case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_SYNCD_SNAPSHOT_FATAL_RECOVERY:return o("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.SYNCD_SNAPSHOT_RECOVERY;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_CHUNK_RETRY:throw r("err")("history sync chunk retry is not supported in web");case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.GALAXY_FLOW_ACTION:return o("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.UPLOAD_STICKER}}function p(e,t,n,r,a,i,l){var s=m(e);new(o("WAWebNonMessagePeerDataOperationResponseWamEvent")).NonMessagePeerDataOperationResponseWamEvent({peerDataResponseCount:n,peerDataSuccessResponseCount:r,peerDataSuccessProcessCount:a,peerDataErrorCount:i,peerDataNotFoundCount:l,peerDataRequestType:s,peerDataRequestSessionId:t}).commit()}function _(e,t,n,r,a,i,l){if(e===o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER){var s=m(e);new(o("WAWebNonMessagePeerDataMediaUploadWamEvent")).NonMessagePeerDataMediaUploadWamEvent({peerDataRequestCount:n,peerDataSuccessUploadCount:r,peerDataExistingDataNoUploadCount:a,peerDataErrorCount:i,peerDataNotFoundCount:l,peerDataRequestType:s,peerDataRequestSessionId:t}).commit()}}function f(e,t){new(o("WAWebNonMessagePeerDataOperationResponseWamEvent")).NonMessagePeerDataOperationResponseWamEvent({peerDataRequestType:o("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.HISTORY_SYNC_ON_DEMAND,peerDataResponseApplyResult:e,peerDataRequestSessionId:t}).commit()}function g(e,t,n,r,a,i){var l=m(e);new(o("WAWebNonMessagePeerDataOperationResponseWamEvent")).NonMessagePeerDataOperationResponseWamEvent({peerDataResponseCount:r,peerDataSuccessResponseCount:a,peerDataErrorCount:i,peerDataResponseApplyResult:n,peerDataRequestType:l,peerDataRequestSessionId:t}).commit()}l.sendTimes=s,l.logLinkPreviewResponse=u,l.logNonMessagePeerDataRequest=c,l.logNonMessagePeerDataResponse=p,l.logMediaUpload=_,l.logHistorySyncOnDemandResponse=f,l.logPlaceholderMessageResendResponse=g}),98);
__d("WAWebCryptoMediaRetry",["WABinary","WACryptoAesGcm","WACryptoHkdf","WALogger","WAWebProtobufsMmsRetry.pb","asyncToGeneratorRuntime","decodeProtobuf","encodeProtobuf"],(function(t,n,r,o,a,i,l){var e;function s(t){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["encodeServerErrorReceipt"]))).devConsole(t);var n=new(o("WABinary")).Binary;return o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsMmsRetry.pb").ServerErrorReceiptSpec,t,n),n.readByteArrayView()}function u(e,t,n){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield f(e),a=(n==null?void 0:n.slice())||g(),i=s({stanzaId:t}),l=yield o("WACryptoAesGcm").gcmEncrypt(r,a,i,t);return{ciphertext:l,iv:a}}),c.apply(this,arguments)}function d(e,t,n,r){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=yield f(e),i=yield o("WACryptoAesGcm").gcmDecrypt(a,n,r,t);return o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsMmsRetry.pb").MediaRetryNotificationSpec,i)}),m.apply(this,arguments)}var p=12,_="WhatsApp Media Retry Notification";function f(e){return o("WACryptoHkdf").extractAndExpand(e,_,32)}function g(){var e=new Uint8Array(p);return self.crypto.getRandomValues(e),e}l.encryptServerErrorReceipt=u,l.decryptMediaRetryNotification=d,l.ENC_IV_SIZE=p}),98);
__d("WAWebSendHistSyncServerErrorReceiptJob",["WABase64","WADeprecatedSendIq","WAWap","WAWebCommsAckParser","WAWebCommsWapMd","WAWebCryptoMediaRetry","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t,n){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r,a=o("WABase64").decodeB64(n),i=yield o("WAWebCryptoMediaRetry").encryptServerErrorReceipt(a,t),l=i.ciphertext,s=i.iv,u=(r=o("WAWap")).wap("receipt",{type:"server-error",to:o("WAWebCommsWapMd").USER_JID(e),id:r.CUSTOM_STRING(t),category:"peer"},r.wap("encrypt",null,r.wap("enc_p",null,l),r.wap("enc_iv",null,s)));return o("WADeprecatedSendIq").deprecatedSendStanzaAndWaitForAck(u,o("WAWebCommsAckParser").toCoreAckTemplate({id:t,class:"receipt",type:"server-error",from:e,participant:null}))}),s.apply(this,arguments)}l.default=e}),98);
__d("WaWebDecodeProtobufThrottled",["Promise","WABaseProto","WABinary","WAProtoCompile","WAProtoConst","WAProtoValidate","asyncToGeneratorRuntime","decodeProtobuf"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=new(o("WABinary")).Binary(t),r=yield c(e,n,void 0,!1,!1,self.performance.now());return yield p(),o("WAProtoValidate").checkRequirements(e,r),r}),u.apply(this,arguments)}function c(e,t,n,r,o,a){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a,i){var l,s=i;self.performance.now()-s>m&&(yield p(),s=self.performance.now());var u=o("WAProtoCompile").compileSpec(e),d=u.names,_=u.fields,f=u.types,g=u.meta,h=u.oneofToFields,y=u.fieldToOneof,C=u.reservedTags,b=u.reservedFields,v=e.internalDefaults,S=n||babelHelpers.extends({},v)||{};S.$$unknownFieldCount=(l=n==null?void 0:n.$$unknownFieldCount)!=null?l:0;for(var R=0;R<d.length;R++)f[R]&o("WAProtoConst").FLAGS.REPEATED?S[d[R]]=[]:f[R]===(o("WAProtoConst").TYPES.MAP&o("WAProtoConst").TYPE_MASK)&&(S[d[R]]=new Map);for(var L=0,E=_.length>0,k=_[0],I=function*(){var e=o("decodeProtobuf").readBoundVarInt(t,0,4294967296,"field and enc type",o("WABinary").parseInt64OrThrow),n=e&7,i=e>>>3;if(E&&i!==k){var l=L;do++L===_.length&&(L=0),k=_[L];while(i!==k&&L!==l)}if(E&&i===k){var u=d[L],m=f[L];o("decodeProtobuf").assertEncType(n,m,u);var p=m&o("WAProtoConst").TYPE_MASK,v=g[L];if(m&o("WAProtoConst").FLAGS.PACKED)for(var R=t.readVarInt(o("WABinary").parseUint64OrThrow),I=t.readBinary(R);I.size();){var T=o("decodeProtobuf").readValue(u,p,I);(p!==o("WAProtoConst").TYPES.ENUM||v[T]||(v.cast==null?void 0:v.cast(T))!==void 0)&&S[u].push(T)}else if(p===o("WAProtoConst").TYPES.MESSAGE){var D=t.readVarInt(o("WABinary").parseUint64OrThrow),x=t.readBinary(D);if(m&o("WAProtoConst").FLAGS.REPEATED)S[u].push(yield c(v,x,void 0,r,a,s));else{var $=S[u];S[u]=yield c(v,x,$,r,a,s)}}else if(p===o("WAProtoConst").TYPES.MAP){for(var P=t.readVarInt(o("WABinary").parseUint64OrThrow),N=t.readBinary(P),M,w,A=0;A<g[L].length;A++){var F=o("decodeProtobuf").readBoundVarInt(N,0,4294967296,"map field and enc type",o("WABinary").parseInt64OrThrow),O=F&7,B=F>>>3,W=void 0;switch(O){case o("WAProtoConst").ENC.VARINT:W=N.readVarInt(o("WABinary").parseInt64OrThrow);break;case o("WAProtoConst").ENC.BIT64:W=N.readBinary(8);break;case o("WAProtoConst").ENC.BINARY:{var q=v[A];if(q===o("WAProtoConst").TYPES.BYTES||q===o("WAProtoConst").TYPES.STRING)W=o("decodeProtobuf").readValue(u,q,N);else{var U=N.readVarInt(o("WABinary").parseUint64OrThrow),V=N.readBinary(U);W=yield c(q,V,void 0,r,a,s)}break}case o("WAProtoConst").ENC.BIT32:W=N.readBinary(4);break}B===1?M=W:w=W}S[u].set(M,w)}else{var H=o("decodeProtobuf").readValue(u,p,t);(p!==o("WAProtoConst").TYPES.ENUM||v[H]||(v.cast==null?void 0:v.cast(H))!==void 0)&&(m&o("WAProtoConst").FLAGS.REPEATED?S[u].push(H):S[u]=H)}var G=y[u];G&&typeof S[u]!="undefined"&&G.forEach(function(e){var t=h[e].filter(function(e){return e!==u});if(t.forEach(function(e){delete S[e]}),a){var n;S[e]=(n={type:u,value:S[u]},n[o("WABaseProto").TAGGED_UNION_TAG]=!0,n),delete S[u]}}),(C[i]||b[u])&&delete S[u]}else if(S.$$unknownFieldCount++,r){S.$$unsafeUnknownFields||(S.$$unsafeUnknownFields={});var z;switch(n){case o("WAProtoConst").ENC.VARINT:z=t.readVarInt(o("WABinary").parseInt64OrThrow);break;case o("WAProtoConst").ENC.BIT64:z=t.readBinary(8);break;case o("WAProtoConst").ENC.BINARY:z=t.readBinary(t.readVarInt(o("WABinary").parseUint64OrThrow));break;case o("WAProtoConst").ENC.BIT32:z=t.readBinary(4);break}S.$$unsafeUnknownFields[i]=z}else n===o("WAProtoConst").ENC.VARINT?t.readVarInt(o("WABinary").parseInt64OrThrow):n===o("WAProtoConst").ENC.BIT64?t.advance(8):n===o("WAProtoConst").ENC.BINARY?t.advance(t.readVarInt(o("WABinary").parseUint64OrThrow)):n===o("WAProtoConst").ENC.BIT32&&t.advance(4)};t.size();)yield*I();return S}),d.apply(this,arguments)}var m=500;function p(){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield new(e||(e=n("Promise")))(function(e){return self.setTimeout(e,0)})}),_.apply(this,arguments)}l.decodeProtobufThrottled=s}),98);
__d("WAWebHandleHistorySyncChunk",["Promise","WAAsyncSleep","WABinary","WAGzip","WALogger","WALongInt","WATimeUtils","WAWebABProps","WAWebAddonProcessMsgsUtils","WAWebApiChat","WAWebApiHistorySyncNotification","WAWebAppTracker","WAWebChatConstants","WAWebCmd","WAWebCurrentUser","WAWebDBCreateLidPnMappings","WAWebDBMessageUtils","WAWebDownloadManager","WAWebHandleHistorySyncMsg","WAWebHistoryMsgHandlerAction","WAWebHistorySyncDynamicThrottlingManager","WAWebHistorySyncNotificationUtils","WAWebHistorySyncProgress","WAWebHistorySyncWorkerCompatibleNotificationUtils","WAWebHttpErrors","WAWebMessageAssociation.flow","WAWebMessageAssociationGatingUtils","WAWebMetricsAttributionActions","WAWebMmsClient","WAWebMsgKey","WAWebNetworkStatus","WAWebNonMessageDataRequestHistorySyncOnDemandUtils","WAWebNonMessageDataRequestLoggingUtils","WAWebProtobufsE2E.pb","WAWebProtobufsHistorySync.pb","WAWebSchemaMessage","WAWebSendHistSyncServerErrorReceiptJob","WAWebSendReceiptJobCommon","WAWebSetUsernameJob","WAWebSyncGatingUtils","WAWebThreadMsgUtils","WAWebUpdateLidMetadataApi","WAWebUserPrefsAppStateSync","WAWebUserPrefsHistorySync","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsTypes","WAWebUsernameGatingUtils","WAWebWamEnumMdBootstrapStepResult","WAWebWamEnumPeerDataResponseApplyResultType","WAWebWidFactory","WaWebDecodeProtobufThrottled","asyncToGeneratorRuntime","decodeProtobuf","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x,$,P,N,M,w,A,F,O,B,W,q,U,V=10,H=100;function G(e,t){return z.apply(this,arguments)}function z(){return z=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(t===void 0&&(t=V),o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleHistorySyncChunk started for ",""])),o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(e)).tags("history-sync"),e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP){var a=yield o("WAWebUserPrefsHistorySync").getInitialHistorySyncComplete();if(a===!0){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Skip duplicate initial sync chunk ",""])),o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(e)).tags("history-sync");return}}if(o("WAWebMetricsAttributionActions").startHistorySyncAttributionTracking(e.syncType),e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_STATUS_V3)try{var i=r("WAWebMsgKey").fromString(e.msgKey);o("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:i.remote,type:o("WAWebSendReceiptJobCommon").RECEIPT_TYPE.HISTORY_SYNC_COMPLETION,groupedReceipt:new Map().set(i.remote,[i.id])})}catch(e){o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[history sync] history_sync_notification_handler: sending Status receipt failed"]))).tags("history-sync").devConsole(e)}var l=yield o("WAWebHistorySyncNotificationUtils").getHistorySyncProgress(e),F=o("WAWebHistorySyncNotificationUtils").maybeGetInlinePayload(e),O=yield o("WAWebHistorySyncNotificationUtils").getHistorySyncMetrics(e,F==null),B=O.historySyncStartDownloadingMetric,W=O.historySyncDownloadedMetric,q=O.historySyncDataAppliedMetric;o("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(e.syncType,o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DOWNLOADING,e.chunkOrder),o("WAWebHistorySyncNotificationUtils").commitHistoryStartDownloadingMetric(B,e.historySyncStepStartedTs,o("WATimeUtils").unixTimeMs());var z=null;if(F!=null)o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[history sync] get inline payload in chunk, ",""])),o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(e)).tags("history-sync"),z=F;else try{o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[history sync] start downloading chunk, ",""])),o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(e)).tags("history-sync"),z=yield o("WAWebDownloadManager").downloadManager.downloadAndMaybeDecrypt(babelHelpers.extends({signal:new AbortController().signal},e.downloadOptions))}catch(n){if(o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history sync] history sync download failed"]))).devConsole(n),o("WAWebMetricsAttributionActions").stopHistorySyncAttributionTracking(e.syncType),n instanceof o("WAWebHttpErrors").HttpNetworkError){if(e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP&&t>0){yield r("WAWebNetworkStatus").waitIfOffline(),o("WALogger").WARN(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Initial sync download failed due to network error retry download"]))).tags("history-sync");var X=t-1;return G(e,X)}o("WAWebApiHistorySyncNotification").removeLocalFailureFromInFlightChunk(e.msgKey);return}var Y=r("WAWebMsgKey").fromString(e.msgKey);if(o("WAWebHistorySyncNotificationUtils").commitHistoryDownloadedMetric(W,e.historySyncStepStartedTs,!1,o("WATimeUtils").unixTimeMs()),e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND){var J,Z;o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[history sync][rdu] history sync on demand chunk fails to download."]))),o("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").handleHistorySyncOnDemandFailure((J=e.peerDataRequestChatId)!=null?J:""),o("WAWebNonMessageDataRequestLoggingUtils").logHistorySyncOnDemandResponse(o("WAWebWamEnumPeerDataResponseApplyResultType").PEER_DATA_RESPONSE_APPLY_RESULT_TYPE.FAIL_TO_DOWNLOAD,(Z=e.peerDataRequestSessionId)!=null?Z:"")}r("WAWebSendHistSyncServerErrorReceiptJob")(Y.remote,Y.id,e.downloadOptions.mediaKey),yield o("WAWebApiHistorySyncNotification").markChunkForReuploadPending(e.msgKey);return}o("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(e.syncType,o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DOWNLOADED,e.chunkOrder),e.downloadOptions.mediaKey="",W.mdBootstrapStepResult=o("WAWebWamEnumMdBootstrapStepResult").MD_BOOTSTRAP_STEP_RESULT.SUCCESS;var ee=new(o("WABinary")).Binary(z),te=yield o("WAGzip").inflate(ee.readByteArrayView()),ne;o("WAWebAppTracker").AppTracker.start(o("WAWebAppTracker").AppTrackerType.HSProtobufParsing),o("WAWebABProps").getABPropConfigValue("web_anr_throttle_protobuf_decoding")?ne=yield o("WaWebDecodeProtobufThrottled").decodeProtobufThrottled(o("WAWebProtobufsHistorySync.pb").HistorySyncSpec,te):ne=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsHistorySync.pb").HistorySyncSpec,te),o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.HSProtobufParsing);var re=[];ne.phoneNumberToLidMappings.forEach(function(e){var t=e.lidJid,n=e.pnJid;t!=null&&n!=null&&re.push({lid:o("WAWebWidFactory").createUserLidOrThrow(t),pn:o("WAWebWidFactory").createUserWidOrThrow(n)})});var oe={mappings:re,flushImmediately:!0,learningSource:"other"};e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP?yield o("WAWebDBCreateLidPnMappings").createLidPnMappings(oe):yield o("WAWebDBCreateLidPnMappings").createLidPnMappingsInBatches(oe);var ae=o("WAWebHistorySyncNotificationUtils").getLidMappingAsStringSet(re);o("WAWebCurrentUser").isEmployee()&&o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["completed learning lid mappings for history sync. count: ",". ","..."])),ae==null?void 0:ae.size,o("WAWebHistorySyncNotificationUtils").getLidsForLogging(ae)).verbose();var ie=new Map;o("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(e.syncType,o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DECODED,e.chunkOrder),o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync] chunk downloaded, ",""])),o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(e,void 0,ne.conversations.length));var le=o("WATimeUtils").unixTimeMs();e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT&&e.chunkOrder!=null&&o("WAWebHistorySyncProgress").updateHistorySyncProgressModel();var se=function(n){o("WAWebHistorySyncNotificationUtils").commitHistoryDataAppliedMetric({historySyncDataAppliedMetric:q,startTs:e.historySyncStepStartedTs,isSuccess:!1,forceFlushWamBuffer:!0,failureReason:n})};e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_STATUS_V3&&ne.statusV3Messages&&ne.statusV3Messages.length>0?yield o("WAWebHistoryMsgHandlerAction").handleStatusMessages(ne,e,W,q,le).catch(function(e){throw o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing status messages failed: ",""])),e),se(""+e),e}):e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.NON_BLOCKING_DATA?yield o("WAWebHistoryMsgHandlerAction").handleNonBlockingData(ne,e,W,q,le).catch(function(e){throw o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing non blocking data failed: ",""])),e),se(""+e),e}):e.syncType!==o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.PUSH_NAME&&(ne.conversations=ne.conversations.reduce(function(e,t){var n=null;try{n=o("WAWebWidFactory").createWid(t.id)}catch(e){o("WALogger").WARN(b||(b=babelHelpers.taggedTemplateLiteralLoose(['[history sync] handleHistorySyncChunk: failed to create wid from "','": ',""])),t.id,e).tags("history-sync")}return n?e.concat(t):e},[]));var ue=[],ce=[],de=[];if(e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP)yield o("WAWebHistoryMsgHandlerAction").handleInitialSyncMsgs(ne,e,ue,W,q,le,de,re).catch(function(e){throw o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing initial sync messages failed: ",""])),e),se(""+e),e});else if(e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.PUSH_NAME)yield o("WAWebHistoryMsgHandlerAction").handlePushName(ne,e,W,q,le).catch(function(e){throw o("WALogger").LOG(S||(S=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing initial pushname failed: ",""])),e),se(""+e),e});else if(![o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_STATUS_V3,o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.NON_BLOCKING_DATA].includes(e.syncType)&&(o("WALogger").LOG(R||(R=babelHelpers.taggedTemplateLiteralLoose(["[history sync] start processing non initial status messages"]))),yield new(U||(U=n("Promise")))(function(e){return self.setTimeout(e,0)}),!j(e,ne))){var me=[],pe=new Set,_e=[],fe=[],ge=[],he=new Set,ye=[],Ce=o("WAWebUserPrefsHistorySync").getHistoryInitialSyncBoundary(),be=0,ve=0,Se=!1,Re=o("WAWebSyncGatingUtils").getRecentSyncMessageProcessingBreakIteration(),Le=yield o("WAWebUserPrefsAppStateSync").getAllCriticalDataSynced();(Ce==null||Object.keys(Ce).length===0)&&o("WALogger").LOG(L||(L=babelHelpers.taggedTemplateLiteralLoose(["[history sync] boundary data is null or empty"])));for(var Ee=0;Ee<ne.conversations.length;Ee++){var ke=!1,Ie=ne.conversations[Ee],Te=Ce==null?void 0:Ce[Ie.id];if(Te==null){o("WALogger").LOG(E||(E=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Dropping chat ","$ due to null entry in initial sync boundary"])),r("gkx")("26258")?"-":Ie.id).tags("history-sync");var De=o("WAWebWidFactory").createWid(Ie.id).toJid();(Ce==null?void 0:Ce[De])!=null&&o("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[history sync] dropping chat "," due to null entry in initial sync boundary, but it exists as chatJid ",""])),r("gkx")("26258")?"-":Ie.id,r("gkx")("26258")?"-":De).sendLogs("history-sync-unexpected-conversation-drop"),ke=!0}var xe=o("WAWebWidFactory").createWid(Ie.id);xe.isNewsletter()&&(o("WALogger").LOG(I||(I=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Dropping chat ","$ due to chat is not enabled for sync"])),r("gkx")("26258")?"-":Ie.id),ke=!0);var $e=yield o("WAWebApiChat").getChatRecord(xe),Pe=($e==null?void 0:$e.endOfHistoryTransferType)===o("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.COMPLETE_AND_NO_MORE_MESSAGE_REMAIN_ON_PRIMARY;if((!$e&&Te!=null||$e&&$e.endOfHistoryTransferType==null||Pe)&&(o("WALogger").LOG(T||(T=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Dropping chat "," due to the chat in sync payload "," is already marked as complete locally"])),r("gkx")("26258")?"-":Ie.id,o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(e)).tags("history-sync"),ke=!0),ke)e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND&&(Se=!0);else{for(var Ne=0,Me=self.performance.now(),we=0;we<Ie.messages.length;we++){var Ae,Fe,Oe,Be;be++;var We=o("WAWebHistorySyncDynamicThrottlingManager").historySyncDynamicThrottlingManager.getThrottleRate();if(++Ne>=We.batchSize&&o("WAWebABProps").getABPropConfigValue("wa_web_history_sync_dynamic_throttling")){var qe=self.performance.now(),Ue=qe-Me;o("WALogger").LOG(D||(D=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Observed process time ","ms, target process time ","ms, batch size ",""])),Ue.toFixed(),o("WAWebHistorySyncDynamicThrottlingManager").historySyncDynamicThrottlingManager.targetTimeMs.toFixed(),Ne).tags("history-sync"),o("WAWebHistorySyncDynamicThrottlingManager").historySyncDynamicThrottlingManager.setLastProcessTime(Ue,Ne),We.delayMs>0&&(o("WALogger").LOG(x||(x=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Applying message throttling delay: ","ms"])),We.delayMs.toFixed()).tags("history-sync"),yield o("WAAsyncSleep").asyncSleep(We.delayMs)),Ne=0,Me=self.performance.now()}var Ve=Ie.messages[we],He=o("WALongInt").maybeNumberOrThrowIfTooLarge(Ve.msgOrderId);if(!(Te!=null&&Te!==-1&&He!=null&&He>=Te)){var Ge=(Ve==null||(Ae=Ve.message)==null||(Ae=Ae.message)==null||(Ae=Ae.protocolMessage)==null?void 0:Ae.type)===o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REQUEST_WELCOME_MESSAGE;if(Ge===!0){o("WALogger").LOG($||($=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Dropping request welcome message"])));continue}var ze=(Ve==null||(Fe=Ve.message)==null||(Fe=Fe.message)==null||(Fe=Fe.protocolMessage)==null?void 0:Fe.type)===o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.BOT_MEMU_ONBOARDING_MESSAGE;if(ze){o("WALogger").LOG(P||(P=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Dropping memu onboarding message"])));continue}he.add(Ie.id);var je=o("WAWebHistorySyncNotificationUtils").parseWebMsgInfoAndReturnNullOnFailure(xe,Ve.message,e,ae,ie);if(je&&je.id.remote.toString()!==Ie.id&&he.add(je.id.remote.toString()),we===0&&je&&$e){var Ke=yield o("WAWebSchemaMessage").getMessageTable().betweenCount(["internalId"],o("WAWebDBMessageUtils").beginningOfChat(xe),o("WAWebDBMessageUtils").endOfChat(xe));Ke===0&&ye.push(je)}if(ge=ge.concat(o("WAWebAddonProcessMsgsUtils").parseHistorySyncMsg({webMsgInfo:Ve.message,parsedWebMsgInfo:je,isFromCag:(Oe=Ie.isDefaultSubgroup)!=null?Oe:!1})),je!=null&&((Be=Ve.message)==null||(Be=Be.commentMetadata)==null?void 0:Be.commentParentKey)==null&&(pe.has(je.id.toString())&&o("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&pe.delete(je==null?void 0:je.id.toString()),me.push(je)),je!=null&&o("WAWebMessageAssociation.flow").isAssociatedMsg(je)&&o("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var Qe=je.parentMsgKey.toString();pe.add(Qe),_e.push(je)}je!=null&&o("WAWebThreadMsgUtils").isThreadMsg(je)&&fe.push(je),o("WAWebABProps").getABPropConfigValue("wa_web_history_sync_dynamic_throttling")||(yield o("WAAsyncSleep").asyncSleepAfterGivenLoopIteration(ve++,Le?Re:H))}}if(Ne>0){var Xe=self.performance.now(),Ye=Xe-Me;o("WAWebHistorySyncDynamicThrottlingManager").historySyncDynamicThrottlingManager.setLastProcessTime(Ye,Ne)}}}W.mdBootstrapMessagesCount=be,W.mdBootstrapChatsCount=ne.conversations.length,o("WAWebHistorySyncNotificationUtils").commitHistoryDownloadedMetric(W,e.historySyncStepStartedTs,!0,le),o("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(e.syncType,o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.MESSAGE_PREPROCESSED,e.chunkOrder);try{me.length!==0?yield o("WAWebHandleHistorySyncMsg").handleProgressiveHistorySyncMsgs(me,Array.from(he),ge,ye,e.syncType,e.chunkOrder,_e,pe,fe):o("WALogger").LOG(N||(N=babelHelpers.taggedTemplateLiteralLoose(["[history sync] no messages from history sync need to handle"]))),yield o("WAWebUserPrefsHistorySync").setLastHistorySyncedChunk(e.syncType,e.chunkOrder,l),o("WAWebHistorySyncProgress").updateHistorySyncProgressModel(),yield o("WAWebApiHistorySyncNotification").updateCurrentlyProcessed(e.msgKey,e.syncType,e.chunkOrder);var Je=new Set;ne.conversations.forEach(function(e){var t=o("WAWebWidFactory").createWid(e.id);Je.add(t.toString());var n=(Ce==null?void 0:Ce[e.id])!=null,r=null;if(n&&(r=e.endOfHistoryTransferType),r!=null)return o("WAWebHistorySyncWorkerCompatibleNotificationUtils").updateEndOfHistorySync(t,r)}),K(e,ne,Se),o("WAWebCmd").Cmd.onHistorySyncChunkProcessed(Je),o("WAWebHistorySyncNotificationUtils").commitHistoryDataAppliedMetric({historySyncDataAppliedMetric:q,startTs:e.historySyncStepStartedTs,isSuccess:!0}),o("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(e.syncType,o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.APPLIED,e.chunkOrder),o("WALogger").LOG(M||(M=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing recent/full/on-demand chunk complete, ",""])),o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(e,be,he.size))}catch(e){throw o("WALogger").LOG(w||(w=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing recent/full/on-demand chunk failed: ",""])),e),se(String(e)),e}}var Ze=r("WAWebMsgKey").fromString(e.msgKey),et=new Map;et.set(Ze.remote,[Ze.id]),e.syncType!==o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_STATUS_V3&&o("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:Ze.remote,type:o("WAWebSendReceiptJobCommon").RECEIPT_TYPE.HISTORY_SYNC_COMPLETION,groupedReceipt:et}),yield o("WAWebDBCreateLidPnMappings").createLidPnMappingsInBatches({mappings:ce,flushImmediately:!0,learningSource:"other"}),yield o("WAWebUpdateLidMetadataApi").updateLidMetadata({updates:ue}),o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&(yield o("WAWebSetUsernameJob").setUsernamesJob(de)),yield o("WAWebApiHistorySyncNotification").updateCurrentlyProcessed(e.msgKey,e.syncType,e.chunkOrder),e.downloadOptions.encFilehash!=null&&r("WAWebMmsClient").deleteMdHistorySyncBlob({directPath:e.downloadOptions.directPath,encFilehash:e.downloadOptions.encFilehash,signal:new AbortController().signal,encHandle:e.encHandle,companionUserSecret:o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WAWebCompanionMetaNonce")}).catch(function(e){o("WALogger").WARN(A||(A=babelHelpers.taggedTemplateLiteralLoose(["MMS client delete error"]))).devConsole(e)});var tt=ne.conversations.length===1?ne.conversations[0].id:null;yield Q(e.syncType,ne.progress,tt),o("WAWebHistorySyncNotificationUtils").reportMissingMapping(ie)}),z.apply(this,arguments)}function j(t,n){if(t.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND&&n.conversations.length!==1){var a,i;return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[history sync][rdu] dropping history sync on demand response as its conversation length "," is not 1."])),r("gkx")("26258")?"":n.conversations.length),o("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").handleHistorySyncOnDemandFailure((a=t.peerDataRequestChatId)!=null?a:""),o("WAWebNonMessageDataRequestLoggingUtils").logHistorySyncOnDemandResponse(o("WAWebWamEnumPeerDataResponseApplyResultType").PEER_DATA_RESPONSE_APPLY_RESULT_TYPE.INVALID_RESPONSE,(i=t.peerDataRequestSessionId)!=null?i:""),!0}return!1}function K(e,t,n){if(e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND&&t.conversations.length===1){var r;o("WAWebMetricsAttributionActions").stopHistorySyncAttributionTracking(e.syncType);var a=t.conversations[0].id;n?o("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").handleHistorySyncOnDemandFailure(a):o("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").handleHistorySyncOnDemandSuccess(a),o("WAWebNonMessageDataRequestLoggingUtils").logHistorySyncOnDemandResponse(n?o("WAWebWamEnumPeerDataResponseApplyResultType").PEER_DATA_RESPONSE_APPLY_RESULT_TYPE.OTHER_ERROR:o("WAWebWamEnumPeerDataResponseApplyResultType").PEER_DATA_RESPONSE_APPLY_RESULT_TYPE.SUCCESS,(r=e.peerDataRequestSessionId)!=null?r:"")}}function Q(e,t,n){return X.apply(this,arguments)}function X(){return X=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a=o("WAWebSyncGatingUtils").isHistorySyncOnDemandEnabled();if((t===100||e===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP)&&o("WAWebMetricsAttributionActions").stopHistorySyncAttributionTracking(e),e===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP)o("WALogger").LOG(F||(F=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Initial bootstrap history sync complete"]))).tags("history-sync"),yield o("WAWebUserPrefsHistorySync").setInitialHistorySyncComplete(),yield o("WAWebUserPrefsHistorySync").setHistorySyncStatus({initialCompleted:!0}),o("WAWebCmd").Cmd.onInitialChatHistorySynced();else if(e===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT&&t===100)o("WALogger").LOG(O||(O=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Recent history sync complete"]))).tags("history-sync"),yield o("WAWebUserPrefsHistorySync").setHistorySyncStatus({recentCompleted:!0}),o("WAWebCmd").Cmd.onRecentChatHistorySynced();else if(e===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.FULL&&t===100)o("WALogger").LOG(B||(B=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Full history sync complete"]))).tags("history-sync"),a||(o("WALogger").LOG(W||(W=babelHelpers.taggedTemplateLiteralLoose(["[history sync] set history initial sync boundary to empty"]))),o("WAWebUserPrefsHistorySync").setHistoryInitialSyncBoundary({})),yield o("WAWebUserPrefsHistorySync").setHistorySyncStatus({fullCompleted:!0}),o("WAWebCmd").Cmd.onFullChatHistorySynced();else if(a&&e===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND&&t===100){var i;o("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[history sync] On demand history sync complete for chat ",""])),r("gkx")("26258")?"-":n).tags("history-sync");var l="onDemandCompleted_"+(n!=null?n:"");yield o("WAWebUserPrefsHistorySync").setHistorySyncStatus((i={},i[l]=!0,i))}}),X.apply(this,arguments)}l.handleHistorySyncChunk=G}),98);
__d("WAWebDBProcessRecentAndFullHistorySyncMessage",["Promise","WALogger","WATimeUtils","WAWebABProps","WAWebApiChat","WAWebApiFilterAndReplaceMessages","WAWebApiGroupInviteV4Store","WAWebBackendApi","WAWebDBEncryptMultipleMsgs","WAWebDBStoreEncryptedMsgs","WAWebMessageAssociationGatingUtils","WAWebMsgGetters","WAWebMsgType","WAWebProcessMessageAssociationMessages","WAWebRunInBatches","WAWebRuntimeEnvironmentUtils","WAWebSchemaChat","WAWebSyncGatingUtils","WAWebThreadCommonModelUtils","WAWebThreadMetadataBulkJob","WAWebUserPrefsHistorySync","WAWebUserPrefsTypes","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y=2500,C=1e3;function b(e,t,n,r,o,a,i){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r,a,i,l,c,d){var m=t,p,_;if(l.length&&o("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var f;if(_=o("WAWebProcessMessageAssociationMessages").classifyAssociatedMsgsFromHistorySyncUsingMissingParentsCache(l,c),(f=_)!=null&&f.validAssociatedMsgs){var g;p=o("WAWebApiFilterAndReplaceMessages").validateMsgFn((g=_)==null?void 0:g.validAssociatedMsgs)}}try{var y=yield o("WAWebApiFilterAndReplaceMessages").filterAndReplaceMessages(t,p),C=y.newMsgs;m=C}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["filterAndReplaceMessages failed with error ",""])),t).tags("history-sync")}var b=new Map,v=[];m.forEach(function(e){e.type===o("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE&&v.push(o("WAWebApiGroupInviteV4Store").persistGroupInviteV4Msg(e.id.toString(),{id:e.id.toString(),from:e.from.toString(),to:e.to.toString(),groupId:e.inviteGrp,expiration:parseInt(e.inviteCodeExp,10),expired:o("WATimeUtils").unixTime()>=parseInt(e.inviteCodeExp,10)}));var t=e.id.remote.toString();if(o("WAWebMsgGetters").getIsImportantMessage(e))if(b.has(t)){var n;(n=b.get(t))==null||n.push(e)}else b.set(t,[e])}),v.length>0&&(yield(h||(h=n("Promise"))).all(v));var R=o("WAWebSyncGatingUtils").isRecentSyncWorkerComaptibleHandlingEnabled()||o("WAWebSyncGatingUtils").isRecentSyncChunkDataHandlingInWorkerEnabled(),E=R&&o("WAWebRuntimeEnvironmentUtils").isWorker()?yield L(b):yield o("WAWebBackendApi").frontendSendAndReceive("processAndGetUnreadMentionsInfo",{filteredMsgs:m}),k=E.unreadMentionsToAdd,I=E.pendingUnreadMentionsMap;o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync] recent or full or on demand sync starts encrypting "," messages"])),m.length);var D=yield o("WAWebDBEncryptMultipleMsgs").encryptMultipleDBMsgs(m,!0);o("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(a,o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.ENCRYPTED,i),o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[history sync] recent or full sync or on demand starts storing "," encrypted messages"])),D.length),yield S(D,r,k,I,R),yield T(d)}),v.apply(this,arguments)}function S(e,t,n,r,o){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,a,i){try{if(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedRecentAndFullSyncMsgs: storing "," messages: start"])),e.length),o("WAWebABProps").getABPropConfigValue("web_anr_throttle_history_sync_db_writes"))try{yield o("WAWebRunInBatches").runInBatches(e,(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: storing "," messages: start"])),e.length),yield o("WAWebDBStoreEncryptedMsgs").storeEncryptedDBMessages(e,t,!0),o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: storing "," messages: done"])),e.length)});return function(t){return e.apply(this,arguments)}})(),{batchSize:y,delayMs:C})}catch(t){throw o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: failed to store "," in batches: ",""])),e.length,t).sendLogs("failed-to-store-encrypted-db-messages-in-batches"),t}else yield o("WAWebDBStoreEncryptedMsgs").storeEncryptedDBMessages(e,t,!0);if(o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedRecentAndFullSyncMsgs: storing "," messages: done"])),e.length),r.size>0){var l=i&&o("WAWebRuntimeEnvironmentUtils").isWorker()?yield k(r,a):yield o("WAWebBackendApi").frontendSendAndReceive("getChatIdsNeedToBeDeletedFromUnreadMentionInfo",{unreadMentionsToAdd:r,pendingUnreadMentionsMap:a});l.forEach(function(e){r.delete(e)}),r.size>0&&o("WAWebApiChat").addUnreadMentionChat(r,a)}}catch(t){o("WALogger").WARN(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[history sync] error storing "," recent or full sync messages: ",""])),e.length,t)}}),R.apply(this,arguments)}function L(e){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=new Map,n=new Map,r=Array.from(e.keys()),a=(yield o("WAWebSchemaChat").getChatTable().bulkGet(r)).reduce(function(e,t){return t&&t.id&&e.set(t.id,t),e},new Map);return e.forEach(function(e,r){var o=a.get(r);e.forEach(function(e){var a=0;if(n.has(r)){var l;a=(l=n.get(r))!=null?l:0}else{var i;a=(i=o==null?void 0:o.unreadMentionCount)!=null?i:0,n.set(r,a)}if(a>0){n.set(r,a-1);var s={id:e.id.toString(),timestamp:e.t};if(t.has(r)){var u;(u=t.get(r))==null||u.push(s)}else t.set(r,[s])}})}),{unreadMentionsToAdd:t,pendingUnreadMentionsMap:n}}),E.apply(this,arguments)}function k(e,t){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=Array.from(e.keys()),r=(yield o("WAWebSchemaChat").getChatTable().bulkGet(n)).reduce(function(e,t){return t&&t.id&&e.set(t.id,t),e},new Map),a=[];return e.forEach(function(e,n){var i,l=r.get(n),s=(i=t.get(n))!=null?i:0;if((l==null?void 0:l.unreadMentionCount)===0){a.push(n);return}(l==null?void 0:l.unreadMentionCount)!=null&&(l==null?void 0:l.unreadMentionCount)>0&&o("WAWebBackendApi").frontendFireAndForget("updateUnreadMentionMetadataByAdding",{chatId:n,newUnreadMentions:e,pendingUnreadMentionCount:s})}),a}),I.apply(this,arguments)}function T(e){return D.apply(this,arguments)}function D(){return D=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e.length!==0)try{var t=o("WAWebThreadCommonModelUtils").getAggregatedThreadDetailUpdatesFromMessages(e);yield o("WAWebThreadMetadataBulkJob").bulkCreateOrUpdateThreadsMetadata(t)}catch(e){o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["storeThreadMetadataFromHistorySyncMessages: failed to store thread metadata: ",""])),e).sendLogs("failed-to-store-thread-metadata-from-history-sync-messages")}}),D.apply(this,arguments)}l.storeRecentAndFullHistSyncMessages=b}),98);
__d("WAWebHandleHistorySyncMsg",["Promise","WAFilteredCatch","WALogger","WAWebAddonProcessMsgs","WAWebBackendErrors","WAWebCheckUpdateOrphanReactions","WAWebDBProcessRecentAndFullHistorySyncMessage","WAWebNoop","WAWebSyncdOrphan","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e,t,n,r,o,a,i,l,s){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i,l,c,d,m,p,_){return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[history sync] starts handling recent/full/on-demand sync progressive history messages"]))),yield(u||(u=n("Promise"))).resolve(),o("WAWebDBProcessRecentAndFullHistorySyncMessage").storeRecentAndFullHistSyncMessages(t,a,c,d,m,p,_).then(function(){var e=a.map(function(e){return e}),n=t.map(function(e){return e.id.toString()});return o("WAWebCheckUpdateOrphanReactions").checkUpdateForOrphanReactions(n),o("WAWebSyncdOrphan").checkOrphanMutations(n,e)}).then(function(){return(u||(u=n("Promise"))).all(i).then(function(e){var t;return o("WAWebAddonProcessMsgs").processHistoryMsgs((t=[]).concat.apply(t,e))})}).then(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){for(var e of l){if(!e||!e.id||!e.id.remote)return;var t=e.id.remote;if(t.isNewsletter())return;yield o("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("processLastMsgs",{chatId:t,msgObjs:[e],meta:{add:"last",isHistory:!0},processMessagesOrigin:"historyMsgHandlerAction",chatMsgsCollection:null})}})).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").LogoutDrop,r("WAWebNoop"))).catch(function(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Error: ",", message: ",", stack: ",""])),e.name,e.message,e.stack).devConsole(e).sendLogs("handleProgressiveHistorySyncMsgs: error storing/processing multiple messages")})}),d.apply(this,arguments)}l.handleProgressiveHistorySyncMsgs=c}),98);
__d("WAWebHandleWorkerCompatibleRecentSyncChunk",["Promise","WABinary","WAGzip","WALogger","WATimeUtils","WAWebApiHistorySyncNotification","WAWebCmd","WAWebDBCreateLidPnMappings","WAWebDownloadManager","WAWebHandleHistorySyncMsg","WAWebHistorySyncNotificationUtils","WAWebHistorySyncProgress","WAWebHistorySyncWorkerCompatibleNotificationUtils","WAWebHttpErrors","WAWebMetricsAttributionActions","WAWebMmsClient","WAWebMsgKey","WAWebPreprocessHistorySyncProto","WAWebProtobufsHistorySync.pb","WAWebSendHistSyncServerErrorReceiptJob","WAWebSendReceiptJobCommon","WAWebSetUsernameJob","WAWebSyncGatingUtils","WAWebUpdateLidMetadataApi","WAWebUserPrefsHistorySync","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsTypes","WAWebUsernameGatingUtils","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v;function S(e){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] handleHistorySyncChunk started for ",""])),o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(t)).tags("history-sync"),o("WAWebMetricsAttributionActions").startHistorySyncAttributionTracking(t.syncType);var a=yield o("WAWebHistorySyncNotificationUtils").getHistorySyncProgress(t),i=o("WAWebSyncGatingUtils").isRecentSyncDownloadOptimizationEnabled(),l=i?t.downloadedHistorySyncPayload:null,S=yield o("WAWebHistorySyncNotificationUtils").getHistorySyncMetrics(t,!0),R=S.historySyncStartDownloadingMetric,L=S.historySyncDownloadedMetric,E=S.historySyncDataAppliedMetric,k=null;if(l!=null)o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] get downloaded payload in chunk, ",""])),o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(t)).tags("history-sync"),k=l;else{o("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(t.syncType,o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DOWNLOADING,t.chunkOrder),o("WAWebHistorySyncNotificationUtils").commitHistoryStartDownloadingMetric(R,t.historySyncStepStartedTs,o("WATimeUtils").unixTimeMs());try{o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] start downloading chunk, ",""])),o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(t)).tags("history-sync"),k=yield o("WAWebDownloadManager").downloadManager.downloadAndMaybeDecrypt(babelHelpers.extends({signal:new AbortController().signal},t.downloadOptions))}catch(e){if(o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] history sync download failed"]))).devConsole(e),o("WAWebMetricsAttributionActions").stopHistorySyncAttributionTracking(t.syncType),e instanceof o("WAWebHttpErrors").HttpNetworkError){o("WAWebApiHistorySyncNotification").removeLocalFailureFromInFlightChunk(t.msgKey);return}var I=r("WAWebMsgKey").fromString(t.msgKey);o("WAWebHistorySyncNotificationUtils").commitHistoryDownloadedMetric(L,t.historySyncStepStartedTs,!1,o("WATimeUtils").unixTimeMs()),r("WAWebSendHistSyncServerErrorReceiptJob")(I.remote,I.id,t.downloadOptions.mediaKey),yield o("WAWebApiHistorySyncNotification").markChunkForReuploadPending(t.msgKey);return}o("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(t.syncType,o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DOWNLOADED,t.chunkOrder),t.downloadOptions.mediaKey="",o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] chunk downloaded, ",""])),o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(t))}var T=new(o("WABinary")).Binary(k),D=yield o("WAGzip").inflate(T.readByteArrayView()),x=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsHistorySync.pb").HistorySyncSpec,D),$=[];x.phoneNumberToLidMappings.forEach(function(e){var t=e.lidJid,n=e.pnJid;t!=null&&n!=null&&$.push({lid:o("WAWebWidFactory").createUserLidOrThrow(t),pn:o("WAWebWidFactory").createUserWidOrThrow(n)})}),yield o("WAWebDBCreateLidPnMappings").createLidPnMappingsInBatches({mappings:$,flushImmediately:!0,identityChangeHandlingEnabled:!1,learningSource:"other"}),o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] learned "," mappings"])),$.length),o("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(t.syncType,o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DECODED,t.chunkOrder),o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] chunk decoded, ",""])),o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(t,void 0,x.conversations.length));var P=o("WATimeUtils").unixTimeMs();t.chunkOrder!=null&&o("WAWebHistorySyncProgress").updateHistorySyncProgressModel(),x.conversations=x.conversations.reduce(function(e,t){var n=null;try{n=o("WAWebWidFactory").createWid(t.id)}catch(e){o("WALogger").WARN(_||(_=babelHelpers.taggedTemplateLiteralLoose(['[history sync][recent sync] handleWorkerCompatibleRecentSyncChunk: failed to create wid from "','": ',""])),t.id,e).tags("history-sync")}return n?e.concat(t):e},[]);var N=[],M=[],w=[];try{o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] start processing recent sync messages"]))),yield new(v||(v=n("Promise")))(function(e){return self.setTimeout(e,0)});var A=yield o("WAWebPreprocessHistorySyncProto").preprocessHistorySyncProto(x,$),F=A.recentOrFullSyncMsgs,O=A.chatsWithRecentOrFullSyncMsgs,B=A.unifiedAddons,W=A.lastMsgs,q=A.totalChunkMsgCount,U=A.associatedMsgs,V=A.missingParentsCache,H=A.threadMsgs;i||(L.mdBootstrapMessagesCount=q,L.mdBootstrapChatsCount=x.conversations.length,o("WAWebHistorySyncNotificationUtils").commitHistoryDownloadedMetric(L,t.historySyncStepStartedTs,!0,P)),o("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(t.syncType,o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.MESSAGE_PREPROCESSED,t.chunkOrder),F.length!==0?yield o("WAWebHandleHistorySyncMsg").handleProgressiveHistorySyncMsgs(F,Array.from(O),B,W,t.syncType,t.chunkOrder,U,V,H):o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] no messages from history sync need to handle"]))),o("WAWebUserPrefsHistorySync").setHistorySyncTotalProcessedMessageCount(q),yield o("WAWebUserPrefsHistorySync").setLastHistorySyncedChunk(t.syncType,t.chunkOrder,a),o("WAWebHistorySyncProgress").updateHistorySyncProgressModel(),yield o("WAWebApiHistorySyncNotification").updateCurrentlyProcessed(t.msgKey,t.syncType,t.chunkOrder);var G=o("WAWebUserPrefsHistorySync").getHistoryInitialSyncBoundary(),z=new Set;x.conversations.forEach(function(e){var t=o("WAWebWidFactory").createWid(e.id);z.add(t.toString());var n=(G==null?void 0:G[e.id])!=null;if(n){var r=e.endOfHistoryTransferType;if(r!=null)return o("WAWebHistorySyncWorkerCompatibleNotificationUtils").updateEndOfHistorySync(t,r)}}),o("WAWebCmd").Cmd.onHistorySyncChunkProcessed(z),o("WAWebHistorySyncNotificationUtils").commitHistoryDataAppliedMetric({historySyncDataAppliedMetric:E,startTs:t.historySyncStepStartedTs,isSuccess:!0}),o("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(t.syncType,o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.APPLIED,t.chunkOrder),o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] storing recent chunk complete, ",""])),o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(t,q,O.length))}catch(e){throw o("WALogger").WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] handleWorkerCompatibleRecentSyncChunk failed with error ",""])),e),o("WAWebHistorySyncNotificationUtils").commitHistoryDataAppliedMetric({historySyncDataAppliedMetric:E,startTs:t.historySyncStepStartedTs,isSuccess:!1,forceFlushWamBuffer:!0,failureReason:String(e)}),e}var j=r("WAWebMsgKey").fromString(t.msgKey),K=new Map;K.set(j.remote,[j.id]),t.syncType!==o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_STATUS_V3&&o("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:j.remote,type:o("WAWebSendReceiptJobCommon").RECEIPT_TYPE.HISTORY_SYNC_COMPLETION,groupedReceipt:K}),yield o("WAWebDBCreateLidPnMappings").createLidPnMappingsInBatches({mappings:M,flushImmediately:!0,identityChangeHandlingEnabled:!1,learningSource:"other"}),yield o("WAWebUpdateLidMetadataApi").updateLidMetadata({updates:N}),o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&(yield o("WAWebSetUsernameJob").setUsernamesJob(w)),yield o("WAWebApiHistorySyncNotification").updateCurrentlyProcessed(t.msgKey,t.syncType,t.chunkOrder),t.downloadOptions.encFilehash!=null&&r("WAWebMmsClient").deleteMdHistorySyncBlob({directPath:t.downloadOptions.directPath,encFilehash:t.downloadOptions.encFilehash,signal:new AbortController().signal,encHandle:t.encHandle,companionUserSecret:o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WAWebCompanionMetaNonce")}).catch(function(e){o("WALogger").WARN(C||(C=babelHelpers.taggedTemplateLiteralLoose(["MMS client delete error"]))).devConsole(e)}),a===100&&(o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] Recent history sync complete"]))).tags("history-sync"),o("WAWebMetricsAttributionActions").stopHistorySyncAttributionTracking(t.syncType),yield o("WAWebUserPrefsHistorySync").setHistorySyncStatus({recentCompleted:!0}),o("WAWebCmd").Cmd.onRecentChatHistorySynced())}),R.apply(this,arguments)}l.handleWorkerCompatibleRecentSyncChunk=S}),98);
__d("WAWebPreprocessHistorySyncProto",["WAAsyncSleep","WALogger","WALongInt","WAWebABProps","WAWebAddonProcessMsgsUtils","WAWebApiChat","WAWebChatConstants","WAWebCurrentUser","WAWebDBMessageUtils","WAWebHistorySyncDynamicThrottlingManager","WAWebHistorySyncNotificationUtils","WAWebMessageAssociation.flow","WAWebMessageAssociationGatingUtils","WAWebProtobufsE2E.pb","WAWebSchemaMessage","WAWebSyncGatingUtils","WAWebThreadMsgUtils","WAWebUserPrefsAppStateSync","WAWebUserPrefsHistorySync","WAWebWidFactory","asyncToGeneratorRuntime","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g=100;function h(e,t){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var a=o("WAWebHistorySyncNotificationUtils").getLidMappingAsStringSet(n);o("WAWebCurrentUser").isEmployee()&&o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["first lid mappings for recent sync preprocess: ","..."])),o("WAWebHistorySyncNotificationUtils").getLidsForLogging(a)).verbose();var i=new Map,l=[],h=[],y=[],C=new Set,b=[],v=new Set,S=[],R=o("WAWebUserPrefsHistorySync").getHistoryInitialSyncBoundary(),L=0,E=0,k=o("WAWebSyncGatingUtils").getRecentSyncMessageProcessingBreakIteration(),I=yield o("WAWebUserPrefsAppStateSync").getAllCriticalDataSynced(),T=self.performance.now(),D=0;(R==null||Object.keys(R).length===0)&&o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync] boundary data is null or empty"])));for(var x=0;x<t.conversations.length;x++){var $=!1,P=t.conversations[x],N=R==null?void 0:R[P.id];if(N==null){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] Dropping chat ","$ due to null entry in initial sync boundary"])),r("gkx")("26258")?"-":P.id).tags("history-sync");var M=o("WAWebWidFactory").createWid(P.id).toJid();(R==null?void 0:R[M])!=null&&o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] dropping chat "," due to null entry in initial sync boundary, but it exists as chatJid ",""])),r("gkx")("26258")?"-":P.id,r("gkx")("26258")?"-":M).sendLogs("history-sync-unexpected-conversation-drop"),$=!0}var w=o("WAWebWidFactory").createWid(P.id);w.isNewsletter()&&(o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] Dropping chat ","$ due to chat is not enabled for sync"])),r("gkx")("26258")?"-":P.id),$=!0);var A=yield o("WAWebApiChat").getChatRecord(w),F=(A==null?void 0:A.endOfHistoryTransferType)===o("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.COMPLETE_AND_NO_MORE_MESSAGE_REMAIN_ON_PRIMARY;if((!A&&N!=null||A&&A.endOfHistoryTransferType==null||F)&&($=!0),!$)for(var O=0;O<P.messages.length;O++){var B,W,q,U;L++;var V=P.messages[O],H=o("WALongInt").maybeNumberOrThrowIfTooLarge(V.msgOrderId);if(!(N!=null&&N!==-1&&H!=null&&H>=N)){var G=(V==null||(B=V.message)==null||(B=B.message)==null||(B=B.protocolMessage)==null?void 0:B.type)===o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REQUEST_WELCOME_MESSAGE;if(G===!0){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] Dropping request welcome message"])));continue}var z=(V==null||(W=V.message)==null||(W=W.message)==null||(W=W.protocolMessage)==null?void 0:W.type)===o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.BOT_MEMU_ONBOARDING_MESSAGE;if(z){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Dropping memu onboarding message"])));continue}v.add(P.id);var j=o("WAWebHistorySyncNotificationUtils").parseWebMsgInfoAndReturnNullOnFailure(w,V.message,void 0,a,i);if(j&&j.id.remote.toString()!==P.id&&v.add(j.id.remote.toString()),O===0&&j&&A){var K=yield o("WAWebSchemaMessage").getMessageTable().betweenCount(["internalId"],o("WAWebDBMessageUtils").beginningOfChat(w),o("WAWebDBMessageUtils").endOfChat(w));K===0&&S.push(j)}if(b=b.concat(o("WAWebAddonProcessMsgsUtils").parseHistorySyncMsg({webMsgInfo:V.message,parsedWebMsgInfo:j,isFromCag:(q=P.isDefaultSubgroup)!=null?q:!1})),j!=null&&((U=V.message)==null||(U=U.commentMetadata)==null?void 0:U.commentParentKey)==null&&(C.has(j.id.toString())&&o("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&C.delete(j==null?void 0:j.id.toString()),l.push(j)),j!=null&&o("WAWebMessageAssociation.flow").isAssociatedMsg(j)&&o("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var Q=j.parentMsgKey.toString();C.add(Q),h.push(j)}if(j!=null&&o("WAWebThreadMsgUtils").isThreadMsg(j)&&y.push(j),o("WAWebABProps").getABPropConfigValue("wa_web_history_sync_dynamic_throttling")){D++;var X=o("WAWebHistorySyncDynamicThrottlingManager").historySyncDynamicThrottlingManager.getThrottleRate();if(D>=X.batchSize){var Y=self.performance.now()-T;o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Observed process time ","ms, target process time ","ms, batch size ",""])),Y.toFixed(),o("WAWebHistorySyncDynamicThrottlingManager").historySyncDynamicThrottlingManager.targetTimeMs.toFixed(),D).tags("history-sync"),o("WAWebHistorySyncDynamicThrottlingManager").historySyncDynamicThrottlingManager.setLastProcessTime(Y,D),X.delayMs>0&&(o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Applying message throttling delay: ","ms"])),X.delayMs.toFixed()).tags("history-sync"),yield o("WAAsyncSleep").asyncSleep(X.delayMs)),D=0,T=self.performance.now()}}else yield o("WAAsyncSleep").asyncSleepAfterGivenLoopIteration(E++,I?k:g)}}}return o("WAWebHistorySyncNotificationUtils").reportMissingMapping(i),{recentOrFullSyncMsgs:l,chatsWithRecentOrFullSyncMsgs:Array.from(v),unifiedAddons:b,lastMsgs:S,totalChunkMsgCount:L,associatedMsgs:h,missingParentsCache:C,threadMsgs:y}}),y.apply(this,arguments)}l.preprocessHistorySyncProto=h}),98);
__d("WAWebGetMetricHistorySyncPayloadType",["WAWebWamEnumMdBootstrapHistoryPayloadType"],(function(t,n,r,o,a,i,l){function e(e){switch(e){case 0:return o("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.INITIAL;case 1:return o("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.STATUS_V3;case 2:return o("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.FULL_HISTORY;case 3:return o("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.RECENT_HISTORY;case 4:return o("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.PUSHNAME;case 5:return o("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.NON_BLOCKING_DATA;case 6:return o("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.ON_DEMAND;default:return o("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.PUSHNAME}}l.getMetricHistorySyncPayloadType=e}),98);
__d("WAWebHistorySyncNotificationUtils",["$InternalEnum","Promise","WALogger","WALongInt","WANullthrows","WATimeUtils","WAWebApiHistorySyncNotification","WAWebChatCollection","WAWebChatThreadLogging","WAWebCurrentUser","WAWebDBGroupParticipant","WAWebDBGroupsGroupMetadata","WAWebEphemeralityUtils","WAWebGetMetricHistorySyncPayloadType","WAWebGroupMetadataCollection","WAWebGroupParticipantModel","WAWebGroupParticipantsJob","WAWebLeaveReasonType","WAWebMdBootstrapDataAppliedWamEvent","WAWebMdBootstrapHistoryDataDownloadedWamEvent","WAWebMdBootstrapHistoryDataStartDownloadingWamEvent","WAWebParseWebMessageInfoApi","WAWebProtobufsHistorySync.pb","WAWebSchemaHistorySyncNotification","WAWebSignalProtocolStore","WAWebSyncdMdSyncFieldstatMeta","WAWebUserPrefsHistorySync","WAWebUserPrefsMeUser","WAWebUserPrefsNotifications","WAWebWamEnumMdBootstrapPayloadType","WAWebWamEnumMdBootstrapSource","WAWebWamEnumMdBootstrapStepResult","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T=n("$InternalEnum").Mirrored(["NewRecentSyncNotification","NewOnDemandSyncNotification","LastProcessedNotification","InitialSyncComplete","BackendStart","HistorySyncStatusCheck","ManualRestart"]);function D(e,t){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=e.pastParticipants.map(function(e){return{groupId:r("WANullthrows")(e.groupJid),pastParticipants:e.pastParticipants.map(function(e){return{id:o("WAWebWidFactory").createWid(r("WANullthrows")(e.userJid)),leaveReason:e.leaveReason===o("WAWebProtobufsHistorySync.pb").PastParticipant$LeaveReason.LEFT?o("WAWebLeaveReasonType").LeaveReason.Left:o("WAWebLeaveReasonType").LeaveReason.Removed,leaveTs:o("WALongInt").numberOrThrowIfTooLarge(r("WANullthrows")(e.leaveTs))}})}});yield o("WAWebDBGroupParticipant").addPastParticipants(n),n.forEach(function(e){var t=o("WAWebChatCollection").ChatCollection.gadd(o("WAWebWidFactory").createWid(e.groupId)),n=t.groupMetadata;n==null||n.pastParticipants.add(e.pastParticipants,{merge:!0})}),o("WALogger").LOG(E||(E=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Past Participants completed, ",""])),$(t))}),x.apply(this,arguments)}function $(e,t,n){var r,o,a;if(e==null)return"";var i=(e.msgKey||"").split("_")[2],l=P(e.syncType,e.chunkOrder,e.isReupload),s=(r=(o=e.downloadOptions.filehash)==null?void 0:o.slice(0,10))!=null?r:(a=e.filehash)==null?void 0:a.slice(0,10);return" "+l+", id: "+i+" ## msgCount: "+(t!=null?t:"-")+", ## chatCount: "+(n!=null?n:"-")+", ## downloadStr: "+(s!=null?s:"")+" "}function P(e,t,n){return"type_"+(e!=null?e:"none")+"_order_"+(t!=null?t:"none")+"_isReupload_"+(n||0)}function N(t,n,a,i,l){var u=null;try{n!=null&&(u=o("WAWebParseWebMessageInfoApi").parseWebMessageInfo(n))}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[history sync] parseWebMessageInfo failed with error "," "," and stack ",""])),t==null?void 0:t.name,t==null?void 0:t.code,t==null?void 0:t.stack),r("gkx")("26258")||o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync] parseWebMessageInfo failed on msg key ",", msg type: "," in chunk ",""])),n==null?void 0:n.key.id,n==null?void 0:n.messageStubType,$(a)).sendLogs("parseWebMessageInfo failed during history sync")}if(!M(t,u))return u}function M(e,t){var n;if(t==null)return!1;var r=e.isUser()&&!e.isLid();if(!r)return!1;var a=(n=t.id)==null?void 0:n.remote,i=a!=null&&a.isLid();if(i){if(o("WAWebCurrentUser").isEmployee()){var l;o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[history sync] msg invalid because chat id is PN and msgKey.remote is lid. chatId: ",", msg key: ",""])),e,(l=t.id)==null?void 0:l.toString())}o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[history sync] msg invalid because chat id is PN and msgKey.remote is lid"]))).sendLogs("history-sync-invalid-msg").devConsole(e,t.id.remote)}return i}function w(e,t){return A.apply(this,arguments)}function A(){return A=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WAWebSignalProtocolStore").getPersistSignalProtocolStore().loadIdentityKey(e);n!=null&&n!==t&&o("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[history sync] get changed self identity key from history sync,\n     existing length: ",", new length: ",""])),n.length,t.length).tags("history-sync").sendLogs("self-identity-change-from-history-sync")}),A.apply(this,arguments)}function F(e,t){var n;if(t.isGroup()){var a=(n=e.disappearingMode)==null?void 0:n.trigger,i;if(a!=null){var l=o("WAWebEphemeralityUtils").getDisappearingModeTriggerFromProtobuf(a);l!=null&&(i=l)}if(e.suspended!=null||e.terminated!=null||e.createdBy!=null||e.createdAt!=null||e.description!=null||e.support!=null||e.isParentGroup!=null||e.isDefaultSubgroup!=null||e.parentGroupId!=null||e.disappearingMode!=null){var s,u,c={id:t,subject:e.name,suspended:e.suspended,terminated:e.terminated,owner:e.createdBy!=null?o("WAWebWidFactory").createWid(e.createdBy):void 0,creation:e.createdAt,desc:e.description,support:e.support,isParentGroup:e.isParentGroup,defaultSubgroup:e.isDefaultSubgroup,parentGroup:e.parentGroupId!=null?o("WAWebWidFactory").createWid(e.parentGroupId):void 0,disappearingModeInitiatedByMe:(s=e.disappearingMode)==null?void 0:s.initiatedByMe,disappearingModeTrigger:i};o("WAWebDBGroupsGroupMetadata").persistGroupMetadata(t,babelHelpers.extends({},c,{id:c.id.toString(),owner:c.owner!==void 0?c.owner.toString():void 0,creation:c.creation!==void 0?Number(c.creation):void 0,parentGroup:c.parentGroup!==void 0?String(c.parentGroup):void 0}));var m=r("WAWebGroupMetadataCollection").add(babelHelpers.extends({},c),{merge:!0})[0],p=(u=e.participant)==null?void 0:u.map(function(e){var t=e.rank===o("WAWebProtobufsHistorySync.pb").GroupParticipant$Rank.SUPERADMIN,n=e.rank===o("WAWebProtobufsHistorySync.pb").GroupParticipant$Rank.ADMIN;return new(r("WAWebGroupParticipantModel"))({id:o("WAWebWidFactory").createWid(e.userJid),isAdmin:n||t,isSuperAdmin:t})});m==null||m.participants.add(p,{merge:!0}),(e.readOnly===!0||p.length>0)&&o("WAWebGroupParticipantsJob").updateParticipantsJob({group:t,participants:p.map(function(e){return{id:e.id,isAdmin:e.isAdmin,isSuperAdmin:e.isSuperAdmin}}),skipDeviceSync:e.readOnly}).catch(function(e){o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["updateParticipantsJob: failed: ",""])),e)})}}}function O(e){var t=(I||(I=n("Promise"))).resolve(),r=I.resolve();return e.threadIdUserSecret!=null?t=o("WAWebChatThreadLogging").setThreadIdUserSecret(e.threadIdUserSecret):o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleChatThreadLoggingMetadata: missing threadIdUserSecret"]))).sendLogs("ctl-missing-secret-history-sync"),e.threadDsTimeframeOffset!=null?r=o("WAWebChatThreadLogging").setThreadDsTimeframeOffset(e.threadDsTimeframeOffset):o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleChatThreadLoggingMetadata: missing threadDsTimeframeOffset"]))).sendLogs("ctl-missing-offset-history-sync"),I.all([t,r])}function B(e,t){return W.apply(this,arguments)}function W(){return W=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP?o("WAWebWamEnumMdBootstrapPayloadType").MD_BOOTSTRAP_PAYLOAD_TYPE.CRITICAL:o("WAWebWamEnumMdBootstrapPayloadType").MD_BOOTSTRAP_PAYLOAD_TYPE.NON_CRITICAL,r=o("WAWebGetMetricHistorySyncPayloadType").getMetricHistorySyncPayloadType(e.syncType),a=yield o("WAWebSyncdMdSyncFieldstatMeta").MdSyncFieldStatsMeta.getMdSessionId(),i=yield G(e),l=new(o("WAWebMdBootstrapHistoryDataStartDownloadingWamEvent")).MdBootstrapHistoryDataStartDownloadingWamEvent({mdBootstrapPayloadType:n,mdBootstrapPayloadSize:e.historySyncPayloadSize,mdBootstrapHistoryPayloadType:r,mdSessionId:a,historySyncStageProgress:i}),s=new(o("WAWebMdBootstrapHistoryDataDownloadedWamEvent")).MdBootstrapHistoryDataDownloadedWamEvent({mdBootstrapPayloadType:n,mdBootstrapPayloadSize:e.historySyncPayloadSize,mdBootstrapHistoryPayloadType:r,mdSessionId:a,historySyncStageProgress:i}),u=new(o("WAWebMdBootstrapDataAppliedWamEvent")).MdBootstrapDataAppliedWamEvent({mdBootstrapPayloadType:n,mdBootstrapSource:o("WAWebWamEnumMdBootstrapSource").MD_BOOTSTRAP_SOURCE.HISTORY,mdBootstrapHistoryPayloadType:r,mdSessionId:a,sentViaMms:t,historySyncStageProgress:i});e.chunkOrder!=null&&(l.historySyncChunkOrder=e.chunkOrder,s.historySyncChunkOrder=e.chunkOrder,u.historySyncChunkOrder=e.chunkOrder);var c=yield o("WAWebSyncdMdSyncFieldstatMeta").MdSyncFieldStatsMeta.getStorageEstimation();return c.mdStorageQuotaBytes!==o("WAWebSyncdMdSyncFieldstatMeta").STORAGE_QUOTA_UNAVAILABLE&&(s.mdStorageQuotaUsedBytes=c.mdStorageQuotaUsedBytes,s.mdStorageQuotaBytes=c.mdStorageQuotaBytes),{historySyncStartDownloadingMetric:l,historySyncDownloadedMetric:s,historySyncDataAppliedMetric:u}}),W.apply(this,arguments)}function q(e,t,n){e.mdTimestamp=n,e.mdBootstrapStepDuration=n-t,e.commit()}function U(e,t,n,r){e.mdTimestamp=r,e.mdBootstrapStepDuration=r-t,e.mdBootstrapStepResult=n?o("WAWebWamEnumMdBootstrapStepResult").MD_BOOTSTRAP_STEP_RESULT.SUCCESS:o("WAWebWamEnumMdBootstrapStepResult").MD_BOOTSTRAP_STEP_RESULT.FAILURE,e.commit()}function V(e){return H.apply(this,arguments)}function H(){return H=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.historySyncDataAppliedMetric,n=e.startTs,r=e.isSuccess,a=e.forceFlushWamBuffer,i=e.failureReason,l=o("WATimeUtils").unixTimeMs();return t.mdTimestamp=l,t.mdBootstrapStepDuration=l-n,t.mdBootstrapStepResult=r?o("WAWebWamEnumMdBootstrapStepResult").MD_BOOTSTRAP_STEP_RESULT.SUCCESS:o("WAWebWamEnumMdBootstrapStepResult").MD_BOOTSTRAP_STEP_RESULT.FAILURE,i!=null&&(t.mdSyncFailureReason=i),t.commitAndWaitForFlush(a)}),H.apply(this,arguments)}function G(e){return z.apply(this,arguments)}function z(){return z=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.progress,n=yield o("WAWebUserPrefsHistorySync").getChunkCountForEndOfRecentHistorySync();return(e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.FULL||e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT&&e.chunkOrder===n)&&(t=100),t!=null?t:0}),z.apply(this,arguments)}function j(e){return[o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP,o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_STATUS_V3,o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.PUSH_NAME].includes(e.syncType)&&e.initialHistBootstrapInlinePayload!=null&&(e==null?void 0:e.initialHistBootstrapInlinePayload.byteLength)>0?e.initialHistBootstrapInlinePayload:null}function K(){return Q.apply(this,arguments)}function Q(){return Q=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().equals(["processed","syncType"],[0,o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT],{shouldDecrypt:!1}).then(function(e){return e.filter(function(e){return!o("WAWebApiHistorySyncNotification").inFlightChunk.has(e.msgKey)&&!e.reuploadPending}).sort(function(e,t){var n,r;return((n=e.chunkOrder)!=null?n:0)-((r=t.chunkOrder)!=null?r:0)})})}),Q.apply(this,arguments)}function X(e){var t=null;if(o("WAWebCurrentUser").isEmployee())try{t=new Set(e.map(function(e){var t=e.lid;return t.toString()}))}catch(e){o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[history] could not create allLidMapping ",""])),e)}return t}function Y(e){if(e==null)return"N/A";var t=0,n=[];for(var r of e)if(n.push(r),t++===50)break;return n.join(",")}function J(e){o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[history] start to report missing mapping. is sw enabled: ",""])),o("WAWebUserPrefsNotifications").getGlobalOfflineNotifications().toString());try{var t=!1;e.forEach(function(e,n){e>0&&(t=!0,o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["total missing mapping for type ",": ",""])),n,e))}),t&&o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["missing Lid mapping in history Sync"]))).sendLogs("missing Lid mapping in history Sync")}catch(e){o("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[history] could not calculate missing mapping: ",""])),e)}o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[history] end to report missing mapping"])))}function Z(e,t,n,r){}l.HistorySyncScheduleSource=T,l.processPastParticipants=D,l.getHistorySyncLogDetailsString=$,l.getHistorySyncBasicChunkInfoString=P,l.parseWebMsgInfoAndReturnNullOnFailure=N,l.isInvalidMsg=M,l.checkSelfHistorySyncIdentity=w,l.saveGroupMetadataForLeftGroup=F,l.handleChatThreadLoggingMetadata=O,l.getHistorySyncMetrics=B,l.commitHistoryStartDownloadingMetric=q,l.commitHistoryDownloadedMetric=U,l.commitHistoryDataAppliedMetric=V,l.getHistorySyncProgress=G,l.maybeGetInlinePayload=j,l.getUnprocessedRecentSyncNotifications=K,l.getLidMappingAsStringSet=X,l.getLidsForLogging=Y,l.reportMissingMapping=J}),98);
__d("WAWebInactiveGroupLidMigration",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){"use strict";function e(){return r("WAWebUserPrefsStore").get(o("WAWebUserPrefsKeys").UserPrefs.InactiveGroupLidMigrationComplete)===!0}function s(){r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").UserPrefs.InactiveGroupLidMigrationComplete,!0)}l.isInactiveGroupLidMigrationComplete=e,l.setInactiveGroupLidMigrationComplete=s}),98);
__d("WAWebInactiveGroupLidMigrationJob",["WAJids","WALogger","WAWebABProps","WAWebGroupsParticipantsApi","WAWebInactiveGroupLidMigration","WAWebQueryAndUpdateGroupMetadataJob","WAWebSchemaGroupMetadata","WAWebSocketConstants","WAWebSocketModel","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g;function h(){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=o("WAWebABProps").getABPropConfigValue("enable_inactive_group_lid_migration");if(!t){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[lid-inactive-group-migration] ABProp not enabled, skipping migration"])));return}var n=o("WAWebInactiveGroupLidMigration").isInactiveGroupLidMigrationComplete();if(n){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[lid-inactive-group-migration] Migration already completed, skipping"])));return}if(o("WAWebSocketModel").Socket.stream!==o("WAWebSocketConstants").SOCKET_STREAM.CONNECTED){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[lid-inactive-group-migration] WebSocket not connected, skipping migration"])));return}o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[lid-inactive-group-migration] Starting inactive group migration to LID"])));try{var r=yield C();if(r.length===0)o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[lid-inactive-group-migration] No inactive (PN-addressed) groups found, marking migration as complete"]))),o("WAWebInactiveGroupLidMigration").setInactiveGroupLidMigrationComplete();else{o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[lid-inactive-group-migration] Found "," inactive (PN-addressed) groups"])),r.length),yield o("WAWebQueryAndUpdateGroupMetadataJob").queryAndUpdateAllGroupMetadata({batchQueryArgs:{groupJids:r.map(function(e){return o("WAJids").toGroupJid(e.id)}),queryContext:"inactive_group_migration"}}),o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[lid-inactive-group-migration] Successfully queried and updated groups"])));var a=yield C();a.length===0?(o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[lid-inactive-group-migration] No inactive (PN-addressed) groups remaining, marking migration as complete"]))),o("WAWebInactiveGroupLidMigration").setInactiveGroupLidMigrationComplete()):o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[lid-inactive-group-migration] Completed batch processing, "," inactive (PN-addressed) groups remaining, will re-run on next scheduled run"])),a.length).sendLogs("lid-inactive-group-migration-incomplete",{sampling:.1})}}catch(e){throw o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[lid-inactive-group-migration] Failed to complete migration: ",""])),e instanceof Error?e.message:String(e)).sendLogs("lid-inactive-group-migration-failed"),e}}),y.apply(this,arguments)}function C(){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebSchemaGroupMetadata").getGroupMetadataTable().all(),t=e.filter(function(e){return e.isLidAddressingMode!==!0}),n=yield o("WAWebGroupsParticipantsApi").bulkCheckMyMembership(t.map(function(e){return o("WAWebWidFactory").createWid(e.id)})),r=[];return t.forEach(function(e,t){var o=n[t];o&&!e.suspended&&!e.terminated&&r.push(e)}),r}),b.apply(this,arguments)}l.migrateInactiveGroupsToLid=h}),98);
__d("WAWebLogDailyStatsJob",["WAJobOrchestratorTypes","WAWebOrchestratorNonPersistedJob","WAWebTasksDailyStatsTask"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("logDailyStats",function(e){return o("WAWebTasksDailyStatsTask").logDailyStats()},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.BEST_EFFORT}).waitUntilCompleted()}l.logDailyStatsJob=e}),98);
__d("WAWebLogHistorySyncStatusAfterPairingJob",["Promise","WAJobOrchestratorTypes","WALogger","WATimeUtils","WAWebApiHistorySyncNotification","WAWebHistorySyncNotificationUtils","WAWebMdBootstrapHistorySyncStatusAfterPairingWamEvent","WAWebOrchestratorNonPersistedJob","WAWebSyncBootstrap","WAWebSyncdMdSyncFieldstatMeta","WAWebUserPrefsHistorySync","WAWebUserPrefsTypes","WAWebWamEnumActiveTimeAfterPairing","WAWebWamEnumMdBootstrapHistoryPayloadType","WAWebWamEnumMdHistorySyncStatusResult","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g;function h(t,r){var a=(o("WATimeUtils").unixTime()-t)/60;return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[history sync] log history sync status with time after pairing "," mins and logging count ",""])),a,r),a<5?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync] skip sync status logging as it's too soon after pairing"]))),(g||(g=n("Promise"))).resolve()):o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("logHistorySyncStatusAfterPairing",function(e){return y(e.timeAfterPairingMins,e.loggingCount)},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.LOW}).waitUntilCompleted({timeAfterPairingMins:a,loggingCount:r})}function y(e,t){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(t>=5){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[history sync] skip sync status logging as we've logged for more than 5 times"])));return}if(e>=60){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[history sync] log status for 60 minutes after pairing"]))),yield b(o("WAWebWamEnumActiveTimeAfterPairing").ACTIVE_TIME_AFTER_PAIRING.MINS_60),o("WAWebUserPrefsHistorySync").setHistorySyncStatusAfterPairingLoggingCount(5);return}if(t<4&&e>=40){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[history sync] log status for 40 minutes after pairing"]))),yield b(o("WAWebWamEnumActiveTimeAfterPairing").ACTIVE_TIME_AFTER_PAIRING.MINS_40),o("WAWebUserPrefsHistorySync").setHistorySyncStatusAfterPairingLoggingCount(4);return}if(t<3&&e>=20){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[history sync] log status for 20 minutes after pairing"]))),yield b(o("WAWebWamEnumActiveTimeAfterPairing").ACTIVE_TIME_AFTER_PAIRING.MINS_20),o("WAWebUserPrefsHistorySync").setHistorySyncStatusAfterPairingLoggingCount(3);return}if(t<2&&e>=10){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history sync] log status for 10 minutes after pairing"]))),yield b(o("WAWebWamEnumActiveTimeAfterPairing").ACTIVE_TIME_AFTER_PAIRING.MINS_10),o("WAWebUserPrefsHistorySync").setHistorySyncStatusAfterPairingLoggingCount(2);return}if(t<1&&e>=5){o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[history sync] log status for 5 minutes after pairing"]))),yield b(o("WAWebWamEnumActiveTimeAfterPairing").ACTIVE_TIME_AFTER_PAIRING.MINS_5),o("WAWebUserPrefsHistorySync").setHistorySyncStatusAfterPairingLoggingCount(1);return}o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[history sync] do not log status as no requirment meets"])))}),C.apply(this,arguments)}function b(e){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield S(e)}),v.apply(this,arguments)}function S(e){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n,a=yield o("WAWebSyncdMdSyncFieldstatMeta").MdSyncFieldStatsMeta.getMdSessionId(),i=new(o("WAWebMdBootstrapHistorySyncStatusAfterPairingWamEvent")).MdBootstrapHistorySyncStatusAfterPairingWamEvent({mdBootstrapHistoryPayloadType:o("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.RECENT_HISTORY,mdSessionId:a,mdTimestamp:o("WATimeUtils").unixTimeMs(),activeTimeAfterPairing:e,isLoopRunning:r("WAWebSyncBootstrap").getIsHistorySyncRunning()}),l=yield o("WAWebUserPrefsHistorySync").getLastHistoryRecentSyncedChunk(),s=l!=null?l.chunkOrder:-1,u=l!=null?l.progress:-1;i.lastProcessedNotificationChunkOrder=s,i.lastProcessedNotificationChunkProgress=u;var c=(t=yield o("WAWebUserPrefsHistorySync").getHistorySyncTotalProcessedMessageCount())!=null?t:0;i.totalProcessedMessageCount=c;var d=yield o("WAWebUserPrefsHistorySync").getHistorySyncStatus();if((d==null?void 0:d.recentCompleted)===!0){i.mdHistorySyncStatusResult=o("WAWebWamEnumMdHistorySyncStatusResult").MD_HISTORY_SYNC_STATUS_RESULT.SUCCESS,i.commit();return}var m=yield o("WAWebHistorySyncNotificationUtils").getUnprocessedRecentSyncNotifications(),p=m.length;i.unprocessedNotificationCount=p;var _=p>0?(n=m[0].chunkOrder)!=null?n:0:-1;if(i.nextNotificationChunkOrder=_,o("WAWebApiHistorySyncNotification").inFlightChunk.size>0){i.mdHistorySyncStatusResult=o("WAWebWamEnumMdHistorySyncStatusResult").MD_HISTORY_SYNC_STATUS_RESULT.IN_PROGRESS,i.commit();return}var f=l?s+1:1,g=yield o("WAWebUserPrefsHistorySync").getRecentSyncSingleChunkStatus(),h=L(g,f);i.mdHistorySyncStatusResult=h,i.commit()}),R.apply(this,arguments)}function L(e,t){if(e==null||e[t]==null)return o("WAWebWamEnumMdHistorySyncStatusResult").MD_HISTORY_SYNC_STATUS_RESULT.FAIL_TO_RECEIVE;switch(e[t]){case o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.RECEIVED:return o("WAWebWamEnumMdHistorySyncStatusResult").MD_HISTORY_SYNC_STATUS_RESULT.FAIL_TO_STORE_CHUNK;case o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.NOTIFICATION_STORED:return o("WAWebWamEnumMdHistorySyncStatusResult").MD_HISTORY_SYNC_STATUS_RESULT.FAIL_TO_FETCH;case o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DOWNLOADING:return o("WAWebWamEnumMdHistorySyncStatusResult").MD_HISTORY_SYNC_STATUS_RESULT.FAIL_TO_DOWNLOAD;case o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DOWNLOADED:return o("WAWebWamEnumMdHistorySyncStatusResult").MD_HISTORY_SYNC_STATUS_RESULT.PROTOBUF_ERROR;case o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DECODED:return o("WAWebWamEnumMdHistorySyncStatusResult").MD_HISTORY_SYNC_STATUS_RESULT.FAIL_TO_PREPROCESS;case o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.MESSAGE_PREPROCESSED:return o("WAWebWamEnumMdHistorySyncStatusResult").MD_HISTORY_SYNC_STATUS_RESULT.FAIL_TO_ENCRYPT;case o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.ENCRYPTED:return o("WAWebWamEnumMdHistorySyncStatusResult").MD_HISTORY_SYNC_STATUS_RESULT.FAIL_TO_STORE;default:return o("WAWebWamEnumMdHistorySyncStatusResult").MD_HISTORY_SYNC_STATUS_RESULT.OTHER_ERROR}}l.logHistorySyncStatusAfterPairingJob=h,l.logHistorySyncStatusAfterPairing=y,l.commitHistorySyncStatusData=b}),98);
__d("WAWebSendServerErrorReceiptJob",["Promise","WABase64","WADeprecatedSendIq","WALogger","WAWap","WAWebChatGetters","WAWebCommsAckParser","WAWebCommsWapMd","WAWebCryptoMediaRetry","WAWebFrontendMsgGetters","WAWebMsgGetters","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=t.id.id;if(o("WAWebMsgGetters").getIsNewsletterMsg(t))return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Called RMR on newsletter media, which has null mediaKey"]))).tags("newsletter").sendLogs("newsletter-called-rmr"),(u||(u=n("Promise"))).resolve();if(t.mediaKey==null)return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[media][rmr] Called RMR with null mediaKey"]))).tags("media","non-sad").sendLogs("rmr-called-with-null-media-key",{sampling:.01}),(u||(u=n("Promise"))).resolve();var a=o("WABase64").decodeB64(t.mediaKey),i=yield o("WAWebCryptoMediaRetry").encryptServerErrorReceipt(a,r),l=i.ciphertext,c=i.iv,d=o("WAWebFrontendMsgGetters").getChat(t),m=o("WAWap").CUSTOM_STRING(d.id.toString({legacy:!0})),p=o("WAWebChatGetters").getIsGroup(d)||o("WAWebChatGetters").getIsBroadcast(d)?o("WAWap").CUSTOM_STRING(o("WAWebMsgGetters").getSender(t).toString({legacy:!0})):o("WAWap").DROP_ATTR,_=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),f=o("WAWap").wap("receipt",{type:"server-error",to:o("WAWebCommsWapMd").USER_JID(_),id:o("WAWap").CUSTOM_STRING(r)},o("WAWap").wap("encrypt",null,o("WAWap").wap("enc_p",null,l),o("WAWap").wap("enc_iv",null,c)),o("WAWap").wap("rmr",{jid:m,from_me:o("WAWap").CUSTOM_STRING(String(o("WAWebMsgGetters").getIsSentByMe(t))),participant:p}));return o("WADeprecatedSendIq").deprecatedSendStanzaAndWaitForAck(f,o("WAWebCommsAckParser").toCoreAckTemplate({id:r,class:"receipt",type:"server-error",from:_,participant:null}))}),d.apply(this,arguments)}l.default=c}),98);
__d("WAWebResendUserMsg",["WALogger","WATimeUtils","WAWebDBDeviceListFanout","WAWebMsgFanoutTypes","WAWebMsgUtilsBridge","WAWebSendMsgCommonApi","WAWebSendMsgToDeviceList","WAWebSyncDeviceAdvDeviceListJob","WAWebUserPrefsMeUser","WAWebWamEnumMessageSendResultType","asyncToGeneratorRuntime","cr:10198","lodash"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m;function p(e,t,n,r,o){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a,i,l){var p=t.data.to,_=t.data.id.id;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: "," to ",""])),_,p.toString()).tags("messaging");var f=o("WAWebSendMsgCommonApi").getResendTimeoutInSeconds();if(o("WATimeUtils").unixTime()-i>f){var g;o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: ",": skip resending due to "," min timeout"])),_,f/60).tags("messaging"),(g=l.sendReporter)==null||g.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_EXPIRED,isTerminal:!1}),l.sendReporter=null;return}try{var h,y=p.isLid()&&(h=o("WAWebUserPrefsMeUser").getMaybeMeDeviceLid())!=null?h:o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow(),C=yield o("WAWebDBDeviceListFanout").getFanOutList({wids:[p,y]}),b=r("lodash").differenceBy(C,a,String);if(b.length===0){var v;o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: ",": skip resending to the empty list"])),_).tags("messaging"),(v=l.sendReporter)==null||v.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_BACKFILL_USYNC_FAILED,isTerminal:!1}),l.sendReporter=null;return}if(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: ",": resending to devices: ",""])),_,b.join(",")).tags("messaging"),t.data.isOverwrittenByRevoke===!0){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: ",": skip resending because this message has been overwritten by a revoke"])),_).tags("messaging");return}var S=yield o("WAWebSendMsgToDeviceList").sendMsgToDeviceList(t,n,b,{fanoutType:o("WAWebMsgFanoutTypes").FANOUT_TYPE.CHAT,isResendingMsg:!0},l),R=S.phash;R!=null&&(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: ",": got phash during the resend"])),_).tags("messaging"),o("WAWebSyncDeviceAdvDeviceListJob").syncDeviceListJob([p,y],"message",R))}catch(e){var L;throw(L=l.sendReporter)==null||L.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UNKNOWN,isTerminal:!1}),l.sendReporter=null,e}yield o("WAWebMsgUtilsBridge").logMessageSendForChatThreadLogging(t.data)}),_.apply(this,arguments)}l.resendUserMsg=p}),98);
__d("WAWebSendAppStateSyncMsgJob",["WADeprecatedSendIq","WALogger","WAWebCommsAckParser","WAWebE2EProtoGenerator","WAWebEventsWaitForOfflineDeliveryEnd","WAWebSendMsgCreateDeviceStanza","WAWebSendMsgTypes","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.msg,r=t.pushPriority,a=t.privacySensitive;yield o("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd(),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendKeyMsg: sending ",""])),n.id.toString()).tags("messaging");var i=n.to,l=o("WAWebE2EProtoGenerator").createPeerMsgProtobuf(n),s=yield o("WAWebSendMsgCreateDeviceStanza").createUserDeviceMsgStanza({type:o("WAWebSendMsgTypes").SendMessageRecordType.Message,data:n},l,{to:i,recipient:null,option:{type:o("WAWebSendMsgCreateDeviceStanza").MsgType.AppStateSync,pushPriority:r,privacySensitive:a}});return o("WADeprecatedSendIq").deprecatedSendStanzaAndWaitForAck(s,o("WAWebCommsAckParser").toCoreAckTemplate({id:n.id.id,class:"message",from:i,participant:null}))}),u.apply(this,arguments)}l.encryptAndSendKeyMsg=s}),98);
__d("WAWebGroupMsgSendUtils",["WALogger","WAWebAddonGatingUtils","WAWebGroupType","WAWebGroupUtils","WAWebMsgGetters","WAWebSchemaGroupMetadata","WAWebSchemaParticipant","WAWebWamGroupMetricUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t,n){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){var a=yield o("WAWebSchemaGroupMetadata").getGroupMetadataTable().get(t);a==null&&o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["_getGroupData: no group metadata record found for: ",""])),t);var i={groupId:t,amIAdmin:null,isCag:null,isLid:null,isLidAddressingMode:null,wamTypeOfGroup:null,participantCount:null,deviceCount:null,deviceSizeBucket:null,isCapiGroup:null},l=(a==null?void 0:a.isLidAddressingMode)===!0;if(a!=null){var s=o("WAWebGroupType").getGroupTypeFromGroupMetadata(a),u=s===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP;i.wamTypeOfGroup=o("WAWebGroupType").groupTypeToWamEnum(s),i.isLid=u&&(r==null?void 0:r.type)==="addon",i.isCag=u,i.isLidAddressingMode=l,i.isCapiGroup=a.hasCapi===!0}if(n!=null){var c=o("WAWebGroupUtils").amIGroupAdmin(n.admins);i.amIAdmin=c,Object.assign(i,o("WAWebWamGroupMetricUtils").getGroupMetricsFromDbRecord(n))}return i}),c.apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebSchemaParticipant").getParticipantTable().get(e);return t==null&&o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["_getParticipantRecord: no participants record found for: ",""])),e),t}),m.apply(this,arguments)}function p(e,t){return t.isCag===!0?o("WAWebMsgGetters").getIsReaction(e)||o("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(e.type):!1}function _(e){var t=e.filter(function(e){return e.isLid()}),n=e.length-t.length;return t.length+" lid participants & "+n+" pn participants"}function f(e){var t=e.isLidAddressingMode===!0?"lid":"pn",n=e.isCag===!0?"cag":"nonCag";return"group type: "+t+", "+n}l.getGroupData=u,l.getParticipantRecord=d,l.isCagAddon=p,l.formatWidTypeCountsForLog=_,l.formatGroupTypeForLog=f}),98);
__d("WAWebEncryptMsgProtobuf",["Promise","WALogger","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebE2eMessageSendWamEvent","WAWebGroupMsgSendUtils","WAWebMsgGetters","WAWebPostE2eMessageSendMetric","WAWebSendMsgCommonApi","WAWebSignal","WAWebSignalSessionApi","WAWebUserPrefsMeUser","WAWebWamAddressingModeUtils","WAWebWamEnumE2eDestination","WAWebWamEnumEditType","WAWebWamMsgUtils","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e,t,n,r,o){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i,l,s){s===void 0&&(s=o("WAWebWamEnumEditType").EDIT_TYPE.NOT_EDITED);try{var c=yield o("WAWebSignal").Cipher.encryptSignalProto(t,o("WAWebSendMsgCommonApi").encodeAndPad(i)),d=c.type,m=c.ciphertext;return o("WAWebPostE2eMessageSendMetric").postSuccessDirectE2eMessageSendMetric({to:t,retryCount:a,type:d,msg:l,editType:s}),{type:d,ciphertext:m}}catch(i){return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["encryptMsgProtobuf: encryption fail for ",", ",""])),t.toString(),i).tags("messaging"),o("WAWebSignalSessionApi").maybeDeleteUnconvertedSession(t),o("WAWebPostE2eMessageSendMetric").postFailureDirectE2eMessageSendMetric({to:t,retryCount:a,msg:l,editType:s}),(u||(u=n("Promise"))).reject(r("err")("[messaging] encryptMsgProtobuf: encryption fail for "+t.toString()+", "+i))}}),d.apply(this,arguments)}function m(e,t,n,r){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,i){var l,c,d=new(o("WAWebE2eMessageSendWamEvent")).E2eMessageSendWamEvent({e2eSuccessful:!0,e2eCiphertextType:o("WAWebBackendJobsCommon").getMetricE2eCiphertextType(o("WAWebBackendJobs.flow").CiphertextType.Skmsg),e2eCiphertextVersion:o("WAWebBackendJobsCommon").CIPHERTEXT_VERSION,e2eDestination:o("WAWebWamEnumE2eDestination").E2E_DESTINATION.GROUP,messageMediaType:o("WAWebWamMsgUtils").getWamMediaType(e),retryCount:0,isLid:!!i.isLid||((l=e.author)==null?void 0:l.isLid()),typeOfGroup:(c=i.wamTypeOfGroup)!=null?c:void 0,editType:o("WAWebMsgGetters").getWamEditType(e),localAddressingMode:o("WAWebWamAddressingModeUtils").getAddressingModeMetricsFromGroupMetadata(i)}),m=o("WAWebWamMsgUtils").getWamAgentEngagementType(e);m!=null&&(d.agentEngagementType=m);var p=o("WAWebUserPrefsMeUser").getMeDeviceLidOrThrow(),_=o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow(),f=o("WAWebGroupMsgSendUtils").isCagAddon(e,i)||i.isLidAddressingMode===!0?p:_;try{return babelHelpers.extends({},yield o("WAWebSignal").Cipher.encryptSenderKeyMsgSignalProto(t,f,a))}catch(e){return d.e2eSuccessful=!1,d.weight=1,o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["encryptMsgSenderKey: encryption fail for ",", ",""])),t.toString(),e).tags("messaging"),(u||(u=n("Promise"))).reject(r("err")("[messaging] encryptMsgSenderKey: encryption fail for "+t.toString()+", "+e))}finally{d.commit()}}),p.apply(this,arguments)}l.encryptMsgProtobuf=c,l.encryptMsgSenderKey=m}),98);
__d("WAWebSendMsgMetaNode",["WAWap","WAWebABProps","WAWebCommonMsgSubtypeTypes","WAWebCommsWapMd","WAWebE2EProtoUtils","WAWebHandleMsgCommon","WAWebMsgType","WAWebPollsGatingUtils","WAWebProtobufsE2E.pb","WAWebUsernameTypes","WAWebVerifyProtobufMsgObjectKeys"],(function(t,n,r,o,a,i,l){function e(e,t){var n=t==null?void 0:t.origin;return e.isLid()&&n!=null&&n===o("WAWebUsernameTypes").LidOriginType.PNH_CTWA?n:null}function s(t,n,r,a,i){var l,s=(l=o("WAWebVerifyProtobufMsgObjectKeys").getUnwrappedProtobufMessage(r))!=null?l:r,m=u(s),p=c(s),_;n.type==="addon"&&(_=o("WAWebE2EProtoUtils").extractCommentTargetIdAndSenderLid(n.data));var f=e(t,i),g=d(n,i),h=!1;if(o("WAWebABProps").getABPropConfigValue("view_once_meta_tag_sending_enabled")){var y;h=((y=n.data.mediaData)==null?void 0:y.isViewOnce)===!0}var C=m!=null||p!=null||_!=null||f!=null||(i==null?void 0:i.appendHostedSenderIntent)===!0||g!=null||h;if(C){var b,v;return o("WAWap").wap("meta",{origin:f!=null?o("WAWap").CUSTOM_STRING(f):o("WAWap").DROP_ATTR,sender_intent:(i==null?void 0:i.appendHostedSenderIntent)===!0?"hosted":o("WAWap").DROP_ATTR,polltype:m!=null?m:o("WAWap").DROP_ATTR,event_type:p!=null?p:o("WAWap").DROP_ATTR,thread_msg_id:((b=_)==null?void 0:b.threadMsgId)!=null?o("WAWap").CUSTOM_STRING(_.threadMsgId):o("WAWap").DROP_ATTR,thread_msg_sender_jid:(v=_)!=null&&v.threadMsgSenderLid?o("WAWebCommsWapMd").USER_JID(_.threadMsgSenderLid):o("WAWap").DROP_ATTR,appdata:g!=null?o("WAWap").CUSTOM_STRING(g):o("WAWap").DROP_ATTR,view_once:h?"true":o("WAWap").DROP_ATTR})}}function u(e){var t;return e.pollCreationMessage!=null||e.pollCreationMessageV2!=null||e.pollCreationMessageV3!=null?o("WAWebHandleMsgCommon").POLL_TYPES.creation:((t=e.pollUpdateMessage)==null?void 0:t.vote)!=null?o("WAWebHandleMsgCommon").POLL_TYPES.vote:e.pollResultSnapshotMessage!=null&&o("WAWebPollsGatingUtils").isPollResultSnapshotPollTypeEnvelopeEnabled()?o("WAWebHandleMsgCommon").POLL_TYPES.result_snapshot:null}function c(e){var t;return e.eventMessage!=null?o("WAWebHandleMsgCommon").EVENT_TYPES.creation:e.encEventResponseMessage!=null?o("WAWebHandleMsgCommon").EVENT_TYPES.response:((t=e.secretEncryptedMessage)==null?void 0:t.secretEncType)===o("WAWebProtobufsE2E.pb").Message$SecretEncryptedMessage$SecretEncType.EVENT_EDIT?o("WAWebHandleMsgCommon").EVENT_TYPES.edit:null}function d(e,t){var n=e.data.type===o("WAWebMsgType").MSG_TYPE.PROTOCOL&&e.data.subtype===o("WAWebCommonMsgSubtypeTypes").MsgSubtype.EphemeralSyncResponse,r=(t==null?void 0:t.isCategoryPeerMessage)===!0;return n||r?"default":null}l.getOriginAttribute=e,l.genMetaNode=s}),98);
__d("WAWebSendMsgCreateDeviceStanza",["invariant","$InternalEnum","Promise","WAWap","WAWebAdvSignatureApi","WAWebApiContact","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebBizCoexGatingUtils","WAWebCommsWapMd","WAWebDeviceSentMessageProtoUtils","WAWebE2EProtoGenerator","WAWebE2EProtoUtils","WAWebEncryptMsgProtobuf","WAWebGroupMsgSendUtils","WAWebHandleMsgCommon","WAWebICDCMetaApi","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebManageE2ESessionsJob","WAWebMsgType","WAWebReportingTokenUtils","WAWebSendMsgCommonApi","WAWebSendMsgMetaNode","WAWebSignalProtocolStore","WAWebUserPrefsMeUser","WAWebUsernameGatingUtils","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l,s){var e,u=n("$InternalEnum").Mirrored(["Retry","AppStateSync"]),c=n("$InternalEnum")({OnDemand:1});function d(e,t,n,r){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=n.to,i=n.recipient,l=n.option,c=t;return yield o("WAWebManageE2ESessionsJob").ensureE2ESessions([a]),o("WAWebUserPrefsMeUser").isMeAccount(a)&&l.type!==u.AppStateSync?(i!=null||s(0,56363),c=o("WAWebDeviceSentMessageProtoUtils").wrapDeviceSentMessage(t,i),yield o("WAWebICDCMetaApi").populateICDCMeta(o("WAWebWidFactory").asUserWidOrThrow(i),c)):yield o("WAWebICDCMetaApi").populateICDCMeta(o("WAWebWidFactory").asUserWidOrThrow(a),c),f(e,c,babelHelpers.extends({type:"user"},n),r)}),m.apply(this,arguments)}function p(e,t,n){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i){var l=i.to,s=i.participant,c=i.option;if(yield o("WAWebManageE2ESessionsJob").ensureE2ESessions([s]),c.type===u.AppStateSync)return(e||(e=n("Promise"))).reject(r("err")("[messaging] createGroupDeviceMsgStanza: not expect for App State Sync message"));var d=t.data.id.remote;if(!d.isGroup())return(e||(e=n("Promise"))).reject(r("err")("[messaging] createGroupDeviceMsgStanza: function called for non group WID"));var m=yield o("WAWebGroupMsgSendUtils").getParticipantRecord(d.toString()),p=yield o("WAWebGroupMsgSendUtils").getGroupData(d.toString(),m,t),_=o("WAWebUserPrefsMeUser").isMeAccount(s)?o("WAWebDeviceSentMessageProtoUtils").wrapDeviceSentMessage(a,l):a;return yield o("WAWebICDCMetaApi").populateICDCMeta(o("WAWebWidFactory").asUserWidOrThrow(s),_),f(t,_,babelHelpers.extends({type:"group",groupData:p},i))}),_.apply(this,arguments)}function f(e,t,n,r){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a,i,l=e.data,c=n.to,d=n.option,m=n.botMessageSecret,p=n.isLidBot,_,f;n.type==="user"?_=n.recipient:f=n.participant;var g=f||c,h=(a=d.retryCount)!=null?a:0,y=o("WAWebBackendJobsCommon").mediaTypeFromProtobuf(t),C=l.id,b=o("WAWebBackendJobsCommon").getMetricEditTypeFromMsg(t,l),v=!1;if(o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&h>0){var S;((S=e.data)==null?void 0:S.senderOrRecipientAccountTypeHosted)===!0&&(v=!0)}var R=c.isBot()&&_!=null&&!_.isBot(),L=!!((i=f)!=null&&i.isBot()||R),E=yield o("WAWebEncryptMsgProtobuf").encryptMsgProtobuf(g,h,L&&m?o("WAWebE2EProtoGenerator").updateBotInvokeMsgProtoCopyForCapi(t,m):t,l,b),k=E.type,I=E.ciphertext,T=null;if(k===o("WAWebBackendJobs.flow").CiphertextType.Pkmsg){var D=yield o("WAWebAdvSignatureApi").getADVEncodedIdentity();T=o("WAWap").wap("device-identity",null,D)}d.type!==u.Retry&&(yield o("WAWebSendMsgCommonApi").updateIdentityRange(e,[g])),yield o("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode();var x;d.pushPriority!=null?x=o("WAWap").CUSTOM_STRING(d.pushPriority):x=d.type===u.AppStateSync?"high":o("WAWap").DROP_ATTR;var $=null;n.type==="group"&&($=n.groupData.isLidAddressingMode===!0?o("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.lid:o("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.pn);var P=o("WAWebSendMsgMetaNode").genMetaNode(c,e,t,n.type==="group"?n.groupData:void 0,{appendHostedSenderIntent:v,isCategoryPeerMessage:d.type===u.AppStateSync,origin:r}),N=_&&R?_:c,M=o("WAWap").wap("enc",{v:o("WAWap").CUSTOM_STRING(o("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:o("WAWap").CUSTOM_STRING(k),count:h===0?o("WAWap").DROP_ATTR:o("WAWap").INT(h),mediatype:o("WAWebBackendJobsCommon").encodeMaybeMediaType(y),"decrypt-fail":o("WAWebBackendJobsCommon").encodeMaybeDecryptFail(o("WAWebE2EProtoUtils").decryptFailAttributeFromProtobuf(t))},I);if(L){var w=c.isBot()?c:f;w!=null&&w.isBot()||s(0,75934),M=o("WAWap").wap("bot",{is_lid:p===!0?"true":o("WAWap").DROP_ATTR},o("WAWap").wap("to",{jid:o("WAWebCommsWapMd").DEVICE_JID(w)},M))}var A=!o("WAWebUserPrefsMeUser").isMeAccount(c)&&e.data.kind!==o("WAWebMsgType").MsgKind.PeerMessage?yield o("WAWebReportingTokenUtils").genReportingTokenBody(e.data,t):null,F=o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated(),O,B,W;if(F&&o("WAWebUserPrefsMeUser").isMeAccount(N)&&_!=null&&_.isRegularUser())if(_.isLid()){if(O=o("WAWebApiContact").getPhoneNumber(_),o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()){var q=yield o("WAWebApiContact").getContactRecord(_);(q==null?void 0:q.username)!=null&&(W=q.username)}}else{var U;B=(U=n.peerRecipientLid)!=null?U:o("WAWebLidMigrationUtils").toLid(_)}return o("WAWap").wap("message",{id:o("WAWap").CUSTOM_STRING(C.id),to:o("WAWebCommsWapMd").JID(N),participant:f&&!L?o("WAWebCommsWapMd").DEVICE_JID(f):o("WAWap").DROP_ATTR,recipient:_&&!L?o("WAWebCommsWapMd").USER_JID(_):o("WAWap").DROP_ATTR,type:o("WAWebE2EProtoUtils").typeAttributeFromProtobuf(t),peer_recipient_pn:O?o("WAWebCommsWapMd").USER_JID(O):o("WAWap").DROP_ATTR,peer_recipient_lid:B?o("WAWebCommsWapMd").USER_JID(B):o("WAWap").DROP_ATTR,peer_recipient_username:W!==void 0?o("WAWap").CUSTOM_STRING(W):o("WAWap").DROP_ATTR,edit:o("WAWebSendMsgCommonApi").editAttribute(t,l.subtype),category:d.type===u.AppStateSync?"peer":o("WAWap").DROP_ATTR,push_priority:x,privacy_sensitive:d.privacySensitive!=null?o("WAWap").CUSTOM_STRING(d.privacySensitive.valueOf().toString()):o("WAWap").DROP_ATTR,addressing_mode:$!=null?o("WAWap").CUSTOM_STRING($):o("WAWap").DROP_ATTR},M,T,P,A)}),g.apply(this,arguments)}l.MsgType=u,l.PrivacySensitiveType=c,l.createUserDeviceMsgStanza=d,l.createGroupDeviceMsgStanza=p}),98);
__d("WAWebWamEnumPrekeysFetchContext",[],(function(t,n,r,o,a,i){var e=Object.freeze({SEND_MESSAGE:1,GET_VNAME_CERTIFICATE:2,SEND_LIVE_LOCATION_RETRY:3,SEND_LIVE_LOCATION_KEY:4,SEND_PEER_MESSAGE:5,MULTI_DEVICE_CALL:6,CALL_PEER_E2E_FAIL:7,IDENTITY_CHANGE_NOTIFICATION:8,BACK_OFF:9,USER_INTENT_PREFETCH:10,RESEND_MESSAGE:11,RETRY_MESSAGE:12,USER_INTENT_STATUS_PREFETCH:13});i.PREKEYS_FETCH_CONTEXT=e}),66);
__d("WAWebPrekeysDepletionWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMessageType","WAWebWamEnumPrekeysFetchContext","WAWebWamEnumSizeBucket"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({PrekeysDepletion:[3014,{deviceSizeBucket:[3,o("WAWebWamEnumSizeBucket").SIZE_BUCKET],messageType:[2,o("WAWebWamEnumMessageType").MESSAGE_TYPE],prekeysFetchReason:[1,o("WAWebWamEnumPrekeysFetchContext").PREKEYS_FETCH_CONTEXT]},[1,20,20],"regular"]},{PrekeysDepletion:[]});l.PrekeysDepletionWamEvent=e}),98);
__d("WAWebPostPrekeysDepletionMetric",["WALogger","WAWebPrekeysDepletionWamEvent"],(function(t,n,r,o,a,i,l){var e;function s(t){var n=t.count,r=t.prekeysFetchReason,a=t.messageType,i=t.deviceSizeBucket;if(!(n==null||n===0)){var l={};r!=null&&(l.prekeysFetchReason=r),a!=null&&(l.messageType=a),i!=null&&(l.deviceSizeBucket=i),o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["maybePostPrekeysDepletionMetric: depletion prekey count: ",""])),n),self.setTimeout(function(){for(var e=0;e<n;e++)new(o("WAWebPrekeysDepletionWamEvent")).PrekeysDepletionWamEvent(l).commit()},0)}}l.maybePostPrekeysDepletionMetric=s}),98);
__d("WAWebExternalEntryPointPrefs",["WALogger","WATimeUtils","WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){var e,s;function u(e){var t=Date.now();return t-e.addedTime>o("WATimeUtils").WEEK_MILLISECONDS}function c(t){try{Object.keys(t).forEach(function(e){u(t[e])&&delete t[e]}),r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").KEYS.EXTERNAL_ENTRY_POINT,t)}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[external_ctx] failed to persist entry points"]))).devConsole(t)}}function d(){try{var e=r("WAWebUserPrefsStore").getUser(o("WAWebUserPrefsKeys").KEYS.EXTERNAL_ENTRY_POINT);return e==null?{}:e}catch(e){return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[external_ctx] failed to load entry points"]))).devConsole(e),{}}}function m(e,t,n,r){var o=d(),a=Date.now();o[e.toString()]={addedTime:a,deepLinkType:t,authSuccess:n,partnerName:r!=null?r:null},c(o)}function p(e){var t=d(),n=t[e.toString()];n!=null&&(delete t[e.toString()],c(t))}function _(e){var t=d(),n=t[e.toString()];return n==null||u(n)?null:n}l.saveExternalEntryPoint=m,l.deleteExternalEntryPoint=p,l.getExternalEntryPoint=_}),98);
__d("WAWebSendMsgCtwaAttributionNode",["WASmaxOutMessagePublishCtwaAttributionMixin","WAWebExternalCtxConfig","WAWebExternalEntryPointPrefs","WAWebMsgType"],(function(t,n,r,o,a,i,l){function e(e){for(var t=e.getAllCMCs(),n=0,r=0;r<t.length;r++)for(var a=t[r].getModelsArray(),i=0;i<a.length;i++){var l=a[i];if(!o("WAWebMsgType").SYSTEM_MESSAGE_TYPES.includes(l.type)&&l.isSendFailure!==!0&&(++n,n>1))return!0}return!1}function s(t,n){var r=o("WAWebExternalCtxConfig").getFirstMessageLoggingOption();switch(r){case"NEW_CHATS_OR_EXISTING_CHATS_WITH_PARTNER_LINKS":return n!=null||!e(t);case"ALL_CHATS":return!0;default:return!e(t)}}function u(e){if(e==null||!o("WAWebExternalCtxConfig").isCtxLoggingEnabled())return null;var t=o("WAWebExternalEntryPointPrefs").getExternalEntryPoint(e.id);if(t==null||!s(e,t.partnerName))return null;var n={lt:"WEB_"+t.deepLinkType};t.authSuccess||(n.s=0),t.partnerName!=null&&(n.p=t.partnerName);var r=new TextEncoder().encode(JSON.stringify(n));return o("WASmaxOutMessagePublishCtwaAttributionMixin").makeCtwaAttributionCtwaAttribution({ctwaAttributionElementValue:r})}l.getCtwaAttributionNode=u}),98);
__d("WAWebSendMsgCreateFanoutStanza",["Promise","WALogger","WAWap","WAWebABProps","WAWebAdvSignatureApi","WAWebApiContact","WAWebApiMessageInfoStore","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebBotGating","WAWebBotTypes","WAWebBotUtils","WAWebChatCollection","WAWebCommsAckParser","WAWebCommsWapMd","WAWebContactCollection","WAWebDeviceSentMessageProtoUtils","WAWebE2EProtoGenerator","WAWebE2EProtoUtils","WAWebEncryptMsgProtobuf","WAWebHandleMsgCommon","WAWebICDCMetaApi","WAWebLid1X1MigrationGating","WAWebManageE2ESessionsJob","WAWebMsgFanoutTypes","WAWebMsgGetters","WAWebMsgRcatUtils","WAWebPostPrekeysDepletionMetric","WAWebReportingTokenUtils","WAWebSendMsgCommonApi","WAWebSendMsgCtwaAttributionNode","WAWebSendMsgMetaNode","WAWebSignalProtocolStore","WAWebSimpleSignalPNToFBIDMigration","WAWebThreadMsgUtils","WAWebTrustedContactsUtils","WAWebUserPrefsMeUser","WAWebUsernameGatingUtils","WAWebUsernameTypes","WAWebWamEnumMessageType","WAWebWamEnumPrekeysFetchContext","WAWebWamNumberToSizeBucket","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p;function _(e,t,n,r,o,a,i){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i,l,u,c,d){var m,_,f=o("WAWebBackendJobsCommon").mediaTypeFromProtobuf(l),g=o("WAWebBackendJobsCommon").nativeFlowNameTypeFromProtobuf(l),h=o("WAWebBotGating").isBotEnabled()&&((m=t.invokedBotWid)==null?void 0:m.isBot())===!0,y=o("WAWebBotGating").isBotEnabled()&&o("WAWebMsgGetters").getIsBotFeedbackMessage(t),C=y&&!!(t.bizBotType&&((_=t.protocolMessageKey)!=null&&_.remote.equals(a))),b=y&&a.isBot()||C,v=y&&!a.isBot()&&!C,S=o("WAWebMsgGetters").getIsRevokeForMsgFromOrDeliveredToBot(t),R=o("WAWebSimpleSignalPNToFBIDMigration").getFbidBotPersonaType(a);if(u.fanoutType===o("WAWebMsgFanoutTypes").FANOUT_TYPE.CHAT&&i.length===1&&o("WAWebSendMsgCommonApi").isPrimaryDevice(i[0])&&!v&&!o("WAWebBotUtils").isMetaAiBot(a)){var L=i[0],E=o("WAWebUserPrefsMeUser").isMeAccount(L)?o("WAWebDeviceSentMessageProtoUtils").wrapDeviceSentMessage(l,a):l,k=E;L.isBot()&&b&&(k=o("WAWebE2EProtoGenerator").updateBotInvokeMsgProtoCopyForCapi(E));var I=yield o("WAWebEncryptMsgProtobuf").encryptMsgProtobuf(L,0,k,t,d),T=I.type,D=I.ciphertext,x=null;return(b||R!=null)&&(x=o("WAWap").wap("bot",{type:b?"feedback":o("WAWap").DROP_ATTR,persona_type:R?o("WAWap").CUSTOM_STRING(R):o("WAWap").DROP_ATTR})),{shouldHaveIdentity:T===o("WAWebBackendJobs.flow").CiphertextType.Pkmsg,body:o("WAWap").wap("enc",{v:o("WAWap").CUSTOM_STRING(o("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:o("WAWap").CUSTOM_STRING(T),mediatype:o("WAWebBackendJobsCommon").encodeMaybeMediaType(f),"decrypt-fail":o("WAWebBackendJobsCommon").encodeMaybeDecryptFail(o("WAWebE2EProtoUtils").decryptFailAttributeFromProtobuf(l)),native_flow_name:o("WAWebBackendJobsCommon").encodeMaybeNativeFlowName(g)},D),botBody:x}}var $=!1,P=i.map((function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){var r=o("WAWebUserPrefsMeUser").isMeAccount(n)?o("WAWebDeviceSentMessageProtoUtils").wrapDeviceSentMessage(l,a):l,i=u.fanoutType===o("WAWebMsgFanoutTypes").FANOUT_TYPE.GROUP_DIRECT?o("WAWebWidFactory").asUserWidOrThrow(n):o("WAWebWidFactory").asUserWidOrThrow(a);yield o("WAWebICDCMetaApi").populateICDCMeta(i,r);var m=c==null?void 0:c.get(o("WAWebWidToJid").widToUserJid(i)),p=m!=null?o("WAWap").wap("content_binding",null,m):null;try{var _=r,y=n.isBot()&&(h||v||S);y&&(_=o("WAWebE2EProtoGenerator").updateBotInvokeMsgProtoCopyForCapi(r,t.botMessageSecret)),n.isFbidBot()&&(_=o("WAWebE2EProtoGenerator").updateFbidBotProtobuf(_)),n.isBot()&&(_=o("WAWebE2EProtoGenerator").updateBotProtobuf(_));var C=yield o("WAWebEncryptMsgProtobuf").encryptMsgProtobuf(n,0,_,t,d),b=C.type,R=C.ciphertext;return b===o("WAWebBackendJobs.flow").CiphertextType.Pkmsg&&($=!0),{shouldFanoutToBot:y,node:o("WAWap").wap("to",{jid:o("WAWebCommsWapMd").DEVICE_JID(n)},o("WAWap").wap("enc",{v:o("WAWap").CUSTOM_STRING(o("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:o("WAWap").CUSTOM_STRING(b),mediatype:o("WAWebBackendJobsCommon").encodeMaybeMediaType(f),"decrypt-fail":o("WAWebBackendJobsCommon").encodeMaybeDecryptFail(o("WAWebE2EProtoUtils").decryptFailAttributeFromProtobuf(l)),native_flow_name:o("WAWebBackendJobsCommon").encodeMaybeNativeFlowName(g)},R),p)}}catch(t){return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendUserMsg: encryption fail for ",": ",""])),String(n),t),o("WAWebSendMsgCommonApi").isPrimaryDevice(n)&&o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendUserMsg: encryption fail for primary device: ",""])),t).tags("messaging").sendLogs("encryption-fail-for-primary-device"),null}});return function(e){return r.apply(this,arguments)}})()),N=yield(p||(p=n("Promise"))).all(P),M=[],w=[];return N.forEach(function(e){(e==null?void 0:e.node)!=null&&(e!=null&&e.shouldFanoutToBot?w.push(e.node):M.push(e.node))}),M.length>0||w.length>0?{body:M.length>0?o("WAWap").wap("participants",null,M):null,botBody:w.length>0||b?o("WAWap").wap("bot",{type:y?"feedback":o("WAWap").DROP_ATTR},w):null,shouldHaveIdentity:$}:p.reject(r("err")("[messaging] encryptAndSendUserMsg: encryption fail for all devices"))}),f.apply(this,arguments)}function g(e,t,n,r,o,a){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a,i,l){var s,p,f,g=e.data,h=g.to,b=g.id,v=g.from,S=g.subtype;try{var R,L;(R=i.sendPerfReporter)==null||R.startPrekeysFetchStage();var E=yield o("WAWebManageE2ESessionsJob").ensureE2ESessions(n),k=E==null?void 0:E.missedPrekeyCount;if(k!=null){var I;(I=i.sendPerfReporter)==null||I.setFetchedPrekeyCount(k)}(L=i.sendPerfReporter)==null||L.postPrekeysFetchStage(),o("WAWebPostPrekeysDepletionMetric").maybePostPrekeysDepletionMetric({count:E==null?void 0:E.depletedPrekeyCount,prekeysFetchReason:o("WAWebWamEnumPrekeysFetchContext").PREKEYS_FETCH_CONTEXT.SEND_MESSAGE,messageType:a.fanoutType===o("WAWebMsgFanoutTypes").FANOUT_TYPE.GROUP_DIRECT?o("WAWebWamEnumMessageType").MESSAGE_TYPE.GROUP:o("WAWebWamEnumMessageType").MESSAGE_TYPE.INDIVIDUAL,deviceSizeBucket:a.fanoutType===o("WAWebMsgFanoutTypes").FANOUT_TYPE.GROUP_DIRECT?r("WAWebWamNumberToSizeBucket")(n.length):null})}catch(e){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions with error"]))).tags("messaging").devConsole(e)}var T=o("WAWebMsgGetters").getIsBotFeedbackMessage(g)&&!!(g.bizBotType&&((s=g.protocolMessageKey)!=null&&s.remote.equals(h))),D=o("WAWebBotGating").isBotEnabled()&&o("WAWebMsgGetters").getIsBotFeedbackMessage(g)&&h.isBot()||T,x=o("WAWebThreadMsgUtils").getMsgAiThread(g),$=n;a.isResendingMsg&&($=yield o("WAWebSendMsgCommonApi").filterDeviceWithChangedIdentity(e,n));var P=$.map(function(e){return{msgKey:b,receiverId:e}});yield o("WAWebApiMessageInfoStore").createOrMergeReceiptRecords(P),(p=i.sendPerfReporter)==null||p.startClientEncryptStage();var N=yield o("WAWebMsgRcatUtils").genContentBindingForMsg(g,y(v,$)),M=o("WAWebMsgGetters").getWamEditType(g),w=yield _(g,h,$,t,a,N,M);(f=i.sendPerfReporter)==null||f.postClientEncryptStage();var A=null;if(a.fanoutType===o("WAWebMsgFanoutTypes").FANOUT_TYPE.GROUP_DIRECT){var F=o("WAWebBackendJobsCommon").mediaTypeFromProtobuf(t);A=o("WAWap").wap("enc",{v:o("WAWap").CUSTOM_STRING(o("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:o("WAWap").CUSTOM_STRING(o("WAWebBackendJobs.flow").CiphertextType.Skmsg),mediatype:o("WAWebBackendJobsCommon").encodeMaybeMediaType(F)})}var O=null;if(w.shouldHaveIdentity){var B=yield o("WAWebAdvSignatureApi").getADVEncodedIdentity();O=o("WAWap").wap("device-identity",null,B)}var W=o("WAWebE2EProtoUtils").getBizNativeFlowName(t),q=g.nativeFlowInteractiveMsg,U,V=o("WAWebContactCollection").ContactCollection.get(h),H=o("WAWebChatCollection").ChatCollection.get(h),G=V==null?void 0:V.privacyMode;if(G!=null){var z;U=(z=o("WAWap")).wap("biz",{host_storage:z.INT(G.hostStorage),actual_actors:z.INT(G.actualActors),privacy_mode_ts:z.INT(G.privacyModeTs),native_flow_name:z.MAYBE_CUSTOM_STRING(W)})}var j,K,Q,X,Y=o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated();if(o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["createFanoutMsgStanza: create fanout for ",""])),b.id),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["createFanoutMsgStanza: create fanout for a message. found chat: ",". found contact: ",".\n      is lid: ",". lid origin: ",". isLidMigrated: ","\n      contact has phone number: ",""])),H!=null,V!=null,h.isLid(),H==null?void 0:H.lidOriginType,Y,(V==null?void 0:V.phoneNumber)!=null).devConsole(b.id),h.isLid()?(((H==null?void 0:H.lidOriginType)==null||(H==null?void 0:H.lidOriginType)===o("WAWebUsernameTypes").LidOriginType.PNH_CTWA)&&(V==null?void 0:V.shareOwnPn)!==!0&&(V==null?void 0:V.phoneNumber)!=null&&(j=V==null?void 0:V.phoneNumber),o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&(V==null?void 0:V.username)!=null&&(X=V.username),Y&&(H==null?void 0:H.lidOriginType)!==o("WAWebUsernameTypes").LidOriginType.PNH_CTWA&&(Q=o("WAWebApiContact").getPhoneNumber(h))):h.isUser()&&H!=null&&H.accountLid&&(K=H==null?void 0:H.accountLid),U==null&&W!=null&&q===!0){var z;U=(z=o("WAWap")).wap("biz",null,z.wap("interactive",{v:"1",type:z.CUSTOM_STRING("native_flow")},z.wap("native_flow",{name:z.CUSTOM_STRING(W)})))}else U==null&&W!=null&&(U=o("WAWap").wap("biz",{native_flow_name:o("WAWap").CUSTOM_STRING(W)}));a.isResendingMsg||(yield o("WAWebSendMsgCommonApi").updateIdentityRange(e,$)),yield o("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode();var J=o("WAWebSendMsgMetaNode").genMetaNode(h,e,t,l,{origin:H==null?void 0:H.lidOriginType}),Z=N==null?void 0:N.get(o("WAWebWidToJid").widToUserJid(o("WAWebWidFactory").asUserWidOrThrow(v))),ee=Z!=null?o("WAWap").wap("sender_content_binding",null,Z):null,te;if(g.subtype==="bot_request_welcome")te="request_welcome";else if(g.botMsgBodyType!=null)switch(g.botMsgBodyType){case o("WAWebBotTypes").BotMsgBodyType.PROMPT:te="prompt";break;case o("WAWebBotTypes").BotMsgBodyType.COMMAND:te="command";break;case o("WAWebBotTypes").BotMsgBodyType.VOICE:o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[bot] outgoing voice message is not supported"])));break}var ne;if(g.bizBotType&&!T)switch(g.bizBotType){case o("WAWebBotTypes").BizBotType.BIZ_1P:ne="1p_partial";break;case o("WAWebBotTypes").BizBotType.BIZ_3P:ne="3p_full";break}var re;(te!=null||ne!=null||x!=null)&&(re=o("WAWap").wap("bot",{type:te!=null?o("WAWap").CUSTOM_STRING(te):o("WAWap").DROP_ATTR,local_automated_type:ne!=null?o("WAWap").CUSTOM_STRING(ne):o("WAWap").DROP_ATTR,client_thread_id:x!=null?o("WAWap").CUSTOM_STRING(x.key.id):o("WAWap").DROP_ATTR}));var oe=yield o("WAWebReportingTokenUtils").genReportingTokenBody(g,t),ae=yield C(H),ie;l!=null&&(ie=(l==null?void 0:l.isLidAddressingMode)===!0?o("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.lid:o("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.pn);var le=o("WAWebSendMsgCtwaAttributionNode").getCtwaAttributionNode(H),se=o("WAWap").wap("message",{id:o("WAWap").CUSTOM_STRING(b.id),to:o("WAWebCommsWapMd").CHAT_JID(h),type:o("WAWebE2EProtoUtils").typeAttributeFromProtobuf(t),peer_recipient_lid:K?o("WAWebCommsWapMd").USER_JID(K):o("WAWap").DROP_ATTR,peer_recipient_pn:Q?o("WAWebCommsWapMd").USER_JID(Q):o("WAWap").DROP_ATTR,peer_recipient_username:X!==void 0?o("WAWap").CUSTOM_STRING(X):o("WAWap").DROP_ATTR,edit:o("WAWebSendMsgCommonApi").editAttribute(t,S),device_fanout:a.isResendingMsg===!0||D?"false":o("WAWap").DROP_ATTR,recipient_pn:j?o("WAWebCommsWapMd").USER_JID(j):o("WAWap").DROP_ATTR,addressing_mode:ie!=null?o("WAWap").CUSTOM_STRING(ie):o("WAWap").DROP_ATTR},w.body,w.botBody,A,O,U,J,ee,re,oe,ae,le),ue=o("WAWebCommsAckParser").toCoreAckTemplate({id:b.id,class:"message",from:g.to,participant:null});return{stanza:se,ackTemplate:ue}}),h.apply(this,arguments)}function y(e,t){var n=new Map;n.set(e.user,o("WAWebWidFactory").asUserWidOrThrow(e));for(var r of t)n.has(r.user)||n.set(r.user,o("WAWebWidFactory").asUserWidOrThrow(r));return Array.from(n.values())}function C(e){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!o("WAWebABProps").getABPropConfigValue("privacy_token_sending_on_all_1_on_1_messages")||e==null)return null;var t=e.tcToken,n=e.tcTokenTimestamp;return t==null||n==null||o("WAWebTrustedContactsUtils").isTokenExpired(n,o("WAWebTrustedContactsUtils").TcTokenMode.Receiver)?null:o("WAWap").wap("tctoken",null,t)}),b.apply(this,arguments)}l.createFanoutMsgStanza=g}),98);
__d("WAWebSendMsgJob",["Promise","WALogger","WAWebABPropsSaga","WAWebE2EProtoGenerator","WAWebEventsWaitForOfflineDeliveryEnd","WAWebMessageSendPerfReporter","WAWebMessageSendReporter","WAWebOutgoingMessage","WAWebSendGroupKeyDistributionMsgJob","WAWebSendGroupMsgJob","WAWebSendTcTokenChatAction","WAWebSendUserMsgJob","WAWebSimpleSignalPNToFBIDMigration","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWid","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a){var i=t.data,l=i.id,u=i.to;if(o("WAWebSimpleSignalPNToFBIDMigration").maybeReplaceWidWithFbIdForBotSend(t),o("WAWebSimpleSignalPNToFBIDMigration").maybeReplaceWidWithFbIdForInvoke(t,"invokedBotWid"),o("WAWebSimpleSignalPNToFBIDMigration").maybeReplaceWidWithFbIdForInvoke(t,"botRespOrInvocationRevokeBotWid"),o("WAWebEventsWaitForOfflineDeliveryEnd").isOfflineDeliveryEnd()||(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[messaging] waiting for offline delivery end before sending "," message"])),l),yield o("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd()),!l||!l.id)return(s||(s=n("Promise"))).reject(r("err")("[messaging] sending message without an id"));if(!u)return(s||(s=n("Promise"))).reject(r("err")("[messaging] sending message without an remote id"));var c=o("WAWebOutgoingMessage").createOutgoingMessageProtobuf(o("WAWebOutgoingMessage").OutgoingMessageOriginType.Chat,t);if(u.isUser()){r("WAWebWid").isCAPISupportAccount(u)&&o("WAWebABPropsSaga").getIsSagaV1Enabled()&&o("WAWebABPropsSaga").getIsSagaV1ReengagementEnabled()&&(yield o("WAWebE2EProtoGenerator").addDebugInfoSupportPayload(c));var d=o("WAWebSendUserMsgJob").encryptAndSendUserMsg(t,c,a);return t.data.type!=="protocol"&&o("WAWebSendTcTokenChatAction").sendTcToken(u),d}else if(u.isGroup())return o("WAWebSendGroupMsgJob").encryptAndSendGroupMsg(t,c,a);return(s||(s=n("Promise"))).reject(r("err")("[messaging] unsupported remote jid type"))}),c.apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(yield o("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd(),e.id){if(!e.remote)return(s||(s=n("Promise"))).reject(r("err")("[messaging] sending message without an remote id"))}else return(s||(s=n("Promise"))).reject(r("err")("[messaging] sending message without an id"));if(e.remote.isGroup()){var t=o("WAWebMessageSendReporter").createMessageSendMetricReporter({messageIsInvisible:!0}),a=new(o("WAWebMessageSendPerfReporter")).MessageSendPerfReporter({chatWid:e.remote,mediaType:o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE,messageType:o("WAWebWamEnumMessageType").MESSAGE_TYPE.GROUP});return a.setMessageIsInvisible(!0),o("WAWebSendGroupKeyDistributionMsgJob").encryptAndSendGroupKeyDistributionMsg(e,t).then(function(){a.postWrittenWireStage(),t.post()})}return(s||(s=n("Promise"))).reject(r("err")("[messaging] unsupported remote jid type"))}),m.apply(this,arguments)}l.encryptAndSendMsg=u,l.encryptAndSendKeyDistributionMsg=d}),98);
__d("WAWebSendMsgToDeviceList",["WADeprecatedSendIq","WAWebCommsAckParser","WAWebSendMsgCommonApi","WAWebSendMsgCreateFanoutStanza","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){function e(e,t,n,r,o){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a,i){var l,s,u,c,d;(l=i.sendPerfReporter)==null||l.startReadyToSendStage();var m=e.data,p=m.id,_=m.to,f=yield o("WAWebSendMsgCreateFanoutStanza").createFanoutMsgStanza(e,t,n,a,i),g=f.stanza;(s=i.sendPerfReporter)==null||s.postReadyToSendStage(),(u=i.sendPerfReporter)==null||u.startWrittenWireStage();var h=yield o("WADeprecatedSendIq").deprecatedSendStanzaAndReturnAck(g,o("WAWebCommsAckParser").toCoreAckTemplate({id:p.id,class:"message",from:_,participant:null})),y=o("WAWebSendMsgCommonApi").sendMsgAckSyncParser.parse(h);if(y.error)throw r("err")("[messaging] sendMsgToDeviceList: Invalid ack from server");return(c=i.sendPerfReporter)==null||c.postWrittenWireStage(),i.sendPerfReporter=null,(d=i.sendReporter)==null||d.postSuccess(),i.sendReporter=null,y.success}),s.apply(this,arguments)}l.sendMsgToDeviceList=e}),98);
__d("WAWebFetchResendMissingKeyJob",["Promise","WALogger","WAParsableXmlNode","WAPromiseQueue","WASmaxPreKeysFetchMissingPreKeysRPC","WAWap","WAWebApiDeviceList","WAWebBackendErrors","WAWebDeviceListPk","WAWebEventsWaitForOfflineDeliveryEnd","WAWebProcessKeyBundle","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebUserPrefsMeUser","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b=new(o("WAPromiseQueue")).PromiseQueueMap;function v(e){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){yield o("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd();var n=Array.from(new Set(t.map(function(e){return o("WAWebWidFactory").asUserWidOrThrow(e).toString()}))).map(function(e){return o("WAWebWidFactory").createUserWidOrThrow(e)}),r=n.map(function(e){return e.toString()}).join();o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys ",""])),r);var a=b.waitIfPending(r);return a?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys deduped ",""])),r),a):b.enqueueHandlers(r,R(n))}),S.apply(this,arguments)}function R(e){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: start fetching key for "," wids"])),e.length);var t=yield E(e),r=yield I(t),a=new Map;t.forEach(function(e,t){var n=r[t],i=o("WAWebWidFactory").asUserWidOrThrow(e).toString(),l=a.get(i)||[];if(n!=null){var s;l.push({id:(s=e.device)!=null?s:0,regId:n})}a.set(i,l)});var i=[];a.forEach(function(e,t){var n=o("WAWebWidToJid").widToUserJid(o("WAWebWidFactory").createUserWidOrThrow(t)),r={userJid:n,hasUserReasonIdentity:!1,deviceArgs:e.map(function(e){return{deviceId:e.id,registrationElementValue:o("WAWap").BIG_ENDIAN_CONTENT(e.regId)}})};i.push(r)}),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: start sending fetching iq for "," wids"])),e.length);var l=yield o("WASmaxPreKeysFetchMissingPreKeysRPC").sendFetchMissingPreKeysRPC({userArgs:i});switch(l.name){case"FetchMissingPreKeysResponseSuccess":return o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: start processing keys for "," wids"])),e.length),T(l.value);case"FetchMissingPreKeysResponseServerError":{var s=l.value.errorServerErrors.value;return o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys failed: ",":",""])),s.code,s.text),(C||(C=n("Promise"))).reject(new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(s.code),s.text))}case"FetchMissingPreKeysResponseRequestError":{var _=l.value.errorRequestErrorsFetch.value;return o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys failed: ",":",""])),_.code,_.text),(C||(C=n("Promise"))).reject(new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(_.code),_.text))}}}),L.apply(this,arguments)}function E(e){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: find "," users"])),e.length);var t=yield o("WAWebApiDeviceList").getDeviceIds(e),n=new Map;return t.forEach(function(t,r){if(t){var a=t.devices;a.forEach(function(e){if(e.id!==0){var r=o("WAWebWidFactory").createDeviceWidFromDeviceListPk(t.id,e.id,e.isHosted);n.set(r.toString(),r)}})}var i=o("WAWebWidFactory").asUserWidOrThrow(e[r]);n.set(i.toString(),i)}),Array.from(n.values())}),k.apply(this,arguments)}function I(e){var t=e.map(function(e){return o("WAWebUserPrefsMeUser").isMeDevice(e)?o("WAWebSignalProtocolStore").getSignalProtocolStore().getLocalRegistrationId():o("WAWebSignalProtocolStore").getSignalProtocolStore().loadSession(String(o("WAWebSignalCommonUtils").createSignalAddress(e))).then(function(e){var t,n=e==null?void 0:e.sessions;if(n){for(var r in n)if(n[r].indexInfo.closed===-1)return n[r].registrationId}return e==null||(t=e.remote)==null?void 0:t.regId})});return(C||(C=n("Promise"))).all(t)}function T(e){return D.apply(this,arguments)}function D(){return D=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=[];if(e.listUser.forEach(function(e){var n=e.userFetchMissingPreKeysSuccessOrFetchMissingPreKeysErrorOrFetchMissingPreKeysErrorFallbackMixinGroup;switch(n.name){case"FetchMissingPreKeysUserSuccess":{var r=n.value,a=r.jid,i=r.device,l=o("WAWebWidFactory").createWid(a);i.forEach(function(e){var n,r,a=e.preKeyMixin;t.push({identity:e.elementValue,deviceIdentity:(n=(r=e.deviceIdentityMixin)==null?void 0:r.deviceIdentityElementValue)!=null?n:null,skey:{id:o("WAParsableXmlNode").convertBytesToUint(e.skeyIdKeyIDMixin.elementValue,3),pubkey:e.skeyValueKeyDataMixin.elementValue,signature:e.skeySignatureElementValue},key:a&&{id:o("WAParsableXmlNode").convertBytesToUint(a.keyIdKeyIDMixin.elementValue,3),pubkey:a.keyValueKeyDataMixin.elementValue},regId:o("WAParsableXmlNode").convertBytesToUint(e.registrationElementValue,4),wid:o("WAWebWidFactory").createDeviceWidFromDeviceListPk(o("WAWebDeviceListPk").createDeviceListPK(l),e.id,!1)})});return}case"FetchMissingPreKeysUserErrorFallback":case"FetchMissingPreKeysUserError":{var s=n.value;o("WALogger").WARN(f||(f=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys failed for user ",": ",":",""])),e.jid,s.errorCode,s.errorText).sendLogs("fetchResendMissingKeys-user-error");return}}}),o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: parsed "," keys"])),t.length),t.length>0)try{var n=yield o("WAWebProcessKeyBundle").processKeyBundles(t),r=n.processedPrekeyCount;o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: successfully established "," E2E sessions out of "," requested"])),r,t.length)}catch(e){o("WALogger").WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: failed to build session with error ",""])),e).sendLogs("fetchResendMissingKeys-session-error")}}),D.apply(this,arguments)}l.fetchResendMissingKeys=v}),98);
__d("WAWebPostMdDeviceSyncAckMetric",["WAWebGetMessageChatTypeFromWid","WAWebMdDeviceSyncAckWamEvent","WAWebSendMsgCommonApi","WAWebWamAddressingModeUtils"],(function(t,n,r,o,a,i,l){function e(e,t,n,r,a){var i=new(o("WAWebMdDeviceSyncAckWamEvent")).MdDeviceSyncAckWamEvent({revoke:o("WAWebSendMsgCommonApi").isRevokeMsg(n)});if(i.chatType=o("WAWebGetMessageChatTypeFromWid").getMessageChatTypeFromWid(e),e.isGroup()?i.isLid=t.data.from.isLid():i.isLid=e.isLid(),r!=null){var l=o("WAWebWamAddressingModeUtils").getAddressingModeMetricsFromGroupMetadata(r);l!=null&&(i.localAddressingMode=l)}e.isGroup()&&a!=null&&(i.serverAddressingMode=o("WAWebWamAddressingModeUtils").getWamAddressingModeFromString(a)),i.commit()}l.postMdDeviceSyncAckMetric=e}),98);
__d("WAWebSendUserMsgJob",["Promise","WALogger","WATimeUtils","WAWebBizCoexGatingUtils","WAWebBizCoexUtils","WAWebBotGating","WAWebDBDeviceListFanout","WAWebDBUpdateMessageTable","WAWebFetchResendMissingKeyJob","WAWebLidMigrationUtils","WAWebMsgFanoutTypes","WAWebMsgGetters","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebPostMdDeviceSyncAckMetric","WAWebResendUserMsg","WAWebSendMsgToDeviceList","WAWebSimpleSignalPNToFBIDMigration","WAWebSyncDeviceAdvDeviceListJob","WAWebUserPrefsMeUser","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","cr:10198"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m;function p(e,t,n){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r,a){var i,l=t.data,p=l.id,_=l.to,h=l.invokedBotWid,y=l.protocolMessageKey,C=l.subtype,b=l.botRespOrInvocationRevokeBotWid;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendUserMsg: sending ",""])),p).tags("messaging");var v=_.isLid()&&(i=o("WAWebUserPrefsMeUser").getMaybeMeDeviceLid())!=null?i:o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow(),S={wids:[_,v]};o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&_!=null&&_.isUser()&&(S.chatWidSetToIncludeHostedInFanoutOneToOneChatOnly=_);var R=yield o("WAWebDBDeviceListFanout").getFanOutList(S);if(o("WAWebBotGating").isBotEnabled())if(o("WAWebMsgGetters").getIsBotFeedbackMessage(t.data)&&y!=null){var L;!_.isBot()&&y.participant!=null?L=y.participant:t.data.bizBotType!=null?L=_:L=y.remote,R=[o("WAWebSimpleSignalPNToFBIDMigration").maybeReplaceDeprecatedBotPnWithFbid(L)]}else if(h&&h!=null&&h.isBot()){var E=h;R=[].concat(R,[E])}else b&&b!=null&&b.isBot()&&(C==="sender_revoke"||C==="admin_revoke")&&(R=[].concat(R,[b]));o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&o("WAWebBizCoexUtils").fanoutListContainsHostedDevice(R)&&o("WAWebDBUpdateMessageTable").updateMessageTable(t.data.id,{senderOrRecipientAccountTypeHosted:!0});var k=yield o("WAWebSendMsgToDeviceList").sendMsgToDeviceList(t,r,R,{fanoutType:o("WAWebMsgFanoutTypes").FANOUT_TYPE.CHAT},a);f(_,k);var I=k.phash;if(I!=null){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendUserMsg: phash mismatch, got server phash ",""])),I).tags("messaging");var T=o("WATimeUtils").unixTime();o("WAWebPostMdDeviceSyncAckMetric").postMdDeviceSyncAckMetric(_,t,r),a.sendReporter=a.createSendReporter({isResend:!0,originalMessage:t.type==="message"?t.data:void 0}),(m||(m=n("Promise"))).resolve().then(function(){if(!_.isLid())return o("WAWebFetchResendMissingKeyJob").fetchResendMissingKeys([_,v]).catch(function(){o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: failed"]))).sendLogs("fetchResendMissingKeys-sync-error")})}).then(function(){return o("WAWebSyncDeviceAdvDeviceListJob").syncDeviceListJob([_,v],"message",I)}).then(function(){return g(t,r,R,T,a)}).catch(function(e){o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: failed to resend message: ",", type: ",""])),t.data.id.toString(),t.data.type).tags("messaging"),o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: failed to resend message: ",""])),e).tags("messaging").sendLogs("message-resend-failed",{sampling:.01})})}return k}),_.apply(this,arguments)}function f(e,t){var n=t.refreshLid;if(n){var r=o("WAWebLidMigrationUtils").toPn(e);r&&o("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("syncContactListJob",{contactIds:[r],shouldSyncDevice:!1,mode:"query"})}}function g(e,t,n,r,o){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a){var i=yield o("WAWebPersistedJobManager").getJobManager().accessors.maybeCreateJob(o("WAWebPersistedJobDefinitions").jobSerializers.resendUserMsg(e,n,r));yield o("WAWebResendUserMsg").resendUserMsg(e,t,n,r,a),yield o("WAWebPersistedJobManager").getJobManager().accessors.deletePersistedJob(i.id)}),h.apply(this,arguments)}l.encryptAndSendUserMsg=p,l.maybeRefreshLid=f}),98);
__d("WAWebIdentityIcdcApi",["WACryptoSha256","WAJids","WANullthrows","WASignalOther","WATimeUtils","WAWebABProps","WAWebApiDeviceList","WAWebBizCoexGatingUtils","WAWebCryptoCurve25519","WAWebIdentityApiUtils","WAWebProtobufsAdv.pb","WAWebSignalProtocolStore","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=8,s=720*60*60;function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebApiDeviceList").getDeviceRecord(e);return!t||t.deleted?null:d(e,t)}),c.apply(this,arguments)}function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(!t||t.deleted)return null;var n={keyHash:void 0,timestamp:void 0},a=t.timestamp,i=t.devices,l=t.id,s=t.advAccountType,u=i.some(function(e){return e.id!==o("WAJids").DEFAULT_DEVICE_ID});if(u){var c=i.map(function(e){return[e.keyIndex,o("WAWebWidFactory").createDeviceWidFromDeviceListPk(l,e.id,e.isHosted)]}),d=[],m=null;c.forEach(function(e){var t=e[0],n=e[1];o("WAWebUserPrefsMeUser").isMeDevice(n)?m=t:d.push([t,n])});var _=yield o("WAWebIdentityApiUtils").getAllIdentityKeysBytes(d.map(function(e){var t=e[1];return t})),h=[],y=[];if(_.forEach(function(e,t){e!=null&&(h.push(e),y.push(d[t][0]))}),o("WAWebUserPrefsMeUser").isMeAccount(e)){var C=yield o("WAWebSignalProtocolStore").getSignalProtocolStore().getIdentityKeyPair();if(!C)return null;h.push(new Uint8Array(C.pubKey)),y.push(r("WANullthrows")(m))}var b=f();n.keyHash=yield p(h.map(function(e){return new Uint8Array(o("WAWebCryptoCurve25519").toCurveKeyPubKey(e.buffer))}),b),y.length!==i.length&&(n.keyIndexes=y)}return(u||g(a))&&(n.timestamp=a),o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(o("WAWebUserPrefsMeUser").isMeAccount(e)&&(yield o("WAWebUserPrefsMultiDevice").getIsHostedMeAccount())===!0&&(n.senderAccountType=o("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED),!o("WAWebUserPrefsMeUser").isMeAccount(e)&&s===o("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(n.receiverAccountType=o("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED)),n}),m.apply(this,arguments)}function p(e,t){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WAWebIdentityApiUtils").identityKeysToBinary(e),r=yield o("WACryptoSha256").sha256(n),a=new Uint8Array(r);return o("WASignalOther").sliceBytes(a,0,t)}),_.apply(this,arguments)}function f(){var t=o("WAWebABProps").getABPropConfigValue("md_icdc_hash_length");return Math.max(t,e)}function g(e){return o("WATimeUtils").unixTime()-e<s}l.getICDCMeta=u,l.getICDCMetaFromDeviceRecord=d,l.computeIdentityHash=p}),98);
__d("WAWebGetGroupKeyDistributionMsg",["Promise","WALogger","WAWebAdvMetadataCreationFailureWamEvent","WAWebApiDeviceList","WAWebDeviceSentMessageProtoUtils","WAWebE2EProtoGenerator","WAWebEncryptMsgProtobuf","WAWebIdentityIcdcApi","WAWebSendMsgCommonApi","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e,t,n,r,o){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i,l,c){var d={senderKeyDistributionMessage:{groupId:a.toString({legacy:!0}),axolotlSenderKeyDistributionMessage:l}};o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getKeyDistributionMsg: precalculate ICDC for ",""])),t==null?void 0:t.id.toString()).tags("messaging");var p=yield m(d,i,c,a),_=i.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){try{var t,a=(t=p.get(o("WAWebWidFactory").asUserWidOrThrow(e).toString()))!=null?t:babelHelpers.extends({},d),i=yield o("WAWebEncryptMsgProtobuf").encryptMsgProtobuf(e,0,a);return{type:i.type,ciphertext:i.ciphertext,participant:e}}catch(t){if(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["getKeyDistributionMsg: encryption fail for ",", ",""])),e.toString(),t).tags("messaging"),o("WAWebSendMsgCommonApi").isPrimaryDevice(e))return(u||(u=n("Promise"))).reject(r("err")("getKeyDistributionMsg: encryption fail for primary device"))}});return function(t){return e.apply(this,arguments)}})()),f=yield(u||(u=n("Promise"))).all(_);return f.filter(Boolean)}),d.apply(this,arguments)}function m(e,t,n,r){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,a){var i=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),l=[].concat(Array.from(new Set(t.map(o("WAWebWidFactory").asUserWidOrThrow)))),s=yield o("WAWebApiDeviceList").bulkGetDeviceRecord([i].concat(l)),c=s[0],d=babelHelpers.arrayLikeToArray(s).slice(1),m=null;try{m=yield o("WAWebIdentityIcdcApi").getICDCMetaFromDeviceRecord(i,c)}catch(e){throw new(o("WAWebAdvMetadataCreationFailureWamEvent")).AdvMetadataCreationFailureWamEvent({advMetadataIsMe:!0}).commit(),e}var p=new Map;return yield(u||(u=n("Promise"))).all(d.map((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var i=l[n],s=babelHelpers.extends({},e),u=null;if(o("WAWebUserPrefsMeUser").isMeAccount(i))r&&(s=o("WAWebDeviceSentMessageProtoUtils").wrapDeviceSentMessage(s,a));else try{u=yield o("WAWebIdentityIcdcApi").getICDCMetaFromDeviceRecord(i,t)}catch(e){throw new(o("WAWebAdvMetadataCreationFailureWamEvent")).AdvMetadataCreationFailureWamEvent({advMetadataIsMe:!1}).commit(),e}o("WAWebE2EProtoGenerator").populateMessageContextInfo(s,m,u),p.set(i.toString(),s)});return function(e,n){return t.apply(this,arguments)}})())),p}),p.apply(this,arguments)}l.getKeyDistributionMsg=c,l.generateMsgProtobufs=m}),98);
__d("WAWebWamNumberToClientGroupSizeBucket",["WAWebWamEnumClientGroupSizeBucket"],(function(t,n,r,o,a,i,l){function e(e){return e<=33?o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.SMALL:e<=65?o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.MEDIUM:e<=129?o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LARGE:e<=257?o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.EXTRA_LARGE:e<=513?o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.XX_LARGE:e<=1025?o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT1024:e<=1501?o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT1500:e<=2001?o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT2000:e<=2501?o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT2500:e<=3001?o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT3000:e<=3501?o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT3500:e<=4001?o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT4000:e<=4501?o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT4500:e<=5001?o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT5000:o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LARGEST_BUCKET}l.default=e}),98);
__d("WAWebMaybePostMdGroupSyncMetrics",["WALogger","WAWebMdGroupParticipantMissAckWamEvent","WAWebSendMsgCommonApi","WAWebWamEnumTypeOfGroupEnum","WAWebWamNumberToClientGroupSizeBucket"],(function(t,n,r,o,a,i,l){var e,s,u;function c(t,n,a,i){var l=d(t,n),c=l.added,m=l.removed;if(c!==0||m!==0){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["postGroupParticipantSyncMetric: added: ",", removed: ",""])),c,m);var p=new(o("WAWebMdGroupParticipantMissAckWamEvent")).MdGroupParticipantMissAckWamEvent;p.messageIsRevoke=o("WAWebSendMsgCommonApi").isRevokeMsg(a),p.groupSizeBucket=r("WAWebWamNumberToClientGroupSizeBucket")((i==null?void 0:i.participantCount)||0),p.typeOfGroup=(i==null?void 0:i.wamTypeOfGroup)||o("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM.GROUP,p.isLid=p.isLid=t.some(function(e){return e.isLid()}),p.participantAddCount=c,p.participantRemoveCount=m,p.commitAndWaitForFlush().catch(function(e){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["maybePostGroupSyncMetrics: event commit failed with ",""])),e)})}o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["postGroupParticipantSyncMetric: skip due to no participant change"])))}function d(e,t){var n=new Set(e.map(String)),r=new Set(t.map(String));return{added:t.filter(function(e){return!n.has(String(e))}).length,removed:e.filter(function(e){return!r.has(String(e))}).length}}l.maybePostGroupSyncMetrics=c,l.computeParticipantChange=d}),98);
__d("WAWebResendGroupMsg",["WALogger","WATimeUtils","WAWebCurrentUser","WAWebDBDeviceListFanout","WAWebFetchResendMissingKeyJob","WAWebGroupMsgSendUtils","WAWebGroupQueryBridge","WAWebMaybePostMdGroupSyncMetrics","WAWebMsgFanoutTypes","WAWebMsgUtilsBridge","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebPostMdDeviceSyncAckMetric","WAWebSendDirectMsgToDeviceList","WAWebSendMsgCommonApi","WAWebSyncDeviceAdvDeviceListJob","WAWebWamEnumMessageSendResultType","WAWebWidFactory","asyncToGeneratorRuntime","lodash"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v;function S(e){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.isDirect,a=t.msgRecord,i=t.msgProtobuf,l=t.oldList,b=t.ackTime,v=t.groupData,S=t.phash,R=t.metricReporter,k=t.serverAddressingMode,I=a.data.id.id,T=a.data.to;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: "," to ",""])),I,T.toString()).tags("messaging"),o("WAWebPostMdDeviceSyncAckMetric").postMdDeviceSyncAckMetric(T,a,i,v,k),R.sendReporter=R.createSendReporter({isResend:!0,originalMessage:a.type==="message"?a.data:void 0,groupData:v});var D=Array.from(new Set(l.map(function(e){return o("WAWebWidFactory").asUserWidOrThrow(e).toString()}))).map(function(e){return o("WAWebWidFactory").createUserWidOrThrow(e)});if(!o("WAWebGroupMsgSendUtils").isCagAddon(a.data,v))try{yield o("WAWebFetchResendMissingKeyJob").fetchResendMissingKeys(l)}catch(e){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: failed"]))).sendLogs("fetchResendMissingKeys-sync-error")}if(n)yield o("WAWebSyncDeviceAdvDeviceListJob").syncDeviceListJob(l,"message",S);else try{yield o("WAWebGroupQueryBridge").sendQueryGroup(T),E(v,T,i,D.map(o("WAWebWidFactory").createWidFromWidLike)).catch(function(e){o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["postGroupParticipantSyncMetric: ",": failed for postGroupParticipantSyncMetric ",""])),I,e).tags("messaging")})}catch(e){throw o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: ",": sendQueryGroup failed for message resend: ",""])),I,e).tags("messaging"),L(R),e}var x=o("WAWebSendMsgCommonApi").getResendTimeoutInSeconds();if(o("WATimeUtils").unixTime()-b>x){var $;o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: ",": skip group resending due to "," min timeout"])),I,x/60).tags("messaging"),($=R.sendReporter)==null||$.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_EXPIRED,isTerminal:!1}),R.sendReporter=null;return}try{var P=yield o("WAWebGroupMsgSendUtils").getParticipantRecord(T.toString()),N=P==null?void 0:P.participants;if(N!=null&&N.length!==D.length){var M=N.length-D.length;if(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: ",": group participant list has "," by "," since initial send"])),I,M>0?"increased":"decreased",Math.abs(M)),o("WAWebCurrentUser").isEmployee()){var w=N.map(function(e){return o("WAWebWidFactory").createUserWidOrThrow(e)}),A=new Set(D),F=w.filter(function(e){return!A.has(e)});o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: ",": message was not sent intentionally to following participants: ",""])),I,F.join()).sendLogs("resendGroupMsg-missed-participants",{sampling:.01})}}var O=yield o("WAWebDBDeviceListFanout").getFanOutList({wids:D}),B=r("lodash").differenceBy(O,l,String);if(B.length===0){o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: ",": skip resending to the empty list"])),I).tags("messaging");return}if(o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: ",": resending to devices: ",""])),I,B.join(",")).tags("messaging"),a.data.isOverwrittenByRevoke===!0){o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: ",": skip resending because this message has been overwritten by a revoke"])),I).tags("messaging");return}yield o("WAWebSendDirectMsgToDeviceList").sendDirectMsgToDeviceList(a,i,B,{fanoutType:o("WAWebMsgFanoutTypes").FANOUT_TYPE.GROUP_DIRECT,isResendingMsg:!0},v,R),o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: ",": done"])),I).tags("messaging")}catch(e){var W;throw o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: failed to resend "," message: ",""])),I,e).tags("messaging"),o("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: failed to resend message: ",""])),e).tags("messaging"),(W=R.sendReporter)==null||W.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UNKNOWN,isTerminal:!1}),R.sendReporter=null,e}yield o("WAWebMsgUtilsBridge").logMessageSendForChatThreadLogging(a.data)}),R.apply(this,arguments)}function L(e){var t;(t=e.sendReporter)==null||t.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_BACKFILL_USYNC_FAILED,isTerminal:!1}),e.sendReporter=null}function E(e,t,n,r){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["postGroupParticipantSyncMetric: start"])));var a=yield o("WAWebGroupMsgSendUtils").getParticipantRecord(String(t));if(!a){o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["postGroupParticipantSyncMetric: failed to find participant record for group ",""])),String(t));return}var i=a.participants.map(o("WAWebWidFactory").createWid);o("WAWebMaybePostMdGroupSyncMetrics").maybePostGroupSyncMetrics(r,i,n,e)}),k.apply(this,arguments)}function I(e){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.msgRecord,n=e.groupData,r=e.isDirect,a=e.oldList,i=e.phash,l=e.ackTime,s=e.serverAddressingMode,u=yield o("WAWebPersistedJobManager").getJobManager().accessors.maybeCreateJob(o("WAWebPersistedJobDefinitions").jobSerializers.resendGroupMsg(t,n,r,a,i,l,s));yield S(e),yield o("WAWebPersistedJobManager").getJobManager().accessors.deletePersistedJob(u.id)}),T.apply(this,arguments)}l.resendGroupMsg=S,l.resendPersistedGroupMsgWrapper=I}),98);
__d("WAWebSendDirectMsgToDeviceList",["Promise","WADeprecatedSendIq","WAWebCommsAckParser","WAWebSendMsgCommonApi","WAWebSendMsgCreateFanoutStanza","WAWebSignalProtocolStore","WAWebWamEnumMessageDistributionEnumType","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e;function s(e,t,n,r,o,a){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i,l,s,u){var c,d,m,p,_,f=t.data,g=f.id,h=f.to,y=yield o("WAWebSendMsgCreateFanoutStanza").createFanoutMsgStanza(t,a,i,l,u,s),C=y.stanza;yield o("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode(),(c=u.sendPerfReporter)==null||c.postReadyToSendStage(),(d=u.sendPerfReporter)==null||d.startWrittenWireStage();var b=yield o("WADeprecatedSendIq").deprecatedSendStanzaAndReturnAck(C,o("WAWebCommsAckParser").toCoreAckTemplate({id:g.id,class:"message",from:h,participant:null})),v=o("WAWebSendMsgCommonApi").sendMsgAckSyncParser.parse(b);return v.error?(e||(e=n("Promise"))).reject(r("err")("[messaging] encryptAndSendGroupDirectMsg: Invalid ack from server")):((m=u.sendReporter)==null||m.setMessageDistributionType(o("WAWebWamEnumMessageDistributionEnumType").MESSAGE_DISTRIBUTION_ENUM_TYPE.DIRECT_MESSAGE),(p=u.sendPerfReporter)==null||p.postWrittenWireStage(),u.sendPerfReporter=null,(_=u.sendReporter)==null||_.postSuccess(),u.sendReporter=null,v.success)}),u.apply(this,arguments)}l.sendDirectMsgToDeviceList=s}),98);
__d("WAWebSendGroupDirectJob",["WALogger","WATimeUtils","WAWebMsgFanoutTypes","WAWebResendGroupMsg","WAWebSendDirectMsgToDeviceList","asyncToGeneratorRuntime","cr:10198"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e,t,n,r,o){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r,a,i){var l=t.data.to;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendGroupDirectMsg: sending "," with group ",""])),t.data.id,l.toLogString()).tags("messaging");var d=yield o("WAWebSendDirectMsgToDeviceList").sendDirectMsgToDeviceList(t,n,r,{fanoutType:o("WAWebMsgFanoutTypes").FANOUT_TYPE.GROUP_DIRECT},a,i),m=d.phash,p=d.addressingMode;return m&&(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendGroupDirectMsg: phash mismatch, got server phash ",""])),m).tags("messaging"),o("WAWebResendGroupMsg").resendPersistedGroupMsgWrapper({isDirect:!0,msgRecord:t,msgProtobuf:n,oldList:r,ackTime:o("WATimeUtils").unixTime(),groupData:a,phash:m,metricReporter:i,serverAddressingMode:p}).catch(function(e){o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["resendGroupDirectMsg: failed to resend group msg: ",", type: ",""])),t.data.id.toString(),t.data.type).tags("messaging"),o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["resendGroupDirectMsg: failed to resend group msg: ",""])),e).tags("messaging").sendLogs("message-resend-failed",{sampling:.01})})),d}),m.apply(this,arguments)}l.encryptAndSendGroupDirectMsg=d}),98);
__d("WAWebSendMsgQueueMap",["WAPromiseQueue"],(function(t,n,r,o,a,i,l){var e=new(o("WAPromiseQueue")).PromiseQueueMap;l.sendMsgQueueMap=e}),98);
__d("WAWebSendGroupKeyDistributionMsgJob",["Promise","WADeprecatedSendIq","WALogger","WAWap","WAWebAdvSignatureApi","WAWebApiMessageInfoStore","WAWebApiParticipantStore","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebCommsAckParser","WAWebCommsWapMd","WAWebGetGroupKeyDistributionMsg","WAWebGroupMsgSendUtils","WAWebManageE2ESessionsJob","WAWebPhashUtils","WAWebSchemaParticipant","WAWebSendMsgCommonApi","WAWebSendMsgQueueMap","WAWebSignal","WAWebSignalProtocolStore","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","cr:10198","err"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(t,n){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendGroupKeyDistributionMsg: sending ",""])),t).tags("messaging");var r=t.remote;return o("WAWebSendMsgQueueMap").sendMsgQueueMap.enqueue(r.toString(),function(){return m(t,n)})}function m(e,t){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var a=e.id,i=e.remote,l=yield o("WAWebSchemaParticipant").getParticipantTable().get(i.toString()),d=yield o("WAWebGroupMsgSendUtils").getGroupData(i.toString(),l);t.setGroupData(d);var m=yield o("WAWebApiParticipantStore").getGroupSenderKeyListFromParticipantRecord(i,l),p=m.skDistribList,f=m.skList,g=m.rotateKey,h=f.concat(p);if(p.length===0){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendGroupKeyDistributionMsg: skip sending ",": sender key distribution list is empty"])),e).tags("messaging");return}yield o("WAWebApiMessageInfoStore").createOrMergeReceiptRecords(h.map(function(t){return{msgKey:e,receiverId:t}})),yield o("WAWebManageE2ESessionsJob").ensureE2ESessions(p);var y=yield o("WAWebPhashUtils").phashV2([].concat(h,[o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow()])),C=yield _(i,p,g),b=C[0],v=C[1],S=o("WAWap").wap("message",{id:o("WAWap").CUSTOM_STRING(a),to:o("WAWebCommsWapMd").CHAT_JID(i),phash:o("WAWap").CUSTOM_STRING(y),type:"text",device_fanout:"false"},o("WAWap").wap("meta",{appdata:"default"}),o("WAWap").wap("enc",{v:o("WAWap").CUSTOM_STRING(o("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:o("WAWap").CUSTOM_STRING(o("WAWebBackendJobs.flow").CiphertextType.Skmsg),"decrypt-fail":"hide"}),b,v);yield o("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode();var R=yield o("WADeprecatedSendIq").deprecatedSendStanzaAndReturnAck(S,o("WAWebCommsAckParser").toCoreAckTemplate({id:a,class:"message",from:i,participant:null})),L=o("WAWebSendMsgCommonApi").sendMsgAckSyncParser.parse(R);return L.error?(o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendSenderKeyMsg: Invalid ack from server"]))).tags("messaging"),(c||(c=n("Promise"))).reject(r("err")("[messaging] encryptAndSendSenderKeyMsg: Invalid ack from server"))):(yield o("WAWebApiParticipantStore").markHasSenderKey(i,p),L.success)}),p.apply(this,arguments)}function _(e,t,n){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=t.every(function(e){return e.isLid()}),a=r?o("WAWebUserPrefsMeUser").getMeDeviceLidOrThrow():o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow();n&&(yield o("WAWebSignal").Session.deleteGroupSenderKeyInfo(e,a));var i=yield o("WAWebSignal").Session.getGroupSenderKeyInfo(e,a),l=yield o("WAWebGetGroupKeyDistributionMsg").getKeyDistributionMsg(null,e,t,i,!0),s=null,u=!1;l&&l.length>0&&(s=o("WAWap").wap("participants",null,l.map(function(e){var t=e.type,n=e.ciphertext,r=e.participant;return t===o("WAWebBackendJobs.flow").CiphertextType.Pkmsg&&(u=!0),o("WAWap").wap("to",{jid:o("WAWebCommsWapMd").DEVICE_JID(r)},o("WAWap").wap("enc",{v:o("WAWap").CUSTOM_STRING(o("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),"decrypt-fail":"hide",type:o("WAWap").CUSTOM_STRING(t)},n))})));var c=null;if(u){var d=yield o("WAWebAdvSignatureApi").getADVEncodedIdentity();c=o("WAWap").wap("device-identity",null,d)}return[s,c]}),f.apply(this,arguments)}l.encryptAndSendGroupKeyDistributionMsg=d}),98);
__d("WAWebSendGroupMsgJob",["WALogger","WAWebABProps","WAWebApiContact","WAWebApiParticipantStore","WAWebDBDeviceListFanout","WAWebE2EProtoGenerator","WAWebGroupMsgSendUtils","WAWebLidMigrationUtils","WAWebMaybe","WAWebMsgGetters","WAWebMsgKey","WAWebMsgRcatUtils","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebSchemaMessageInfo","WAWebSendGroupDirectJob","WAWebSendGroupSkmsgJob","WAWebSendMsgQueueMap","WAWebWidFactory","asyncToGeneratorRuntime","err","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_=Object.freeze({SKMSG:"skmsg",DIRECT:"direct"});function f(e){return e.isLid()}function g(e){return!e.isLid()}function h(e,t,n,r,o,a,i,l){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a,i,l,s){var u=yield o("WAWebApiParticipantStore").getGroupSenderKeyListFromParticipantRecord(t,l),c=u.skDistribList,d=u.skList,m=s||C(e,i),p=m?f:g,h={type:_.SKMSG,senderKeyList:{skList:d.filter(p),skDistribList:c.filter(p),rotateKey:!1}};if(o("WAWebMsgGetters").getSubtype(e.data)==="sender_revoke"){var y=!i&&o("WAWebABProps").getABPropConfigValue("send_cag_member_revokes_as_GDM"),b=n==null?null:yield S(n,h.senderKeyList,{forceDirectMessage:y,normalizeAddressingModeFn:function(t){return t}});return b!=null?b:h}if(o("WAWebMsgGetters").getType(e.data)==="keep_in_chat"){var v=!i&&o("WAWebABProps").getABPropConfigValue("supports_keep_in_chat_in_cag"),R=r==null?null:yield L(r,h.senderKeyList,v);return R!=null?R:h}return a?k(a,h.senderKeyList,{normalizeAddressingModeFn:function(t){return t}}):h}),y.apply(this,arguments)}function C(e,t){var n=e.data,a=n.type,i=n.subtype,l=n.keepType;if(l===o("WAWebProtobufsE2E.pb").KeepType.UNDO_KEEP_FOR_ALL)return!1;switch(a){case"reaction_enc":case"comment":case"event_response":return!0;case"poll_update":if(i==="poll_vote")return!0;break;case"protocol":{if(e.type==="addon"&&e.data.kind===o("WAWebMsgType").MsgKind.ProtocolAddonRevoke)return!0;if(i==="sender_revoke")return!1;break}case"notification":case"status_notification":case"notification_template":case"gp2":case"broadcast_notification":case"e2e_notification":case"call_log":case"chat":case"location":case"payment":case"vcard":case"ciphertext":case"debug_placeholder":case"multi_vcard":case"revoked":case"oversized":case"groups_v4_invite":case"hsm":case"template_button_reply":case"debug":case"image":case"video":case"ptv":case"audio":case"ptt":case"sticker":case"status":case"document":case"product":case"order":case"list":case"interactive":case"interactive_response":case"list_response":case"buttons_response":case"reaction":case"poll_creation":case"poll_result_snapshot":case"request_phone_number":case"native_flow":case"biz-cover-photo":case"keep_in_chat":case"pin_message":case"pinned_message":case"unknown":case"newsletter_notification":case"history_bundle":case"newsletter_admin_invite":case"event_creation":case"event_edit_encrypted":case"biz_content_placeholder":case"album":case"sticker-pack":case"rich_response":case"automated_greeting_message":case"newsletter_question_response":case"guest_upsell_system_msg":case"newsletter_follower_invite":case o("WAWebMsgType").MSG_TYPE.MESSAGE_HISTORY_BUNDLE:case"message_history_notice":case"quarantined":case"message_edit_encrypted":break;default:throw r("err")("CAG - Invalid type: "+a)}if(t)return!1;throw r("err")("CAG - non-admin trying to send a regular message")}function b(e,t,n,r,o){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a){var i=yield o("WAWebApiParticipantStore").getGroupSenderKeyListFromParticipantRecord(e,t),l={senderKeyList:i,type:_.SKMSG},s=function(t){return t.map(o("WAWebLidMigrationUtils").toAddressingModeFactory(a))};if(n){var u=yield S(n,i,{forceDirectMessage:!1,normalizeAddressingModeFn:s});return u!=null?u:l}return r?k(r,i,{normalizeAddressingModeFn:s}):l}),v.apply(this,arguments)}function S(e,t,n){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield o("WAWebSchemaMessageInfo").getMessageInfoTable().equals(["msgKey"],String(e)),a=r.map(function(e){return o("WAWebWidFactory").createWid(e.receiverUserJid)});if(a.length===0)return null;var i=t.skDistribList,l=t.skList,s=new Set([].concat(i,l).map(o("WAWebWidFactory").asUserWidOrThrow).map(String)),u=a.filter(function(e){var t=o("WAWebApiContact").getAlternateUserWid(o("WAWebWidFactory").asUserWidOrThrow(e));return!s.has(String(e))&&!(t!=null&&s.has(String(t)))}),c=n.normalizeAddressingModeFn(u).filter(Boolean);if(n.forceDirectMessage===!1&&c.length===0)return null;var d=yield o("WAWebDBDeviceListFanout").getFanOutList({wids:c});return{type:_.DIRECT,deviceList:[].concat(d,l,i)}}),R.apply(this,arguments)}function L(e,t,n){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield o("WAWebSchemaMessageInfo").getMessageInfoTable().equals(["msgKey"],String(e));if(r.length===0)return null;var a=t.skDistribList,i=t.skList,l=new Set(a.concat(i).map(function(e){return String(o("WAWebWidFactory").asUserWidOrThrow(e))})),s=r.filter(function(e){return!l.has(e.receiverUserJid)}).map(function(e){return o("WAWebWidFactory").createWid(e.receiverUserJid)});if(s.length===0&&n!==!0)return null;var u=yield o("WAWebDBDeviceListFanout").getFanOutList({wids:s}),c=[].concat(u,i,a);return{type:_.DIRECT,deviceList:c}}),E.apply(this,arguments)}function k(e,t,n){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield o("WAWebSchemaMessageInfo").getMessageInfoTable().equals(["msgKey"],String(e)),a=t.skDistribList,i=t.skList,l=new Set(a.concat(i).map(function(e){return String(o("WAWebWidFactory").asUserWidOrThrow(e))})),s=function(t){return o("WAWebMaybe").ifSome(o("WAWebApiContact").getAlternateUserWid(o("WAWebWidFactory").asUserWidOrThrow(t)),function(e){return l.has(String(e))})},u=r.map(function(e){return o("WAWebWidFactory").createWid(e.receiverUserJid)}).filter(function(e){return l.has(String(e))||s(e)}),c=n.normalizeAddressingModeFn(u).filter(Boolean),d=yield o("WAWebDBDeviceListFanout").getFanOutList({wids:c});return{type:_.DIRECT,deviceList:[].concat(d)}}),I.apply(this,arguments)}function T(t,r,a){var i,l=t.data,d=l.id,m=l.to;return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendGroupMsg: queued ",""])),d).tags("messaging"),(i=a.sendPerfReporter)==null||i.startWaitingToEncryptStage(),o("WAWebSendMsgQueueMap").sendMsgQueueMap.enqueue(m.toString(),n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e,n,i,p,f,g;o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendGroupMsg: sending ",""])),d).tags("messaging"),(e=a.sendPerfReporter)==null||e.postWaitingToEncryptStage(),(n=a.sendPerfReporter)==null||n.startReadyToSendStage();var y=x(r),C=P(r),v=$(r),S=yield o("WAWebGroupMsgSendUtils").getParticipantRecord(m.toString()),R=yield o("WAWebGroupMsgSendUtils").getGroupData(m.toString(),S,t);(i=a.sendReporter)==null||i.setGroupData(R),(p=a.sendPerfReporter)==null||p.setGroupData(R);var L=(f=S==null?void 0:S.participants.map(function(e){return o("WAWebWidFactory").createUserWidOrThrow(e)}))!=null?f:[],E=yield o("WAWebMsgRcatUtils").genContentBindingForMsg(l,L),k=!!R.isLidAddressingMode,I;if(R.isCag===!0){var T=!!R.amIAdmin;o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendGroupMsg: CAG "," "])),T?"admin":"non-admin").tags("messaging"),I=yield h(t,m,y,v,C,T,S,k)}else{o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendGroupMsg: "," group size: ",""])),o("WAWebGroupMsgSendUtils").formatGroupTypeForLog(R),S==null?void 0:S.participants.length).tags("messaging");var N=yield b(m,S,y,C,k);I=D(N,R)}var M=(R==null?void 0:R.isCapiGroup)===!0?o("WAWebE2EProtoGenerator").updateGroupMsgProtoWithCapiFlag(r):r;if(I.type===_.DIRECT){var w,A,F=I,O=F.deviceList;return(w=a.sendReporter)==null||w.setDeviceCount(O.length),(A=a.sendPerfReporter)==null||A.setIsDirectedMessage(!0),o("WAWebSendGroupDirectJob").encryptAndSendGroupDirectMsg(t,M,O,R,a)}var B=I,W=B.senderKeyList;return(g=a.sendReporter)==null||g.setDeviceCount(W.skList.length+W.skDistribList.length),o("WAWebSendGroupSkmsgJob").encryptAndSendSenderKeyMsg(t,M,W,R,a,E)}))}function D(e,t){var n=t.isLidAddressingMode===!0?f:g;switch(e.type){case _.DIRECT:{var a=e.deviceList.filter(n);if(a.length<e.deviceList.length){var i=o("WAWebGroupMsgSendUtils").formatWidTypeCountsForLog(e.deviceList),l=o("WAWebGroupMsgSendUtils").formatGroupTypeForLog(t);o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose([""," found in "," group groupSendingList.deviceList"])),i,l).sendLogs("GroupLidInfra/outgoing_message")}return babelHelpers.extends({},e,{deviceList:a})}case _.SKMSG:{var s=e.senderKeyList,u=s.skDistribList,c=s.skList,h=u.filter(n);if(h.length<u.length){var y=o("WAWebGroupMsgSendUtils").formatWidTypeCountsForLog(u),C=o("WAWebGroupMsgSendUtils").formatGroupTypeForLog(t);o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose([""," found in "," group groupSendingList.senderKeyList.skDistribList"])),y,C).sendLogs("GroupLidInfra/outgoing_message")}var b=c.filter(n);if(b.length<c.length){var v=o("WAWebGroupMsgSendUtils").formatWidTypeCountsForLog(c),S=o("WAWebGroupMsgSendUtils").formatGroupTypeForLog(t);o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose([""," found in "," group groupSendingList.senderKeyList.skList"])),v,S).sendLogs("GroupLidInfra/outgoing_message")}return babelHelpers.extends({},e,{senderKeyList:babelHelpers.extends({},e.senderKeyList,{skDistribList:h,skList:b})})}default:throw e.type,r("err")("filterIncorrectlyAddressedDevices - Invalid type: "+e.type)}}function x(e){var t=e.protocolMessage,n=null;if((t==null?void 0:t.type)===o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REVOKE&&t!=null&&t.key){var a=t.key,i=a.remoteJid,l=a.id,s=a.participant;!r("isStringNullOrEmpty")(i)&&!r("isStringNullOrEmpty")(l)&&!r("isStringNullOrEmpty")(s)&&(n=new(r("WAWebMsgKey"))({remote:o("WAWebWidFactory").createWid(i),fromMe:!0,id:l,participant:o("WAWebWidFactory").createWid(s)}))}return n}function $(e){var t=e.keepInChatMessage;if(t!=null&&t.key){var n=t.key,a=n.remoteJid,i=n.id,l=n.participant;if(!r("isStringNullOrEmpty")(a)&&!r("isStringNullOrEmpty")(i)&&!r("isStringNullOrEmpty")(l)){var s=new(r("WAWebMsgKey"))({remote:o("WAWebWidFactory").createWid(a),fromMe:!0,id:i,participant:o("WAWebWidFactory").createWid(l)});return s}}return null}function P(e){var t=e.protocolMessage,n=null;if((t==null?void 0:t.type)===o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.MESSAGE_EDIT&&t!=null&&t.key){var a=t.key,i=a.remoteJid,l=a.id,s=a.participant;!r("isStringNullOrEmpty")(i)&&!r("isStringNullOrEmpty")(l)&&!r("isStringNullOrEmpty")(s)&&(n=new(r("WAWebMsgKey"))({remote:o("WAWebWidFactory").createWid(i),fromMe:!0,id:l,participant:o("WAWebWidFactory").createWid(s)}))}return n}l.GROUP_MSG_TYPE=_,l.getCagMessageSendList=h,l.getGroupSendListForRevoke=S,l.encryptAndSendGroupMsg=T,l.filterIncorrectlyAddressedDevices=D}),98);
__d("WAWebSendGroupSkmsgJob",["Promise","WADeprecatedSendIq","WALogger","WATimeUtils","WAWap","WAWebAck","WAWebAdvSignatureApi","WAWebApiMessageInfoStore","WAWebApiParticipantStore","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebBotGating","WAWebCommsAckParser","WAWebCommsWapMd","WAWebCreateNackFromStanza","WAWebE2EProtoGenerator","WAWebE2EProtoUtils","WAWebEncryptMsgProtobuf","WAWebGetGroupKeyDistributionMsg","WAWebGroupHandleAddressingModeMismatch","WAWebGroupMsgSendUtils","WAWebGroupQueryBridge","WAWebHandleMsgCommon","WAWebInteractiveMessagesNativeFlowName","WAWebManageE2ESessionsJob","WAWebMsgGetters","WAWebPhashUtils","WAWebPostPrekeysDepletionMetric","WAWebReportingTokenUtils","WAWebResendGroupMsg","WAWebSchemaMessage","WAWebSendMsgCommonApi","WAWebSendMsgMetaNode","WAWebSendMsgTypes","WAWebSignal","WAWebSignalProtocolStore","WAWebUserPrefsGeneral","WAWebUserPrefsMeUser","WAWebWamEnumMessageDistributionEnumType","WAWebWamEnumMessageType","WAWebWamEnumMismatchOriginType","WAWebWamEnumPrekeysFetchContext","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime","cr:10198","cr:10199","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f;function g(e,t,n){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){var a,i,l;if((a=t.sendPerfReporter)==null||a.startPrekeysFetchStage(),(i=t.sendPerfReporter)==null||i.setFetchedPrekeyCount(0),n.length>0)try{var s,u=yield o("WAWebManageE2ESessionsJob").ensureE2ESessions(n);(s=t.sendPerfReporter)==null||s.setFetchedPrekeyCount(u==null?void 0:u.missedPrekeyCount),o("WAWebPostPrekeysDepletionMetric").maybePostPrekeysDepletionMetric({count:u==null?void 0:u.depletedPrekeyCount,prekeysFetchReason:o("WAWebWamEnumPrekeysFetchContext").PREKEYS_FETCH_CONTEXT.SEND_MESSAGE,messageType:o("WAWebWamEnumMessageType").MESSAGE_TYPE.GROUP,deviceSizeBucket:r.deviceSizeBucket})}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions: failed for "," devices: ",""])),n.length,t).tags("messaging").devConsole(t)}(l=t.sendPerfReporter)==null||l.postPrekeysFetchStage()}),h.apply(this,arguments)}function y(e,t,n,r,o,a,i,l){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a,i,l,s){var u,c,d;(u=l.sendPerfReporter)==null||u.startClientEncryptStage();var m=o("WAWebSendMsgCommonApi").encodeAndPad(a),p=o("WAWebBackendJobsCommon").mediaTypeFromProtobuf(a),_=o("WAWebBotGating").isBotEnabled()&&((c=e.invokedBotWid)==null?void 0:c.isBot())===!0,f=o("WAWebBotGating").isBotEnabled()&&o("WAWebMsgGetters").getIsBotFeedbackMessage(e),g=o("WAWebMsgGetters").getIsRevokeForMsgFromOrDeliveredToBot(e),h=yield o("WAWebEncryptMsgProtobuf").encryptMsgSenderKey(e,t,m,i),y=h.ciphertext,C=h.senderKeyBytes,b;n.length>0&&(b=yield o("WAWebGetGroupKeyDistributionMsg").getKeyDistributionMsg(e,t,n,C,!1)),(d=l.sendPerfReporter)==null||d.postClientEncryptStage();var v=null,S=!1;b&&b.length>0&&!f?v=o("WAWap").wap("participants",null,b.map(function(e){var t=e.type,n=e.ciphertext,r=e.participant;t===o("WAWebBackendJobs.flow").CiphertextType.Pkmsg&&(S=!0);var i=s==null?void 0:s.get(o("WAWebWidToJid").widToUserJid(o("WAWebWidFactory").asUserWidOrThrow(r))),l=i!=null?o("WAWap").wap("content_binding",null,i):null;return o("WAWap").wap("to",{jid:o("WAWebCommsWapMd").DEVICE_JID(r)},o("WAWap").wap("enc",{v:o("WAWap").CUSTOM_STRING(o("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:o("WAWap").CUSTOM_STRING(t),"decrypt-fail":o("WAWebBackendJobsCommon").encodeMaybeDecryptFail(o("WAWebE2EProtoUtils").decryptFailAttributeFromProtobuf(a))},n),l)})):s!=null&&(v=o("WAWap").wap("participants",null,r.map(function(e){var t=s==null?void 0:s.get(o("WAWebWidToJid").widToUserJid(o("WAWebWidFactory").asUserWidOrThrow(e)));return t!=null?o("WAWap").wap("to",{jid:o("WAWebCommsWapMd").DEVICE_JID(e)},o("WAWap").wap("content_binding",null,t)):null})));var R=f?null:o("WAWap").wap("enc",{v:o("WAWap").CUSTOM_STRING(o("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:o("WAWap").CUSTOM_STRING(o("WAWebBackendJobs.flow").CiphertextType.Skmsg),mediatype:o("WAWebBackendJobsCommon").encodeMaybeMediaType(p),"decrypt-fail":o("WAWebBackendJobsCommon").encodeMaybeDecryptFail(o("WAWebE2EProtoUtils").decryptFailAttributeFromProtobuf(a))},y),E=null,k=_||f||g?yield L(e,a):[null,!1],I=k[0],T=k[1];if(S||T){var D=yield o("WAWebAdvSignatureApi").getADVEncodedIdentity();E=o("WAWap").wap("device-identity",null,D)}return{keyDistributionMsg:v,skeyEncryptedGroupMsg:R,identityNode:E,botMsgNode:I}}),C.apply(this,arguments)}function b(e,t){var n=t.data,a=o("WAWebE2EProtoUtils").getBizNativeFlowName(e),i=n.nativeFlowInteractiveMsg;if(a!=null&&r("WAWebInteractiveMessagesNativeFlowName").cast(a)===r("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO&&i===!0){var l;return(l=o("WAWap")).wap("biz",null,l.wap("interactive",{v:"1",type:l.CUSTOM_STRING("native_flow")},l.wap("native_flow",{name:l.CUSTOM_STRING(a)})))}return null}function v(e,t,n,r,o,a){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,i,l,h){var C,v,S,L,E,k=e.data,I=k.id,T=k.to,D=e.data;o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendSenderKeyMsg: sending ",""])),I).tags("messaging");var x=I.id,$=a.skDistribList,P=a.skList,N=a.rotateKey;R(T,l),(C=l.sendPerfReporter)==null||C.setSenderKeyDistributionCount($.length);var M=P.concat($),w=o("WAWebUserPrefsMeUser").getMeDeviceLidOrThrow(),A=o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow(),F=o("WAWebGroupMsgSendUtils").isCagAddon(D,i)||(i==null?void 0:i.isLidAddressingMode)===!0?w:A,O=yield o("WAWebPhashUtils").phashV2([].concat(M,[F])),B=o("WAWebMsgGetters").getIsBotFeedbackMessage(D);yield o("WAWebApiMessageInfoStore").createOrMergeReceiptRecords(M.map(function(e){return{msgKey:I,receiverId:e}})),N&&(yield o("WAWebSignal").Session.deleteGroupSenderKeyInfo(T,F)),yield g(l,$,i);var W=yield y(D,T,$,P,t,i,l,h),q=W.keyDistributionMsg,U=W.skeyEncryptedGroupMsg,V=W.identityNode,H=W.botMsgNode,G=h==null?void 0:h.get(o("WAWebWidToJid").widToUserJid(o("WAWebWidFactory").asUserWidOrThrow(F))),z=G!=null?o("WAWap").wap("sender_content_binding",null,G):null,j=i.isLidAddressingMode===!0?o("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.lid:o("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.pn,K=yield o("WAWebReportingTokenUtils").genReportingTokenBody(D,t),Q=o("WAWap").wap("message",{id:o("WAWap").CUSTOM_STRING(x),to:o("WAWebCommsWapMd").CHAT_JID(T),phash:B?o("WAWap").DROP_ATTR:o("WAWap").CUSTOM_STRING(O),type:o("WAWebE2EProtoUtils").typeAttributeFromProtobuf(t),edit:o("WAWebSendMsgCommonApi").editAttribute(t,D.subtype),addressing_mode:o("WAWap").CUSTOM_STRING(j)},q,U,V,b(t,e),o("WAWebSendMsgMetaNode").genMetaNode(T,e,t,i,{}),H,z,K);yield o("WAWebSendMsgCommonApi").updateIdentityRange(e,M),yield o("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode(),(v=l.sendPerfReporter)==null||v.postReadyToSendStage(),(S=l.sendPerfReporter)==null||S.startWrittenWireStage(),n("cr:10199")==null||n("cr:10199").printEncNode(t);var X=yield o("WADeprecatedSendIq").deprecatedSendStanzaAndReturnAck(Q,o("WAWebCommsAckParser").toCoreAckTemplate({id:x,class:"message",from:T,participant:null}));if(q){var Y;(Y=l.sendReporter)==null||Y.setMessageDistributionType(o("WAWebWamEnumMessageDistributionEnumType").MESSAGE_DISTRIBUTION_ENUM_TYPE.SENDER_KEY_DISTRIBUTION_MESSAGE)}(L=l.sendPerfReporter)==null||L.postWrittenWireStage(),l.sendPerfReporter=null,(E=l.sendReporter)==null||E.postSuccess(),l.sendReporter=null;var J=o("WAWebSendMsgCommonApi").sendMsgAckSyncParser.parse(X);if(J.error)return o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendSenderKeyMsg: invalid ack from server for ",""])),D.id).tags("messaging"),(f||(f=n("Promise"))).reject(r("err")("[messaging] encryptAndSendSenderKeyMsg: Invalid ack from server"));var Z=J.success.error;if(Z===o("WAWebCreateNackFromStanza").NackReason.StaleGroupAddressingMode)return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendSenderKeyMsg: ack with error code 421"]))).tags("messaging"),(f||(f=n("Promise"))).resolve().then(function(){return o("WAWebGroupQueryBridge").sendQueryGroup(T)}).catch(function(e){o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendSenderKeyMsg: sendQueryGroup failed after ack. error: ",""])),e).tags("messaging")}),e.type===o("WAWebSendMsgTypes").SendMessageRecordType.Message&&e.data.updateAck(o("WAWebAck").ACK.FAILED,!1),f.reject(r("err")("[messaging] encryptAndSendSenderKeyMsg: ack with error code 421"));yield o("WAWebApiParticipantStore").markHasSenderKey(T,$);var ee=J.success,te=ee.phash,ne=ee.count,re=ee.addressingMode;return te!=null&&te!==O?(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendSenderKeyMsg: phash mismatch for ",", got server phash ",""])),D.id,te).tags("messaging"),o("WAWebResendGroupMsg").resendPersistedGroupMsgWrapper({isDirect:!1,msgRecord:e,msgProtobuf:t,oldList:M,ackTime:o("WATimeUtils").unixTime(),groupData:i,metricReporter:l,serverAddressingMode:re}).catch(function(t){o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: failed to resend group msg: ",", type: ",""])),e.data.id.toString(),e.data.type).tags("messaging"),o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: failed to resend group msg: ",""])),t).tags("messaging").sendLogs("message-resend-failed",{sampling:.01})})):re!=null&&re!==j&&o("WAWebGroupHandleAddressingModeMismatch").handleAddressingModeMismatch(T,{localAddressingMode:j,serverAddressingMode:re,mismatchOrigin:o("WAWebWamEnumMismatchOriginType").MISMATCH_ORIGIN_TYPE.ACK_OUTGOING_MESSAGE}),ne!=null&&o("WAWebSchemaMessage").getMessageTable().merge(String(I),{count:ne}),J.success}),S.apply(this,arguments)}function R(e,t){var n=o("WAWebUserPrefsGeneral").markUserSentMessageToChat(e);if(n){var r,a;(r=t.sendPerfReporter)==null||r.setMessageIsFirstUserMessage(!0),(a=t.sendReporter)==null||a.setMessageIsFirstUserMessage(!0)}}function L(e,t){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WAWebMsgGetters").getIsBotFeedbackMessage(e),r=null,a=o("WAWebMsgGetters").getIsRevokeForMsgFromOrDeliveredToBot(e);if(n){var i;r=(i=e.protocolMessageKey)==null?void 0:i.participant}else a?r=e.botRespOrInvocationRevokeBotWid:r=e.invokedBotWid;if(!r||!r.isBot())return[null,!1];yield o("WAWebApiMessageInfoStore").createOrMergeReceiptRecords([{msgKey:e.id,receiverId:r}]);var l=!1;yield o("WAWebManageE2ESessionsJob").ensureE2ESessions([r]);var s=o("WAWebE2EProtoGenerator").updateBotInvokeMsgProtoCopyForCapi(t,e.botMessageSecret);a&&r.isFbidBot()&&(s=o("WAWebE2EProtoGenerator").updateFbidBotInvokeProtobuf(s));var u=yield o("WAWebEncryptMsgProtobuf").encryptMsgProtobuf(r,0,s,e,0),c=u.type,d=u.ciphertext;c===o("WAWebBackendJobs.flow").CiphertextType.Pkmsg&&(l=!0);var m=o("WAWap").wap("bot",{type:n?"feedback":o("WAWap").DROP_ATTR},o("WAWap").wap("to",{jid:o("WAWebCommsWapMd").DEVICE_JID(r)},o("WAWap").wap("enc",{v:o("WAWap").CUSTOM_STRING(o("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:o("WAWap").CUSTOM_STRING(c)},d)));return[m,l]}),E.apply(this,arguments)}l.encryptAndSendSenderKeyMsg=v}),98);
__d("WAWebGalaxyFlowCloseEvent",["WAWebEventEmitter"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return"galaxy_flow_"+e+"_"+t}var s=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.handleClose=function(t){this.trigger(t)},t})(r("WAWebEventEmitter")),u=new s;l.getGalaxyFlowCloseEventKey=e,l.GalaxyFlowCloseEvent=u}),98);
__d("WAWebNonMessageDataRequestHandlerGalaxyFlow",["WALogger","WAWebGalaxyFlowCloseEvent","WAWebProtobufsE2E.pb"],(function(t,n,r,o,a,i,l){var e,s,u;function c(t){var n=t.galaxyFlowAction;if(n==null){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["galaxy flow: galaxyFlowAction is null in peer data operation request"])));return}var r=n.flowId,a=n.stanzaId;if(r==null||a==null){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["galaxy flow: missing required field - flowId="," stanzaId=",""])),r!=null?r:"null",a!=null?a:"null");return}o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["galaxy flow: received NOTIFY_LAUNCH request with flowId="," stanzaId=",""])),r,a),o("WAWebGalaxyFlowCloseEvent").GalaxyFlowCloseEvent.trigger(o("WAWebGalaxyFlowCloseEvent").getGalaxyFlowCloseEventKey(r,a))}function d(e){var t=e.flowId,n=e.stanzaId;return t==null||n==null?null:{type:o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestMessage$GalaxyFlowAction$GalaxyFlowActionType.NOTIFY_LAUNCH,flowId:t,stanzaId:n}}l.handleGalaxyFlowLaunchRequest=c,l.buildGalaxyFlowDataOperationRequest=d}),98);
__d("WAWebSendNonMessageDataRequest",["Promise","WALogger","WANullthrows","WAShiftTimer","WATimeUtils","WAWebABProps","WAWebApiPeerMessageStore","WAWebCommsWapMd","WAWebCurrentUser","WAWebDBDeviceListFanout","WAWebE2EProtoUtils","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebMsgKey","WAWebMsgType","WAWebNonMessageDataRequestHandlerGalaxyFlow","WAWebNonMessageDataRequestHistorySyncOnDemandUtils","WAWebNonMessageDataRequestLoggingUtils","WAWebNonMessageDataRequestMediaHandlingUtils","WAWebNonMessageDataRequestPlaceholderMessageResendUtils","WAWebProtobufsE2E.pb","WAWebSendAppStateSyncMsgJob","WAWebSendMsgCreateDeviceStanza","WAWebSyncGatingUtils","WAWebSyncdSnapshotRecoveryGatingUtils","WAWebUserPrefsMeUser","WAWebWamEnumPeerDataResponseApplyResultType","WAWebWidFactory","asyncToGeneratorRuntime","gkx","justknobx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S=3e3;function R(e,t,n){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){var a=r!=null?r:{},i=a.skipStoringMessage,l=yield E(e,t);if(l==null){o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[rdu] the constructed peer data operation request object is null"])));return}var s=yield I(l,r);if(s==null||s.length===0){o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[rdu] the constructed peer data operation request message is null or empty"])));return}var u=F(e),p=O(e);yield(v||(v=n("Promise"))).all(s.map((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[rdu] build rdu message successfully, ## type: ",", ## msg: ",""])),e,t.id.id).devConsole(t),w(e,t),o("WAWebNonMessageDataRequestLoggingUtils").logNonMessagePeerDataRequest(e,t),i!==!0&&(yield o("WAWebApiPeerMessageStore").storePeerMessages([t])),o("WAWebNonMessageDataRequestLoggingUtils").sendTimes.set(t.id.id,o("WATimeUtils").unixTimeMs()),yield o("WAWebSendAppStateSyncMsgJob").encryptAndSendKeyMsg({msg:t,pushPriority:u!=null?u:void 0,privacySensitive:p!=null?p:void 0})});return function(e){return t.apply(this,arguments)}})()))}),L.apply(this,arguments)}function E(e,t){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[rdu] start building rdu request object, ## type: ",""])),e);var n={peerDataOperationRequestType:e,requestUrlPreview:[],requestStickerReupload:[],placeholderMessageResendRequest:[]};switch(e){case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.SEND_RECENT_STICKER_BOOTSTRAP:break;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.WAFFLE_LINKING_NONCE_FETCH:break;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER:{var r=D(t);if(r==null)return null;n.requestStickerReupload=r;break}case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.GENERATE_LINK_PREVIEW:{var a=x(t);if(a==null)return null;n.requestUrlPreview=a;break}case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_ON_DEMAND:{var i=yield P(t);if(i==null)return null;n.historySyncOnDemandRequest=i;break}case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.PLACEHOLDER_MESSAGE_RESEND:{var l=M(t);if(l==null)return null;n.placeholderMessageResendRequest=l;break}case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.FULL_HISTORY_SYNC_ON_DEMAND:{o("WALogger").WARN(_||(_=babelHelpers.taggedTemplateLiteralLoose(["full history sync on demand not supported in web"])));break}case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_META_NONCE_FETCH:{o("WALogger").WARN(f||(f=babelHelpers.taggedTemplateLiteralLoose(["companion meta nonce fetch is not supported in web"])));break}case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_CANONICAL_USER_NONCE_FETCH:{o("WALogger").WARN(g||(g=babelHelpers.taggedTemplateLiteralLoose(["companion canonical user nonce fetch is not supported in web"])));break}case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_SYNCD_SNAPSHOT_FATAL_RECOVERY:{if(o("WAWebSyncdSnapshotRecoveryGatingUtils").syncdSnapshotRecoveryEnabled()===!1)return o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Syncd Snapshot recovery is not enabled"]))),null;var s=$(t);if(s==null)return null;n.syncdCollectionFatalRecoveryRequest=s;break}case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_CHUNK_RETRY:{o("WALogger").WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["history sync chunk retry is not supported in web"])));break}case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.GALAXY_FLOW_ACTION:{var u=o("WAWebNonMessageDataRequestHandlerGalaxyFlow").buildGalaxyFlowDataOperationRequest(t);if(u==null)return null;n.galaxyFlowAction=u;break}}return n}),k.apply(this,arguments)}function I(e,t){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var a=t!=null?t:{},i=a.fanout,l=a.msgId;if(i){var s,u=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),c=u.isLid()&&(s=o("WAWebUserPrefsMeUser").getMaybeMeDeviceLid())!=null?s:o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow(),d={wids:[c]},m=yield o("WAWebDBDeviceListFanout").getFanOutList(d),p=yield(v||(v=n("Promise"))).all(m.map(function(e){return r("WAWebMsgKey").newId()}));return m.map(function(t,n){return{id:new(r("WAWebMsgKey"))({fromMe:!0,remote:o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),id:p[n]}),to:t,type:"protocol",subtype:"peer_data_operation_request_message",kind:o("WAWebMsgType").MsgKind.PeerMessage,peerDataOperationRequestMessage:e}})}var _=new(r("WAWebMsgKey"))({fromMe:!0,remote:o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),id:l!=null?l:yield r("WAWebMsgKey").newId()});return[{id:_,to:o("WAWebWidFactory").createDeviceWidFromUserAndDevice(o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().user,o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().server,0),type:"protocol",subtype:"peer_data_operation_request_message",kind:o("WAWebMsgType").MsgKind.PeerMessage,peerDataOperationRequestMessage:e}]}),T.apply(this,arguments)}function D(e){var t,n=e.fileSha256Arr,r=n==null||(t=n.filter(function(e){return!o("WAWebNonMessageDataRequestMediaHandlingUtils").inFlightStickerRequests.has(e)}))==null?void 0:t.map(function(e){return A(o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER,o("WAWebNonMessageDataRequestMediaHandlingUtils").inFlightStickerRequests,e),{fileSha256:e}});return(r==null?void 0:r.length)===0?null:r}function x(e){var t=e.urls;return t==null?void 0:t.map(function(t){return{url:t,includeHqThumbnail:e.includeHqThumbnail}})}function $(e){return{collectionName:r("WANullthrows")(e.collectionName),timestamp:e.timestamp}}function P(e){return N.apply(this,arguments)}function N(){return N=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!o("WAWebSyncGatingUtils").isHistorySyncOnDemandEnabled())return null;if(o("WAWebABProps").getABPropConfigValue("history_sync_on_demand_request_send_killswitch")&&o("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").historySyncOnDemandRequestsFailureRecord.disableRequestSending)return o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[rdu] stop sending history sync on demand request as it fails too many times"]))),null;var t=e.chatId;if(t==null)return null;var n=o("WAWebCommsWapMd").CHAT_JID(t).toString();if(new Set(o("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").inFlightHistorySyncOnDemandRequests.values()).has(n))return o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[rdu] drop history sync on demand request as it's in flight"]))),null;var r=yield o("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").getOldestMsgInChatFromDB(t),a=yield o("WAWebABProps").getABPropConfigValue("history_sync_on_demand_message_count");return{chatJid:n,oldestMsgId:r==null?void 0:r.id.id,oldestMsgFromMe:r==null?void 0:r.id.fromMe,onDemandMsgCount:a,oldestMsgTimestampMs:r==null?void 0:r.t}}),N.apply(this,arguments)}function M(t){if(!o("WAWebSyncGatingUtils").isPlaceholderMessageResendEnabled())return null;var n=t.msgKeys;return n==null||n.length===0?null:(o("WAWebCurrentUser").isEmployee()&&o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[rdu] send placeholder message backfill request for ",""])),n.map(function(e){return e.toString()})),n.filter(function(e){return!o("WAWebNonMessageDataRequestPlaceholderMessageResendUtils").inFlightPlaceholderResendRequests.has(e.id)}).map(function(e){A(o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.PLACEHOLDER_MESSAGE_RESEND,o("WAWebNonMessageDataRequestPlaceholderMessageResendUtils").inFlightPlaceholderResendRequests,e.id);var t=e.remote.isRegularUser()?o("WAWebLidMigrationUtils").toUserLid(e.remote):null,n=e.remote.isRegularUser()&&o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()?new(r("WAWebMsgKey"))({id:e.id,fromMe:e.fromMe,remote:t!=null?t:e.remote}):e;return{messageKey:o("WAWebE2EProtoUtils").msgKeyToProtobuf(n)}}))}function w(e,t){switch(e){case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER:{var n,a=(n=t.peerDataOperationRequestMessage)==null?void 0:n.requestStickerReupload;a!=null&&a.forEach(function(e){var t=e.fileSha256;if(t!=null){var n;o("WAWebNonMessageDataRequestMediaHandlingUtils").inFlightStickerRequests.add(t),o("WAWebNonMessageDataRequestMediaHandlingUtils").mediaReuploadRequestCountMap.set(t,((n=o("WAWebNonMessageDataRequestMediaHandlingUtils").mediaReuploadRequestCountMap.get(t))!=null?n:0)+1)}});break}case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_ON_DEMAND:{var i,l=(i=t.peerDataOperationRequestMessage)==null?void 0:i.historySyncOnDemandRequest;if(l!=null){var u,c=(u=l.chatJid)!=null?u:"";o("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").inFlightHistorySyncOnDemandRequests.set(t.id.id,c);var d=o("WAWebABProps").getABPropConfigValue("history_sync_on_demand_timeout_ms"),m=function(){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync][rdu] dropping history sync on demand response as it's timeout with key ","."])),r("gkx")("26258")?"":t.id.id),o("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").handleHistorySyncOnDemandFailure(c),o("WAWebNonMessageDataRequestLoggingUtils").logHistorySyncOnDemandResponse(o("WAWebWamEnumPeerDataResponseApplyResultType").PEER_DATA_RESPONSE_APPLY_RESULT_TYPE.REQUEST_TIMEOUT,t.id.id)};A(o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_ON_DEMAND,o("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").inFlightHistorySyncOnDemandRequests,t.id.id,d,m)}break}case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.PLACEHOLDER_MESSAGE_RESEND:{var p,_=(p=t.peerDataOperationRequestMessage)==null?void 0:p.placeholderMessageResendRequest;_!=null&&_.forEach(function(e){var t,n=(t=e.messageKey)==null?void 0:t.id;n!=null&&o("WAWebNonMessageDataRequestPlaceholderMessageResendUtils").inFlightPlaceholderResendRequests.add(n)});break}default:break}}function A(e,t,n,a,i){a===void 0&&(a=S),new(o("WAShiftTimer")).ShiftTimer(function(){t.has(n)&&(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[rdu] clean rdu message request (regardless of success status). key ",", ## type: ",""])),r("gkx")("26258")?"":n,e),t.delete(n),i==null||i())}).onOrAfter(a)}function F(e){switch(e){case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.GENERATE_LINK_PREVIEW:return o("WAWebSyncGatingUtils").isWebLinkPreviewNseSupportEnabled()?"high_force":null;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.PLACEHOLDER_MESSAGE_RESEND:return o("WAWebSyncGatingUtils").isMessagePlaceholderResendNseSupportEnabled()?"high_force":null;case o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_ON_DEMAND:return o("WAWebSyncGatingUtils").isHistorySyncOnDemandEnabled()?"high_force":null;default:return null}}function O(e){if(!r("justknobx")._("4199")&&e===o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_ON_DEMAND)return o("WAWebSendMsgCreateDeviceStanza").PrivacySensitiveType.OnDemand}l.sendPeerDataOperationRequest=R}),98);
__d("WAWebEncryptAndSendStatusMsg",["WADeprecatedSendIq","WAJids","WALogger","WANullthrows","WAWap","WAWebAdvSignatureApi","WAWebApiContact","WAWebApiMessageInfoStore","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebCommsAckParser","WAWebCommsWapMd","WAWebDBDeviceListFanout","WAWebE2EProtoUtils","WAWebGetGroupKeyDistributionMsg","WAWebLidMigrationUtils","WAWebLidStatusMigrationGating","WAWebLidStatusMigrationUtils","WAWebManageE2ESessionsJob","WAWebMsgFanoutTypes","WAWebMsgKey","WAWebPostPrekeysDepletionMetric","WAWebProtobufsE2E.pb","WAWebReportingTokenUtils","WAWebSchemaMessageInfo","WAWebSendMsgCommonApi","WAWebSendMsgCreateFanoutStanza","WAWebSignal","WAWebSignalProtocolStore","WAWebUserPrefsMeUser","WAWebUserPrefsStatus","WAWebUserPrefsStatusType","WAWebWamEnumMessageDistributionEnumType","WAWebWamEnumMessageType","WAWebWamEnumPrekeysFetchContext","WAWebWamNumberToSizeBucket","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g;function h(e){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebSchemaMessageInfo").getMessageInfoTable().equals(["msgKey"],String(e));return t.length===0&&(t=yield o("WAWebSchemaMessageInfo").getMessageInfoTable().equals(["msgKey"],String(o("WAWebLidMigrationUtils").getAlternateMsgKey(e)))),t.map(function(e){return o("WAWebLidStatusMigrationUtils").matWidConvert(o("WAWebWidFactory").createWid(e.receiverUserJid))})}),y.apply(this,arguments)}function C(e,t,n){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a){var i,l,f,g,y,C=t.data.id,b=o("WAWebLidStatusMigrationGating").getLidStatusSendEnabled(),S=o("WAWebWidFactory").createWid(o("WAJids").STATUS_JID),I=b?r("WANullthrows")(o("WAWebUserPrefsMeUser").getMaybeMeDeviceLid()):o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow(),T=L(n),D,x,$=yield r("WAWebUserPrefsStatus").getStatusList();if(b&&($.list=$.list.map(function(e){return o("WAWebApiContact").getCurrentLid(o("WAWebWidFactory").asUserWidOrThrow(e))}).filter(Boolean).map(function(e){return e})),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusMsg: start to send ",", revoke: ",""])),C.id,T).devConsole(n),T){var P;(P=a.sendPerfReporter)==null||P.setIsRevokeMessage(!0);var N=yield h(T);if(E(N,$.list)){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusMsg: start to send direct revoke message"])));var M=yield o("WAWebDBDeviceListFanout").getFanOutList({wids:[].concat(N,[I]),shouldMergeAltDevices:!0});return k(t,n,M,a)}D=N}else{if($.list.length===0)return;D=$.list,x=o("WAWap").wap("meta",{status_setting:R($.setting)})}var w=yield o("WAWebDBDeviceListFanout").getFanOutList({wids:[].concat(D,[I]),shouldMergeAltDevices:!0});o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusMsg: all device list size ",""])),w.length);var A=yield r("WAWebUserPrefsStatus").getStatusSkDistribList(w),F=A.skDistribList,O=A.participantList;if(F.length>0){var B,W,q;o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusMsg: distribute "," sender key"])),F.length),(B=a.sendReporter)==null||B.setMessageDistributionType(o("WAWebWamEnumMessageDistributionEnumType").MESSAGE_DISTRIBUTION_ENUM_TYPE.SENDER_KEY_DISTRIBUTION_MESSAGE),(W=a.sendReporter)==null||W.setDeviceCount(F.length),(q=a.sendPerfReporter)==null||q.setSenderKeyDistributionCount(F.length)}if(yield o("WAWebApiMessageInfoStore").createOrMergeReceiptRecords(w.map(function(e){return{msgKey:C,receiverId:e}})),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusMsg: create receipts records"]))),F.length>0)try{var U,V;(U=a.sendPerfReporter)==null||U.startPrekeysFetchStage();var H=yield o("WAWebManageE2ESessionsJob").ensureE2ESessions(F);(V=a.sendPerfReporter)==null||V.setFetchedPrekeyCount(H==null?void 0:H.missedPrekeyCount),o("WAWebPostPrekeysDepletionMetric").maybePostPrekeysDepletionMetric({count:H==null?void 0:H.depletedPrekeyCount,prekeysFetchReason:o("WAWebWamEnumPrekeysFetchContext").PREKEYS_FETCH_CONTEXT.SEND_MESSAGE,messageType:o("WAWebWamEnumMessageType").MESSAGE_TYPE.STATUS,deviceSizeBucket:r("WAWebWamNumberToSizeBucket")(w.length)})}catch(e){o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusMsg: ensureE2ESessions: failed for "," devices: ",""])),F.length,e).tags("messaging").devConsole(e)}(i=a.sendPerfReporter)==null||i.postPrekeysFetchStage(),(l=a.sendPerfReporter)==null||l.startClientEncryptStage();var G=yield v(S,I,F,O,n),z=G[0],j=G[1],K=G[2];o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusMsg: encrypt message body done"])));var Q=yield o("WAWebReportingTokenUtils").genReportingTokenBody(t.data,n),X=o("WAWap").wap("message",{id:o("WAWap").CUSTOM_STRING(C.id),to:o("WAWebCommsWapMd").CHAT_JID(S),type:o("WAWebE2EProtoUtils").typeAttributeFromProtobuf(n),edit:o("WAWebSendMsgCommonApi").editAttribute(n,t.data.subtype)},z,j,K,x,Q);yield o("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode(),(f=a.sendPerfReporter)==null||f.postClientEncryptStage(),(g=a.sendPerfReporter)==null||g.startWrittenWireStage(),o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusMsg: start sending ",""])),C.id),yield o("WADeprecatedSendIq").deprecatedSendStanzaAndReturnAck(X,o("WAWebCommsAckParser").toCoreAckTemplate({id:C.id,class:"message",from:S,participant:null})),(y=a.sendPerfReporter)==null||y.postWrittenWireStage(),yield r("WAWebUserPrefsStatus").markStatusHasSenderKey(F)}),b.apply(this,arguments)}function v(e,t,n,r,o){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a){var i=o("WAWebSendMsgCommonApi").encodeAndPad(a),l=o("WAWebBackendJobsCommon").mediaTypeFromProtobuf(a),s=yield o("WAWebSignal").Cipher.encryptSenderKeyMsgSignalProto(e,t,i),u=s.ciphertext,c=s.senderKeyBytes,d;n.length>0&&(d=yield o("WAWebGetGroupKeyDistributionMsg").getKeyDistributionMsg(null,e,n,c,!1));var m=[],p=[],_=!1,f=null;d&&d.length>0&&(m=d.map(function(e){var t=e.type,n=e.ciphertext,r=e.participant;return t===o("WAWebBackendJobs.flow").CiphertextType.Pkmsg&&(_=!0),o("WAWap").wap("to",{jid:o("WAWebCommsWapMd").DEVICE_JID(r)},o("WAWap").wap("enc",{v:o("WAWap").CUSTOM_STRING(o("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:o("WAWap").CUSTOM_STRING(t)},n))})),p=r.map(function(e){return o("WAWap").wap("to",{jid:o("WAWebCommsWapMd").USER_JID(e)})}),(p.length>0||m.length>0)&&(f=o("WAWap").wap("participants",null,m.concat(p)));var g=o("WAWap").wap("enc",{v:o("WAWap").CUSTOM_STRING(o("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:o("WAWap").CUSTOM_STRING(o("WAWebBackendJobs.flow").CiphertextType.Skmsg),mediatype:o("WAWebBackendJobsCommon").encodeMaybeMediaType(l)},u),h=null;if(_){var y=yield o("WAWebAdvSignatureApi").getADVEncodedIdentity();h=o("WAWap").wap("device-identity",null,y)}return[f,g,h]}),S.apply(this,arguments)}function R(e){switch(e){case o("WAWebUserPrefsStatusType").StatusPrivacySettingType.AllowList:return"allowlist";case o("WAWebUserPrefsStatusType").StatusPrivacySettingType.DenyList:return"denylist";case o("WAWebUserPrefsStatusType").StatusPrivacySettingType.Contact:return"contacts"}}function L(e){var t=e.protocolMessage,n=null;if((t==null?void 0:t.type)===o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REVOKE&&t!=null&&t.key){var a=t.key,i=a.remoteJid,l=a.id,s=a.participant;i!=null&&l!=null&&s!=null&&(n=new(r("WAWebMsgKey"))({remote:o("WAWebWidFactory").createWid(i),fromMe:!0,id:l,participant:o("WAWebWidFactory").createWid(s)}))}return n}function E(e,t){var n=new Set(t.map(function(e){return o("WAWebWidFactory").asUserWidOrThrow(e).toString()}));return e.some(function(e){return!o("WAWebUserPrefsMeUser").isMeAccount(e)&&!n.has(o("WAWebWidFactory").asUserWidOrThrow(e).toString())})}function k(e,t,n,r){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a,i,l=e.data.id,s=o("WAWebWidFactory").createWid(o("WAJids").STATUS_JID);o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusDirectMsg: send "," to "," device"])),l.id,n.length);var u=yield o("WAWebSendMsgCreateFanoutStanza").createFanoutMsgStanza(e,t,n,{fanoutType:o("WAWebMsgFanoutTypes").FANOUT_TYPE.GROUP_DIRECT},r),c=u.stanza;yield o("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode(),(a=r.sendPerfReporter)==null||a.startWrittenWireStage(),o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusDirectMsg: start sending ",""])),l.id),yield o("WADeprecatedSendIq").deprecatedSendStanzaAndReturnAck(c,o("WAWebCommsAckParser").toCoreAckTemplate({id:l.id,class:"message",from:s,participant:null})),(i=r.sendPerfReporter)==null||i.postWrittenWireStage()}),I.apply(this,arguments)}l.calculateRevokeSenderList=h,l.encryptAndSendStatusMsg=C}),98);
__d("WAWebMexFetchNewsletterAdminCapabilitiesJobQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"newsletter_id"}],t=[{kind:"Variable",name:"newsletter_id",variableName:"newsletter_id"}],n={alias:null,args:null,kind:"ScalarField",name:"capabilities",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebMexFetchNewsletterAdminCapabilitiesJobQuery",selections:[{alias:null,args:t,concreteType:"XWA2NewsletterAdmin",kind:"LinkedField",name:"xwa2_newsletter_admin",plural:!1,selections:[n],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebMexFetchNewsletterAdminCapabilitiesJobQuery",selections:[{alias:null,args:t,concreteType:"XWA2NewsletterAdmin",kind:"LinkedField",name:"xwa2_newsletter_admin",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:"9801384413216421",metadata:{},name:"WAWebMexFetchNewsletterAdminCapabilitiesJobQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebMexFetchNewsletterAdminCapabilitiesJob",["WALogger","WAWebMexClient","WAWebMexFetchNewsletterAdminCapabilitiesJobQuery.graphql","WAWebNewsletterModelUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u=e!==void 0?e:e=n("WAWebMexFetchNewsletterAdminCapabilitiesJobQuery.graphql");function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n={newsletter_id:e},r=yield o("WAWebMexClient").fetchQuery(u,n);o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] fetched admin capabilities"]))).tags("GQL","MEX").devConsole({newsletterJid:e,response:r});var a=(t=r.xwa2_newsletter_admin)==null?void 0:t.capabilities,i=a==null?[]:a.map(o("WAWebNewsletterModelUtils").getNewsletterCapabilityFromValue);return new Set(i)}),d.apply(this,arguments)}l.mexFetchNewsletterAdminCapabilities=c}),98);
__d("WAWebQueryDisappearingModeJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=new(r("WADeprecatedWapParser"))("dmParser",function(e){var t=e.child("disappearing_mode");return{duration:t.attrInt("duration"),t:t.attrInt("t")}});function s(){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=o("WAWap").wap("iq",{xmlns:"disappearing_mode",to:o("WAWap").S_WHATSAPP_NET,type:"get",id:o("WAWap").generateId()}),n=yield o("WADeprecatedSendIq").deprecatedSendIq(t,e);if(!n.success)throw new(o("WAWebBackendErrors")).ServerStatusCodeError(n.errorCode);return n.result}),u.apply(this,arguments)}l.queryDisappearingMode=s}),98);
__d("WAWebQueryPrivacySettingsJob",["WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WAWap","WAWebPrivacySettings","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e;function s(t,n){var r=n.maybeChild("error"),a=r&&r.maybeAttrString("code"),i=r&&r.maybeAttrString("text");o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getPrivacy error: "," - code "," text ",""])),t,a,i).sendLogs("getPrivacy",{sampling:.01})}var u=new(r("WADeprecatedWapParser"))("privacyParser",function(e){e.assertAttr("type","result");var t={};return e.child("privacy").forEachChildWithTag("category",function(e){var n=e.attrString("name");switch(n){case"readreceipts":{var r=e.attrEnum("value",o("WAWebPrivacySettings").ALL_NONE_WITH_ERROR);r!=="error"?t.readReceipts=r:s("readreceipts",e);break}case"last":{var a=e.attrEnum("value",o("WAWebPrivacySettings").VISIBILITY_WITH_ERROR);a!=="error"?t.lastSeen=a:s("last",e);break}case"online":{var i=e.attrEnum("value",o("WAWebPrivacySettings").ONLINE_VISIBILITY_WITH_ERROR);i!=="error"?t.online=i:s("online",e);break}case"profile":{var l=e.attrEnum("value",o("WAWebPrivacySettings").VISIBILITY_WITH_ERROR);l!=="error"?t.profilePicture=l:s("profile",e);break}case"status":{var u=e.attrEnum("value",o("WAWebPrivacySettings").VISIBILITY_WITH_ERROR);u!=="error"?t.about=u:s("status",e);break}case"groupadd":{var c=e.attrEnum("value",o("WAWebPrivacySettings").VISIBILITY_WITH_ERROR);c!=="error"?t.groupAdd=c:s("groupadd",e);break}case"calladd":{var d=e.attrEnum("value",o("WAWebPrivacySettings").CALL_ADD_WITH_ERROR);d!=="error"?t.callAdd=d:s("calladd",e);break}case"messages":{var m=e.attrEnum("value",o("WAWebPrivacySettings").ALL_CONTACTS);t.messages=m;break}case"defense":{var p=e.attrEnum("value",o("WAWebPrivacySettings").DEFENSE_MODE_STATE);t.defenseMode=p;break}case"pix":case"linked_profiles":case"stickers":break;default:{s(n+" is unknown type",e);break}}}),t});function c(){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e,t=(e=o("WAWap")).wap("iq",{xmlns:"privacy",to:e.S_WHATSAPP_NET,type:"get",id:e.generateId()},e.wap("privacy",null)),n=yield o("WADeprecatedSendIq").deprecatedSendIq(t,u);if(n.success)return n.result;throw r("err")("invalid response")}),d.apply(this,arguments)}l.getPrivacy=c}),98);
__d("WAWebQueryPrivacyDisallowedListLidJob",["WALogger","WASmaxPrivacyGetContactBlacklistRPC","WAWebDBCreateLidPnMappings","WAWebJidToWid","WAWebLidMigrationUtils","WAWebSchemaPrivacyDisallowedList","WAWebSetUsernameJob","WAWebUsernameGatingUtils","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m;function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n;if(t===o("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.About)n="status";else if(t===o("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.GroupAdd)n="groupadd";else if(t===o("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.LastSeen)n="last";else if(t===o("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.ProfilePicture)n="profile";else throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["invalid privacyType: ",""])),t),r("err")("GetContactBlacklist lid request invalid privacyType");var a={getContactBlacklistGetContactBlacklistLIDOrGetContactBlacklistPNMixinGroupArgs:{getContactBlacklistGetContactBlacklistLID:{categoryNamesForContactBlacklistMixinArgs:{anyName:n}}}},i=yield o("WASmaxPrivacyGetContactBlacklistRPC").sendGetContactBlacklistRPC(a);if(i.name==="GetContactBlacklistResponseError")throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["retrieved response error for GetContactBlacklist lid request"]))),r("err")("GetContactBlacklist lid request invalid response");var l=i.value,p=l.privacyAddressingMode,_=l.privacyList,f=_==null?void 0:_.user;if(_==null||f==null||f.length===0)return{status:"match"};if(i.name==="GetContactBlacklistResponseSuccess")throw o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["retrieved pn response for GetContactBlacklist lid request"]))),r("err")("GetContactBlacklist lid request invalid response");if(p!=="lid")throw o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["response privacyAddressingMode should be lid but it is pn"]))),r("err")("GetContactBlacklist lid request invalid response");var g=[],h=[],y=f.map(function(e){var t=e.jid,n;if(t==null){var a=e.contactListIds;if(a==null||a.name!=="PnJid")throw o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["response contactListIds should be PnJid for user with no LID"]))),r("err")("GetContactBlacklist lid request invalid response");var i=o("WAWebJidToWid").userJidToUserWid(a.value.pnJid),l=o("WAWebLidMigrationUtils").toUserLid(i);if(l==null)return i;n=o("WAWebLidMigrationUtils").toUserLidOrThrow(l)}else{var s=o("WAWebJidToWid").userJidToUserWid(t);n=o("WAWebLidMigrationUtils").toUserLidOrThrow(s)}var u=e.contactListIds;if((u==null?void 0:u.name)==="Username")g.push({userId:n,username:u.value.username});else if((u==null?void 0:u.name)==="PnJid")h.push({lid:n,pn:o("WAWebJidToWid").userJidToUserWid(u.value.pnJid)});else throw o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["response contactListIds name is unexpected ",""])),u==null?void 0:u.name),r("err")("GetContactBlacklist lid request invalid response");return n});yield o("WAWebDBCreateLidPnMappings").createLidPnMappingsInBatches({mappings:h,flushImmediately:!0,learningSource:"other"}),o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&g.length>0&&(yield o("WAWebSetUsernameJob").setUsernamesJob(g));var C=_.dhash;return{status:"mismatch",users:y,dhash:C}}),_.apply(this,arguments)}l.queryPrivacyDisallowedListLid=p}),98);
__d("WAWebQueryPrivacyDisallowedListPnJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebJidToWid","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e=new(r("WADeprecatedWapParser"))("getPrivacyDisallowedListParser",function(e){var t=e.child("privacy"),n=t.maybeChild("list");if(n==null)return{status:"match"};var r=n.mapChildren(function(e){return o("WAWebJidToWid").deviceJidToUserWid(e.attrDeviceJid("jid"))});return{status:"mismatch",users:r,dhash:n.attrString("dhash")}});function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n,a=(n=o("WAWap")).wap("iq",{to:n.S_WHATSAPP_NET,type:"get",id:n.generateId(),xmlns:"privacy"},n.wap("privacy",null,n.wap("list",{name:n.CUSTOM_STRING(t),value:n.CUSTOM_STRING("contact_blacklist")}))),i=yield o("WADeprecatedSendIq").deprecatedSendIq(a,e);if(i.success)return i.result;throw r("err")("invalid response")}),u.apply(this,arguments)}l.queryPrivacyDisallowedListPn=s}),98);
__d("WAWebQueryPrivacyDisallowedListUtil",["WALogger","WAWebPrivacyGatingUtils","WAWebQueryPrivacyDisallowedListLidJob","WAWebQueryPrivacyDisallowedListPnJob","WAWebSchemaPrivacyDisallowedList","asyncToGeneratorRuntime","justknobx"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(c(t))try{return yield o("WAWebQueryPrivacyDisallowedListLidJob").queryPrivacyDisallowedListLid(t)}catch(n){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[queryPrivacyDisallowedList] Failed to query privacy disallowed list with lid for type "," with error ",", falling back to pn"])),t,n).sendLogs("queryPrivacyDisallowedList-with-lid-failed")}return yield o("WAWebQueryPrivacyDisallowedListPnJob").queryPrivacyDisallowedListPn(t)}),u.apply(this,arguments)}function c(e){if(r("justknobx")._("5326"))return!1;switch(e){case o("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.About:return o("WAWebPrivacyGatingUtils").isPrivacyListLidMigrationForStatusEnabled();case o("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.GroupAdd:return o("WAWebPrivacyGatingUtils").isPrivacyListLidMigrationForGroupAddEnabled();case o("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.LastSeen:return o("WAWebPrivacyGatingUtils").isPrivacyListLidMigrationForLastSeenEnabled();case o("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.ProfilePicture:return o("WAWebPrivacyGatingUtils").isPrivacyListLidMigrationForProfilePictureEnabled()}}l.queryPrivacyDisallowedList=s,l.isPrivacyDisallowedListTypeLidMigrated=c}),98);
__d("WAWebSyncPrivacyDisallowedLists",["Promise","WAWebQueryPrivacyDisallowedListUtil","WAWebSchemaPrivacyDisallowedList","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=yield(e||(e=n("Promise"))).all(t.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebQueryPrivacyDisallowedListUtil").queryPrivacyDisallowedList(e);return{type:e,response:t}});return function(t){return e.apply(this,arguments)}})())),a=[];return r.forEach(function(e){var t=e.response,n=t.status,r=t.users,o=t.dhash;n!=="mismatch"||r==null||o==null||a.push({id:e.type,disallowedList:r.map(function(e){return e.toString()}),dhash:o})}),yield o("WAWebSchemaPrivacyDisallowedList").getPrivacyDisallowedListTable().bulkCreateOrReplace(a),a}),u.apply(this,arguments)}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield s([e])}),d.apply(this,arguments)}l.syncPrivacyDisallowedLists=s,l.syncSinglePrivacyDisallowedList=c}),98);
__d("WAWebAccountSyncJob",["$InternalEnum","WATimeUtils","WAWebProfilePicThumbCollection","WAWebQueryDisappearingModeJob","WAWebQueryPrivacySettingsJob","WAWebSchemaPrivacyDisallowedList","WAWebSyncDeviceAdvDeviceListJob","WAWebSyncPrivacyDisallowedLists","WAWebTos","WAWebUpdateDisappearingModeForContact","WAWebUserPrefsGeneral","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=n("$InternalEnum")({BLOCKLIST:"blocklist",OPTOUTLIST:"biz_opt_out_list",DEVICES:"devices",DISAPPEARING_MODE:"disappearing_mode",PICTURE:"picture",PRIVACY:"privacy",STATUS:"status",TOS:"tos",NOTICE:"notice",USER:"user",TEXT_STATUS:"text_status"});function s(e){return o("WAWebSyncDeviceAdvDeviceListJob").syncDeviceListJob(o("WAWebUserPrefsMeUser").getMePNandLIDWids(),e,null)}function u(){var e=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),t=o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.get(e);return t!=null?o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.resyncPictures([t]):o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.resyncPicturesByWid([e])}function c(){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e,t=yield o("WAWebQueryPrivacySettingsJob").getPrivacy();o("WAWebUserPrefsGeneral").setUserPrivacySettings(t);var n=[(e=o("WAWebSchemaPrivacyDisallowedList")).PrivacyDisallowedListType.About,e.PrivacyDisallowedListType.GroupAdd,e.PrivacyDisallowedListType.LastSeen,e.PrivacyDisallowedListType.ProfilePicture],r=yield o("WAWebSyncPrivacyDisallowedLists").syncPrivacyDisallowedLists(n);return{privacySettings:t,privacyDisallowedRows:r}}),d.apply(this,arguments)}function m(e){var t=o("WATimeUtils").unixTime();e.forEach(function(e){var n;o("WAWebTos").TosManager.setState(e.id,e.state?"ACCEPTED":"NOT_ACCEPTED",(n=e.timestamp)!=null?n:t)})}function p(){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebQueryDisappearingModeJob").queryDisappearingMode();yield o("WAWebUpdateDisappearingModeForContact").updateDisappearingModeForContact(o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),e.duration,e.t)}),_.apply(this,arguments)}l.AccountSyncType=e,l.getDevices=s,l.getAndUpdateProfilePicture=u,l.updatePrivacySettings=c,l.updateTosStateFromAccountSync=m,l.updateDefaultDisappearingMode=p}),98);
__d("WAWebRestartRecentSyncJob",["Promise","WAJobOrchestratorTypes","WALogger","WAWebHistorySyncNotificationUtils","WAWebOrchestratorNonPersistedJob","WAWebProtobufsHistorySync.pb","WAWebSchemaHistorySyncNotification","WAWebSyncBootstrap","WAWebSyncGatingUtils","WAWebUserPrefsHistorySync","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m;function p(){return o("WAWebSyncGatingUtils").isHistorySyncHandlingRestartV2Enabled()?o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("restartRecentSyncJob",function(){return _()},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.LOW}).waitUntilCompleted():(m||(m=n("Promise"))).resolve()}function _(){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(r("WAWebSyncBootstrap").getIsHistorySyncRunning()){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[history sync] History sync is running, skip restart recent sync job"])));return}var t=yield o("WAWebUserPrefsHistorySync").getHistorySyncStatus();if((t==null?void 0:t.recentCompleted)===!0){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Recent sync already completed, skip restart recent sync job"])));return}var n=yield o("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().equals(["processed"],0,{shouldDecrypt:!1}).then(function(e){return e.filter(function(e){return e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT||e.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.FULL})});if(n.length===0){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[history sync] No unprocessed notifications found, skip restart recent sync job"])));return}o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Unprocessed notifications length: ",""])),n.length),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Restart recent sync job"]))),r("WAWebSyncBootstrap").continueProgressiveHistorySyncProcessingV2(o("WAWebHistorySyncNotificationUtils").HistorySyncScheduleSource.ManualRestart)}),f.apply(this,arguments)}l.restartRecentSyncJob=p}),98);
__d("WAWebNonAddressBookContactsJob",["WAJids","WALogger","WAWebApiContact","WAWebChatCollection","WAWebChatGetters","WAWebLidAwareContactsDB","WAWebModelStorageUtils","WAWebSchemaChat","WAWebSchemaParticipant","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m;function p(t){t===void 0&&(t=500);var n=[],r=[],a=new Set,i=new Set;for(var l of o("WAWebChatCollection").ChatCollection.toArray())i.size===t&&(n.push(i),i=new Set),o("WAWebChatGetters").getIsEligibleForContactSync(l)&&(o("WAWebChatGetters").getIsGroup(l)?r.push(l.id):a.has(l.id)||(i.add(l.id),a.add(l.id)));for(var s of r){var u,c,d=o("WAWebChatCollection").ChatCollection.get(s)||{},m=(u=(c=d.groupMetadata)==null?void 0:c.participants.toArray())!=null?u:[];for(var p of m)i.size===t&&(n.push(i),i=new Set),a.has(p.id)||(i.add(p.id),a.add(p.id))}return i.size!==0&&n.push(i),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["get "," chunks of contacts from chat collection, chunk size: ",""])),n.length,t).tags("contact-sync"),n}function _(){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=new Set;return yield o("WAWebSchemaParticipant").getParticipantTable().forEach(function(t){t.participants.forEach(function(t){r("WAWebWid").isStringLid(t)?e.add(o("WAJids").toLidUserJid(o("WAWebWidFactory").createWid(t).user)):e.add(o("WAJids").toPhoneUserJid(o("WAWebWidFactory").createWid(t).user))})}),yield o("WAWebSchemaChat").getChatTable().forEach(function(t){r("WAWebWid").isEligibleForUSync(t.id)&&(r("WAWebWid").isStringLid(t.id)?e.add(o("WAJids").toLidUserJid(o("WAWebWidFactory").createWid(t.id).user)):e.add(o("WAJids").toPhoneUserJid(o("WAWebWidFactory").createWid(t.id).user)))}),o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["found "," contacts from chat and group participant tables"])),e.size).tags("contact-sync"),Array.from(e)}),f.apply(this,arguments)}function g(){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield r("WAWebLidAwareContactsDB").anyOf(["isAddressBookContact"],[1,0]),t=new Map(e.map(function(e){return[e.id,e.contactHash]}));return o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["found "," contacts with set isAddressBookContact value from contact table"])),t.size).tags("contact-sync"),t}),h.apply(this,arguments)}function y(e,t){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(e.size!==0){var n=function(n,r){var e={id:n,contactHash:o("WAWebApiContact").getContactHash(n)};if(r.isLid()){var a=o("WAWebApiContact").getPhoneNumber(r);if(a!=null){var i,l=a.toJid();e.pnContactHash=(i=t.get(l))!=null?i:o("WAWebApiContact").getContactHash(l)}}return e},a=Array.from(e).reduce(function(e,r){var a;try{a=o("WAWebWidFactory").createUserWidOrThrow(r)}catch(t){return e}var i=n(r,a);if(e.push(i),a.isLid()){var l=o("WAWebApiContact").getPhoneNumber(a);if(l!=null){var s=l.toJid();if(t.get(s)==null){var u=n(s,l);e.push(u)}}}else{var c=o("WAWebApiContact").getCurrentLid(a);if(c!=null){var d=c.toJid();if(t.get(d)==null){var m=n(d,c);e.push(m)}}}return e},[]);return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["add missing contactHashes to "," contacts"])),a.length).tags("contact-sync"),r("WAWebLidAwareContactsDB").bulkCreateOrMerge(a,"NonAddressBookContactsJob.addMissingContactHashesToContacts")}}),C.apply(this,arguments)}function b(){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield _();return o("WAWebModelStorageUtils").getStorage().lock(["contact"],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield g(),n=new Set,a=Array.from(e).map(function(e){var r={id:e,isContactSyncCompleted:0};return t.has(e)||(r.isAddressBookContact=0),t.get(e)==null&&n.add(e),r});o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["mark "," contacts dirty during the regular sync"])),a.length).tags("contact-sync"),yield r("WAWebLidAwareContactsDB").bulkCreateOrMerge(a,"NonAddressBookContactsJob.getNonAddressBookContactsAndMarkAllContactsDirty"),t.forEach(function(e,t){e==null&&n.add(t)}),yield y(n,t)}))}),v.apply(this,arguments)}function S(){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield _();return o("WAWebModelStorageUtils").getStorage().lock(["contact"],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield g(),n=e.filter(function(e){return!t.has(e)}),a=n.map(function(e){return{id:e,isAddressBookContact:0,isContactSyncCompleted:0}});o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["get "," non-address book contacts, mark dirty, and update the contact table during the initial sync"])),a.length).tags("contact-sync"),yield r("WAWebLidAwareContactsDB").bulkCreateOrMerge(a,"NonAddressBookContactsJob.getAndUpdateNonAddressBookContacts");var i=new Set(e.filter(function(e){return t.get(e)==null}));t.forEach(function(e,t){e==null&&i.add(t)}),yield y(i,t)}))}),R.apply(this,arguments)}l.getAllContactsFromChatCollectionIntoChunks=p,l.getNonAddressBookContactsAndMarkAllContactsDirty=b,l.getAndUpdateNonAddressBookContacts=S}),98);
__d("WAWebSyncContactJob",["WAJobOrchestratorTypes","WAWebContactSyncApi","WAWebOrchestratorNonPersistedJob"],(function(t,n,r,o,a,i,l){function e(e,t,n){t===void 0&&(t=!0);var r={contactIds:e,shouldDelayBetweenChunks:t,mode:n};return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("syncContactListInChunks",function(e){return o("WAWebContactSyncApi").syncContactListInChunks(e)},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(r)}function s(e,t,n){t===void 0&&(t=!0);var r={contactIds:e,shouldSyncDevice:t,mode:n};return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("syncContactList",function(e){return o("WAWebContactSyncApi").syncContactList(e)},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(r)}l.syncContactListInChunksJob=e,l.syncContactListJob=s}),98);
__d("WAWebSyncContactsJob",["WALogger","WANullthrows","WAShiftTimer","WAWebContactSyncApi","WAWebLidAwareContactsDB","WAWebLocalStorage","WAWebUserPrefsAppStateSync","WAWebUserPrefsKeys","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c=86400,d=2e4,m=1e3,p=60,_=null,f=[];function g(t){f.push(t),_?_.debounce(m):(_=new(o("WAShiftTimer")).ShiftTimer(function(){if(o("WAWebUserPrefsMultiDevice").isRegistered()){var t=f;f=[],_=null,o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["start new contact sync for "," contacts"])),t.length).tags("contact-sync"),o("WAWebContactSyncApi").syncContactListInChunks({contactIds:t,shouldDelayBetweenChunks:!0,mode:"query"}).catch(function(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncNewContact: contact sync failed, error: ",""])),e).verbose().tags("non-sad","contact-sync").sendLogs("syncNewContact: contact sync failed")})}}),_.onOrBefore(d))}function h(){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield r("WAWebLidAwareContactsDB").equals(["isContactSyncCompleted"],0),t=e.map(function(e){return o("WAWebWidFactory").createWid(e.id)});return o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["sync dirty contacts, found "," contacts to sync"])),t.length).tags("contact-sync"),o("WAWebContactSyncApi").syncContactListInChunks({contactIds:t,shouldDelayBetweenChunks:!0,mode:"query"})}),y.apply(this,arguments)}function C(){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){(yield o("WAWebUserPrefsMultiDevice").getShouldCheckContactSyncStatus())&&self.setTimeout(function(){h()},p*1e3),yield o("WAWebUserPrefsAppStateSync").setShouldCheckContactSyncStatus()}),b.apply(this,arguments)}function v(){var e,t=(e=r("WANullthrows")(r("WAWebLocalStorage")).getItem(o("WAWebUserPrefsKeys").KEYS.CONTACT_SYNC_REFRESH))!=null?e:c;return parseInt(t,10)}l.syncNewContact=g,l.runSyncDirtyContactsJob=C,l.getContactSyncRefreshSeconds=v}),98);
__d("WAWebSyncdRequestAllSyncdMissingKeysJob",["WAJobOrchestratorTypes","WAWebOrchestratorNonPersistedJob","WAWebSyncdHandleMissingKeys","WAWebSyncdStoreMissingKeys","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("requestAllSyncdMissingKeys",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield o("WAWebSyncdHandleMissingKeys").requestAllMissingKeys(),self.setTimeout(o("WAWebSyncdStoreMissingKeys").setMissingKeyTimeoutInTransaction,1e3*20)}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.BEST_EFFORT,maxTimeoutMs:1e3*30}).waitUntilCompleted()}l.requestAllSyncdMissingKeysJob=e}),98);
__d("WAWebSyncdSyncAllCollectionsJob",["WAJobOrchestratorTypes","WALogger","WASyncdConst","WATimeUtils","WAWebOrchestratorNonPersistedJob","WAWebSyncd","WAWebUserPrefsAppStateSync","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("syncdSyncAllCollections",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: periodic sync for all collection"]))),yield o("WAWebSyncd").markCollectionsForSync([o("WASyncdConst").CollectionName.CriticalBlock,o("WASyncdConst").CollectionName.CriticalUnblockLow,o("WASyncdConst").CollectionName.Regular,o("WASyncdConst").CollectionName.RegularLow,o("WASyncdConst").CollectionName.RegularHigh]),yield o("WAWebUserPrefsAppStateSync").setLastPeriodicAppStateSyncTs(o("WATimeUtils").unixTime())}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.LOW,maxTimeoutMs:1e3*30}).waitUntilCompleted()}l.syncdSyncAllCollectionsJob=s}),98);
__d("WAWebNonMessageDataRequestMediaHandlingUtils",["Promise","WAJobOrchestratorTypes","WATimeUtils","WAWebMediaMmsV4Upload","WAWebOrchestratorNonPersistedJob","WAWebProtobufsE2E.pb","WAWebSchemaNonMessageDataRequest","WAWebSendNonMessageDataRequest","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=15,u=15,c=new Set,d=new Map,m=new Map;function p(e){d.clear(),e.forEach(function(e){e.operationType===o("WAWebSchemaNonMessageDataRequest").DataRequestUploadOperationType.MEDIA_UPLOAD&&d.set(e.id,e)})}function _(){return m.clear(),o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("requestAllSyncdMissingKeys",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("WATimeUtils").unixTime(),t=o("WAWebSchemaNonMessageDataRequest").getNonMessageDataRequestTable(),n=yield t.all();n.filter(function(t){return!(t.operationType!==o("WAWebSchemaNonMessageDataRequest").DataRequestUploadOperationType.MEDIA_UPLOAD||t.requestType!==o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER||t.lastRequestTimeStampSec!=null&&e-t.lastRequestTimeStampSec>48*o("WATimeUtils").HOUR_SECONDS||t.requestRetryCount!=null&&t.requestRetryCount>=3)}),o("WAWebSendNonMessageDataRequest").sendPeerDataOperationRequest(o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER,{fileSha256Arr:n.map(function(e){return e.fileKey})})}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.LOW}).waitUntilCompleted()}function f(e,t){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){var a=o("WAWebSchemaNonMessageDataRequest").getNonMessageDataRequestTable(),i=Array.from(t.keys()),l=o("WATimeUtils").unixTime(),s=[];yield(e||(e=n("Promise"))).all(i.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n,i=b(e,r,o("WAWebSchemaNonMessageDataRequest").DataRequestUploadOperationType.SEND_REQUEST),u=yield a.get(i);s.push({id:i,fileKey:e,requestType:r,operationType:o("WAWebSchemaNonMessageDataRequest").DataRequestUploadOperationType.SEND_REQUEST,lastRequestTimeStampSec:l,requestRetryCount:((n=u==null?void 0:u.requestRetryCount)!=null?n:0)+1,responseError:t.get(e)})});return function(t){return e.apply(this,arguments)}})())).then(function(){a.bulkCreateOrReplace(s)})}),g.apply(this,arguments)}function h(e,t,n){var r=b(e,t,o("WAWebSchemaNonMessageDataRequest").DataRequestUploadOperationType.MEDIA_UPLOAD),a=d.get(r);return a!=null&&a.lastMediaUploadSuccess===!0&&a.lastMediaUploadTimeStampSec!=null&&n-a.lastMediaUploadTimeStampSec<=o("WATimeUtils").DAY_SECONDS}function y(e,t,n){var r=b(e,t,o("WAWebSchemaNonMessageDataRequest").DataRequestUploadOperationType.MEDIA_UPLOAD),a=d.get(r),i=v(n,a==null?void 0:a.lastRequestTimeStampSec);return a!=null&&a.lastMediaUploadSuccess===!1&&i&&a.mediaUploadFailureCount!=null&&a.mediaUploadFailureCount>=s}function C(e,t){var n=[];e.forEach(function(e,r){var a,i=b(r,o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER,o("WAWebSchemaNonMessageDataRequest").DataRequestUploadOperationType.MEDIA_UPLOAD),l=d.get(i),s=!v(t,l==null?void 0:l.lastMediaUploadTimeStampSec),u=e===o("WAWebMediaMmsV4Upload").UploadMediaResultKind.SUCCESS,c=(s?0:(a=l==null?void 0:l.mediaUploadFailureCount)!=null?a:0)+(u?0:1),m={id:i,fileKey:r,requestType:o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER,operationType:o("WAWebSchemaNonMessageDataRequest").DataRequestUploadOperationType.MEDIA_UPLOAD,lastMediaUploadTimeStampSec:t,lastMediaUploadSuccess:u,mediaUploadFailureCount:c};d.set(i,m),n.push(m)});var r=o("WAWebSchemaNonMessageDataRequest").getNonMessageDataRequestTable();r.bulkCreateOrReplace(n)}function b(e,t,n){return e+"_"+String(t)+"_"+String(n)}function v(e,t){var n=new Date(e*1e3).toDateString(),r=t!=null?new Date(t*1e3).toDateString():n;return n===r}l.MEDIA_REUPLOAD_REQUEST_LIMIT=u,l.inFlightStickerRequests=c,l.mediaReuploadRequestCountMap=m,l.initializeMediaUploadResultFromStorage=p,l.retryNonMessageDataRequestJob=_,l.insertResponseError=f,l.shouldSkipMediaUploadWithSuccess=h,l.shouldSkipMediaUploadWithCancellation=y,l.insertMediaUploadResult=C}),98);
__d("WAWebNonMessageDataRequestPlaceholderMessageResendUtils",["WATimeUtils","WAWebABProps","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebSendNonMessageDataRequest","WAWebSyncGatingUtils"],(function(t,n,r,o,a,i,l){var e=new Set,s=new Set,u=32;function c(t,n){if(!(!o("WAWebSyncGatingUtils").isPlaceholderMessageResendEnabled()||!n)){var r=[],a=o("WATimeUtils").unixTime(),i=o("WAWebABProps").getABPropConfigValue("placeholder_message_resend_maximum_days_limit")*o("WATimeUtils").DAY_SECONDS;if(t.forEach(function(t){t.type===o("WAWebMsgType").MSG_TYPE.CIPHERTEXT&&!e.has(t.id)&&a-t.t<=i&&!t.unsafe().isMdHistoryMsg&&t.subtype!=="bot_unavailable_fanout"&&t.subtype!=="hosted_unavailable_fanout"&&t.subtype!=="view_once_unavailable_fanout"&&(e.add(t.id),r.push(t.id))}),r.length>0)for(var l=0;l<r.length;l+=u){var s=r.slice(l,l+u);o("WAWebSendNonMessageDataRequest").sendPeerDataOperationRequest(o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.PLACEHOLDER_MESSAGE_RESEND,{msgKeys:s})}}}l.inFlightPlaceholderResendRequests=s,l.handlePlaceholderMsgsSeen=c}),98);
__d("WAWebContactSyncApiConst",[],(function(t,n,r,o,a,i){var e=500,l=20;i.CONTACT_SYNC_CHUNK_SIZE=e,i.SYNC_CONTACT_CHUNK_INTERVAL_SECONDS=l}),66);
__d("WAWebContactSyncApi",["Promise","WAJids","WALogger","WANullthrows","WAPromiseDelays","WATimeUtils","WAWebAdvHandlerApi","WAWebApiContact","WAWebApiDeviceList","WAWebBizVerifiedNameAction","WAWebContactSyncApiConst","WAWebDBCreateLidPnMappings","WAWebGetIdentityKeysJob","WAWebHandleUsernameSync","WAWebLidAwareContactsDB","WAWebLocalStorage","WAWebPhashUtils","WAWebTextStatusCollection","WAWebTextStatusGatingUtils","WAWebUpdateDisappearingModeForContact","WAWebUpdateTextStatusForContact","WAWebUserPrefsKeys","WAWebUsernameGatingUtils","WAWebUsync","WAWebUsyncUser","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v;function S(e){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.contactIds,n=e.shouldDelayBetweenChunks,r=e.mode,a=o("WAWebContactSyncApiConst").CONTACT_SYNC_CHUNK_SIZE;o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["start contact sync for "," contacts in "," chunks, each chunk size: ",""])),t.length,Math.ceil(t.length/a),a).tags("contact-sync");for(var i=0;i<t.length;i+=a){var l=t.slice(i,i+a);n&&(yield o("WAPromiseDelays").delayMs(o("WAWebContactSyncApiConst").SYNC_CONTACT_CHUNK_INTERVAL_SECONDS*1e3)),yield L({contactIds:l,shouldSyncDevice:!0,mode:r})}}),R.apply(this,arguments)}function L(e){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.contactIds,a=e.shouldSyncDevice,i=e.mode;if(t.length!==0){var l=yield O(t),s=new(o("WAWebUsync")).USyncQuery().withContext("background").withMode(i).withBusinessProtocol().withStatusProtocol();o("WAWebTextStatusGatingUtils").receiveTextStatusEnabled()&&s.withTextStatusProtocol(),a&&s.withDeviceProtocol(),s.withDisappearingModeProtocol(),s.withLidProtocol(),o("WAWebUsernameGatingUtils").usernameUsyncEnabled()&&s.withUsernameProtocol();var u=l.filter(function(e){return!e.id.isLid()}).map(function(e){return o("WAWebWidFactory").asUserWidOrThrow(e.id)}),c=new Map(u.map(function(e){var t=o("WAWebApiContact").getCurrentLid(e);return t==null?null:[e.toString(),t]}).filter(Boolean));l.forEach(function(e){var t=new(o("WAWebUsyncUser")).USyncUser().withId(e.id).withDeviceHash(String(e.hash));if(!e.id.isLid()){var n=c.get(e.id.toString());n!=null&&t.withLid(n)}s.withUser(t)});for(var d=null,p=3,_=10*Math.random();p-- >0;)try{d=yield s.execute();var f=d.error.all;if(f){var g;throw _=(g=f.errorBackoff)!=null?g:10*Math.random(),r("err")("syncContactList: error "+f.errorCode+": "+f.errorText)}else p=0}catch(e){p===0&&o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["failed to execute usync query"]))).verbose().devConsole(e).sendLogs("failed to execute usync query: "+e),yield o("WAPromiseDelays").delayMs(_*1e3)}if(!(d==null||d.error.all)){var h=d.refresh,y=[];for(var C of Object.keys(h))y.push(h[C]);if(y.length>0){var b=Math.min.apply(Math,y);W(b)}yield $(d),yield(v||(v=n("Promise"))).all([a?A(d):(v||(v=n("Promise"))).resolve(),D(d),o("WAWebUsernameGatingUtils").usernameUsyncEnabled()?o("WAWebHandleUsernameSync").handleUsernameSync(d):(v||(v=n("Promise"))).resolve(),k(d),I(d),N(d)]),yield w(t)}}}),E.apply(this,arguments)}function k(t){var n=t.error.status;if(n){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["handleSyncStatus: failed "," : ",""])),n.errorCode,n.errorText);return}t.list.map(function(e){var t=o("WAWebTextStatusCollection").TextStatusCollection.get(e.id);t&&e.status&&t.set({status:e.status})})}function I(e){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!o("WAWebTextStatusGatingUtils").receiveTextStatusEnabled())return(v||(v=n("Promise"))).resolve();var t=e.error.text_status;if(t){o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["handleSyncTextStatus: failed "," : ",""])),t.errorCode,t.errorText);return}yield(v||(v=n("Promise"))).all(e.list.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e.text_status){var t=e.text_status,n=t.text,r=t.emoji,a=t.ephemeralDurationSeconds,i=t.lastUpdateTime;yield o("WAWebUpdateTextStatusForContact").updateTextStatusForContact(e.id,n,r,a,i)}});return function(t){return e.apply(this,arguments)}})()))}),T.apply(this,arguments)}function D(e){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.error.status;if(t){o("WALogger").WARN(_||(_=babelHelpers.taggedTemplateLiteralLoose(["handleDisappearingMode: failed "," : ",""])),t.errorCode,t.errorText);return}yield(v||(v=n("Promise"))).all(e.list.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){e.disappearing_mode&&(yield o("WAWebUpdateDisappearingModeForContact").updateDisappearingModeForContact(e.id,e.disappearing_mode.duration,e.disappearing_mode.t))});return function(t){return e.apply(this,arguments)}})()))}),x.apply(this,arguments)}function $(e){return P.apply(this,arguments)}function P(){return P=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.error.lid;t&&o("WALogger").WARN(f||(f=babelHelpers.taggedTemplateLiteralLoose(["handleLidSync: error ",": ",""])),t.errorCode,t.errorText);var n=[],r=[];e.list.forEach(function(e){var t=e.id,a=e.lid,i=e.pn;if(a!=null){if(t.isLid()){o("WALogger").WARN(g||(g=babelHelpers.taggedTemplateLiteralLoose(["handleLidSync: lidResults entry has lid as id, skipping: ",""])),t.toLogString());return}n.push({lid:o("WAWebWidFactory").createUserWidOrThrow(a,"lid"),pn:t})}else if(i!=null){if(!t.isLid()){o("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["handleLidSync: pnResults entry has phone number as id, skipping: ",""])),t.toLogString());return}r.push({lid:t,pn:i})}}),n.length>0&&r.length>0&&o("WALogger").WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["handleLidSync: mixed mapping types detected - lidResults: ",", pnResults: ",""])),n.length,r.length);var a=[].concat(n,r);a.length>0&&(yield o("WAWebDBCreateLidPnMappings").createLidPnMappings({mappings:a,flushImmediately:!0,learningSource:"usync"}))}),P.apply(this,arguments)}function N(e){return M.apply(this,arguments)}function M(){return M=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.list.filter(function(e){var t=e.business;return!!t});yield o("WAWebBizVerifiedNameAction").handleVerifiedNameSync(t.map(function(e){var t=e.id,n=e.business.verifiedName;return{id:t,verifiedName:n}}))}),M.apply(this,arguments)}function w(e){var t=e.map(function(e){var t=e.isLid()?o("WAJids").toLidUserJid(e.user):o("WAJids").toPhoneUserJid(e.user);return{id:t,isContactSyncCompleted:1}});return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["mark "," contacts completed for contact sync"])),t.length).tags("contact-sync"),r("WAWebLidAwareContactsDB").bulkCreateOrMerge(t,"ContactSyncApi.markContactsSyncCompleted")}function A(e){return F.apply(this,arguments)}function F(){return F=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.error.devices;t&&o("WALogger").WARN(C||(C=babelHelpers.taggedTemplateLiteralLoose(["handleSyncDevice: error ",": ",""])),t.errorCode,t.errorText);var n=e.list.filter(function(e){return e.devices&&e.devices.deviceList!=null&&e.devices.keyIndex!=null&&!("errorCode"in e.devices)}).map(function(e){return{wid:e.id,devices:e.devices}});return o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["handleSyncDevice: skipping "," out of "," records"])),e.list.length-n.length,e.list.length),yield o("WAWebGetIdentityKeysJob").getAndStoreIdentityKeys(n.map(function(e){return e.wid})),o("WAWebAdvHandlerApi").handleADVDeviceSyncResult(n)}),F.apply(this,arguments)}function O(e){return B.apply(this,arguments)}function B(){return B=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebApiDeviceList").getDeviceIds(e),r=t.map(function(e){return e==null?[]:e.devices.map(function(t){return o("WAWebWidFactory").createDeviceWidFromDeviceListPk(e.id,t.id,t.isHosted)})}),a=yield(v||(v=n("Promise"))).all(r.map(function(e){return e.length===0?"":o("WAWebPhashUtils").phashV2(e)})),i=e.map(function(e,t){return{id:e,hash:a[t]}});return i}),B.apply(this,arguments)}function W(e){if(Number.isNaN(e)||e<=o("WATimeUtils").HOUR_SECONDS){o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["invalid contact sync refresh period: ",""])),e).tags("contact-sync");return}o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["set contact sync refresh period: ",""])),e).tags("contact-sync"),r("WANullthrows")(r("WAWebLocalStorage")).setItem(o("WAWebUserPrefsKeys").KEYS.CONTACT_SYNC_REFRESH,String(e))}l.syncContactListInChunks=S,l.syncContactList=L,l.handleLidSync=$,l.markContactsSyncCompleted=w}),98);
__d("WAWebOutgoingMessage",["$InternalEnum","WALogger","WAWebE2EProtoGenerator","WAWebE2EProtoUtils","WAWebFrontendMsgGetters","WAWebHandleMsgError","WAWebMessagePluginParseProtobuf","WAWebMsgType","WAWebProcessBaseMsgInfo","WAWebSendMsgTypes","WAWebVerifyProtobufMsgObjectKeys","cr:10197"],(function(t,n,r,o,a,i,l){var e,s,u,c=new Set([(u=o("WAWebMsgType")).MSG_TYPE.CIPHERTEXT,u.MSG_TYPE.UNKNOWN,u.MSG_TYPE.GP2,u.MSG_TYPE.E2E_NOTIFICATION,u.MSG_TYPE.NOTIFICATION_TEMPLATE]),d=n("$InternalEnum")({Chat:"chat",ChatResend:"chat-resend",Retry:"retry",Newsletter:"newsletter",Report:"report",Status:"status",Debug:"debug"}),m=function(n,r,a){if(!c.has(r.data.type))try{var t=o("WAWebE2EProtoUtils").getMutableMessageProtobuf(a);o("WAWebVerifyProtobufMsgObjectKeys").verifyProtobufMessageObjectKeys(t),o("WAWebMessagePluginParseProtobuf").parseProtobuf({msgContext:"outgoing",messageProtobuf:t,baseMessage:r.type===o("WAWebSendMsgTypes").SendMessageRecordType.Message?o("WAWebProcessBaseMsgInfo").msgToBaseMsgInfo(r.data):o("WAWebProcessBaseMsgInfo").msgDataToBaseMsgInfo(r.data)})}catch(t){throw t instanceof o("WAWebHandleMsgError").MessageValidationError?o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["generate proto: type:"," error:",""])),r.data.type,t.name).tags("messaging").sendLogs("outgoingMsg: "+t.name):o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["generate proto uncategorized error: msgId:"," type:"," error:",""])),r.data.id,r.data.type,t).sendLogs("outgoing "+String(n)+" "+r.data.type,{sampling:.01}),t}},p="https://web.whatsapp.net",_=function(t){t.type===o("WAWebMsgType").MSG_TYPE.STICKER&&t.deprecatedMms3Url==null&&(t.deprecatedMms3Url=p);var e;if(o("WAWebFrontendMsgGetters").getAsMms(t)){var n=t.isUnsentPhoneMsg();e=n?{type:t.type}:t.avParams(),t.type===o("WAWebMsgType").MSG_TYPE.STICKER&&!n&&e.url==null&&(e.url=p)}return o("WAWebE2EProtoGenerator").createMsgProtobuf(t,e||{})},f=function(t,n){var e=n.type===o("WAWebSendMsgTypes").SendMessageRecordType.Message?_(n.data):o("WAWebE2EProtoGenerator").createAddonProtobuf(n.data);return m(t,n,e),e},g=function(t,n){return f(t,{type:o("WAWebSendMsgTypes").SendMessageRecordType.Message,data:n})};l.OutgoingMessageOriginType=d,l.createOutgoingMessageProtobuf=f,l.createOutgoingMsgModelProtobuf=g}),98);
__d("WAWebICDCMetaApi",["WAWebAdvMetadataCreationFailureWamEvent","WAWebE2EProtoGenerator","WAWebIdentityIcdcApi","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),r,a;try{r=yield o("WAWebIdentityIcdcApi").getICDCMeta(n)}catch(e){throw new(o("WAWebAdvMetadataCreationFailureWamEvent")).AdvMetadataCreationFailureWamEvent({advMetadataIsMe:!0}).commit(),e}try{a=o("WAWebUserPrefsMeUser").isMeAccount(e)?null:yield o("WAWebIdentityIcdcApi").getICDCMeta(e)}catch(e){throw new(o("WAWebAdvMetadataCreationFailureWamEvent")).AdvMetadataCreationFailureWamEvent({advMetadataIsMe:!1}).commit(),e}o("WAWebE2EProtoGenerator").populateMessageContextInfo(t,r,a)}),s.apply(this,arguments)}l.populateICDCMeta=e}),98);
__d("WAWebModelStorageInit",["WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsKeys","WAWebUserPrefsLocalStorage","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=[],t=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.ROUTING_INFO);t!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.ROUTING_INFO,value:t});var n=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.INITIAL_HISTORY_SYNCED);n!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.INITIAL_HISTORY_SYNCED,value:n!=null});var a=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.HISTORY_SYNC_STATUS);a!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_STATUS,value:a});var i=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.BLOCKLIST_HASH);i!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.BLOCKLIST_HASH,value:i});var l=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.CRITICAL_DATA_SYNCED);l!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.CRITICAL_DATA_SYNCED,value:l});var s=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.SHOULD_CHECK_CONTACT_SYNC_STATUS);s!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.SHOULD_CHECK_CONTACT_SYNC_STATUS,value:s});var c=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.ADV_SECRET_KEY);c!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.ADV_SECRET_KEY,value:c});var d=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.MD_UPGRADE_WAM_FLAG);d!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MD_UPGRADE_WAM_FLAG,value:d===!0});var m=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.MD_HISTORY_LAST_CHUNK_PROCESSED);m!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MD_HISTORY_LAST_CHUNK_PROCESSED,value:m});var p=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.UNARCHIVE_CHATS_SETTING);p!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.UNARCHIVE_CHATS_SETTING,value:p});var _=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.ARCHIVE_V2_ENABLED_SETTING);_!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.ARCHIVE_V2_ENABLED_SETTING,value:_});var f=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.MD_SYNC_ACTIONS_ACTION_SANITIZED);f!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MD_SYNC_ACTIONS_ACTION_SANITIZED,value:f===!0});var g=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.CHAT_THREAD_LOGGING_OFFSET);g!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.CHAT_THREAD_LOGGING_OFFSET,value:g});var h=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.CHAT_THREAD_LOGGING_SECRET);h!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.CHAT_THREAD_LOGGING_SECRET,value:h});var y=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.CHAT_THREAD_LOGGING_LAST_UPLOADED_START_TS);y!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.CHAT_THREAD_LOGGING_LAST_UPLOADED_START_TS,value:y});var C=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.PAIRING_TIMESTAMP);C!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.PAIRING_TIMESTAMP,value:C});var b=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.RECENT_MAILBOX_AGE_DAYS);b!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.RECENT_MAILBOX_AGE_DAYS,value:b});var v=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.LAST_PERIODIC_APP_STATE_SYNC_TS);v!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.LAST_PERIODIC_APP_STATE_SYNC_TS,value:v});var S=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").MD_KEYS.MD_LOGIN_COOKIE_REQUEST_COMPLETE);S!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MD_LOGIN_COOKIE_REQUEST_COMPLETE,value:S});var R=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").KEYS.MOBILE_PLATFORM_DEPRECATED);R!=null&&e.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MOBILE_PLATFORM,value:R});var L=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").KEYS.PRIMARY_FEATURES);L!=null&&e.push({key:o("WAWebUserPrefsKeys").KEYS.PRIMARY_FEATURES,value:L});var E=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").HASHED_KEYS.USER_PRIVACY_SETTINGS);E!=null&&e.push({key:o("WAWebUserPrefsKeys").HASHED_KEYS.USER_PRIVACY_SETTINGS,value:E});var k=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").KEYS.INITIAL_HIST_BOUNDARY),I=u(k);return I!=null&&e.push({key:o("WAWebUserPrefsKeys").HASHED_KEYS.INITIAL_HIST_BOUNDARY,value:I}),o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.bulkSetItemsToIndexedDB(e)}),s.apply(this,arguments)}function u(e){if(typeof e=="object")return e;if(typeof e!="string")return null;var t;try{t=JSON.parse(e)}catch(e){return null}if(t==null||typeof t!="object"||t instanceof Array)return null;var n={};return Object.entries(t).forEach(function(e){var t=e[0],r=e[1];typeof r=="number"&&(n[t]=r)}),n}l.migrateMDUserPrefsToIndexedDB=e}),98);
__d("WAWebStatusStorageUtils",["invariant","WAWebIdb","WAWebStorage"],(function(t,n,r,o,a,i,l,s){var e="status-storage",u=null;function c(){var t=new(r("WAWebIdb"))(e);u=new(o("WAWebStorage")).Storage(t)}function d(){return u!=null||s(0,92225),u}l.createStorage=c,l.getStorage=d}),98);
__d("WAWebStatusStorageVersions",["WAWebStatusStorageUtils"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebStatusStorageUtils").getStorage().versions.version(0)}l.statusCreateTable=e}),98);
__d("WAWebSchemaStatus",["WAWebStatusStorageUtils","WAWebStatusStorageVersions","WAWebStorageMutationBuilder"],(function(t,n,r,o,a,i,l){"use strict";var e=o("WAWebStorageMutationBuilder").columnBuilder(),s=e.addColumn,u=e.addAutoIncrementingPrimaryKey,c=e.addUniqueIndex;function d(){var e=o("WAWebStatusStorageUtils").getStorage();e.add("status").version(o("WAWebStatusStorageVersions").statusCreateTable(),[u("id"),s("status_uuid"),c("status_uuid"),s("sender_user_jid"),s("type"),s("timestamp"),s("state"),s("is_archived"),s("media_row_id"),s("secret")])}l.addTable=d}),98);
__d("WAWebStatusStorageInitialize",["WALogger","WAWeb-dexie","WAWebDbRolloutUtil","WAWebSchemaStatus","WAWebStatusStorageUtils","WAWebStorage","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return s==null&&(yield o("WAWebDbRolloutUtil").loadSchemaVersions(),o("WAWebStatusStorageUtils").createStorage(),o("WAWebSchemaStatus").addTable(),s=o("WAWebStatusStorageUtils").getStorage().initialize().catch(function(t){var n="Unknown error";throw t instanceof o("WAWebStorage").AlreadyInitializedError||t instanceof o("WAWebStorage").NoSuchDatabaseError?n=t.toString():t instanceof r("WAWeb-dexie").DexieError&&(n="Unknown DexieError"),o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to initialize status storage: ",""])),n).verbose().devConsole(t).sendLogs("failed-to-initialize-status-storage",{sendLogsType:o("WALogger").SendLogsType.CRASH_OR_UNRECOVERABLE_ERROR_SAD}),t})),s}),c.apply(this,arguments)}l.initialize=u}),98);
__d("WAWebStatusStorage",["WAWebStatusStorageInitialize","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield o("WAWebStatusStorageInitialize").initialize()}),s.apply(this,arguments)}Object.keys(o("WAWebStatusStorageInitialize")).forEach(function(e){e==="default"||e==="__esModule"||(l[e]=o("WAWebStatusStorageInitialize")[e])}),l.initialize=e}),98);
__d("WAWebLaunchSocket",["Promise","WAComms","WAGzip","WALogger","WAWebABPropsUpdateFromStorage","WAWebApiContact","WAWebBackendApi","WAWebBridgeInitialization","WAWebBrokerGlobalAppState","WAWebBuildConstants","WAWebCmd","WAWebCommsConfig","WAWebCommsHandleStanza","WAWebCryptoEncKeyHelper","WAWebCurrentUser","WAWebDbRolloutUtil","WAWebEnvironment","WAWebEventSamplingCache","WAWebFtsClient","WAWebInitFromStorage","WAWebInvocationInterface","WAWebModelStorage","WAWebModelStorageInit","WAWebPageLoadLogging","WAWebPushNotificationsOfflineBbApi","WAWebRegistration","WAWebSchemaVersions","WAWebSignalStorage","WAWebSocketModel","WAWebStartBackend","WAWebStatusStorage","WAWebUserPrefsGeneral","WAWebUserPrefsIsLoggedIn","WAWebUserPrefsMultiDevice","WAWebWaitForInitialChatsSynced","WAWebWamEnumWebcScenarioType","WAWebWamMemoryStat","WAWebWamOfflineResumeReporter","WAWebWorkerStorage","asyncToGeneratorRuntime","err","gkx","requireDeferred"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g=r("requireDeferred")("WAWebSetFrontendHandlerApi").__setRef("WAWebLaunchSocket"),h=r("requireDeferred")("WAWebSetWorkerSafeHandlerApi").__setRef("WAWebLaunchSocket");o("WAWebCmd").Cmd.on("md_refresh_qr",function(){o("WAComms").stopComms(),y()}),o("WAWebCmd").Cmd.on("reconnect_socket",function(){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["reconnect_socket triggered, resetting socket loop"]))),o("WAComms").closeSocketAndResume()});function y(){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("WAWebCommsConfig").getCommsConfig(void 0);return o("WAComms").startComms(r("WAWebCommsHandleStanza"),e,function(e){return(f||(f=n("Promise"))).resolve(o("WAGzip").inflate(e))}),yield o("WAComms").waitForConnection(),o("WAComms").startHandlingRequests()}),C.apply(this,arguments)}function b(e){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[socket] start launchSocket flow with mutexComplete promise ",""])),e==null?"NULL":"not null"),r("gkx")("26258")||(e!=null?o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[socket] entered eager launchSocket flow"]))).sendLogs("intern-launchSocket-eager",{sampling:0}):o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[socket] entered legacy launchSocket flow"]))).sendLogs("intern-launchSocket-legacy",{sampling:0})),o("WAWebPageLoadLogging").startPageLoadQplMeasure("launchSocket");var t=o("WAWebBridgeInitialization").makeBridge();return o("WAWebBackendApi").setApi(t),g.load().then(function(e){var n=e.setFrontendHandlers;return n(t)}),h.load().then(function(e){var n=e.setWorkerSafeHandlers;return n(t)}),o("WAWebFtsClient").ftsClient.initialize(),o("WAWebDbRolloutUtil").loadSchemaVersions().then(function(){return v()}).then(function(){return o("WAWebCryptoEncKeyHelper").initEncSalt()}).then(function(){return o("WAWebCryptoEncKeyHelper").initEncSaltForInvoker()}).then(function(){return o("WAWebSignalStorage").initialize()}).then(function(){return(f||(f=n("Promise"))).all([o("WAWebModelStorage").initialize(),e]).then(function(){return o("WAWebModelStorageInit").migrateMDUserPrefsToIndexedDB()})}).then(function(){return o("WAWebStatusStorage").initialize()}).then(function(){return(f||(f=n("Promise"))).all([o("WAWebUserPrefsGeneral").getLogoutReason(),o("WAWebWorkerStorage").initialize(),o("WAWebUserPrefsGeneral").setAppVersionBase(o("WAWebBuildConstants").VERSION_BASE)])}).catch(function(e){o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[socket] storageInitializationError triggered logout: ","."])),(e==null?void 0:e.message)||(e==null?void 0:e.name)).tags("launch-socket"),o("WAWebCmd").Cmd.storageInitializationError()}).then(function(e){var t=e==null?void 0:e[0];if(t&&(r("WAWebEnvironment").isWindows&&o("WAWebCurrentUser").isEmployee()?o("WAWebCmd").Cmd.unexpectedLogoutModal(t.reason):o("WAWebSocketModel").Socket.logout(t.reason)),r("WAWebBrokerGlobalAppState").isLogoutInProgress)throw r("err")("aborting launchSocket due to logout");return o("WAWebUserPrefsMultiDevice").isRegistered()?(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[socket] launchSocket for login"]))),o("WAWebUserPrefsIsLoggedIn").setIsConnectedAsRegistered(!0),o("WAWebCmd").Cmd.initialLoadReady(),o("WAWebWamMemoryStat").setCurrentMemoryScenario(o("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.OFFLINE_RESUME),o("WAWebModelStorage").initialize().catch(function(){return o("WAWebCmd").Cmd.storageInitializationError()}).then(function(){return(f||(f=n("Promise"))).all([o("WAWebABPropsUpdateFromStorage").updateABPropsFromStorage(),o("WAWebEventSamplingCache").updateEventSamplingFromStorage()])}).then(function(){o("WAWebCmd").Cmd.abPropsLoaded(),o("WAWebInitFromStorage").restoreImportantMetaData()}).then(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=function(){return o("WAWebPageLoadLogging").startPageLoadQplMeasure("lidCacheWarmup"),o("WAWebApiContact").warmUpAllLidPnMappings().then(function(e){return o("WAWebPageLoadLogging").endPageLoadQplMeasure("lidCacheWarmup")})};yield(f||(f=n("Promise"))).all([o("WAWebInitFromStorage").restoreBlocklist(),o("WAWebInitFromStorage").restoreOptOutList(),e()])})).then(function(){o("WAWebPushNotificationsOfflineBbApi").setStartCommsT(),o("WAWebPageLoadLogging").endPageLoadQplMeasure("launchSocket"),o("WAWebStartBackend").startBackend()})):(o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[socket] launchSocket for registration"]))),o("WAWebWamMemoryStat").setCurrentMemoryScenario(o("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.INITIAL_PAIRING),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.setIsInitialSync(),o("WAWebWaitForInitialChatsSynced").initWaitForInitialChatsSynced(),(f||(f=n("Promise"))).all([o("WAWebRegistration").refreshNoiseCredentials(),o("WAWebRegistration").refreshSignalCredentials()]).then(function(){o("WAWebPageLoadLogging").endPageLoadQplMeasure("launchSocket"),y()}))})}function v(){o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[storage] send schema versions to fts worker"]))),o("WAWebInvocationInterface").get().setSchemaVersions(o("WAWebSchemaVersions").getSchemaVersions())}l.launchSocket=b}),98);
__d("WAWebFeatureDetectionDetermineIncognito",["Promise","WACustomError","WAFilteredCatch","WALogger","WAPromiseTimeout","WAWebIndexedDB","WAWebLocalStorage","WAWebUA"],(function(t,n,r,o,a,i,l){var e,s;function u(){var t=new(s||(s=n("Promise")))(function(e){function t(){e(!1)}if(self.requestFileSystem)self.requestFileSystem(window.TEMPORARY,1,t,function(t){e(t.name==="SecurityError")});else if(r("WAWebIndexedDB")){var n=r("WAWebIndexedDB").open("pb_detect");n?(n.onsuccess=t,n.onerror=function(t){t.preventDefault(),window.InvalidStateError?e(t instanceof window.InvalidStateError):e(!0)}):t()}else o("WAWebUA").UA.isTrident?e(!0):t()}).then(function(e){if(e)return e;if(!r("WAWebLocalStorage"))return!1;try{return r("WAWebLocalStorage").setItem("INCOG","0"),r("WAWebLocalStorage").removeItem("INCOG"),!1}catch(e){if(e.name==="QuotaExceededError")return!0;throw e}});return o("WAPromiseTimeout").promiseTimeout(t,100,"detectIncognitoTimeout").catch(o("WAFilteredCatch").filteredCatch(o("WACustomError").TimeoutError,function(){return!1})).catch(function(t){return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["promiseUtil:determineIncognito failed check: ",""])),String(t)).devConsole(t).sendLogs("incog-throw"),!1})}l.default=u}),98);
__d("WAWebMediaArrayBufferCacheStore",["WAWebKeyValueCacheStore"],(function(t,n,r,o,a,i,l){var e={ignoreSearch:!0,ignoreMethod:!0,ignoreVary:!0},s=(function(t){function n(n){return t.call(this,n,u,c,{encodeKey:d,matchOptions:e})||this}return babelHelpers.inheritsLoose(n,t),n})(r("WAWebKeyValueCacheStore"));function u(e){return new Response(e)}function c(e){return e.arrayBuffer()}function d(e,t){var n=encodeURIComponent(e),r=encodeURIComponent(t);return"https://_media_cache_v2_.whatsapp.com/"+r+"_"+n}l.default=s}),98);
__d("WAWebLruMediaStorage",["WAWebLruMediaStorageUtils","once"],(function(t,n,r,o,a,i,l){var e=r("once")(function(){return o("WAWebLruMediaStorageUtils").getStorage().initialize()});l.initialize=e}),98);
__d("WAWebMediaLruIdbStoreUtils",["Promise","WAWebAbstractStore","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=(function(t){function r(e,n){var r;return r=t.call(this)||this,r.$IdbStore$p_1=e,r.$IdbStore$p_2=n,r}babelHelpers.inheritsLoose(r,t);var o=r.prototype;return o.doGet=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return yield this.$IdbStore$p_1(),this.$IdbStore$p_2.get(e)});function t(t){return e.apply(this,arguments)}return t})(),o.doQueryByIndex=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){return yield this.$IdbStore$p_1(),this.$IdbStore$p_2.all({limit:t.limit,index:[e]})});function t(t,n){return e.apply(this,arguments)}return t})(),o.doGetAll=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return yield this.$IdbStore$p_1(),this.$IdbStore$p_2.all()});function t(){return e.apply(this,arguments)}return t})(),o.doPut=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=this;return yield this.$IdbStore$p_1().then(function(){return n.$IdbStore$p_2.createOrReplace(t)}),t});function t(t,n){return e.apply(this,arguments)}return t})(),o.doDel=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return yield this.$IdbStore$p_1(),this.$IdbStore$p_2.remove(e)});function t(t){return e.apply(this,arguments)}return t})(),o.doCount=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return yield this.$IdbStore$p_1(),this.$IdbStore$p_2.count()});function t(){return e.apply(this,arguments)}return t})(),o.doClear=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return yield this.$IdbStore$p_1(),this.$IdbStore$p_2.clear(!0)});function t(){return e.apply(this,arguments)}return t})(),o.doOpen=function(){return this.$IdbStore$p_1()},o.doClose=function(){return(e||(e=n("Promise"))).resolve()},r})(r("WAWebAbstractStore"));l.default=s}),98);
__d("WAWebSchemaLruMediaArrayBuffer",["WAWebLruMediaStorageUtils","WAWebStorageMutationBuilder"],(function(t,n,r,o,a,i,l){var e="id",s="data",u="lru-media-array-buffer",c=o("WAWebStorageMutationBuilder").columnBuilder(),d=c.addColumn,m=c.addUserDefinedPrimaryKey;o("WAWebLruMediaStorageUtils").getStorage().add(u).version(o("WAWebLruMediaStorageUtils").getStorage().versions.version(0),[m(e),d(s)]).view(function(t){var n={id:t[e],data:t[s]};return n});var p=o("WAWebLruMediaStorageUtils").getStorage().table(u);l.IdbArrayBufferTable=p}),98);
__d("WAWebMediaArrayBufferIdbStore",["Promise","WAWebAbstractStore","WAWebLruMediaStorage","WAWebMediaLruIdbStoreUtils","WAWebSchemaLruMediaArrayBuffer","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s=(function(t){function a(e){var n;return n=t.call(this)||this,n.$ArrayBufferIdbStore$p_1=new(r("WAWebMediaLruIdbStoreUtils"))(o("WAWebLruMediaStorage").initialize,o("WAWebSchemaLruMediaArrayBuffer").IdbArrayBufferTable),n}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.doGet=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield this.$ArrayBufferIdbStore$p_1.get(e);return t?t.data:null});function t(t){return e.apply(this,arguments)}return t})(),i.doQueryByIndex=function(t,n){throw r("err")("Not implemented. Actual Arraybuffer store does not need it.")},i.doGetAll=function(){throw r("err")("Not implemented. Actual Arraybuffer store does not need it.")},i.doPut=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this.$ArrayBufferIdbStore$p_1.put(e,{id:e,data:t});return n.data});function t(t,n){return e.apply(this,arguments)}return t})(),i.doDel=function(t){return this.$ArrayBufferIdbStore$p_1.del(t)},i.doCount=function(){return this.$ArrayBufferIdbStore$p_1.count()},i.clear=function(){return this.$ArrayBufferIdbStore$p_1.clear()},i.doOpen=function(){return(e||(e=n("Promise"))).resolve()},i.doClose=function(){return(e||(e=n("Promise"))).resolve()},a})(r("WAWebAbstractStore"));l.default=s}),98);
__d("WAWebMediaStoreDummyImpl",["Promise","WAWebAbstractStore"],(function(t,n,r,o,a,i,l){var e,s=(function(t){function r(){return t.apply(this,arguments)||this}babelHelpers.inheritsLoose(r,t);var o=r.prototype;return o.get=function(r){return(e||(e=n("Promise"))).resolve()},o.queryByIndex=function(r,o){return(e||(e=n("Promise"))).resolve([])},o.getAll=function(){return(e||(e=n("Promise"))).resolve([])},o.put=function(r,o){return(e||(e=n("Promise"))).resolve(o)},o.del=function(r){return(e||(e=n("Promise"))).resolve()},o.count=function(){return(e||(e=n("Promise"))).resolve(0)},o.clear=function(){return(e||(e=n("Promise"))).resolve()},o.setMaxSize=function(r){return(e||(e=n("Promise"))).resolve()},r})(r("WAWebAbstractStore"));l.default=s}),98);
__d("WAWebSchemaLruMediaMetaInfo",["WAWebLruMediaStorageUtils","WAWebStorageMutationBuilder"],(function(t,n,r,o,a,i,l){var e,s="id",u="timestamp",c="size",d="lru-media-meta-info",m=o("WAWebStorageMutationBuilder").columnBuilder(),p=m.addColumn,_=m.addUserDefinedPrimaryKey,f=m.addIndex;(e=o("WAWebLruMediaStorageUtils")).getStorage().add(d).version(e.getStorage().versions.version(1),[_(s),p(u),f(u)]).version(e.getStorage().versions.version(2),[p(c)]).view(function(e){var t={id:e.id,timestamp:e.timestamp,size:e.size||0};return t});var g=e.getStorage().table(d);l.metaInfoPrimaryIndex=s,l.metaInfoDateIndex=u,l.metaInfoSizeIndex=c,l.IdbMetaInfoTable=g}),98);
__d("WAWebSizeLruObjectStore",["Promise","WALogger","WANullthrows","WAPromiseLoop","WAPromiseQueue","WAShiftTimer","WAWebAbstractStore","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p=(function(t){function a(a,i){var l;if(l=t.call(this)||this,l._queueMap=new(o("WAPromiseQueue")).PromiseQueueMap,l._purge=function(){if(l._pendingPurgePromise)return l._pendingPurgePromise;var t=l.open().then(function(){return o("WAPromiseLoop").promiseLoop((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=function(){l._pendingPurgePromise=null,t()},i=l.getCurrentSize();if(i==null||i<=l._maxSize){a();return}var s=yield l.queryOneByIndex(l._dateIndex),u=l.getCurrentSize(),c=l._maxSize;if(u==null||u<=c){a();return}if(s==null)return n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield l.count();o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["SizeLruObjectStore: _purge error: No row returned but currentSize (",") > maxSize (","). Row count is "," (may be out of date)."])),u,c,t).sendLogs("size-lru-store-invalid-empty")})(),(m||(m=n("Promise"))).reject(r("err")("Query returned no result but currentSize > maxSize"));var d=s[l._primaryIndex];return l.del(d)});return function(e){return t.apply(this,arguments)}})())});return l._pendingPurgePromise=t},l._schedulePurge=function(){l._purgeTimer.debounce(2e3)},l.doPut=function(e,t){return l._queueMap.enqueue(e,n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(t[l._primaryIndex]!==e)throw r("err")("The key you provide does not match.");var n=yield l._store.get(e),o=n==null?0:l._getSize(n),a=l._getSize(t),i=a-o,s=yield l._store.put(e,t);return l._currentSize=r("WANullthrows")(l.getCurrentSize())+i,l._schedulePurge(),s}))},l.doDel=function(e){return l._queueMap.enqueue(e,n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield l._store.get(e);if(t!=null){try{yield l._dispose(e,t)}catch(e){throw o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["SizeLRUObjectStore: _dispose error: ",""])),e.message).sendLogs("size-lru-store-dispose-error"),e}yield l._store.del(e),l._currentSize=r("WANullthrows")(l.getCurrentSize())-l._getSize(t)}}))},l._store=a,l._primaryIndex=i.primaryIndex,l._dateIndex=i.dateIndex,l._sizeIndex=i.sizeIndex,i.maxSize<0)throw r("err")("Cannot set max size to a negative number");return l._maxSize=Math.floor(i.maxSize),l._dispose=i.dispose,l._purgeTimer=new(o("WAShiftTimer")).ShiftTimer(function(){l._purge().catch(function(e){o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Error while purging: ",""])),e.message)})}),l}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.getCurrentSize=function(){return this._currentSize},i.getMaxSize=function(){return this._maxSize},i.setMaxSize=function(t){return t<0?(m||(m=n("Promise"))).reject(r("err")("Cannot set size to a negative number")):(this._maxSize=Math.floor(t),this._purgeTimer.cancel(),this._purge().catch(function(e){o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Error while purging during setMaxSize: ",""])),e.message)}))},i.putObject=function(t){var e=t[this._primaryIndex];return this.put(e,t)},i._getSize=function(t){var e=t[this._sizeIndex];return typeof e!="number"||e<0?(o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Invalid size in index ",": ",""])),this._sizeIndex,e),0):e},i.doGet=function(t){return this._store.get(t)},i.queryOneByIndex=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield this._store.queryByIndex(e,{limit:1});return t.length===0?null:t[0]});function t(t){return e.apply(this,arguments)}return t})(),i.doQueryByIndex=function(t,n){return this._store.queryByIndex(t,n)},i.doGetAll=function(){return this._store.getAll()},i.doClear=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){this._purgeTimer.cancel(),yield this._store.clear(),this._currentSize=0});function t(){return e.apply(this,arguments)}return t})(),i.doCount=function(){return this._store.count()},i.doOpen=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=this;if(yield this._store.open(),this._currentSize==null){var t=yield this._store.doGetAll();this._currentSize=t.reduce(function(t,n){return t+e._getSize(n)},0)}});function t(){return e.apply(this,arguments)}return t})(),i.doClose=function(){return this._currentSize=null,this._store.close()},a})(r("WAWebAbstractStore"));l.default=p}),98);
__d("WAWebMediaStoreMetaInfo",["WAWebLruMediaStorage","WAWebMediaLruIdbStoreUtils","WAWebSchemaLruMediaMetaInfo","WAWebSizeLruObjectStore"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(t,n){var a,i={primaryIndex:(a=o("WAWebSchemaLruMediaMetaInfo")).metaInfoPrimaryIndex,dateIndex:a.metaInfoDateIndex,sizeIndex:a.metaInfoSizeIndex,maxSize:t,dispose:n},l=new(r("WAWebMediaLruIdbStoreUtils"))(o("WAWebLruMediaStorage").initialize,a.IdbMetaInfoTable);return e.call(this,l,i)||this}return babelHelpers.inheritsLoose(t,e),t})(r("WAWebSizeLruObjectStore"));l.default=e}),98);
__d("WAWebMediaStoreLruImpl",["Promise","WALogger","WANullthrows","WAPromiseQueue","WAWeb-dexie","WAWebAbstractStore","WAWebMediaStoreMetaInfo","WAWebStorageErrorHandlingUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u=3e7,c=(function(t){function a(a){var i;i=t.call(this)||this,i._queueMap=new(o("WAPromiseQueue")).PromiseQueueMap,i.updateMaxSizeInterval=null,i._dispose=function(e,t){return i._bufferStore.del(e)},i.doPut=function(t,a){return i._queueMap.enqueue(t,n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(a.byteLength>i.getMaxSize()||a.byteLength>u)return a;var n={id:t,timestamp:new Date().getTime(),size:a.byteLength};try{return yield i._metaInfoStore.putObject(n),i._bufferStore.put(t,a)}catch(t){if(t instanceof r("WAWeb-dexie").AbortError&&t.message.includes("QuotaExceededError")){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["LruMediaStore: encounter QuotaExceededError, thus shrink the size of LruMediaStore"]))),i.setMaxSize(r("WANullthrows")(i.getCurrentSize())/2),o("WAWebStorageErrorHandlingUtils").reportQuotaExceededError(t,{op:"put",db:"lru-media-store",writeSize:a.byteLength});return}throw t}}))},i.doDel=function(e){return i._queueMap.enqueue(e,function(){return i._metaInfoStore.del(e)})};var l=a.maxSize,s=a.arrayBufferStore;return i._bufferStore=s,i._metaInfoStore=new(r("WAWebMediaStoreMetaInfo"))(l,i._dispose),i}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.doGet=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield this._bufferStore.get(e);return t!=null&&this.put(e,t),t});function t(t){return e.apply(this,arguments)}return t})(),i.doClear=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return yield this._bufferStore.clear(),this._metaInfoStore.clear()});function t(){return e.apply(this,arguments)}return t})(),i.doCount=function(){return this._metaInfoStore.count()},i.doOpen=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield(s||(s=n("Promise"))).all([this._metaInfoStore.open(),this._bufferStore.open()])});function t(){return e.apply(this,arguments)}return t})(),i.doClose=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield(s||(s=n("Promise"))).all([this._metaInfoStore.close(),this._bufferStore.close()])});function t(){return e.apply(this,arguments)}return t})(),i.getCurrentSize=function(){return this._metaInfoStore.getCurrentSize()},i.getMaxSize=function(){return this._metaInfoStore.getMaxSize()},i.setMaxSize=function(t){return this._metaInfoStore.setMaxSize(t)},i._calculateTargetedBufferSize=function(t){var e=Math.floor(t*.01);return e<1e8?1e8:e>5e8?5e8:e},i._clearStoreForThisSession=function(){this.setMaxSize(0),this.updateMaxSizeInterval&&(self.clearInterval(this.updateMaxSizeInterval),this.updateMaxSizeInterval=null)},a})(r("WAWebAbstractStore"));l.default=c}),98);
__d("WAWebSerializeError",["WAWebNormalizeStack"],(function(t,n,r,o,a,i,l){var e=["name","message","stack"];function s(t){var n=o("WAWebNormalizeStack").normalizeError(t),r=n.name,a=n.message,i=n.stack,l=babelHelpers.objectWithoutPropertiesLoose(n,e),s=o("WAWebNormalizeStack").normalizeStack(t,!0),u=Object.keys(l).length===0?"":" "+JSON.stringify(l,function(e,t){return e&&typeof t=="object"?String(t):t});return r+" - "+(a||"")+u+"\n"+s}l.default=s}),98);
__d("WAWebStoreQuotaManager",["WAStorageEstimator","WAWebABProps","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=1073741824,s=new Map([["lru-media-store",{getQuota:function(n){return n<=o("WAWebABProps").getABPropConfigValue("web_browser_quota_threshold")*e?Math.min(n*.2,o("WAWebABProps").getABPropConfigValue("web_browser_min_storage_quota")*e):.2*n}}]]),u=(function(){function e(e){this.$1=e}var t=e.prototype;return t.getQuotaForStore=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n,r=yield o("WAStorageEstimator").estimateStorage();if(!r.success)return 0;var a=r.value.quota;return Math.floor((t=(n=this.$1.get(e))==null?void 0:n.getQuota(a))!=null?t:0)});function t(t){return e.apply(this,arguments)}return t})(),e})(),c=new u(s);l.storeQuotaManager=c}),98);
__d("WAWebMediaStore",["WALogger","WAMemoizeConcurrent","WAWebIndexedDB","WAWebMediaArrayBufferCacheStore","WAWebMediaArrayBufferIdbStore","WAWebMediaStoreDummyImpl","WAWebMediaStoreLruImpl","WAWebMiscErrors","WAWebPromiseQueue","WAWebSerializeError","WAWebStoreQuotaManager","asyncToGeneratorRuntime","once"],(function(t,n,r,o,a,i,l){var e,s,u=new AbortController,c=(function(){function t(){var t=this;this._getBackingStore=r("once")(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var t=yield d();if(t!=null)return yield t.open(),t}catch(t){if(t.name==="SecurityError")o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["\n            There was a security error attempting to open the media storage.             This likely indicates a permissions error. Falling back to fake             (no-op) storage.\n          "],["\n            There was a security error attempting to open the media storage. \\\n            This likely indicates a permissions error. Falling back to fake \\\n            (no-op) storage.\n          "])));else{if(t instanceof o("WAWebMiscErrors").DbOnLogoutAbort)throw t;o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["\n            Failed to initialize media store! Falling back to fake (no-op) storage. Error:\n            ","\n          "])),r("WAWebSerializeError")(t)).verbose().devConsole(t).sendLogs("Failed to initialize media store")}}return new(r("WAWebMediaStoreDummyImpl"))})),this._promiseQueueHas=new(o("WAWebPromiseQueue")).PromiseQueue,this._memoizedConcurrentHas=r("WAMemoizeConcurrent")(function(e){return e.key},function(e){var n=e.key;return t._promiseQueueHas.enqueue(function(){return t.get(n).then(function(e){return e!=null})})})}var a=t.prototype;return a.setMaxSize=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield this._getBackingStore();return t.setMaxSize(e)});function t(t){return e.apply(this,arguments)}return t})(),a.get=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield this._getBackingStore();return t.get(e)});function t(t){return e.apply(this,arguments)}return t})(),a.has=function(t){return this._memoizedConcurrentHas({key:t,signal:u.signal})},a.queryByIndex=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this._getBackingStore();return n.queryByIndex(e,t)});function t(t,n){return e.apply(this,arguments)}return t})(),a.getAll=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield this._getBackingStore();return e.getAll()});function t(){return e.apply(this,arguments)}return t})(),a.put=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this._getBackingStore();return n.put(e,t)});function t(t,n){return e.apply(this,arguments)}return t})(),a.del=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield this._getBackingStore();yield t.del(e)});function t(t){return e.apply(this,arguments)}return t})(),a.count=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield this._getBackingStore();return e.count()});function t(){return e.apply(this,arguments)}return t})(),a.clear=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield this._getBackingStore();yield e.clear()});function t(){return e.apply(this,arguments)}return t})(),a.open=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield this._getBackingStore();yield e.open()});function t(){return e.apply(this,arguments)}return t})(),a.close=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield this._getBackingStore();yield e.close()});function t(){return e.apply(this,arguments)}return t})(),t})();function d(){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=p();if(e==null)return null;var t=yield o("WAWebStoreQuotaManager").storeQuotaManager.getQuotaForStore("lru-media-store");return new(r("WAWebMediaStoreLruImpl"))({maxSize:t,arrayBufferStore:e})}),m.apply(this,arguments)}function p(){if(r("WAWebIndexedDB")!=null){var e=new(r("WAWebMediaArrayBufferIdbStore"))("media_lru_buffer");return"caches"in self?new(r("WAWebMediaArrayBufferCacheStore"))("lru-media-array-buffer-cache"):e}return null}var _=new c;l.MediaStore=c,l.LruMediaStore=_}),98);
__d("WAWebUnpairDeviceJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebCommsWapMd","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=new(r("WADeprecatedWapParser"))("unpairResponse",function(e){e.assertTag("iq"),e.assertFromServer();var t=e.attrString("type"),n=200;return t==="error"&&(n=e.child("error").attrInt("code")),{status:n}});function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n,r=(n=o("WAWap")).wap("iq",{to:n.S_WHATSAPP_NET,type:"set",id:n.generateId(),xmlns:"md"},n.wap("remove-companion-device",{jid:o("WAWebCommsWapMd").DEVICE_JID(o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow()),reason:n.CUSTOM_STRING(t)})),a=yield o("WADeprecatedSendIq").deprecatedSendIq(r,e);return a.success?{status:a.result.status}:{status:a.errorCode}}),u.apply(this,arguments)}l.unpairDevice=s}),98);
__d("WAWebSocketModel",["Promise","WAComms","WALogger","WANullthrows","WAPromiseDelays","WAPromiseTimeout","WAWebABPropsCache","WAWebAddMeContactAction","WAWebBackgroundSyncAction","WAWebBaseModel","WAWebCmd","WAWebConnModel","WAWebCrashlog","WAWebCryptoEncKeyHelper","WAWebCryptoEncryptionSaltHelper","WAWebDeleteAllCacheStorage","WAWebEnvironment","WAWebFeatureDetectionDetermineIncognito","WAWebFtsClient","WAWebFtsStorage","WAWebInvocationInterface","WAWebJobsStorage","WAWebLocalStorage","WAWebLogoutReason","WAWebLogoutReasonConstants","WAWebLruMediaStorageUtils","WAWebMediaStore","WAWebMiscBrowserUtils","WAWebMiscErrors","WAWebModelStorage","WAWebNetworkStatus","WAWebOffdStorage","WAWebPonyfillsUrlSearchParams","WAWebQplStorage","WAWebSentinel","WAWebSignalStorage","WAWebSocketConstants","WAWebSubscribePushManagerAction","WAWebSyncBootstrap","WAWebSyncdGatingUtils","WAWebUnpairDeviceJob","WAWebUpdater","WAWebUserPrefsAppStateSync","WAWebUserPrefsClearLocalState","WAWebUserPrefsGeneral","WAWebUserPrefsKeys","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebUserPrefsStore","WAWebWorkerStorage","asyncToGeneratorRuntime","cr:10201","cr:17219","err","gkx","requireDeferred"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x,$,P,N,M,w,A,F,O,B,W,q,U,V,H,G,z=r("requireDeferred")("WAWebClearAppStates").__setRef("WAWebSocketModel"),j=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.socket=o("WAWebBaseModel").session(),e.launchGeneration=o("WAWebBaseModel").session(0),e.backoffGeneration=o("WAWebBaseModel").session(0),e.hasSynced=o("WAWebBaseModel").session(),e.state=o("WAWebBaseModel").session(o("WAWebSocketConstants").SOCKET_STATE.UNLAUNCHED),e.stream=o("WAWebBaseModel").session(o("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED),e.isIncognito=o("WAWebBaseModel").session(),e.retryTimestamp=o("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.initialize=function(){var t=this,a;this.clearAppStatesDeferred=z.load(),this.listenTo(this,"change:state",function(){return t.$SocketImpl$p_1()}),this.listenTo(this,"change:stream",function(){return t.$SocketImpl$p_2()}),o("WAPromiseDelays").delayMs(0).then(r("WAWebFeatureDetectionDetermineIncognito")).then(function(e){t.isIncognito=e}),this.listenTo((a=o("WAWebCmd")).Cmd,"log_socket_summary",function(){return t.summary()}),this.listenTo(a.Cmd,"set_socket_state",function(e){t.state=e}),this.listenTo(a.Cmd,"open_socket_stream",function(){r("WAWebNetworkStatus").online=!0,r("WAWebNetworkStatus").checkOnline(),t.openStream().catch(function(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[open socket stream] failed to open stream: ",""])),t).sendLogs("socket-model-failed-to-open-stream")}),t.hasSynced&&t.set({stream:o("WAWebSocketConstants").SOCKET_STREAM.CONNECTED})}),this.listenTo(a.Cmd,"socket_stream_disconnected",function(){t.set({stream:o("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED}),r("WAWebNetworkStatus").checkOnline()}),this.listenTo(a.Cmd,"on_critical_sync_done",function(){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[ws2] observed on_critical_sync_done"]))),t.$SocketImpl$p_3()}),this.listenTo(a.Cmd,"main_stream_mode_ready",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[ws2] observed main_stream_mode_ready"]))),!(yield o("WAWebUserPrefsAppStateSync").getAllCriticalDataSynced())){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[ws2] did not meet conditions to move to main screen"])));return}o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[ws2] moving to main screen from main_stream_mode_ready"]))),t.set({hasSynced:!0,stream:o("WAWebSocketConstants").SOCKET_STREAM.CONNECTED})})),this.listenTo(a.Cmd,"socket_stream_disconnected",function(){t.stream=o("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED})},i.reconnect=function(){o("WAWebCmd").Cmd.reconnectSocket()},i.takeover=function(){throw"Takeover called without conflict!"},i.$SocketImpl$p_4=function(){r("WAWebLocalStorage")==null||r("WAWebLocalStorage").setItem(o("WAWebUserPrefsKeys").KEYS.LOGOUT_DIRTY_BIT,"1")},i.$SocketImpl$p_5=function(){r("WAWebLocalStorage")==null||r("WAWebLocalStorage").removeItem(o("WAWebUserPrefsKeys").KEYS.LOGOUT_DIRTY_BIT)},i.$SocketImpl$p_6=function(){return(r("WAWebLocalStorage")==null?void 0:r("WAWebLocalStorage").getItem(o("WAWebUserPrefsKeys").KEYS.LOGOUT_DIRTY_BIT))==="1"},i.clearCredentialsAndStoredData=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(r("WAWebEnvironment").isWindows){var a,i=n("cr:17219")==null||(a=n("cr:17219").getWindowsBridge())==null?void 0:a.getClientKeyBridge();if(i!=null)try{yield o("WAPromiseTimeout").promiseTimeout(i.clearClientKey(),5e3)}catch(e){o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["clearCredentials: native logout failed - ",""])),e).tags("logout").sendLogs("native-clear-credentials-failed")}}var l=!1;if(e!=null&&[o("WAWebLogoutReasonConstants").LogoutReason.WebFailAddChat,o("WAWebLogoutReasonConstants").LogoutReason.WebFailEncSalt,o("WAWebLogoutReasonConstants").LogoutReason.WebFailOfflineResume,o("WAWebLogoutReasonConstants").LogoutReason.WebFailStorageInitialization].includes(e)&&(l=!0),this.$SocketImpl$p_4(),l=yield this.clearCredentials(),this.$SocketImpl$p_6()){l=!0;var s=o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["clearCredentials: dirty bit is still set"]))).tags("logout");r("gkx")("26258")||s.sendLogs("Logout clearCredentials failed")}o("WAWebSubscribePushManagerAction").unsubscribePushManager(),o("WAWebBackgroundSyncAction").updatePeriodicBackgroundSyncRegistration(!0),this.$SocketImpl$p_4();try{yield this.destroyStorage()}catch(e){l=!0,r("gkx")("26258")?o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["destroyStorage: failed with error ",""])),e).tags("logout"):o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["destroyStorage: failed with error ",""])),e).tags("logout").sendLogs("Logout destroyStorage failed")}o("WAWebABPropsCache").clearABPropConfigs(),l||this.$SocketImpl$p_5();var u=new(r("WAWebPonyfillsUrlSearchParams"));if(l&&r("WAWebMiscBrowserUtils").info().name!=="Firefox"&&u.set("post_logout","1"),e){var c=o("WAWebLogoutReason").getErrorCodeFromLogoutReason(e);if(c&&u.set("logout_reason",c),e===o("WAWebLogoutReasonConstants").LogoutReason.AccountLocked&&t!=null){var d=t.logoutMessageHeader,g=t.logoutMessageSubtext;d!=null&&u.set("logout_message_header",d),g!=null&&u.set("logout_message_subtext",g)}}var h=u.toString();h==null||h===""?window.location.reload():window.location.href=window.location.pathname+"?"+u.toString()});function t(t,n){return e.apply(this,arguments)}return t})(),i.destroyStorage=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=[o("WAWebModelStorage").destroy(),o("WAWebLruMediaStorageUtils").destroyStorage()];e.push(o("WAWebFtsStorage").destroy()),e.push(o("WAWebOffdStorage").destroy()),e.push(o("WAWebJobsStorage").destroy()),e.push(o("WAWebQplStorage").destroy()),e.push(o("WAWebFtsClient").ftsClient.clearInitializationPromises()),e.push(o("WAWebFtsClient").ftsClient.destroyExternalStorage()),e.push(o("WAWebWorkerStorage").destroy()),yield(G||(G=n("Promise"))).all(e)});function t(){return e.apply(this,arguments)}return t})(),i.logout=function(t){var e=this;if(t===void 0&&(t=o("WAWebLogoutReasonConstants").LogoutReason.UserInitiated),r("WAWebLocalStorage")==null||r("WAWebLocalStorage").removeItem("WebEncKeySalt"),r("WAWebLocalStorage")==null||r("WAWebLocalStorage").removeItem("WANoiseInfo"),o("WAWebInvocationInterface").get().setLogoutState(!0).catch(function(e){o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[socket model] failed to set logout state: ",""])),e).sendLogs("socket-model-set-logout-state-failed")}),o("WAWebCmd").Cmd.onStartingLogout(),!r("gkx")("26258"))try{throw r("err")("Non Error - WS2 logout, thrown only for getting logout stack trace")}catch(e){o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["WS2 logout debug: \n ",""],["WS2 logout debug: \\n ",""])),e.stack).verbose()}o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["ws2:user logged out"])));var a=(G||(G=n("Promise"))).resolve(),i=0,l=20,s=Math.min(l,Math.max(i,o("WAWebSyncdGatingUtils").getSyncdSentinelTimeoutSeconds()));a=o("WAPromiseTimeout").promiseTimeout(r("WAWebSentinel")(),s*1e3).catch(function(){return o("WALogger").WARN(C||(C=babelHelpers.taggedTemplateLiteralLoose(["ws2: multi-device logout did not manage to send sentinel patch"])))});var u=3;o("WAPromiseTimeout").promiseTimeout(a.then(function(){return e.sendCurrentLogout(t)}).catch((function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){o("WALogger").ERROR(b||(b=babelHelpers.taggedTemplateLiteralLoose(["ws2: [logout error] sendCurrentLogoutPromise errored with ",""])),n),yield e.clearCredentialsAndStoredData(t),o("WAWebCmd").Cmd.logout()});return function(e){return r.apply(this,arguments)}})()),u*1e3,"network request took more than "+u+" seconds").then(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield e.clearCredentialsAndStoredData(t),e.state===o("WAWebSocketConstants").SOCKET_STATE.OPENING&&e.trigger("change:state"),o("WAWebCmd").Cmd.logout()})).catch((function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){o("WALogger").ERROR(v||(v=babelHelpers.taggedTemplateLiteralLoose(["ws2: [logout error] sentinelPromise or sendCurrentLogoutPromise timed out with ",""])),n),yield e.clearCredentialsAndStoredData(t),o("WAWebCmd").Cmd.logout()});return function(e){return r.apply(this,arguments)}})()).finally(function(){o("WAWebInvocationInterface").get().setLogoutState(!1).catch(function(e){o("WALogger").ERROR(S||(S=babelHelpers.taggedTemplateLiteralLoose(["[socket model] failed to set logout state: ",""])),e).sendLogs("socket-model-set-logout-state-failed")})})},i.summary=function(){o("WALogger").LOG(R||(R=babelHelpers.taggedTemplateLiteralLoose(["ws:summary --------------------------------"]))),o("WALogger").LOG(L||(L=babelHelpers.taggedTemplateLiteralLoose(["ws state           ",""])),this.state),o("WALogger").LOG(E||(E=babelHelpers.taggedTemplateLiteralLoose(["wd online:         ",""])),String(navigator.onLine)),o("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["ws socket id:      ",""])),this.socket?this.socket.id:"n/a"),r("gkx")("26258")||r("WAWebSyncBootstrap").getCriticalSyncDebugSummary().then(function(e){o("WALogger").LOG(I||(I=babelHelpers.taggedTemplateLiteralLoose(["",""])),e)})},i.$SocketImpl$p_1=function(){o("WALogger").LOG(T||(T=babelHelpers.taggedTemplateLiteralLoose(["ws2:state change: ",""])),this.state)},i.$SocketImpl$p_2=function(){o("WALogger").LOG(D||(D=babelHelpers.taggedTemplateLiteralLoose(["ws2:stream change: ",""])),this.stream),this.stream===o("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED&&this.unset("resumePromise")},i.$SocketImpl$p_3=function(){o("WALogger").LOG(x||(x=babelHelpers.taggedTemplateLiteralLoose(["[ws2] moving to main screen from onCriticalSyncDone"]))),this.set({hasSynced:!0,stream:o("WAWebSocketConstants").SOCKET_STREAM.CONNECTED})},i.openStream=function(){var e=o("WAWebUserPrefsMeUser").getMePnUserOrThrow();if(e){var t;return(t=o("WAWebConnModel")).Conn.blockStoreAdds=!1,t.Conn.id="1",t.Conn.trigger("me_ready"),t.Conn.meReadyTriggered=!0,o("WAWebAddMeContactAction").addMeToContacts(e)}return(G||(G=n("Promise"))).resolve()},i.clearCredentials=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){r("WAWebUserPrefsStore").updatePreservedUserKeys();var e=!1;try{e=yield this.clearState()}catch(t){e=!0}try{o("WAWebUserPrefsGeneral").setBrowserId()}catch(t){e=!0,o("WALogger").ERROR($||($=babelHelpers.taggedTemplateLiteralLoose(["ws2:clearState error ",""])),t).tags("logout")}try{o("WAWebUserPrefsMeUser").setUnknownId()}catch(e){o("WALogger").ERROR(P||(P=babelHelpers.taggedTemplateLiteralLoose(["ws2:setUnknownId error ",""])),e).tags("logout")}try{o("WAWebUserPrefsMeUser").setMe()}catch(t){e=!0,o("WALogger").ERROR(N||(N=babelHelpers.taggedTemplateLiteralLoose(["ws2:setMe error ",""])),t).tags("logout")}try{yield o("WAWebUserPrefsMultiDevice").clearRegistrationInfo()}catch(t){e=!0,o("WALogger").ERROR(M||(M=babelHelpers.taggedTemplateLiteralLoose(["ws2:clearRegistrationInfo error ",""])),t).tags("logout")}try{yield o("WAWebSignalStorage").destroy()}catch(t){e=!0,o("WALogger").ERROR(w||(w=babelHelpers.taggedTemplateLiteralLoose(["ws2:destroySignal error ",""])),t).tags("logout")}try{yield o("WAWebCryptoEncKeyHelper").deleteEncKeysAndCache(),yield o("WAWebCryptoEncryptionSaltHelper").deleteSalt()}catch(t){e=!0}try{yield o("WAWebUserPrefsClearLocalState").clearAllLocalState()}catch(t){e=!0,o("WALogger").ERROR(A||(A=babelHelpers.taggedTemplateLiteralLoose(["ws2:clearAllLocalState error ",""])),t).tags("logout")}return e});function t(){return e.apply(this,arguments)}return t})(),i.clearState=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(F||(F=babelHelpers.taggedTemplateLiteralLoose(["ws2:clearState"])));var e=!1;this.unset("hasSynced");try{r("WANullthrows")(yield this.clearAppStatesDeferred)()}catch(t){e=!0,t instanceof o("WAWebMiscErrors").DbOnLogoutAbort?o("WALogger").WARN(O||(O=babelHelpers.taggedTemplateLiteralLoose(["ws2:clearState failed due to DB operations aborted: ",""])),t.stack):o("WALogger").ERROR(B||(B=babelHelpers.taggedTemplateLiteralLoose(["ws2:clearState error ",""])),t.stack).sendLogs("clear_session_app_state")}try{yield X()}catch(t){e=!0,t instanceof o("WAWebMiscErrors").DbOnLogoutAbort?o("WALogger").WARN(W||(W=babelHelpers.taggedTemplateLiteralLoose(["ws2:clearState failed due to DB operations aborted: ",""])),t.stack):o("WALogger").ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["ws2:clearState error ",""])),t.stack).sendLogs("clear_persistent_app_state")}return e});function t(){return e.apply(this,arguments)}return t})(),i.sendCurrentLogout=function(t){return o("WAWebUnpairDeviceJob").unpairDevice(t).then(function(e){e.status!==200&&o("WALogger").WARN(U||(U=babelHelpers.taggedTemplateLiteralLoose(["ws2:multi-device logout failed with error code ",""])),e.status),o("WAComms").stopComms()}).catch(function(e){o("WALogger").ERROR(V||(V=babelHelpers.taggedTemplateLiteralLoose(["[CRITICAL] unpairDevice failed with error, preoceed with local logout \n",""],["[CRITICAL] unpairDevice failed with error, preoceed with local logout \\n",""])),e.stack).verbose().devConsole(e)})},i.updateImmediately=function(t){o("WAWebCrashlog").upload({reason:t,immediate:!0}).finally(function(){o("WAWebUpdater").Updater.restart(!0).catch(function(e){o("WALogger").ERROR(H||(H=babelHelpers.taggedTemplateLiteralLoose(["[socket model] failed to restart updater: ",""])),e).sendLogs("socket-model-failed-to-restart-updater")})})},a})(o("WAWebBaseModel").BaseModel),K=o("WAWebBaseModel").defineModel(j),Q=new K;function X(){return Y.apply(this,arguments)}function Y(){return Y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield(G||(G=n("Promise"))).allSettled([r("WAWebDeleteAllCacheStorage")(),o("WAWebMediaStore").LruMediaStore.clear()]);e.forEach(function(e){if(e.status==="rejected")throw e.reason})}),Y.apply(this,arguments)}l.Socket=Q}),98);
__d("WAWebChatStateBridge",["WASendChatStateProtocol","WAWebWidToJid"],(function(t,n,r,o,a,i,l){function e(e){return o("WASendChatStateProtocol").sendChatStateProtocol(o("WAWebWidToJid").widToChatJid(e),"idle")}function s(e){return o("WASendChatStateProtocol").sendChatStateProtocol(o("WAWebWidToJid").widToChatJid(e),"recording_audio")}function u(e){return o("WASendChatStateProtocol").sendChatStateProtocol(o("WAWebWidToJid").widToChatJid(e),"typing")}l.sendChatStatePaused=e,l.sendChatStateRecording=s,l.sendChatStateComposing=u}),98);
__d("WAWebSendPresenceSubscriptionJob",["WASmaxPresenceSubscribeRPC","WAWebWidToJid"],(function(t,n,r,o,a,i,l){function e(e,t){var n;e.isUser()&&t!=null&&(n={privacyTokenContentsMixinArgs:{anyElementValue:new Uint8Array(t)}}),o("WASmaxPresenceSubscribeRPC").sendSubscribeRPC({presenceTo:o("WAWebWidToJid").widToChatJid(e),tCTokenMixinArgs:n})}l.default=e}),98);
__d("WAWebContactPresenceBridge",["Promise","WASendPresenceStatusProtocol","WAWebConnModel","WAWebSendPresenceSubscriptionJob","WAWebWid","WAWebWidFactory"],(function(t,n,r,o,a,i,l){var e;function s(){o("WASendPresenceStatusProtocol").sendPresenceStatusProtocol({status:"available",name:o("WAWebConnModel").Conn.pushname})}function u(){o("WASendPresenceStatusProtocol").sendPresenceStatusProtocol({status:"unavailable",name:o("WAWebConnModel").Conn.pushname})}function c(t,a){var i;return t instanceof r("WAWebWid")?i=t:i=o("WAWebWidFactory").createWid(t),(e||(e=n("Promise"))).resolve(r("WAWebSendPresenceSubscriptionJob")(i,a))}l.setPresenceAvailable=s,l.setPresenceUnavailable=u,l.subscribePresence=c}),98);
__d("WAWebPresenceChatAction",["WAFilteredCatch","WALogger","WAWebBackendErrors","WAWebChatGetters","WAWebChatStateBridge","WAWebContactPresenceBridge","WAWebLidMigrationUtils","WAWebStateUtils","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p=2500,_=1e4;function f(e){if(!(o("WAWebChatGetters").getIsNewsletter(e)||e.id.isBot()||o("WAWebChatGetters").getIsBroadcast(e)))return v(o("WAWebStateUtils").unproxy(e))}function g(e){if(!(o("WAWebChatGetters").getIsNewsletter(e)||e.id.isBot()))return S(o("WAWebStateUtils").unproxy(e))}function h(e){if(!(o("WAWebChatGetters").getIsNewsletter(e)||e.id.isBot()))return R(o("WAWebStateUtils").unproxy(e))}function y(){o("WAWebContactPresenceBridge").setPresenceAvailable()}function C(){o("WAWebContactPresenceBridge").setPresenceUnavailable()}function b(t){var n=o("WAWebLidMigrationUtils").shouldHaveAccountLid(t.id);if(n&&t.accountLid==null){var a="[presence] getChatIdentifier: lid-migrated client does not have an accountLid!";throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["",""])),a).sendLogs("lid-migrated-client-with-null-account-lid"),r("err")(a)}return n&&t.accountLid?t.accountLid:t.id}function v(e){if(!e.typing){var t=b(e);o("WAWebChatStateBridge").sendChatStateComposing(t).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").ServerStatusCodeError,function(e){e.status>=400&&o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["models:chat send presence composing error ",""])),t.toLogString())})),e.presenceResendTimerId=self.setTimeout(function(){return L(e)},_)}e.typing=!0,e.pausedTimerId&&self.clearTimeout(e.pausedTimerId),e.pausedTimerId=self.setTimeout(function(){return S(e)},p)}function S(e){if(e.typing||e.recording){var t=b(e);o("WAWebChatStateBridge").sendChatStatePaused(t).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").ServerStatusCodeError,function(e){e.status>=400&&o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["models:chat send presence paused error ",""])),t.toLogString())}))}e.presenceResendTimerId&&(self.clearTimeout(e.presenceResendTimerId),e.unset("presenceResendTimerId")),e.pausedTimerId&&(self.clearTimeout(e.pausedTimerId),e.unset("pausedTimerId")),e.typing=e.recording=!1}function R(e){if(!e.recording){var t=b(e);o("WAWebChatStateBridge").sendChatStateRecording(t).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").ServerStatusCodeError,function(e){e.status>=400&&o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["models:chat send presence recording error ",""])),t.toLogString())})),e.presenceResendTimerId=self.setTimeout(function(){return L(e)},_)}e.pausedTimerId&&(self.clearTimeout(e.pausedTimerId),e.unset("pausedTimerId")),e.recording=!0,e.typing=!1}function L(e){var t=e.id;if(e.recording)o("WAWebChatStateBridge").sendChatStateRecording(t).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").ServerStatusCodeError,function(e){e.status>=400&&o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["models:chat send presence resend recording error ",""])),t.toLogString())}));else if(e.typing)o("WAWebChatStateBridge").sendChatStateComposing(t).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").ServerStatusCodeError,function(e){e.status>=400&&o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["models:chat send presence resend composing error ",""])),t.toLogString())}));else{e.unset("presenceResendTimerId");return}e.presenceResendTimerId=self.setTimeout(function(){return L(e)},_)}function E(e){e.presence.isOnline?L(e):e.presenceResendTimerId&&(self.clearTimeout(e.presenceResendTimerId),e.unset("presenceResendTimerId"))}function k(e){e.presenceResendTimerId&&(self.clearTimeout(e.presenceResendTimerId),e.unset("presenceResendTimerId")),e.pausedTimerId&&(self.clearTimeout(e.pausedTimerId),e.unset("pausedTimerId")),e.typing=!1}l.markComposing=f,l.markPaused=g,l.markRecording=h,l.sendPresenceAvailable=y,l.sendPresenceUnavailable=C,l.getChatIdentifier=b,l.presenceOnlineChanged=E,l.clearPresence=k}),98);
__d("WAWebStreamModel",["$InternalEnum","WALogger","WAShiftTimer","WAWebABProps","WAWebBaseModel","WAWebBuildConstants","WAWebCallCollection","WAWebCmd","WAWebEnvironment","WAWebLockScreenResolver","WAWebNetworkStatus","WAWebPresenceChatAction","WAWebPresenceCollection","WAWebSocketConstants","WAWebSocketModel","WAWebUpdater","WAWebUserPrefsMultiDevice","WAWebUserPrefsScreenLock","WAWebWamEnumWebcStreamModeCode","WAWebWamPageLoadReporter","WAWebWebcPageResumeWamEvent","WAWebWebcStreamModeChangeWamEvent","asyncToGeneratorRuntime","cr:17219","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=(e=n("cr:17219"))!=null?e:{},m=d.getWindowsBridge,p=n("$InternalEnum").Mirrored(["OFFLINE","OPENING","PAIRING","SYNCING","RESUMING","CONNECTING","NORMAL"]),_=n("$InternalEnum").Mirrored(["QR","MAIN","SYNCING","OFFLINE","CONFLICT","PROXYBLOCK","TOS_BLOCK","SMB_TOS_BLOCK","DEPRECATED_VERSION"]),f=n("$InternalEnum").Mirrored(["SHOW","OBSCURE","HIDE"]),g=18e3,h=3e3,y=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.info=o("WAWebBaseModel").session(p.NORMAL),t.mode=o("WAWebBaseModel").session(_.SYNCING),t.obscurity=o("WAWebBaseModel").session(f.HIDE),t.needsUpdate=o("WAWebBaseModel").session(),t.clientExpired=o("WAWebBaseModel").session(!1),t.hardExpired=o("WAWebBaseModel").session(!1),t.lastSyncStart=o("WAWebBaseModel").session(E()),t.needsManualDownload=o("WAWebBaseModel").session(),t.couldForce=o("WAWebBaseModel").session(),t.uiActive=o("WAWebBaseModel").session(),t.isInConnectedCall=o("WAWebBaseModel").session(!1),t.available=o("WAWebBaseModel").session(!0),t.unavailableShiftTimer=o("WAWebBaseModel").session(),t.unavailableAutoLockTimer=o("WAWebBaseModel").session(),t.unavailableLogoutTimer=o("WAWebBaseModel").session(),t.unobscureShiftTimer=o("WAWebBaseModel").session(),t.resumeCount=o("WAWebBaseModel").session(0),t.phoneAuthed=o("WAWebBaseModel").session(!1),t.displayInfo=o("WAWebBaseModel").derived(function(){return L(this.info,this.obscurity)},["info","obscurity"]),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a.initialize=function(){var t=this;e.prototype.initialize.call(this),o("WAWebUserPrefsMultiDevice").isRegistered()||(this.mode=_.QR);var n=o("WAWebABProps").getABPropConfigValue("web_dau_overreporting_fix");window.document&&n&&(this.available=document.hasFocus()),this.unavailableShiftTimer=new(o("WAShiftTimer")).ShiftTimer(function(){return t.markUnavailable()}),this.unobscureShiftTimer=new(o("WAShiftTimer")).ShiftTimer(function(){return t.unobscure()}),this.unavailableAutoLockTimer=new(o("WAShiftTimer")).ShiftTimer(function(){o("WAWebUserPrefsScreenLock").getScreenLockDurationInSeconds()!==0&&(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Stream:autoLockShiftTimer auto lock due to inactivity"]))),o("WAWebLockScreenResolver").lockScreenAndTriggerUnlockFlow())}),this.listenTo(o("WAWebSocketModel").Socket,"change:state change:stream change:hasSynced",this.$StreamImpl$p_1),this.listenTo(r("WAWebNetworkStatus"),"change:online",this.$StreamImpl$p_1),this.listenTo(this,"change:available",this.$StreamImpl$p_2),this.listenTo(this,"change:phoneAuthed",this.$StreamImpl$p_3),this.listenTo(this,"change:info",this.logPageResume),this.listenTo(this,"change:info",this.updateWamLog),this.listenTo(this,"change:mode",this.logModeChange),this.listenTo(this,"change:available change:uiActive",this.updateCouldForce),this.listenTo(o("WAWebCmd").Cmd,"midnight",this.updateHardExpire),this.listenTo(o("WAWebCmd").Cmd,"serverUpdatedClientExpiration",this.updateHardExpire),this.listenTo(o("WAWebCmd").Cmd,"socket_stream_disconnected",function(){o("WAWebPresenceCollection").PresenceCollection.clearAllPresence()}),this.listenTo(r("WAWebCallCollection"),"change:isInConnectedCall",this.$StreamImpl$p_4),window.document&&document.addEventListener("visibilitychange",this.updateCouldForce),this.updateCouldForce(),this.updateHardExpire()},a.delete=function(){},a.markAvailable=function(){this.unavailableShiftTimer.cancel(),this.available=!0},a.markUnavailable=function(t){t!=null&&t!==0?this.unavailableShiftTimer.onOrBefore(t):(this.unavailableShiftTimer.cancel(),this.available=!1)},a.$StreamImpl$p_1=function(){var e=S(),t={info:e,mode:R(),phoneAuthed:o("WAWebSocketModel").Socket.stream!==o("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED};if(e===p.NORMAL)this.unobscureShiftTimer.cancel(),t.obscurity=f.HIDE;else if(e===p.OFFLINE)this.unobscureShiftTimer.cancel(),t.obscurity=f.OBSCURE;else switch(this.obscurity){case f.HIDE:this.unobscureShiftTimer.onOrBefore(g);break;case f.OBSCURE:this.unobscureShiftTimer.onOrBefore(h);break;case f.SHOW:break}this.set(t)},a.unobscure=function(){this.obscurity=f.SHOW},a.$StreamImpl$p_3=function(){this.phoneAuthed&&(r("WAWebEnvironment").isWindows?this.$StreamImpl$p_5():this.$StreamImpl$p_6())},a.$StreamImpl$p_6=function(){this.sendAvailability(!0)},a.$StreamImpl$p_5=function(){var e,t=m==null||(e=m())==null||(e=e.nativeAppStateBridge)==null?void 0:e.isMinimizedToTray();t!=null?t&&!this.isInConnectedCall?o("WAWebPresenceChatAction").sendPresenceUnavailable():this.sendAvailability(!1):this.sendAvailability(!0)},a.$StreamImpl$p_2=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=this.available;o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Stream:onAvailableUpdate user ",""])),e?"available":"unavailable");var t=o("WAWebUserPrefsScreenLock").getScreenLockDurationInSeconds();!e&&t!==0?this.unavailableAutoLockTimer.onOrBefore(t*1e3):this.unavailableAutoLockTimer.cancel(),this.sendAvailability(!1),e||o("WAWebPresenceCollection").PresenceCollection.clearAllPresence()});function t(){return e.apply(this,arguments)}return t})(),a.$StreamImpl$p_4=function(){this.isInConnectedCall=r("WAWebEnvironment").isWindows&&r("WAWebCallCollection").isInConnectedCall,this.sendAvailability(!0)},a.sendAvailability=function(t){(t||this.uiActive||this.isInConnectedCall)&&(this.available||this.isInConnectedCall?o("WAWebPresenceChatAction").sendPresenceAvailable():o("WAWebPresenceChatAction").sendPresenceUnavailable())},a.updateCouldForce=function(){this.couldForce=!this.uiActive||!this.available&&document.hidden},a.updateHardExpire=function(){o("WAWebUpdater").Updater.isExpired()&&(this.hardExpired=!0,o("WAWebUpdater").Updater.restart(!0))},a.logPageResume=function(){this.info===p.RESUMING&&(this.resumeCount++,new(o("WAWebWebcPageResumeWamEvent")).WebcPageResumeWamEvent({webcResumeCount:this.resumeCount}).commit())},a.updateWamLog=function(){var e=this.info===p.NORMAL;o("WAWebWamPageLoadReporter").streamInfoChange(this.info,1,e),e&&this.stopListening(this,"change:info",this.updateWamLog)},a.logModeChange=function(){this.mode===_.SYNCING&&(this.lastSyncStart=E()),new(o("WAWebWebcStreamModeChangeWamEvent")).WebcStreamModeChangeWamEvent({webcStreamMode:C(this.mode)}).commit()},t})(o("WAWebBaseModel").BaseModel);y.Proxy="stream";function C(e){switch(e){case _.QR:return o("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE.QR;case _.MAIN:return o("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE.MAIN;case _.SYNCING:return o("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE.SYNCING;case _.OFFLINE:return o("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE.OFFLINE;case _.CONFLICT:return o("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE.CONFLICT;case _.PROXYBLOCK:return o("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE.PROXYBLOCK;case _.DEPRECATED_VERSION:return o("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE.DEPRECATED_VERSION;case _.TOS_BLOCK:case _.SMB_TOS_BLOCK:return o("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE.TOS_BLOCK}}var b=o("WAWebBaseModel").defineModel(y),v=new b;function S(){var e=!1;if((e||r("gkx")("26256"))&&!r("WAWebNetworkStatus").online&&r("WAWebNetworkStatus").simulatedOfflineConditions)return p.OFFLINE;switch(o("WAWebSocketModel").Socket.state){case o("WAWebSocketConstants").SOCKET_STATE.OPENING:return r("WAWebNetworkStatus").online?p.OPENING:p.OFFLINE;case o("WAWebSocketConstants").SOCKET_STATE.PAIRING:return o("WAWebSocketModel").Socket.hasSynced?p.RESUMING:p.PAIRING;case o("WAWebSocketConstants").SOCKET_STATE.CONNECTED:return o("WAWebSocketModel").Socket.stream!==o("WAWebSocketConstants").SOCKET_STREAM.CONNECTED?o("WAWebSocketModel").Socket.hasSynced?p.NORMAL:p.SYNCING:p.NORMAL;case o("WAWebSocketConstants").SOCKET_STATE.UNLAUNCHED:case o("WAWebSocketConstants").SOCKET_STATE.PROXYBLOCK:default:return p.NORMAL}}function R(){var e=!1;if(e=o("WAWebUserPrefsMultiDevice").isRegistered(),!e&&o("WAWebSocketModel").Socket.state!==o("WAWebSocketConstants").SOCKET_STATE.PROXYBLOCK)return _.QR;var t=o("WAWebSocketModel").Socket.hasSynced;if(t&&e&&o("WAWebBuildConstants").WINDOWS_OFFLINE)return _.MAIN;switch(o("WAWebSocketModel").Socket.state){case o("WAWebSocketConstants").SOCKET_STATE.PROXYBLOCK:return _.PROXYBLOCK;case o("WAWebSocketConstants").SOCKET_STATE.CONFLICT:return _.CONFLICT;case o("WAWebSocketConstants").SOCKET_STATE.TOS_BLOCK:return _.TOS_BLOCK;case o("WAWebSocketConstants").SOCKET_STATE.SMB_TOS_BLOCK:return _.SMB_TOS_BLOCK;case o("WAWebSocketConstants").SOCKET_STATE.DEPRECATED_VERSION:return _.DEPRECATED_VERSION;case o("WAWebSocketConstants").SOCKET_STATE.UNLAUNCHED:return _.SYNCING;case o("WAWebSocketConstants").SOCKET_STATE.UNPAIRED_IDLE:case o("WAWebSocketConstants").SOCKET_STATE.UNPAIRED:return _.QR;case o("WAWebSocketConstants").SOCKET_STATE.OPENING:if(!r("WAWebNetworkStatus").online&&!o("WAWebSocketModel").Socket.hasSynced)return _.OFFLINE;default:return t||o("WAWebSocketModel").Socket.stream===o("WAWebSocketConstants").SOCKET_STREAM.CONNECTED?_.MAIN:_.SYNCING}}function L(e,t){switch(t){case f.SHOW:return e;case f.HIDE:return o("WAWebSocketModel").Socket.hasSynced?p.NORMAL:p.CONNECTING;case f.OBSCURE:switch(e){case p.OPENING:case p.PAIRING:case p.SYNCING:case p.RESUMING:return p.CONNECTING;default:return e}}return o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Stream:unknown obscure level:"]))).devConsole(t),e}function E(){return Math.floor(window.performance.now())}l.StreamInfo=p,l.StreamMode=_,l.Stream=v}),98);
__d("WAWebMessagePluginGenerateProtobuf",["WAWebMessagePluginGenerateProtobufRegistry","WAWebPluginCreateRegistryLookup"],(function(t,n,r,o,a,i,l){var e=o("WAWebPluginCreateRegistryLookup").createMsgTypeRegistryLookup(r("WAWebMessagePluginGenerateProtobufRegistry"));function s(t){var n,r=t.json;return(n=e(r.type,r.subtype))==null||n.generateProtobuf==null?void 0:n.generateProtobuf(t)}l.generateProtobuf=s}),98);
__d("WAWebEventsGenerateEventCreationMessageProto",[],(function(t,n,r,o,a,i){function e(e){var t,n=e.contextInfo,r=e.json,o={description:r.eventDescription,isCanceled:r.isEventCanceled,location:r.eventLocation,name:r.eventName,startTime:r.eventStartTime,endTime:r.eventEndTime,joinLink:r.eventJoinLink,contextInfo:n!=null?n:void 0,isScheduleCall:(t=r.eventIsScheduledCall)!=null?t:void 0};return{eventMessage:o}}i.default=e}),66);
__d("WAWebEventsGenerateEventEditMessageProto",["WAWebE2EProtoUtils","WAWebProtobufsE2E.pb"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n={targetMessageKey:o("WAWebE2EProtoUtils").encodeKey(t.targetMessageKey),encIv:t.encIv,encPayload:t.encPayload,secretEncType:o("WAWebProtobufsE2E.pb").Message$SecretEncryptedMessage$SecretEncType.EVENT_EDIT};return{secretEncryptedMessage:n}}l.default=e}),98);
__d("WAWebEventsGenerateEventResponseMessageProto",["WAWebE2EProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n={eventCreationMessageKey:o("WAWebE2EProtoUtils").encodeKey(t.targetMessageKey),encPayload:t.encPayload,encIv:t.encIv};return{encEventResponseMessage:n}}l.default=e}),98);
__d("WAWebGenerateBizContentPlaceholderProto",["err"],(function(t,n,r,o,a,i,l){function e(e){throw r("err")("Not supported")}l.default=e}),98);
__d("WAWebGenerateBotFeedbackProtocolMessageProto",["WAWebBotTypes","WAWebE2EProtoUtils","WAWebProtobufsAICommon.pb","WAWebProtobufsE2E.pb"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n;switch(t.botFeedbackKind){case o("WAWebBotTypes").BotFeedbackKind.POSITIVE:n=o("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_POSITIVE;break;case o("WAWebBotTypes").BotFeedbackKind.NEGATIVE_GENERIC:n=o("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_GENERIC;break;case o("WAWebBotTypes").BotFeedbackKind.NEGATIVE_HELPFUL:n=o("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_HELPFUL;break;case o("WAWebBotTypes").BotFeedbackKind.NEGATIVE_INTERESTING:n=o("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_INTERESTING;break;case o("WAWebBotTypes").BotFeedbackKind.NEGATIVE_ACCURATE:n=o("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_ACCURATE;break;case o("WAWebBotTypes").BotFeedbackKind.NEGATIVE_SAFE:n=o("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_SAFE;break;case o("WAWebBotTypes").BotFeedbackKind.NEGATIVE_OTHER:n=o("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_OTHER;break;case o("WAWebBotTypes").BotFeedbackKind.NEGATIVE_REFUSED:n=o("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_REFUSED;break;case o("WAWebBotTypes").BotFeedbackKind.NEGATIVE_NOT_VISUALLY_APPEALING:n=o("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_NOT_VISUALLY_APPEALING;break;case o("WAWebBotTypes").BotFeedbackKind.NEGATIVE_NOT_RELEVANT_TO_TEXT:n=o("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_TEXT;break}var r={messageKey:o("WAWebE2EProtoUtils").encodeKey(t.protocolMessageKey),kind:n,text:t.botFeedbackText},a={type:o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.BOT_FEEDBACK_MESSAGE,botFeedbackMessage:r};return{protocolMessage:a}}l.default=e}),98);
__d("WAWebGenerateBotRequestWelcomeMessageProto",["WAWebProtobufsE2E.pb"],(function(t,n,r,o,a,i,l){function e(e){return{protocolMessage:{type:o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REQUEST_WELCOME_MESSAGE}}}l.default=e}),98);
__d("WAWebGenerateButtonsResponseMessageProto",[],(function(t,n,r,o,a,i){function e(e){var t=e.json,n=e.contextInfo;return{buttonsResponseMessage:babelHelpers.extends({},t.buttonsResponse,{contextInfo:n})}}i.default=e}),66);
__d("WAWebGenerateCancelPaymentMessageProto",["err"],(function(t,n,r,o,a,i,l){function e(e){throw r("err")("Not supported")}l.default=e}),98);
__d("WAWebGenerateExtendedTextMessageProtoUtils",["WATypeUtils","WAWebE2EProtoUtils","WAWebGroupType","WAWebProtobufsE2E.pb"],(function(t,n,r,o,a,i,l){function e(e){switch(e){case o("WAWebGroupType").GroupType.COMMUNITY:return o("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$InviteLinkGroupType.PARENT;case o("WAWebGroupType").GroupType.LINKED_SUBGROUP:return o("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$InviteLinkGroupType.SUB;case o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP:return o("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$InviteLinkGroupType.DEFAULT_SUB;default:return o("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$InviteLinkGroupType.DEFAULT}}function s(t){var n=t.json,r=t.contextInfo,a=n.faviconMMSMetadata!=null;return{extendedTextMessage:{text:n.body,matchedText:n.matchedText,description:n.description,title:n.title,jpegThumbnail:o("WAWebE2EProtoUtils").encodeBytes(n.thumbnail),previewType:n.richPreviewType,contextInfo:r,mediaKey:o("WAWebE2EProtoUtils").encodeBytes(n.mediaKey),mediaKeyTimestamp:o("WATypeUtils").isNumber(n.mediaKeyTimestamp)?n.mediaKeyTimestamp:void 0,thumbnailDirectPath:n.thumbnailDirectPath,thumbnailSha256:o("WAWebE2EProtoUtils").encodeBytes(n.thumbnailSha256),thumbnailEncSha256:o("WAWebE2EProtoUtils").encodeBytes(n.thumbnailEncSha256),thumbnailHeight:n.thumbnailHeight,thumbnailWidth:n.thumbnailWidth,inviteLinkGroupTypeV2:e(n.inviteGrpType),backgroundArgb:n.backgroundColor,paymentLinkMetadata:n.paymentLinkMetadata,faviconMMSMetadata:a?{mediaKey:o("WAWebE2EProtoUtils").encodeBytes(n.faviconMMSMetadata.mediaKey),mediaKeyTimestamp:o("WATypeUtils").isNumber(n.faviconMMSMetadata.mediaKeyTimestamp)?n.faviconMMSMetadata.mediaKeyTimestamp:void 0,thumbnailDirectPath:n.faviconMMSMetadata.thumbnailDirectPath,thumbnailSha256:o("WAWebE2EProtoUtils").encodeBytes(n.faviconMMSMetadata.thumbnailSha256),thumbnailEncSha256:o("WAWebE2EProtoUtils").encodeBytes(n.faviconMMSMetadata.thumbnailEncSha256)}:void 0}}}l.default=s}),98);
__d("WAWebGenerateExtendedTextUrlChatMessageProto",["WAWebGenerateExtendedTextMessageProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n=e.contextInfo;return r("WAWebGenerateExtendedTextMessageProtoUtils")({json:t,contextInfo:n})}l.default=e}),98);
__d("WAWebGenerateChatMessageProto",["WAWebGenerateExtendedTextUrlChatMessageProto"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n=e.contextInfo;return t.quotedMsg||t.quotedRemoteJid||Array.isArray(t.mentionedJidList)&&t.mentionedJidList.length>0||Array.isArray(t.groupMentions)&&t.groupMentions.length>0||t.conversionTuple||t.isForwarded||t.forwardingScore||t._isPaymentNoteMsg||t.ephemeralDuration||t.ephemeralSettingTimestamp||t.ctwaContext||t.backgroundColor||n!=null&&n.utm||(n==null?void 0:n.isQuestion)===!0||n!=null&&n.questionReplyQuotedMessage||t.paymentLinkMetadata||(n==null?void 0:n.nonJidMentions)!=null&&n.nonJidMentions>0?r("WAWebGenerateExtendedTextUrlChatMessageProto")({json:t,contextInfo:n}):{conversation:t.body}}l.default=e}),98);
__d("WAWebGenerateDeclinePaymentMessageProto",["err"],(function(t,n,r,o,a,i,l){function e(e){throw r("err")("Not supported")}l.default=e}),98);
__d("WAWebGenerateDocumentMessageProto",["WATypeUtils","WAWebE2EProtoUtils","WAWebMsgType","WAWebWid"],(function(t,n,r,o,a,i,l){function e(e){var t=e.contextInfo,n=e.json,a=e.mediaMetadata,i=a===void 0?{}:a,l=n.mimetype||i.mimetype,s=void 0,u=void 0;n.type!==o("WAWebMsgType").MSG_TYPE.INTERACTIVE&&(u=n.caption,s=i.filename);var c={url:i.url,mimetype:l,title:s,caption:u,directPath:i.directPath,fileSha256:o("WAWebE2EProtoUtils").encodeBytes(i.filehash),fileEncSha256:o("WAWebE2EProtoUtils").encodeBytes(i.encFilehash),fileName:i.filename,fileLength:o("WATypeUtils").isNumber(n.size)?n.size:void 0,mediaKey:o("WAWebE2EProtoUtils").encodeBytes(i.mediaKey),mediaKeyTimestamp:o("WATypeUtils").isNumber(i.mediaKeyTimestamp)?i.mediaKeyTimestamp:void 0,jpegThumbnail:o("WAWebE2EProtoUtils").encodeBytes(n.body),contextInfo:t,contactVcard:n.isVcardOverMmsDocument,thumbnailDirectPath:i.thumbnailDirectPath,thumbnailSha256:o("WAWebE2EProtoUtils").encodeBytes(i.thumbnailSha256),thumbnailEncSha256:o("WAWebE2EProtoUtils").encodeBytes(i.thumbnailEncSha256),thumbnailHeight:i.thumbnailHeight,thumbnailWidth:i.thumbnailWidth};return Number.isFinite(n.pageCount)&&!Number.isNaN(n.pageCount)&&(c.pageCount=n.pageCount),o("WAWebE2EProtoUtils").validateOutgoingRequiredMediaProperties(n.type,c,r("WAWebWid").isNewsletter(n.to)),{documentMessage:c}}l.default=e}),98);
__d("WAWebGenerateEncCommentMessageProto",["WAWebE2EProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json;return{encCommentMessage:{targetMessageKey:o("WAWebE2EProtoUtils").encodeKey(t.targetMessageKey),encIv:t.encIv,encPayload:t.encPayload}}}l.default=e}),98);
__d("WAWebGenerateEphemeralSyncResponseMessageProto",["WAWebE2EProtoUtils","WAWebProtobufsE2E.pb"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n={type:o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.EPHEMERAL_SYNC_RESPONSE,ephemeralExpiration:t.ephemeralDuration,ephemeralSettingTimestamp:t.ephemeralSettingTimestamp,disappearingMode:o("WAWebE2EProtoUtils").disappearingModeInitiatorToProto(t.disappearingModeInitiator,t.disappearingModeTrigger,t.disappearingModeInitiatedByMe)};return{protocolMessage:n}}l.default=e}),98);
__d("WAWebGenerateGroupInviteMessageProto",["WAWebE2EProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n=e.contextInfo;return{groupInviteMessage:{inviteCode:t.inviteCode,inviteExpiration:parseInt(t.inviteCodeExp,10),groupJid:t.inviteGrp,groupName:t.inviteGrpName,caption:t.comment,jpegThumbnail:o("WAWebE2EProtoUtils").encodeBytes(t.inviteGrpJpegThum),contextInfo:n}}}l.default=e}),98);
__d("WAWebGenerateHsmMessageProto",["err"],(function(t,n,r,o,a,i,l){function e(e){throw r("err")("Not supported")}l.default=e}),98);
__d("WAWebGenerateImageMessageProto",["WATypeUtils","WAWebE2EProtoUtils","WAWebMediaGatingUtils","WAWebWid","err"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n=e.mediaMetadata,a=e.contextInfo;if(n==null)throw r("err")("generateImageMessageProto: generating image protobuf without mediaMetadata");var i=t.mimetype||n.mimetype,l={};r("WAWebWid").isStatus(t.to)&&(l={thumbnailDirectPath:n.thumbnailDirectPath,thumbnailSha256:o("WAWebE2EProtoUtils").encodeBytes(n.thumbnailSha256),thumbnailEncSha256:o("WAWebE2EProtoUtils").encodeBytes(n.thumbnailEncSha256)}),o("WAWebMediaGatingUtils").isThumbnailGenerationForMsgOnServerEnabled(t)&&(l={thumbnailDirectPath:n.thumbnailDirectPath,thumbnailSha256:o("WAWebE2EProtoUtils").encodeBytes(n.thumbnailSha256)});var s=babelHelpers.extends({url:n.url,mimetype:i,caption:t.caption,directPath:n.directPath,fileSha256:o("WAWebE2EProtoUtils").encodeBytes(n.filehash),fileEncSha256:o("WAWebE2EProtoUtils").encodeBytes(n.encFilehash),height:n.height,width:n.width,fileLength:o("WATypeUtils").isNumber(t.size)?t.size:void 0,mediaKey:o("WAWebE2EProtoUtils").encodeBytes(n.mediaKey),mediaKeyTimestamp:o("WATypeUtils").isNumber(n.mediaKeyTimestamp)?n.mediaKeyTimestamp:void 0,jpegThumbnail:t.isViewOnce?void 0:o("WAWebE2EProtoUtils").encodeBytes(t.body),contextInfo:a,viewOnce:t.isViewOnce},l);return o("WAWebE2EProtoUtils").validateOutgoingRequiredMediaProperties(t.type,s,r("WAWebWid").isNewsletter(t.to)),{imageMessage:s}}l.default=e}),98);
__d("WAWebGenerateVideoMessageProto",["WATypeUtils","WAWebE2EProtoUtils","WAWebMediaGatingUtils","WAWebMsgType","WAWebWid"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n=e.mediaMetadata,a=e.contextInfo,i=n==null?void 0:n.duration,l=i!=null&&o("WATypeUtils").isString(i)?parseInt(i,10):i,s=t.caption,u=t.mimetype||(n==null?void 0:n.mimetype),c={};o("WAWebMediaGatingUtils").isThumbnailGenerationForMsgOnServerEnabled(t)&&(c={thumbnailDirectPath:n==null?void 0:n.thumbnailDirectPath,thumbnailSha256:o("WAWebE2EProtoUtils").encodeBytes(n==null?void 0:n.thumbnailSha256)});var d=babelHelpers.extends({url:n==null?void 0:n.url,mimetype:u,directPath:n==null?void 0:n.directPath,fileSha256:o("WAWebE2EProtoUtils").encodeBytes(n==null?void 0:n.filehash),fileEncSha256:o("WAWebE2EProtoUtils").encodeBytes(n==null?void 0:n.encFilehash),height:n==null?void 0:n.height,width:n==null?void 0:n.width,seconds:l,caption:s,fileLength:o("WATypeUtils").isNumber(t.size)?t.size:void 0,mediaKey:o("WAWebE2EProtoUtils").encodeBytes(n==null?void 0:n.mediaKey),mediaKeyTimestamp:o("WATypeUtils").isNumber(n==null?void 0:n.mediaKeyTimestamp)?n.mediaKeyTimestamp:void 0,jpegThumbnail:t.isViewOnce?void 0:o("WAWebE2EProtoUtils").encodeBytes(t.body),gifPlayback:t.isGif,gifAttribution:t.gifAttribution,accessibilityLabel:t.accessibilityLabel,contextInfo:a,streamingSidecar:t.streamingSidecar,viewOnce:t.isViewOnce,metadataUrl:(n==null?void 0:n.metadataUrl)!=null&&o("WAWebMediaGatingUtils").isChannelVideoServerTranscodeUploadEnabled()?n.metadataUrl:void 0},c);return o("WAWebE2EProtoUtils").validateOutgoingRequiredMediaProperties(t.type,d,r("WAWebWid").isNewsletter(t.to)),t.type===o("WAWebMsgType").MSG_TYPE.PTV?{ptvMessage:d}:{videoMessage:d}}l.default=e}),98);
__d("WAWebGenerateInteractiveMessageProto",["WAWebE2EProtoUtils","WAWebGenerateDocumentMessageProto","WAWebGenerateImageMessageProto","WAWebGenerateVideoMessageProto","WAWebInteractiveMessageHeaderMediaType","WAWebInteractiveMessagesNativeFlowName"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n=e.mediaMetadata,a=e.contextInfo,i;if(t.interactiveHeader){if(i={title:t.interactiveHeader.title,subtitle:t.interactiveHeader.subtitle,hasMediaAttachment:t.interactiveHeader.hasMediaAttachment},t.interactiveHeader.thumbnail)i=babelHelpers.extends({},i,{jpegThumbnail:o("WAWebE2EProtoUtils").encodeBytes(t.interactiveHeader.thumbnail)});else if(t.interactiveHeader.mediaType)switch(t.interactiveHeader.mediaType){case o("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.VIDEO:{var l=r("WAWebGenerateVideoMessageProto")({json:t,mediaMetadata:n,contextInfo:a}).videoMessage;i=babelHelpers.extends({},i,{videoMessage:babelHelpers.extends({},l,{caption:void 0})});break}case o("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.DOCUMENT:i=babelHelpers.extends({},i,{documentMessage:r("WAWebGenerateDocumentMessageProto")({json:t,mediaMetadata:n,contextInfo:a}).documentMessage});break;case o("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.IMAGE:i=babelHelpers.extends({},i,{imageMessage:r("WAWebGenerateImageMessageProto")({json:t,mediaMetadata:n,contextInfo:a}).imageMessage});break}}var s=babelHelpers.extends({body:t.caption||t.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS?{text:t.caption}:void 0,footer:t.footer?{text:t.footer}:void 0,header:i},a&&{contextInfo:a}),u=o("WAWebE2EProtoUtils").getInteractiveMessageFieldNameForType(t.interactiveType);return u&&(s[u]=t.interactivePayload),{interactiveMessage:s}}l.default=e}),98);
__d("WAWebGenerateInteractiveResponseMessageProto",["WAWebABProps","WAWebE2EProtoUtils","WAWebInteractiveMessagesNativeFlowName","WAWebProtobufsE2E.pb"],(function(t,n,r,o,a,i,l){var e=["type"],s=["type","buttonParamsJson"],u=["flow_token","flow_message_version","wa_flow_response_params"];function c(t){var n,a=t.json,i=t.contextInfo,l=a.interactivePayload,s=l.type,u=babelHelpers.objectWithoutPropertiesLoose(l,e),c=o("WAWebE2EProtoUtils").getInteractiveResponseMessageFieldNameForType(s),m=u.name===String(r("WAWebInteractiveMessagesNativeFlowName").CTA_FLOW)&&o("WAWebABProps").getABPropConfigValue("flows_wa_web");if(m)return d({json:a,contextInfo:i});var p=(n={body:{text:a.body}},n[c]=u,n.contextInfo=i,n);return{interactiveResponseMessage:p}}function d(e){var t,n=e.json,r=e.contextInfo,a=n.interactivePayload,i=a.type,l=a.buttonParamsJson,c=babelHelpers.objectWithoutPropertiesLoose(a,s),d=o("WAWebE2EProtoUtils").getInteractiveResponseMessageFieldNameForType(i),m=JSON.parse(l),p=m.flow_token,_=m.flow_message_version,f=m.wa_flow_response_params,g=babelHelpers.objectWithoutPropertiesLoose(m,u),h=(t={body:{text:n.body,format:o("WAWebProtobufsE2E.pb").Message$InteractiveResponseMessage$Body$Format.EXTENSIONS_1}},t[d]=babelHelpers.extends({},c,{paramsJson:JSON.stringify(babelHelpers.extends({},g,{flow_token:p,wa_flow_response_params:f})),version:f!=null?3:2}),t.contextInfo=r,t);return{interactiveResponseMessage:h}}l.default=c}),98);
__d("WAWebGenerateKeepInChatMessageProto",["WAWebE2EProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json;return{keepInChatMessage:{key:o("WAWebE2EProtoUtils").encodeKey(t.keptMessageKey),keepType:t.keepType,timestampMs:t.senderTimestampMs}}}l.default=e}),98);
__d("WAWebGenerateListMessageProto",[],(function(t,n,r,o,a,i){function e(e){var t=e.json,n=e.contextInfo;return{listMessage:babelHelpers.extends({},t.list,{contextInfo:n})}}i.default=e}),66);
__d("WAWebGenerateListResponseMessageProto",[],(function(t,n,r,o,a,i){function e(e){var t=e.json,n=e.contextInfo;return{listResponseMessage:babelHelpers.extends({},t.listResponse,{contextInfo:n})}}i.default=e}),66);
__d("WAWebGenerateLocationMessageProto",["WATypeUtils","WAWebE2EProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n=e.contextInfo,r={};if(t.loc&&o("WATypeUtils").isString(t.loc)){var a=t.loc.split("\n");r={name:a[0],address:a[1],url:t.clientUrl}}return{locationMessage:babelHelpers.extends({},r,{degreesLatitude:parseFloat(t.lat)||void 0,degreesLongitude:parseFloat(t.lng)||void 0,jpegThumbnail:o("WAWebE2EProtoUtils").encodeBytes(t.body),contextInfo:n})}}l.default=e}),98);
__d("WAWebGenerateMessageHistoryBundleProto",["WAWebE2EProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t,n,r,a=e.json,i=e.mediaMetadata;return{messageHistoryBundle:{directPath:i==null?void 0:i.directPath,fileSha256:o("WAWebE2EProtoUtils").encodeBytes(i==null?void 0:i.filehash),fileEncSha256:o("WAWebE2EProtoUtils").encodeBytes(i==null?void 0:i.encFilehash),mediaKey:o("WAWebE2EProtoUtils").encodeBytes(i==null?void 0:i.mediaKey),mediaKeyTimestamp:i==null?void 0:i.mediaKeyTimestamp,messageHistoryMetadata:{messageCount:(t=a.groupHistoryBundleMetadata)==null?void 0:t.messageCount,oldestMessageTimestamp:(n=a.groupHistoryBundleMetadata)==null?void 0:n.oldestMessageTimestamp,historyReceivers:(r=a.groupHistoryBundleMetadata)==null?void 0:r.historyReceivers},mimetype:a.mimetype||(i==null?void 0:i.mimetype)}}}l.default=e}),98);
__d("WAWebGenerateMultiVcardMessageProto",[],(function(t,n,r,o,a,i){function e(e){var t=e.json,n=e.contextInfo;return{contactsArrayMessage:{contacts:t.vcardList.map(function(e){return e}),contextInfo:n}}}i.default=e}),66);
__d("WAWebGenerateNativeFlowButtonsMessageProto",["WAWebButtonsMessageProtoUtils","WAWebGenerateImageMessageProto","WAWebProtobufsE2E.pb"],(function(t,n,r,o,a,i,l){function e(e){var t=e.message,n=e.json,a=e.mediaMetadata,i=e.contextInfo,l=babelHelpers.extends({},t);if(n.headerType===o("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.IMAGE){var s=r("WAWebGenerateImageMessageProto")({json:n,mediaMetadata:a,contextInfo:void 0}),u=s.imageMessage;l=babelHelpers.extends({},l,{imageMessage:u})}return l=o("WAWebButtonsMessageProtoUtils").createDynamicReplyButtonsMessage(l,n,i),l.buttonsMessage=babelHelpers.extends({},l.buttonsMessage,{buttons:n.nativeFlowButtons}),l}l.default=e}),98);
__d("WAWebGenerateNewsletterAdminInviteMessageProto",["WAWebE2EProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n=e.contextInfo,r=t.newsletterAdminInviteInfo,a=r.newsletterId,i=r.newsletterName,l=r.inviteExpiration,s=r.inviteMessage,u=r.pictureThumbnail;return{newsletterAdminInviteMessage:{newsletterJid:o("WAWebE2EProtoUtils").encodeJid(a),newsletterName:i,caption:s,inviteExpiration:l,jpegThumbnail:o("WAWebE2EProtoUtils").encodeBytes(u),contextInfo:n}}}l.default=e}),98);
__d("WAWebGenerateNewsletterFollowerInviteMessageProto",["WAWebE2EProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n=e.contextInfo,r=t.newsletterFollowerInviteInfo,a=r.newsletterId,i=r.newsletterName,l=r.inviteMessage,s=r.pictureThumbnail;return{newsletterFollowerInviteMessageV2:{newsletterJid:o("WAWebE2EProtoUtils").encodeJid(a),newsletterName:i,caption:l,jpegThumbnail:o("WAWebE2EProtoUtils").encodeBytes(s),contextInfo:n}}}l.default=e}),98);
__d("WAWebGenerateOrderMessageProto",["WAWebE2EProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json;return t.itemCount||t.message||t.orderId||t.orderTitle||t.sellerJid||t.status||t.surface||t.thumbnail||t.token||t.totalAmount1000||t.totalCurrencyCode||t.catalogType?{orderMessage:{itemCount:t.itemCount,message:t.message,orderId:t.orderId,orderTitle:t.orderTitle,sellerJid:t.sellerJid,status:t.status,surface:t.surface,thumbnail:o("WAWebE2EProtoUtils").encodeBytes(t.thumbnail),token:t.token,totalAmount1000:t.totalAmount1000,totalCurrencyCode:t.totalCurrencyCode,catalogType:t.catalogType}}:{conversation:t.body}}l.default=e}),98);
__d("WAWebGeneratePaymentInviteMessageProto",["err"],(function(t,n,r,o,a,i,l){function e(e){throw r("err")("Not supported")}l.default=e}),98);
__d("WAWebGeneratePinMessageProto",["WAWebE2EProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json;return{pinInChatMessage:{key:o("WAWebE2EProtoUtils").encodeKey(t.pinParentKey),type:t.pinMessageType,senderTimestampMs:t.pinSenderTimestampMs},messageContextInfo:{messageAddOnDurationInSecs:t.pinExpiryDuration}}}l.default=e}),98);
__d("WAWebGeneratePollResultSnapshotMessageProto",[],(function(t,n,r,o,a,i){"use strict";function e(e){var t=e.msgContext,n=e.contextInfo,r=e.json,o=r.pollName;if(t==="quoted")return{pollResultSnapshotMessage:{name:o,pollVotes:[],contextInfo:n}};var a=r.pollVotesSnapshot,i=a.pollVotes.map(function(e){var t=e.option,n=e.optionVoteCount;return{optionName:t.name,optionVoteCount:n}});return{pollResultSnapshotMessage:{name:o,pollVotes:i,contextInfo:n}}}i.default=e}),66);
__d("WAWebGenerateProductMessageProto",["WAWebGenerateImageMessageProto"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n=e.mediaMetadata,o=e.contextInfo,a;n!=null&&(a=r("WAWebGenerateImageMessageProto")({json:t,mediaMetadata:n,contextInfo:o}).imageMessage);var i={product:{productImage:a,productId:t.productId,title:t.title,description:t.description,currencyCode:t.currencyCode,priceAmount1000:t.priceAmount1000||void 0,salePriceAmount1000:t.salePriceAmount1000||void 0,retailerId:t.retailerId,url:t.url,productImageCount:t.productImageCount},businessOwnerJid:t.businessOwnerJid,contextInfo:o,body:t.caption,footer:t.footer};return{productMessage:i}}l.default=e}),98);
__d("WAWebGenerateProtocolEphemeralSettingMessageProto",["WAWebE2EProtoUtils","WAWebProtobufsE2E.pb"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json;return{protocolMessage:{type:o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.EPHEMERAL_SETTING,ephemeralExpiration:t.ephemeralDuration,disappearingMode:o("WAWebE2EProtoUtils").disappearingModeInitiatorToProto(t.disappearingModeInitiator,t.disappearingModeTrigger,t.disappearingModeInitiatedByMe)}}}l.default=e}),98);
__d("WAWebGenerateProtocolHistorySyncNotificationMessageProto",["err"],(function(t,n,r,o,a,i,l){function e(e){throw r("err")("generateProtocolHistorySyncNotificationMessageProto: Not supported")}l.default=e}),98);
__d("WAWebGenerateProtocolLimitSharingMessageProto",["WAWebProtobufsE2E.pb"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n=t.limitSharing?{trigger:t.limitSharing.trigger,sharingLimited:t.limitSharing.sharingLimited,limitSharingSettingTimestamp:t.limitSharing.limitSharingSettingTimestamp,initiatedByMe:!0}:void 0;return{limitSharingMessage:{message:{protocolMessage:{type:o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.LIMIT_SHARING,limitSharing:n}}}}}l.default=e}),98);
__d("WAWebGenerateProtocolMemberLabelMessageProto",["WAWebProtobufsE2E.pb","err"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n=t.memberLabelData;if(n==null)throw r("err")("Missing memberLabelData for member label message");return{protocolMessage:{type:o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.GROUP_MEMBER_LABEL_CHANGE,memberLabel:{label:n.label,labelTimestamp:n.labelTimestamp}}}}l.default=e}),98);
__d("WAWebGenerateProtocolRevokeMessageProto",["WAWebE2EProtoUtils","WAWebProtobufsE2E.pb","WAWebWid"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json;return babelHelpers.extends({protocolMessage:{key:o("WAWebE2EProtoUtils").encodeKey(t.protocolMessageKey),type:o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REVOKE}},t.botTargetSenderJid instanceof r("WAWebWid")?{messageContextInfo:{botMetadata:{invokerJid:t.botTargetSenderJid.toJid()}}}:{})}l.default=e}),98);
__d("WAWebGenerateProtocolSharePhoneNumberMessageProto",["WAWebProtobufsE2E.pb"],(function(t,n,r,o,a,i,l){function e(e){return{protocolMessage:{type:o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.SHARE_PHONE_NUMBER}}}l.default=e}),98);
__d("WAWebGenerateReactionEncMessageProto",["WAWebE2EProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json;return{encReactionMessage:{targetMessageKey:o("WAWebE2EProtoUtils").encodeKey(t.targetMessageKey),encIv:t.encIv,encPayload:t.encPayload}}}l.default=e}),98);
__d("WAWebGenerateRequestPhoneNumberMessageProto",[],(function(t,n,r,o,a,i){function e(e){var t=e.contextInfo;return{requestPhoneNumberMessage:{contextInfo:t}}}i.default=e}),66);
__d("WAWebGenerateStickerPackMessageProto",["WAWebE2EProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n=e.mediaMetadata,r=n===void 0?{}:n;return{stickerPackMessage:{stickerPackId:t.stickerPackId,name:t.filename,publisher:t.stickerPackPublisher,fileSha256:o("WAWebE2EProtoUtils").encodeBytes(r.filehash),fileEncSha256:o("WAWebE2EProtoUtils").encodeBytes(r.encFilehash),mediaKey:o("WAWebE2EProtoUtils").encodeBytes(r.mediaKey),directPath:t.directPath,caption:t.caption,packDescription:t.description,thumbnailSha256:o("WAWebE2EProtoUtils").encodeBytes(r.thumbnailSha256),thumbnailEncSha256:o("WAWebE2EProtoUtils").encodeBytes(r.thumbnailEncSha256),thumbnailDirectPath:t.thumbnailDirectPath,stickers:t.stickers,fileLength:t.size,trayIconFileName:t.trayIconFileName,stickerPackSize:t.stickerPackSize}}}l.default=e}),98);
__d("WAWebGenerateTemplateButtonReplyMessageProto",[],(function(t,n,r,o,a,i){function e(e){var t=e.json,n=e.contextInfo;return{templateButtonReplyMessage:{selectedId:t.selectedId,selectedIndex:t.selectedIndex,selectedCarouselCardIndex:t.selectedCarouselCardIndex,selectedDisplayText:t.body,contextInfo:n}}}i.default=e}),66);
__d("WAWebGenerateVcardMessageProto",[],(function(t,n,r,o,a,i){function e(e){var t=e.json,n=e.contextInfo;return{contactMessage:{displayName:t.vcardFormattedName,vcard:t.body,contextInfo:n}}}i.default=e}),66);
__d("WAWebPollsProtoUtils",["WALogger","WAWebProtobufsE2E.pb"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c;function d(t){var n=t.pollContentType,r=t.options;if(n===o("WAWebProtobufsE2E.pb").Message$PollContentType.IMAGE){if(r==null){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Missing options in pollCreationMessage"]))).sendLogs("missing-options-in-pollCreationMessage");return}var a=r.some(function(e){var t=e.optionHash;return t==null||t===""});a&&o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Outgoing photo poll with missing option hashes"]))).devConsole(r).sendLogs("outgoing-photo-poll-missing-option-hashes")}}function m(e){var t=e.pollType,n=e.correctAnswer;if(t===o("WAWebProtobufsE2E.pb").Message$PollType.QUIZ){if(n==null){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Missing correctAnswer in pollCreationMessage"]))).sendLogs("missing-correctAnswer-in-pollCreationMessage");return}}else if(n){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["correctAnswer present in pollCreationMessage"]))).sendLogs("invalid-correctAnswer-in-pollCreationMessage");return}}l.validatePhotoPollCreationMessage=d,l.validatePollCreationMessage=m}),98);
__d("WAWebPollsGeneratePollCreationMessageProto",["WAWebPollCreationUtils","WAWebPollsProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.msgContext,n=e.contextInfo,r=e.json,a=r.pollContentType===o("WAWebPollCreationUtils").PollContentType.IMAGE,i=t==="quoted"?{name:r.pollName,options:[]}:{name:r.pollName,options:r.pollOptions.map(function(e){var t=e.name,n=e.hash;return a?{optionName:t,optionHash:n}:{optionName:t}}),selectableOptionsCount:r.pollSelectableOptionsCount,pollContentType:o("WAWebPollCreationUtils").getPollContentTypeAsE2EValue(r.pollContentType),pollType:o("WAWebPollCreationUtils").getPollTypeAsE2EValue(r.pollType),correctAnswer:r.correctOptionIndex!=null?{optionName:r.pollOptions[r.correctOptionIndex].name,optionHash:r.pollOptions[r.correctOptionIndex].hash}:void 0};return n!=null&&(i.contextInfo=n),o("WAWebPollsProtoUtils").validatePollCreationMessage(i),a&&o("WAWebPollsProtoUtils").validatePhotoPollCreationMessage(i),r.isSentCagPollCreation?{pollCreationMessageV2:i}:r.pollSelectableOptionsCount===1||r.pollContentType===o("WAWebPollCreationUtils").PollContentType.IMAGE?{pollCreationMessageV3:i}:{pollCreationMessage:i}}l.default=e}),98);
__d("WAWebPollsGeneratePollVoteMessageProto",["WAWebE2EProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n={pollCreationMessageKey:o("WAWebE2EProtoUtils").encodeKey(t.pollUpdateParentKey),vote:t.encPollVote,senderTimestampMs:t.senderTimestampMs};return{pollUpdateMessage:n}}l.default=e}),98);
__d("WAWebPttGenerateAudioOrPttMessageProto",["invariant","WALogger","WATypeUtils","WAWebAudioMessageProtoUtils","WAWebE2EProtoUtils","WAWebWid"],(function(t,n,r,o,a,i,l,s){var e;function u(t){var n=t.json,a=t.mediaMetadata,i=t.contextInfo;a||s(0,66891);var l=n.mimetype||a.mimetype,u=a.duration,c=n.waveform||a.waveform,d=u!=null&&o("WATypeUtils").isString(u)?parseInt(u,10):u,m={url:a.url,mimetype:l,directPath:a.directPath,fileSha256:o("WAWebE2EProtoUtils").encodeBytes(a.filehash),fileEncSha256:o("WAWebE2EProtoUtils").encodeBytes(a.encFilehash),seconds:d,ptt:n.type==="ptt",fileLength:o("WATypeUtils").isNumber(n.size)?n.size:void 0,mediaKey:o("WAWebE2EProtoUtils").encodeBytes(a.mediaKey),mediaKeyTimestamp:o("WATypeUtils").isNumber(a.mediaKeyTimestamp)?a.mediaKeyTimestamp:void 0,contextInfo:i,streamingSidecar:n.streamingSidecar,viewOnce:n.isViewOnce};return c&&(o("WAWebAudioMessageProtoUtils").validateWaveform(c)?m.waveform=c.buffer:o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Outgoing waveform with invalid size: ",""])),c.byteLength).sendLogs("outgoing-waveform-invalid-size")),o("WAWebE2EProtoUtils").validateOutgoingRequiredMediaProperties(n.type?"ptt":"audio",m,r("WAWebWid").isNewsletter(n.to)),{audioMessage:m}}l.default=u}),98);
__d("WAWebQuestionsGenerateQuestionResponseMessageProto",["WAWebE2EProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json;return{questionResponseMessage:{key:o("WAWebE2EProtoUtils").encodeKey(t.id),text:t.body}}}l.default=e}),98);
__d("WAWebReactionsGenerateReactionMessageProto",["WAWebE2EProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json;return{reactionMessage:{key:o("WAWebE2EProtoUtils").encodeKey(t.reactionParentKey),text:t.reactionText,senderTimestampMs:t.reactionTimestamp}}}l.default=e}),98);
__d("WAWebStickersGenerateStickerMessageProto",["invariant","WALogger","WATypeUtils","WAWebE2EProtoUtils","WAWebMsgType","WAWebStickerMimeUtils","WAWebWid","err"],(function(t,n,r,o,a,i,l,s){var e;function u(t){var n=t.contextInfo,a=t.json,i=t.mediaMetadata;if(i!=null||s(0,66810),i.mimetype!=null&&!o("WAWebStickerMimeUtils").getValidStickerMimeTypes().has(i.mimetype))throw o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["invalid sticker mimetype: ",""])),i.mimetype),r("err")("invalid sticker mimetype");var l={url:i.url,mimetype:i.mimetype,directPath:i.directPath,fileSha256:o("WAWebE2EProtoUtils").encodeBytes(i.filehash),fileEncSha256:o("WAWebE2EProtoUtils").encodeBytes(i.encFilehash),mediaKey:o("WAWebE2EProtoUtils").encodeBytes(i.mediaKey),mediaKeyTimestamp:o("WATypeUtils").isNumber(i.mediaKeyTimestamp)?i.mediaKeyTimestamp:void 0,fileLength:o("WATypeUtils").isNumber(a.size)?a.size:void 0,height:a.height,width:a.width,firstFrameLength:i.firstFrameLength,firstFrameSidecar:a.firstFrameSidecar||void 0,isAnimated:i.isAnimated,isLottie:i.isLottie,stickerSentTs:a.stickerSentTs,contextInfo:n};return o("WAWebE2EProtoUtils").validateOutgoingRequiredMediaProperties(o("WAWebMsgType").MSG_TYPE.STICKER,l,r("WAWebWid").isNewsletter(a.to)),{stickerMessage:l}}l.default=u}),98);
__d("WAWebMessagePluginGenerateProtobufRegistry",["WAWebEventsGenerateEventCreationMessageProto","WAWebEventsGenerateEventEditMessageProto","WAWebEventsGenerateEventResponseMessageProto","WAWebGenerateBizContentPlaceholderProto","WAWebGenerateBotFeedbackProtocolMessageProto","WAWebGenerateBotRequestWelcomeMessageProto","WAWebGenerateButtonsResponseMessageProto","WAWebGenerateCancelPaymentMessageProto","WAWebGenerateChatMessageProto","WAWebGenerateDeclinePaymentMessageProto","WAWebGenerateDocumentMessageProto","WAWebGenerateEncCommentMessageProto","WAWebGenerateEphemeralSyncResponseMessageProto","WAWebGenerateExtendedTextUrlChatMessageProto","WAWebGenerateGroupInviteMessageProto","WAWebGenerateHsmMessageProto","WAWebGenerateImageMessageProto","WAWebGenerateInteractiveMessageProto","WAWebGenerateInteractiveResponseMessageProto","WAWebGenerateKeepInChatMessageProto","WAWebGenerateListMessageProto","WAWebGenerateListResponseMessageProto","WAWebGenerateLocationMessageProto","WAWebGenerateMessageHistoryBundleProto","WAWebGenerateMultiVcardMessageProto","WAWebGenerateNativeFlowButtonsMessageProto","WAWebGenerateNewsletterAdminInviteMessageProto","WAWebGenerateNewsletterFollowerInviteMessageProto","WAWebGenerateOrderMessageProto","WAWebGeneratePaymentInviteMessageProto","WAWebGeneratePinMessageProto","WAWebGeneratePollResultSnapshotMessageProto","WAWebGenerateProductMessageProto","WAWebGenerateProtocolEphemeralSettingMessageProto","WAWebGenerateProtocolHistorySyncNotificationMessageProto","WAWebGenerateProtocolLimitSharingMessageProto","WAWebGenerateProtocolMemberLabelMessageProto","WAWebGenerateProtocolMessageEditProto","WAWebGenerateProtocolRevokeMessageProto","WAWebGenerateProtocolSharePhoneNumberMessageProto","WAWebGenerateReactionEncMessageProto","WAWebGenerateRequestPaymentMessageProto","WAWebGenerateRequestPhoneNumberMessageProto","WAWebGenerateSendPaymentMessageProto","WAWebGenerateStickerPackMessageProto","WAWebGenerateTemplateButtonReplyMessageProto","WAWebGenerateVcardMessageProto","WAWebGenerateVideoMessageProto","WAWebPollsGeneratePollCreationMessageProto","WAWebPollsGeneratePollVoteMessageProto","WAWebPttGenerateAudioOrPttMessageProto","WAWebQuestionsGenerateQuestionResponseMessageProto","WAWebReactionsGenerateReactionMessageProto","WAWebStickersGenerateStickerMessageProto"],(function(t,n,r,o,a,i,l){var e,s=[{type:"album",subtype:void 0,generateProtobuf:null},{type:"audio",subtype:void 0,generateProtobuf:r("WAWebPttGenerateAudioOrPttMessageProto")},{type:"biz_content_placeholder",subtype:void 0,generateProtobuf:r("WAWebGenerateBizContentPlaceholderProto")},{type:"buttons_response",subtype:void 0,generateProtobuf:r("WAWebGenerateButtonsResponseMessageProto")},{type:"chat",subtype:"url",generateProtobuf:r("WAWebGenerateExtendedTextUrlChatMessageProto")},{type:"chat",subtype:void 0,generateProtobuf:r("WAWebGenerateChatMessageProto")},{type:"ciphertext",subtype:"bot_unavailable_fanout",generateProtobuf:null},{type:"ciphertext",subtype:"fanout",generateProtobuf:null},{type:"ciphertext",subtype:"hosted_unavailable_fanout",generateProtobuf:null},{type:"ciphertext",subtype:"view_once_unavailable_fanout",generateProtobuf:null},{type:"ciphertext",subtype:void 0,generateProtobuf:null},{type:"comment",subtype:void 0,generateProtobuf:r("WAWebGenerateEncCommentMessageProto")},{type:"debug_placeholder",subtype:void 0,generateProtobuf:null},{type:"document",subtype:void 0,generateProtobuf:r("WAWebGenerateDocumentMessageProto")},{type:"event_creation",subtype:void 0,generateProtobuf:r("WAWebEventsGenerateEventCreationMessageProto")},{type:"event_edit_encrypted",subtype:void 0,generateProtobuf:r("WAWebEventsGenerateEventEditMessageProto")},{type:"event_response",subtype:void 0,generateProtobuf:r("WAWebEventsGenerateEventResponseMessageProto")},{type:"group-history",subtype:"message_history_bundle",generateProtobuf:r("WAWebGenerateMessageHistoryBundleProto")},{type:"groups_v4_invite",subtype:void 0,generateProtobuf:r("WAWebGenerateGroupInviteMessageProto")},{type:"hsm",subtype:void 0,generateProtobuf:r("WAWebGenerateHsmMessageProto")},{type:"image",subtype:void 0,generateProtobuf:r("WAWebGenerateImageMessageProto")},{type:"interactive",subtype:void 0,generateProtobuf:r("WAWebGenerateInteractiveMessageProto")},{type:"interactive_response",subtype:void 0,generateProtobuf:r("WAWebGenerateInteractiveResponseMessageProto")},{type:"keep_in_chat",subtype:void 0,generateProtobuf:r("WAWebGenerateKeepInChatMessageProto")},{type:"list",subtype:void 0,generateProtobuf:r("WAWebGenerateListMessageProto")},{type:"list_response",subtype:void 0,generateProtobuf:r("WAWebGenerateListResponseMessageProto")},{type:"location",subtype:void 0,generateProtobuf:r("WAWebGenerateLocationMessageProto")},{type:"message_edit_encrypted",subtype:"message_edit",generateProtobuf:null},{type:"multi_vcard",subtype:void 0,generateProtobuf:r("WAWebGenerateMultiVcardMessageProto")},{type:"native_flow",subtype:void 0,generateProtobuf:r("WAWebGenerateNativeFlowButtonsMessageProto")},{type:"newsletter_admin_invite",subtype:void 0,generateProtobuf:r("WAWebGenerateNewsletterAdminInviteMessageProto")},{type:"newsletter_follower_invite",subtype:void 0,generateProtobuf:r("WAWebGenerateNewsletterFollowerInviteMessageProto")},{type:"newsletter_question_response",subtype:void 0,generateProtobuf:r("WAWebQuestionsGenerateQuestionResponseMessageProto")},{type:"notification_template",subtype:"contact_info_card",generateProtobuf:null},{type:"order",subtype:void 0,generateProtobuf:r("WAWebGenerateOrderMessageProto")},{type:"payment",subtype:"ciphertext",generateProtobuf:null},{type:"payment",subtype:"futureproof",generateProtobuf:null},{type:"payment",subtype:"invite",generateProtobuf:r("WAWebGeneratePaymentInviteMessageProto")},{type:"payment",subtype:"request",generateProtobuf:r("WAWebGenerateRequestPaymentMessageProto")},{type:"payment",subtype:"send",generateProtobuf:r("WAWebGenerateSendPaymentMessageProto")},{type:"pin_message",subtype:void 0,generateProtobuf:r("WAWebGeneratePinMessageProto")},{type:"pinned_message",subtype:void 0,generateProtobuf:null},{type:"poll_creation",subtype:void 0,generateProtobuf:r("WAWebPollsGeneratePollCreationMessageProto")},{type:"poll_result_snapshot",subtype:void 0,generateProtobuf:r("WAWebGeneratePollResultSnapshotMessageProto")},{type:"poll_update",subtype:"poll_vote",generateProtobuf:r("WAWebPollsGeneratePollVoteMessageProto")},{type:"product",subtype:void 0,generateProtobuf:r("WAWebGenerateProductMessageProto")},{type:"protocol",subtype:"admin_revoke",generateProtobuf:e=r("WAWebGenerateProtocolRevokeMessageProto")},{type:"protocol",subtype:"bot_feedback",generateProtobuf:r("WAWebGenerateBotFeedbackProtocolMessageProto")},{type:"protocol",subtype:"bot_memu_onboarding",generateProtobuf:null},{type:"protocol",subtype:"bot_request_welcome",generateProtobuf:r("WAWebGenerateBotRequestWelcomeMessageProto")},{type:"protocol",subtype:"ephemeral_setting",generateProtobuf:r("WAWebGenerateProtocolEphemeralSettingMessageProto")},{type:"protocol",subtype:"ephemeral_sync_response",generateProtobuf:r("WAWebGenerateEphemeralSyncResponseMessageProto")},{type:"protocol",subtype:"event_edit_decrypted",generateProtobuf:null},{type:"protocol",subtype:"history_sync_notification",generateProtobuf:r("WAWebGenerateProtocolHistorySyncNotificationMessageProto")},{type:"protocol",subtype:"limit_sharing_system_message",generateProtobuf:r("WAWebGenerateProtocolLimitSharingMessageProto")},{type:"protocol",subtype:"member_label",generateProtobuf:r("WAWebGenerateProtocolMemberLabelMessageProto")},{type:"protocol",subtype:"message_edit",generateProtobuf:r("WAWebGenerateProtocolMessageEditProto")},{type:"protocol",subtype:"message_edit_decrypted",generateProtobuf:null},{type:"protocol",subtype:"message_history_notice",generateProtobuf:null},{type:"protocol",subtype:"sender_revoke",generateProtobuf:e},{type:"protocol",subtype:"share_phone_number",generateProtobuf:r("WAWebGenerateProtocolSharePhoneNumberMessageProto")},{type:"protocol",subtype:"status_group_mention_message",generateProtobuf:null},{type:"protocol",subtype:"status_mention_message",generateProtobuf:null},{type:"ptt",subtype:void 0,generateProtobuf:r("WAWebPttGenerateAudioOrPttMessageProto")},{type:"ptv",subtype:void 0,generateProtobuf:r("WAWebGenerateVideoMessageProto")},{type:"reaction",subtype:void 0,generateProtobuf:r("WAWebReactionsGenerateReactionMessageProto")},{type:"reaction_enc",subtype:void 0,generateProtobuf:r("WAWebGenerateReactionEncMessageProto")},{type:"request_phone_number",subtype:void 0,generateProtobuf:r("WAWebGenerateRequestPhoneNumberMessageProto")},{type:"revoked",subtype:"admin",generateProtobuf:e},{type:"revoked",subtype:"sender",generateProtobuf:e},{type:"rich_response",subtype:void 0,generateProtobuf:null},{type:"status_notification",subtype:"status_notification_message",generateProtobuf:null},{type:"sticker",subtype:void 0,generateProtobuf:r("WAWebStickersGenerateStickerMessageProto")},{type:"sticker-pack",subtype:void 0,generateProtobuf:r("WAWebGenerateStickerPackMessageProto")},{type:"template_button_reply",subtype:void 0,generateProtobuf:r("WAWebGenerateTemplateButtonReplyMessageProto")},{type:"unknown",subtype:"payment_action_request_declined",generateProtobuf:r("WAWebGenerateDeclinePaymentMessageProto")},{type:"unknown",subtype:"payment_transaction_request_cancelled",generateProtobuf:r("WAWebGenerateCancelPaymentMessageProto")},{type:"unknown",subtype:"phone",generateProtobuf:null},{type:"unknown",subtype:"phone_only_feature",generateProtobuf:null},{type:"unknown",subtype:void 0,generateProtobuf:null},{type:"vcard",subtype:void 0,generateProtobuf:r("WAWebGenerateVcardMessageProto")},{type:"video",subtype:void 0,generateProtobuf:r("WAWebGenerateVideoMessageProto")}];l.default=s}),98);
__d("WAWebFetchSubscriptionsQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="32114967328146495"}),null);
__d("WAWebFetchSubscriptionsQuery.graphql",["WAWebFetchSubscriptionsQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"data"}],t=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"data"}],concreteType:"XWAGetSubscriptionsResponse",kind:"LinkedField",name:"xwa_get_subscriptions",plural:!1,selections:[{alias:null,args:null,concreteType:"XWASubscriptionInfoType",kind:"LinkedField",name:"subscriptions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWASubscriptionFeatureFlagType",kind:"LinkedField",name:"feature_flags",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"enabled",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebFetchSubscriptionsQuery",selections:t,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebFetchSubscriptionsQuery",selections:t},params:{id:n("WAWebFetchSubscriptionsQuery_facebookRelayOperation"),metadata:{},name:"WAWebFetchSubscriptionsQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebFetchSubscriptions",["WACustomError","WALogger","WAPromiseTimeout","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebFetchSubscriptionsQuery.graphql","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c={type:"error"},d=e!==void 0?e:e=n("WAWebFetchSubscriptionsQuery.graphql");function m(){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield _();return e.type==="success"?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["fetchSubscriptions: success"]))),e):(e.type,o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(['fetchSubscriptions: failed as "','"'])),e.type),e)}),p.apply(this,arguments)}function _(){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var e=yield o("WAPromiseTimeout").promiseTimeout(o("WAWebFetchAdAccountToken").fetchToken(),o("WAWebBizGatingUtils").adAccountTokenNoncePushWaitTimeoutSeconds()*1e3);if(e.type==="success"){var t=yield g(e.token);return t.type!=="success"&&t.type==="auth-failure"?o("WAWebFetchAdAccountToken").markTokenAsInvalid():t.type,t}return e.type,e}catch(e){return e instanceof o("WACustomError").TimeoutError?{type:"timeout"}:{type:"error"}}}),f.apply(this,arguments)}function g(e){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n;yield r("WAWebNetworkStatus").waitIfOffline();var a=yield o("WAWebRelayClient").fetchQuery(d,{data:{platform:"UNKNOWN"}},{environmentType:"facebook",accessToken:e}).catch(function(e){if(o("WAWebFetchAdAccountToken").hasGraphQLAuthError(e))return{type:"auth-failure"};if(e instanceof o("WAWebGraphQLServerError").GraphQLServerError)return{type:"graphql-error",error:e}}),i=a==null||(t=a.xwa_get_subscriptions)==null?void 0:t.subscriptions,l=a==null||(n=a.xwa_get_subscriptions)==null?void 0:n.feature_flags;return i==null||l==null?c:{type:"success",subscriptions:i.map(function(e){var t,n,r,o,a;return{expirationDate:(t=e.end_time)!=null?t:null,id:(n=e.id)!=null?n:"",status:y(e.status),creationTime:(r=e.creation_time)!=null?r:null,newMessageCappingEnabled:(o=(a=l.find(function(e){return e.name==="NEW_CHATS_LIMIT"}))==null?void 0:a.enabled)!=null?o:!1}})}}),h.apply(this,arguments)}function y(e){if(e!=null){var t=e;switch(t){case"STATUS_ACTIVE":return"ACTIVE";case"STATUS_CANCELED":return"CANCELED";case"STATUS_DISCOUNT_TRIAL":return"DISCOUNT_TRIAL";case"STATUS_EXPIRED":return"EXPIRED";case"STATUS_FREE_TRIAL":return"FREE_TRIAL";case"STATUS_IN_GRACE_PERIOD":return"IN_GRACE_PERIOD";case"STATUS_ON_HOLD":return"ON_HOLD"}}}l.fetchSubscriptions=m}),98);
__d("WAWebUserPrefsSubscription",["$InternalEnum","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){var e=n("$InternalEnum").Mirrored(["NextSubscriptionQuery","ShouldShowMetaVerifiedEntryPoint","NextFetchSubscriptionEntryPointsTime","MetaVerifiedEntryPointRedirectionUri"]);function s(){var t;return(t=parseInt(r("WAWebUserPrefsStore").getUser(e.NextSubscriptionQuery),10))!=null?t:0}function u(t){r("WAWebUserPrefsStore").setUser(e.NextSubscriptionQuery,t)}function c(){var t=r("WAWebUserPrefsStore").getUser(e.ShouldShowMetaVerifiedEntryPoint);return t==null?null:t===!0}function d(t){r("WAWebUserPrefsStore").setUser(e.ShouldShowMetaVerifiedEntryPoint,t)}function m(){var t;return(t=parseInt(r("WAWebUserPrefsStore").getUser(e.NextFetchSubscriptionEntryPointsTime),10))!=null?t:0}function p(t){r("WAWebUserPrefsStore").setUser(e.NextFetchSubscriptionEntryPointsTime,t)}function _(){var t=r("WAWebUserPrefsStore").getUser(e.MetaVerifiedEntryPointRedirectionUri);return typeof t!="string"||t===""?null:t}function f(t){r("WAWebUserPrefsStore").setUser(e.MetaVerifiedEntryPointRedirectionUri,t)}l.getNextSubscriptionQuery=s,l.setNextSubscriptionQuery=u,l.getShouldShowMetaVerifiedEntryPoint=c,l.setShouldShowMetaVerifiedEntryPoint=d,l.getNextFetchSubscriptionEntryPointsTime=m,l.setNextFetchSubscriptionEntryPointsTime=p,l.getMetaVerifiedEntryPointRedirectionUri=_,l.setMetaVerifiedEntryPointRedirectionUri=f}),98);
__d("WAWebSubscriptions",["WAExponentialBackoff","WALogger","WAPromiseDelays","WAWebBackendErrors","WAWebBizGatingUtils","WAWebFetchSubscriptions","WAWebPremiumAccessEngine","WAWebSchemaSubscription","WAWebSubscriptionCollection","WAWebUserPrefsMeUser","WAWebUserPrefsSubscription","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b={minTimeout:5e3,maxTimeout:3e4,retries:10,signal:new AbortController().signal},v=86400*1e3;function S(){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebBizGatingUtils").subscriptionFetchEnabled()){var t=o("WAWebUserPrefsSubscription").getNextSubscriptionQuery();if(t){var n=t-Date.now();n>0&&(o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Subscriptions manager found scheduled query, not due yet, sleeping for "," sec"])),n/1e3),yield o("WAPromiseDelays").delayMs(n))}try{yield o("WAExponentialBackoff").exponentialBackoff(b,function(e,t){return o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Subscriptions manager, run"]))),k().catch(function(n){if(n instanceof o("WAWebBackendErrors").ServerStatusCodeError)switch(n.statusCode){case 500:return o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Subscriptions manager query failed, retriable error: ",", failCount ",""])),n.message,t),e(n)}throw n})})}catch(e){if(o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Subscriptions manager pull failed, error: ",""])),e).verbose().devConsole(e).sendLogs("Subscriptions manager run failed"),e instanceof o("WAWebBackendErrors").ServerStatusCodeError&&e.statusCode===500)o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Subscriptions manager, will retry in "," ms"])),v);else{o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Subscriptions manager, non recoverable error, exiting"])));return}}o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Subscriptions manager, sleeping for "," sec"])),v/1e3),o("WAWebUserPrefsSubscription").setNextSubscriptionQuery(Date.now()+v),yield o("WAPromiseDelays").delayMs(v),o("WAWebUserPrefsMeUser").getMaybeMePnUser()&&S()}}),R.apply(this,arguments)}function L(e){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(o("WAWebBizGatingUtils").subscriptionFetchEnabled()){if(e.length===0){o("WALogger").DEV(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Subscriptions manager, no subscriptions found"]))),o("WAWebSubscriptionCollection").SubscriptionCollection.reset();try{o("WAWebPremiumAccessEngine").update()}catch(e){o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["subscription sync: error PremiumAccessEngine ",""])),e).sendLogs("PremiumAccessEngine")}return}var t=["ACTIVE","FREE_TRIAL","IN_GRACE_PERIOD"],n=e.map(function(e){var n={id:e.id,isAutoRenewing:e.status==="ACTIVE",isDeactivated:!t.includes(e.status),expirationDate:e.expirationDate!==void 0?parseInt(e.expirationDate,10):void 0,creationTime:e.creationTime!==void 0?parseInt(e.creationTime,10):void 0,newMessageCappingEnabled:e.newMessageCappingEnabled!==void 0?e.newMessageCappingEnabled:void 0};return e.status==="CANCELED"&&(n.expirationDate||0)>new Date().getTime()/1e3&&(n.isDeactivated=!1),n});o("WALogger").DEV(g||(g=babelHelpers.taggedTemplateLiteralLoose(["Subscriptions manager, got subscriptions: ",""])),JSON.stringify(n)),yield o("WAWebSchemaSubscription").getSubscriptionTable().bulkCreateOrMerge(n),o("WAWebSubscriptionCollection").SubscriptionCollection.add(n.map(function(e){return babelHelpers.extends({},e)}),{merge:!0});try{o("WAWebPremiumAccessEngine").update()}catch(e){o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["subscription sync: error PremiumAccessEngine ",""])),e).sendLogs("PremiumAccessEngine")}}}),E.apply(this,arguments)}function k(){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebUserPrefsMeUser").getMaybeMePnUser()){o("WALogger").DEV(y||(y=babelHelpers.taggedTemplateLiteralLoose(["Subscriptions manager, fetch state"])));var e=yield o("WAWebFetchSubscriptions").fetchSubscriptions();if(e.type==="success"&&e.subscriptions!=null)L(e.subscriptions);else throw o("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["subscription sync: GraphQL fetch failed with type: ",""])),e.type).verbose().sendLogs("PremiumAccessEngine",{sampling:.01}),e.type==="error"||e.type==="graphql-error"?new(o("WAWebBackendErrors")).ServerStatusCodeError(500):r("err")("Failed to fetch subscriptions via GraphQL: "+e.type)}}),I.apply(this,arguments)}l.runSubscriptionsManager=S,l.applySubscriptions=L,l.query=k}),98);
__d("WAWebGenerateBotMetadata",["WAWebAiThreadTypeUtils","WAWebBotGating","WAWebLidMigrationUtils","WAWebProtobufsAICommon.pb"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.aiThreadInfo;if(t!=null){var n=o("WAWebAiThreadTypeUtils").getProtoTypeFromAiThreadType(t.aiThreadType);return{clientInfo:{type:n}}}}function s(t){var n=t.botPersonaId!=null?t.botPersonaId:void 0,r=u(t),a=t.aiThreadInfo!=null&&o("WAWebBotGating").isAiChatThreadsInfraEnabled()?e(t):void 0;if(!(n==null&&r==null))return{personaId:n,invokerJid:r,capabilityMetadata:c(),botThreadInfo:a}}function u(e){if(e.subtype==="bot_feedback"){var t;return(t=e.botTargetSenderJid)==null?void 0:t.toJid()}if(e.botTargetSenderJid!=null){var n;return(n=o("WAWebLidMigrationUtils").toLid(e.botTargetSenderJid))==null?void 0:n.toJid()}}function c(){var e=[];return o("WAWebBotGating").isRichStructuredResponseEnabled()&&(e.push(o("WAWebProtobufsAICommon.pb").BotCapabilityMetadata$BotCapabilityType.RICH_RESPONSE_STRUCTURED_RESPONSE),o("WAWebBotGating").isRichResponseHeadingEnabled()&&e.push(o("WAWebProtobufsAICommon.pb").BotCapabilityMetadata$BotCapabilityType.RICH_RESPONSE_HEADING),o("WAWebBotGating").isRichResponseSubHeadingEnabled()&&e.push(o("WAWebProtobufsAICommon.pb").BotCapabilityMetadata$BotCapabilityType.RICH_RESPONSE_SUB_HEADING),o("WAWebBotGating").isRichResponseTableEnabled()&&e.push(o("WAWebProtobufsAICommon.pb").BotCapabilityMetadata$BotCapabilityType.RICH_RESPONSE_TABLE),o("WAWebBotGating").isRichResponseInlineReelsEnabled()&&e.push(o("WAWebProtobufsAICommon.pb").BotCapabilityMetadata$BotCapabilityType.RICH_RESPONSE_INLINE_REELS)),e.length>0?{capabilities:e}:void 0}l.generateAiThreadInfo=e,l.generateBotMetadata=s,l.generateBotCapabilityMetadata=c}),98);
__d("WAWebGenerateThreadIds",["WAWebE2EProtoUtils","WAWebThreadUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.threadIds;if(!(t==null||t.length===0))return t.map(function(e){return{threadType:o("WAWebThreadUtils").getThreadsTypeAsE2EValue(e.type),threadKey:o("WAWebE2EProtoUtils").msgKeyToProtobuf(e.key)}})}l.generateThreadIds=e}),98);
__d("WAWebE2EProtoGenerator",["WALogger","WATypeUtils","WAWebABPropsSaga","WAWebAssociationProtoUtils","WAWebBizCoexGatingUtils","WAWebBotGating","WAWebButtonsMessageProtoUtils","WAWebConversionTupleCollection","WAWebE2EProtoUtils","WAWebGenerateBotMetadata","WAWebGenerateThreadIds","WAWebLidMigrationUtils","WAWebLoggerDebugInfo","WAWebMessageAssociation.flow","WAWebMessageAssociationGatingUtils","WAWebMessagePluginGenerateProtobuf","WAWebMessagePluginGenerateReportingTokenContent","WAWebMessagingGatingUtils","WAWebMsgType","WAWebPollCreationUtils","WAWebProtobufsE2E.pb","WAWebThreadsGating","WAWebURLUtils","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","isArrayNullOrEmpty","lodash"],(function(t,n,r,o,a,i,l){var e=["messageContextInfo"],s;function u(e,t,n){!t&&!n||(e.messageContextInfo=babelHelpers.extends({},e.messageContextInfo,{deviceListMetadata:{senderKeyHash:t==null?void 0:t.keyHash,senderTimestamp:t==null?void 0:t.timestamp,senderKeyIndexes:t==null?void 0:t.keyIndexes,recipientKeyHash:n==null?void 0:n.keyHash,recipientTimestamp:n==null?void 0:n.timestamp,recipientKeyIndexes:n==null?void 0:n.keyIndexes,senderAccountType:o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()?t==null?void 0:t.senderAccountType:void 0,receiverAccountType:o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()?n==null?void 0:n.receiverAccountType:void 0},deviceListMetadataVersion:2}))}function c(e){if(e.type!==o("WAWebMsgType").MSG_TYPE.PROTOCOL)return{};switch(e.subtype){case"app_state_sync_key_share":return{protocolMessage:{type:o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.APP_STATE_SYNC_KEY_SHARE,appStateSyncKeyShare:e.appStateSyncKeyShare}};case"app_state_sync_key_request":return{protocolMessage:{type:o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.APP_STATE_SYNC_KEY_REQUEST,appStateSyncKeyRequest:e.appStateSyncKeyRequest}};case"app_state_fatal_exception_notification":return{protocolMessage:{type:o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.APP_STATE_FATAL_EXCEPTION_NOTIFICATION,appStateFatalExceptionNotification:e.appStateFatalExceptionNotification}};case"peer_data_operation_request_message":return{protocolMessage:{type:o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.PEER_DATA_OPERATION_REQUEST_MESSAGE,peerDataOperationRequestMessage:e.peerDataOperationRequestMessage}};case"peer_data_operation_request_response_message":return{protocolMessage:{type:o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.PEER_DATA_OPERATION_REQUEST_RESPONSE_MESSAGE,peerDataOperationRequestResponseMessage:e.peerDataOperationRequestResponseMessage}}}return{}}function d(e,t){var n,r=_(e);return p(r,t,(n=e.utm)!=null?n:void 0)}function m(e){return p(e)}function p(e,t,n){var r={};if(e.quotedMsg){var a=e.quotedMsg.mentionedJidList,i=e.quotedMsg.groupMentions,l=[],s=[];Array.isArray(a)&&a.length>0&&l.push.apply(l,a.map(o("WAWebE2EProtoUtils").encodeJid)),Array.isArray(i)&&i.length>0&&s.push.apply(s,i.map(function(e){return{groupSubject:e.groupSubject,groupJid:o("WAWebE2EProtoUtils").encodeJid(e.groupJid)}}));var u=l.length>0||s.length>0?{mentionedJid:l,groupMentions:s,statusAttributions:[]}:void 0;r.stanzaId=e.quotedStanzaID,r.remoteJid=o("WAWebE2EProtoUtils").encodeJid(e.quotedRemoteJid),r.participant=o("WAWebE2EProtoUtils").encodeJid(e.quotedParticipant);var c={duration:e.quotedMsg.duration,directPath:e.quotedMsg.directPath,encFilehash:e.quotedMsg.encFilehash,filehash:e.quotedMsg.filehash,height:e.quotedMsg.height,mediaKey:e.quotedMsg.mediaKey,mediaKeyTimestamp:o("WATypeUtils").isNumber(e.quotedMsg.mediaKeyTimestamp)?e.quotedMsg.mediaKeyTimestamp:void 0,mimetype:e.quotedMsg.mimetype,url:e.quotedMsg.clientUrl||e.quotedMsg.deprecatedMms3Url,width:e.quotedMsg.width};r.quotedMessage=f(e.quotedMsg,c,u,void 0,"quoted")}else e.quotedRemoteJid&&e.quotedGroupSubject&&e.quotedParentGroupJid?(r.remoteJid=o("WAWebE2EProtoUtils").encodeJid(e.quotedRemoteJid),r.groupSubject=e.quotedGroupSubject,r.parentGroupJid=o("WAWebE2EProtoUtils").encodeJid(e.quotedParentGroupJid)):e.quotedRemoteJid&&(r.remoteJid=o("WAWebE2EProtoUtils").encodeJid(e.quotedRemoteJid));if(e.mentionedJidList&&e.mentionedJidList.length>0){var d=e.mentionedJidList;r.mentionedJid=d.map(o("WAWebE2EProtoUtils").encodeJid)}if(e.groupMentions&&e.groupMentions.length>0&&(r.groupMentions=e.groupMentions.map(function(e){return{groupSubject:e.groupSubject,groupJid:o("WAWebE2EProtoUtils").encodeJid(e.groupJid)}})),e.conversionTuple&&Object.assign(r,e.conversionTuple),e.isForwarded&&(r.isForwarded=e.isForwarded),e.isQuestion&&(r.isQuestion=e.isQuestion),e.questionReplyQuotedMessage&&(r.questionReplyQuotedMessage={serverQuestionId:e.questionReplyQuotedMessage.questionServerId,quotedQuestion:f(e.questionReplyQuotedMessage.quotedQuestion,void 0,{isQuestion:!0,groupMentions:[],mentionedJid:[],statusAttributions:[]},void 0,"quoted"),quotedResponse:f(e.questionReplyQuotedMessage.quotedResponse,void 0,void 0,void 0,"quoted")}),e.forwardingScore&&(r.forwardingScore=e.forwardingScore),e.nonJidMentions!=null&&(r.nonJidMentions=e.nonJidMentions),e.groupId&&(r.groupId=e.groupId),e.groupIndex&&(r.groupIndex=e.groupIndex),e.groupSize&&(r.groupSize=e.groupSize),e.forwardedNewsletterMessageInfo){var m=e.forwardedNewsletterMessageInfo,p=m.newsletterId,_=m.newsletterName,g=m.serverMessageId;r.forwardedNewsletterMessageInfo={newsletterJid:o("WAWebE2EProtoUtils").encodeJid(p),newsletterName:_,serverMessageId:g}}return e.ephemeralDuration&&(r.expiration=e.ephemeralDuration),e.ephemeralSettingTimestamp&&(r.ephemeralSettingTimestamp=e.ephemeralSettingTimestamp),(e.disappearingModeInitiator||e.disappearingModeTrigger!=null&&e.to.isGroup())&&(r.disappearingMode=o("WAWebE2EProtoUtils").disappearingModeInitiatorToProto(e.disappearingModeInitiator,e.disappearingModeTrigger,e.disappearingModeInitiatedByMe)),e.ctwaContext&&(r.externalAdReply={sourceUrl:e.ctwaContext.sourceUrl,sourceId:e.ctwaContext.sourceId,sourceType:e.ctwaContext.sourceType,body:e.ctwaContext.description,title:e.ctwaContext.title,thumbnailUrl:e.ctwaContext.thumbnailUrl,thumbnail:e.ctwaContext.thumbnail?o("WAWebE2EProtoUtils").encodeBytes(e.ctwaContext.thumbnail):void 0,mediaType:e.ctwaContext.mediaType,mediaUrl:e.ctwaContext.mediaUrl}),n&&(r.utm={utmCampaign:n.campaign!=null?n.campaign:void 0,utmSource:n.source!=null?n.source:void 0}),e.cannotBeRanked&&(r.featureEligibilities={cannotBeRanked:e.cannotBeRanked}),e.limitSharing&&(r.limitSharingV2=e.limitSharing),f(e,t,Object.keys(r).length>0?r:void 0)}function _(e){var t=e.id,n=e.toJSON();delete n.status,delete n.mimetype,delete n.height,delete n.width,delete n.recipients,delete n.chat,delete n.broadcast,delete n.ack,delete n.invis,delete n.filehash,delete n.recvFresh,delete n.mediaData,r("WAWebURLUtils").isHttp(e.clientUrl)||delete n.clientUrl,r("WAWebURLUtils").isHttp(e.deprecatedMms3Url)||delete n.deprecatedMms3Url;for(var o in n)n[o]==null&&delete n[o];var a=r("WAWebConversionTupleCollection").get(t.remote);return a&&(n.conversionTuple=a.serialize()),n}function f(e,t,n,a,i){var l,u;t===void 0&&(t={}),n===void 0&&(n=void 0);var c=g(e,t,n,a,i);try{var d=o("WAWebAssociationProtoUtils").getValidatedOutgoingMessageAssociationContextInfo(e.associationType,e.parentMsgKey);d&&(c.messageContextInfo=babelHelpers.extends({},c.messageContextInfo,d))}catch(t){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["failed to generate associated message context info for "," of association "," due to error: ",""])),e.type,e.associationType,t).sendLogs("getProtobufMessage: failed to generate associated message context info")}if(!(o("WAWebBotGating").isBotEnabled()&&(l=e.invokedBotWid)!=null&&l.isBot())&&e.messageSecret&&(c.messageContextInfo=babelHelpers.extends({},c.messageContextInfo,{messageSecret:e.messageSecret})),o("WAWebBotGating").isBotEnabled()){var m=o("WAWebGenerateBotMetadata").generateBotMetadata(e);c.messageContextInfo=babelHelpers.extends({},c.messageContextInfo,{botMetadata:m})}if(!r("isArrayNullOrEmpty")(e.threadIds)&&o("WAWebThreadsGating").isThreadsInfraEnabled()){var p=o("WAWebGenerateThreadIds").generateThreadIds(e);c.messageContextInfo=babelHelpers.extends({},c.messageContextInfo,{threadId:p})}if(c=I(c,e,n),o("WAWebMessagingGatingUtils").isReportingTokenSendingEnabled()&&o("WAWebMessagePluginGenerateReportingTokenContent").isMsgTypeReportingTokenCompatible(e.type,e.subtype)){var _,f;c.messageContextInfo=babelHelpers.extends({},c.messageContextInfo,{messageSecret:(_=(f=c.messageContextInfo)==null?void 0:f.messageSecret)!=null?_:e.messageSecret})}return e.type===o("WAWebMsgType").MSG_TYPE.COMMENT&&((u=c.messageContextInfo)==null?void 0:u.messageSecret)!=null&&(c.messageContextInfo=babelHelpers.extends({},c.messageContextInfo,{messageSecret:null})),e.limitSharing&&(c.messageContextInfo=babelHelpers.extends({},c.messageContextInfo,{limitSharingV2:e.limitSharing})),c}function g(e,t,n,r,a){t===void 0&&(t={}),n===void 0&&(n=void 0),r===void 0&&(r={});var i=o("WAWebMessagePluginGenerateProtobuf").generateProtobuf({message:r,msgContext:a,contextInfo:n,json:e,mediaMetadata:t});if(i!=null)return i;switch(e.type){case o("WAWebMsgType").MSG_TYPE.AUTOMATED_GREETING_MESSAGE:return{conversation:e.body};case"template":return e.subtype==="text"?(e.type="chat",e.title&&(e.body="*"+e.title+"*\n"+e.body)):e.type=e.subtype,f(e,t,n,r)}return r}function h(e,t){return t.type==="ptt"?{viewOnceMessageV2Extension:{message:e}}:{viewOnceMessage:{message:e}}}function y(e){return{documentWithCaptionMessage:{message:e}}}function C(e){return{lottieStickerMessage:{message:e}}}function b(e){return{groupMentionedMessage:{message:e}}}function v(e){return{botInvokeMessage:{message:e}}}function S(e){return{pollCreationMessageV4:{message:e}}}function R(e){return{questionMessage:{message:e}}}function L(e){return{questionReplyMessage:{message:e}}}function E(e){return{associatedChildMessage:{message:babelHelpers.extends({},e,{messageContextInfo:void 0})},messageContextInfo:e.messageContextInfo}}function k(t){var n=t.messageContextInfo,r=babelHelpers.objectWithoutPropertiesLoose(t,e);return{pollCreationOptionImageMessage:{message:r},messageContextInfo:n}}function I(e,t,n){var a,i,l,s,u,c=e;if(t.pollContentType===o("WAWebPollCreationUtils").PollContentType.IMAGE&&(c=S(c)),(n==null?void 0:n.isQuestion)===!0&&(c=R(c)),n!=null&&n.questionReplyQuotedMessage&&(c=L(c)),t.associationType!=null&&(t.associationType===o("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_POLL?c=k(c):o("WAWebMessageAssociationGatingUtils").isFutureproofAssociatedChildEnabled()&&(c=E(c))),t.isViewOnce&&(c=h(c,t)),t.isDynamicReplyButtonsMsg===!0&&(c=o("WAWebButtonsMessageProtoUtils").createDynamicReplyButtonsMessage(c,t,n)),t.type===o("WAWebMsgType").MSG_TYPE.DOCUMENT&&((a=c.documentMessage)!=null&&a.caption)&&(c=y(c)),t.type===o("WAWebMsgType").MSG_TYPE.STICKER&&((i=c.stickerMessage)!=null&&i.isLottie)&&(c=C(c)),n!=null&&(l=n.groupMentions)!=null&&l.length&&(c=b(c)),!((s=t.invokedBotWid)!=null&&s.isFbidBot())&&((u=t.invokedBotWid)!=null&&u.isPnBot()||t.subtype==="bot_request_welcome")&&(c=v(c),o("WAWebBotGating").isBotEnabled())){var d;c.messageContextInfo=babelHelpers.extends({},c.messageContextInfo,{messageSecret:t.messageSecret,botMetadata:babelHelpers.extends({},((d=e.messageContextInfo)==null?void 0:d.botMetadata)||{},t.botTargetSenderJid instanceof r("WAWebWid")?{invokerJid:t.botTargetSenderJid.toJid()}:{})})}return c}function T(e,t){var n,a,i,l,s,u=r("lodash").cloneDeep(e);u.messageContextInfo=babelHelpers.extends({},u.messageContextInfo,{messageSecret:null}),t&&(u.messageContextInfo=babelHelpers.extends({},u.messageContextInfo,{botMessageSecret:t}));var c=(u==null||(n=u.botInvokeMessage)==null||(n=n.message)==null||(n=n.extendedTextMessage)==null?void 0:n.contextInfo)||(u==null||(a=u.extendedTextMessage)==null?void 0:a.contextInfo);if((c==null?void 0:c.quotedMessage)!=null){var d;c.participant!=null&&((d=o("WAWebWidFactory").createWid(c.participant))==null?void 0:d.isBot())!==!0&&(delete c.quotedMessage,delete c.stanzaId,delete c.remoteJid,delete c.participant)}var m=u==null||(i=u.protocolMessage)==null||(i=i.botFeedbackMessage)==null?void 0:i.messageKey;m!=null&&m.remoteJid!=null&&delete m.remoteJid;var p=(u==null||(l=u.protocolMessage)==null?void 0:l.type)===o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REVOKE?u==null||(s=u.protocolMessage)==null?void 0:s.key:null;return p!=null&&p.remoteJid!=null&&delete p.remoteJid,u}function D(e){var t,n,a,i=e,l=(t=e==null||(n=e.botInvokeMessage)==null||(n=n.message)==null||(n=n.extendedTextMessage)==null||(n=n.contextInfo)==null?void 0:n.participant)!=null?t:e==null||(a=e.extendedTextMessage)==null||(a=a.contextInfo)==null?void 0:a.participant;if(l!=null){var s=o("WAWebWidFactory").createWid(l);if(!s.isBot()){var u,c,d;i=r("lodash").cloneDeep(e);var m=(u=(c=i)==null||(c=c.botInvokeMessage)==null||(c=c.message)==null||(c=c.extendedTextMessage)==null?void 0:c.contextInfo)!=null?u:(d=i)==null||(d=d.extendedTextMessage)==null?void 0:d.contextInfo;if(m!=null){var p=o("WAWebLidMigrationUtils").toLid(s);m.participant=o("WAWebE2EProtoUtils").encodeJid(p)}}}return i}function x(e){var t,n=e,a=e==null||(t=e.protocolMessage)==null||(t=t.key)==null?void 0:t.participant;if(a!=null){var i=o("WAWebWidFactory").createWid(a);if(!i.isBot()&&!i.isLid()){var l;n=r("lodash").cloneDeep(e);var s=(l=n)==null||(l=l.protocolMessage)==null?void 0:l.key;if(s!=null){var u=o("WAWebLidMigrationUtils").toLid(i);s.participant=o("WAWebE2EProtoUtils").encodeJid(u)}}}return n}function $(e){var t=e,n=(e==null?void 0:e.protocolMessage)!=null;if(n){var o,a;t=r("lodash").cloneDeep(e),(o=t.protocolMessage)==null||(o=o.key)==null||delete o.remoteJid,(a=t.protocolMessage)==null||(a=a.key)==null||delete a.participant}return t}function P(e){var t=r("lodash").cloneDeep(e);return t.messageContextInfo=babelHelpers.extends({},t.messageContextInfo,{capiCreatedGroup:!0}),t}function N(e){return M.apply(this,arguments)}function M(){return M=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebLoggerDebugInfo").getDebugInfo({addLanguageFields:!0,convertFields:!0,addUserAgentDetails:!0});t.sagaKey="saga_v1_enabled";var n=babelHelpers.extends({version:1,debug_information:t},o("WAWebABPropsSaga").getIsSagaV1CarouselEnabled()?{citations_carousel:!0}:{});e.messageContextInfo=babelHelpers.extends({},e.messageContextInfo,{supportPayload:JSON.stringify(n)})}),M.apply(this,arguments)}l.populateMessageContextInfo=u,l.createPeerMsgProtobuf=c,l.createMsgProtobuf=d,l.createAddonProtobuf=m,l.getProtobufMessage=f,l.updateBotInvokeMsgProtoCopyForCapi=T,l.updateFbidBotProtobuf=D,l.updateFbidBotInvokeProtobuf=x,l.updateBotProtobuf=$,l.updateGroupMsgProtoWithCapiFlag=P,l.addDebugInfoSupportPayload=N}),98);
__d("WAWebApiHistorySyncNotification",["WALogger","WAWebHistorySyncNotificationUtils","WAWebHistorySyncProgress","WAWebProtobufsHistorySync.pb","WAWebSchemaHistorySyncNotification","WAWebSyncGatingUtils","WAWebUserPrefsHistorySync","WAWebUserPrefsTypes","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C=new Set,b={};function v(e,t,n){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){if(e===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.PUSH_NAME)return!0;if([o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.FULL,o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT].includes(e)&&t===1||o("WAWebSyncGatingUtils").isHistorySyncOnDemandEnabled()&&e===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND&&t===0){if(e===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT){var r=yield o("WAWebUserPrefsHistorySync").getInitialHistorySyncComplete();return r===!0}var a=yield o("WAWebUserPrefsHistorySync").getHistorySyncStatus();return!!(a!=null&&a.recentCompleted)}var i=yield o("WAWebUserPrefsHistorySync").getLastHistorySyncedChunk();if(i==null)return!1;var l=i.split("_"),s=l[0],u=l[1];return s===""+e&&u===""+(t-1)?!0:s===""+e&&u===""+t?(o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[history sync] isPreviousChunkProcessed: next chunk already processed ","_",", last processed: "," "])),e,t,i).tags("history-sync"),yield k(n,e,t),!1):(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[history sync] isPreviousChunkProcessed returned false for ","_",", last processed: "," "])),e,t,i).tags("history-sync"),!1)}),S.apply(this,arguments)}function R(e,t,n){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){if(o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history sync] check if previous recent sync is processed with optimized logic"]))),t===1){var r=yield o("WAWebUserPrefsHistorySync").getInitialHistorySyncComplete();return r===!0}var a=yield o("WAWebUserPrefsHistorySync").getLastHistoryRecentSyncedChunk();if(a==null)return!1;var i=a.chunkOrder;return i===t-1?!0:i===t?(o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[history sync] isPreviousChunkProcessed: next chunk already processed ","_",", last processed: chunkOrder:"," progress:",""])),e,t,a.chunkOrder,a.progress).tags("history-sync"),yield k(n,e,t),!1):(o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[history sync] isPreviousChunkProcessed returned false for ","_",", last processed: "," "])),e,t,i).tags("history-sync"),!1)}),L.apply(this,arguments)}function E(t){return o("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().equals(["processed"],0,{shouldDecrypt:!1}).then((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n,r=t.filter(function(e){return!C.has(e.msgKey)&&!e.reuploadPending}).sort(function(e,t){return e.syncType!==t.syncType?t.syncType-e.syncType:e.chunkOrder!=null&&t.chunkOrder!=null?e.chunkOrder-t.chunkOrder:0}),a=r.length>0?r[0]:void 0,i=(n=a)==null?void 0:n.chunkOrder;if(i==null){var l;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[history sync] getNextUnProcessedNotification chunkOrder is null, ",""])),(l=a)==null?void 0:l.msgKey).tags("history-sync");return}if(a){var s;if(a.syncType===o("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT&&o("WAWebSyncGatingUtils").isRecentSyncNextChunkFetchOptimizationEnabled()?s=yield R(a.syncType,i,a.msgKey):s=yield v(a.syncType,i,a.msgKey),o("WAWebHistorySyncProgress").handleChunkProgress(s),!s)return;a=yield o("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().postflightDecryptSingleRecord(a)}return a});return function(e){return t.apply(this,arguments)}})())}function k(e,t,n){return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync] remove history sync notification from db with ","_",""])),t,n),C.delete(e),o("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().remove(e).catch(function(e){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[history sync] updateCurrentlyProcessed failed with error ",""])),e).tags("history-sync")})}function I(e){return C.delete(e),o("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().merge(e,{reuploadPending:!0})}function T(e){C.delete(e)}function D(e){var t=o("WAWebHistorySyncNotificationUtils").getHistorySyncBasicChunkInfoString(e.syncType,e.chunkOrder,e.isReupload);o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[history sync] add history sync notification, ",""])),t);var n=e.downloadOptions.mediaKey,r=e.downloadOptions.directPath,a=e.downloadOptions.filehash,i=e.downloadOptions.encFilehash;e.downloadOptions.mediaKey="",e.downloadOptions.directPath="",e.downloadOptions.filehash="",e.downloadOptions.encFilehash="";var l=babelHelpers.extends({},e,{chunkEncryptionKey:n,directPath:r,filehash:a,encFilehash:i});return e.processed=0,o("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().createOrMerge(e.msgKey,l)}function x(e,t){return $.apply(this,arguments)}function $(){return $=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){t===void 0&&(t=!1),yield D(e).then(function(){o("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(e.syncType,o("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.NOTIFICATION_STORED,e.chunkOrder)}),t&&C.add(e.msgKey)}),$.apply(this,arguments)}function P(){return N.apply(this,arguments)}function N(){return N=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(C.size>0)return o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[history sync] return null for next history sync chunk due to inFlightChunk.size=",""])),C.size),null;var e=yield E();if(e){var t=o("WAWebHistorySyncNotificationUtils").getHistorySyncBasicChunkInfoString(e==null?void 0:e.syncType,e==null?void 0:e.chunkOrder,e==null?void 0:e.isReupload);o("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync] fetched next history sync chunk for processing, ",""])),t),e.downloadOptions.mediaKey=e.chunkEncryptionKey,delete e.chunkEncryptionKey,e.downloadOptions.directPath=e.directPath||e.downloadOptions.directPath,delete e.directPath,e.downloadOptions.filehash=e.downloadOptions.filehash===""?e.filehash:e.downloadOptions.filehash,delete e.filehash,e.downloadOptions.encFilehash=e.encFilehash,delete e.encFilehash,C.add(e.msgKey)}else o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[history sync] return null for next history sync chunk due to next=null"])));return e}),N.apply(this,arguments)}l.inFlightChunk=C,l.recentSyncChunkHandlingTriedCount=b,l.updateCurrentlyProcessed=k,l.markChunkForReuploadPending=I,l.removeLocalFailureFromInFlightChunk=T,l.enqueueNotification=x,l.fetchNextHistorySyncChunkForProcessing=P}),98);
__d("WAWebSettingsGetters",["WAWebGetters","WAWebGettersCaches"],(function(t,n,r,o,a,i,l){var e=o("WAWebGetters").createGetterFactories({createCache:o("WAWebGettersCaches").createSettingsCache}),s=e.field,u=e.computed,c=e.clearCacheFor,d=c,m=s("archive"),p=u(function(e){var t=e[0];return t.enabled?!t.classic:!1},[m]);l.clearSettingsGetterCacheFor=d,l.getArchive=m,l.getShowArchiveV2=p}),98);
__d("WAWebSettingsModel",["WAWebBaseModel","WAWebSettingsGetters"],(function(t,n,r,o,a,i,l){var e={classic:!1,enabled:!1},s={duration:0,settingTimestamp:0},u=(function(t){function n(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.id=o("WAWebBaseModel").prop(),e.archive=o("WAWebBaseModel").prop(),e.disappearingMode=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(n,t);var r=n.prototype;return r.delete=function(){this.set({archive:e,disappearingMode:e}),t.prototype.delete.call(this),o("WAWebSettingsGetters").clearSettingsGetterCacheFor(this)},n})(o("WAWebBaseModel").BaseModel);u.Proxy="settings";var c=o("WAWebBaseModel").defineModel(u),d=new c({id:"default_settings_id",archive:e,disappearingMode:s});l.default=d}),98);
__d("WAWebInitFromStorage",["Promise","WALogger","WAWebAgentCollection","WAWebApiHydrateWidsUtil","WAWebBizGatingUtils","WAWebBlocklistCollection","WAWebCartCollection","WAWebChatAssignmentCollection","WAWebCommunityActivityCollection","WAWebConnModel","WAWebDBLabelAssociationDatabaseApi","WAWebDataSharing3pdLidCollection","WAWebFavoriteStickerCollection","WAWebGroupMetadataCollection","WAWebLabelCollection","WAWebListsGatingUtils","WAWebLogoutReasonConstants","WAWebMarketingMessagesUserFeedbackGatingUtils","WAWebMobilePlatforms","WAWebModelStorageUtils","WAWebNonMessageDataRequestMediaHandlingUtils","WAWebOptOutListCollection","WAWebQuickReplyCollection","WAWebRecentStickerCollectionMd","WAWebSchemaAgent","WAWebSchemaBlocklist","WAWebSchemaCart","WAWebSchemaChatAssignment","WAWebSchemaDataSharing3pdLidV2","WAWebSchemaFavoriteStickers","WAWebSchemaLabel","WAWebSchemaNonMessageDataRequest","WAWebSchemaOptOutList","WAWebSchemaQuickReply","WAWebSchemaRecentStickers","WAWebSchemaStickerDownload","WAWebSchemaSubscription","WAWebSchemaUnjoinedSubgroupMetadata","WAWebSettingsGetters","WAWebSettingsModel","WAWebSocketModel","WAWebStickerDownloadCollection","WAWebSubscriptionCollection","WAWebUnjoinedSubgroupMetadataCollection","WAWebUserPrefsGeneral","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m;function p(){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[InitFromStorage] will attempt to initialize metadata from storage"]))),o("WAWebConnModel").Conn.trigger("me_ready"),o("WAWebConnModel").Conn.meReadyTriggered=!0;var t=o("WAWebUserPrefsGeneral").getPushname(),n=yield o("WAWebUserPrefsGeneral").getLastMobilePlatform();if(n==null)return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["platform not found in UserPrefs."]))),o("WAWebSocketModel").Socket.logout(o("WAWebLogoutReasonConstants").LogoutReason.UnknownCompanion);yield o("WAWebMobilePlatforms").setMobilePlatform(n,!1),o("WAWebConnModel").Conn.pushname=t,o("WAWebConnModel").Conn.platform=n,o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[InitFromStorage] important metadata loaded"])))}),_.apply(this,arguments)}function f(){return o("WAWebSchemaBlocklist").getBlocklistTable().all().then(function(e){o("WAWebBlocklistCollection").BlocklistCollection.initializeFromCache(o("WAWebApiHydrateWidsUtil").hydrateWids(e))})}function g(){return o("WAWebMarketingMessagesUserFeedbackGatingUtils").isMMOptOutEnabled()?o("WAWebSchemaOptOutList").getOptOutListTable().all().then(function(e){o("WAWebOptOutListCollection").OptOutListCollection.initializeFromCache(o("WAWebApiHydrateWidsUtil").hydrateWids(e))}):(m||(m=n("Promise"))).resolve()}function h(){return o("WAWebBizGatingUtils").canDisplayLabel()||o("WAWebListsGatingUtils").isListsEnabled()?o("WAWebSchemaLabel").getLabelTable().all().then(function(e){o("WAWebLabelCollection").LabelCollection.initializeFromCache(e)}):(m||(m=n("Promise"))).resolve()}function y(){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebBizGatingUtils").canDisplayLabel()||o("WAWebListsGatingUtils").isListsEnabled()){var e=[];yield o("WAWebModelStorageUtils").getStorage().lock(["label","label-association","chat"],(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t[0],r=yield n.all(),a=r.map(function(e){return e.id}),i=yield o("WAWebDBLabelAssociationDatabaseApi").queryLabelAssociationsForLabelIds(a);e.push.apply(e,i)});return function(e){return t.apply(this,arguments)}})()),e.length>0&&o("WAWebLabelCollection").LabelCollection.initializeAssociationsFromCache(e)}return(m||(m=n("Promise"))).resolve()}),C.apply(this,arguments)}function b(){return o("WAWebBizGatingUtils").canSendQuickReply()?o("WAWebSchemaQuickReply").getQuickReplyTable().all().then(function(e){o("WAWebQuickReplyCollection").QuickReplyCollection.initializeFromCache(e)}):(m||(m=n("Promise"))).resolve()}function v(){return o("WAWebSchemaRecentStickers").getRecentStickersTable().all().then(function(e){return o("WAWebRecentStickerCollectionMd").RecentStickerCollectionMd.initializeFromCache(e)})}function S(){return o("WAWebSchemaFavoriteStickers").getFavoriteStickersTable().all().then(function(e){return o("WAWebFavoriteStickerCollection").FavoriteStickerCollection.initializeFromCache(e)})}function R(){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebUserPrefsMultiDevice").getArchiveV2EnabledSetting(),t=yield o("WAWebUserPrefsMultiDevice").getUnarchiveChatsSetting();e!=null&&(r("WAWebSettingsModel").archive=babelHelpers.extends({},o("WAWebSettingsGetters").getArchive(r("WAWebSettingsModel")),{enabled:e})),t!=null&&(r("WAWebSettingsModel").archive=babelHelpers.extends({},o("WAWebSettingsGetters").getArchive(r("WAWebSettingsModel")),{classic:t}))}),L.apply(this,arguments)}function E(){return o("WAWebSchemaCart").getCartTable().all().then(function(e){o("WAWebCartCollection").CartCollection.initializeFromCache(o("WAWebApiHydrateWidsUtil").hydrateWids(e))})}function k(){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebBizGatingUtils").isMultiDeviceMessageAttributionEnabled()){var e=yield o("WAWebSchemaAgent").getAgentTable().all();o("WAWebAgentCollection").AgentCollection.initializeFromCache(e)}}),I.apply(this,arguments)}function T(){return D.apply(this,arguments)}function D(){return D=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebSchemaSubscription").getSubscriptionTable().all();o("WAWebSubscriptionCollection").SubscriptionCollection.initializeFromCache(e)}),D.apply(this,arguments)}function x(){return $.apply(this,arguments)}function $(){return $=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebBizGatingUtils").chatAssignmentEnabled()){var e=yield o("WAWebSchemaChatAssignment").getChatAssignmentTable().all();o("WAWebChatAssignmentCollection").ChatAssignmentCollection.initializeFromCache(e)}}),$.apply(this,arguments)}function P(){return N.apply(this,arguments)}function N(){return N=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebSchemaDataSharing3pdLidV2").getDataSharing3pdLidTable().all();o("WAWebDataSharing3pdLidCollection").DataSharing3pdLidCollection.initializeFromCache(e)}),N.apply(this,arguments)}function M(){return w.apply(this,arguments)}function w(){return w=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: restoreUnjoinedSubgroups: start restoring unjoined subgroups"])));try{var e=yield o("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().all();e.forEach(function(e){r("WAWebUnjoinedSubgroupMetadataCollection").add({id:o("WAWebWidFactory").createWid(e.id),subject:e.subject,subjectTime:e.subjectTime,defaultSubgroup:e.defaultSubgroup,parentGroupId:o("WAWebWidFactory").createWid(e.parentGroup),size:e.size,generalSubgroup:e.generalSubgroup,membershipApprovalMode:e.membershipApprovalMode,membershipApprovalRequest:e.membershipApprovalRequest,hiddenSubgroup:e.hiddenSubgroup},{merge:!0})})}finally{o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: restoreUnjoinedSubgroups: complete restoring unjoined subgroups"])))}}),w.apply(this,arguments)}function A(){var e=r("WAWebGroupMetadataCollection").filter(function(e){return e.isParentGroup}),t=e.map(function(e){return r("WAWebCommunityActivityCollection").syncActivityFor(e.id)});return(m||(m=n("Promise"))).all(t)}function F(){return o("WAWebSchemaNonMessageDataRequest").getNonMessageDataRequestTable().all().then(function(e){o("WAWebNonMessageDataRequestMediaHandlingUtils").initializeMediaUploadResultFromStorage(e)})}function O(){return o("WAWebSchemaStickerDownload").getStickerDownloadTable().all().then(function(e){return o("WAWebStickerDownloadCollection").StickerDownloadCollection.initializeFromCache(e)})}l.restoreImportantMetaData=p,l.restoreBlocklist=f,l.restoreOptOutList=g,l.restoreLabels=h,l.restoreLabelAssociations=y,l.restoreQuickReplies=b,l.restoreRecentStickers=v,l.restoreFavoriteStickers=S,l.restoreArchiveV2Settings=R,l.restoreCarts=E,l.restoreAgents=k,l.restoreSubscriptions=T,l.restoreChatAssignments=x,l.restoreDataSharing3pdLid=P,l.restoreUnjoinedSubgroups=M,l.restoreCommunityActivity=A,l.restoreMediaUploadResult=F,l.restoreStickerDownload=O}),98);
__d("WAWebGetPendingMutation",["WAWebRunInTransaction"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return o("WAWebRunInTransaction").runInTransaction({PendingMutationStore:!0},function(t){var n=t.PendingMutationStore;return n.getByCollection(e)})}function s(){return o("WAWebRunInTransaction").runInTransaction({PendingMutationStore:!0},function(e){var t=e.PendingMutationStore;return t.getAll()})}function u(e){return o("WAWebRunInTransaction").runInTransaction({PendingMutationStore:!0},function(t){var n=t.PendingMutationStore;return n.bulkCreate(e)})}l.getSyncPendingMutationsByCollectionInTransaction=e,l.getAllSyncPendingMutationsInTransaction=s,l.bulkCreateSyncPendingMutationsInTransaction=u}),98);
__d("WAWebSentinel",["WASyncdConst","WAWebGetPendingMutation","WAWebSentinelMutationSync","WAWebSyncd","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield r("WAWebSentinelMutationSync").getSentinelMutations();return yield o("WAWebGetPendingMutation").bulkCreateSyncPendingMutationsInTransaction(e),o("WAWebSyncd").markCollectionsForSync(Array.from(o("WASyncdConst").CollectionName.members()))}),s.apply(this,arguments)}l.default=e}),98);
__d("WAWebGetCollectionVersion",["WACryptoLtHash","WAWebRunInTransaction"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return o("WAWebRunInTransaction").runInTransaction({CollectionVersionStore:!0},function(t){var n=t.CollectionVersionStore;return n.get(e)})}function s(e,t){var n=e.CollectionVersionStore;return n.get(t).then(function(e){var t;return(t=e==null?void 0:e.ltHash)!=null?t:new ArrayBuffer(o("WACryptoLtHash").KEY_LENGTH_BYTES)})}function u(e){return o("WAWebRunInTransaction").runInTransaction({CollectionVersionStore:!0},function(t){var n=t.CollectionVersionStore;return s({CollectionVersionStore:n},e)})}function c(e){return o("WAWebRunInTransaction").runInTransaction({CollectionVersionStore:!0},function(t){var n=t.CollectionVersionStore;return n.bulkGet(e)})}function d(){return o("WAWebRunInTransaction").runInTransaction({CollectionVersionStore:!0},function(e){var t=e.CollectionVersionStore;return t.getAll()})}function m(e,t,n){return o("WAWebRunInTransaction").runInTransaction({CollectionVersionStore:!0},function(r){var o=r.CollectionVersionStore;return o.update(e,{version:t,ltHash:n})})}function p(e){return o("WAWebRunInTransaction").runInTransaction({CollectionVersionStore:!0},function(t){var n=t.CollectionVersionStore;return n.bulkUpdate(e)})}function _(e){return o("WAWebRunInTransaction").runInTransaction({CollectionVersionStore:!0},function(t){var n=t.CollectionVersionStore;return n.get(e).then(function(e){return e==null?void 0:e.isCollectionInMacMismatchFatal})})}function f(e){return o("WAWebRunInTransaction").runInTransaction({CollectionVersionStore:!0},function(t){var n=t.CollectionVersionStore;return n.update(e,{isCollectionInMacMismatchFatal:!0})})}l.getCollectionVersionInTransaction=e,l.getCollectionVersionLtHashInTransaction=u,l.bulkGetCollectionVersionsInTransaction=c,l.getAllCollectionVersionsInTransaction=d,l.updateCollectionVersionAndLtHashInTransaction=m,l.bulkUpdateCollectionVersionInTransaction=p,l.getIsCollectionInMacMismatchFatalInTransaction=_,l.updateIsCollectionInMacMismatchFatalInTransaction=f}),98);
__d("WAWebGetSyncAction",["WASyncdConst","WAWebRunInTransaction"],(function(t,n,r,o,a,i,l){"use strict";function e(){return o("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0},function(e){var t=e.SyncActionStore;return t.count()})}function s(e){return o("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0},function(t){var n=t.SyncActionStore;return n.get(e)})}function u(e){return o("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0},function(t){var n=t.SyncActionStore;return n.getByCollections(e)})}function c(e){return o("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0},function(t){var n=t.SyncActionStore;return n.getByIndexMacs(e)})}function d(e){return o("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0},function(t){var n=t.SyncActionStore;return n.getByActionStates(e)})}function m(e){return o("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0},function(t){var n=t.SyncActionStore;return n.getByModelInfos(e)})}function p(){return o("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0},function(e){var t=e.SyncActionStore;return t.getAll()})}function _(e){return o("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0},function(t){var n=t.SyncActionStore;return n.getByActionStates([o("WASyncdConst").SyncActionState.Orphan]).then(function(t){return t.filter(function(t){return t.modelType!=null&&o("WASyncdConst").SyncModelType.cast(t.modelType)===e})})})}l.countSyncActionsInTransaction=e,l.getSyncActionInTransaction=s,l.getSyncActionsByCollectionsInTransaction=u,l.getSyncActionsByIndexMacsInTransaction=c,l.getSyncActionsByActionStatesInTransaction=d,l.getSyncActionsByModelInfosInTransaction=m,l.getAllSyncActions=p,l.getOrphanSyncActionsByModelTypeInTransaction=_}),98);
__d("WAWebSyncdCollectionsStateMachine",["WALogger","WASyncdConst","WATimeUtils","WAWebGetCollectionVersion","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=(function(){function t(){}return t.loadStatesFromDb=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=this,t=yield o("WAWebGetCollectionVersion").getAllCollectionVersionsInTransaction();t.forEach(function(t){return e.collectionStates.set(t.collection,{collection:t.collection,state:t.state,finiteFailureStartTime:t.finiteFailureStartTime})})});function t(){return e.apply(this,arguments)}return t})(),t.persistToDb=function(){var t=[];return this.collectionStates.forEach(function(e){return t.push(babelHelpers.extends({},e))}),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: state machine persistToDb. states:"]))),t.forEach(function(e){var t=e.finiteFailureStartTime==null?"":"(failure start: "+e.finiteFailureStartTime+")";o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: ",": "," ",""])),e.collection,e.state,t)}),o("WAWebGetCollectionVersion").bulkUpdateCollectionVersionInTransaction(t)},t.clean=function(){this.collectionStates=new Map},t.getCollectionState=function(t){var e=this.collectionStates.get(t);return e?e.state:(this.moveCollectionsToUpToDate([t]),o("WASyncdConst").CollectionSyncState.UpToDate)},t.getCollectionsInStateDirty=function(){var e=[];return this.collectionStates.forEach(function(t){t.state===o("WASyncdConst").CollectionSyncState.Dirty&&e.push(t.collection)}),e},t.getCollectionsInStateRetry=function(){var e=[];return this.collectionStates.forEach(function(t){t.state===o("WASyncdConst").CollectionSyncState.FailingFiniteRetry&&e.push(t.collection)}),e},t.getCollectionsInStateFatal=function(){var e=[];return this.collectionStates.forEach(function(t){t.state===o("WASyncdConst").CollectionSyncState.Fatal&&e.push(t.collection)}),e},t.getCollectionsInStateBlocked=function(){var e=[];return this.collectionStates.forEach(function(t){t.state===o("WASyncdConst").CollectionSyncState.Blocked&&e.push(t.collection)}),e},t.moveCollectionsToUpToDate=function(t){var e=this;t.forEach(function(t){return e.collectionStates.set(t,{collection:t,state:o("WASyncdConst").CollectionSyncState.UpToDate,finiteFailureStartTime:void 0})})},t.moveCollectionsToDirty=function(t){var e=this;t.forEach(function(t){var n;return e.collectionStates.set(t,{collection:t,state:o("WASyncdConst").CollectionSyncState.Dirty,finiteFailureStartTime:(n=e.collectionStates.get(t))==null?void 0:n.finiteFailureStartTime})})},t.moveCollectionsToFiniteRetry=function(t){var e=this;t.forEach(function(t){var n,r;return e.collectionStates.set(t,{collection:t,state:o("WASyncdConst").CollectionSyncState.FailingFiniteRetry,finiteFailureStartTime:(n=(r=e.collectionStates.get(t))==null?void 0:r.finiteFailureStartTime)!=null?n:o("WATimeUtils").unixTimeMs()})})},t.moveCollectionsToFatal=function(t){var e=this;t.forEach(function(t){return e.collectionStates.set(t,{collection:t,state:o("WASyncdConst").CollectionSyncState.Fatal})})},t.moveCollectionsToBlocked=function(t){var e=this;t.forEach(function(t){var n;return e.collectionStates.set(t,{collection:t,state:o("WASyncdConst").CollectionSyncState.Blocked,finiteFailureStartTime:(n=e.collectionStates.get(t))==null?void 0:n.finiteFailureStartTime})})},t.getExpiredCollections=function(){var e=[];return this.collectionStates.forEach(function(t){if(t.state===o("WASyncdConst").CollectionSyncState.FailingFiniteRetry){var n;t.finiteFailureStartTime==null?(n=1/0,o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Collection "," is in finite retry state with no failure start time"])),t.collection)):n=t.finiteFailureStartTime;var r=n+o("WASyncdConst").FINITE_FAILURE_EXPIRY_DURATION;r<o("WATimeUtils").unixTimeMs()&&e.push(t.collection)}}),e},t.getCollectionMinFailureTime=function(){var e=Array.from(this.collectionStates.values()).filter(function(e){return e.state===o("WASyncdConst").CollectionSyncState.FailingFiniteRetry}).map(function(e){return e.finiteFailureStartTime}).filter(Boolean);return e.length===0?null:Math.min.apply(Math,e)},t})();c.collectionStates=new Map,l.default=c}),98);
__d("WAWebSyncdDisabled",["WAWebRuntimeEnvironmentUtils"],(function(t,n,r,o,a,i,l){function e(){return!!o("WAWebRuntimeEnvironmentUtils").isWorker()}l.isSyncdDisabled=e}),98);
__d("WAWebSyncdMetricCriticalBootstrapStage",["$InternalEnum","WALogger","WAPREList","WAPREMetrics","WAWebProtobufSyncAction.pb","decodeProtobuf"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_=n("$InternalEnum").Mirrored(["ABOUT_TO_APPLY_MUTATIONS","APPLIED_MUTATIONS","MUTATIONS_DECRYPTED","REQUEST_BUILT","RESPONSE_RECEIVED","RESPONSE_PARSED_VALID","ENTERED_RETRY_MODE","MISSING_KEYS_RECEIVED"]),f=n("$InternalEnum").Mirrored(["PATCH_MUTATIONS","SNAPSHOT_MUTATIONS"]);function g(e){o("WAPREMetrics").startMetric(o("WAPREList").PRE_METRIC.SYNCD_CRITICAL_BOOTSTRAP_STAGE).endSuccess(y({type:e}))}function h(e,t){g(_.MUTATIONS_DECRYPTED),o("WAPREMetrics").startMetric(o("WAPREList").PRE_METRIC.SYNCD_DECRYPT_MUTATIONS).endSuccess(C({type:e,mutations:t}))}function y(e){return{string:{criticalBootstrapStage:e.type}}}function C(e){var t=e.type,n=e.mutations,r,a=0,i=[];return n.forEach(function(e){var t=e.binarySyncData,n=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,t),l=n.value;l!=null&&(l.archiveChatAction?r=l.archiveChatAction.messageRange:l.markChatAsReadAction?r=l.markChatAsReadAction.messageRange:l.clearChatAction?r=l.clearChatAction.messageRange:l.deleteChatAction&&(r=l.deleteChatAction.messageRange),r!=null&&(a+=r.messages.length,i.push(r.messages.length)))}),{string:{mutationType:t},int:{count:n.length,totalAdditionalMessagesCount:a},int_array:{messageRangeLengths:i}}}function b(t){var n,r=t==null||(n=t.string)==null?void 0:n.criticalBootstrapStage;if(r==null)return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing bootstrap stage for critical bootstrap stage"]))),null;var a=_.cast(r);return a==null?(o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown bootstrap stage: "," for critical bootstrap stage"])),r),null):{type:a}}function v(e){var t,n,r,a,i=e==null||(t=e.string)==null?void 0:t.mutationType,l=e==null||(n=e.int)==null?void 0:n.count,s=e==null||(r=e.int)==null?void 0:r.totalAdditionalMessagesCount,_=e==null||(a=e.int_array)==null?void 0:a.messageRangeLengths;if(i==null)return o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing type for DecryptMutations"]))),null;if(l==null)return o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing count for DecryptMutations"]))),null;if(s==null)return o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing totalAdditionalMessagesCount for DecryptMutations"]))),null;if(_==null)return o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing decryptedMutationMessageRangeCountArray for DecryptMutations"]))),null;var g=f.cast(i);return g==null?(o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown SyncdDecryptMutationsType for DecryptMutations"]))),null):{type:g,count:l,totalAdditionalMessagesCount:s,decryptedMutationMessageRangeCountArray:_}}l.SyncdCriticalBootstrapStageType=_,l.SyncdDecryptMutationsType=f,l.reportSyncdCriticalBootstrapStage=g,l.reportSyncdDecryptedMutations=h,l.convertSyncdCriticalBootstrapStageFromAnnotations=b,l.convertSyncdDecryptMutationsMetricsFromAnnotations=v}),98);
__d("WAWebSyncd",["Promise","WALogger","WASyncdConst","WAWebGetCollectionVersion","WAWebGetMissingKey","WAWebGetPendingMutation","WAWebGetSyncAction","WAWebGetSyncKey","WAWebSyncdAntiTampering","WAWebSyncdCollectionsStateMachine","WAWebSyncdCryptoUtils","WAWebSyncdDbCallbacksApi","WAWebSyncdDisabled","WAWebSyncdMetricCriticalBootstrapStage","WAWebSyncdMetricFatalError","WAWebSyncdOrphan","WAWebSyncdServerSync","WAWebSyncdWamAppState","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x,$,P,N,M,w,A=1e3,F=1e3*60*60,O=2,B=new Set,W=new Set,q,U=!1,V=0,H=0;function G(e,t){return z.apply(this,arguments)}function z(){return z=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=t!=null?yield j(e,t):e;return o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["syncd: marking for sync: ",""])),n),n.forEach(function(e){var t=r("WAWebSyncdCollectionsStateMachine").getCollectionState(e);o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["syncd: "," state before sync: ",""])),e,t),t===o("WASyncdConst").CollectionSyncState.UpToDate?r("WAWebSyncdCollectionsStateMachine").moveCollectionsToDirty([e]):t===o("WASyncdConst").CollectionSyncState.Dirty&&(W=new Set([].concat(Array.from(W),[e])))}),yield r("WAWebSyncdCollectionsStateMachine").persistToDb(),ne()}),z.apply(this,arguments)}function j(e,t){return K.apply(this,arguments)}function K(){return K=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: start filter collections: ",""])),e);var n=yield o("WAWebGetCollectionVersion").bulkGetCollectionVersionsInTransaction(e),r=new Map(e.map(function(e,t){var r;return[e,(r=n[t])==null?void 0:r.version]}));return e.filter(function(e){var n=r.get(e);if(n==null)return o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["syncd: local version for "," missing; will mark for sync."])),e),!0;var a=t.get(e);return a==null?(o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["syncd: server version for "," missing; will mark for sync."])),e),!0):n<a?(o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["syncd: local version (",") for "," less than server version (","); will mark for sync."])),n,e,a),!0):(o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["syncd: local version (",")for "," >= server version (","); will not mark for sync."])),n,e,a),!1)})}),K.apply(this,arguments)}function Q(){return X.apply(this,arguments)}function X(){return X=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e,t=yield o("WAWebGetSyncAction").countSyncActionsInTransaction();(e=o("WAWebSyncdWamAppState")).setStoredMutationCount(t);var n=yield o("WAWebGetSyncAction").getSyncActionsByActionStatesInTransaction([o("WASyncdConst").SyncActionState.Malformed]);e.setInvalidActionCount(n.length);var r=yield o("WAWebGetSyncAction").getSyncActionsByActionStatesInTransaction([o("WASyncdConst").SyncActionState.Unsupported]);e.setUnsupportedActionCount(r.length);var a=yield o("WAWebGetMissingKey").getMissingKeyCountTransaction();e.setMissingKeyCount(a)}),X.apply(this,arguments)}function Y(){return J.apply(this,arguments)}function J(){return J=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){}),J.apply(this,arguments)}function Z(){return ee.apply(this,arguments)}function ee(){return ee=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){}),ee.apply(this,arguments)}function te(){var t=r("WAWebSyncdCollectionsStateMachine").getCollectionsInStateBlocked();return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: sync blocked collections: ",""])),t),r("WAWebSyncdCollectionsStateMachine").moveCollectionsToDirty(t),W=new Set([].concat(Array.from(W),Array.from(B))),o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncBlockedCollections:\n    	moving blocked collections to dirty: [","]\n    	adding inflight collections to pending: [","]"],["syncd: syncBlockedCollections:\n    \\tmoving blocked collections to dirty: [","]\n    \\tadding inflight collections to pending: [","]"])),t,Array.from(B)),ne()}function ne(){return re.apply(this,arguments)}function re(){return re=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebSyncdDisabled").isSyncdDisabled())return(w||(w=n("Promise"))).resolve();var e=r("WAWebSyncdCollectionsStateMachine").getCollectionsInStateDirty();o("WALogger").LOG(E||(E=babelHelpers.taggedTemplateLiteralLoose(["syncd: dirty collections: ",""])),e);var t=new Set(e.filter(function(e){return!B.has(e)}));if(t.size===0)return o("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: no collections to sync"]))),(w||(w=n("Promise"))).resolve();var a=[];try{B=new Set([].concat(Array.from(B),Array.from(t))),o("WALogger").LOG(I||(I=babelHelpers.taggedTemplateLiteralLoose(["syncd: initiate server sync"]))),a=yield o("WAWebSyncdServerSync").serverSync(Array.from(t)),o("WALogger").LOG(T||(T=babelHelpers.taggedTemplateLiteralLoose(["syncd: server sync successful"])));var i=a.filter(function(e){return e.state===o("WASyncdConst").CollectionState.ErrorRetry});i.length>0&&(H=i[0].serverBackoff||0,V=0),ue(a)}catch(e){o("WALogger").LOG(D||(D=babelHelpers.taggedTemplateLiteralLoose(["syncd: exception during sync(): ",""])),e),r("WAWebSyncdCollectionsStateMachine").moveCollectionsToFiniteRetry(Array.from(t))}finally{o("WALogger").LOG(x||(x=babelHelpers.taggedTemplateLiteralLoose(["syncd: cleanup after sync()"]))),r("WAWebSyncdCollectionsStateMachine").persistToDb(),B=new Set(Array.from(B).filter(function(e){return!t.has(e)})),se(),yield o("WAWebSyncdDbCallbacksApi").handleSyncCompleted(a)}}),re.apply(this,arguments)}function oe(){if(!o("WAWebSyncdDisabled").isSyncdDisabled()){var e=new Set(r("WAWebSyncdCollectionsStateMachine").getCollectionsInStateRetry());e.size!==0&&(q=setTimeout(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{U=!0,V+=1,o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: initiate server sync retry"])));var t=yield o("WAWebSyncdServerSync").serverSync(Array.from(e));o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["syncd: server sync retry successful"]))),ue(t)}catch(t){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["syncd: exception during handleRetry(): ",""])),t),r("WAWebSyncdCollectionsStateMachine").moveCollectionsToFiniteRetry(Array.from(e))}finally{o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: cleanup after handleRetry()"]))),yield ie(),r("WAWebSyncdCollectionsStateMachine").persistToDb(),U=!1,se()}}),ae(V,H)))}}function ae(e,t){var n=Math.pow(O,e)*A;return Math.min(Math.max(n,t),F)}function ie(){return le.apply(this,arguments)}function le(){return le=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=r("WAWebSyncdCollectionsStateMachine").getExpiredCollections();e.length>0&&(r("WAWebSyncdCollectionsStateMachine").moveCollectionsToFatal(e),yield o("WAWebSyncdDbCallbacksApi").printSyncdLog(),o("WALogger").ERROR($||($=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: expired collections"]))).sendLogs("syncd: fatal error: expired collections"),o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.TOO_MANY_INTERNAL_SERVER_ERRORS_IN_7D,{collection:e[0],lidMigrationStage:o("WAWebSyncdAntiTampering").getLidMigrationStage()}))}),le.apply(this,arguments)}function se(){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["syncd: state machine tick"]))),r("WAWebSyncdCollectionsStateMachine").getCollectionsInStateDirty().length>0&&(W=new Set(Array.from(W).filter(function(e){return B.has(e)})),ne());var e=r("WAWebSyncdCollectionsStateMachine").getCollectionsInStateRetry();if(e.length>0){if(U){o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["syncd: retry is in flight"])));return}q!=null&&clearTimeout(q),W=new Set(Array.from(W).filter(function(t){return!e.includes(t)})),oe()}r("WAWebSyncdCollectionsStateMachine").getCollectionsInStateFatal().length>0&&o("WAWebSyncdDbCallbacksApi").handleSyncdFatal({collections:r("WAWebSyncdCollectionsStateMachine").getCollectionsInStateFatal()})}function ue(e){return e.forEach(function(e){if(e.state===o("WASyncdConst").CollectionState.Success&&!W.has(e.name))return r("WAWebSyncdCollectionsStateMachine").moveCollectionsToUpToDate([e.name]);if(e.state===o("WASyncdConst").CollectionState.ErrorRetry)return o("WAWebSyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(o("WAWebSyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.ENTERED_RETRY_MODE),r("WAWebSyncdCollectionsStateMachine").moveCollectionsToFiniteRetry([e.name]);if(e.state===o("WASyncdConst").CollectionState.ErrorFatal)return r("WAWebSyncdCollectionsStateMachine").moveCollectionsToFatal([e.name]);if(e.state===o("WASyncdConst").CollectionState.Blocked&&!W.has(e.name))return r("WAWebSyncdCollectionsStateMachine").moveCollectionsToBlocked([e.name])})}function ce(){return de.apply(this,arguments)}function de(){return de=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(P||(P=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncPendingMutationsAndBlockedCollections"])));var e=yield o("WAWebGetPendingMutation").getAllSyncPendingMutationsInTransaction(),t=r("WAWebSyncdCollectionsStateMachine").getCollectionsInStateBlocked();r("WAWebSyncdCollectionsStateMachine").moveCollectionsToDirty(t);var n=e.map(function(e){return e.collection}).concat(t);n.length>0&&(o("WALogger").LOG(N||(N=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncPendingMutationsAndBlockedCollections: [","]"])),n),G(n))}),de.apply(this,arguments)}function me(){return r("WAWebSyncdCollectionsStateMachine").loadStatesFromDb().then(function(){return se()})}function pe(){return _e.apply(this,arguments)}function _e(){return _e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield o("WAWebSyncdOrphan").applyAllOrphansAndUnsupported(),o("WALogger").LOG(M||(M=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncing pending mutations and blocked collections due to app resume"]))),yield ce()}),_e.apply(this,arguments)}function fe(){return B}function ge(){return W}l.markCollectionsForSync=G,l.reportWam=Q,l.logKeysInfoInIntern=Z,l.syncBlockedCollections=te,l.initializeStateMachine=me,l.processOnAppResume=pe,l.getInFlightCollections=fe,l.getPendingCollections=ge}),98);
__d("WAWebSyncdMutationsCryptoUtils",["WACryptoAesCbc","WACryptoDependencies","WACryptoHmac","WASyncdKeyTypes","WAWebProtobufsServerSync.pb","WAWebSyncdCryptoConst","WAWebSyncdCryptoUtils","err"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){var n=o("WASyncdKeyTypes").fromSyncKeyId(t),a;switch(e){case o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET:a=o("WAWebSyncdCryptoConst").OPERATION_SET_HEX;break;case o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE:a=o("WAWebSyncdCryptoConst").OPERATION_REMOVE_HEX;break}if(a!=null){var i=new Uint8Array([parseInt(a,16)]).buffer,l=new Uint8Array(i.byteLength+n.byteLength);return l.set(new Uint8Array(i)),l.set(new Uint8Array(n),i.byteLength),l.buffer}throw r("err")("invalid mutation operation value")}function s(e,t){var n=Math.max(0,o("WAWebSyncdCryptoConst").MAX_OF_MIN_DATA_LENGTH-e-t),r=new Uint8Array(n);return o("WACryptoDependencies").getCrypto().getRandomValues(r),r.buffer}function u(e,t,n){return o("WACryptoAesCbc").aesCbcEncrypt(t,n,e)}function c(e,t,n){var r=new Uint8Array(o("WAWebSyncdCryptoConst").OCTET_LENGTH);r.set([e.byteLength],r.byteLength-1);var a=o("WAWebSyncdCryptoUtils").combine([e,t,r.buffer]);return o("WACryptoHmac").hmacSha512(n,a,o("WAWebSyncdCryptoConst").MAC_LENGTH)}function d(e,t,n){return o("WACryptoAesCbc").aesCbcDecrypt(t,e,n)}l.generateAssociatedData=e,l.generatePadding=s,l.generateCipherText=u,l.generateMac=c,l.decryptCipherText=d}),98);
__d("WAWebSyncdDecryptMutations",["WACryptoUtils","WALogger","WAWebProtobufSyncAction.pb","WAWebSyncdCrypto","WAWebSyncdCryptoConst","WAWebSyncdCryptoUtils","WAWebSyncdDecode","WAWebSyncdError","WAWebSyncdMetricFatalError","WAWebSyncdMutationsCryptoUtils","WAWebSyncdValidateSyncActionProtobuf","asyncToGeneratorRuntime","encodeProtobuf"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(e,t,n,r,o){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a,i,l){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: decrypting mutation"])));var c=l.index.blob,d=l.value.blob,m=o("WAWebSyncdCrypto").valueMacFromIndexAndValueCipherText(d),p=o("WAWebSyncdCryptoUtils").split(d,o("WAWebSyncdCryptoConst").IV_LENGTH,d.byteLength-o("WAWebSyncdCryptoConst").MAC_LENGTH-o("WAWebSyncdCryptoConst").IV_LENGTH),_=p[0],f=p[1],g=p[2],h=yield o("WAWebSyncdCrypto").generateEncryptionKeys(a),y=h.indexKey,C=h.valueEncryptionKey,b=h.valueMacKey,v=o("WAWebSyncdCryptoUtils").combine([_,f]),S=o("WAWebSyncdMutationsCryptoUtils").generateAssociatedData(i,n),R=yield o("WAWebSyncdMutationsCryptoUtils").generateMac(S,v,b);if(!o("WACryptoUtils").arrayBuffersEqual(g,R))throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: decrypting mutation failed: valueMAC mismatch"]))),o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.DECRYPTION_FAILED,{collection:t}),new(o("WAWebSyncdError")).SyncdFatalError("decryption failure: valueMAC mismatch");var L=yield o("WAWebSyncdMutationsCryptoUtils").decryptCipherText(new Uint8Array(_),C,f),E=o("WAWebSyncdDecode").decodeSyncActionData(t,L),k=r("WAWebSyncdValidateSyncActionProtobuf").validateSyncActionDataProtobuf(t,E),I=yield o("WAWebSyncdCrypto").generateIndexMac(y,k.index);if(!o("WACryptoUtils").arrayBuffersEqual(c,I))throw o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: decrypting mutation failed: indexMAC mismatch"]))),o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.DECRYPTION_FAILED,{collection:t}),new(o("WAWebSyncdError")).SyncdFatalError("decryption failure: indexMAC mismatch");var T=k.index,D=k.value,x=k.version;return{version:x,index:T,value:D?o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionValueSpec,D).readBuffer():null,indexMac:c,valueMac:m,plaintext:L}}),d.apply(this,arguments)}l.syncdDecryptMutation=c}),98);
__d("WAWebSyncdEncryptMutations",["WAArrayBufferUtils","WACryptoDependencies","WALogger","WAWebProtobufSyncAction.pb","WAWebSyncdCrypto","WAWebSyncdCryptoConst","WAWebSyncdCryptoUtils","WAWebSyncdError","WAWebSyncdMetricFatalError","WAWebSyncdMutationsCryptoUtils","WAWebSyncdRequestEncode","asyncToGeneratorRuntime","decodeProtobuf"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(e,t,n){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: encrypting mutation"])));try{var a,i=t.index,l=t.binarySyncAction,u=t.operation,c=t.version,m=o("WAArrayBufferUtils").stringToArrayBuffer(i),p=yield o("WAWebSyncdCrypto").generateEncryptionKeys(r),_=p.indexKey,f=p.valueEncryptionKey,g=p.valueMacKey,h=yield o("WACryptoDependencies").getCrypto().getRandomValues(new Uint8Array(o("WAWebSyncdCryptoConst").IV_LENGTH)),y=(a=o("WAWebSyncdMutationsCryptoUtils")).generatePadding(m.byteLength,l.byteLength),C=d(m,l,y,c),b=yield a.generateCipherText(h,f,C),v=a.generateAssociatedData(u,n),S=yield a.generateMac(v,b,g),R=o("WAWebSyncdCryptoUtils").combine([b,S]),L=yield o("WAWebSyncdCrypto").generateIndexMac(_,m);return{indexMac:L,indexAndValueCipherText:R}}catch(e){throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: encrypting mutation failed"]))),o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.ENCRYPTION_FAILED),new(o("WAWebSyncdError")).SyncdFatalError("encryption failure")}}),c.apply(this,arguments)}function d(e,t,n,r){return o("WAWebSyncdRequestEncode").encodeSyncActionData({index:e,value:o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionValueSpec,t),padding:n,version:r})}l.syncdEncryptMutation=u}),98);
__d("WAWebSyncdEncryptionManager",["WACryptoHmac","WAEncodeString","WAWebSyncdCrypto","WAWebSyncdCryptoUtils","WAWebSyncdDecryptMutations","WAWebSyncdEncryptMutations","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n,r){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=yield o("WAWebSyncdCrypto").generateEncryptionKeys(e),i=a.snapshotMacKey,l=o("WAEncodeString").toUtf8(r).buffer,s=o("WAWebSyncdCryptoUtils").to64BitNetworkOrder(n);return o("WACryptoHmac").hmacSha256(i,o("WAWebSyncdCryptoUtils").combine([t,s,l]))}),s.apply(this,arguments)}function u(e,t,n,r,o){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a){var i=yield o("WAWebSyncdCrypto").generateEncryptionKeys(e),l=i.patchMacKey,s=o("WAEncodeString").toUtf8(a).buffer,u=o("WAWebSyncdCryptoUtils").to64BitNetworkOrder(r);return o("WACryptoHmac").hmacSha256(l,o("WAWebSyncdCryptoUtils").combine([t].concat(n,[u,s])))}),c.apply(this,arguments)}var d={encryptMutation:o("WAWebSyncdEncryptMutations").syncdEncryptMutation,decryptMutation:o("WAWebSyncdDecryptMutations").syncdDecryptMutation,generatePatchMac:u,generateSnapshotMac:e};l.WASyncdEncryptionManager=d}),98);
__d("WAWebEncryptionManagerSelector",["WASyncdKmpEncryptionManager","WAWebABProps","WAWebSyncdEncryptionManager"],(function(t,n,r,o,a,i,l){"use strict";function e(){return o("WAWebABProps").getABPropConfigValue("kmp_syncd_engine_crypto_enabled")?o("WASyncdKmpEncryptionManager").WASyncdKmpEncryptionManager:o("WAWebSyncdEncryptionManager").WASyncdEncryptionManager}l.syncdEncryptionManager=e}),98);
__d("WAWebKeyManagementUtils",["WALogger","WAWebApiDeviceList","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=[],n=o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow();try{var r=yield o("WAWebApiDeviceList").getMyDeviceList();r.devices.forEach(function(e){e.id!==n.getDeviceId()&&t.push(o("WAWebWidFactory").createDeviceWidFromUserAndDevice(n.user,n.server,e.id))})}catch(t){var a=String(t);return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: getPeerDevices: error ",". Future key requests will only be sent to primary device."])),a).sendLogs(a),[o("WAWebWidFactory").createDeviceWidFromUserAndDevice(n.user,n.server,0)]}return t}),u.apply(this,arguments)}l.getPeerDevices=s}),98);
__d("WAWebSyncdKeyCache",["WABase64","WASyncdKeyTypes","WAWebGetSyncKey","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e=new Map;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n,r=o("WABase64").encodeB64(o("WASyncdKeyTypes").fromSyncKeyId(t)),a=e.get(r);return a?a.keyData:(a=yield o("WAWebGetSyncKey").getSyncKeyInTransaction_DO_NOT_USE(t),a&&e.set(r,a),(n=a)==null?void 0:n.keyData)}),u.apply(this,arguments)}function c(){e=new Map}l.getKeyData=s,l.clearSyncKeysCache=c}),98);
__d("WAWebSyncdMetrics",["$InternalEnum","WALogger","WAPREList","WAPREMetrics","WASyncdConst"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y,C=n("$InternalEnum").Mirrored(["MISSING_MUTATION_TO_REMOVE"]),b=n("$InternalEnum").Mirrored(["SNAPSHOT_USED","SNAPSHOT_NOT_USED"]),v=n("$InternalEnum").Mirrored(["APP_STATE_SYNC_KEY_EXPIRY","DEVICE_DEREGISTERATION","NO_KEYS"]);function S(e){var t=o("WAPREMetrics").startMetric(o("WAPREList").PRE_METRIC.SYNCD_BOOTSTRAP_APP_STATE_DOWNLOAD);e.isSuccess!=="success"?t.endFail("syncd error: Error downloading snapshot or patches",k(e)):t.endSuccess(k(e))}function R(e,t,n){o("WAPREMetrics").startMetric(o("WAPREList").PRE_METRIC.SYNCD_BOOTSTRAP_DATA_APPLIED).endSuccess(I({collection:e,snapshotUsed:t,durationMs:n}))}function L(e,t){o("WAPREMetrics").startMetric(o("WAPREList").PRE_METRIC.SYNCD_CRITICAL_EVENT).endFail("syncd critical event: "+e,T({type:e,collection:t}))}function E(e){o("WAPREMetrics").startMetric(o("WAPREList").PRE_METRIC.SYNCD_KEY_ROTATION).endSuccess(D({type:e}))}function k(e){var t=e.collection,n=e.downloadSize,r=e.downloadStartTs,o=e.isSuccess;return{string:{collection:t},int:{downloadSize:n,downloadStartTs:r},bool:{isSuccess:o==="success"}}}function I(e){return{string:{collection:e.collection},bool:{snapshot:e.snapshotUsed===b.SNAPSHOT_USED},int:{durationMs:e.durationMs}}}function T(e){return{string:{criticalEventCode:e.type,collection:e.collection==null?null:e.collection}}}function D(e){return{string:{keyRotationEventCode:e.type}}}function x(t){var n,r,a,i,l=t==null||(n=t.string)==null?void 0:n.collection,d=t==null||(r=t.int)==null?void 0:r.downloadSize,m=t==null||(a=t.int)==null?void 0:a.downloadStartTs,p=t==null||(i=t.bool)==null?void 0:i.isSuccess;if(l==null)return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing collection for bootstrap app state download metric"]))),null;if(m==null)return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing downloadStartTs for bootstrap app state download metric"]))),null;if(p==null)return o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing isSuccess for bootstrap app state download metric"]))),null;var _=o("WASyncdConst").CollectionName.cast(l);if(_==null)return o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown collection "," for bootstrap app state download metric"])),l),null;var f=p?"success":"failure";return{collection:_,downloadStartTs:m,downloadSize:d,isSuccess:f}}function $(e){var t,n,r,a=e==null||(t=e.string)==null?void 0:t.collection,i=e==null||(n=e.bool)==null?void 0:n.snapshot,l=e==null||(r=e.int)==null?void 0:r.durationMs;if(a==null)return o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing collection for bootstrap data applied event"]))),null;if(i==null)return o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing snapshotUsed for bootstrap data applied event"]))),null;if(l==null)return o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing durationMs for bootstrap data applied event"]))),null;var s=o("WASyncdConst").CollectionName.cast(a);if(s==null)return o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown collection "," for bootstrap data applied event"])),a),null;var u=i?b.SNAPSHOT_USED:b.SNAPSHOT_NOT_USED;return{collection:s,snapshotUsed:u,durationMs:l}}function P(e){var t,n,r=e==null||(t=e.string)==null?void 0:t.criticalEventCode;if(r==null)return o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing error code for critical event"]))),null;var a=C.cast(r);return a==null?(o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown error code: "," for critical event"])),r),null):{type:a,collection:o("WASyncdConst").CollectionName.cast(e==null||(n=e.string)==null?void 0:n.collection)}}function N(e){var t,n=e==null||(t=e.string)==null?void 0:t.keyRotationEventCode;if(n==null)return o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing error code for key rotation event"]))),null;var r=v.cast(n);return r==null?(o("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown error code: "," for key rotation event"])),n),null):{type:r}}function M(e){var t={};return Object.keys(e).forEach(function(n){typeof e[n]=="number"?(t.int==null&&(t.int={}),t.int[n]=e[n]):typeof e[n]=="string"&&(t.string==null&&(t.string={}),t.string[n]=e[n])}),Object.keys(t).length>0?t:void 0}var w=(function(){function e(){this.event=o("WAPREMetrics").startMetric(o("WAPREList").PRE_METRIC.SYNCD)}var t=e.prototype;return t.end=function(t){t===void 0&&(t=!1),t?this.event.endFail("syncd failed"):this.event.endSuccess()},t.mark=function(t,n){this.event.addPoint(t,M(n))},e})();l.SyncdCriticalEventType=C,l.SyncdBootstrapDataAppliedSnapshotUsed=b,l.SyncdKeyRotationEventType=v,l.reportSyncdBootstrapAppStateDownloadMetric=S,l.reportSyncdBootstrapDataApplied=R,l.reportSyncdCriticalEvent=L,l.reportSyncdKeyRotationEvent=E,l.convertSyncdBootstrapAppStateDownloadFromAnnotations=x,l.convertSyncdBootstrapDataAppliedFromAnnotations=$,l.convertSyncdCriticalEventFromAnnotations=P,l.convertSyncdKeyRotationEventFromAnnotations=N,l.constructAnnotationsFromContext=M,l.SyncdEventFlow=w}),98);
__d("WAWebSyncdAntiTampering",["$InternalEnum","Promise","WACryptoLtHash","WACryptoUtils","WAEncodeString","WAJids","WALogger","WAPromiseEach","WASyncdConst","WASyncdKeyTypes","WATextEncoding","WAWebABProps","WAWebConnModel","WAWebCurrentUser","WAWebEncryptionManagerSelector","WAWebGetCollectionVersion","WAWebGetSyncAction","WAWebKeyManagementUtils","WAWebLid1X1MigrationGating","WAWebProtobufsServerSync.pb","WAWebRunInTransaction","WAWebSyncdCrypto","WAWebSyncdCryptoUtils","WAWebSyncdDb","WAWebSyncdDbCallbacksApi","WAWebSyncdError","WAWebSyncdKeyCache","WAWebSyncdMetricFatalError","WAWebSyncdMetrics","WAWebSyncdSnapshotRecoveryGatingUtils","WAWebUserPrefsTypes","WAWebWamEnumIsPureSyncdSessionEnum","WAWebWamEnumLidMigrationStageEnum","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x,$,P,N,M,w,A,F,O,B,W,q=n("$InternalEnum").Mirrored(["Incoming","Outgoing"]),U=[(W=o("WASyncdConst")).Actions.LocaleSetting,W.Actions.SettingPushName,"generated_wui",W.Actions.Sentinel,W.Actions.PrimaryVersion,W.Actions.TimeFormat,W.Actions.Nux,W.Actions.BotWelcomeRequest,W.Actions.DeviceCapabilities,W.Actions.Archive,W.Actions.LockChat,W.Actions.FavoriteSticker,W.Actions.ChatLockSettings,W.Actions.MarkChatAsRead,W.Actions.NoteEdit,W.Actions.Pin,W.Actions.PinDEPRECATED,W.Actions.RemoveRecentSticker,W.Actions.UnarchiveChatsSetting,W.Actions.AndroidUnsupportedActions];function V(e,t,n){n===void 0&&(n=!0);var r=typeof e=="string"?e:o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(e),a=typeof t=="string"?t:o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(t),i=n?-16:0;return r.slice(i)+":"+a.slice(i)}var H=o("WATextEncoding").newTextDecoder();function G(e,t,n){return z.apply(this,arguments)}function z(){return z=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){var a=n.mac,i=n.version,l=n.keyId,u=n.records,c=yield o("WAWebSyncdKeyCache").getKeyData(l.id);if(!c)throw new(o("WAWebSyncdError")).SyncdMissingKeyError;var d=new Map(u.map(function(e){return[o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(e.index.blob),o("WAWebSyncdCrypto").valueMacFromIndexAndValueCipherText(e.value.blob)]}));o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd:\n  "," snapshot macsToAdd:\n      ",""])),r,t,Array.from(d.entries()).map(function(e){var t=e[0],n=e[1];return V(t,n)}).join("\n	"));var m=yield o("WACryptoLtHash").LT_HASH_ANTI_TAMPERING.add(o("WACryptoLtHash").EMPTY_LT_HASH,Array.from(d.values())),p=yield o("WAWebSyncdCrypto").generateEncryptionKeys(c),_=p.snapshotMacKey,f=o("WAWebSyncdCryptoUtils").to64BitNetworkOrder(i.version),g=o("WAEncodeString").toUtf8(t).buffer;return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: validating snapshot mac for "," snapshot v",":\n  ltHash: ","\n  encoded version: ","\n  encoded collection: ","\n  expected snapshotMAC: ","\n  "])),r,t,i.version,o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(m),o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(f),o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(g),o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(a)).devConsole("\n  --- DEV ONLY ---\n  snapshotMacKey: "+o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(_)),yield Y(t,a,c,m,f,g,!0,u.length,n.version.version,null,null,null,null,r),m}),z.apply(this,arguments)}function j(e,t,n,r){return K.apply(this,arguments)}function K(){return K=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,a){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: computeLtHashAndValidatePatch for ",""])),r,e);var i=t.version,l=t.mutations,s=t.snapshotMac,m=t.patchMac,p=t.keyId,_=p.id,f=yield o("WAWebSyncdKeyCache").getKeyData(_);if(!f)throw new(o("WAWebSyncdError")).SyncdMissingKeyError;var g=l.map(function(e){return{operation:e.operation,indexMac:e.record.index.blob,valueMac:o("WAWebSyncdCrypto").valueMacFromIndexAndValueCipherText(e.record.value.blob)}}),h=yield o("WAWebGetCollectionVersion").getCollectionVersionLtHashInTransaction(e),y=yield re(e,g,r,a,t.version.version,q.Incoming,h),C=o("WAWebSyncdCryptoUtils").to64BitNetworkOrder(i.version),b=o("WAEncodeString").toUtf8(e).buffer;o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: validating snapshot and patch mac for "," v",":\n  expected snapshotMAC: ","\n  expected patchMAC: ","\n  encoded version: ","\n  encoded collection: ","\n  key ID: ","\n  "])),r,e,i.version,o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(s),o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(m),o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(C),o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(b),o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(o("WASyncdKeyTypes").fromSyncKeyId(_)));try{yield Z(e,m,f,s,g.map(function(e){return e.valueMac}),l.length,i.version,r),yield Y(e,s,f,y.ltHash,C,b,!1,l.length,i.version,t.clientDebugData,h,y,t.deviceIndex,r)}catch(e){throw yield v(),e}return y.ltHash;function v(){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield de(e,r,"logErrorDiagnostics",!1),n=new Map(t.map(function(e){var t=e.indexMac,n=e.valueMac;return[o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(t),o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(n)]}));o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: error on incoming records:\n    	",""],["[","] syncd: error on incoming records:\n    \\t",""])),r,g.map(function(e){var t=e.operation,r=e.indexMac,a=e.valueMac;return(t===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET?"set":"remove")+" | "+V(r,a,!1)+" | "+(n.has(o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(r))?"found":"did not find")+" indexMAC in the above logged macs"}).join("\n	"))}),S.apply(this,arguments)}}),K.apply(this,arguments)}function Q(e,t,n){return X.apply(this,arguments)}function X(){return X=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield o("WAWebGetCollectionVersion").getCollectionVersionInTransaction(e).then(function(e){var t;return(t=e==null?void 0:e.version)!=null?t:0});if(r!==t-1){var a=r>t-1?"greater-than-expected":"less-than-expected";throw o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: "," received patch v"," !== latest local version (v",") + 1"])),n,e,t,r).sendLogs("syncd-version-check-error-local-version-"+a),yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+n+"] received patch v"+t+" !== latest local version (v"+r+") + 1"),new(o("WAWebSyncdError")).SyncdRetryableError("syncd-version-check-error-local-version-"+a)}var i=yield o("WAWebGetCollectionVersion").getCollectionVersionLtHashInTransaction(e);if(o("WACryptoUtils").arrayBuffersEqual(i,o("WACryptoLtHash").EMPTY_LT_HASH)&&t!==1)throw o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: empty local lthash found when processing "," patch v",""])),n,e,t).sendLogs("syncd-empty-lthash-on-mac-mismatch"),new(o("WAWebSyncdError")).SyncdRetryableError("empty lthash")}),X.apply(this,arguments)}function Y(e,t,n,r,o,a,i,l,s,u,c,d,m,p){return J.apply(this,arguments)}function J(){return J=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a,i,l,s,u,c,d,m,p,L){var E,k=!l,I=(E=yield o("WAWebGetCollectionVersion").getIsCollectionInMacMismatchFatalInTransaction(e))!=null?E:!1;if(k&&I){o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: collection "," is already in snapshot mac mismatch so not checking again"])),L,e);return}var T=o("WAWebEncryptionManagerSelector").syncdEncryptionManager().generateSnapshotMac,D=yield T(n,r,u,e),x=o("WACryptoUtils").arrayBuffersEqual(D,t),$=o("WAWebSyncdSnapshotRecoveryGatingUtils").shouldPreformSnapshotRecovery(e,s,new(o("WAWebSyncdError")).SyncdFatalError("probe")),P=!x&&l&&$.shouldPerformRecovery;if(!x){P&&o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: snapshot mac mismatch, will perform recovery for "," v"," with "," mutations"])),L,e,u,s),o("WALogger").DEV(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd:\n      expected snapshotMAC: ","\n      computed snapshotMAC: ",""])),L,o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(t),o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(D)),l||(yield Q(e,u,L)),yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+L+"] failed validate snapshot mac");var N=yield ae(L,e),M=N.isLtHashConsistent,w=N.scratchLtHash,A=l?o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.SNAPSHOT_MAC_MISMATCH_IN_SNAPSHOT:o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.SNAPSHOT_MAC_MISMATCH_IN_PATCH,F=(c==null?void 0:c.collectionName)&&!o("WACryptoUtils").arrayBuffersEqual(i,c==null?void 0:c.collectionName),O=(c==null?void 0:c.newLthash)&&!o("WACryptoUtils").arrayBuffersEqual(r,c==null?void 0:c.newLthash),B=(c==null?void 0:c.patchVersion)&&!o("WACryptoUtils").arrayBuffersEqual(a,c==null?void 0:c.patchVersion),W=(c==null?void 0:c.currentLthash)&&d&&!o("WACryptoUtils").arrayBuffersEqual(d,c==null?void 0:c.currentLthash),q=(c==null?void 0:c.newLthashSubtract)&&(m==null?void 0:m.subtractResult)&&!o("WACryptoUtils").arrayBuffersEqual(m==null?void 0:m.subtractResult,c==null?void 0:c.newLthashSubtract),U=m==null?void 0:m.hasOverride,V=m==null?void 0:m.numAdd,H=m==null?void 0:m.numRemove,G=(c==null?void 0:c.currentLthash)&&w&&!o("WACryptoUtils").arrayBuffersEqual(w,c==null?void 0:c.currentLthash),z=p===0,j=(c==null?void 0:c.numberAdd)!=null&&(m==null?void 0:m.numAdd)!=null&&(m==null?void 0:m.numAdd)!==(c==null?void 0:c.numberAdd),K=(c==null?void 0:c.numberRemove)!=null&&(m==null?void 0:m.numRemove)!=null&&(m==null?void 0:m.numRemove)!==(c==null?void 0:c.numberRemove),X=m==null?void 0:m.didUseFallback,Y=m==null?void 0:m.hasMissingRemove,J=(yield o("WAWebKeyManagementUtils").getPeerDevices()).length>1;if(o("WAWebSyncdMetricFatalError").reportSyncdFatalError(A,{collection:e,patchSnapshotMutationCount:s,patchVersion:u,isFatal:!k,isLtHashConsistent:M,macFatalCollectionNameMismatch:F,macFatalCurrentLthashMismatch:W,macFatalNewLthashMismatch:O,macFatalPatchVersionMismatch:B,macFatalNewLthashSubtractMismatch:q,macFatalNumberHasOverrideMutation:U,macFatalNumberNumAddMutation:V,macFatalNumberNumRemoveMutation:H,macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:G,isPatchSenderPrimary:z,macFatalDidUseMacFetchFallback:X,macFatalHasMissingRemove:Y,macFatalNumberAddMismatch:j,macFatalNumberRemoveMismatch:K,isThereAnotherSyncdCompanion:J,isPureSyncdSession:yield ge(),lidMigrationStage:fe(),recoveryStatus:$.reason},P),o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: fatal extra details:\n      mdFatalErrorCode: ",",\n      collection: ",",\n      mutationCount: ",",\n      patchVersion: ",",\n      isLtHashConsistent: ",",\n      macFatalCollectionNameMismatch: ",",\n      macFatalCurrentLthashMismatch: ",",\n      macFatalNewLthashMismatch: ",",\n      macFatalPatchVersionMismatch: ",",\n      macFatalNewLthashSubtractMismatch: ",",\n      macFatalNumberHasOverrideMutation: ",",\n      macFatalNumberNumAddMutation: ",",\n      macFatalNumberNumRemoveMutation: ",",\n      macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch: ",",\n      isPatchSenderPrimary: ",",\n      macFatalDidUseMacFetchFallback: ",",\n      macFatalHasMissingRemove: ",",\n      macFatalNumberAddMismatch: ",",\n      macFatalNumberRemoveMismatch: ",",\n      isThereAnotherSyncdCompanion: ","\n    "])),L,A,e,s,u,M,F,W,O,B,q,U,V,H,G,z,X,Y,j,K,J),k){yield o("WAWebSyncdDbCallbacksApi").printSyncdLog(e);var Z="syncd: unable to validate snapshot mac. collection: "+e;if(o("WAWebCurrentUser").isEmployee())o("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[","] ",""])),L,Z).sendLogs(Z,{sampling:1});else if(c!=null){var ee=Z+" (additional info)";o("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[","] ",""])),L,ee).sendLogs(ee,{sampling:1})}else o("WALogger").ERROR(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[","]  ",""])),L,Z).sendLogs(Z,{sampling:.01});if(yield o("WAWebGetCollectionVersion").updateIsCollectionInMacMismatchFatalInTransaction(e),o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: skip fatal after snapshot mac mismatch for collection ",""])),L,e),G===!1&&W===!0){var te;o("WALogger").LOG(S||(S=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: clientDebugData?.currentLthash: ",",\n        scratchLtHash: ",",\n        currentLtHash: ",""])),L,o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded((te=c==null?void 0:c.currentLthash)!=null?te:new ArrayBuffer(0)).slice(-16),o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(w!=null?w:new ArrayBuffer(0)).slice(-16),o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(d!=null?d:new ArrayBuffer(0)).slice(-16)),o("WALogger").ERROR(R||(R=babelHelpers.taggedTemplateLiteralLoose(["syncd: snapshot_mac_mismatch_in_patch due to cache mismatch"]))).sendLogs("syncd: snapshot_mac_mismatch_in_patch due to cache mismatch")}return}throw new(o("WAWebSyncdError")).SyncdFatalError("unable to validate snapshot mac")}}),J.apply(this,arguments)}function Z(e,t,n,r,o,a,i,l){return ee.apply(this,arguments)}function ee(){return ee=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a,i,l,s){var u=o("WAWebEncryptionManagerSelector").syncdEncryptionManager().generatePatchMac,c=yield u(n,r,a,l,e),d=o("WACryptoUtils").arrayBuffersEqual(c,t);if(!d)throw yield Q(e,l,s),yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"failed validate patch mac"),o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MAC_MISMATCH_PATCH,{collection:e,patchSnapshotMutationCount:i,patchVersion:l}),o("WALogger").WARN(L||(L=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: unable to validate patch mac."])),s).sendLogs("syncd: unable to validate patch mac."),o("WALogger").DEV(E||(E=babelHelpers.taggedTemplateLiteralLoose(["syncd:\n      expected patchMAC: ","$\n      computed patchMAC: ",""])),t,c),new(o("WAWebSyncdError")).SyncdFatalError("unable to validate patch mac")}),ee.apply(this,arguments)}function te(e,t,n,r){return ne.apply(this,arguments)}function ne(){return ne=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=(yield o("WAWebGetCollectionVersion").getCollectionVersionInTransaction(e).then(function(e){var t;return(t=e==null?void 0:e.version)!=null?t:o("WASyncdConst").DEFAULT_COLLECTION_VERSION}))+1,i=o("WAWebSyncdCryptoUtils").to64BitNetworkOrder(a),l=o("WAEncodeString").toUtf8(e).buffer,s=o("WAWebEncryptionManagerSelector").syncdEncryptionManager(),u=yield s.generateSnapshotMac(r,t,a,e),c=yield s.generatePatchMac(r,u,n.map(function(e){return e.valueMac}),a,e),d=yield o("WAWebSyncdCrypto").generateEncryptionKeys(r),m=d.patchMacKey,p=d.snapshotMacKey;return o("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: computing snapshot and patch macs for outgoing patch "," v",":\n  encoded version: ","\n  encoded collection: ","\n  snapshotMAC: ","\n  patchMAC: ",""])),e,a,o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(i),o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(l),o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(u),o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(c)).devConsole("\n  --- DEV ONLY ---\n  snapshotMacKey: "+o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(p)+"\n  patchMacKey: "+o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(m)),{snapshotMac:u,patchMac:c}}),ne.apply(this,arguments)}function re(e,t,n,r,o,a,i){return oe.apply(this,arguments)}function oe(){return oe=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,a,i,l,s){var u=o("WAWebABProps").getABPropConfigValue("enable_syncd_debug_data_in_patch")||e===o("WASyncdConst").CollectionName.CriticalBlock||l===q.Outgoing,c=s!=null?s:yield o("WAWebGetCollectionVersion").getCollectionVersionLtHashInTransaction(e),d=yield se(t.map(function(e){return e.indexMac})),m=new Map,p=new Map,_=new Map,f=!1,g=!1;yield o("WAPromiseEach").promiseEach(t,(function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n,a){var s=n.indexMac,u=n.valueMac,c=n.operation,h=H.decode(s),y=d.get(h);if(y)c===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE?p.set(o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(s),y.valueMac):_.set(o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(s),y.valueMac);else if(c===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE){var C=yield S(s);if(C!=null){var b;p.set(o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(s),C),g=!0,o("WALogger").WARN(I||(I=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: had to use fallbackQueryForValueMac in collection "," for platform ",": ","\n        }"])),r,e,(b=o("WAWebConnModel").Conn.platform)!=null?b:"[empty]",o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(s).slice(-16)).tags("non-sad").sendLogs("syncd: fallback query"),yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+r+"] used fallback for "+o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(s))}else{var v,R,L;f=!0,yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+r+"] incoming REMOVE mutation missing in local snapshot for collection "+e+" version "+((v=i==null?void 0:i.toString())!=null?v:"n/a")+": "+o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(s)),yield de(e,r,"REMOVE missing",!1);var E="\n          syncUseMultipleMacQueries: true\n          input mutations mac:\n          "+t.map(function(e){return(e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET?"SET ":"REMOVE ")+V(e.indexMac,e.valueMac)}).join("\n	")+"\n          currentMacs: "+Array.from(d.values()).map(function(e){return V(e.indexMac,e.valueMac)}).join(", ")+"\n        ";o("WALogger").LOG(T||(T=babelHelpers.taggedTemplateLiteralLoose(["",""])),E),yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"missing remove additional info: "+E),o("WAWebSyncdMetrics").reportSyncdCriticalEvent(o("WAWebSyncdMetrics").SyncdCriticalEventType.MISSING_MUTATION_TO_REMOVE,e);var k="["+r+"] syncd: missing indexMAC in sync-actions table for REMOVE mutation in collection "+e+" version "+((R=i==null?void 0:i.toString())!=null?R:"n/a")+" direction "+(l||"n/a")+" for platform "+((L=o("WAWebConnModel").Conn.platform)!=null?L:"[empty]")+": "+o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(s).slice(-16);e===o("WASyncdConst").CollectionName.CriticalBlock?(yield o("WAWebSyncdDbCallbacksApi").printSyncdLog(e),o("WALogger").ERROR(D||(D=babelHelpers.taggedTemplateLiteralLoose(["",""])),k).sendLogs("syncd: missing indexMAC from REMOVE in collection "+e)):o("WALogger").ERROR(x||(x=babelHelpers.taggedTemplateLiteralLoose(["",""])),k).sendLogs("syncd: missing indexMAC from REMOVE in collection "+e,{sampling:.01})}}c===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET&&m.set(o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(s),u)});return function(e,t){return a.apply(this,arguments)}})());var h=yield o("WACryptoLtHash").LT_HASH_ANTI_TAMPERING.subtractThenAdd(c,Array.from(m.values()),Array.from(p.values()).concat(Array.from(_.values()))),y=h.ltHash,C=h.subtractResult,b="["+r+"] syncd: computing ltHash for "+e+":\n  mutations length: "+t.length+"\n  currentLtHash: "+o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(c).slice(-16)+"\n  subtractResult: "+o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(C).slice(-16)+"\n  currentMacs length: "+d.size+"\n  macsToAdd:\n      "+Array.from(m.entries()).map(function(e){var t=e[0],n=e[1];return V(t,n)}).join("\n	")+"\n  macsToRemove:\n      "+Array.from(p.entries()).map(function(e){var t=e[0],n=e[1];return V(t,n)}).join("\n	")+"\n  macsToOverwrite (also remove):\n      "+Array.from(_.entries()).map(function(e){var t=e[0],n=e[1];return V(t,n)}).join("\n	")+"\n  newLtHash: "+o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(y).slice(-16)+"\n  hasMissingRemove: "+f.toString()+"\n  didUseFallback: "+g.toString();if(o("WALogger").LOG($||($=babelHelpers.taggedTemplateLiteralLoose(["",""])),b),yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"generate lthash details 1: "+b),u){var v="\n      input mutations mac:\n      "+t.map(function(e){return(e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET?"SET ":"REMOVE ")+V(e.indexMac,e.valueMac)}).join("\n	")+"\n      currentMacs: "+Array.from(d.values()).map(function(e){return V(e.indexMac,e.valueMac)}).join(", ")+"\n    ";o("WALogger").LOG(P||(P=babelHelpers.taggedTemplateLiteralLoose(["",""])),v),yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"generate lthash details 2: "+v)}return{ltHash:y,numAdd:m.size,numRemove:p.size,hasOverride:_.size>0,subtractResult:C,hasMissingRemove:f,didUseFallback:g};function S(e){return a==null?(B||(B=n("Promise"))).resolve(null):a(e)}}),oe.apply(this,arguments)}function ae(e,t,n){return ie.apply(this,arguments)}function ie(){return ie=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){var a=o("WAWebCurrentUser").isEmployee()?900:r,i=yield o("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0,CollectionVersionStore:!0},(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var r=e.SyncActionStore,o=e.CollectionVersionStore,a=t==null?yield o.getAll():[yield o.get(t)];return(B||(B=n("Promise"))).all(a.filter(Boolean).map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.collection,n=e.ltHash,o=yield r.getByCollections([t]);return{collection:t,ltHash:n,mutations:o}});return function(t){return e.apply(this,arguments)}})()))});return function(t){return e.apply(this,arguments)}})()),l=0;if(i.map(function(e){var t=e.collection,n=e.ltHash,r=e.mutations;l+=r.length}),a!==void 0&&l>a)return{isLtHashConsistent:void 0,scratchLtHash:void 0,cachedLtHash:void 0};var s=null,u=null,c=!0;return yield(B||(B=n("Promise"))).all(i.map((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.collection,r=t.ltHash,a=t.mutations,i=yield le(a);s==null&&(s=i),u==null&&(u=r),o("WACryptoUtils").arrayBuffersEqual(r,i)||l>0&&(c=!1,o("WALogger").ERROR(N||(N=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: failed LtHash check for ",""])),e,n).verbose())});return function(e){return t.apply(this,arguments)}})())),{isLtHashConsistent:c,scratchLtHash:s,cachedLtHash:u}}),ie.apply(this,arguments)}function le(e){var t=new Map(e.map(function(e){return[o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(e.indexMac),e.valueMac]}));return o("WACryptoLtHash").LT_HASH_ANTI_TAMPERING.add(o("WACryptoLtHash").EMPTY_LT_HASH,Array.from(t.values()))}function se(e){return ue.apply(this,arguments)}function ue(){return ue=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebGetSyncAction").getSyncActionsByIndexMacsInTransaction(e);return new Map(t.map(function(e){return[H.decode(e.indexMac),{indexMac:e.indexMac,valueMac:e.valueMac}]}))}),ue.apply(this,arguments)}function ce(e,t){var n=t.action;if(n&&(o("WAWebCurrentUser").isEmployee()||e===o("WASyncdConst").CollectionName.RegularLow||e===o("WASyncdConst").CollectionName.CriticalBlock||U.includes(n))){if(n===o("WASyncdConst").Actions.DeviceCapabilities){if(o("WAWebCurrentUser").isEmployee())return t.index;var r=t.index.indexOf(":");return"device_capabilities:"+t.index.slice(r-4)}return n}}function de(e,t,n,r){return me.apply(this,arguments)}function me(){return me=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,a){a===void 0&&(a=!0);var i=a?20:1;o("WALogger").LOG(M||(M=babelHelpers.taggedTemplateLiteralLoose(["syncd: logMacs: ",": prepare"])),e);var l=yield o("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0,CollectionVersionStore:!0},function(t){var r=t.SyncActionStore,o=t.CollectionVersionStore;return(B||(B=n("Promise"))).all([o.get(e).then(function(e){return e==null?void 0:e.version}),r.getByCollections([e])])}),s=l[0],u=l[1];o("WALogger").LOG(w||(w=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: current snapshot "," v"," with "," mutations. context "," mutations:"])),t,e,s,u.length,r);var c=o("WAWebCurrentUser").isEmployee()?200:120;if(a&&u.length>c)return u;var d=u.reduce(function(t,n,r){var o;return r%i===0&&t.push(""),t[t.length-1]+=V(n.indexMac,n.valueMac,a)+(" "+((o=ce(e,n))!=null?o:"n/a")+" | "),t},[]);return d.forEach(function(e){return o("WALogger").LOG(A||(A=babelHelpers.taggedTemplateLiteralLoose(["|",""])),e)}),(e===o("WASyncdConst").CollectionName.CriticalBlock||e===o("WASyncdConst").CollectionName.RegularLow||o("WAWebCurrentUser").isEmployee())&&(yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"current local snapshot for "+e+" v"+(s!=null?s:"n/a")+" mutation length "+u.length+" context "+r+": "+d.join("\n"))),u}),me.apply(this,arguments)}function pe(e,t,n,r){return _e.apply(this,arguments)}function _e(){return _e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){r===void 0&&(r=400);var a=yield ae(n,e,r),i=a.isLtHashConsistent,l=a.scratchLtHash,s=a.cachedLtHash,u=l==null?"":o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(l).slice(-16),c=s==null?"":o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(s).slice(-16);if(i===!1){yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+n+"] lthash first time inconsistent. scratchLtHash: "+u+", cachedLtHash: "+c+", context: "+t),yield o("WAWebSyncdDbCallbacksApi").printSyncdLog(e);var d="syncd: lthash inconsistent";return e===o("WASyncdConst").CollectionName.CriticalBlock||o("WAWebCurrentUser").isEmployee()?o("WALogger").ERROR(F||(F=babelHelpers.taggedTemplateLiteralLoose([""," first time for ",""])),d,e).verbose().sendLogs(d):o("WALogger").ERROR(O||(O=babelHelpers.taggedTemplateLiteralLoose([""," first time for ",""])),d,e).verbose().sendLogs(d,{sampling:.01}),!0}else if(i===!0)return yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"lthash consistent. scratchLtHash: "+u+", cachedLtHash: "+c+", context: "+t),!1;yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"lthash unknown if consistent. scratchLtHash: "+u+", cachedLtHash: "+c+", context: "+t)}),_e.apply(this,arguments)}function fe(){return o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()?o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.lidMigrationSource()===o("WAWebUserPrefsTypes").LidMigrationSource.PEER?o("WAWebWamEnumLidMigrationStageEnum").LID_MIGRATION_STAGE_ENUM.PEER_MIGRATED:o("WAWebWamEnumLidMigrationStageEnum").LID_MIGRATION_STAGE_ENUM.HISTORY_MIGRATED:o("WAWebWamEnumLidMigrationStageEnum").LID_MIGRATION_STAGE_ENUM.NOT_MIGRATED}function ge(){return he.apply(this,arguments)}function he(){return he=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isPureLidSyncDSession();if(e!=null)return e?o("WAWebWamEnumIsPureSyncdSessionEnum").IS_PURE_SYNCD_SESSION_ENUM.YES:o("WAWebWamEnumIsPureSyncdSessionEnum").IS_PURE_SYNCD_SESSION_ENUM.NO;var t=yield o("WAWebSyncdDb").getSyncActionsRows(["action"],[o("WASyncdConst").Actions.Archive,o("WASyncdConst").Actions.ClearChat,o("WASyncdConst").Actions.DeleteChat,o("WASyncdConst").Actions.DeleteMessageForMe,o("WASyncdConst").Actions.MarkChatAsRead,o("WASyncdConst").Actions.Mute,o("WASyncdConst").Actions.Pin,o("WASyncdConst").Actions.Star]),n=t.find(function(e){return e.index.includes(o("WAJids").WA_USER_DOMAIN)});if(n)return o("WAWebWamEnumIsPureSyncdSessionEnum").IS_PURE_SYNCD_SESSION_ENUM.PROBABLY_NO;var r=t.find(function(e){return e.index.includes(o("WAJids").LID_DOMAIN)});return r?o("WAWebWamEnumIsPureSyncdSessionEnum").IS_PURE_SYNCD_SESSION_ENUM.PROBABLY_YES:o("WAWebWamEnumIsPureSyncdSessionEnum").IS_PURE_SYNCD_SESSION_ENUM.UNKNOWN}),he.apply(this,arguments)}l.SyncdPatchDirection=q,l.indexAndValueMacToString=V,l.computeLtHashAndValidateSnapshot=G,l.computeLtHashAndValidatePatch=j,l.computeOutgoingSnapshotAndPatchMacs=te,l.computeLtHash=re,l.checkLtHash=ae,l.logMacsInSnapshot=de,l.reportCollectionInconsistency=pe,l.getLidMigrationStage=fe}),98);
__d("WAWebSyncdGetActionHandler",["err"],(function(t,n,r,o,a,i,l){"use strict";var e=null,s=null,u=null;function c(e){u=e}function d(t){if(u==null)throw r("err")("Action handlers not initialized");return e==null&&(e=new Map(u.map(function(e){return[e.getAction(),e]}))),e.get(t)}function m(){if(u==null)throw r("err")("Action handlers not initialized");return s==null&&(s=Math.max.apply(Math,u.map(function(e){return e.getVersion()}))),s}l.setActionHandlers=c,l.getActionHandler=d,l.maxSupportedVersion=m}),98);
__d("WAWebSyncdRequestBuilderTypesConverter",["WANullthrows","WAWebProtobufSyncAction.pb","decodeProtobuf","encodeProtobuf"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return e.map(function(e){var n=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,e.binarySyncData).value,a=o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionValueSpec,r("WANullthrows")(n)).readBuffer();return{collection:e.collection,index:e.index,binarySyncAction:a,operation:t,version:e.version,timestamp:e.timestamp,action:e.action}})}l.syncActionsToPendingMutations=e}),98);
__d("WAWebSyncdCoreApi",["Promise","WALogger","WASyncdConst","WATypeUtils","WAWebCmd","WAWebDebounce","WAWebEventsWaitForOfflineDeliveryEnd","WAWebLid1X1MigrationGating","WAWebModelStorageUtils","WAWebProtobufsServerSync.pb","WAWebSchemaChat","WAWebSchemaSyncActions","WAWebSyncd","WAWebSyncdDb","WAWebSyncdDisabled","WAWebSyncdGetActionHandler","WAWebSyncdRequestBuilderTypesConverter","WAWebSyncdUtils","WAWebUserPrefsAppStateSync","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","tryParseJSONMixed"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m=["pending-mutations"];function p(){return o("WAWebSyncdDisabled").isSyncdDisabled()?(d||(d=n("Promise"))).resolve():(_(),o("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd().then(function(){o("WAWebSyncd").processOnAppResume()}),f(),o("WAWebSyncd").initializeStateMachine())}function _(){var e=6e4,t=r("WAWebDebounce")(o("WAWebSyncd").reportWam,e,{maxWait:e*3});o("WAWebCmd").Cmd.on(o("WAWebCmd").APP_STATE_SYNC_COMPLETED,t)}function f(){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield o("WAWebUserPrefsAppStateSync").getMdSyncActionsActionSanitized();if(!t){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: sanitizing null 'action' property in sync-actions table"])));var n=yield o("WAWebSchemaSyncActions").getSyncActionsTable().all(),r=n.filter(function(e){return e.action==null}),a=r.map(function(e){var t=o("WAWebSyncdUtils").getMutationNameFromIndex(e.index),n=o("WASyncdConst").Actions.cast(t);return n?babelHelpers.extends({},e,{action:n}):(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: invalid action ",""])),t),babelHelpers.extends({},e))});yield o("WAWebSyncdDb").updateSyncActionRows(a),yield o("WAWebUserPrefsAppStateSync").setMdSyncActionsActionSanitized(!0)}}),g.apply(this,arguments)}function h(e,t,r){var a=[].concat(e,m);o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&a.push("chat","sync-actions");var i=o("WAWebModelStorageUtils").getStorage().lock(a,(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var a=yield y(t);return(d||(d=n("Promise"))).all([o("WAWebSyncdDb").appendPendingMutationsRows(t.concat(a)),r(e)])});return function(t){return e.apply(this,arguments)}})()).then(function(){var e=t.map(function(e){return e.collection});o("WAWebSyncd").markCollectionsForSync(e)});return(d||(d=n("Promise"))).resolve(i)}function y(e){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()||o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isSyncdSessionMigrated())return[];var t=(yield(d||(d=n("Promise"))).all(e.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e.action!=null){var t=o("WAWebSyncdGetActionHandler").getActionHandler(e.action);if(!(t==null||!t.isChatSyncdAction())){var n=t.chatJidIndex,a=r("tryParseJSONMixed")(e.index);if(!Array.isArray(a)){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: getPnMutationsForLidCleanup: indexParts is not an array"]))).sendLogs("syncd-lid-cleanup-invalid-index-non-array");return}var i=a[n];if(!o("WATypeUtils").isString(i)){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["syncd: getPnMutationsForLidCleanup: chat JID not a string"]))).sendLogs("syncd-lid-cleanup-invalid-index-non-string-jid");return}if(r("WAWebWid").isStringLid(i)){var l=(yield o("WAWebSchemaChat").getChatTable().equals(["accountLid"],i,{shouldDecrypt:!1}))[0];if(!(l==null||l.accountLid===l.id)){var s=o("WAWebWidFactory").createWid(l.id).toJid(),d=[].concat(a);d[n]=s;var m=JSON.stringify(d);return o("WAWebSchemaSyncActions").getSyncActionsTable().get(m)}}}}});return function(t){return e.apply(this,arguments)}})()))).filter(Boolean).map(o("WAWebSchemaSyncActions").convertToSyncActionFromRow);return o("WAWebSyncdRequestBuilderTypesConverter").syncActionsToPendingMutations(t,o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE)}),C.apply(this,arguments)}l.initialize=p,l.sanitizeActionInSyncActionsRow=f,l.lockForSync=h}),98);
__d("WAWebSyncdCriticalBootstrapProcessingApi",["WATimeUtils","WAWebMdBootstrapAppStateCriticalDataProcessingWamEvent","WAWebSyncBootstrap","WAWebSyncdMdSyncFieldstatMeta","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){r("WAWebSyncBootstrap").isSyncDCriticalDataSyncInProcess()&&new(o("WAWebMdBootstrapAppStateCriticalDataProcessingWamEvent")).MdBootstrapAppStateCriticalDataProcessingWamEvent({bootstrapAppStateDataStage:e,mdSessionId:yield o("WAWebSyncdMdSyncFieldstatMeta").MdSyncFieldStatsMeta.getMdSessionId(),mdTimestamp:o("WATimeUtils").unixTimeMs()}).commit()}),s.apply(this,arguments)}l.logCriticalBootstrapStageIfNecessary=e}),98);
__d("WAWebSyncdIndexUtils",["WALogger","WASyncdConst","WAWebMsgKey","WAWebSyncdUtils","WAWebUserPrefsMeUser","WAWebWamEnumMdSyncdCriticalEventCode","WAWebWid","WAWebWidFactory","err"],(function(t,n,r,o,a,i,l){var e,s,u,c=/\d(?=)/gm;function d(e){var t=e.toString();if(!e.fromMe||e.remote.isUser())return t;var n=t.lastIndexOf("_");return t.substring(0,n)}function m(t,n,a,i){var l=void 0;if(!r("WAWebWid").isWid(t))return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncKeyToMsgKey: invalid remote value: ",""])),t.replace(c,"#")),null;if(!o("WAWebWidFactory").createWid(t).isUser()){if(a==="0"&&!r("WAWebWid").isWid(i))return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncKeyToMsgKey: invalid participant value: ",""])),i.replace(c,"#")),null;a==="1"?l=o("WAWebUserPrefsMeUser").getMePnUserOrThrow():l=o("WAWebWidFactory").createWid(i)}return new(r("WAWebMsgKey"))({fromMe:a==="1",remote:o("WAWebWidFactory").createWid(t),id:n,participant:l})}function p(e){var t=JSON.parse(e);if(t.length<5)throw r("err")("[sync-action] star action index malformed, cannot create MsgKey");var n=m(t[1],t[2],t[3],t[4]);if(!n)throw o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[sync-action] star action index data is malformed, , cannot create MsgKey"]))),r("err")("[sync-action] star action index data is malformed, , cannot create MsgKey");return n}function _(e){return o("WAWebSyncdUtils").uploadCriticalEventMetric(o("WAWebWamEnumMdSyncdCriticalEventCode").MD_SYNCD_CRITICAL_EVENT_CODE.ACTION_INVALID_INDEX_DATA,e),{actionState:o("WASyncdConst").SyncActionState.Malformed}}function f(e){return{actionState:o("WASyncdConst").SyncActionState.Malformed}}l.msgKeyToDbIdWithoutFromMeParticipant=d,l.syncKeyToMsgKey=m,l.getMsgKeyFromStarActionIndex=p,l.malformedActionIndex=_,l.malformedActionValue=f}),98);
__d("WAWebSyncdAction",["Promise","WALogger","WASyncdConst","WAWebSyncdIndexUtils","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(function(){function t(){}var a=t.prototype;return a.resolveConflicts=function(t,r){var e=r.timestamp;return e>=t.timestamp?(s||(s=n("Promise"))).resolve(o("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal):(s||(s=n("Promise"))).resolve(o("WASyncdConst").ConflictResolutionState.SkipRemote)},a.dropMutationDueToCrossIndexConflict=function(t,r){return(s||(s=n("Promise"))).resolve(!1)},a.getValidatedContent=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){switch(e.operation){case"remove":return this.getValidatedContentRemove(e);case"set":return this.getValidatedContentSet(e)}});function t(t){return e.apply(this,arguments)}return t})(),a.getValidatedContentSet=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){throw r("err")("You must implement getValidatedContent on your handler before using `withValidatedContent`")});function t(t){return e.apply(this,arguments)}return t})(),a.getValidatedContentRemove=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return{result:"unsupported"}});function t(t){return e.apply(this,arguments)}return t})(),a.withValidatedContent=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r=yield this.getValidatedContent(t),a=this.asSyncdActionHandler();switch(r.result){case"malformed_index":return o("WAWebSyncdIndexUtils").malformedActionIndex(a.collectionName);case"malformed_value":return o("WAWebSyncdIndexUtils").malformedActionValue(a.collectionName);case"unsupported":return{actionState:o("WASyncdConst").SyncActionState.Unsupported};case"ok":return n(r.content).catch(function(t){var n=t instanceof Error?t.message:String(t);return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: withValidatedContent: error while validating content for ",": ",""])),a.getAction(),n),{actionState:o("WASyncdConst").SyncActionState.Failed}})}});function r(e,n){return t.apply(this,arguments)}return r})(),a.asSyncdActionHandler=function(){if(this.isSyncdAction())return this;throw r("err")("Invalid cast to SyncdAction")},a.isSyncdAction=function(){return!0},a.isAccountSyncdAction=function(){return!1},a.isChatSyncdAction=function(){return!1},a.isChatOrContactSyncdAction=function(){return!1},a.isChatMessageRangeSyncdAction=function(){return!1},a.isMessageSyncdAction=function(){return!1},t})(),c=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.isAccountSyncdAction=function(){return!0},n.asAccountSyncdActionHandler=function(){if(this.isAccountSyncdAction())return this;throw r("err")("Invalid cast to AccountSyncdAction")},t})(u),d=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.isChatSyncdAction=function(){return!0},n.asChatSyncdActionHandler=function(){if(this.isChatSyncdAction())return this;throw r("err")("Invalid cast to ChatSyncdAction")},t})(u),m=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.isChatOrContactSyncdAction=function(){return!0},n.asChatOrContactSyncdActionHandler=function(){if(this.isChatOrContactSyncdAction())return this;throw r("err")("Invalid cast to ChatOrContactSyncdAction")},t})(d),p=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.isMessageSyncdAction=function(){return!0},n.asMessageSyncdActionHandler=function(){if(this.isMessageSyncdAction())return this;throw r("err")("Invalid cast to MessageSyncdAction")},t})(d),_=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.isChatMessageRangeSyncdAction=function(){return!0},n.asChatMessageRangeSyncdActionHandler=function(){if(this.isChatMessageRangeSyncdAction())return this;throw r("err")("Invalid cast to ChatMessageRangeSyncdActionBase")},t})(d);l.AccountSyncdActionBase=c,l.ChatSyncdActionBase=d,l.ChatOrContactSyncdActionBase=m,l.MessageSyncdActionBase=p,l.ChatMessageRangeSyncdActionBase=_}),98);
__d("WAWebAndroidUnsupportedActionsSync",["Promise","WALogger","WASyncdConst","WAWebSyncdAction","WAWebSyncdIndexUtils","WAWebUserPrefsAppStateSync"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p=(function(t){function r(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.collectionName=o("WASyncdConst").CollectionName.RegularLow,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(r,t);var a=r.prototype;return a.getVersion=function(){return 4},a.getAction=function(){return o("WASyncdConst").Actions.AndroidUnsupportedActions},a.applyMutations=function(r){var t=this;return(m||(m=n("Promise"))).all(r.map(function(n){try{if(n.operation==="set"){var r=n.value,a=r.androidUnsupportedActions;if(!a)return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["android unsupported actions: malformed mutation"]))),o("WAWebSyncdIndexUtils").malformedActionValue(t.collectionName);var i=a.allowed;return i===!0?(t.updatePrimaryAllowsAllMutationsFlag("allow_unsupported_mutation"),o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: successfully set primary allows all mutations flag"])))):o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: androidUnsupportedMutation has invalid 'allowed' value"]))),{actionState:o("WASyncdConst").SyncActionState.Success}}return o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["locale setting sync: operation not supported"]))),{actionState:o("WASyncdConst").SyncActionState.Unsupported}}catch(e){return{actionState:o("WASyncdConst").SyncActionState.Failed}}}))},a.updatePrimaryAllowsAllMutationsFlag=function(t){o("WAWebUserPrefsAppStateSync").getPrimaryAllowsAllMutations()||(o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[syncd] primary allows all mutations flag set: ",""])),t),o("WAWebUserPrefsAppStateSync").setPrimaryAllowsAllMutations())},r})(o("WAWebSyncdAction").AccountSyncdActionBase),_=new p;l.default=_}),98);
__d("WAWebSyncdLogs",["WALogger","WASyncdConst","WAWebPriorLogs","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r=o("WAWebPriorLogs").WAWebLogCategory.cast(t);if(r!=null)return o("WAWebPriorLogs").writePriorLog(r,n);o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: cannot log unknown cagtegory ",""])),t)});return function(n,r){return t.apply(this,arguments)}})(),u=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=[].concat(Array.from(e?[e]:o("WASyncdConst").CollectionName.members()),[""]).map(function(e){return o("WAWebPriorLogs").WAWebLogCategory.cast(e)}).filter(Boolean);return o("WAWebPriorLogs").printPriorLogs(t)});return function(n){return e.apply(this,arguments)}})();l.writeSyncdLogImpl=s,l.printSyncdLogs=u}),98);
__d("WAWebSyncdDbCallbacksApi",["Promise","WAWebAndroidUnsupportedActionsSync","WAWebCmd","WAWebEventsWaitForOfflineDeliveryEnd","WAWebLid1X1MigrationGating","WAWebMsgKey","WAWebSchemaChat","WAWebSyncdFatal","WAWebSyncdLogs","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=function(o){return o.deviceIndex===0&&r("WAWebAndroidUnsupportedActionsSync").updatePrimaryAllowsAllMutationsFlag("device index"),(e||(e=n("Promise"))).resolve()},u=function(r){return o("WAWebCmd").Cmd.trigger(o("WAWebCmd").APP_STATE_SYNC_COMPLETED,r),(e||(e=n("Promise"))).resolve()},c=function(){return o("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd().then(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){}))},d=function(t){return o("WAWebSyncdFatal").handleFatalError(t==null?void 0:t.collections)};function m(e){return o("WAWebSchemaChat").getChatTable().bulkGet(e).then(function(e){return e.map(function(e){return e==null?void 0:e.accountLid})})}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated())return[];for(var t=e.map(function(e){return r("WAWebMsgKey").fromString(e)}).filter(function(e){return e.remote.isUser()&&!e.remote.isLid()}),n=(yield o("WAWebSchemaChat").getChatTable().bulkGet(t.map(function(e){return e.remote.toString()}))).map(function(e){return e==null?void 0:e.accountLid}),a=[],i=0;i<t.length;i++){var l=n[i];if(l!=null){var s=t[i];a.push(new(r("WAWebMsgKey"))({fromMe:s.fromMe,remote:o("WAWebWidFactory").createWid(l),id:s.id}).toString())}}return a}),_.apply(this,arguments)}l.handleSyncBeforeApplyPatch=s,l.handleSyncCompleted=u,l.handleSyncDelayApplyingPatchUntilUIUnblocks=c,l.handleSyncdFatal=d,l.writeSyncdLog=o("WAWebSyncdLogs").writeSyncdLogImpl,l.printSyncdLog=o("WAWebSyncdLogs").printSyncdLogs,l.bulkGetAccountLid=m,l.getAdditionalLidMsgKeys=p}),98);
__d("WAWebSyncdFatal",["Promise","WAAsyncSleep","WALogger","WATimeUtils","WAWebLogoutReasonConstants","WAWebSocketLogoutJob","WAWebSyncdDbCallbacksApi","WAWebSyncdFatalExceptionNotificationApi","WAWebSyncdLogs","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f=5e3;function g(e){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: starting fatal flow for ",""])),t),t?yield y(t,"handleFatalError for collection"):yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog("","handleFatalError without collection");var n=[];t!=null&&(n=t.map(function(e){return String(e)}));var r=o("WATimeUtils").castMilliSecondsToUnixTime(o("WATimeUtils").unixTimeMs());o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal flow: before sleep"]))),yield o("WAAsyncSleep").asyncSleep(f),yield y(t,"handleFatalError before notify primary");var a=o("WATimeUtils").castMilliSecondsToUnixTime(o("WATimeUtils").unixTimeMs());o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: start notifying primary on fatal error"])));try{yield o("WAWebSyncdFatalExceptionNotificationApi").sendAppStateFatalExceptionNotification(n)}catch(e){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["syncd: error when sending fatal message to primary: ",""])),e).sendLogs("syncd: could not send fatal to primary")}o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["syncd: end notifying primary on fatal error"]))),yield y(t,"handleFatalError after notify primary");var i=o("WATimeUtils").castMilliSecondsToUnixTime(o("WATimeUtils").unixTimeMs());o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: end notifying primary on fatal error. tsBeforeSleep: ",", tsBeforeSendToPrimary: ",", currTs: ",""])),o("WATimeUtils").toHttpHeaderDate(r),o("WATimeUtils").toHttpHeaderDate(a),o("WATimeUtils").toHttpHeaderDate(i)),yield o("WAWebSyncdLogs").printSyncdLogs(),o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["syncd: Received fatal error and logged out"]))).verbose().tags("syncd","logout").sendLogs("syncd: fatal error and logged out"),yield o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.SyncdFailure)}),h.apply(this,arguments)}function y(e,t){return(_||(_=n("Promise"))).all((e!=null?e:[""]).map(function(e){return o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,t)}))}l.handleFatalError=g}),98);
__d("WAWebSyncdFatalExceptionNotificationApi",["WATimeUtils","WAWebApiPeerMessageStore","WAWebMsgKey","WAWebMsgType","WAWebSendAppStateSyncMsgJob","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t={collectionNames:e,timestamp:o("WATimeUtils").unixTimeMs()},n=new(r("WAWebMsgKey"))({fromMe:!0,remote:o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),id:yield r("WAWebMsgKey").newId()}),a={id:n,to:o("WAWebWidFactory").createDeviceWidFromUserAndDevice(o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().user,o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().server,0),type:"protocol",subtype:"app_state_fatal_exception_notification",kind:o("WAWebMsgType").MsgKind.PeerMessage,appStateFatalExceptionNotification:t};return yield o("WAWebApiPeerMessageStore").storePeerMessages([a]),o("WAWebSendAppStateSyncMsgJob").encryptAndSendKeyMsg({msg:a})}),s.apply(this,arguments)}l.sendAppStateFatalExceptionNotification=e}),98);
__d("WAWebSyncdKeyCallbacksApi",["WALogger","WAWebApiDeviceList","WAWebKeyManagementSendKeyRequestApi","WAWebKeyManagementSendKeyShareApi","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield o("WAWebApiDeviceList").getMyDeviceList(),n=t.currentIndex,a=t.devices,i=t.rawId;if(n==null)throw o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing current index for own device: devices length: ",""])),a==null?void 0:a.length),r("err")("syncd: missing current index for own device");return{currentIndex:n,deviceIndexes:a.map(function(e){return e.keyIndex}),rawId:i}});return function(){return t.apply(this,arguments)}})(),u=function(t){return o("WAWebKeyManagementSendKeyShareApi").sendAppStateSyncKeyShare({type:"key_rotation",keys:t})};l.getDeviceFingerprint=s,l.sendSyncdKeyRequest=o("WAWebKeyManagementSendKeyRequestApi").sendAppStateSyncKeyRequest,l.sendSyncdKeyRotation=u}),98);
__d("WAWebWamEnumUploadSourceType",[],(function(t,n,r,o,a,i){var e=Object.freeze({OTHER:1,CAMERA:2,GALLERY:3,SHARE:4});i.UPLOAD_SOURCE_TYPE=e}),66);
__d("WAWebMapFileOriginToUploadOrigin",["WAWebWamEnumMediaPickerOriginType","WAWebWamEnumUploadSourceType"],(function(t,n,r,o,a,i,l){function e(e,t){if(t)return o("WAWebWamEnumUploadSourceType").UPLOAD_SOURCE_TYPE.OTHER;switch(e){case o("WAWebWamEnumMediaPickerOriginType").MEDIA_PICKER_ORIGIN_TYPE.CHAT_PHOTO_LIBRARY:return o("WAWebWamEnumUploadSourceType").UPLOAD_SOURCE_TYPE.GALLERY;case o("WAWebWamEnumMediaPickerOriginType").MEDIA_PICKER_ORIGIN_TYPE.MENU_CAMERA_CAPTURE:return o("WAWebWamEnumUploadSourceType").UPLOAD_SOURCE_TYPE.CAMERA;case o("WAWebWamEnumMediaPickerOriginType").MEDIA_PICKER_ORIGIN_TYPE.PASTE:return o("WAWebWamEnumUploadSourceType").UPLOAD_SOURCE_TYPE.SHARE;default:return o("WAWebWamEnumUploadSourceType").UPLOAD_SOURCE_TYPE.OTHER}}l.default=e}),98);
__d("WAWebWamEnumConnectionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({HOSTNAME:0,IP4:1,IP6:2});i.CONNECTION_TYPE=e}),66);
__d("WAWebWamEnumHttpProtocolVersionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({HTTP1:0,HTTP2:1,HTTP3:2});i.HTTP_PROTOCOL_VERSION_TYPE=e}),66);
__d("WAWebWamEnumMediaUploadModeType",[],(function(t,n,r,o,a,i){var e=Object.freeze({REGULAR:1,FAST_FORWARD_EXIST_CHECK:2,VIDEO_EXIST_CHECK:3,PRODUCT:4,MEDIA_RETRY:5,WEB_REUPLOAD:6,THUMBNAIL:7,EXPRESS_PATH_UPLOAD:8});i.MEDIA_UPLOAD_MODE_TYPE=e}),66);
__d("WAWebWamEnumNetworkStackType",[],(function(t,n,r,o,a,i){var e=Object.freeze({NATIVE:0,OK_HTTP:1,LIGER:2,APACHE:3,WATLS:4,CRONET:5,TIGON_HUC:6,TIGON_MNS:7});i.NETWORK_STACK_TYPE=e}),66);
__d("WAWebWamEnumOptimisticFlagType",[],(function(t,n,r,o,a,i){var e=Object.freeze({NONE:0,OPTIMISTIC:1,OPT_USED:2,OPT_TAKEOVER:3,OPT_DISABLED:4});i.OPTIMISTIC_FLAG_TYPE=e}),66);
__d("WAWebWamEnumOverallMediaKeyReuseType",[],(function(t,n,r,o,a,i){var e=Object.freeze({NONE_NEW_CONTENT:1,NONE_EXPIRED:2,REUSED:3,NONE_WAS_STATUS:4});i.OVERALL_MEDIA_KEY_REUSE_TYPE=e}),66);
__d("WAWebWamEnumUploadOriginType",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNKNOWN:1,CHAT_PERSONAL:2,CHAT_GROUP:3,STATUS_USER:4,PRODUCT_CATALOG:5,STICKER_WEB:6,PAYMENTS_KYC:7,MESSAGE_HISTORY_SYNC:8,COMMUNITY:9,CHANNEL:10,BROADCAST:11,MULTI_CHAT:12,INTEROP:13});i.UPLOAD_ORIGIN_TYPE=e}),66);
__d("WAWebMediaUpload2WamEvent",["WAWebWamCodegenUtils","WAWebWamEnumConnectionType","WAWebWamEnumHttpProtocolVersionType","WAWebWamEnumMediaQuality","WAWebWamEnumMediaType","WAWebWamEnumMediaUploadModeType","WAWebWamEnumMediaUploadResultType","WAWebWamEnumNetworkStackType","WAWebWamEnumOptimisticFlagType","WAWebWamEnumOverallLastUploadRetryPhaseType","WAWebWamEnumOverallMediaKeyReuseType","WAWebWamEnumPairedMediaType","WAWebWamEnumUploadOriginType","WAWebWamEnumUploadSourceType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MediaUpload2:[1588,{appContext:[63,e.TYPES.STRING],appContextBitfield:[64,e.TYPES.INTEGER],batchSize:[57,e.TYPES.INTEGER],connectionType:[43,o("WAWebWamEnumConnectionType").CONNECTION_TYPE],debugMediaException:[34,e.TYPES.STRING],debugMediaIp:[32,e.TYPES.STRING],debugUrl:[33,e.TYPES.STRING],estimatedBandwidth:[45,e.TYPES.NUMBER],estimatedBandwidthV2:[61,e.TYPES.NUMBER],fileHeight:[55,e.TYPES.INTEGER],fileWidth:[56,e.TYPES.INTEGER],finalizeConnectT:[28,e.TYPES.TIMER],finalizeHttpCode:[31,e.TYPES.INTEGER],finalizeIsReuse:[30,e.TYPES.BOOLEAN],finalizeNetworkT:[29,e.TYPES.TIMER],httpProtocolVersionType:[51,o("WAWebWamEnumHttpProtocolVersionType").HTTP_PROTOCOL_VERSION_TYPE],isViewOnce:[49,e.TYPES.BOOLEAN],mediaCollectionId:[60,e.TYPES.INTEGER],mediaId:[46,e.TYPES.INTEGER],messageKeyHash:[58,e.TYPES.STRING],networkStack:[42,o("WAWebWamEnumNetworkStackType").NETWORK_STACK_TYPE],originalSize:[53,e.TYPES.INTEGER],overallAttemptCount:[4,e.TYPES.INTEGER],overallConnBlockFetchT:[10,e.TYPES.TIMER],overallConnectionClass:[41,e.TYPES.STRING],overallCumT:[37,e.TYPES.TIMER],overallCumUserVisibleT:[38,e.TYPES.TIMER],overallDomain:[5,e.TYPES.STRING],overallEncryptT:[50,e.TYPES.TIMER],overallIsFinal:[36,e.TYPES.BOOLEAN],overallIsForward:[16,e.TYPES.BOOLEAN],overallIsManual:[13,e.TYPES.BOOLEAN],overallLastUploadRetryPhase:[11,o("WAWebWamEnumOverallLastUploadRetryPhaseType").OVERALL_LAST_UPLOAD_RETRY_PHASE_TYPE],overallMediaKeyReuse:[40,o("WAWebWamEnumOverallMediaKeyReuseType").OVERALL_MEDIA_KEY_REUSE_TYPE],overallMediaSize:[7,e.TYPES.NUMBER],overallMediaType:[1,o("WAWebWamEnumMediaType").MEDIA_TYPE],overallMmsVersion:[6,e.TYPES.INTEGER],overallOptimisticFlag:[12,o("WAWebWamEnumOptimisticFlagType").OPTIMISTIC_FLAG_TYPE],overallQueueT:[9,e.TYPES.TIMER],overallRetryCount:[3,e.TYPES.INTEGER],overallT:[8,e.TYPES.TIMER],overallTranscodeT:[15,e.TYPES.TIMER],overallUploadMode:[39,o("WAWebWamEnumMediaUploadModeType").MEDIA_UPLOAD_MODE_TYPE],overallUploadOrigin:[44,o("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE],overallUploadResult:[35,o("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE],overallUserVisibleT:[14,e.TYPES.TIMER],pairedMediaType:[62,o("WAWebWamEnumPairedMediaType").PAIRED_MEDIA_TYPE],photoQualitySetting:[52,o("WAWebWamEnumMediaQuality").MEDIA_QUALITY],resumeConnectT:[17,e.TYPES.TIMER],resumeHttpCode:[20,e.TYPES.INTEGER],resumeIsReuse:[19,e.TYPES.BOOLEAN],resumeNetworkT:[18,e.TYPES.TIMER],uploadBytesTransferred:[27,e.TYPES.NUMBER],uploadConnectT:[22,e.TYPES.TIMER],uploadHttpCode:[25,e.TYPES.INTEGER],uploadIsReuse:[24,e.TYPES.BOOLEAN],uploadIsStreaming:[26,e.TYPES.BOOLEAN],uploadNetworkT:[23,e.TYPES.TIMER],uploadResumePoint:[21,e.TYPES.INTEGER],uploadSource:[48,o("WAWebWamEnumUploadSourceType").UPLOAD_SOURCE_TYPE],usedFallbackHint:[47,e.TYPES.STRING],videoQualitySetting:[54,o("WAWebWamEnumMediaQuality").MEDIA_QUALITY]},[1,1,1],"regular"]},{MediaUpload2:[]});l.MediaUpload2WamEvent=s}),98);
__d("WAWebWamEnumBackendStoreType",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNKNOWN:0,NON_DIRECT_PATH:1,EVERSTORE:2,OIL:3,EXPRESS_PATH:4,STATIC:5,MANIFOLD:6});i.BACKEND_STORE_TYPE=e}),66);
__d("WAWebWamEnumMediaDownloadModeType",[],(function(t,n,r,o,a,i){var e=Object.freeze({MANUAL:1,FULL:2,PREFETCH:3,HEADER:4,THUMBNAIL:5,EXPRESS_PATH_DOWNLOAD:6,PREFETCH_FOR_THUMB_PREVIEW:7,FULL_FOR_THUMB_PREVIEW:8});i.MEDIA_DOWNLOAD_MODE_TYPE=e}),66);
__d("WAWebWamEnumMediaDownloadResultType",[],(function(t,n,r,o,a,i){var e=Object.freeze({OK:1,ERROR_UNKNOWN:2,ERROR_TIMEOUT:3,ERROR_DNS:4,ERROR_INSUFFICIENT_SPACE:5,ERROR_TOO_OLD:6,ERROR_CANNOT_RESUME:7,ERROR_HASH_MISMATCH:8,ERROR_INVALID_URL:9,ERROR_OUTPUT_STREAM:10,ERROR_CANCEL:11,DEDUPED:12,ERROR_ENC_HASH_MISMATCH:14,PREFETCH_END:15,ERROR_CANCEL_PROGRAMMATIC:16,ERROR_MEDIA_CONN:17,ERROR_THROTTLE:18,ERROR_SSL:19,ERROR_NETWORK:20,ERROR_CONNECT:21,ERROR_EP_NOTIFY_DECRYPTION_FAILURE:22,SKIPPED_EP_DIFFERENT_POP:23,SKIPPED_EP_AUTODOWNLOAD_DISABLED:24,ERROR_SERVER:25,ERROR_WATLS:26,ERROR_INVALID_CODE:27,ERROR_WAMSYS:28,ERROR_GENERIC:29,ERROR_CRONET:30,ERROR_NO_CLIENT_NETWORK:31,ERROR_HOST_SWITCH_REQUIRED:32,ERROR_SUSPICIOUS_CONTENT:33,ERROR_NO_ENCRYPTION_ALGORITHM:34,ERROR_NO_ENCRYPTED_HASH:35,ERROR_NO_MEDIA_HASH:36,ERROR_NO_MEDIA_KEY:37,ERROR_NO_SIDECAR:38,ERROR_HASH_VERIFICATION_FAILURE:39,INTEGRITY_CHECK_FAILURE:40});i.MEDIA_DOWNLOAD_RESULT_TYPE=e}),66);
__d("WAWebWamEnumWebcMediaOperationCode",[],(function(t,n,r,o,a,i){var e=Object.freeze({DOWNLOAD:1,UPLOAD:2});i.WEBC_MEDIA_OPERATION_CODE=e}),66);
__d("WAWebWebcMediaErrorUnknownDetailsWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebcMediaOperationCode"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WebcMediaErrorUnknownDetails:[2352,{mediaId:[1,e.TYPES.INTEGER],webcMediaErrorMessage:[4,e.TYPES.STRING],webcMediaErrorName:[3,e.TYPES.STRING],webcMediaOperation:[2,o("WAWebWamEnumWebcMediaOperationCode").WEBC_MEDIA_OPERATION_CODE]},[1,1,1],"regular"]},{WebcMediaErrorUnknownDetails:[]});l.WebcMediaErrorUnknownDetailsWamEvent=s}),98);
__d("WAWebWamMediaMetricUtils",["WAAbortError","WALogger","WAWebHttpErrors","WAWebMediaHostsErrors","WAWebMiscErrors","WAWebMmsClientErrors","WAWebMmsMediaTypes","WAWebWamEnumBackendStoreType","WAWebWamEnumMediaDownloadModeType","WAWebWamEnumMediaDownloadResultType","WAWebWamEnumMediaType","WAWebWamEnumMediaUploadModeType","WAWebWamEnumMediaUploadResultType","WAWebWamEnumWebcMediaOperationCode","WAWebWebcMediaErrorUnknownDetailsWamEvent","err","gkx"],(function(t,n,r,o,a,i,l){var e,s;function u(e){switch(e){case"thumbnail-document":case"thumbnail-image":case"thumbnail-video":case"thumbnail-link":case"newsletter-thumbnail-link":return!0}return!1}function c(e,t,n){return u(e)?o("WAWebWamEnumMediaDownloadModeType").MEDIA_DOWNLOAD_MODE_TYPE.THUMBNAIL:t==="manual"?o("WAWebWamEnumMediaDownloadModeType").MEDIA_DOWNLOAD_MODE_TYPE.MANUAL:n?o("WAWebWamEnumMediaDownloadModeType").MEDIA_DOWNLOAD_MODE_TYPE.PREFETCH:o("WAWebWamEnumMediaDownloadModeType").MEDIA_DOWNLOAD_MODE_TYPE.FULL}function d(e){return u(e)?o("WAWebWamEnumMediaUploadModeType").MEDIA_UPLOAD_MODE_TYPE.THUMBNAIL:o("WAWebWamEnumMediaUploadModeType").MEDIA_UPLOAD_MODE_TYPE.REGULAR}function m(e){switch(e){case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_AUDIO:case"audio":return o("WAWebWamEnumMediaType").MEDIA_TYPE.AUDIO;case"document":return o("WAWebWamEnumMediaType").MEDIA_TYPE.DOCUMENT;case"thumbnail-document":return o("WAWebWamEnumMediaType").MEDIA_TYPE.DOCUMENT;case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_GIF:case"gif":return o("WAWebWamEnumMediaType").MEDIA_TYPE.GIF;case"image":case"waffle-image":case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_IMAGE:return o("WAWebWamEnumMediaType").MEDIA_TYPE.PHOTO;case"thumbnail-image":return o("WAWebWamEnumMediaType").MEDIA_TYPE.PHOTO;case"ppic":return o("WAWebWamEnumMediaType").MEDIA_TYPE.PROFILE_PIC;case"product":return o("WAWebWamEnumMediaType").MEDIA_TYPE.PRODUCT_IMAGE;case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTT:case"ptt":return o("WAWebWamEnumMediaType").MEDIA_TYPE.PTT;case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER:case"sticker":return o("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER;case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER_PACK:case"sticker-pack":return o("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER_PACK;case"thumbnail-sticker-pack":return o("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER_PACK;case"video":case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_VIDEO:case"waffle-video":return o("WAWebWamEnumMediaType").MEDIA_TYPE.VIDEO;case"ptv":case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTV:return o("WAWebWamEnumMediaType").MEDIA_TYPE.PUSH_TO_VIDEO;case"thumbnail-video":return o("WAWebWamEnumMediaType").MEDIA_TYPE.VIDEO;case"template":return o("WAWebWamEnumMediaType").MEDIA_TYPE.TEMPLATE;case"md-msg-hist":return o("WAWebWamEnumMediaType").MEDIA_TYPE.MD_HISTORY_SYNC;case"md-app-state":return o("WAWebWamEnumMediaType").MEDIA_TYPE.MD_APP_STATE;case"product-catalog-image":return o("WAWebWamEnumMediaType").MEDIA_TYPE.PRODUCT_IMAGE;case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_THUMBNAIL_LINK:case"thumbnail-link":return o("WAWebWamEnumMediaType").MEDIA_TYPE.URL;case"payment-bg-image":return o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"biz-cover-photo":return o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"ads-image":return o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"ads-video":return o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"music-artwork":return o("WAWebWamEnumMediaType").MEDIA_TYPE.MUSIC_ARTWORK;case"group-history":return o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"newsletter-music-artwork":return o("WAWebWamEnumMediaType").MEDIA_TYPE.MUSIC_ARTWORK;default:throw r("err")("webMediaType is invalid: "+e)}}function p(e){return e instanceof o("WAWebMmsClientErrors").MMSUnauthorizedError?o("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_NO_PERMISSIONS:e instanceof o("WAWebMmsClientErrors").MediaTooLargeError?o("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_BAD_MEDIA:e instanceof o("WAWebMmsClientErrors").MMSThrottleError?o("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_THROTTLE:e instanceof o("WAWebHttpErrors").HttpStatusCodeError&&e.status>=500?o("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_SERVER:e instanceof o("WAWebMediaHostsErrors").NoMediaHostsError?o("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_MEDIA_CONN:e.name===o("WAAbortError").ABORT_ERROR?o("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_CANCEL:e instanceof o("WAWebHttpErrors").HttpNetworkError?o("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_UPLOAD:o("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_UNKNOWN}function _(e){if(e instanceof o("WAWebMmsClientErrors").MMSThrottleError)return o("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_THROTTLE;if(e instanceof o("WAWebMediaHostsErrors").NoMediaHostsError)return o("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_MEDIA_CONN;if(e instanceof o("WAWebHttpErrors").HttpNetworkError)return o("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_NETWORK;if(e instanceof o("WAWebHttpErrors").HttpStatusCodeError)switch(e.status){case 404:case 410:return o("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_TOO_OLD;case 416:return o("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_CANNOT_RESUME;case 401:return o("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_INVALID_URL;case 429:case 507:return o("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_THROTTLE;default:return o("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_UNKNOWN}return e.name===o("WAAbortError").ABORT_ERROR?o("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_CANCEL:e instanceof o("WAWebHttpErrors").MmsDownloadFilehashMismatchError?o("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_ENC_HASH_MISMATCH:e instanceof o("WAWebMiscErrors").MediaDecryptionError&&e.message.includes(o("WAWebMiscErrors").PLAINTEXT_HASH_MISMATCH_ERROR)?o("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_HASH_MISMATCH:o("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_UNKNOWN}function f(e){if(e instanceof o("WAWebHttpErrors").HttpStatusCodeError)return e.status}function g(){return 1+Math.floor(Number.MAX_SAFE_INTEGER*Math.random())}function h(e,t){if(t!=null){var n;e.overallDownloadResult===o("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_UNKNOWN?n=o("WAWebWamEnumWebcMediaOperationCode").WEBC_MEDIA_OPERATION_CODE.DOWNLOAD:e.overallUploadResult===o("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_UNKNOWN&&(n=o("WAWebWamEnumWebcMediaOperationCode").WEBC_MEDIA_OPERATION_CODE.UPLOAD),n!=null&&new(o("WAWebWebcMediaErrorUnknownDetailsWamEvent")).WebcMediaErrorUnknownDetailsWamEvent({mediaId:e.mediaId,webcMediaOperation:n,webcMediaErrorName:t.name,webcMediaErrorMessage:t.message}).commit()}}function y(t){if(!t)return o("WAWebWamEnumBackendStoreType").BACKEND_STORE_TYPE.NON_DIRECT_PATH;switch(t.slice(0,2).toLowerCase()){case"/v":return o("WAWebWamEnumBackendStoreType").BACKEND_STORE_TYPE.EVERSTORE;case"/o":return o("WAWebWamEnumBackendStoreType").BACKEND_STORE_TYPE.OIL;case"/m":return o("WAWebWamEnumBackendStoreType").BACKEND_STORE_TYPE.MANIFOLD}return r("gkx")("26258")?o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Unrecognized direct path type"]))).sendLogs("unrecognized-direct-path-type"):o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Unrecognized direct path type: ",""])),t).sendLogs("unrecognized-direct-path-type"),null}l.getMetricOverallDownloadModeType=c,l.getMetricOverallUploadModeType=d,l.getMetricMediaType=m,l.getMetricUploadErrorResultType=p,l.getMetricDownloadErrorResultType=_,l.getStatusCode=f,l.generateMediaEventId=g,l.logErrorUnknownDetails=h,l.getMetricBackendStore=y}),98);
__d("WAWebCreateMediaUploadMetrics",["WAWebABProps","WAWebAppTracker","WAWebHttpErrors","WAWebMapFileOriginToUploadOrigin","WAWebMediaUpload2WamEvent","WAWebMmsMediaTypes","WAWebWamEnumConnectionType","WAWebWamEnumMediaQuality","WAWebWamEnumMediaUploadResultType","WAWebWamEnumNetworkStackType","WAWebWamEnumOverallLastUploadRetryPhaseType","WAWebWamMediaMetricUtils"],(function(t,n,r,o,a,i,l){function e(e,t,n,a,i,l){l===void 0&&(l=!1);var s=o("WAWebWamMediaMetricUtils").generateMediaEventId(),u=new(o("WAWebMediaUpload2WamEvent")).MediaUpload2WamEvent({mediaId:s,connectionType:o("WAWebWamEnumConnectionType").CONNECTION_TYPE.HOSTNAME,overallMediaType:o("WAWebWamMediaMetricUtils").getMetricMediaType(e),overallMmsVersion:4,overallAttemptCount:n,networkStack:o("WAWebWamEnumNetworkStackType").NETWORK_STACK_TYPE.NATIVE,overallUploadMode:o("WAWebWamMediaMetricUtils").getMetricOverallUploadModeType(e),overallIsForward:a,overallUploadOrigin:t,uploadSource:r("WAWebMapFileOriginToUploadOrigin")(t,a),isViewOnce:i,overallUserVisibleT:0});if(o("WAWebAppTracker").AppTracker.start(o("WAWebAppTracker").AppTrackerType.MediaUL),e===o("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE&&o("WAWebABProps").getABPropConfigValue("hqp_log_enabled")){var c=l?o("WAWebWamEnumMediaQuality").MEDIA_QUALITY.HIGHEST_QUALITY:o("WAWebWamEnumMediaQuality").MEDIA_QUALITY.DATA_SAVER;u.set({photoQualitySetting:c})}function d(e){u.set({overallMediaSize:e})}function m(e){e instanceof o("WAWebHttpErrors").HttpStatusCodeError&&u.set({resumeHttpCode:e.status})}function p(){u.set({overallUploadResult:o("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.DUPLICATE,overallIsFinal:!0,resumeHttpCode:200}),u.markOverallCumT(),o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.MediaUL),o("WAWebAppTracker").attachWAMAppContext(u,u.overallCumT),u.commit()}function _(e){var t=e.hostName,n=e.hostClass,r=e.failCount;u.set({overallDomain:t,overallConnectionClass:n,overallRetryCount:r})}function f(){u.set({resumeHttpCode:404,overallUploadResult:o("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.OK,overallIsFinal:!0,uploadHttpCode:200,finalizeHttpCode:200}),u.markOverallCumT(),o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.MediaUL),o("WAWebAppTracker").attachWAMAppContext(u,u.overallCumT),u.commit()}function g(e){u.set({overallUploadResult:o("WAWebWamMediaMetricUtils").getMetricUploadErrorResultType(e),overallIsFinal:!0});var t=o("WAWebWamMediaMetricUtils").getStatusCode(e);t!=null&&(u.uploadHttpCode=t,u.finalizeHttpCode=t),u.markOverallCumT(),o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.MediaUL),o("WAWebAppTracker").attachWAMAppContext(u,u.overallCumT),u.commit(),o("WAWebWamMediaMetricUtils").logErrorUnknownDetails(u,e)}function h(e){u.set({overallT:e})}function y(e,t,n,r){var a=new(o("WAWebMediaUpload2WamEvent")).MediaUpload2WamEvent(u.all),i=o("WAWebWamMediaMetricUtils").getStatusCode(e),l=r===o("WAWebWamEnumOverallLastUploadRetryPhaseType").OVERALL_LAST_UPLOAD_RETRY_PHASE_TYPE.FINALIZE?i:a.finalizeHttpCode;a.set({mediaId:o("WAWebWamMediaMetricUtils").generateMediaEventId(),overallUploadResult:o("WAWebWamMediaMetricUtils").getMetricUploadErrorResultType(e),overallIsFinal:!1,overallT:t,overallRetryCount:n,overallLastUploadRetryPhase:r,finalizeHttpCode:l}),i!=null&&(u.uploadHttpCode=i),u.markOverallCumT(),o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.MediaUL),o("WAWebAppTracker").attachWAMAppContext(u,u.overallCumT),a.commit(),o("WAWebWamMediaMetricUtils").logErrorUnknownDetails(u,e)}function C(){u.startOverallEncryptT()}function b(){u.markOverallEncryptT()}function v(){u.set({uploadIsStreaming:!0})}function S(e){u.set({uploadBytesTransferred:e})}function R(e){e!=null&&u.set({isViewOnce:e}),u.markOverallUserVisibleT()}return{handleStreamUploadStart:v,handleArrayBufferCreated:d,handleCheckExistingError:m,handleCheckExistingSuccess:p,handleUploadHostFound:_,handleUploadSuccess:f,handleUploadError:g,handleUploadAttemptSuccess:h,handleUploadAttemptError:y,mediaId:s,handleEncryptionStart:C,handleEncryptionSuccess:b,handleUploadProgress:S,handleSendMessageStart:R}}l.default=e}),98);
__d("WAWebCryptoCalculateStreamingSidecar",["Promise","WAArrayBuffersConcat","WACryptoHmac","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=65536,u=16,c=10;function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){var a=t instanceof ArrayBuffer?t.byteLength:t.buffer.byteLength,i=a-u,l=Math.ceil(i/s),d=Array.from({length:l},function(e,n){var a=n*s,i=a+u+s,l=t.slice(a,i);return o("WACryptoHmac").hmacSha256(r,l,c)}),m=yield(e||(e=n("Promise"))).all(d);return o("WAArrayBuffersConcat").concatArrayBuffers.apply(void 0,m)}),m.apply(this,arguments)}l.IV_LENGTH=u,l.HMAC_LENGTH=c,l.calculateStreamingSidecar=d}),98);
__d("WAWebCryptoCalculateFirstFrameSidecar",["WACryptoHmac","WAWebCryptoCalculateStreamingSidecar"],(function(t,n,r,o,a,i,l){var e=16;function s(t,n,r){var a=Math.ceil(t/e)*e,i=n.slice(0,o("WAWebCryptoCalculateStreamingSidecar").IV_LENGTH+a);return o("WACryptoHmac").hmacSha256(r,i,o("WAWebCryptoCalculateStreamingSidecar").HMAC_LENGTH)}l.default=s}),98);
__d("WAWebCryptoCreateMediaKeys",["WABase64","WACryptoHkdf","WALogger","WAWebMiscErrors","WAWebMmsMediaTypes","asyncToGeneratorRuntime","err","gkx"],(function(t,n,r,o,a,i,l){var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var a=c(t),i;try{i=o("WABase64").decodeB64(n)}catch(t){r("gkx")("26258")||o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["decodeB64: invalid base64 string ",""])),n)}if(!n||!a||!i)throw new(o("WAWebMiscErrors")).MediaEncryptionError("createKeys fail: !!mediakey: "+!!n+" info: "+a+" type: "+t);var l=yield o("WACryptoHkdf").extractAndExpand(i,a,112);if(!l||l.byteLength<112)throw new(o("WAWebMiscErrors")).MediaEncryptionError("computeMediaKeys: hkdf error");return{iv:l.slice(0,16),encKey:l.slice(16,48),macKey:l.slice(48,80),refKey:l.slice(80,112)}}),u.apply(this,arguments)}function c(e){switch(e){case o("WAWebMmsMediaTypes").MEDIA_TYPES.AUDIO:return"WhatsApp Audio Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT:return"WhatsApp Document Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.GIF:return"WhatsApp Video Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE:return"WhatsApp Image Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.PPIC:throw r("err")("Cannot create media keys for profile pics");case o("WAWebMmsMediaTypes").MEDIA_TYPES.PRODUCT:return"WhatsApp Image Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.PTT:return"WhatsApp Audio Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER:return"WhatsApp Image Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO:case o("WAWebMmsMediaTypes").MEDIA_TYPES.PTV:return"WhatsApp Video Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_DOCUMENT:return"WhatsApp Document Thumbnail Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER_PACK:return"WhatsApp Sticker Pack Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_STICKER_PACK:return"WhatsApp Sticker Pack Thumbnail Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_IMAGE:return"WhatsApp Image Thumbnail Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_VIDEO:return"WhatsApp Video Thumbnail Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_LINK:return"WhatsApp Link Thumbnail Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.TEMPLATE:throw r("err")("Cannot create media keys for template");case o("WAWebMmsMediaTypes").MEDIA_TYPES.HISTORY_SYNC:return"WhatsApp History Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.MD_APP_STATE:return"WhatsApp App State Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.PRODUCT_CATALOG_IMAGE:throw r("err")("Cannot create media keys for product catalog image");case o("WAWebMmsMediaTypes").MEDIA_TYPES.PAYMENT_BG_IMAGE:return"WhatsApp Payment Background Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.NATIVE_AD_IMAGE:return"ads-image";case o("WAWebMmsMediaTypes").MEDIA_TYPES.NATIVE_AD_VIDEO:return"ads-video";case o("WAWebMmsMediaTypes").MEDIA_TYPES.MUSIC_ARTWORK:return"WhatsApp Music Artwork Keys";case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_AUDIO:case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_DOCUMENT:case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_GIF:case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_IMAGE:case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTT:case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTV:case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER:case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_VIDEO:case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_THUMBNAIL_LINK:case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER_PACK:case o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_MUSIC_ARTWORK:case o("WAWebMmsMediaTypes").MEDIA_TYPES.WAFFLE_IMAGE:case o("WAWebMmsMediaTypes").MEDIA_TYPES.WAFFLE_VIDEO:throw r("err")("createKeys: newsletter media is not encrypted: "+e);case o("WAWebMmsMediaTypes").MEDIA_TYPES.GROUP_HISTORY:return"Group History";default:return}}l.default=s}),98);
__d("WAWebMmsPerformanceExperimentSwitch",["WAWebServerPropConstants"],(function(t,n,r,o,a,i,l){function e(e){return e>o("WAWebServerPropConstants").DEFAULT_MAX_FILE_SIZE_BYTES}l.shouldEncryptInChunks=e}),98);
__d("WAWebWebp",["$InternalEnum","WABinary","WALogger","WATypedArraysEqual"],(function(t,n,r,o,a,i,l){var e,s,u=n("$InternalEnum")({VP8X:"VP8X",ANMF:"ANMF",EXIF:"EXIF",XMP:"XMP "}),c=12,d=8,m=4,p=20,_=2,f=125,g=0;function h(e,t){var n=R(t),o=0;for(o+=c;o<e.byteLength;){var a=e.slice(o,o+d),i=a.slice(0,m),l=v(a.slice(m,2*m));if(l%2!==0&&(l+=1),r("WATypedArraysEqual")(i,n))return{position:o,size:l+m+m};o+=d+l}return null}function y(t){if(!C(t))return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Sticker file not extended format."]))),null;var n=h(t,u.EXIF);if(!n)return null;for(var r=t.slice(n.position,n.position+n.size),a,i,l=r.byteLength;l>0;--l)if(i==null&&r[l]===f)i=l;else if(i!=null&&r[l]===g){a=l+1;break}return a==null||i==null?(o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["JSON not found in sticker file"]))),null):{position:n.position+a,size:i-a+1}}function C(e){var t=e.slice(c,c+m);return r("WATypedArraysEqual")(t,R(u.VP8X))}function b(e){var t=new Uint8Array(e);return C(t)&&(_&t[p])!==0}function v(e){return e.reduce(function(e,t,n){return e+(t<<n*8)},0)}function S(e){var t=new(o("WABinary")).Binary;return t.writeUint32(e,!0),t.readByteArrayView()}function R(e){var t=new(o("WABinary")).Binary;return t.writeString(e),t.readByteArrayView()}l.Chunk=u,l.CHUNK_HEADER_SIZE=d,l.FOUR=m,l.findWebpChunk=h,l.findWebpMetadata=y,l.isExtendedFile=C,l.isAnimatedWebp=b,l.littleEndianToNumber=v,l.numberToLittleEndian=S,l.stringToUint8=R}),98);
__d("WAWebWebpMetadata",["$InternalEnum","WAWebStickerMetadataParsing","WAWebWamEnumStickerMakerSourceType"],(function(t,n,r,o,a,i,l){var e=n("$InternalEnum")({CutoutImage:1,WebStickerMaker:2,IosStickerMaker:3,AndroidStickerMaker:4,TransparentImage:5,GIF:6});function s(e){return o("WAWebStickerMetadataParsing").toStickerMetadata(e)}function u(e){var t={};return e.isFirstParty!=null&&(t[o("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.isFirstParty]=e.isFirstParty?1:0),e.isFromStickerMaker!=null&&(t[o("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.isFromStickerMaker]=e.isFromStickerMaker?1:0),e.emojis!=null&&(t[o("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.emojis]=e.emojis),e.stickerPackId!=null&&(t[o("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.stickerPackId]=e.stickerPackId),e.stickerPackName!=null&&(t[o("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.stickerPackName]=e.stickerPackName),e.stickerPackPublisher!=null&&(t[o("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.stickerPackPublisher]=e.stickerPackPublisher),e.stickerPackPlayStoreLink!=null&&(t[o("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.stickerPackPlayStoreLink]=e.stickerPackPlayStoreLink),e.stickerPackAppleStoreLink!=null&&(t[o("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.stickerPackAppleStoreLink]=e.stickerPackAppleStoreLink),e.isAvatar!=null&&(t[o("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.isAvatar]=e.isAvatar?1:0),e.isAiSticker!=null&&(t[o("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.isAiSticker]=e.isAiSticker?1:0),e.stickerMakerSourceType!=null&&(t[o("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.stickerMakerSourceType]=e.stickerMakerSourceType),e.accessibilityLabel!=null&&(t[o("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.accessibilityLabel]=e.accessibilityLabel),t}function c(t){if(t==null)return null;switch(t){case e.CutoutImage:return o("WAWebWamEnumStickerMakerSourceType").STICKER_MAKER_SOURCE_TYPE.CUTOUT_IMAGE;case e.WebStickerMaker:return o("WAWebWamEnumStickerMakerSourceType").STICKER_MAKER_SOURCE_TYPE.WEB_STICKER_MAKER;case e.IosStickerMaker:return o("WAWebWamEnumStickerMakerSourceType").STICKER_MAKER_SOURCE_TYPE.IOS_STICKER_MAKER;case e.AndroidStickerMaker:return o("WAWebWamEnumStickerMakerSourceType").STICKER_MAKER_SOURCE_TYPE.ANDROID_STICKER_MAKER;case e.TransparentImage:return o("WAWebWamEnumStickerMakerSourceType").STICKER_MAKER_SOURCE_TYPE.TRANSPARENT_IMAGE;case e.GIF:return o("WAWebWamEnumStickerMakerSourceType").STICKER_MAKER_SOURCE_TYPE.GIF}}l.StickerMakerSourceType=e,l.toWebpMetadata=s,l.toRawWebpMetadata=u,l.getStickerMakerSourceType=c}),98);
__d("WAWebStickerMetadataParsing",["WAWebWebpMetadata"],(function(t,n,r,o,a,i,l){"use strict";var e={isFirstParty:!1,isFromStickerMaker:!1,emojis:[],stickerPackId:null,stickerPackName:null,stickerPackPublisher:null,stickerPackPlayStoreLink:null,stickerPackAppleStoreLink:null,isAvatar:!1,isAiSticker:!1,stickerMakerSourceType:null,accessibilityLabel:null},s={isFirstParty:"is-first-party-sticker",isFromStickerMaker:"is-from-sticker-maker",emojis:"emojis",stickerPackId:"sticker-pack-id",stickerPackName:"sticker-pack-name",stickerPackPublisher:"sticker-pack-publisher",stickerPackPlayStoreLink:"android-app-store-link",stickerPackAppleStoreLink:"ios-app-store-link",isAvatar:"is-avatar-sticker",isAiSticker:"is-ai-sticker",stickerMakerSourceType:"sticker-maker-source-type",accessibilityLabel:"accessibility-text"};function u(t){var n=t[s.isFirstParty],r=t[s.isFromStickerMaker],a=t[s.emojis],i=t[s.stickerPackId],l=t[s.stickerPackName],u=t[s.stickerPackPublisher],c=t[s.stickerPackPlayStoreLink],d=t[s.stickerPackAppleStoreLink],m=t[s.isAvatar],p=t[s.isAiSticker],_=o("WAWebWebpMetadata").StickerMakerSourceType.cast(t[s.stickerMakerSourceType]),f=t[s.accessibilityLabel],g=babelHelpers.extends({},e);if(n!=null){var h=n===1;g.isFirstParty=h}if(r!=null){var y=r===1;g.isFromStickerMaker=y}if(a!=null&&Array.isArray(a)&&(g.emojis=a),i!=null&&(g.stickerPackId=i),l!=null&&(g.stickerPackName=l),u!=null&&(g.stickerPackPublisher=u),c!=null&&(g.stickerPackPlayStoreLink=c),d!=null&&(g.stickerPackAppleStoreLink=d),m!=null){var C=m===1;g.isAvatar=C}if(p!=null){var b=p===1;g.isAiSticker=b}return _!=null&&(g.stickerMakerSourceType=_),f!=null&&(g.accessibilityLabel=f),g}l.DEFAULT_STICKER_METADATA=e,l.STICKER_METADATA_FIELDS=s,l.toStickerMetadata=u}),98);
__d("WAWebGetWebpMetadata",["WALogger","WAWebWebp","WAWebWebpMetadata"],(function(t,n,r,o,a,i,l){var e;function s(t){var n=new Uint8Array(t),r=o("WAWebWebp").findWebpMetadata(n);if(!r)return{};var a=r.position,i=r.size,l=new TextDecoder,s=n.slice(a,a+i),u=l.decode(s);try{var c=JSON.parse(u);return c}catch(t){return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to parse emojis out of sticker, returning empty object."]))).devConsole(t),{}}}function u(e){var t=s(e),n=o("WAWebWebpMetadata").toWebpMetadata(t);return n}l.getWebpMetadata=u}),98);
__d("WAWebWebpParseWebp",["WALogger","WATypedArraysEqual","WAWebGetWebpMetadata","WAWebWebp"],(function(t,n,r,o,a,i,l){var e,s=3,u=5e3;function c(e){if(e===0)return 0;var t=Math.min(Math.floor(u/e),s);return Math.max(t,1)*e}var d=44,m=20,p=3,_=4,f={animationDuration:0,singleLoopDuration:0,emojis:[],isFirstParty:!1,isFromStickerMaker:!1,stickerPackId:null,stickerPackName:null,stickerPackPublisher:null,isAvatar:!1,isAiSticker:!1,stickerMakerSourceType:null,accessibilityLabel:null};function g(t){var n=new Uint8Array(t);if(!o("WAWebWebp").isExtendedFile(n))return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Sticker file not extended format."]))),f;var a=o("WAWebGetWebpMetadata").getWebpMetadata(t),i=a.emojis,l=a.isFirstParty,s=a.isFromStickerMaker,u=a.stickerPackId,g=a.stickerPackName,h=a.stickerPackPublisher,y=a.isAvatar,C=a.isAiSticker,b=a.stickerMakerSourceType,v=a.accessibilityLabel,S=babelHelpers.extends({},f,{emojis:i,isFirstParty:l,isFromStickerMaker:s,stickerPackId:u,stickerPackName:g,stickerPackPublisher:h,isAvatar:y,isAiSticker:C,stickerMakerSourceType:b,accessibilityLabel:v});if(!o("WAWebWebp").isAnimatedWebp(n))return S;for(var R=0,L=d,E;r("WATypedArraysEqual")(n.slice(L,L+_),o("WAWebWebp").stringToUint8(o("WAWebWebp").Chunk.ANMF));){var k=L+m,I=n.slice(k,k+p);if(I.length!==p)return S;R+=o("WAWebWebp").littleEndianToNumber(I);var T=L+_,D=n.slice(T,T+_);if(D.length!==_)return S;L+=_*2+o("WAWebWebp").littleEndianToNumber(D),E==null&&(E=L)}var x=c(R);return babelHelpers.extends({},S,{animationDuration:x,firstFrameLength:E,singleLoopDuration:R})}l.MAX_LOOPS=s,l.getTotalAnimationDuration=c,l.parseWebp=g}),98);
__d("WAWebCryptoEncryptMedia",["Promise","WAArrayBuffersConcat","WACryptoAesCbc","WACryptoHmac","WALogger","WAMediaCalculateFilehash","WAPromiseProps","WATypedArraysConcat","WAWebCryptoCalculateFirstFrameSidecar","WAWebCryptoCalculateStreamingSidecar","WAWebCryptoCreateMediaKeys","WAWebMiscErrors","WAWebMmsMediaTypes","WAWebMmsPerformanceExperimentSwitch","WAWebWebpParseWebp","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=10;function m(e){var t=e.ivCiphertext,r=e.signature,a=e.macKey,i=o("WAArrayBuffersConcat").concatArrayBuffers(t,r);return{sidecar:o("WAWebCryptoCalculateStreamingSidecar").calculateStreamingSidecar(i,a),firstFrameSidecar:(c||(c=n("Promise"))).resolve()}}function p(e){var t=e.plaintext,a=e.ivCiphertext,i=e.signature,l=e.macKey,s=o("WAWebWebpParseWebp").parseWebp(t),u=s.firstFrameLength;return{sidecar:(c||(c=n("Promise"))).resolve(),firstFrameSidecar:u!=null?r("WAWebCryptoCalculateFirstFrameSidecar")(u,o("WAArrayBuffersConcat").concatArrayBuffers(a,i),l):(c||(c=n("Promise"))).resolve()}}var _=new Map([[o("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO,m],[o("WAWebMmsMediaTypes").MEDIA_TYPES.AUDIO,m],[o("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER,p]]);function f(e,t,n){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){var a,i,l=r.iv,s=r.encKey,u=r.macKey,m=o("WAWebMmsPerformanceExperimentSwitch").shouldEncryptInChunks(e.byteLength)?yield o("WACryptoAesCbc").aesCbcEncryptWithChunking(s,e,l):yield o("WACryptoAesCbc").aesCbcEncrypt(s,e,l),p=new Uint8Array(m).subarray(l.byteLength),f=yield o("WACryptoHmac").hmacSha256(u,m,d),g=(a=(i=_.get(t))==null?void 0:i({plaintext:e,ivCiphertext:m,signature:f,macKey:u}))!=null?a:{},h=g.sidecar,y=h===void 0?(c||(c=n("Promise"))).resolve():h,C=g.firstFrameSidecar,b=C===void 0?(c||(c=n("Promise"))).resolve():C,v=o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[p,new Uint8Array(f)]).buffer;return o("WAPromiseProps").promiseProps({ciphertextHmac:v,hash:o("WAMediaCalculateFilehash").calculateFilehash(v),sidecar:y,firstFrameSidecar:b})}),g.apply(this,arguments)}function h(t){var a=t.mediaKey,i=t.plaintext,l=t.type;return new(c||(c=n("Promise")))(function(t,n){var c={mediaKey:a.slice(0,10),type:l};if(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["encryptMedia: start"]))).devConsole(c),!l)throw new(o("WAWebMiscErrors")).MediaEncryptionError('encryptMedia: missing "type"');if(!a)throw new(o("WAWebMiscErrors")).MediaEncryptionError('encryptMedia: missing "mediaKey"');r("WAWebCryptoCreateMediaKeys")(l,a).then(function(e){return f(i,l,e)}).then(function(e){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["encryptMedia: success"]))).devConsole(c),t(e)}).catch(function(e){throw o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["encryptMedia: error"]))).devConsole(c,e),e instanceof o("WAWebMiscErrors").MediaEncryptionError?e:new(o("WAWebMiscErrors")).MediaEncryptionError("encryption error: "+String(e)+"; stack: "+e.stack)}).catch(n)})}l.default=h}),98);
__d("WAWebCryptoRandomMediaKey",["WABase64","WATimeUtils"],(function(t,n,r,o,a,i,l){function e(){var e=new Uint8Array(32);return self.crypto.getRandomValues(e),{key:o("WABase64").encodeB64(e),timestamp:o("WATimeUtils").unixTime()}}l.default=e}),98);
__d("WAWebMediaDebugString",[],(function(t,n,r,o,a,i){function e(e){var t;return(t=e==null?void 0:e.slice(0,10))!=null?t:""}i.getDebugString=e}),66);
__d("WAWebMmsDownloadUploadCrashLogger",["$InternalEnum","WALogger","WAWebLocalStorage","justknobx"],(function(t,n,r,o,a,i,l){var e,s=n("$InternalEnum").Mirrored(["DOWNLOAD_STARTED","DOWNLOAD_FINISHED","DOWNLOAD_DECRYPTION_STARTED","DOWNLOAD_DECRYPTION_FINISHED","DOWNLOAD_ERROR","UPLOAD_STARTED","UPLOAD_FINISHED","UPLOAD_BLOB_TO_ARRAY_BUFFER_STARTED","UPLOAD_BLOB_TO_ARRAY_BUFFER_FINISHED","UPLOAD_ENCRYPTION_STARTED","UPLOAD_ENCRYPTION_FINISHED","UPLOAD_ERROR"]),u="DownloadUploadCrashLoggerLikelyCrashed",c=new Set([s.DOWNLOAD_DECRYPTION_FINISHED,s.DOWNLOAD_ERROR,s.UPLOAD_FINISHED,s.UPLOAD_ERROR]);function d(e){return e.toLowerCase().replace(/(?:^|_)(\w)/g,function(e,t){return t.toLocaleUpperCase()})}function m(e){return Object.entries(e).map(function(e){var t=e[0],n=e[1];return t+": "+String(n)}).join(", ")}var p=(function(){function t(){this.hasPerformedInit=!1,this.$3=function(){r("WAWebLocalStorage")==null||r("WAWebLocalStorage").removeItem(u)}}var n=t.prototype;return n.$1=function(){var e=r("WAWebLocalStorage")==null?void 0:r("WAWebLocalStorage").getItem(u);return e?JSON.parse(e):{}},n.$2=function(){r("WAWebLocalStorage")==null||r("WAWebLocalStorage").setItem(u,JSON.stringify(this.storage))},n.$4=function(){return r("justknobx")._("3944")},n.init=function(){this.hasPerformedInit||!this.$4()||(window.addEventListener("beforeunload",this.$3),this.storage=this.$1(),Object.entries(this.storage).forEach(function(t){var n=t[0],r=t[1],a=r.progressType,i=r.metadata;o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["downloadUploadCrashLogger.likelyCrashedDuring","WithID","",""])),d(a),n,i?"AndData => "+m(i):"").sendLogs("download-upload-manager-likely-crashed")}),this.$3(),this.hasPerformedInit=!0)},n.reset=function(){this.$4()&&(window.removeEventListener("beforeunload",this.$3),this.$3(),this.hasPerformedInit=!1)},n.mark=function(t,n,r){this.$4()&&(c.has(n)?delete this.storage[String(t)]:this.storage[String(t)]={progressType:n,metadata:r},this.$2())},t})(),_=new p;l.ProgressType=s,l.downloadUploadCrashLogger=_}),98);
__d("WAWebUploadManager",["Promise","WAAbortError","WAFilteredCatch","WALogger","WAMemoizeConcurrent","WATimeUtils","WAWebCreateMediaUploadMetrics","WAWebCryptoEncryptMedia","WAWebCryptoRandomMediaKey","WAWebFileUtils","WAWebMediaDebugString","WAWebMmsClient","WAWebMmsClientErrors","WAWebMmsDownloadUploadCrashLogger","WAWebPonyfillsUrlSearchParams","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C;function b(e){var t=e.mediaKey,n=e.mediaKeyTimestamp;if(t!=null&&n!=null)return{mediaKey:t,mediaKeyTimestamp:n};var o=r("WAWebCryptoRandomMediaKey")(),a=o.key,i=o.timestamp;return{mediaKey:a,mediaKeyTimestamp:i}}var v=(function(){function t(){var t=this;this._checkIfAlreadyUploaded=r("WAMemoizeConcurrent")(function(e){return e.token},(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.encFilehash,a=t.type,i={encFilehash:n,type:a},l=o("WAWebMediaDebugString").getDebugString(n);o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["uploadManager.checkIfAlreadyUploaded: [","] start"])),l).devConsole(i);try{var d=yield r("WAWebMmsClient").checkIfUploadExists(t).catch(o("WAFilteredCatch").filteredCatch(o("WAWebMmsClientErrors").MediaNotFoundError,function(){return null}));return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["uploadManager.checkIfAlreadyUploaded: [","] success"])),l).devConsole(i),d}catch(e){throw e.name===o("WAAbortError").ABORT_ERROR?o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["uploadManager.checkIfAlreadyUploaded: [","] canceled"])),l).devConsole(i,e):o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["uploadManager.checkIfAlreadyUploaded: [","] error"])),l).devConsole(i,e),e}});return function(e){return t.apply(this,arguments)}})()),this._memoizedUpload=r("WAMemoizeConcurrent")(function(e){return e.token},(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=e.ciphertextHmac,o=e.encFilehash,a=e.type,i=e.signal,l=e.onUploadHostFound,s=e.onUploadAttemptSuccess,u=e.onUploadAttemptError,c=e.onUploadSuccess,d=e.onProgress,m=e.onFinalize,p=e.onStreamUploadStart,_=e.mediaId,f=e.generateThumbnailOnServer,g=yield r("WAWebMmsClient").upload({ciphertextHmac:n,encFilehash:o,type:a,signal:i,onUploadHostFound:l,onUploadAttemptSuccess:s,onUploadAttemptError:u,onProgress:d,byteOffset:(t=e.byteOffset)!=null?t:0,onFinalize:m,onStreamUploadStart:p,mediaId:_,token:e.token,generateThumbnailOnServer:f});return c(),g});return function(t){return e.apply(this,arguments)}})()),this._getExistingOrUpload=r("WAMemoizeConcurrent")(function(e){return e.token},(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n=e.ciphertextHmac,r=e.encFilehash,a=e.signal,i=e.type,l=e.onCheckExistingSuccess,s=e.onCheckExistingError,u=e.onUploadHostFound,c=e.onUploadAttemptSuccess,f=e.onUploadAttemptError,g=e.onUploadSuccess,h=e.onProgress,y=e.onFinalize,C=e.onStreamUploadStart,b=e.mediaId,v=e.generateThumbnailOnServer,S={encFilehash:r,type:i},R=o("WAWebMediaDebugString").getDebugString(r);o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["uploadManager._getExistingOrUpload: [","] start"])),R).devConsole(S);try{var L=yield t._checkIfAlreadyUploaded({encFilehash:r,type:i,signal:a,mediaId:b,token:e.token,generateThumbnailOnServer:v}).catch(function(e){throw s(e),e}).then(function(o){return(o==null?void 0:o.complete)===!0?(l(),{directPath:o.directPath,handle:o.handle,url:o.url}):t._memoizedUpload({ciphertextHmac:n,encFilehash:r,type:i,signal:a,onUploadHostFound:u,onUploadAttemptSuccess:c,onUploadAttemptError:f,onUploadSuccess:g,onCheckExistingSuccess:l,onCheckExistingError:s,onProgress:h,onFinalize:y,onStreamUploadStart:C,byteOffset:o==null?void 0:o.resume,mediaId:b,token:e.token,generateThumbnailOnServer:v})});return o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["uploadManager._getExistingOrUpload: [","] success"])),R).devConsole(S,L),L}catch(e){throw e.name===o("WAAbortError").ABORT_ERROR?o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["uploadManager._getExistingOrUpload: [","] canceled"])),R).devConsole(S,e):o("WALogger").WARN(_||(_=babelHelpers.taggedTemplateLiteralLoose(["uploadManager._getExistingOrUpload: [","] error"])),R).devConsole(S,e),e}});return function(t){return e.apply(this,arguments)}})()),o("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.init()}var a=t.prototype;return a.encryptAndUpload=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this,a=e.blob,i=e.signal,l=e.type,s=e.userUploadAttemptCount,u=e.forwardedFromWeb,c=e.uploadOrigin,d=e.onProgress,m=e.onFinalize,p=e.isViewOnce,_=e.isHdPhoto,v={type:l};o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["uploadManager.encryptAndUpload: start"]))).devConsole(v);var S=r("WAWebCreateMediaUploadMetrics")(l,c,s,u,p,_),L=S.handleCheckExistingSuccess,E=S.handleCheckExistingError,k=S.handleUploadHostFound,I=S.handleUploadAttemptSuccess,T=S.handleUploadAttemptError,D=S.handleUploadSuccess,x=S.handleArrayBufferCreated,$=S.handleUploadError,P=S.mediaId,N=S.handleEncryptionStart,M=S.handleEncryptionSuccess,w=S.handleStreamUploadStart,A=S.handleUploadProgress,F=function(t,n){d==null||d(t,n);var e=n+t.loaded;A(e)};o("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(P,o("WAWebMmsDownloadUploadCrashLogger").ProgressType.UPLOAD_ENCRYPTION_STARTED);try{var O=b(e),B=(C||(C=n("Promise"))).resolve(a).then(function(e){o("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(P,o("WAWebMmsDownloadUploadCrashLogger").ProgressType.UPLOAD_BLOB_TO_ARRAY_BUFFER_STARTED,{size:a instanceof Blob?a.size:a.byteLength});var t=e instanceof Blob?o("WAWebFileUtils").blobToArrayBuffer(e):e;return o("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(P,o("WAWebMmsDownloadUploadCrashLogger").ProgressType.UPLOAD_BLOB_TO_ARRAY_BUFFER_FINISHED),t}).then(function(e){return x(e.byteLength),N(),r("WAWebCryptoEncryptMedia")({type:l,plaintext:e,mediaKey:O.mediaKey})}).then(function(n){var r,a=n.hash,s=n.ciphertextHmac,c=n.sidecar,d=n.firstFrameSidecar;M(),o("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(P,o("WAWebMmsDownloadUploadCrashLogger").ProgressType.UPLOAD_ENCRYPTION_FINISHED);var p=e.mediaKey?t._getExistingOrUpload:t._memoizedUpload;return p({ciphertextHmac:s,encFilehash:a,type:l,signal:i,onCheckExistingSuccess:L,onCheckExistingError:E,onUploadHostFound:k,onUploadAttemptSuccess:I,onUploadAttemptError:T,onUploadSuccess:D,onProgress:F,onFinalize:m,onStreamUploadStart:w,mediaId:P,token:(r=e.token)!=null?r:a}).then(function(e){return{directPath:u?R(e.directPath):e.directPath,encFilehash:a,mediaKey:O.mediaKey,mediaKeyTimestamp:O.mediaKeyTimestamp,sidecar:c,firstFrameSidecar:d,url:e.url,handle:e.handle}})}),W=yield B;return o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["uploadManager.encryptAndUpload: success"]))).devConsole(v),o("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(P,o("WAWebMmsDownloadUploadCrashLogger").ProgressType.UPLOAD_FINISHED),W}catch(e){throw e.name===o("WAAbortError").ABORT_ERROR?o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["uploadManager.encryptAndUpload: canceled"]))).devConsole(v,e):o("WALogger").WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["uploadManager.encryptAndUpload: error"]))).devConsole(v,e),o("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(P,o("WAWebMmsDownloadUploadCrashLogger").ProgressType.UPLOAD_ERROR),$(e),e}});function t(t){return e.apply(this,arguments)}return t})(),a.unencryptedUpload=function(t){var e,n=t.file,o=t.hash,a=t.type,i=t.signal,l=t.uploadOrigin,s=t.isViewOnce,u=t.generateThumbnailOnServer,c=r("WAWebCreateMediaUploadMetrics")(a,l,0,!1,s),d=c.handleCheckExistingSuccess,m=c.handleCheckExistingError,p=c.handleUploadHostFound,_=c.handleUploadAttemptSuccess,f=c.handleUploadAttemptError,g=c.handleUploadSuccess,h=c.handleStreamUploadStart,y=c.handleUploadProgress,C=c.mediaId,b=function(t,n){y(t.loaded+n)},v=(e=t.token)!=null?e:o;return this._getExistingOrUpload({ciphertextHmac:n,encFilehash:o,type:a,signal:i,onCheckExistingSuccess:d,onCheckExistingError:m,onUploadHostFound:p,onUploadAttemptSuccess:_,onUploadAttemptError:f,onUploadSuccess:g,onStreamUploadStart:h,onProgress:b,mediaId:C,token:v,generateThumbnailOnServer:u})},a.uploadCoverPhoto=function(t){var e,n=t.file,o=t.hash,a=t.type,i=t.signal,l=t.uploadOrigin,s=t.isViewOnce,u=r("WAWebCreateMediaUploadMetrics")(a,l,0,!1,s),c=u.handleCheckExistingSuccess,d=u.handleCheckExistingError,m=u.handleUploadHostFound,p=u.handleUploadAttemptSuccess,_=u.handleUploadAttemptError,f=u.handleUploadSuccess,g=u.handleStreamUploadStart,h=u.handleUploadProgress,y=u.mediaId,C=function(t,n){h(t.loaded+n)},b={ciphertextHmac:n,encFilehash:o,type:a,signal:i,onCheckExistingSuccess:c,onCheckExistingError:d,onUploadHostFound:m,onUploadAttemptSuccess:p,onUploadAttemptError:_,onUploadSuccess:f,onStreamUploadStart:g,onProgress:C,mediaId:y,token:(e=t.token)!=null?e:t.hash};return this._memoizedUpload(b)},t})(),S=new v;function R(e){var t=e.split("?"),n=t[0],a=t[1],i=new(r("WAWebPonyfillsUrlSearchParams"))(a),l=o("WATimeUtils").unixTime();return i.set("_nc_hot",String(l)),n+"?"+i.toString()}l.default=S}),98);
__d("WAWebSyncdNetCallbacksApi",["WABase64","WALogger","WAWebDownloadManager","WAWebMmsClientErrors","WAWebSyncdError","WAWebSyncdUploadFatalErrorMetric","WAWebUploadManager","WAWebWamEnumMdSyncdFatalErrorCode","WAWebWamEnumUploadOriginType","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s=function(t){return r("WAWebUploadManager").encryptAndUpload({blob:t,signal:new AbortController().signal,type:"md-app-state",uploadOrigin:o("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.UNKNOWN,userUploadAttemptCount:0,forwardedFromWeb:!1,isViewOnce:!1}).then(function(e){var t=e.mediaKey,n=e.directPath,a=e.encFilehash,i=e.handle;if(i==null)throw r("err")("Missing handle after uploading external patch to mms4");return{mediaKey:o("WABase64").decodeB64(t),directPath:n,encFilehash:o("WABase64").decodeB64(a),handle:i}})},u=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){var a=t.mediaKey,i=t.directPath,l=t.fileSha256,s=t.fileEncSha256,u={directPath:i,encFilehash:o("WABase64").encodeB64(s),filehash:o("WABase64").encodeB64(l),mediaKey:o("WABase64").encodeB64(a),type:"md-app-state",userDownloadAttemptCount:0};try{return yield o("WAWebDownloadManager").downloadManager.downloadAndMaybeDecrypt(babelHelpers.extends({signal:new AbortController().signal},u))}catch(a){throw o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: error downloading "," of expected size "," with expected hash b64 length of "," for collection ",""])),n,t.fileSizeBytes,o("WABase64").encodeB64(t.fileEncSha256).length,r),a instanceof o("WAWebMmsClientErrors").MediaNotFoundError?(o("WAWebSyncdUploadFatalErrorMetric").uploadFatalErrorMetric(n==="patch"?o("WAWebWamEnumMdSyncdFatalErrorCode").MD_SYNCD_FATAL_ERROR_CODE.EXTERNAL_PATCH_EXPIRED:o("WAWebWamEnumMdSyncdFatalErrorCode").MD_SYNCD_FATAL_ERROR_CODE.SNAPSHOT_EXPIRED,r),new(o("WAWebSyncdError")).SyncdFatalError("external patch expired")):a}});return function(n,r,o){return t.apply(this,arguments)}})();l.uploadSyncExternalPatch=s,l.downloadSyncBlob=u}),98);
__d("WAWebSyncdOrphan",["Promise","WALogger","WASyncdConst","WAWebGetSyncAction","WAWebMiscGatingUtils","WAWebSyncdCollectionHandler","WAWebSyncdDbCallbacksApi","WAWebSyncdDisabled","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y;function C(e,t){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(o("WAWebSyncdDisabled").isSyncdDisabled())return(y||(y=n("Promise"))).resolve();yield(y||(y=n("Promise"))).all([v(e),R(t),o("WAWebSyncdDbCallbacksApi").bulkGetAccountLid(t).then(function(e){return E(e.filter(Boolean))})])}),b.apply(this,arguments)}function v(e){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebSyncdDbCallbacksApi").getAdditionalLidMsgKeys(e);yield I(e.concat(t),o("WASyncdConst").SyncModelType.Msg)}),S.apply(this,arguments)}function R(e){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield I(e,o("WASyncdConst").SyncModelType.Chat)}),L.apply(this,arguments)}function E(e){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield I(e,o("WASyncdConst").SyncModelType.Account)}),k.apply(this,arguments)}function I(e,t){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){if(o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: applying orphans of type "," with ids=",""])),r,t),o("WAWebSyncdDisabled").isSyncdDisabled())return(y||(y=n("Promise"))).resolve();var a=yield o("WAWebGetSyncAction").getSyncActionsByModelInfosInTransaction(t.map(function(e){return[e,r,o("WASyncdConst").SyncActionState.Orphan]}));yield o("WAWebSyncdCollectionHandler").applyIndividualMutations(a),o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: finished applying orphans of type "," with ids=",""])),r,t)}),T.apply(this,arguments)}function D(){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebSyncdDisabled").isSyncdDisabled())return(y||(y=n("Promise"))).resolve();o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: start applyAllOrphansAndUnsupported"])));var e=yield o("WAWebGetSyncAction").getSyncActionsByActionStatesInTransaction([o("WASyncdConst").SyncActionState.Orphan,o("WASyncdConst").SyncActionState.Unsupported]);yield o("WAWebSyncdCollectionHandler").applyIndividualMutations(e),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["syncd: end applyAllOrphansAndUnsupported"])))}),x.apply(this,arguments)}function $(e){return P.apply(this,arguments)}function P(){return P=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield I(e,o("WASyncdConst").SyncModelType.Agent)}),P.apply(this,arguments)}function N(e){return M.apply(this,arguments)}function M(){return M=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield I(e,o("WASyncdConst").SyncModelType.ChatAssignment)}),M.apply(this,arguments)}function w(e){return A.apply(this,arguments)}function A(){return A=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield I(e,o("WASyncdConst").SyncModelType.UserStatusMute)}),A.apply(this,arguments)}function F(e,t){return O.apply(this,arguments)}function O(){return O=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["syncd: applying all orphans for type ",""])),e),o("WAWebSyncdDisabled").isSyncdDisabled())return(y||(y=n("Promise"))).resolve();var r=yield o("WAWebGetSyncAction").getOrphanSyncActionsByModelTypeInTransaction(e);if(r.length===0){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: no orphans for type "," to apply"])),e);return}t!=null&&!t()||(yield o("WAWebSyncdCollectionHandler").applyIndividualMutations(r),o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["syncd: finished applying all orphans for type ",", count=",""])),e,r.length))}),O.apply(this,arguments)}function B(){return W.apply(this,arguments)}function W(){return W=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["syncd: checkOrphanFavoriteStickers"]))),!o("WAWebMiscGatingUtils").isFavoriteStickersEnabled()){o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["syncd: checkOrphanFavoriteStickers: favorite stickers not enabled in primary device"])));return}yield F(o("WASyncdConst").SyncModelType.FavoriteSticker,function(){var e=o("WAWebMiscGatingUtils").isFavoriteStickerSyncAfterPairingEnabled();return o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["syncd: checkOrphanFavoriteStickers: favorite sticker sync after pairing enabled: ",""])),e),e}),o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: checkOrphanFavoriteStickers: finished"])))}),W.apply(this,arguments)}l.checkOrphanMutations=C,l.checkOrphanMessages=v,l.checkOrphanChats=R,l.applyAllOrphansAndUnsupported=D,l.checkOrphanAgents=$,l.checkOrphanChatAssignments=N,l.checkOrphanUserStatusMutes=w,l.checkOrphanFavoriteStickers=B}),98);
__d("WAWebSyncdResponseParser",["WADeprecatedWapParser","WALogger","WASyncdConst","WAWebSyncdDecode","WAWebSyncdError","WAWebSyncdMetricFatalError"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g=new(r("WADeprecatedWapParser"))("syncResponseParser",function(t){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: start parsing syncd collections"])));var n=[],r=t.child("sync");return r.mapChildrenWithTag("collection",function(e){var t=o("WASyncdConst").CollectionName.cast(e.attrString("name"));if(!t)throw new(o("WAWebSyncdError")).SyncdFatalError("invalid collection name");var r={name:t};r.state=h(e,r.name),e.hasAttr("version")&&(r.version=parseInt(e.attrString("version"),10)),e.hasChild("patches")&&(r.patches=e.child("patches").mapChildrenWithTag("patch",function(e){return o("WAWebSyncdDecode").decodeSyncdPatch(t,e.contentBytes())})),e.hasChild("snapshot")&&(r.snapshot=o("WAWebSyncdDecode").decodeExternalBlobReference(t,e.child("snapshot").contentBytes())),n.push(r),r.version==null&&r.patches==null&&r.snapshot==null&&o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," has no version, patches or snapshot"])),t),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: successfully parsed collection ",""])),t)}),n});function h(e,t){if(e.hasAttr("type")&&e.attrString("type")==="error"){var n=e.child("error"),r=n.attrString("code"),a=n.attrString("text");switch(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," got server error: ",""])),t,r),r){case"409":return e.hasAttr("has_more_patches")?o("WASyncdConst").CollectionState.ConflictHasMore:o("WASyncdConst").CollectionState.Conflict;case"400":return o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.XMPP_BAD_REQUEST_FOR_COLLECTION),o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: collection "," throws ",""])),String(t),a).sendLogs("syncd: fatal error 400: collection "+String(t)),o("WASyncdConst").CollectionState.ErrorFatal;case"404":return o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.XMPP_NOT_FOUND_FOR_COLLECTION),o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error 404: collection "," throws ",""])),String(t),a).sendLogs("syncd: fatal error: collection "+String(t)),o("WASyncdConst").CollectionState.ErrorFatal;default:return o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["syncd: retryable error: collection "," throws ",""])),String(t),a).sendLogs("syncd: retryable error: collection "+String(t)),o("WASyncdConst").CollectionState.ErrorRetry}}else return e.hasAttr("has_more_patches")?(o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," got server code has_more_patches"])),t),o("WASyncdConst").CollectionState.SuccessHasMore):(o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," did not get server error"])),t),o("WASyncdConst").CollectionState.Success)}l.syncResponseParser=g}),98);
__d("WAWebSyncdServerSync",["Promise","WADeprecatedSendIq","WALogger","WASyncdConst","WAWebGetPendingMutation","WAWebRuntimeEnvironmentUtils","WAWebSyncd","WAWebSyncdCollectionHandler","WAWebSyncdDbCallbacksApi","WAWebSyncdError","WAWebSyncdMetricCriticalBootstrapStage","WAWebSyncdMetricFatalError","WAWebSyncdMetrics","WAWebSyncdRequestBuilder","WAWebSyncdResponseParser","WAWebSyncdWamAppState","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y,C=5,b=500;function v(e){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=Math.random().toString(36).substr(2,5);yield T(t,r+" start serverSync");for(var a=[],i=[].concat(t),l=0;(l<C||i.length>0&&l<b)&&i.length!==0;){var s=yield R(i,r),u=s.doneCollections,c=s.refetchCollections;yield(y||(y=n("Promise"))).all(u.map(function(e){return T([e.name],r+" done collection "+e.name+",\n            state: "+e.state)})),i=c,a=a.concat(u),l++,r=Math.random().toString(36).substr(2,5)}return i.length>0&&(yield T(i,"error: max iterations"),o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: reached max iterations for collections: ",""])),i).tags("syncd").sendLogs("syncd: max iteration"),a=a.concat(i.map(function(e){return{state:o("WASyncdConst").CollectionState.ErrorRetry,name:e}}))),a}),S.apply(this,arguments)}function R(e,t){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(e.length===0)return{doneCollections:[],refetchCollections:[]};try{var r=yield E(e,t),a=r.collectionDetails,i=r.localCollectionVersions,l=r.collectionsToUpload;l.length>0&&o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: deferred local mutation upload for ",""])),l),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: local collection versions:"])),t),i.forEach(function(e,t){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["\n	"," v",""],["\\n\\t"," v",""])),t,e!=null?e:"(undefined)}")});var f=[],g=[];a.forEach(function(e){switch(e.state){case o("WASyncdConst").CollectionState.ErrorRetry:case o("WASyncdConst").CollectionState.ErrorFatal:case o("WASyncdConst").CollectionState.Blocked:g.push(e);return;default:f.push(e)}(e.state===o("WASyncdConst").CollectionState.Conflict||e.state===o("WASyncdConst").CollectionState.ConflictHasMore)&&o("WAWebSyncdWamAppState").incConflict()}),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: start apply collections:\n      ",""])),t,f.map(function(e){return e.name}));var h=new(o("WAWebSyncdMetrics")).SyncdEventFlow,C=yield(y||(y=n("Promise"))).all(f.map(function(e){return o("WAWebSyncdCollectionHandler").applyAppStateSyncResponse(e,t,i.get(e.name),h)}));h.end(),o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: end apply collections: ",""])),f.map(function(e){return e.name}));var b=[];return yield y.all(C.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e.state===o("WASyncdConst").CollectionState.Conflict){var t=(yield o("WAWebGetPendingMutation").getSyncPendingMutationsByCollectionInTransaction(e.name)).length>0;t?b.push(e.name):(e.state=o("WASyncdConst").CollectionState.Success,g.push(e))}else e.state===o("WASyncdConst").CollectionState.ConflictHasMore||e.state===o("WASyncdConst").CollectionState.SuccessHasMore||e.state===o("WASyncdConst").CollectionState.Success&&l.some(function(t){return t===e.name})?b.push(e.name):g.push(e)});return function(t){return e.apply(this,arguments)}})())),{doneCollections:g,refetchCollections:b}}catch(n){if(n instanceof o("WAWebSyncdError").SyncdFatalError){o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: syncd global throws ",""])),n.message).sendLogs("syncd: fatal error: syncd global throws "+n.message),yield T(e,t+" moving to fatal state: "+n.name+" "+n.message+" "+n.stack);var v=e.map(function(e){return{state:o("WASyncdConst").CollectionState.ErrorFatal,name:e}});return{doneCollections:v,refetchCollections:[]}}o("WALogger").WARN(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: retryable error: syncd global throws ",""])),t,n.message).sendLogs("syncd: retryable error: syncd global throws "+n.message),yield T(e,"["+t+"] retryable error: "+n);var S=e.map(function(e){return{state:o("WASyncdConst").CollectionState.ErrorRetry,name:e,serverBackoff:n.errorBackoff}});return{doneCollections:S,refetchCollections:[]}}}),L.apply(this,arguments)}function E(e,t){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield r("WAWebSyncdRequestBuilder")(e,t),a=n.syncIqNode,i=n.collectionWithPendingMutationsIds,l=n.collectionWithEncryptedMutations,s=n.localCollectionVersions,u=n.collectionsToSkip;o("WAWebSyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(o("WAWebSyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.REQUEST_BUILT);var c="["+t+"] syncd: before sendIq for collections:\n    "+e.map(function(e){var t,n,r;return"\n	\n          "+e+" v"+((t=s.get(e))!=null?t:"(undefined)")+" "+(((n=(r=i.get(e))==null?void 0:r.length)!=null?n:0)>0&&s.get(e)!=null?" with local changes":"")}).join(",")+"\n\n  in flight: "+Array.from(o("WAWebSyncd").getInFlightCollections()).join(",")+"\n  pending: "+Array.from(o("WAWebSyncd").getPendingCollections()).join(",")+"\n  is worker? "+o("WAWebRuntimeEnvironmentUtils").isWorker().toString()+"\n  ";o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: ",""])),t,c),yield T(e,c);var d=yield o("WADeprecatedSendIq").deprecatedSendIq(a,o("WAWebSyncdResponseParser").syncResponseParser);if(o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: completed network operation for collections:\n    ",""])),t,e),o("WAWebSyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(o("WAWebSyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.RESPONSE_RECEIVED),d.success){o("WAWebSyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(o("WAWebSyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.RESPONSE_PARSED_VALID),yield T(e,"["+t+"] after sendIq success");var m=d.result;return o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: received sync response for collections:\n      ",""])),t,m.map(function(e){var t="\n"+e.name;return e.version!=null&&(t+="\n	updated to version "+e.version),e.snapshot!=null&&(t+="\n	contains snapshot"),e.patches!=null&&(t+="\n	contains "+e.patches.length+" patches"),t})),m.forEach(function(e){var t=i.get(e.name);t&&(e.syncedPendingMutationsId=t);var n=l.get(e.name);n&&(e.syncedEncryptedMutations=n)}),{collectionDetails:m,localCollectionVersions:s,collectionsToUpload:u}}var p=d.errorCode,_=d.errorText,y=d.errorBackoff;throw I(p,_,y)}),k.apply(this,arguments)}function I(e,t,n){switch(e){case 400:return o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.XMPP_BAD_REQUEST_GLOBAL_ERROR),new(o("WAWebSyncdError")).SyncdFatalError(t);case 404:return o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.XMPP_NOT_FOUND_GLOBAL_ERROR),new(o("WAWebSyncdError")).SyncdFatalError(t);case 405:return o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.XMPP_BAD_METHOD_GLOBAL_ERROR),new(o("WAWebSyncdError")).SyncdFatalError(t);case 406:return o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.XMPP_NOT_ACCEPTABLE_GLOBAL_ERROR),new(o("WAWebSyncdError")).SyncdFatalError(t);default:return new(o("WAWebSyncdError")).SyncdRetryableError(t,n)}}function T(e,t){return(y||(y=n("Promise"))).all(e.map(function(e){return o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,t)}))}l.serverSync=v}),98);
__d("WAWebMessageRangeUtils",["$InternalEnum","WALogger","WALongInt","WASyncdConst","WAWebApiActiveMessageRanges","WAWebDBMessageRange","WAWebProtobufSyncAction.pb","WAWebSchemaActiveMessageRanges","WAWebSyncdCoreApi","WAWebSyncdDb","WAWebSyncdUtils","WAWebTimestampConversionUtils","WAWebWamEnumMdSyncdCriticalEventCode","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_=n("$InternalEnum").Mirrored(["RangeAEnclosesRangeB","RangeBEnclosesRangeA","RangesAreEqual","RangesNotEnclosing"]);function f(e,t){for(var n=new Set(e.messages.map(function(e){var t;return(t=e.key)==null?void 0:t.id})),r=0;r<t.messages.length;r++)if(t.messages[r].timestamp==null){var a;if(!n.has((a=t.messages[r].key)==null?void 0:a.id))return!1}for(var i=0;i<t.messages.length;i++){var l,s,u;if(!n.has((l=t.messages[i].key)==null?void 0:l.id)&&o("WALongInt").numberOrThrowIfTooLarge((s=e.lastMessageTimestamp)!=null?s:0)<=o("WALongInt").numberOrThrowIfTooLarge((u=t.messages[i].timestamp)!=null?u:0))return!1}return!0}function g(e,t){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n,r=yield(n=o("WAWebDBMessageRange")).getLastMessageTimestamp(e);n.logMaybeMillisecondTimestamp(r,"getLastMessageTimestamp");var a=yield n.getLastSystemMessageTimestamp(e);n.logMaybeMillisecondTimestamp(a,"lastSystemMessageTimestamp");var i=yield n.getAdditionalMessages(e,r),l=i.messages,u=i.newLastMessageTimestamp;if(u!=null&&(r=u,o("WAWebDBMessageRange").logMaybeMillisecondTimestamp(u,"newLastMessageTimestamp")),r==null){var c,d=l.sort(o("WAWebDBMessageRange").timestampComparison),m=(c=d[l.length-1])==null?void 0:c.timestamp;r=m!=null?o("WALongInt").numberOrThrowIfTooLarge(m):null,o("WAWebDBMessageRange").logMaybeMillisecondTimestamp(r,"sorting")}var p={messages:l};if(r!=null&&(p.lastMessageTimestamp=r),a!=null&&(r==null||a>o("WALongInt").numberOrThrowIfTooLarge(r))&&(p.lastSystemMessageTimestamp=a,o("WAWebDBMessageRange").logMaybeMillisecondTimestamp(p.lastSystemMessageTimestamp,"lastSystemMessageTimestamp")),t.forOutgoingMutation&&p.lastMessageTimestamp==null){var _=yield o("WAWebDBMessageRange").getFirstSystemMessageTimestamp(e);_!=null&&(p.lastMessageTimestamp=_,o("WAWebDBMessageRange").logMaybeMillisecondTimestamp(p.lastMessageTimestamp,"firstSystemMessageTimestamp"),_===a&&(p.lastSystemMessageTimestamp=void 0))}if(o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: constructing current message range for ","\n      ",""])),e.toString({legacy:!0}),JSON.stringify(p,null,2)),t.forOutgoingMutation&&t.mutationIndexJid!=null)for(var f of p.messages){var g;((g=f.key)==null?void 0:g.remoteJid)!=null&&(f.key.remoteJid=t.mutationIndexJid)}return p}),h.apply(this,arguments)}function y(e,t){var n=f(e,t),r=f(t,e);return n&&r?_.RangesAreEqual:n?_.RangeAEnclosesRangeB:r?_.RangeBEnclosesRangeA:_.RangesNotEnclosing}function C(e,t,n){var r=new Map,a=e.concat(t);return a.forEach(function(e){var t,a,i,l=(t=(a=e.key)==null?void 0:a.id)!=null?t:"";if(o("WALongInt").numberOrThrowIfTooLarge((i=e.timestamp)!=null?i:0)>=n){var s=r.get(l);if(s){var u,c;r.set(l,o("WALongInt").numberOrThrowIfTooLarge((u=s.timestamp)!=null?u:0)<o("WALongInt").numberOrThrowIfTooLarge((c=e.timestamp)!=null?c:0)?e:s)}else r.set(l,e)}}),Array.from(r.values())}function b(e,t){var n,r,a=o("WALongInt").numberOrThrowIfTooLarge((n=e.lastMessageTimestamp)!=null?n:0),i=o("WALongInt").numberOrThrowIfTooLarge((r=t.lastMessageTimestamp)!=null?r:0),l=Math.max(a,i),s=C(e.messages,t.messages,l),u={messages:s};if(l!==0&&(u.lastMessageTimestamp=l),e.lastSystemMessageTimestamp!=null||t.lastSystemMessageTimestamp!=null){var c,d,m=Math.max(o("WALongInt").numberOrThrowIfTooLarge((c=e.lastSystemMessageTimestamp)!=null?c:0),o("WALongInt").numberOrThrowIfTooLarge((d=t.lastSystemMessageTimestamp)!=null?d:0));(l==null||m>l)&&(u.lastSystemMessageTimestamp=m)}return u}var v=[[(p=o("WAWebWamEnumMdSyncdCriticalEventCode")).MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_LAST_SYSTEM_MESSAGE_TIMESTAMP_SET,function(e){var t=e.lastSystemMessageTimestamp,n=e.lastMessageTimestamp;return t!=null&&n!=null&&o("WALongInt").numberOrThrowIfTooLarge(t)<o("WALongInt").numberOrThrowIfTooLarge(n)}],[p.MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_MESSAGES_CROSS_LIMIT,function(e){return e.messages.filter(function(e){return e.timestamp!=null}).length>1e3}]],S=[[p.MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_MESSAGE_KEY_UNSET,function(e){return e.key==null}],[p.MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_MESSAGE_KEY_REMOTE_JID_UNSET,function(e){var t;return((t=e.key)==null?void 0:t.remoteJid)==null}],[p.MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_MESSAGE_KEY_FROM_ME_UNSET,function(e){var t;return((t=e.key)==null?void 0:t.fromMe)==null}],[p.MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_MESSAGE_KEY_STANZA_ID_UNSET,function(e){var t;return((t=e.key)==null?void 0:t.id)==null}],[p.MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_MESSAGE_KEY_REMOTE_JID_INVALID,function(e){var t;return!o("WAWebWidFactory").isWidlike((t=e.key)==null?void 0:t.remoteJid)}],[p.MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_MESSAGE_KEY_PARTICIPANT_UNSET,function(e){var t,n,o;return r("WAWebWid").isGroup((t=e.key)==null?void 0:t.remoteJid)&&((n=e.key)==null?void 0:n.fromMe)!==!0&&((o=e.key)==null?void 0:o.participant)==null}]];function R(t){if(t==null){o("WAWebSyncdUtils").uploadCriticalEventMetric(o("WAWebWamEnumMdSyncdCriticalEventCode").MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_UNSET);return}for(var n of v){var r=n[0],a=n[1];if(a(t)){o("WAWebSyncdUtils").uploadCriticalEventMetric(r);return}}if(t.messages==null)return t;for(var i of t.messages)for(var l of S){var s=l[0],u=l[1];if(u(i)){var c;o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["message_range_utils: malformed message key for id ",""])),(c=i.key)==null?void 0:c.id),o("WAWebSyncdUtils").uploadCriticalEventMetric(s);return}}return t}function L(e,t){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n,r=yield g(e,{forOutgoingMutation:!0,mutationIndexJid:t}),a=yield o("WAWebApiActiveMessageRanges").getActiveMessageRanges(e.toString());a.forEach(function(e){var t=e.actionValue.messageRange;switch(t&&(o("WAWebDBMessageRange").logMaybeMillisecondTimestamp(t.lastMessageTimestamp,"activeRanges"),o("WAWebDBMessageRange").logMaybeMillisecondTimestamp(t.lastSystemMessageTimestamp,"activeRangesSystem")),e.action){case o("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredDeleteMedia:case o("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredKeepMedia:case o("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredDeleteMedia:case o("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredKeepMedia:case o("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatDeleteMedia:case o("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatKeepMedia:{var n=e.actionValue.messageRange;n&&(r=b(r,n));break}case o("WAWebSchemaActiveMessageRanges").ActiveRangeAction.Archive:case o("WAWebSchemaActiveMessageRanges").ActiveRangeAction.MarkChatAsRead:break}}),o("WAWebDBMessageRange").logMaybeMillisecondTimestamp(r.lastMessageTimestamp,"intermediaForwardMovingRange");var i=yield k(e);return r.messages=C(r.messages,i,o("WALongInt").numberOrThrowIfTooLarge((n=r.lastMessageTimestamp)!=null?n:0)),r=o("WAWebDBMessageRange").fixMessageRange(r),o("WAWebDBMessageRange").logMaybeMillisecondTimestamp(r.lastMessageTimestamp,"forwardMovingRange"),o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: constructing forward moving message range for ","\n      ",""])),e.toString({legacy:!0}),JSON.stringify(r,null,2)),r}),E.apply(this,arguments)}function k(e){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=[],n=yield o("WAWebSyncdDb").getSyncActionsRows(["action"],[o("WASyncdConst").Actions.DeleteMessageForMe]);return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["syncd: deleteForMeSyncActions length: ",""])),n.length),n.forEach(function(n){var r=e.toString({legacy:!0}),a=JSON.parse(n.index);if(a.length!==5)o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["constructForwardMovingMessageRange: delete for me mutation index malformed ",""])),n.index);else if(r===a[1]&&n.actionState===o("WASyncdConst").SyncActionState.Success){var i,l=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,n.binarySyncData).value,s=l==null||(i=l.deleteMessageForMeAction)==null?void 0:i.messageTimestamp;if(s==null)o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["constructForwardMovingMessageRange: deleteMessageForMeAction malformed"])));else{var u={remoteJid:a[1],id:a[2],fromMe:a[3]==="1",participant:a[4]!=="0"?a[4]:void 0};t.push({key:u,timestamp:o("WAWebTimestampConversionUtils").maybeMillisecondsToSeconds(s)})}}}),t}),I.apply(this,arguments)}function T(e,t){return babelHelpers.extends({},t,{messages:t.messages.map(function(t){return babelHelpers.extends({},t,{key:babelHelpers.extends({},t.key,{remoteJid:e.toString()})})})})}var D=function(t,n,r){return o("WAWebSyncdCoreApi").lockForSync([].concat(t,["message","active-message-ranges"]),n,r)};l.MessageRangeEncloseType=_,l.constructMessageRange=g,l.compareMessageRanges=y,l.mergeMessageRanges=b,l.validateMessageRange=R,l.constructForwardMovingMessageRange=L,l.replaceMessageRangeRemoteJid=T,l.lockForMessageRangeSync=D}),98);
__d("WAWebSyncdGetChat",["WALogger","WASyncdConst","WAWebApiContact","WAWebLid1X1MigrationGating","WAWebSchemaChat","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&t.isLid()){var n,r=yield o("WAWebSchemaChat").getChatTable().equals(["accountLid"],t.toString(),{shouldDecrypt:!1});return r.length>0&&(n=r[0]),n==null?{success:!1,orphanModel:{modelId:t.toString(),modelType:o("WASyncdConst").SyncModelType.Account}}:(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: resolveChatForMutationIndex: found chat using accountLid query ",""])),t.toLogString()),{success:!0,chat:n})}var a=yield o("WAWebSchemaChat").getChatTable().get(t.toString(),!1);return a==null?{success:!1,orphanModel:{modelId:t.toString(),modelType:o("WASyncdConst").SyncModelType.Chat}}:(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: resolveChatForMutationIndex: found chat using chatId query ",""])),t.toLogString()),{success:!0,chat:a})}),m.apply(this,arguments)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!e.isRegularUser())return e.toJid();var t=yield h(e);if(t==null)throw o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: getChatJidMutationIndexForChat: chat not found}"]))).sendLogs("syncd-missing-chat-outgoing-mutation").devConsole(e.toString()),r("err")("syncd-missing-chat-outgoing-mutation");return t}),_.apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!e.isRegularUser())return e.toJid();var t=yield h(e);if(t!=null)return t;var n=o("WAWebApiContact").getCurrentLid(o("WAWebWidFactory").asUserWidOrThrow(e));return n!=null?n.toJid():e.toJid()}),g.apply(this,arguments)}function h(e){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()||e.isLid())return e.toJid();var t=yield o("WAWebSchemaChat").getChatTable().get(e.toString(),!1);if(t!=null){var n=t.accountLid;if(n==null)throw o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["syncd: getChatJidMutationIndexForChatImpl: accountLid not found in chat row}"]))).sendLogs("syncd-missing-accountLid-outgoing-mutation").devConsole(e.toString()),r("err")("syncd-missing-accountLid-outgoing-mutation");return n}}),y.apply(this,arguments)}l.resolveChatForMutationIndex=d,l.getChatJidMutationIndexForChat=p,l.getWidMutationIndexForWid=f}),98);
__d("WAWebArchiveChatSync",["Promise","WALogger","WANullthrows","WASyncdConst","WAWebApiActiveMessageRanges","WAWebChatDbUpdatesApi","WAWebMessageRangeUtils","WAWebPinChatSync","WAWebProtobufSyncAction.pb","WAWebProtobufsServerSync.pb","WAWebSchemaChat","WAWebSettingsGetters","WAWebSettingsModel","WAWebSyncdAction","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf","encodeProtobuf"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C;function b(e,t){switch(t){case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesAreEqual:case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:return{actionState:o("WASyncdConst").SyncActionState.Success};case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeBEnclosesRangeA:case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:return{actionState:o("WASyncdConst").SyncActionState.Orphan,orphanModel:{modelType:o("WASyncdConst").SyncModelType.Chat,modelId:e.toString()}}}}var v=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.chatJidIndex=1,e.collectionName=o("WASyncdConst").CollectionName.RegularLow,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.getMessageRange=function(t){var e;return(e=t.archiveChatAction)==null?void 0:e.messageRange},i.getVersion=function(){return 3},i.getAction=function(){return o("WASyncdConst").Actions.Archive},i.validateSyncActionValue=function(t){var e=t.archiveChatAction,n=e==null?void 0:e.archived,r=this.getMessageRange(t);return!o("WAWebMessageRangeUtils").validateMessageRange(r)||n==null||r==null?null:{archived:n,messageRange:r}},i.applyMutations=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=this,i=[],l=yield(C||(C=n("Promise"))).all(t.map((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){try{if(t.operation==="set"){var n=t.indexParts,l=t.value,u=n[1];if(!u||!r("WAWebWid").isWid(u))return o("WAWebSyncdIndexUtils").malformedActionIndex(a.collectionName);var c=yield o("WAWebSyncdGetChat").resolveChatForMutationIndex(o("WAWebWidFactory").createWid(u));if(!c.success)return{actionState:o("WASyncdConst").SyncActionState.Orphan,orphanModel:c.orphanModel};var d=c.chat.id,m=a.validateSyncActionValue(l);if(m==null)return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[syncd][archive-chat]: malformed mutation"]))),o("WAWebSyncdIndexUtils").malformedActionValue(a.collectionName);var p=m.archived,_=m.messageRange,f=o("WAWebWidFactory").createWid(d);yield a.$ArchiveChatSync$p_1(f,"before apply");var g=yield a.$ArchiveChatSync$p_2(f,p,_,l);return g.updates&&(i.push(g.updates),yield a.$ArchiveChatSync$p_1(f,"after push")),g.syncApplyActionResult}return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[syncd][archive-chat]: REMOVE operation not supported"]))),{actionState:o("WASyncdConst").SyncActionState.Unsupported}}catch(e){return{actionState:o("WASyncdConst").SyncActionState.Failed}}});return function(e){return t.apply(this,arguments)}})()));return i.length>0&&(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[syncd] before archive use case will update chat table"]))),yield o("WAWebChatDbUpdatesApi").setArchive(i),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[syncd] after archive use case updated chat table"])))),l});function a(e){return t.apply(this,arguments)}return a})(),i.$ArchiveChatSync$p_1=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){try{if(!e.isRegularUser())return;var n=yield o("WAWebSchemaChat").getChatTable().get(e.toString());n==null&&o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[syncd][archive-chat]: chat expected to exist ",". context: ",""])),e.toLogString(),t),(n==null?void 0:n.accountLid)==null&&o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[syncd][archive-chat]: chat expected to have accountLid ",". ",""])),e.toLogString(),t)}catch(e){o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[syncd][archive-chat]: error validating chat exists ",""])),e)}});function t(t,n){return e.apply(this,arguments)}return t})(),i.$ArchiveChatSync$p_2=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a){if(yield o("WAWebApiActiveMessageRanges").removeActiveMessageRange(e.toString(),o("WAWebApiActiveMessageRanges").getActiveRangeAction("archive")),!t)return o("WALogger").DEV(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[syncd][archive-chat]: archive-",", chatId-",""])),t,e.toString()),{updates:{id:e.toString(),archive:t},syncApplyActionResult:{actionState:o("WASyncdConst").SyncActionState.Success}};var i=yield o("WAWebMessageRangeUtils").constructMessageRange(e,{forOutgoingMutation:!1}),l=o("WAWebMessageRangeUtils").compareMessageRanges(i,n),s=o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionValueSpec,a).readBuffer(),u=function(){return o("WAWebApiActiveMessageRanges").addActiveMessageRange(e.toString(),o("WAWebApiActiveMessageRanges").getActiveRangeAction("archive"),s)},c=o("WAWebSettingsGetters").getShowArchiveV2(r("WAWebSettingsModel"));switch(o("WALogger").DEV(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[syncd][archive-chat]: shouldKeepChatsArchived-",""])),c),o("WALogger").DEV(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[syncd][archive-chat]: archive-",", rangeEnclosedType-",", chatId-",""])),t,l,e.toLogString()),l){case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesAreEqual:case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeBEnclosesRangeA:return yield u(),{updates:{id:e.toString(),archive:t},syncApplyActionResult:b(e,l)};case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:return c?{updates:{id:e.toString(),archive:t},syncApplyActionResult:b(e,l)}:(yield u(),{updates:void 0,syncApplyActionResult:b(e,l)})}});function t(t,n,r,o){return e.apply(this,arguments)}return t})(),i.getArchiveChatMutation=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield o("WAWebSyncdGetChat").getChatJidMutationIndexForChat(n),a={archiveChatAction:{archived:t,messageRange:yield o("WAWebMessageRangeUtils").constructMessageRange(n,{forOutgoingMutation:!0,mutationIndexJid:r})}};return o("WAWebSyncdActionUtils").buildPendingMutation({collection:this.collectionName,indexArgs:[r],value:a,version:this.getVersion(),operation:o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET,timestamp:e,action:this.getAction()})});function t(t,n,r){return e.apply(this,arguments)}return t})(),i.getMutationsForArchive=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){var a=[this.getArchiveChatMutation(e,t,r)];return t&&a.push(o("WAWebPinChatSync").PinChatSync.getPinMutation(e,!1,r)),(C||(C=n("Promise"))).all(a)});function t(t,n,r){return e.apply(this,arguments)}return t})(),i.resolveConflicts=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var a=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionValueSpec,e.binarySyncAction),i=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,t.binarySyncData).value,l=e.timestamp,s=t.timestamp,u=r("WANullthrows")(a.archiveChatAction),c=r("WANullthrows")(i==null?void 0:i.archiveChatAction),d=o("WAWebMessageRangeUtils").compareMessageRanges(r("WANullthrows")(c.messageRange),r("WANullthrows")(u.messageRange));switch(d){case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:return o("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal;case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeBEnclosesRangeA:return o("WASyncdConst").ConflictResolutionState.SkipRemote;case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesAreEqual:return l<=s?o("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal:o("WASyncdConst").ConflictResolutionState.SkipRemote;case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:{var m,p,_=l<=s?(m=c.archived)!=null?m:!1:(p=u.archived)!=null?p:!1,f=o("WAWebMessageRangeUtils").mergeMessageRanges(r("WANullthrows")(c.messageRange),r("WANullthrows")(u.messageRange)),g={archived:_,messageRange:f},C=o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionValueSpec,babelHelpers.extends({},i,{archiveChatAction:g})).readBuffer(),b=babelHelpers.extends({},e,{binarySyncAction:C});return delete b.id,yield o("WAWebMessageRangeUtils").lockForMessageRangeSync(["chat"],[b],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=JSON.parse(e.index),n=o("WAWebWidFactory").createWid(t[1]);o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[syncd] before update chat table due to conflict"]))),yield o("WAWebApiActiveMessageRanges").addActiveMessageRange(n.toString(),o("WAWebApiActiveMessageRanges").getActiveRangeAction("archive"),C);var r=yield o("WAWebChatDbUpdatesApi").setArchive([{id:n.toString(),archive:_}]);return o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[syncd] after update chat table due to conflict"]))),r})),o("WASyncdConst").ConflictResolutionState.SkipRemoteAndDropLocal}}});function t(t,n){return e.apply(this,arguments)}return t})(),a})(o("WAWebSyncdAction").ChatMessageRangeSyncdActionBase),S=new v;l.default=S}),98);
__d("WAWebBotWelcomeRequestSync",["Promise","WALogger","WASyncdConst","WATimeUtils","WAWebChatCollection","WAWebDBUpdateChatTable","WAWebProtobufsServerSync.pb","WAWebSyncdAction","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m=(function(t){function r(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.chatJidIndex=1,e.collectionName=o("WASyncdConst").CollectionName.RegularLow,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(r,t);var a=r.prototype;return a.getVersion=function(){return 2},a.getAction=function(){return o("WASyncdConst").Actions.BotWelcomeRequest},a.applyMutations=function(r){var t=this;return(d||(d=n("Promise"))).all(r.map((function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){try{switch(n.operation){case"set":{var r,a=n.indexParts,i=n.value,l=a[1];if(!l)return o("WAWebSyncdIndexUtils").malformedActionIndex(t.collectionName);var c=(r=i.botWelcomeRequestAction)==null?void 0:r.isSent;if(c==null)return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[BotWelcomeRequestSync]: malformed mutation. isSent is not of boolean type"]))),o("WAWebSyncdIndexUtils").malformedActionValue(t.collectionName);var d=yield o("WAWebSyncdGetChat").resolveChatForMutationIndex(o("WAWebWidFactory").createWid(l));if(!d.success)return{actionState:o("WASyncdConst").SyncActionState.Orphan,orphanModel:d.orphanModel};var m=o("WAWebWidFactory").createWid(d.chat.id);yield o("WAWebDBUpdateChatTable").updateChatTable(m,{hasRequestedWelcomeMsg:c});var p=o("WAWebChatCollection").ChatCollection.get(m);return p!=null&&(p.hasRequestedWelcomeMsg=c),o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[BotWelcomeRequestSync]: set bot welcome request to "," for ",""])),c,m),{actionState:o("WASyncdConst").SyncActionState.Success}}default:return o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[BotWelcomeRequestSync] operation not supported"]))),{actionState:o("WASyncdConst").SyncActionState.Unsupported}}}catch(e){return{actionState:o("WASyncdConst").SyncActionState.Failed}}});return function(e){return r.apply(this,arguments)}})()))},a.getBotWelcomeRequestSetMutation=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n={botWelcomeRequestAction:{isSent:t}},r=o("WAWebSyncdActionUtils").buildPendingMutation({collection:this.collectionName,indexArgs:[yield o("WAWebSyncdGetChat").getChatJidMutationIndexForChat(e)],value:n,version:this.getVersion(),operation:o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET,timestamp:o("WATimeUtils").unixTime(),action:this.getAction()});return o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[BotWelcomeRequestSync] mutation generated, set bot welcome request to "," for ",""])),t,e).devConsole(r),r});function t(t,n){return e.apply(this,arguments)}return t})(),r})(o("WAWebSyncdAction").ChatSyncdActionBase),p=new m;l.default=p}),98);
__d("WAWebChatAssignmentOpenedStatusSync",["Promise","WALogger","WASyncdConst","WATimeUtils","WAWebBizChatAssignmentOpenedAction","WAWebChatAssignmentCollection","WAWebProtobufsServerSync.pb","WAWebSyncdAction","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=(function(t){function r(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.chatJidIndex=1,e.collectionName=o("WASyncdConst").CollectionName.Regular,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(r,t);var a=r.prototype;return a.getVersion=function(){return o("WASyncdConst").CHAT_ASSIGNMENT_SYNC_VERSION},a.getAction=function(){return o("WASyncdConst").Actions.ChatAssignmentOpenedStatus},a.createChatOpenedMutations=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this,r=o("WATimeUtils").unixTimeMs(),a=yield(c||(c=n("Promise"))).all(e.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n=e.chatId,a=e.agentId,i=e.chatOpenedByAgent,l={chatAssignmentOpenedStatus:{chatOpened:i}};return o("WAWebSyncdActionUtils").buildPendingMutation({timestamp:r,collection:t.collectionName,operation:o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET,indexArgs:[yield o("WAWebSyncdGetChat").getChatJidMutationIndexForChat(o("WAWebWidFactory").createWid(n)),a],value:l,action:o("WASyncdConst").Actions.ChatAssignmentOpenedStatus,version:o("WASyncdConst").CHAT_ASSIGNMENT_SYNC_VERSION})});return function(t){return e.apply(this,arguments)}})()));return a});function t(t){return e.apply(this,arguments)}return t})(),a.applyMutations=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=this,a=[],i=yield(c||(c=n("Promise"))).all(t.map((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){try{var n=t.indexParts,i=n[1],l=n[2];if(i==null||l==null)return o("WAWebSyncdIndexUtils").malformedActionIndex(r.collectionName);if(t.operation==="set"){var c=yield o("WAWebSyncdGetChat").resolveChatForMutationIndex(o("WAWebWidFactory").createWid(i));if(!c.success)return{actionState:o("WASyncdConst").SyncActionState.Orphan,orphanModel:c.orphanModel};var d=o("WAWebWidFactory").createWid(c.chat.id),m=t.value.chatAssignmentOpenedStatus;if(!m)return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["chat_assignment_opened_status:syncd: malformed mutation"]))),o("WAWebSyncdIndexUtils").malformedActionValue(r.collectionName);var p=m.chatOpened;if(p==null)return o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["chat_assignment_opened_status:syncd: malformed mutation"]))),o("WAWebSyncdIndexUtils").malformedActionValue(r.collectionName);var _=d.toJid()+"_"+l,f=o("WAWebChatAssignmentCollection").ChatAssignmentCollection.get(_);return f==null?{actionState:o("WASyncdConst").SyncActionState.Orphan,orphanModel:{modelId:_,modelType:o("WASyncdConst").SyncModelType.ChatAssignment}}:(a.push({id:_,chatId:d.toJid(),agentId:l,chatOpenedByAgent:p}),{actionState:o("WASyncdConst").SyncActionState.Success})}return o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["chat_assignment_opened_status:syncd: operation not supported"]))),{actionState:o("WASyncdConst").SyncActionState.Unsupported}}catch(e){return{actionState:o("WASyncdConst").SyncActionState.Failed}}});return function(e){return t.apply(this,arguments)}})()));return yield o("WAWebBizChatAssignmentOpenedAction").updateLocalOpenedState(a),i});function r(e){return t.apply(this,arguments)}return r})(),r})(o("WAWebSyncdAction").ChatSyncdActionBase),m=new d;l.default=m}),98);
__d("WAWebChatAssignmentSync",["Promise","WALogger","WASyncdConst","WATimeUtils","WAWebAgentCollection","WAWebBizChatAssignmentAction","WAWebChatAssignmentCollection","WAWebProtobufsServerSync.pb","WAWebSchemaChatAssignment","WAWebSyncBootstrap","WAWebSyncdAction","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebSyncdOrphan","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.chatJidIndex=1,e.collectionName=o("WASyncdConst").CollectionName.Regular,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.getVersion=function(){return o("WASyncdConst").CHAT_ASSIGNMENT_SYNC_VERSION},i.getAction=function(){return o("WASyncdConst").Actions.ChatAssignment},i.createChatAssignmentMutations=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this,r=o("WATimeUtils").unixTimeMs(),a=yield(u||(u=n("Promise"))).all(e.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n=e.chatId,a=e.agentId,i={chatAssignment:{deviceAgentID:a}};return o("WAWebSyncdActionUtils").buildPendingMutation({timestamp:r,collection:t.collectionName,operation:o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET,indexArgs:[yield o("WAWebSyncdGetChat").getChatJidMutationIndexForChat(o("WAWebWidFactory").createWid(n))],value:i,action:o("WASyncdConst").Actions.ChatAssignment,version:o("WASyncdConst").CHAT_ASSIGNMENT_SYNC_VERSION})});return function(t){return e.apply(this,arguments)}})()));return a});function t(t){return e.apply(this,arguments)}return t})(),i.applyMutations=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=this,i=[],l=[],c=[],d=yield(u||(u=n("Promise"))).all(t.map((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){try{var n=t.indexParts,u=n[1];if(!u)return o("WAWebSyncdIndexUtils").malformedActionIndex(a.collectionName);if(t.operation==="set"){var d,m=t.value.chatAssignment;if(!m)return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["chat_assignment:syncd: malformed mutation"]))),o("WAWebSyncdIndexUtils").malformedActionValue(a.collectionName);var p=(d=m.deviceAgentID)!=null?d:"",_=o("WAWebAgentCollection").AgentCollection.get(p);if(p!==""&&_==null)return{actionState:o("WASyncdConst").SyncActionState.Orphan,orphanModel:{modelId:p,modelType:o("WASyncdConst").SyncModelType.Agent}};var f=yield o("WAWebSyncdGetChat").resolveChatForMutationIndex(o("WAWebWidFactory").createWid(u));if(!f.success)return{actionState:o("WASyncdConst").SyncActionState.Orphan,orphanModel:f.orphanModel};var g=o("WAWebWidFactory").createWid(f.chat.id);return o("WAWebChatAssignmentCollection").ChatAssignmentCollection.getAgentCollectionForChatId(g).filter(function(e){return e.id!==p}).forEach(function(e){return l.push(g.toJid()+"_"+e.id)}),p!==""&&i.push({id:g.toJid()+"_"+p,chatId:g.toJid(),agentId:p,chatOpenedByAgent:!1}),r("WAWebSyncBootstrap").isSyncDBootstrapInProcess()||c.push({chatId:g,agent:_,timestamp:Math.floor(t.timestamp/1e3)}),{actionState:o("WASyncdConst").SyncActionState.Success}}return o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["chat_assignment:syncd: operation not supported"]))),{actionState:o("WASyncdConst").SyncActionState.Unsupported}}catch(e){return{actionState:o("WASyncdConst").SyncActionState.Failed}}});return function(e){return t.apply(this,arguments)}})()));yield o("WAWebSchemaChatAssignment").getChatAssignmentTable().bulkCreateOrMerge(i),o("WAWebChatAssignmentCollection").ChatAssignmentCollection.processChatAssignments(i),yield o("WAWebSchemaChatAssignment").getChatAssignmentTable().bulkRemove(l),o("WAWebChatAssignmentCollection").ChatAssignmentCollection.remove(l),o("WAWebBizChatAssignmentAction").createChatAssignmentSystemMsgs(c),o("WAWebBizChatAssignmentAction").triggerChatAssignmentNotification(i,t.map(function(e){return e.timestamp}).join("-"));var m=i.map(function(e){return e.id.toString()});return o("WAWebSyncdOrphan").checkOrphanChatAssignments(m),d});function a(e){return t.apply(this,arguments)}return a})(),a})(o("WAWebSyncdAction").ChatSyncdActionBase),d=new c;l.default=d}),98);
__d("WAWebDeleteChatSync",["Promise","WALogger","WANullthrows","WASyncdConst","WAWebAndroidUnsupportedActionsSync","WAWebApiActiveMessageRanges","WAWebBackendApi","WAWebBizCoexGatingUtils","WAWebBizCoexUtils","WAWebChatCollection","WAWebChatDeleteBridge","WAWebDBMessageRange","WAWebDBQueryAndRemoveMessageHistory","WAWebMdSyncdDogfoodingFeatureUsageWamEvent","WAWebMessageRangeUtils","WAWebNonMessageDataRequestHistorySyncOnDemandUtils","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebProtobufSyncAction.pb","WAWebProtobufsServerSync.pb","WAWebSyncdAction","WAWebSyncdActionUtils","WAWebSyncdDb","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebWamEnumMdFeatureCode","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf","encodeProtobuf","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.collectionName=o("WASyncdConst").CollectionName.RegularHigh,e.chatJidIndex=1,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.getMessageRange=function(t){var e;return(e=t.deleteChatAction)==null?void 0:e.messageRange},i.getVersion=function(){return 6},i.getAction=function(){return o("WASyncdConst").Actions.DeleteChat},i.applyMutations=function(a){var t=this;return r("WAWebAndroidUnsupportedActionsSync").updatePrimaryAllowsAllMutationsFlag("other mutation"),(_||(_=n("Promise"))).all(a.map((function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){try{if(n.operation==="set"){var a=n.indexParts,i=n.value,l=a[1],u=a[2];if(!l||!u||!r("WAWebWid").isWid(l))return o("WAWebSyncdIndexUtils").malformedActionIndex(t.collectionName);var c=o("WAWebMessageRangeUtils").validateMessageRange(t.getMessageRange(i));if(c==null)return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[syncd][delete-chat]: malformed mutation"]))),o("WAWebSyncdIndexUtils").malformedActionValue(t.collectionName);var d=yield o("WAWebSyncdGetChat").resolveChatForMutationIndex(o("WAWebWidFactory").createWid(l));if(!d.success)return{actionState:o("WASyncdConst").SyncActionState.Orphan,orphanModel:d.orphanModel};var m=o("WAWebWidFactory").createWid(d.chat.id),p=o("WAWebMessageRangeUtils").replaceMessageRangeRemoteJid(m,c);return t.$DeleteChatSync$p_1(m,p,u==="0",i)}return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[syncd][delete-chat]: REMOVE operation not supported"]))),{actionState:o("WASyncdConst").SyncActionState.Unsupported}}catch(e){return{actionState:o("WASyncdConst").SyncActionState.Failed}}});return function(e){return a.apply(this,arguments)}})()))},i.deleteChat=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(o("WAWebBizCoexUtils").deleteChatFromFallbackHostedAdvSystemMsgOnPlaceholderCache(e),o("WAWebBizCoexUtils").clearDedupInitialHostedSystemMsgCache());var n=o("WAWebChatCollection").ChatCollection.get(e);if(t){var r=yield o("WAWebDBQueryAndRemoveMessageHistory").queryAndRemoveMessagesInMessageRange(e,t,{forceDeleteAllMessagesExceptInitialEncryption:!0});r.length>0&&(o("WAWebBackendApi").frontendFireAndForget("deleteModelsForLastAddOnPreview",{messagesIds:r}),yield o("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(o("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(e.toString(),r))),n&&n.deleteMessages(r)}else o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[syncd] before use case will update chat table ",""])),e.toLogString()),yield o("WAWebChatDeleteBridge").deleteFromStorage(e),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[syncd] after use case updated chat table ",""])),e.toLogString()),n&&n.delete();n&&o("WAWebBackendApi").frontendFireAndForget("deleteAiThreadsForChat",{chat:n}),o("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").deleteChatFromInitialSyncBoundary(e)});function t(t,n){return e.apply(this,arguments)}return t})(),i.$DeleteChatSync$p_1=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionValueSpec,r).readBuffer();yield o("WAWebApiActiveMessageRanges").addActiveMessageRange(e.toString(),o("WAWebApiActiveMessageRanges").getActiveRangeAction("deleteChat",{deleteMedia:n}),a);var i=yield o("WAWebMessageRangeUtils").constructMessageRange(e,{forOutgoingMutation:!1}),l=o("WAWebMessageRangeUtils").compareMessageRanges(i,t);switch(o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[syncd][delete-chat]: rangeEnclosedType-"," chatId-",""])),l,e.toString()),l){case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:yield this.deleteChat(e,t);break;default:yield this.deleteChat(e);break}return{actionState:o("WASyncdConst").SyncActionState.Success}});function t(t,n,r,o){return e.apply(this,arguments)}return t})(),i.getDeleteChatMutation=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){r("gkx")("26258")||new(o("WAWebMdSyncdDogfoodingFeatureUsageWamEvent")).MdSyncdDogfoodingFeatureUsageWamEvent({mdSyncdDogfoodingFeature:o("WAWebWamEnumMdFeatureCode").MD_FEATURE_CODE.DELETE_MUTATION}).commit();var a=yield o("WAWebSyncdGetChat").getChatJidMutationIndexForChat(t),i=o("WAWebWidFactory").createWid(a),l=yield o("WAWebMessageRangeUtils").constructForwardMovingMessageRange(t,a),s=o("WAWebSyncdActionUtils").buildIndex(this.getAction(),this.buildDeleteChatIndexArgs(o("WAWebWidFactory").createWid(a),n||!1)),u=yield o("WAWebSyncdDb").getPendingMutationsRowsByIndex(["index"],s);if(u.length){var c,d=u.reduce(function(e,t){return e.timestamp>t.timestamp?e:t}),m=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionValueSpec,d.binarySyncAction),p=(c=m.deleteChatAction)==null?void 0:c.messageRange;p&&(l=o("WAWebMessageRangeUtils").mergeMessageRanges(l,p),o("WAWebDBMessageRange").logMaybeMillisecondTimestamp(l.lastMessageTimestamp,"pendingMutationRange"))}return this.buildDeleteChatMutation({timestamp:e,indexWid:i,mergedRange:l,deleteMediaFiles:n||!1})});function t(t,n,r){return e.apply(this,arguments)}return t})(),i.resolveConflicts=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var a=this,i=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionValueSpec,e.binarySyncAction),l=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,t.binarySyncData).value,s=e.timestamp,u=t.timestamp,c=r("WANullthrows")(i.deleteChatAction),d=r("WANullthrows")(l==null?void 0:l.deleteChatAction),_=o("WAWebMessageRangeUtils").compareMessageRanges(r("WANullthrows")(d.messageRange),r("WANullthrows")(c.messageRange));switch(_){case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:return o("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal;case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeBEnclosesRangeA:return o("WASyncdConst").ConflictResolutionState.SkipRemote;case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesAreEqual:return s<=u?o("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal:o("WASyncdConst").ConflictResolutionState.SkipRemote;case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:{var f=o("WAWebMessageRangeUtils").mergeMessageRanges(r("WANullthrows")(d.messageRange),r("WANullthrows")(c.messageRange)),g={messageRange:f},h=o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionValueSpec,babelHelpers.extends({},l,{deleteChatAction:g})).readBuffer(),y=babelHelpers.extends({},e,{binarySyncAction:h});return delete y.id,yield o("WAWebMessageRangeUtils").lockForMessageRangeSync(["message-association","chat"],[y],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=JSON.parse(e.index),n=o("WAWebWidFactory").createWid(t[1]);o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[syncd] before update chat table due to conflict"]))),yield o("WAWebApiActiveMessageRanges").addActiveMessageRange(n.toString(),o("WAWebApiActiveMessageRanges").getActiveRangeAction("deleteChat",{deleteMedia:t[2]==="1"}),h);var r=yield a.deleteChat(n,f);return o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[syncd] after update chat table due to conflict"]))),r})),o("WASyncdConst").ConflictResolutionState.SkipRemoteAndDropLocal}}});function t(t,n){return e.apply(this,arguments)}return t})(),i.buildDeleteChatMutation=function(t){var e=t.timestamp,n=t.indexWid,r=t.mergedRange,a=t.deleteMediaFiles,i={deleteChatAction:{messageRange:r}};return o("WAWebSyncdActionUtils").buildPendingMutation({collection:this.collectionName,indexArgs:this.buildDeleteChatIndexArgs(n,a),value:i,version:this.getVersion(),operation:o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET,timestamp:e,action:this.getAction()})},i.buildDeleteChatIndexArgs=function(t,n){return[t.toJid(),n?"1":"0"]},a})(o("WAWebSyncdAction").ChatMessageRangeSyncdActionBase),g=new f;l.default=g}),98);
__d("WAWebDBFavoriteDatabaseApi",["WAWebLidMigrationDbUtils","WAWebSchemaFavorite","WAWebUserPrefsFavoritesLidMigration","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebUserPrefsFavoritesLidMigration").isFavoritesMigrationComplete()?yield C(e):e;yield o("WAWebSchemaFavorite").getFavoriteTable().bulkCreateOrReplace(t)}),s.apply(this,arguments)}function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebUserPrefsFavoritesLidMigration").isFavoritesMigrationComplete()?yield C(e):e;yield o("WAWebSchemaFavorite").getFavoriteTable().clear(),yield o("WAWebSchemaFavorite").getFavoriteTable().bulkCreateOrReplace(t)}),c.apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebUserPrefsFavoritesLidMigration").isFavoritesMigrationComplete()?[].concat(yield h(e),e):e;yield o("WAWebSchemaFavorite").getFavoriteTable().bulkRemove(t)}),m.apply(this,arguments)}function p(){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebSchemaFavorite").getFavoriteTable().all();if(e.length===0)return 0;var t=Math.max.apply(Math,e.map(function(e){var t=e.orderIndex;return t}));return t+1}),_.apply(this,arguments)}function f(){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebSchemaFavorite").getFavoriteTable().all();return o("WAWebUserPrefsFavoritesLidMigration").isFavoritesMigrationComplete()?v(e):e}),g.apply(this,arguments)}function h(e){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebLidMigrationDbUtils").findAccountLidsForPnChatIds(e);return e.map(function(e){var n;return(n=t.get(e))!=null?n:e})}),y.apply(this,arguments)}function C(e){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebLidMigrationDbUtils").findAccountLidsForPnChatIds(e.map(function(e){return e.id}));return e.map(function(e){var n;return babelHelpers.extends({},e,{id:(n=t.get(e.id))!=null?n:e.id})})}),b.apply(this,arguments)}function v(e){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebLidMigrationDbUtils").findChatIdsForAccountLids(e.map(function(e){return e.id}));return e.map(function(e){var n;return babelHelpers.extends({},e,{id:(n=t.get(e.id))!=null?n:e.id})})}),S.apply(this,arguments)}l.addOrEditFavorites=e,l.setFavorites=u,l.removeFavorites=d,l.getNextFavoriteOrderIndex=p,l.getAllFavorites=f}),98);
__d("WAWebFavoritesSync",["Promise","WALogger","WASyncdConst","WAWebApiContact","WAWebDBFavoriteDatabaseApi","WAWebFavoriteCollection","WAWebLid1X1MigrationGating","WAWebProtobufsServerSync.pb","WAWebSyncdAction","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=(function(t){function r(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.collectionName=o("WASyncdConst").CollectionName.RegularHigh,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(r,t);var a=r.prototype;return a.getVersion=function(){return 1},a.getAction=function(){return o("WASyncdConst").Actions.Favorites},a.applyMutations=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=this,a,i,l=t.map(function(t){var n;return t.operation!=="set"?(o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["favorites sync: operation not supported"]))),o("WAWebSyncdIndexUtils").malformedActionValue(r.collectionName)):((n=t.value.favoritesAction)==null?void 0:n.favorites)==null?(o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["favorites sync: malformed mutation"]))),o("WAWebSyncdIndexUtils").malformedActionValue(r.collectionName)):((i==null||t.timestamp>i.timestamp)&&(i=t),{actionState:o("WASyncdConst").SyncActionState.Success})}),d=(a=i)==null||(a=a.value.favoritesAction)==null?void 0:a.favorites;if(d!=null){var m=0,p=d.reduce(function(e,t){var n=t.id;return n!=null&&e.push({id:n,orderIndex:m++}),e},[]),_=0,f=yield(c||(c=n("Promise"))).all(p.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebSyncdGetChat").resolveChatForMutationIndex(o("WAWebWidFactory").createWid(e.id));if(t.success===!0)return _++,{orderIndex:e.orderIndex,id:t.chat.id};t.success;var n=o("WAWebWidFactory").createWid(e.id);if(o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&n.isLid()){var r=o("WAWebApiContact").getPhoneNumber(n);if(r!=null)return{orderIndex:e.orderIndex,id:r.toString()}}return{orderIndex:e.orderIndex,id:e.id}});return function(t){return e.apply(this,arguments)}})()));yield o("WAWebDBFavoriteDatabaseApi").setFavorites(f),o("WAWebFavoriteCollection").FavoriteCollection.set(f.map(function(e){return{id:e.id,orderIndex:e.orderIndex}})),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Favorites sync: successfully set favorites. Resolved chats: "," of total ",""])),_,f.length).devConsole(f)}return l});function r(e){return t.apply(this,arguments)}return r})(),a.getFavoritesMutation=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var r=e.map(function(e){return{orderIndex:e.orderIndex,wid:o("WAWebWidFactory").createWid(e.id)}}),a=yield(c||(c=n("Promise"))).all(r.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return babelHelpers.extends({},e,{mutationIndex:yield o("WAWebSyncdGetChat").getWidMutationIndexForWid(e.wid)})});return function(t){return e.apply(this,arguments)}})()));return o("WAWebSyncdActionUtils").buildPendingMutation({collection:this.collectionName,indexArgs:[],operation:o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET,version:this.getVersion(),timestamp:t,action:this.getAction(),value:{favoritesAction:{favorites:a.sort(function(e,t){return e.orderIndex-t.orderIndex}).map(function(e){var t=e.mutationIndex;return{id:t}})}}})});function t(t,n){return e.apply(this,arguments)}return t})(),r})(o("WAWebSyncdAction").AccountSyncdActionBase),m=new d;l.default=m}),98);
__d("WAWebListItemParentType",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["Chat","Contact","Msg"]);i.LabelItemParentType=e}),66);
__d("WAWebLabelJidSync",["Promise","WALogger","WASyncdConst","WATimeUtils","WAWebApiContact","WAWebBizGatingUtils","WAWebBizLabelUtils","WAWebCTWAConstants","WAWebContactSystemMsg","WAWebDBLabelAssociationDatabaseApi","WAWebHandleSingleMsg","WAWebLid1X1MigrationGating","WAWebListItemParentType","WAWebMsgType","WAWebProtobufsServerSync.pb","WAWebSchemaChat","WAWebSchemaLabel","WAWebSchemaLabelAssociation","WAWebSyncdAction","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebUserPrefsGeneral","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.chatJidIndex=2,e.collectionName=o("WASyncdConst").CollectionName.Regular,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.getVersion=function(){return o("WASyncdConst").LABEL_ASSOCIATION_SYNC_VERSION},i.getAction=function(){return o("WASyncdConst").Actions.LabelJid},i.applyMutations=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=this,i=new Set,l=[],c=[],d=yield(u||(u=n("Promise"))).all(t.map((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){try{if(t.operation==="set"){var n,u=t.indexParts,d=t.value,m=u[1],p=u[2];if(!m||!p)return o("WAWebSyncdIndexUtils").malformedActionIndex(a.collectionName);var _=(n=d.labelAssociationAction)==null?void 0:n.labeled;if(_==null)return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["label jid sync: malformed mutation"]))),o("WAWebSyncdIndexUtils").malformedActionValue(a.collectionName);if(!r("WAWebWid").isWid(p))return o("WAWebSyncdIndexUtils").malformedActionIndex(a.collectionName);var f=o("WAWebWidFactory").createWid(p),g=yield o("WAWebSyncdGetChat").resolveChatForMutationIndex(f);if(g.success===!0)f=o("WAWebWidFactory").createWid(g.chat.id);else if(g.success,o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&f.isLid()){var h=o("WAWebApiContact").getPhoneNumber(f);h!=null&&(f=h)}var y=f.toString(),C={labelId:m,associationId:y,type:o("WAWebSchemaLabelAssociation").LabelAssociationType.Jid};if(_){var b=i.has(y);if(!b){var v=yield o("WAWebSchemaChat").getChatTable().get(y,!1);v&&(i.add(y),b=!0)}l.push(C),o("WAWebBizLabelUtils").addToLabelCollection(y,[m],b||!f.isUser()?o("WAWebListItemParentType").LabelItemParentType.Chat:o("WAWebListItemParentType").LabelItemParentType.Contact);var S=yield o("WAWebSchemaLabel").getLabelTable().get(m),R=S==null?void 0:S.predefinedId;if(o("WAWebUserPrefsGeneral").getDetectedOutcomeOnboardingStatus()&&(R===o("WAWebCTWAConstants").DETECTED_OUTCOME_NEW_ORDER_PREDEFINED_ID||R===o("WAWebCTWAConstants").DETECTED_OUTCOME_LEAD_PREDEFINED_ID)&&o("WAWebBizGatingUtils").isCTWADetectedOutcomeWS2Enabled()){var L=o("WAWebContactSystemMsg").genNotificationMsg(f,{type:"notification_template",kind:o("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"biz_automatically_labeled_chat_system_message",templateParams:[R.toString()]});yield o("WAWebHandleSingleMsg").handleSingleMsg({chatId:f,newMsg:L,handleSingleMsgOrigin:"detectedOutcomeNotification",preserveOrder:!1})}}else c.push(o("WAWebSchemaLabelAssociation").createLabelAssociationPrimaryKey(C)),o("WAWebBizLabelUtils").removeLabelFromCollection(y,m,o("WAWebListItemParentType").LabelItemParentType.Chat);return{actionState:o("WASyncdConst").SyncActionState.Success}}return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["label jid sync: unsupported operation"]))),{actionState:o("WASyncdConst").SyncActionState.Unsupported}}catch(e){return{actionState:o("WASyncdConst").SyncActionState.Failed}}});return function(e){return t.apply(this,arguments)}})()));return yield o("WAWebDBLabelAssociationDatabaseApi").removeLabelAssociations(c),yield o("WAWebDBLabelAssociationDatabaseApi").addOrEditLabelAssociations(l),d});function a(e){return t.apply(this,arguments)}return a})(),i.createLabelAssociationMutations=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var r=this,a=o("WATimeUtils").unixTimeMs(),i=[];e.forEach(function(e){var n=e.id,l=e.type;t.forEach(function(e){var t=e.labelAssociationType,s=e.mutationIndexSegments,u={labelAssociationAction:{labeled:l==="add"}},c=t===o("WAWebSchemaLabelAssociation").LabelAssociationType.Message?o("WASyncdConst").Actions.LabelMessage:o("WASyncdConst").Actions.LabelJid;i.push({timestamp:a,collection:r.collectionName,operation:o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET,indexArgs:[n].concat(s),version:o("WASyncdConst").LABEL_ASSOCIATION_SYNC_VERSION,value:u,action:c})})});var l=yield(u||(u=n("Promise"))).all(i.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e.action===o("WASyncdConst").Actions.LabelMessage)return e;var t=e.indexArgs,r=t[0],a=babelHelpers.arrayLikeToArray(t).slice(1),i=yield(u||(u=n("Promise"))).all(a.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebWidFactory").createWid(e);return o("WAWebSyncdGetChat").getWidMutationIndexForWid(t)});return function(t){return e.apply(this,arguments)}})()));return babelHelpers.extends({},e,{indexArgs:[r].concat(i)})});return function(t){return e.apply(this,arguments)}})()));return l.map(o("WAWebSyncdActionUtils").buildPendingMutation)});function t(t,n){return e.apply(this,arguments)}return t})(),a})(o("WAWebSyncdAction").ChatOrContactSyncdActionBase),d=new c;l.default=d}),98);
__d("WAWebMarkChatAsReadSync",["Promise","WALogger","WANullthrows","WASyncdConst","WAWebApiActiveMessageRanges","WAWebChatGetExistingBridge","WAWebConstantsDeprecated","WAWebMessageRangeUtils","WAWebProtobufSyncAction.pb","WAWebProtobufsServerSync.pb","WAWebSchemaChat","WAWebSyncdAction","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebUpdateUnreadChatAction","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf","encodeProtobuf"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f;function g(e,t){switch(t){case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesAreEqual:case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:return{actionState:o("WASyncdConst").SyncActionState.Success};case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeBEnclosesRangeA:case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:return{actionState:o("WASyncdConst").SyncActionState.Orphan,orphanModel:{modelType:o("WASyncdConst").SyncModelType.Chat,modelId:e.toString()}}}}var h=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.chatJidIndex=1,e.collectionName=o("WASyncdConst").CollectionName.RegularLow,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.getMessageRange=function(t){var e;return(e=t.markChatAsReadAction)==null?void 0:e.messageRange},i.getVersion=function(){return 3},i.getAction=function(){return o("WASyncdConst").Actions.MarkChatAsRead},i.$MarkChatAsReadSync$p_1=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WAWebChatGetExistingBridge").getExisting(e);n&&(t?o("WAWebUpdateUnreadChatAction").markSeen(n):o("WAWebUpdateUnreadChatAction").markUnseen(n))});function t(t,n){return e.apply(this,arguments)}return t})(),i.$MarkChatAsReadSync$p_2=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebSchemaChat").getChatTable().get(e.toString(),!1);return(t==null?void 0:t.unreadCount)===r("WAWebConstantsDeprecated").MARKED_AS_UNREAD});function t(t){return e.apply(this,arguments)}return t})(),i.validateSyncActionValue=function(t){var e=t.markChatAsReadAction,n=e==null?void 0:e.read,r=o("WAWebMessageRangeUtils").validateMessageRange(e==null?void 0:e.messageRange);return n!=null&&r!=null?{read:n,messageRange:r}:null},i.applyMutations=function(a){var t=this;return(f||(f=n("Promise"))).all(a.map((function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){try{if(n.operation==="set"){var a=n.indexParts,i=n.value,l=a[1];if(!l)return o("WAWebSyncdIndexUtils").malformedActionIndex(t.collectionName);var u=t.validateSyncActionValue(i);if(u==null)return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[syncd][mark-chat-as-read]: malformed mutation"]))),o("WAWebSyncdIndexUtils").malformedActionValue(t.collectionName);var c=u.read,d=u.messageRange;if(!r("WAWebWid").isWid(l))return o("WAWebSyncdIndexUtils").malformedActionIndex(t.collectionName);var m=yield o("WAWebSyncdGetChat").resolveChatForMutationIndex(o("WAWebWidFactory").createWid(l));return m.success?t.$MarkChatAsReadSync$p_3(o("WAWebWidFactory").createWid(m.chat.id),c,d,i):{actionState:o("WASyncdConst").SyncActionState.Orphan,orphanModel:m.orphanModel}}return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[syncd][mark-chat-as-read]: operation not supported"]))),{actionState:o("WASyncdConst").SyncActionState.Unsupported}}catch(e){return{actionState:o("WASyncdConst").SyncActionState.Failed}}});return function(e){return a.apply(this,arguments)}})()))},i.$MarkChatAsReadSync$p_3=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,a){yield o("WAWebApiActiveMessageRanges").removeActiveMessageRange(e.toString(),o("WAWebApiActiveMessageRanges").getActiveRangeAction("markChatAsRead"));var i=yield o("WAWebMessageRangeUtils").constructMessageRange(e,{forOutgoingMutation:!1}),l=o("WAWebMessageRangeUtils").compareMessageRanges(i,r),s=o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionValueSpec,a).readBuffer(),p=function(){return o("WAWebApiActiveMessageRanges").addActiveMessageRange(e.toString(),o("WAWebApiActiveMessageRanges").getActiveRangeAction("markChatAsRead"),s)};switch(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[syncd] before use case will update chat table"]))),o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[syncd][mark-chat-as-read]: read-",", rangeEnclosedType-",", chatId-",""])),t,l,e.toString()),l){case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesAreEqual:case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeBEnclosesRangeA:return yield p(),yield this.$MarkChatAsReadSync$p_1(e,t),(f||(f=n("Promise"))).resolve(g(e,l));case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:return t&&(yield this.$MarkChatAsReadSync$p_2(e))&&(o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[syncd][mark-chat-as-read]: isChatMarkedUnreadByUser-true"]))),yield this.$MarkChatAsReadSync$p_1(e,t)),(f||(f=n("Promise"))).resolve(g(e,l))}o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[syncd] after use case updated chat table"])))});function t(t,n,r,o){return e.apply(this,arguments)}return t})(),i.getMarkChatAsReadMutation=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield o("WAWebSyncdGetChat").getChatJidMutationIndexForChat(n),a={markChatAsReadAction:{read:t,messageRange:yield o("WAWebMessageRangeUtils").constructMessageRange(n,{forOutgoingMutation:!0,mutationIndexJid:r})}};return o("WAWebSyncdActionUtils").buildPendingMutation({collection:this.collectionName,indexArgs:[r],value:a,version:this.getVersion(),operation:o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET,timestamp:e,action:this.getAction()})});function t(t,n,r){return e.apply(this,arguments)}return t})(),i.resolveConflicts=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var a=this,i=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionValueSpec,e.binarySyncAction),l=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,t.binarySyncData).value,s=e.timestamp,u=t.timestamp,c=r("WANullthrows")(i.markChatAsReadAction),d=r("WANullthrows")(l==null?void 0:l.markChatAsReadAction),m=o("WAWebMessageRangeUtils").compareMessageRanges(r("WANullthrows")(d.messageRange),r("WANullthrows")(c.messageRange));switch(m){case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:return o("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal;case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeBEnclosesRangeA:return o("WASyncdConst").ConflictResolutionState.SkipRemote;case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesAreEqual:return s<=u?o("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal:o("WASyncdConst").ConflictResolutionState.SkipRemote;case o("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:{var f,g,h=s<=u?(f=d.read)!=null?f:!1:(g=c.read)!=null?g:!1,y=o("WAWebMessageRangeUtils").mergeMessageRanges(r("WANullthrows")(d.messageRange),r("WANullthrows")(c.messageRange)),C={read:h,messageRange:y},b=o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionValueSpec,babelHelpers.extends({},l,{markChatAsReadAction:C})).readBuffer(),v=babelHelpers.extends({},e,{binarySyncAction:b});return delete v.id,yield o("WAWebMessageRangeUtils").lockForMessageRangeSync(["chat"],[v],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=JSON.parse(e.index),n=o("WAWebWidFactory").createWid(t[1]);o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[syncd] before update chat table due to conflict"]))),yield o("WAWebApiActiveMessageRanges").addActiveMessageRange(n.toString(),o("WAWebApiActiveMessageRanges").getActiveRangeAction("markChatAsRead"),b);var r=yield a.$MarkChatAsReadSync$p_1(n,h);return o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[syncd] after update chat table due to conflict"]))),r})),o("WASyncdConst").ConflictResolutionState.SkipRemoteAndDropLocal}}});function t(t,n){return e.apply(this,arguments)}return t})(),a})(o("WAWebSyncdAction").ChatMessageRangeSyncdActionBase),y=new h;l.default=y}),98);
__d("WAWebMuteChatSync",["Promise","WALogger","WALongInt","WASyncdConst","WATimeUtils","WAWebMuteCollection","WAWebProtobufsServerSync.pb","WAWebSchemaChat","WAWebSyncdAction","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=-1,m=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.chatJidIndex=1,e.collectionName=o("WASyncdConst").CollectionName.RegularHigh,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.getVersion=function(){return 2},i.getAction=function(){return o("WASyncdConst").Actions.Mute},i.applyMutations=function(a){var t=this;return(c||(c=n("Promise"))).all(a.map((function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){try{if(n.operation==="set"){var a,i=n.indexParts,l=n.value,c=i[1];if(!c||!r("WAWebWid").isWid(c))return o("WAWebSyncdIndexUtils").malformedActionIndex(t.collectionName);var d=l.muteAction,m=(a=l.muteAction)==null?void 0:a.muted,p=o("WALongInt").maybeNumberOrThrowIfTooLarge(d==null?void 0:d.muteEndTimestamp);if(m==null||m&&p==null)return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["mute chat sync: malformed mutation"]))),o("WAWebSyncdIndexUtils").malformedActionValue(t.collectionName);var _=yield o("WAWebSyncdGetChat").resolveChatForMutationIndex(o("WAWebWidFactory").createWid(c));if(!_.success)return{actionState:o("WASyncdConst").SyncActionState.Orphan,orphanModel:_.orphanModel};var f=_.chat.id,g=p!=null?p:0,h=g>0&&g<o("WATimeUtils").unixTimeMs()?0:Math.floor(g/1e3);yield o("WAWebSchemaChat").getChatTable().merge(f,{muteExpiration:h});var y={id:o("WAWebWidFactory").createWid(f),expiration:h};return o("WAWebMuteCollection").MuteCollection.add(y,{merge:!0}),o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: successfully set mute for "," with expiration=",""])),f,h),{actionState:o("WASyncdConst").SyncActionState.Success}}return o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["mute chat sync: operation not supported"]))),{actionState:o("WASyncdConst").SyncActionState.Unsupported}}catch(e){return{actionState:o("WASyncdConst").SyncActionState.Failed}}});return function(e){return a.apply(this,arguments)}})()))},i.generateMuteMutation=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=t!==void 0&&t!==0,r=o("WATimeUtils").unixTimeMs(),a=t;a!==d&&(a*=1e3);var i={muted:n,muteEndTimestamp:a},l={muteAction:i};return o("WAWebSyncdActionUtils").buildPendingMutation({collection:this.collectionName,indexArgs:[yield o("WAWebSyncdGetChat").getChatJidMutationIndexForChat(e)],operation:o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET,version:this.getVersion(),value:l,timestamp:r,action:this.getAction()})});function t(t,n){return e.apply(this,arguments)}return t})(),a})(o("WAWebSyncdAction").ChatSyncdActionBase),p=new m;l.default=p}),98);
__d("WAWebPinChatSync",["$InternalEnum","Promise","WALogger","WALongInt","WANullthrows","WASyncdConst","WATimeUtils","WAWebAndroidUnsupportedActionsSync","WAWebArchiveChatSync","WAWebChatGetExistingBridge","WAWebChatPinBridge","WAWebMdSyncdDogfoodingFeatureUsageWamEvent","WAWebProtobufSyncAction.pb","WAWebProtobufsServerSync.pb","WAWebSchemaChat","WAWebSyncdAction","WAWebSyncdActionUtils","WAWebSyncdCoreApi","WAWebSyncdDb","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebWamEnumMdFeatureCode","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_=3,f=2;function g(e){switch(e){case h.Chat:return function(e){return!r("WAWebWid").isNewsletter(e)};case h.Newsletter:return function(e){return r("WAWebWid").isNewsletter(e)}}}var h=n("$InternalEnum").Mirrored(["Chat","Newsletter"]),y=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.chatJidIndex=1,e.collectionName=o("WASyncdConst").CollectionName.RegularLow,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.getVersion=function(){return 5},i.getAction=function(){return o("WASyncdConst").Actions.Pin},i.applyMutations=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){r("WAWebAndroidUnsupportedActionsSync").updatePrimaryAllowsAllMutationsFlag("other mutation");for(var t=[],n=0;n<e.length;n++)t.push(yield this.applyMutation(e[n]));return t});function t(t){return e.apply(this,arguments)}return t})(),i.applyMutation=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(t.operation==="remove")return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: pin_chat_sync: REMOVE not supported"]))),(p||(p=n("Promise"))).resolve({actionState:o("WASyncdConst").SyncActionState.Unsupported});var a=t.indexParts,i=t.value,l=t.timestamp,_=a[1];try{if(!_)return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: pin_chat_sync: missing chatJid in index"]))),o("WAWebSyncdIndexUtils").malformedActionIndex(this.collectionName);if(!r("WAWebWid").isWid(_))return o("WAWebSyncdIndexUtils").malformedActionIndex(this.collectionName);var f=i.pinAction;if(f==null)return o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: pin_chat_sync: missing pinAction"]))),o("WAWebSyncdIndexUtils").malformedActionValue(this.collectionName);var g=f.pinned;if(g==null)return o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["syncd: pin_chat_sync: missing pinned field"]))),o("WAWebSyncdIndexUtils").malformedActionValue(this.collectionName);var h=yield o("WAWebSyncdGetChat").resolveChatForMutationIndex(o("WAWebWidFactory").createWid(_));if(!h.success)return{actionState:o("WASyncdConst").SyncActionState.Orphan,orphanModel:h.orphanModel};var y=h.chat.id,C=h.chat.id,b=o("WAWebWidFactory").createWid(C);if(!g)return o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["syncd: pin_chat_sync: unpin ",""])),C),yield this.applyUpdates([{wid:b,pinned:!1,timestamp:l}]),{actionState:o("WASyncdConst").SyncActionState.Success};var v=b.isNewsletter()?yield this.getLocalNewsletterPins():yield this.getLocalChatPins();if(v.some(function(e){return e.chatId.toString()===b.toString()}))return o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: pin_chat_sync: "," already pinned, updating timestamp"])),y),yield this.applyUpdates([{wid:b,pinned:g,timestamp:l}]),{actionState:o("WASyncdConst").SyncActionState.Success};if(v.length<o("WAWebChatPinBridge").getPinLimit(b))return yield this.applyUpdates([{wid:b,pinned:g,timestamp:l}]),{actionState:o("WASyncdConst").SyncActionState.Success};r("gkx")("26258")||new(o("WAWebMdSyncdDogfoodingFeatureUsageWamEvent")).MdSyncdDogfoodingFeatureUsageWamEvent({mdSyncdDogfoodingFeature:o("WAWebWamEnumMdFeatureCode").MD_FEATURE_CODE.UNPIN_4TH_CHAT_MUTATION}).commit();var S=v.reduce(function(e,t){return t.timestamp<e.timestamp?t:e}),R=[],L=S.timestamp<l?S.chatId:b;return L===S.chatId&&R.push({wid:S.chatId,pinned:!1,timestamp:l},{wid:b,pinned:!0,timestamp:l}),yield(p||(p=n("Promise"))).all([this.applyUpdates(R),this.createPendingUnpin(L,l)]),p.resolve({actionState:o("WASyncdConst").SyncActionState.Success})}catch(e){return{actionState:o("WASyncdConst").SyncActionState.Failed}}});function a(e){return t.apply(this,arguments)}return a})(),i.applyUpdates=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e.length!==0){var t=e.map(function(e){var t=e.wid,n=e.pinned,r=e.timestamp,o={id:t.toString(),pin:n?r:0};return n&&(o.archive=!1),o});yield(p||(p=n("Promise"))).all(t.map(function(e){return o("WAWebSchemaChat").getChatTable().merge(e.id,e)})),yield p.all(e.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebChatGetExistingBridge").getExisting(e.wid);t!=null&&(t.pin=e.pinned?e.timestamp:0,e.pinned&&(t.archive=!1))});return function(t){return e.apply(this,arguments)}})()))}});function t(t){return e.apply(this,arguments)}return t})(),i.createPendingUnpin=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){yield o("WAWebSyncdDb").appendPendingMutationsRows([yield this.getPinMutation(t,!1,e)])});function t(t,n){return e.apply(this,arguments)}return t})(),i.getLocalChatPins=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return this.$PinChatSyncImpl$p_1(h.Chat)});function t(){return e.apply(this,arguments)}return t})(),i.getLocalNewsletterPins=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return this.$PinChatSyncImpl$p_1(h.Newsletter)});function t(){return e.apply(this,arguments)}return t})(),i.$PinChatSyncImpl$p_1=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebSchemaChat").getChatTable().all().then(function(e){return e.filter(function(e){return e.pin!=null&&e.pin>0}).map(function(e){return[e.id,r("WANullthrows")(e.pin)]})}),a=o("WAWebSyncdDb").getSyncActionsRows(["action"],[o("WASyncdConst").Actions.Pin]).then(function(e){return e.filter(function(e){return e.actionState===o("WASyncdConst").SyncActionState.Orphan}).map(function(e){var t,n=JSON.parse(e.index);if(n.length<2)return null;var r=n[1],a=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,e.binarySyncData).value;return(a==null?void 0:a.pinAction)==null||(a==null?void 0:a.pinAction.pinned)!==!0?null:[r,o("WALongInt").numberOrThrowIfTooLarge((t=a.timestamp)!=null?t:0)]}).filter(Boolean)}),i=yield(p||(p=n("Promise"))).all([t,a]),l=i[0],s=i[1],u=g(e);return[].concat(l,s).filter(function(e){var t=e[0];return u(t)}).map(function(e){var t=e[0],n=e[1];return{chatId:o("WAWebWidFactory").createWid(t),timestamp:n}})});function t(t){return e.apply(this,arguments)}return t})(),i.unpinAllChats=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return this.$PinChatSyncImpl$p_2(yield this.getLocalChatPins())});function t(){return e.apply(this,arguments)}return t})(),i.unpinAllNewsletters=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return this.$PinChatSyncImpl$p_2(yield this.getLocalNewsletterPins())});function t(){return e.apply(this,arguments)}return t})(),i.$PinChatSyncImpl$p_2=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this,r=o("WATimeUtils").unixTimeMs(),a=yield(p||(p=n("Promise"))).all(e.map(function(e){var n=e.chatId;return t.getPinMutation(r,!1,n)}));return o("WAWebSyncdCoreApi").lockForSync(["chat"],a,function(){return(p||(p=n("Promise"))).resolve()}).then(function(){return t.applyUpdates(e.map(function(e){var t=e.chatId;return{wid:t,pinned:!1,timestamp:r}}))})});function t(t){return e.apply(this,arguments)}return t})(),i.getMutationsForPin=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){r("gkx")("26258")||new(o("WAWebMdSyncdDogfoodingFeatureUsageWamEvent")).MdSyncdDogfoodingFeatureUsageWamEvent({mdSyncdDogfoodingFeature:o("WAWebWamEnumMdFeatureCode").MD_FEATURE_CODE.PIN_MUTATION}).commit();var a=[yield this.getPinMutation(e,t,n)];return t&&a.push(yield r("WAWebArchiveChatSync").getArchiveChatMutation(e,!1,n)),a});function t(t,n,r){return e.apply(this,arguments)}return t})(),i.getPinMutation=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r={pinAction:{pinned:t}};return o("WAWebSyncdActionUtils").buildPendingMutation({collection:this.collectionName,indexArgs:[yield o("WAWebSyncdGetChat").getChatJidMutationIndexForChat(n)],value:r,version:this.getVersion(),operation:o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET,timestamp:e,action:this.getAction()})});function t(t,n,r){return e.apply(this,arguments)}return t})(),a})(o("WAWebSyncdAction").ChatSyncdActionBase),C=new y;l.MAX_PINNED_CHATS=_,l.MAX_PINNED_NEWSLETTERS=f,l.PinChatSync=C}),98);
__d("WAWebSentinelMutationSync",["Promise","WALogger","WASyncdConst","WATagsLogger","WATimeUtils","WAWebGetSyncKey","WAWebProtobufsServerSync.pb","WAWebSyncdAction","WAWebSyncdActionUtils","WAWebSyncdIndexUtils","WAWebSyncdKeyManagement","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p=o("WATagsLogger").TAGS(["syncd","SentinelMutationSync"]),_=(function(t){function r(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.collectionName=o("WASyncdConst").CollectionName.RegularLow,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(r,t);var a=r.prototype;return a.getVersion=function(){return 3},a.getAction=function(){return o("WASyncdConst").Actions.Sentinel},a.applyMutations=function(r){var t=this;return p.LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["applying mutations..."]))),(m||(m=n("Promise"))).all(r.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){try{if(e.operation==="set"){var n,r=(n=e.value.keyExpiration)==null?void 0:n.expiredKeyEpoch;return r==null?(o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["sentinel mutation sync: malformed mutation"]))),o("WAWebSyncdIndexUtils").malformedActionValue(t.collectionName)):(yield o("WAWebGetSyncKey").expireSyncKeyInTransaction(r),{actionState:o("WASyncdConst").SyncActionState.Success})}return o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["sentinel mutation sync: operation not supported"]))),{actionState:o("WASyncdConst").SyncActionState.Unsupported}}catch(e){return{actionState:o("WASyncdConst").SyncActionState.Failed}}});return function(t){return e.apply(this,arguments)}})()))},a.getSentinelMutations=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=this;p.LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["preparing mutations..."])));var t=o("WATimeUtils").unixTimeMs(),n=Array.from(o("WASyncdConst").CollectionName.members()),r=yield o("WAWebSyncdKeyManagement").getNewestKeyPair();if(r==null)return o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["sentinel mutation sync: no key pairs"]))),[];var a=r.keyEpoch,i={keyExpiration:{expiredKeyEpoch:a}};return n.map(function(n){return o("WAWebSyncdActionUtils").buildPendingMutation({collection:n,indexArgs:[n],operation:o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET,version:e.getVersion(),value:i,timestamp:t,action:e.getAction()})})});function t(){return e.apply(this,arguments)}return t})(),r})(o("WAWebSyncdAction").AccountSyncdActionBase),f=new _;Object.freeze(f);var g=f;l.default=g}),98);
__d("WAWebSyncdResolveMessages",["Promise","WAWebABProps","WAWebSchemaMessage","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t){for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){r===void 0&&(r=50);var a=s(t,r),i=yield(e||(e=n("Promise"))).all(a.map(function(e){return o("WAWebSchemaMessage").getMessageTable().startsWithAnyOf(["id"],e)})),l=new Set;for(var u of i)for(var c of u)c&&!l.has(c.id)&&l.add(c.id);return Array.from(l)}),c.apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=new Map,i=(yield(e||(e=n("Promise"))).all(t.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.indexParts,n=t[1],i=t[2],l=t[3],s=t[4];if(!n||!i||!l||!s||!r("WAWebWid").isWid(n))return null;var u=yield o("WAWebSyncdGetChat").resolveChatForMutationIndex(o("WAWebWidFactory").createWid(n));if(u.success){var c=u.chat.id;a.set(n,c);var d=o("WAWebSyncdIndexUtils").syncKeyToMsgKey(c,i,l,s);return d!=null?o("WAWebSyncdIndexUtils").msgKeyToDbIdWithoutFromMeParticipant(d):null}});return function(t){return e.apply(this,arguments)}})()))).filter(Boolean);return{incomingRemoteToLocalChatId:a,msgKeys:i}}),m.apply(this,arguments)}function p(){return o("WAWebABProps").getABPropConfigValue("synced_message_keys_processing_type")}function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return p()==="async-chunk"?yield y(e):yield g(e)}),f.apply(this,arguments)}function g(e){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield d(e),n=t.incomingRemoteToLocalChatId,r=t.msgKeys,a=[];return yield o("WAWebSchemaMessage").getMessageTable().startsWithAnyOf(["id"],r).then(function(e){return e.forEach(function(e){e&&a.push(e.id)})}),{messagesInDB:a,incomingRemoteToLocalChatId:n}}),h.apply(this,arguments)}function y(e){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebABProps").getABPropConfigValue("message_keys_async_chunk_size"),n=yield d(e),r=n.incomingRemoteToLocalChatId,a=n.msgKeys,i=yield u(a,t);return{messagesInDB:i,incomingRemoteToLocalChatId:r}}),C.apply(this,arguments)}l.resolveMessagesForMutations=_,l.resolveMessagesForMutationsControl=g,l.resolveMessagesForMutationsHypothesisTest=y}),98);
__d("WAWebStarMessageSync",["Promise","WALogger","WANullthrows","WASyncdConst","WATimeUtils","WAWebAssociationProcessor","WAWebAssociationProcessorConstants","WAWebCurrentUser","WAWebDBProcessMessage","WAWebLid1X1MigrationGating","WAWebMessageAssociationGatingUtils","WAWebMsgCollection","WAWebMsgKey","WAWebProtobufsServerSync.pb","WAWebSchemaChat","WAWebStarredMsgCollection","WAWebSyncdAction","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebSyncdResolveMessages","WAWebSyncdUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.collectionName=o("WASyncdConst").CollectionName.RegularHigh,e.chatJidIndex=1,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.getMessageKey=function(t){var e=t[1],n=t[2],r=t[3],a=t[4];if(!(!e||!n||!r||!a))return o("WAWebSyncdIndexUtils").syncKeyToMsgKey(e,n,r,a)},i.getVersion=function(){return 2},i.getAction=function(){return o("WASyncdConst").Actions.Star},i.applyMutations=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=this,i=[],l=[];o("WAWebCurrentUser").isEmployee()&&o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: start apply star message"])));var h=yield o("WAWebSyncdResolveMessages").resolveMessagesForMutations(t),y=h.incomingRemoteToLocalChatId,C=h.messagesInDB;o("WAWebCurrentUser").isEmployee()&&o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: after gather cache for star message"])));var b=yield(g||(g=n("Promise"))).all(t.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){try{if(e.operation==="set"){var t,n=e.indexParts,s=e.value,_=n[1],f=n[2],g=n[3],h=n[4];if(!_||!f||!g||!h)return o("WAWebSyncdIndexUtils").malformedActionIndex(a.collectionName);var b=(t=s.starAction)==null?void 0:t.starred,v=y.get(_);if(b==null)return o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["star message sync: malformed mutation"]))),o("WAWebSyncdIndexUtils").malformedActionValue(a.collectionName);var S=o("WAWebSyncdIndexUtils").syncKeyToMsgKey(_,f,g,h);if(S==null)return o("WAWebSyncdIndexUtils").malformedActionIndex(a.collectionName);if(v==null){if(!o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()){var R=yield o("WAWebSchemaChat").getChatTable().get(S.remote.toString());R!=null&&o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["star message sync: found chat via fallback"]))).sendLogs("star-message-sync-found-chat-via-fallback",{sampling:.01})}return{actionState:o("WASyncdConst").SyncActionState.Orphan,orphanModel:{modelId:S.toString(),modelType:o("WASyncdConst").SyncModelType.Msg}}}var L=r("WANullthrows")(o("WAWebSyncdIndexUtils").syncKeyToMsgKey(v,f,g,h)),E=C.find(function(e){return e.startsWith(o("WAWebSyncdIndexUtils").msgKeyToDbIdWithoutFromMeParticipant(L))});if(E==null)return{actionState:o("WASyncdConst").SyncActionState.Orphan,orphanModel:{modelId:S.toString(),modelType:o("WASyncdConst").SyncModelType.Msg}};b?i.push(E.toString()):l.push(E.toString());var k=o("WAWebMsgCollection").MsgCollection.get(E);if(k){var I=k.associationType;if(I!=null&&o("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var T=o("WAWebAssociationProcessor").getAssociationProcessorByAssociationType(I);(T==null?void 0:T.processorType)===o("WAWebAssociationProcessorConstants").AssociationProcessorType.WithDetachedMessages&&k.detachAssociatedMsg()}k.star=b,k.star?o("WAWebStarredMsgCollection").addStarredMsgs([k]):o("WAWebStarredMsgCollection").removeStarredMsgs([k])}else o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["star_message_sync: msg "," found in storage but not in collection"])),L);return o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: successfully "," msg ",""])),b?"starred":"unstarred",L),{actionState:o("WASyncdConst").SyncActionState.Success}}return o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["star message sync: operation not supported"]))),{actionState:o("WASyncdConst").SyncActionState.Unsupported}}catch(e){return{actionState:o("WASyncdConst").SyncActionState.Failed}}});return function(t){return e.apply(this,arguments)}})()));return o("WAWebCurrentUser").isEmployee()&&o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["syncd: before persist stars"]))),yield g.all([o("WAWebDBProcessMessage").starMessages(i),o("WAWebDBProcessMessage").unstarMessages(l)]),o("WAWebCurrentUser").isEmployee()&&o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["syncd: after persist stars"]))),b});function a(e){return t.apply(this,arguments)}return a})(),i.getStarMessageMutations=function(t,a){var e=this,i=o("WATimeUtils").unixTimeMs();return(g||(g=n("Promise"))).all(t.map((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n={starAction:{starred:a}},l=new(r("WAWebMsgKey"))({fromMe:t.fromMe,participant:t.participant,remote:o("WAWebWidFactory").createWid(yield o("WAWebSyncdGetChat").getChatJidMutationIndexForChat(t.remote)),id:t.id});return o("WAWebSyncdActionUtils").buildPendingMutation({collection:e.collectionName,indexArgs:o("WAWebSyncdUtils").constructMsgKeySegmentsFromMsgKey(l),operation:o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET,version:e.getVersion(),value:n,timestamp:i,action:e.getAction()})});return function(e){return t.apply(this,arguments)}})()))},a})(o("WAWebSyncdAction").MessageSyncdActionBase),y=new h;l.default=y}),98);
__d("WAWebSyncdCollectionUtils",["WASyncdConst"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return e==null}function s(e){switch(e){case o("WASyncdConst").CollectionName.CriticalBlock:return!0;case o("WASyncdConst").CollectionName.CriticalUnblockLow:return!0;case o("WASyncdConst").CollectionName.Regular:return!1;case o("WASyncdConst").CollectionName.RegularHigh:return!1;case o("WASyncdConst").CollectionName.RegularLow:return!1}}l.isBootstrap=e,l.isCriticalCollection=s}),98);
__d("WAWebSyncdResolveConflict",["Promise","WASyncdConst","WAWebGetPendingMutation","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){var o=yield(e||(e=n("Promise"))).all(t.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=r.get(e.index);if(t){var n=e.actionHandler;return{remoteMutationIndex:e.index,conflictResolutionState:yield n.resolveConflicts(t,e)}}});return function(t){return e.apply(this,arguments)}})())),a=new Map;return o.forEach(function(e){e&&a.set(e.remoteMutationIndex,e.conflictResolutionState)}),a}),u.apply(this,arguments)}function c(e,t){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=[],r=[],a=yield o("WAWebGetPendingMutation").getSyncPendingMutationsByCollectionInTransaction(e),i=new Map(a.map(function(e){return[e.index,e]})),l=yield s(t,i);t.forEach(function(e){var t=l.get(e.index);if(t)switch(t){case o("WASyncdConst").ConflictResolutionState.SkipRemote:break;case o("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal:n.push(e),r=r.concat(a.filter(function(t){return t.index===e.index}));break;case o("WASyncdConst").ConflictResolutionState.SkipRemoteAndDropLocal:r=r.concat(a.filter(function(t){return t.index===e.index}));break}else n.push(e)});for(var u=[],c=0;c<n.length;c++){var d=n[c].actionHandler,m=yield d.dropMutationDueToCrossIndexConflict(n[c],i);m||u.push(n[c])}var p=r.map(function(e){return e.id}).filter(Boolean);return{remoteMutationsToApply:u,pendingSetMutationsToDrop:p}}),d.apply(this,arguments)}l.resolveConflict=c}),98);
__d("WAWebSyncdValidateMutations",["WACryptoUtils","WALogger","WALongInt","WASyncdConst","WAWebProtobufSyncAction.pb","WAWebProtobufsServerSync.pb","WAWebSyncdError","WAWebSyncdMetricFatalError","WAWebSyncdUtils","decodeProtobuf"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m;function p(e,t){var n=new Set;t.forEach(function(t){var r=t.version.version;if(n.has(r))throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.DUPLICATE_PATCH_VERSION_IN_COLLECTION,{collection:e}),new(o("WAWebSyncdError")).SyncdFatalError("duplicate patch version in collection");n.add(r)})}function _(e){return e==null?!0:[o("WASyncdConst").Actions.Agent,o("WASyncdConst").Actions.AndroidUnsupportedActions,o("WASyncdConst").Actions.Archive,o("WASyncdConst").Actions.BotWelcomeRequest,o("WASyncdConst").Actions.ChatAssignment,o("WASyncdConst").Actions.ChatAssignmentOpenedStatus,o("WASyncdConst").Actions.ChatLockSettings,o("WASyncdConst").Actions.ClearChat,o("WASyncdConst").Actions.Contact,o("WASyncdConst").Actions.CustomPaymentMethods,o("WASyncdConst").Actions.DeleteChat,o("WASyncdConst").Actions.DeleteMessageForMe,o("WASyncdConst").Actions.DeviceCapabilities,o("WASyncdConst").Actions.DisableLinkPreviews,o("WASyncdConst").Actions.ExternalWebBeta,o("WASyncdConst").Actions.FavoriteSticker,o("WASyncdConst").Actions.LabelEdit,o("WASyncdConst").Actions.LabelJid,o("WASyncdConst").Actions.LabelMessage,o("WASyncdConst").Actions.LabelReordering,o("WASyncdConst").Actions.LocaleSetting,o("WASyncdConst").Actions.LockChat,o("WASyncdConst").Actions.MarkChatAsRead,o("WASyncdConst").Actions.MarketingMessage,o("WASyncdConst").Actions.MarketingMessageBroadcast,o("WASyncdConst").Actions.Mute,o("WASyncdConst").Actions.Nux,o("WASyncdConst").Actions.PaymentInfo,o("WASyncdConst").Actions.Pin,o("WASyncdConst").Actions.PinDEPRECATED,o("WASyncdConst").Actions.PnForLidChat,o("WASyncdConst").Actions.PrimaryFeature,o("WASyncdConst").Actions.PrimaryVersion,o("WASyncdConst").Actions.QuickReply,o("WASyncdConst").Actions.RemoveRecentSticker,o("WASyncdConst").Actions.Sentinel,o("WASyncdConst").Actions.SettingPushName,o("WASyncdConst").Actions.ShareOwnPn,o("WASyncdConst").Actions.Star,o("WASyncdConst").Actions.StatusPrivacy,o("WASyncdConst").Actions.Subscription,o("WASyncdConst").Actions.TimeFormat,o("WASyncdConst").Actions.UnarchiveChatsSetting,o("WASyncdConst").Actions.UserStatusMute,o("WASyncdConst").Actions.Favorites,o("WASyncdConst").Actions.NoteEdit].includes(e)}function f(t){var n=o("WASyncdConst").Actions.cast(o("WAWebSyncdUtils").getMutationNameFromIndex(t.index)),r=t.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET?"SET":"REMOVE";_(n)?o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: duplicate "," mutation: ",""])),r,n):o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: duplicate "," mutation: [not specified]"])),r),o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: duplicate "," mutation: ",""])),r,t.index)}function g(e,t,n){var r=new Set,a=new Set;t.forEach(function(i){var l=!1;if(i.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET&&(r.has(i.index)?(f(i),l=!0):r.add(i.index)),i.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE&&(a.has(i.index)?(f(i),l=!0):a.add(i.index)),l)switch(n){case o("WASyncdConst").SyncDataType.Patch:throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_PATCH,{collection:e}),new(o("WAWebSyncdError")).SyncdFatalError("same index for multiple mutations in patch");case o("WASyncdConst").SyncDataType.Snapshot:o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_SNAPSHOT,{collection:e,isFatal:!1}),h(t);break;case o("WASyncdConst").SyncDataType.Local:o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["validation not required for local mutations"])))}})}function h(e){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["syncd: all duplicated actions:"])));var t=new Map;e.forEach(function(e){if(t.has(e.index)){f(e);var n=t.get(e.index);if(n==null)return;var r=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,e.binarySyncData).value,a=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,n.binarySyncData).value;o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: is using same timestamp? ","\n          is same key? ",""])),(r==null?void 0:r.timestamp)===(a==null?void 0:a.timestamp),o("WACryptoUtils").arrayBuffersEqual(e.keyId,n==null?void 0:n.keyId))}t.set(e.index,e)})}function y(e,t){return t.map(function(t){var n=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,t.binarySyncData),r=n.value;if(!r)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_ACTION_VALUE,{collection:e}),new(o("WAWebSyncdError")).SyncdFatalError("missing action value");var a=o("WALongInt").maybeNumberOrThrowIfTooLarge(r.timestamp);if(a==null)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_ACTION_TIMESTAMP,{collection:e}),new(o("WAWebSyncdError")).SyncdFatalError("missing action timestamp");return{index:t.index,version:t.version,keyId:t.keyId,indexMac:t.indexMac,valueMac:t.valueMac,collection:t.collection,binarySyncData:t.binarySyncData,timestamp:a}})}l.validateNoDuplicatePatchVersionInCollection=p,l.validateNoSameIndexForMultipleMutations=g,l.validateAndTypeSetMutations=y}),98);
__d("WAWebSyncdValidateServerSyncProtobuf",["WALongInt","WASyncdKeyTypes","WAWebProtobufSyncAction.pb","WAWebSyncdError","WAWebSyncdMetricFatalError","decodeProtobuf"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(){}return e.validateSnapshotProtobuf=function(n,r){var t=r.version,a=r.records,i=r.mac,l=r.keyId,s=t==null?void 0:t.version;if(!t||s==null)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_SNAPSHOT_VERSION,{collection:n}),new(o("WAWebSyncdError")).SyncdFatalError("missing snapshot version");var u=a.map(function(t){return e.validateRecordProtobuf(n,t)});if(!i)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_SNAPSHOT_MAC,{collection:n}),new(o("WAWebSyncdError")).SyncdFatalError("missing snapshot mac");var c=e.validateKeyIdProtobuf(n,l,o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_SNAPSHOT_KEY_ID);return{version:{version:o("WALongInt").numberOrThrowIfTooLarge(s)},records:u,mac:i,keyId:c}},e.validatePatchProtobuf=function(n,r){var t=r.version,a=r.mutations,i=r.externalMutations,l=r.snapshotMac,s=r.patchMac,u=r.keyId,c=r.exitCode,d=r.deviceIndex,m=r.clientDebugData,p=t==null?void 0:t.version;if(!t||p==null)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_PATCH_VERSION,{collection:n}),new(o("WAWebSyncdError")).SyncdFatalError("missing patch version");if(a&&a.length>0&&i)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.PATCH_WITH_BOTH_INLINE_AND_EXTERNAL_MUTATIONS,{collection:n}),new(o("WAWebSyncdError")).SyncdFatalError("patch with both inline and external mutations");if(!l)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_PATCH_SNAPSHOT_MAC,{collection:n}),new(o("WAWebSyncdError")).SyncdFatalError("missing patch snapshot mac");if(!s)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_PATCH_MAC,{collection:n}),new(o("WAWebSyncdError")).SyncdFatalError("missing patch mac");var _=e.validateKeyIdProtobuf(n,u,o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_PATCH_KEY_ID),f=void 0;if(m!=null&&(f=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").PatchDebugDataSpec,m)),i){var g=e.validateExternalBlobReference(n,i);return{version:{version:o("WALongInt").numberOrThrowIfTooLarge(p)},mutations:void 0,externalMutations:g,snapshotMac:l,patchMac:s,keyId:_,deviceIndex:d,clientDebugData:f}}var h=a.map(function(t){return e.validateMutationProtobuf(n,t)});return{version:{version:o("WALongInt").numberOrThrowIfTooLarge(p)},mutations:h,externalMutations:void 0,exitCode:c,snapshotMac:l,patchMac:s,keyId:_,deviceIndex:d,clientDebugData:f}},e.validateExternalBlobReference=function(t,n){var e=n.mediaKey,r=n.directPath,a=n.handle,i=n.fileSizeBytes,l=n.fileSha256,s=n.fileEncSha256;if(!e)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_MEDIA_KEY,{collection:t}),new(o("WAWebSyncdError")).SyncdFatalError("missing external blob reference media key");if(r==null)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_DIRECT_PATH,{collection:t}),new(o("WAWebSyncdError")).SyncdFatalError("missing external blob reference direct path");if(!l)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_FILE_SHA256,{collection:t}),new(o("WAWebSyncdError")).SyncdFatalError("missing external blob reference file SHA256");if(!s)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_FILE_ENC_SHA256,{collection:t}),new(o("WAWebSyncdError")).SyncdFatalError("missing external blob reference file enc SHA256");return{mediaKey:e,directPath:r,handle:a,fileSizeBytes:i,fileSha256:l,fileEncSha256:s}},e.validateMutationProtobuf=function(n,r){var t=r.operation,a=r.record;if(t==null)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_OPERATION,{collection:n}),new(o("WAWebSyncdError")).SyncdFatalError("missing mutation operation");if(!a)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_RECORD,{collection:n}),new(o("WAWebSyncdError")).SyncdFatalError("missing mutation record");var i=e.validateRecordProtobuf(n,a);return{operation:t,record:i}},e.validateRecordProtobuf=function(n,r){var t=r.index,a=r.value,i=r.keyId,l=t==null?void 0:t.blob,s=a==null?void 0:a.blob;if(!t||!l)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_INDEX,{collection:n}),new(o("WAWebSyncdError")).SyncdFatalError("missing mutation index");if(!a||!s)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_VALUE,{collection:n}),new(o("WAWebSyncdError")).SyncdFatalError("missing mutation value");var u=e.validateKeyIdProtobuf(n,i,o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_KEY_ID);return{index:{blob:l},value:{blob:s},keyId:u}},e.validateKeyIdProtobuf=function(t,n,r){var e=n==null?void 0:n.id;if(!n||!e)throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(r,{collection:t}),new(o("WAWebSyncdError")).SyncdFatalError("missing mutation key id");return{id:o("WASyncdKeyTypes").toSyncKeyId(e)}},e})();l.default=e}),98);
__d("WAWebWamEnumMutationBundleType",[],(function(t,n,r,o,a,i){var e=Object.freeze({SNAPSHOT:0,PATCH:1});i.MUTATION_BUNDLE_TYPE=e}),66);
__d("WAWebWamEnumMutationDirectionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({INCOMING:0,OUTGOING:1});i.MUTATION_DIRECTION_TYPE=e}),66);
__d("WAWebWamEnumMutationOperationType",[],(function(t,n,r,o,a,i){var e=Object.freeze({SET:0,REMOVE:1});i.MUTATION_OPERATION_TYPE=e}),66);
__d("WAWebWamEnumSyncdCollectionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({REGULAR:1,REGULAR_LOW:2,REGULAR_HIGH:3,CRITICAL_BLOCK:4,CRITICAL_UNBLOCK_LOW:5});i.SYNCD_COLLECTION_TYPE=e}),66);
__d("WAWebMdSyncdMutationWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMutationBundleType","WAWebWamEnumMutationDirectionType","WAWebWamEnumMutationOperationType","WAWebWamEnumSyncdCollectionType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MdSyncdMutation:[5970,{appSessionId:[1,e.TYPES.STRING],companionSessionIds:[2,e.TYPES.STRING],contentLength:[3,e.TYPES.INTEGER],isInBootstrap:[4,e.TYPES.BOOLEAN],isUsingLid:[5,e.TYPES.BOOLEAN],mutationBundle:[6,o("WAWebWamEnumMutationBundleType").MUTATION_BUNDLE_TYPE],mutationDirection:[7,o("WAWebWamEnumMutationDirectionType").MUTATION_DIRECTION_TYPE],mutationMac:[8,e.TYPES.STRING],mutationName:[9,e.TYPES.STRING],mutationOperation:[10,o("WAWebWamEnumMutationOperationType").MUTATION_OPERATION_TYPE],patchMac:[15,e.TYPES.STRING],seqNumber:[11,e.TYPES.INTEGER],syncdCollection:[12,o("WAWebWamEnumSyncdCollectionType").SYNCD_COLLECTION_TYPE],syncdKeyhash:[13,e.TYPES.STRING],syncdKeyid:[14,e.TYPES.STRING]},[1,1,1],"regular"]},{MdSyncdMutation:[]});l.MdSyncdMutationWamEvent=s}),98);
__d("WAWebSyncdWamReportingUtils",["WALogger","WASyncdConst","WAWebABProps","WAWebMdSyncdMutationWamEvent","WAWebWamEnumMutationBundleType","WAWebWamEnumMutationDirectionType","WAWebWamEnumMutationOperationType","WAWebWamEnumSyncdCollectionType","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){switch(e){case o("WASyncdConst").CollectionName.RegularHigh:return o("WAWebWamEnumSyncdCollectionType").SYNCD_COLLECTION_TYPE.REGULAR_HIGH;case o("WASyncdConst").CollectionName.RegularLow:return o("WAWebWamEnumSyncdCollectionType").SYNCD_COLLECTION_TYPE.REGULAR_LOW;case o("WASyncdConst").CollectionName.Regular:return o("WAWebWamEnumSyncdCollectionType").SYNCD_COLLECTION_TYPE.REGULAR;case o("WASyncdConst").CollectionName.CriticalBlock:return o("WAWebWamEnumSyncdCollectionType").SYNCD_COLLECTION_TYPE.CRITICAL_BLOCK;case o("WASyncdConst").CollectionName.CriticalUnblockLow:return o("WAWebWamEnumSyncdCollectionType").SYNCD_COLLECTION_TYPE.CRITICAL_UNBLOCK_LOW}}function u(e,t,n,r,o,a,i,l,s){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r,a,i,l,u,c,d){try{var m=o("WAWebABProps").getABPropConfigValue("syncd_mutation_and_bundle_logging");if(!m)return;var p=JSON.parse(m);if(!p||!p.allowlist||!p.allowlist.includes(t))return;new(o("WAWebMdSyncdMutationWamEvent")).MdSyncdMutationWamEvent({appSessionId:"",companionSessionIds:c,contentLength:0,isInBootstrap:!1,isUsingLid:!1,mutationBundle:u?o("WAWebWamEnumMutationBundleType").MUTATION_BUNDLE_TYPE.PATCH:o("WAWebWamEnumMutationBundleType").MUTATION_BUNDLE_TYPE.SNAPSHOT,mutationDirection:r?o("WAWebWamEnumMutationDirectionType").MUTATION_DIRECTION_TYPE.INCOMING:o("WAWebWamEnumMutationDirectionType").MUTATION_DIRECTION_TYPE.OUTGOING,mutationMac:a,mutationName:i,mutationOperation:l?o("WAWebWamEnumMutationOperationType").MUTATION_OPERATION_TYPE.REMOVE:o("WAWebWamEnumMutationOperationType").MUTATION_OPERATION_TYPE.SET,seqNumber:n,syncdCollection:s(t),syncdKeyhash:"",syncdKeyid:"",patchMac:d!=null?d:""}).commit()}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncReportMutationToWam: ",""])),t).sendLogs("syncReportMutationToWam failed")}}),c.apply(this,arguments)}l.syncReportMutationToWam=u}),98);
__d("WAWebSyncdCollectionHandler",["Promise","WABase64","WACryptoDependencies","WACryptoUtils","WALogger","WALongInt","WANullthrows","WASyncdConst","WASyncdKeyTypes","WATimeUtils","WAWebABProps","WAWebCurrentUser","WAWebGetCollectionVersion","WAWebGetMissingKey","WAWebGetPendingMutation","WAWebGetSyncAction","WAWebProtobufSyncAction.pb","WAWebProtobufsServerSync.pb","WAWebRequestSyncdSnapshotRecovery","WAWebRunInTransaction","WAWebSyncdAntiTampering","WAWebSyncdCollectionHandlerTypesConverter","WAWebSyncdCollectionUtils","WAWebSyncdCryptoUtils","WAWebSyncdDbCallbacksApi","WAWebSyncdDecryptMutationsWrapper","WAWebSyncdError","WAWebSyncdGetActionHandler","WAWebSyncdHandleMissingKeys","WAWebSyncdMMSDownload","WAWebSyncdMdSyncFieldstatMeta","WAWebSyncdMetricCriticalBootstrapStage","WAWebSyncdMetricFatalError","WAWebSyncdMetrics","WAWebSyncdResolveConflict","WAWebSyncdSnapshotRecoveryGatingUtils","WAWebSyncdUtils","WAWebSyncdValidateMutations","WAWebSyncdValidateServerSyncProtobuf","WAWebSyncdWamAppState","WAWebSyncdWamReportingUtils","asyncToGeneratorRuntime","decodeProtobuf","err","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x,$,P,N,M,w,A,F,O,B,W,q,U,V,H,G,z,j,K,Q,X,Y,J,Z,ee,te,ne,re,oe,ae,ie,le,se,ue,ce,de,me,pe,_e,fe,ge,he,ye,Ce,be,ve,Se,Re,Le=0,Ee=new ArrayBuffer(128),ke=null;function Ie(){return Te.apply(this,arguments)}function Te(){return Te=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{if(ke!=null)return ke;var e=yield o("WAWebSyncdMdSyncFieldstatMeta").MdSyncFieldStatsMeta.getMdSessionId(),t=o("WABase64").decodeB64(e),n=yield o("WACryptoDependencies").getCrypto().subtle.digest({name:"SHA-1"},t),r=o("WABase64").encodeB64UrlSafe(n);return ke=r.slice(-6),ke}catch(e){return o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["getShortMdSessionId: ",""])),e).sendLogs("getShortMdSessionId failed"),""}}),Te.apply(this,arguments)}function De(e){return xe.apply(this,arguments)}function xe(){return xe=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e.length===0)return(Re||(Re=n("Promise"))).resolve();var t=Math.random().toString(36).substr(2,5),r=e.sort(function(e,t){return e.timestamp-t.timestamp});o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: start applyIndividualMutations"])));var a=o("WAWebSyncdCollectionHandlerTypesConverter").syncActionsToDecryptedMutation(r),i=a.reduce(function(e,t){var n,r=(n=e.get(t.collection))!=null?n:[];return r.push(t),e.set(t.collection,r),e},new Map),l=Array.from(i.keys()).map((function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(r){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose([""," syncd: apply individual mutations for collection ",""])),t,r);var a=i.get(r);if(a!==void 0){var l=yield Ze(r,a,o("WASyncdConst").SyncDataType.Local,t,null,null),s=l.setMutationsToPersist,u=l.pendingSetMutationsToDrop,c=s.map(function(e){return{actionState:e.actionState,index:e.index,modelId:e.modelId,modelType:e.modelType}}),d=c;d=c.filter(function(t){var n=e.find(function(e){return e.index===t.index});return n==null?(o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["syncd: could not find original individual mutation"]))).sendLogs("syncd: could not find original individual mutation"),!0):t.actionState!==n.actionState||t.modelId!==n.modelId||t.modelType!==n.modelType}),o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: end apply individual mutations for collection ",""])),t,r),yield o("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0},(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.SyncActionStore,n=e.PendingMutationStore;d.length>0&&(yield t.bulkUpdate(d)),u.length>0&&(yield n.bulkRemove(u))});return function(t){return e.apply(this,arguments)}})()),o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose([""," syncd: end update db after apply individual mutations for collection ",""])),t,r)}});return function(e){return r.apply(this,arguments)}})());yield(Re||(Re=n("Promise"))).all(l),o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose([""," syncd: end applyIndividualMutations"])),t)}),xe.apply(this,arguments)}function $e(e,t,n,r){return Pe.apply(this,arguments)}function Pe(){return Pe=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=e.name,i=e.version,l=e.patches,s=e.snapshot,u=e.syncedPendingMutationsId,c=e.syncedEncryptedMutations;o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: start applying collection ",""])),t,a);try{var d,m;r==null||r.mark("external_mutations_download_start",{patchCount:(d=e.patches)==null?void 0:d.length,snapshotSizeBytes:(m=e.snapshot)==null?void 0:m.fileSizeBytes});var p=yield Be(a,l,s,n),_=p[0],f=p[1];r==null||r.mark("external_mutations_download_end",{patchesWithMutationsCount:f==null?void 0:f.length,snapshotRecordsCount:_==null?void 0:_.records.length});var g=performance.now();if(_!=null)yield Ve(a,_,f,r,t),o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: "," snapshot and patches applied successfully"])),t,a);else if(f!=null){var h=Math.min.apply(Math,f.map(function(e){return e.version.version})),x=n!=null&&h>n+1&&f.length>0;if(x){yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,t+" has missing patches");var $=yield o("WAWebGetMissingKey").getAllMissingKeysInTransaction();throw o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose([""," syncd: missing keys: [","]"])),t,$.map(function(e){return e.keyHex+":"+e.timestamp})),o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose([""," syncd: has missing patches. collection: ",", localVersion: ",",\n           minPatch: ",""])),t,a,n,h),yield Ne(a,f[0]),yield o("WAWebSyncdDbCallbacksApi").printSyncdLog(a),o("WALogger").ERROR(S||(S=babelHelpers.taggedTemplateLiteralLoose([""," syncd: has missing patches. collection: ",""])),t,a).sendLogs("syncd: has missing patches"),o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.SERVER_DID_NOT_SEND_ALL_PATCHES,{collection:a,patchVersion:n!=null?n:0}),new(o("WAWebSyncdError")).SyncdFatalError("syncd: has missing patches")}yield je(a,f,r,t),o("WALogger").LOG(R||(R=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: "," patches applied successfully"])),t,a)}else if(i!=null){var P=c.filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET}).length,N=c.filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE}).length,M=Array.from(new Set(c.map(function(e){return e.index}))).length;yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,t+" start upload patch. version: "+i+". mutation count: "+c.length+",\n        numSet: "+P+", numRemove: "+N+", numUniqueIndex: "+M),yield we(a,i,u,c,t);var w=yield Ie();c.forEach(function(e){var t=o("WAWebSyncdUtils").getMutationNameFromIndex(e.index);o("WAWebSyncdWamReportingUtils").syncReportMutationToWam(a,i,!1,o("WABase64").encodeB64UrlSafe(e.indexMac),t,e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE,!0,w,e.patchMac?o("WABase64").encodeB64UrlSafe(e.patchMac):void 0)}),yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,t+" end upload patches"),o("WALogger").LOG(L||(L=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: "," v"," uploaded successfully"])),t,a,i)}else o("WAWebSyncdCollectionUtils").isBootstrap(n)&&(yield o("WAWebGetCollectionVersion").updateCollectionVersionAndLtHashInTransaction(a,Le,Ee)),o("WALogger").LOG(E||(E=babelHelpers.taggedTemplateLiteralLoose(["syncd: sync "," but there are no updates"])),a);var A=Math.floor(performance.now()-g);if(o("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: applyAppStateSyncResponse: finished applying "," in ","ms"])),a,A),(f||_)&&o("WAWebSyncdCollectionUtils").isBootstrap(n)&&!o("WAWebSyncdCollectionUtils").isCriticalCollection(a)){var F=_!=null;o("WAWebSyncdMetrics").reportSyncdBootstrapDataApplied(a,F?o("WAWebSyncdMetrics").SyncdBootstrapDataAppliedSnapshotUsed.SNAPSHOT_USED:o("WAWebSyncdMetrics").SyncdBootstrapDataAppliedSnapshotUsed.SNAPSHOT_NOT_USED,A)}return e}catch(e){var O=e.message;return yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"error (maybe retryable): "+e),e instanceof o("WAWebSyncdError").SyncdMissingKeyError?(o("WALogger").WARN(I||(I=babelHelpers.taggedTemplateLiteralLoose(["syncd: key error: "," missing keys"])),a),{name:a,state:o("WASyncdConst").CollectionState.Blocked}):e instanceof o("WAWebSyncdError").SyncdFatalError?(o("WALogger").ERROR(T||(T=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: "," throws ",""])),a,O).sendLogs("syncd: fatal error: "+String(a)+" throws "+O),{name:a,state:o("WASyncdConst").CollectionState.ErrorFatal}):(o("WALogger").WARN(D||(D=babelHelpers.taggedTemplateLiteralLoose(["syncd: retryable error: "," throws ",""])),a,O).sendLogs("syncd: retryable error: "+String(a)+" throws "+O),{name:a,state:o("WASyncdConst").CollectionState.ErrorRetry})}}),Pe.apply(this,arguments)}function Ne(e,t){return Me.apply(this,arguments)}function Me(){return Me=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){try{var n=yield o("WAWebSyncdDecryptMutationsWrapper").tryDecryptPatch(e,t),r=n.filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET}),a=o("WAWebSyncdValidateMutations").validateAndTypeSetMutations(e,r),i=a.length>0?a[0].timestamp:null,l=i==null?null:o("WATimeUtils").daysDiff(o("WATimeUtils").unixTimeMs(),i);yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"max timestamp in first patch: "+(l!=null?l:"n/a")+" days ago")}catch(e){o("WALogger").WARN(x||(x=babelHelpers.taggedTemplateLiteralLoose(["syncd: could not log max timestamp: ",""])),e)}}),Me.apply(this,arguments)}function we(e,t,n,r,o){return Ae.apply(this,arguments)}function Ae(){return Ae=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,a,i){var l,s=a.map(function(e){return{indexMac:e.indexMac,valueMac:e.valueMac,operation:e.operation}});yield Fe(i,e,a,s);var u=yield o("WAWebSyncdAntiTampering").computeLtHash(e,s,i,null,t,o("WAWebSyncdAntiTampering").SyncdPatchDirection.Outgoing),c=u.ltHash,d=o("WAWebSyncdCollectionHandlerTypesConverter").encryptedUploadMutationsToSyncActions(a.filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET}),o("WASyncdConst").SyncActionState.Success);yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+i+"] set mutation during upload: "+d.map(function(e){return o("WAWebSyncdAntiTampering").indexAndValueMacToString(e.indexMac,e.valueMac)}).join("\n	"));var m=new Set(d.map(function(e){return e.index})),p=a.filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE&&!m.has(e.index)}).map(function(e){return e.index});yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+i+"] count removed during upload: "+p.length);var _=(l=yield o("WAWebGetCollectionVersion").getCollectionVersionInTransaction(e).then(function(e){return e==null?void 0:e.version}))!=null?l:0;t!==_+1&&o("WALogger").ERROR($||($=babelHelpers.taggedTemplateLiteralLoose(["syncd: _uploadSuccessful: unexpected server version (",") after patch upload, expected ",""])),t,_+1).sendLogs("syncd: unexpected server version after patch upload"),o("WALogger").LOG(P||(P=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: _uploadSuccessful: write to db for ",""])),i,e),yield o("WAWebSyncdAntiTampering").logMacsInSnapshot(e,i,"pre-processing outgoing patch v"+t),yield o("WAWebSyncdAntiTampering").reportCollectionInconsistency(e,"pre-processing outgoing patch "+t+".",i),yield Qe(e,t,a,i);var f=null;if(yield o("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0,CollectionVersionStore:!0},(function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){var a=n.SyncActionStore,l=n.PendingMutationStore,s=n.CollectionVersionStore;f=yield st(e,t,"outgoing patch",s,i),f==null?(yield a.bulkRemove(p),yield a.bulkSet(d),yield l.bulkRemove(r),yield s.update(e,{version:t,ltHash:c})):o("WALogger").LOG(N||(N=babelHelpers.taggedTemplateLiteralLoose(["syncd: [","] skip applying syncd old version ",""])),i,t)});return function(e){return a.apply(this,arguments)}})()),f!=null){var g=f;yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,g),yield o("WAWebSyncdDbCallbacksApi").printSyncdLog(e),o("WALogger").ERROR(M||(M=babelHelpers.taggedTemplateLiteralLoose(["",""])),g).sendLogs("syncd: processing old version for "+e)}o("WALogger").LOG(w||(w=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: end _uploadSuccessful for ",""])),i,e)}),Ae.apply(this,arguments)}function Fe(e,t,n,r){return Oe.apply(this,arguments)}function Oe(){return Oe=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,a){try{var i=yield(Re||(Re=n("Promise"))).all([(yield Re.all(r.filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE}).map(function(e){return o("WAWebGetSyncAction").getSyncActionInTransaction(e.index)}))).filter(Boolean),(yield Re.all(r.filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET}).map(function(e){return o("WAWebGetSyncAction").getSyncActionInTransaction(e.index)}))).filter(Boolean),(yield Re.all(r.filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET}).map(function(e){return o("WAWebGetSyncAction").getSyncActionsByIndexMacsInTransaction([e.indexMac])}))).filter(Boolean)]),l=i[0],s=i[1],u=i[2],c=null;s.length===1&&u.length===1&&u[0].length===1&&(c=s[0].index===u[0][0].index);var d="["+e+"] patch uploaded with mutations mac for "+t+":\n\n      SET: "+a.filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET}).map(function(e){return o("WAWebSyncdAntiTampering").indexAndValueMacToString(e.indexMac,e.valueMac)}).join("\n	")+"\n      REMOVE: "+a.filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE}).map(function(e){return o("WAWebSyncdAntiTampering").indexAndValueMacToString(e.indexMac,e.valueMac)}).join("\n	")+"\n\n      REMOVE fetch by index: "+l.map(function(e){return e.collection+":"+o("WAWebSyncdAntiTampering").indexAndValueMacToString(e.indexMac,e.valueMac)+":"+o("WAWebSyncdUtils").getMutationNameFromIndex(e.index)}).join("\n	")+"\n      SET fetch by index: "+s.map(function(e){return e.collection+":"+o("WAWebSyncdAntiTampering").indexAndValueMacToString(e.indexMac,e.valueMac)+":"+o("WAWebSyncdUtils").getMutationNameFromIndex(e.index)}).join("\n	")+"\n      SET fetch by mac: "+u.map(function(e){return e.map(function(e){return e.collection+":"+o("WAWebSyncdAntiTampering").indexAndValueMacToString(e.indexMac,e.valueMac)+":"+o("WAWebSyncdUtils").getMutationNameFromIndex(e.index)})}).join("\n	")+"\n      isSameIndex: "+(c==null?"n/a":c.toString())+"\n      ";o("WALogger").LOG(A||(A=babelHelpers.taggedTemplateLiteralLoose(["syncd: "," "])),d),yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(t,d)}catch(e){o("WALogger").LOG(F||(F=babelHelpers.taggedTemplateLiteralLoose(["syncd: failed to debug upload: ",""])),e)}}),Oe.apply(this,arguments)}function Be(e,t,n,r){return We.apply(this,arguments)}function We(){return We=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,i){var l=(Re||(Re=n("Promise"))).resolve(),s=0,u=o("WATimeUtils").unixTimeMs();if(a!=null){var c,d=r("WAWebSyncdValidateServerSyncProtobuf").validateExternalBlobReference(e,a);s+=o("WALongInt").numberOrThrowIfTooLarge((c=d.fileSizeBytes)!=null?c:0),o("WALogger").LOG(O||(O=babelHelpers.taggedTemplateLiteralLoose(["syncd: download snapshot for ",""])),e),l=o("WAWebSyncdMMSDownload").downloadSnapshot(e,d)}var m=Re.resolve();if(t!=null&&t.length>0){var p=t.map(function(t){return r("WAWebSyncdValidateServerSyncProtobuf").validatePatchProtobuf(e,t)});m=(Re||(Re=n("Promise"))).all(p.map((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.mutations||[],r=t.externalMutations;if(r){var a;o("WALogger").LOG(B||(B=babelHelpers.taggedTemplateLiteralLoose(["syncd: download patch for ",""])),e),n=yield o("WAWebSyncdMMSDownload").downloadExternalPatch(e,r),o("WALogger").LOG(W||(W=babelHelpers.taggedTemplateLiteralLoose(["syncd: ","'s external patch downloaded"])),e),s+=o("WALongInt").numberOrThrowIfTooLarge((a=r.fileSizeBytes)!=null?a:0)}return{mutations:n,version:t.version,snapshotMac:t.snapshotMac,patchMac:t.patchMac,keyId:t.keyId,exitCode:t.exitCode,deviceIndex:t.deviceIndex,clientDebugData:t.clientDebugData}});return function(e){return t.apply(this,arguments)}})()))}var _,f;try{var g=yield(Re||(Re=n("Promise"))).all([l,m]);_=g[0],f=g[1],o("WAWebSyncdCollectionUtils").isBootstrap(i)&&o("WAWebSyncdMetrics").reportSyncdBootstrapAppStateDownloadMetric({collection:e,downloadStartTs:u,downloadSize:s,isSuccess:"success"})}catch(t){throw o("WAWebSyncdCollectionUtils").isBootstrap(i)&&o("WAWebSyncdMetrics").reportSyncdBootstrapAppStateDownloadMetric({collection:e,downloadStartTs:u,downloadSize:s,isSuccess:"failure"}),t}return[_,f]}),We.apply(this,arguments)}function qe(e,t){var r=(function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n,r){e==null||e.mark("anti_tampering_start",{source:o("WASyncdConst").SyncDataType.Snapshot});var a=yield o("WAWebSyncdAntiTampering").computeLtHashAndValidateSnapshot(n,r,t);return e==null||e.mark("anti_tampering_end",{source:o("WASyncdConst").SyncDataType.Snapshot}),a});return function(t,n){return r.apply(this,arguments)}})(),a=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){e==null||e.mark("decryption_start",{source:o("WASyncdConst").SyncDataType.Snapshot});var r=yield o("WAWebSyncdDecryptMutationsWrapper").tryDecryptSnapshot(t,n);return e==null||e.mark("decryption_end",{source:o("WASyncdConst").SyncDataType.Snapshot}),r});return function(n,r){return t.apply(this,arguments)}})();return{measuredComputeLtHashAndValidateSnapshot:r,measuredTryDecryptSnapshot:a}}function Ue(e){var t=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r,a){e==null||e.mark("anti_tampering_start",{source:o("WASyncdConst").SyncDataType.Patch});var i=yield o("WAWebSyncdAntiTampering").computeLtHashAndValidatePatch(t,n,r,a);return e==null||e.mark("anti_tampering_end",{source:o("WASyncdConst").SyncDataType.Patch}),i});return function(n,r,o,a){return t.apply(this,arguments)}})(),r=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){e==null||e.mark("decryption_start",{source:o("WASyncdConst").SyncDataType.Patch});var r=yield o("WAWebSyncdDecryptMutationsWrapper").tryDecryptPatch(t,n);return e==null||e.mark("decryption_end",{source:o("WASyncdConst").SyncDataType.Patch}),r});return function(n,r){return t.apply(this,arguments)}})();return{measuredComputeLtHashAndValidatePatch:t,measuredTryDecryptPatch:r}}function Ve(e,t,n,r,o){return He.apply(this,arguments)}function He(){return He=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,i,l){yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+l+"] start _applySnapshotAndPatches. mutation count: "+t.records.length+", version: "+t.version.version);var s=!1;try{var u=qe(i,l),c=u.measuredComputeLtHashAndValidateSnapshot,d=u.measuredTryDecryptSnapshot;i==null||i.mark("apply_start",{source:o("WASyncdConst").SyncDataType.Snapshot,snapshotRecordsCount:t.records.length}),o("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: start validate ","'s snapshot"])),l,e);var m=new ArrayBuffer(0),p=null;try{m=yield c(e,t)}catch(n){var _=o("WAWebSyncdSnapshotRecoveryGatingUtils").shouldPreformSnapshotRecovery(e,t.records.length,n);if(_.shouldPerformRecovery)s=!0,yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+l+"] attempt to recovery failed validate snapshot mac"),o("WALogger").LOG(U||(U=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: "," failed validate snapshot mac, attempt to recovery"])),l,e);else throw n}o("WALogger").LOG(V||(V=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: collection ","'s snapshot validated"])),l,e);var f=[];if(!s)f=yield d(e,t),o("WALogger").LOG(H||(H=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: collection ","'s snapshot decrypted"])),l,e);else{o("WALogger").LOG(G||(G=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd recovery: "," requesting recovery from primary"])),l,e),r("gkx")("26258")||o("WALogger").ERROR(z||(z=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd recovery: "," requesting recovery from primary"])),l,e).sendLogs("syncd-recover-fatal");var g=o("WATimeUtils").unixTimeMs(),h=yield o("WAWebRequestSyncdSnapshotRecovery").SyncdSnapshotRecoveryModule.requestRecoveryWithTimeout(e);o("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd recovery: "," recovery request resolved"])),l,e);var y=o("WATimeUtils").unixTimeMs()-g;if(h==null)throw o("WAWebSyncdMetricFatalError").flushDeferredFatalError(y),new(o("WAWebSyncdError")).SyncdFatalError("unable to validate snapshot mac");o("WAWebSyncdMetricFatalError").flushDeferredFatalError(y,!1),f=h.decryptedMutations,m=h.collectionLthash,p=h.version}var C=yield Ie();s||(f.forEach(function(n){var r=o("WAWebSyncdUtils").getMutationNameFromIndex(n.index);o("WAWebSyncdWamReportingUtils").syncReportMutationToWam(e,t.version.version,!0,o("WABase64").encodeB64UrlSafe(n.indexMac),r,n.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE,!1,C,o("WABase64").encodeB64UrlSafe(t.mac))}),yield Qe(e,t.version.version,f,l),o("WAWebSyncdWamAppState").addMutationCount(t.records.length),o("WAWebSyncdMetricCriticalBootstrapStage").reportSyncdDecryptedMutations(o("WAWebSyncdMetricCriticalBootstrapStage").SyncdDecryptMutationsType.SNAPSHOT_MUTATIONS,f),o("WAWebSyncdValidateMutations").validateNoSameIndexForMultipleMutations(e,f,o("WASyncdConst").SyncDataType.Snapshot));var b=s&&p!=null?p:t.version.version,v=yield Ze(e,f,o("WASyncdConst").SyncDataType.Snapshot,l,i,b),S=v.setMutationsToPersist,R=v.pendingSetMutationsToDrop;o("WALogger").LOG(K||(K=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: processed "," mutations in snapshot of collection "," v",""])),l,f.length,e,b),o("WALogger").LOG(Q||(Q=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: collection ","'s snapshot v"," applied"])),l,e,b);var L=null;if(i==null||i.mark("update_DB_start",{source:o("WASyncdConst").SyncDataType.Snapshot,setMutationsToPersistCount:S.length,pendingMutationsToDropCount:R.length}),yield o("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0,CollectionVersionStore:!0},(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.SyncActionStore,r=t.PendingMutationStore,a=t.CollectionVersionStore;L=yield st(e,b,"snapshot",a,l),L==null?(yield n.bulkSet(S),yield r.bulkRemove(R),yield a.update(e,{version:b,ltHash:m})):o("WALogger").LOG(X||(X=babelHelpers.taggedTemplateLiteralLoose(["syncd: [","] skip applying syncd old version ",""])),l,b)});return function(e){return t.apply(this,arguments)}})()),i==null||i.mark("update_DB_end",{source:o("WASyncdConst").SyncDataType.Snapshot}),L!=null){var E=L;yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,E),yield o("WAWebSyncdDbCallbacksApi").printSyncdLog(e),o("WALogger").ERROR(Y||(Y=babelHelpers.taggedTemplateLiteralLoose(["",""])),E).sendLogs("syncd: processing old version for "+e)}o("WALogger").LOG(J||(J=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: completed applying snapshot for ",""])),l,e),i==null||i.mark("apply_end",{source:o("WASyncdConst").SyncDataType.Snapshot,decryptedMutationsCount:f.length})}catch(n){throw yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"exception "+n.message),n instanceof o("WAWebSyncdError").SyncdMissingKeyError&&(yield o("WAWebSyncdHandleMissingKeys").handleMissingKeysInSnapshot(e,t)),n}yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+l+"] done applying snapshot"),a&&!s&&(i==null||i.mark("apply_start",{source:o("WASyncdConst").SyncDataType.Patch,patchCount:a.length}),yield je(e,a,i,l),i==null||i.mark("apply_end",{source:o("WASyncdConst").SyncDataType.Patch,patchCount:a.length}))}),He.apply(this,arguments)}function Ge(e){return ze.apply(this,arguments)}function ze(){return ze=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebABProps").getABPropConfigValue("web_syncd_max_mutations_to_process_during_resume");if(e>t){var n=Date.now();o("WALogger").LOG(Z||(Z=babelHelpers.taggedTemplateLiteralLoose(["syncd: patches have "," mutations, wait for UI unblock"])),e),yield o("WAWebSyncdDbCallbacksApi").handleSyncDelayApplyingPatchUntilUIUnblocks(),o("WALogger").LOG(ee||(ee=babelHelpers.taggedTemplateLiteralLoose(["syncd: UI is unblocked, waited for ","ms"])),Date.now()-n)}}),ze.apply(this,arguments)}function je(e,t,n,r){return Ke.apply(this,arguments)}function Ke(){return Ke=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,a){var i=t.length===0?"n/a":t[t.length-1].version.version;if(yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+a+"] start apply patches. count: "+t.length+", last patch version: "+i),t.length===0)return o("WALogger").LOG(te||(te=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: no patches for collection ",""])),a,e),(Re||(Re=n("Promise"))).resolve();o("WAWebSyncdValidateMutations").validateNoDuplicatePatchVersionInCollection(e,t),t.sort(function(e,t){return e.version.version>t.version.version?1:-1});try{var l=t.reduce(function(e,t){return e+t.mutations.length},0);yield Ge(l);for(var s=0;s<t.length;s++){if(s<=4||s%10===0){var u;yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+a+"] start applying "+e+" patch "+t[s].version.version+" with "+t[s].mutations.length+" mutations from device "+((u=t[s].deviceIndex)!=null?u:"n/a"))}yield Ye(e,t[s],r,s<=1,a),(s<=4||s%10===0)&&(yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+a+"] finished applying patch "+t[s].version.version+" with "+t[s].mutations.length+" mutations"))}yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+a+"] after apply patches for "+e+" (last patch: v"+i+" total mutations: "+l+")")}catch(n){throw yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"exception"+n.message),n instanceof o("WAWebSyncdError").SyncdMissingKeyError&&(yield o("WAWebSyncdHandleMissingKeys").handleMissingKeysInPatches(e,t)),n}}),Ke.apply(this,arguments)}function Qe(e,t,n,r){return Xe.apply(this,arguments)}function Xe(){return Xe=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){if(e===o("WASyncdConst").CollectionName.CriticalBlock||e===o("WASyncdConst").CollectionName.RegularLow){var a=n.map(function(e){var t=e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET?"SET":"REMOVE",n=o("WAWebSyncdUtils").getMutationNameFromIndex(e.index);return t+" "+n+" index mac: "+o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(e.indexMac).slice(-16)+", key id: "+o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(o("WASyncdKeyTypes").fromSyncKeyId(e.keyId))}).join("  || "),i="mutations in patch for collection "+e+" version "+t+": "+a;o("WALogger").LOG(ne||(ne=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: ",""])),r,i),yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,i)}}),Xe.apply(this,arguments)}function Ye(e,t,n,r,o){return Je.apply(this,arguments)}function Je(){return Je=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,a,i){a===void 0&&(a=!1);var l=o("WAWebABProps").getABPropConfigValue("enable_syncd_debug_data_in_patch")||e===o("WASyncdConst").CollectionName.CriticalBlock||e===o("WASyncdConst").CollectionName.RegularLow||o("WAWebCurrentUser").isEmployee();if(l){var s,u,c,d;yield o("WAWebSyncdAntiTampering").logMacsInSnapshot(e,i,"pre-processing incoming patch "+t.version.version+"."),yield o("WAWebSyncdAntiTampering").reportCollectionInconsistency(e,"["+i+"] pre-processing incoming patch "+t.version.version+".\n      incoming current lthash: "+o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded((s=t==null||(u=t.clientDebugData)==null?void 0:u.currentLthash)!=null?s:new ArrayBuffer(0)).slice(-16)+",\n      incoming new lthash: "+o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded((c=t==null||(d=t.clientDebugData)==null?void 0:d.newLthash)!=null?c:new ArrayBuffer(0)).slice(-16),i,250)}if(t.exitCode){var m,p=t.exitCode.code;switch(yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"patch exit code "+(p!=null?p:"")),p){case 100:o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.TERMINAL_PATCH_MISSING_DATA,{collection:e});break;case 101:o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.TERMINAL_PATCH_DESERIALIZATION_ERROR,{collection:e});break;default:o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.TERMINAL_PATCH_UNKNOWN,{collection:e})}throw new(o("WAWebSyncdError")).SyncdFatalError("received terminal patch with exit code:  "+String(p)+" text: "+String((m=t.exitCode)==null?void 0:m.text)+"  ")}yield o("WAWebSyncdDbCallbacksApi").handleSyncBeforeApplyPatch(t);var _=t.mutations.filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET}).length,f=t.mutations.length-_;o("WALogger").LOG(re||(re=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: applying patch "," v"," from device ","\n    SET count: ","\n    REMOVE count: ",""])),i,e,t.version.version,t.deviceIndex,_,f),_===0&&f===0&&o("WALogger").WARN(oe||(oe=babelHelpers.taggedTemplateLiteralLoose(["syncd: ",": empty patch found"])),e).sendLogs("syncd: "+e+": empty patch found");var g=Ue(r),h=g.measuredComputeLtHashAndValidatePatch,y=g.measuredTryDecryptPatch,C=yield y(e,t);o("WAWebSyncdMetricCriticalBootstrapStage").reportSyncdDecryptedMutations(o("WAWebSyncdMetricCriticalBootstrapStage").SyncdDecryptMutationsType.PATCH_MUTATIONS,C);var b=yield Ie();C.forEach(function(n){var r=o("WAWebSyncdUtils").getMutationNameFromIndex(n.index);o("WAWebSyncdWamReportingUtils").syncReportMutationToWam(e,t.version.version,!0,o("WABase64").encodeB64UrlSafe(n.indexMac),r,n.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE,!0,b,t.patchMac?o("WABase64").encodeB64UrlSafe(t.patchMac):void 0)}),yield Qe(e,t.version.version,C,i),a&&(yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+i+"] after decrypt patch "+t.version.version));var v=yield h(e,t,i,M);o("WALogger").LOG(ae||(ae=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: completed computeLtHashAndValidatePatch for "," v",""])),i,e,t.version.version),o("WAWebSyncdWamAppState").addMutationCount(C.length),o("WAWebSyncdValidateMutations").validateNoSameIndexForMultipleMutations(e,C,o("WASyncdConst").SyncDataType.Patch);var S=ot(C),R=S.filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE}),L=yield tt(e,R,i),E=L.pendingRemoveMutationsToDrop;o("WALogger").LOG(ie||(ie=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: completed _applyRemoveMutations for "," v",""])),i,e,t.version.version);var k=S.filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET}),I=yield Ze(e,k,o("WASyncdConst").SyncDataType.Patch,i,r,t.version.version,a),T=I.setMutationsToPersist,D=I.pendingSetMutationsToDrop;o("WALogger").LOG(le||(le=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: processed "," mutations in patch version "," of collection ",""])),i,C.length,t.version.version,e);var x=E.concat(D);r==null||r.mark("update_DB_start",{source:o("WASyncdConst").SyncDataType.Patch,setMutationsToPersistCount:T.length,pendingMutationsToDropCount:x.length});var $=t.version.version,P=null;if(yield o("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0,CollectionVersionStore:!0},(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.SyncActionStore,r=t.PendingMutationStore,a=t.CollectionVersionStore;P=yield st(e,$,"incoming patch",a,i),P==null?(yield n.bulkRemove(R.map(function(e){return e.index})),yield n.bulkSet(T),yield r.bulkRemove(x),yield a.update(e,{version:$,ltHash:v})):o("WALogger").LOG(se||(se=babelHelpers.taggedTemplateLiteralLoose(["syncd: [","] skip applying syncd old version ",""])),i,$)});return function(e){return t.apply(this,arguments)}})()),P!=null){var N=P;yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,N),yield o("WAWebSyncdDbCallbacksApi").printSyncdLog(e),o("WALogger").ERROR(ue||(ue=babelHelpers.taggedTemplateLiteralLoose(["",""])),N).sendLogs("syncd: processing old version for "+e)}(l||e===o("WASyncdConst").CollectionName.RegularLow||o("WAWebCurrentUser").isEmployee())&&(yield o("WAWebSyncdAntiTampering").logMacsInSnapshot(e,i,"post-processing incoming patch "+t.version.version+".")),r==null||r.mark("update_DB_end",{source:o("WASyncdConst").SyncDataType.Patch}),o("WALogger").LOG(ce||(ce=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: completed final transaction in _applyPatch for "," v",""])),i,e,t.version.version),a&&(yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+i+"] after final transaction for patch "+t.version.version+". new lthash: "+o("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(v).slice(-16)));function M(e){return w.apply(this,arguments)}function w(){return w=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n;return(n=(yield o("WAWebGetSyncAction").getSyncActionsByCollectionsInTransaction([e])).filter(function(e){return o("WACryptoUtils").arrayBuffersEqual(t,e.indexMac)}).pop())==null?void 0:n.valueMac}),w.apply(this,arguments)}}),Je.apply(this,arguments)}function Ze(e,t,n,r,o,a,i){return et.apply(this,arguments)}function et(){return et=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a,i,l,s){s===void 0&&(s=!1),o("WAWebSyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(o("WAWebSyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.ABOUT_TO_APPLY_MUTATIONS);var u=n===o("WASyncdConst").SyncDataType.Local?" (individual mutations)":"",c=[],d=o("WAWebSyncdValidateMutations").validateAndTypeSetMutations(e,t),m=at(e,d),p=m.supportedMutations,_=m.unsupportedMutations;_.forEach(function(e){return c.push(o("WAWebSyncdCollectionHandlerTypesConverter").setMutationToSyncAction(e,o("WASyncdConst").SyncActionState.Unsupported))}),i==null||i.mark("conflict_resolution_start",{source:n,collectionName:e,count:p.length}),o("WALogger").LOG(de||(de=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: before resolveConflict for "," v",""])),a,e,l);var f=yield o("WAWebSyncdResolveConflict").resolveConflict(e,p),g=f.remoteMutationsToApply,h=f.pendingSetMutationsToDrop;o("WALogger").LOG(me||(me=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: after resolveConflict for "," v",""])),a,e,l);var y=p.filter(function(e){return!g.includes(e)});i==null||i.mark("conflict_resolution_end",{source:n,collectionName:e,apply:g.length,drop:y.length}),y.forEach(function(e){return c.push(o("WAWebSyncdCollectionHandlerTypesConverter").setMutationToSyncAction(e,o("WASyncdConst").SyncActionState.Skipped,e.actionName))}),i==null||i.mark("apply_set_mutations_start",{source:n,collectionName:e,count:g.length});for(var C=it(g),b=null,v=0;v<C.length;v++){var S=s&&v<=1,R=C[v][0].actionHandler,L=C[v].map(function(e){var t;return e.binarySyncData?t=r("WANullthrows")(o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,e.binarySyncData).value):t=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionValueSpec,e.binarySyncAction),(b==null||b<e.timestamp)&&(b=e.timestamp),{operation:"set",indexParts:e.indexArr,value:t,timestamp:e.timestamp}});S&&(yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,a+" after deserialize. mutationsToApply length: "+L.length));var E=[],k=!1;try{o("WAWebCurrentUser").isEmployee()&&o("WALogger").LOG(pe||(pe=babelHelpers.taggedTemplateLiteralLoose(["syncd: applying mutations "," for handler "," ",""])),JSON.stringify(L.slice(0,3),null,2),R.getAction(),u),o("WALogger").LOG(_e||(_e=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: before apply mutation batch for "," v",", mutations count: "," ",""])),a,e,l,L.length,u),E=yield R.applyMutations(L,{setMutationsPendingToPersist:c,allSupportedSetMutations:g},S);var I=o("WAWebCurrentUser").isEmployee()?R.getAction():"-";o("WALogger").LOG(fe||(fe=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: after apply mutation batch for "," v",", mutations count: ",", handler: "," ",""])),a,e,l,L.length,I,u),S&&(yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,"["+a+"] after apply group "+v+"/"+C.length+" for "+e+" "+(l!=null?l:"")+". result length: "+E.length))}catch(t){if(t instanceof o("WAWebSyncdError").SyncdFatalError||e===o("WASyncdConst").CollectionName.CriticalBlock)throw t;k=!0,o("WALogger").WARN(ge||(ge=babelHelpers.taggedTemplateLiteralLoose(["syncd: catching error during _applySetMutations: ",""])),t)}o("WALogger").DEV(he||(he=babelHelpers.taggedTemplateLiteralLoose(["syncd: actionStates after apply ",": ",""])),u,E.slice(0,100).map(function(e){return e.actionState})),o("WALogger").LOG(ye||(ye=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: after apply mutation batch for "," ",""])),a,e,u);for(var T=0;T<C[v].length;T++){var D,x,$=k?o("WASyncdConst").SyncActionState.Failed:E[T].actionState;c.push(o("WAWebSyncdCollectionHandlerTypesConverter").setMutationToSyncAction(C[v][T],$,C[v][T].actionName,k||(D=E[T].orphanModel)==null?void 0:D.modelId,k||(x=E[T].orphanModel)==null?void 0:x.modelType))}}var P=b,N=P==null?null:o("WATimeUtils").daysDiff(o("WATimeUtils").unixTimeMs(),P);o("WALogger").LOG(Ce||(Ce=babelHelpers.taggedTemplateLiteralLoose(["syncd: max timestamp from recent patch: "," days agp"])),N!=null?N:"n/a"),s&&(yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,a+" max timestamp from recent patch: "+(N!=null?N:"n/a")+" days ago"));var M=c.reduce(function(e,t){var n=t.actionState;return e[n]==null&&(e[n]=0),e[n]++,e},{});return i==null||i.mark("apply_set_mutations_end",babelHelpers.extends({source:n,collectionName:e,count:g.length},M)),o("WAWebSyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(o("WAWebSyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.APPLIED_MUTATIONS),e===o("WASyncdConst").CollectionName.CriticalBlock&&(yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,a+" apply states for "+e+" v"+(l!=null?l:"n/a")+": "+c.map(function(e){return e.actionState}).join(", "))),o("WALogger").LOG(be||(be=babelHelpers.taggedTemplateLiteralLoose([""," syncd: completed apply set mutations for "," ",""])),a,e,u),{setMutationsToPersist:c,pendingSetMutationsToDrop:h}}),et.apply(this,arguments)}function tt(e,t,n){return nt.apply(this,arguments)}function nt(){return nt=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=rt(t),a=r.supportedMutations,i=it(a),l=new Set(t.map(function(e){return e.index})),s=(yield o("WAWebGetPendingMutation").getSyncPendingMutationsByCollectionInTransaction(e)).filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE&&l.has(e.index)}).map(function(e){return e.id}).filter(Boolean);o("WALogger").LOG(ve||(ve=babelHelpers.taggedTemplateLiteralLoose([""," syncd: before apply remove mutations for ",""])),n,e);for(var u=0;u<i.length;u++){var c=i[u][0].actionHandler;yield c.applyMutations(i[u].map(function(t){return{operation:"remove",indexParts:lt(e,t.index)}}),{setMutationsPendingToPersist:[],allSupportedSetMutations:[]})}return o("WALogger").LOG(Se||(Se=babelHelpers.taggedTemplateLiteralLoose([""," syncd: after apply remove mutations for ",""])),n,e),yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(e,n+" after apply remove mutations for "+e+". mutation count: "+t.length),{pendingRemoveMutationsToDrop:s}}),nt.apply(this,arguments)}function rt(t){var n=t.map(function(t){if(t.version>o("WAWebSyncdGetActionHandler").maxSupportedVersion())return{unsupported:t};var n=lt(t.collection,t.index),r=o("WASyncdConst").Actions.cast(n[0]);if(!r)return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: invalid action ",""])),n[0]),{unsupported:t};var a=o("WAWebSyncdGetActionHandler").getActionHandler(r);if(!a)return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: no handler for action ",""])),r),{unsupported:t};var i={collection:t.collection,index:t.index,indexMac:t.indexMac,keyId:t.keyId,binarySyncData:t.binarySyncData,valueMac:t.valueMac,version:t.version,indexArr:n,actionName:r,actionHandler:a};return{supported:i}}),r=[],a=[];return n.map(function(e){var t=e.supported,n=e.unsupported;t!=null?r.push(t):n!=null&&a.push(n)}),{supportedMutations:r,unsupportedMutations:a}}function ot(e){var t=e.filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET}),n=new Set(t.map(function(e){return e.index})),r=e.filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE});return r.forEach(function(e){n.has(e.index)||t.push(e)}),t}function at(e,t){var n=t.map(function(t){if(t.version>o("WAWebSyncdGetActionHandler").maxSupportedVersion())return{unsupported:t};var n=lt(e,t.index),r=o("WASyncdConst").Actions.cast(n[0]);if(!r)return o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: invalid action ",""])),n[0]),{unsupported:t};var a=o("WAWebSyncdGetActionHandler").getActionHandler(r);return a?{supported:{collection:t.collection,index:t.index,indexMac:t.indexMac,keyId:t.keyId,timestamp:t.timestamp,binarySyncData:t.binarySyncData,valueMac:t.valueMac,version:t.version,indexArr:n,actionName:r,actionHandler:a}}:(o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["syncd: no handler for action ",""])),r),{unsupported:t})}),r=[],a=[];return n.map(function(e){var t=e.supported,n=e.unsupported;t!=null?r.push(t):n!=null&&a.push(n)}),{supportedMutations:r,unsupportedMutations:a}}function it(e){return e.reduce(function(e,t){return e.length!==0&&t.actionName===e[e.length-1][0].actionName?e[e.length-1].push(t):e.push([t]),e},[])}function lt(e,t){try{var n=JSON.parse(t);if(n.length<1)throw r("err")("");return n}catch(t){throw o("WAWebSyncdMetricFatalError").reportSyncdFatalError(o("WAWebSyncdMetricFatalError").SyncdFatalErrorType.INVALID_ACTION_INDEX,{collection:e}),new(o("WAWebSyncdError")).SyncdFatalError("invalid action index")}}function st(e,t,n,r,o){return ut.apply(this,arguments)}function ut(){return ut=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,o){var a=yield r.get(e);if(a!=null&&a.version>=t)return"["+o+"] syncd: processing old version for "+e+". processing: "+t+" already persisted: "+a.version+". context: "+n}),ut.apply(this,arguments)}l.applyIndividualMutations=De,l.applyAppStateSyncResponse=$e}),98);
__d("WAWebSyncdDecryptMutationsWrapper",["Promise","WALogger","WATextEncoding","WAWebEncryptionManagerSelector","WAWebProtobufsServerSync.pb","WAWebSyncdDbCallbacksApi","WAWebSyncdError","WAWebSyncdKeyCache","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=o("WATextEncoding").newTextDecoder();function c(e,t){return(s||(s=n("Promise"))).all(t.records.map(function(t){return m(e,o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET,t)}))}function d(e,t){return(s||(s=n("Promise"))).all(t.mutations.map(function(t){return m(e,t.operation,t.record)}))}function m(e,t,n){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){var a=o("WAWebEncryptionManagerSelector").syncdEncryptionManager().decryptMutation,i=r.keyId.id,l=yield o("WAWebSyncdKeyCache").getKeyData(i);if(!l)throw n===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE?(yield o("WAWebSyncdDbCallbacksApi").writeSyncdLog(t,"exception: no key data for remove mutations"),new(o("WAWebSyncdError")).SyncdFatalError("no key data for remove mutations")):new(o("WAWebSyncdError")).SyncdMissingKeyError;try{var s=yield a(t,i,l,n,r),c=s.index,d=s.version,m=s.indexMac,p=s.valueMac,_=s.plaintext;return{index:u.decode(c),action:null,version:d,keyId:i,operation:n,indexMac:m,valueMac:p,collection:t,binarySyncData:_}}catch(t){var f=t instanceof Error?t.message:String(t);throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: decryption failed: ",""])),f).sendLogs("syncd: decryption failed"),t}}),p.apply(this,arguments)}l.tryDecryptSnapshot=c,l.tryDecryptPatch=d}),98);
__d("WAWebSyncdMMSDownload",["WAWebSyncdDecode","WAWebSyncdNetCallbacksApi","WAWebSyncdValidateServerSyncProtobuf","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WAWebSyncdNetCallbacksApi").downloadSyncBlob(t,"snapshot",e),a=o("WAWebSyncdDecode").decodeSyncdSnapshot(e,n);return r("WAWebSyncdValidateServerSyncProtobuf").validateSnapshotProtobuf(e,a)}),s.apply(this,arguments)}function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WAWebSyncdNetCallbacksApi").downloadSyncBlob(t,"patch",e),a=o("WAWebSyncdDecode").decodeSyncdMutations(e,n).mutations;return a.map(function(t){return r("WAWebSyncdValidateServerSyncProtobuf").validateMutationProtobuf(e,t)})}),c.apply(this,arguments)}l.downloadSnapshot=e,l.downloadExternalPatch=u}),98);
__d("WAWebKeyManagementSendKeyRequestApi",["Promise","WALogger","WASyncdKeyTypes","WAWebApiPeerMessageStore","WAWebKeyManagementUtils","WAWebMsgKey","WAWebMsgType","WAWebSendAppStateSyncMsgJob","WAWebSyncdCriticalBootstrapProcessingApi","WAWebSyncdCryptoUtils","WAWebUserPrefsMeUser","WAWebWamEnumBootstrapAppStateDataStageCode","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=yield o("WAWebKeyManagementUtils").getPeerDevices(),i=t.map(function(e){return{keyId:o("WASyncdKeyTypes").fromSyncKeyId(e)}}),l={keyIds:i},u=a.map(function(e){var t=new(r("WAWebMsgKey"))({fromMe:!0,remote:o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),id:r("WAWebMsgKey").newId_DEPRECATED()});return{id:t,to:e,type:"protocol",subtype:"app_state_sync_key_request",kind:o("WAWebMsgType").MsgKind.PeerMessage,appStateSyncKeyRequest:l}}),c=a.map(function(e){return e.getDeviceId()}),d=t.map(function(e){return o("WAWebSyncdCryptoUtils").syncKeyIdToHex(e)});return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: send key request key id "," to peer deviceIds ",""])),d,c),yield o("WAWebApiPeerMessageStore").storePeerMessages(u),yield(s||(s=n("Promise"))).all(u.map(function(e){return o("WAWebSendAppStateSyncMsgJob").encryptAndSendKeyMsg({msg:e})})),o("WAWebSyncdCriticalBootstrapProcessingApi").logCriticalBootstrapStageIfNecessary(o("WAWebWamEnumBootstrapAppStateDataStageCode").BOOTSTRAP_APP_STATE_DATA_STAGE_CODE.MISSING_KEYS_REQUESTED),c}),c.apply(this,arguments)}l.sendAppStateSyncKeyRequest=u}),98);
__d("WAWebKeyManagementSendKeyShareApi",["Promise","WALogger","WASyncdKeyTypes","WAWebApiPeerMessageStore","WAWebKeyManagementUtils","WAWebMsgKey","WAWebMsgType","WAWebSendAppStateSyncMsgJob","WAWebSyncdCryptoUtils","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a,i;if(t.type==="key_rotation"?(a=d(t.keys),i=yield o("WAWebKeyManagementUtils").getPeerDevices()):t.type==="missing_key"&&(a=d(t.keys,t.orphanKeys),i=[t.peerDeviceId]),i==null)return(s||(s=n("Promise"))).resolve();var l=i,u=l.map(function(e){var t=new(r("WAWebMsgKey"))({fromMe:!0,remote:o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),id:r("WAWebMsgKey").newId_DEPRECATED()});return{id:t,to:e,type:"protocol",subtype:"app_state_sync_key_share",kind:o("WAWebMsgType").MsgKind.PeerMessage,appStateSyncKeyShare:a}}),c=l.map(function(e){return e.getDeviceId()}),m=t.keys.map(function(e){return o("WAWebSyncdCryptoUtils").syncKeyIdToHex(e.keyId)});o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: send key share key id "," to peer deviceIds "," due to ",""])),m,c,t.type),yield o("WAWebApiPeerMessageStore").storePeerMessages(u),yield(s||(s=n("Promise"))).all(u.map(function(e){return o("WAWebSendAppStateSyncMsgJob").encryptAndSendKeyMsg({msg:e})}))}),c.apply(this,arguments)}function d(e,t){var n=e.map(function(e){return{keyId:{keyId:o("WASyncdKeyTypes").fromSyncKeyId(e.keyId)},keyData:{keyData:o("WASyncdKeyTypes").fromSyncKeyData(e.keyData),fingerprint:{rawId:e.fingerprint.rawId,currentIndex:e.fingerprint.currentIndex,deviceIndexes:e.fingerprint.deviceIndexes},timestamp:e.timestamp}}});if(t){var r=t.map(function(e){return{keyId:{keyId:o("WASyncdKeyTypes").fromSyncKeyId(e)},keyData:void 0}});n=n.concat(r)}return{keys:n}}l.sendAppStateSyncKeyShare=u}),98);
__d("WAWebSyncdHandleMissingKeys",["Promise","WALogger","WASyncdKeyTypes","WAWebGetMissingKey","WAWebGetSyncKey","WAWebOfflineHandler","WAWebSyncdCryptoUtils","WAWebSyncdError","WAWebSyncdKeyCallbacksApi","WAWebSyncdStoreMissingKeys","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f=o("WASyncdKeyTypes").toSyncKeyId(new ArrayBuffer(0));function g(e,t){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r=new Set,a=(yield o("WAWebGetSyncKey").getAllSyncKeysInTransaction()).map(function(e){return o("WAWebSyncdCryptoUtils").syncKeyIdToHex(e.keyId)});n.records.forEach(function(e){var t=e.keyId.id;if(o("WAWebSyncdCryptoUtils").syncKeyIdsEqual(t,f))throw new(o("WAWebSyncdError")).SyncdFatalError("snapshot has empty key");var n=o("WAWebSyncdCryptoUtils").syncKeyIdToHex(t);a.includes(n)||r.add(n)}),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection ","'s snapshot has missing keys ",""])),t,Array.from(r)),yield b(r)}),h.apply(this,arguments)}function y(e,t){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=new Set,r=(yield o("WAWebGetSyncKey").getAllSyncKeysInTransaction()).map(function(e){return o("WAWebSyncdCryptoUtils").syncKeyIdToHex(e.keyId)});t.forEach(function(e){var t=e.keyId.id;if(o("WAWebSyncdCryptoUtils").syncKeyIdsEqual(t,f))throw new(o("WAWebSyncdError")).SyncdFatalError("syncd: patch has empty key. patch device id: ${p.deviceIndex}");var a=o("WAWebSyncdCryptoUtils").syncKeyIdToHex(t);r.includes(a)||(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: handleMissingKeysInPatches: missing key: keyId: ",", patch version: ",", patch device id: ",""])),a,e.version.version,e.deviceIndex),n.add(a))}),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection ","'s patches has missing keys ",""])),e,Array.from(n)),yield b(n)}),C.apply(this,arguments)}function b(e){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebOfflineHandler").OfflineMessageHandler.isResumeFromRestartComplete()?"idle":"processing";if(t!=="idle"){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["syncd: _handleMissingKeys: skipping due to resume from restart in progress"])));return}var r=Array.from(e);o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["syncd: _handleMissingKeys: missing keys [","]"])),r);var a=new Set((yield o("WAWebGetMissingKey").bulkGetMissingKeysInTransaction(r)).filter(Boolean).map(function(e){return e.keyHex})),i=r.filter(function(e){return!a.has(e)});if(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: _handleMissingKeys: missing keys after filter: [","]"])),i),i.length===0)return(_||(_=n("Promise"))).resolve();var l=i.map(function(e){return o("WASyncdKeyTypes").toSyncKeyId(o("WAWebSyncdCryptoUtils").hexToUint8Array(e).buffer)}),s=yield o("WAWebSyncdKeyCallbacksApi").sendSyncdKeyRequest(l);yield o("WAWebSyncdStoreMissingKeys").addMissingKeys(l,s)}),v.apply(this,arguments)}function S(){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebGetMissingKey").getAllMissingKeysInTransaction();o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["syncd: requestAllMissingKeys: missing keys: [","]"])),e.map(function(e){return e.keyHex})),e.length!==0&&(yield o("WAWebSyncdKeyCallbacksApi").sendSyncdKeyRequest(e.map(function(e){return e.keyId})))}),R.apply(this,arguments)}l.handleMissingKeysInSnapshot=g,l.handleMissingKeysInPatches=y,l.requestAllMissingKeys=S}),98);
__d("WAWebSyncdRotateKey",["WAArrayBuffersConcat","WABaseGlobals","WAByteArray","WACryptoDependencies","WAJids","WASyncdKeyManagementUtils","WASyncdKeyTypes","WATimeUtils","WAWebSyncdGatingUtils","equalsSet"],(function(t,n,r,o,a,i,l){"use strict";var e=1,s=90;function u(t){var n=t.timestamp,r=Math.min(s,Math.max(e,o("WAWebSyncdGatingUtils").getSyncdKeyMaxUseDays())),a=r*o("WATimeUtils").DAY_MILLISECONDS,i=o("WATimeUtils").unixTimeMs()-n;return i>a}function c(e,t){for(var n=e.fingerprint,o=t.rawId,a=t.currentIndex,i=t.deviceIndexes,l=new Set(n.deviceIndexes),s=n.currentIndex+1;s<=a;s++)l.add(s);return n.rawId!==o||!r("equalsSet")(l,new Set(i))}function d(e,t){var n=m(t),r=n.keyId,a=n.keyEpoch,i=p(),l=o("WATimeUtils").unixTimeMs();return{keyId:r,keyEpoch:a,keyData:i,fingerprint:e,timestamp:l}}function m(e){var t;if(e==null){var n=new Uint8Array(16);o("WACryptoDependencies").getCrypto().getRandomValues(n),t=o("WASyncdKeyManagementUtils").generateNewKeyEpoch(o("WASyncdKeyTypes").toSyncKeyId(n.buffer))}else t=o("WASyncdKeyManagementUtils").generateNewKeyEpoch(e.keyId);var r=o("WAJids").interpretAsNumber(o("WAJids").extractDeviceId(o("WABaseGlobals").getMyDeviceJid()));return{keyId:o("WASyncdKeyTypes").toSyncKeyId(new Uint8Array(o("WAArrayBuffersConcat").concatArrayBuffers(o("WAByteArray").intToBytes(2,r).buffer,o("WAByteArray").intToBytes(4,t).buffer)).buffer),keyEpoch:t}}function p(){return o("WASyncdKeyTypes").toSyncKeyData(o("WACryptoDependencies").getCrypto().getRandomValues(new Uint8Array(32)).buffer)}l.hasKeyExpired=u,l.hasADeviceBeenRemoved=c,l.rotateKey=d}),98);
__d("WAWebSyncdKeyManagement",["WALogger","WAPromiseQueue","WASyncdKeyManagementUtils","WAWebGetSyncKey","WAWebSyncdCryptoUtils","WAWebSyncdKeyCallbacksApi","WAWebSyncdMetrics","WAWebSyncdRotateKey","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=new(o("WAPromiseQueue")).PromiseQueue;function m(e){return e===void 0&&(e=!0),d.enqueue(function(){return p(e)})}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){t===void 0&&(t=!0);var n=yield f(),a=yield o("WAWebSyncdKeyCallbacksApi").getDeviceFingerprint(),i=!1,l=!1;if(n!=null){if(i=o("WAWebSyncdRotateKey").hasKeyExpired(n),l=o("WAWebSyncdRotateKey").hasADeviceBeenRemoved(n,a),!t||!i&&!l)return{keyId:n.keyId,keyData:n.keyData}}else throw r("err")("syncd: No sync key available");var d=o("WAWebSyncdRotateKey").rotateKey(a,n);return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: stored key rotation key id ",""])),o("WAWebSyncdCryptoUtils").syncKeyIdToHex(d.keyId)),yield o("WAWebGetSyncKey").setSyncKeyInTransaction(d),yield o("WAWebSyncdKeyCallbacksApi").sendSyncdKeyRotation([d]),i&&(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: key rotation due to key expiry"]))),o("WAWebSyncdMetrics").reportSyncdKeyRotationEvent(o("WAWebSyncdMetrics").SyncdKeyRotationEventType.APP_STATE_SYNC_KEY_EXPIRY)),l&&(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: key rotation due to device removal"]))),o("WAWebSyncdMetrics").reportSyncdKeyRotationEvent(o("WAWebSyncdMetrics").SyncdKeyRotationEventType.DEVICE_DEREGISTERATION)),n==null&&(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["syncd: key rotation due to no key present"]))),o("WAWebSyncdMetrics").reportSyncdKeyRotationEvent(o("WAWebSyncdMetrics").SyncdKeyRotationEventType.NO_KEYS)),p(t)}),_.apply(this,arguments)}function f(){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebGetSyncKey").getAllSyncKeysInTransaction();if(e.length===0)return null;var t=e.map(function(e){return o("WASyncdKeyManagementUtils").getKeyEpoch(e.keyId)}),n=Math.max.apply(Math,t),r=e.filter(function(e){return o("WASyncdKeyManagementUtils").getKeyEpoch(e.keyId)===n}),a=r.map(function(e){return o("WASyncdKeyManagementUtils").getKeyDeviceId(e.keyId)}),i=Math.min.apply(Math,a),l=a.indexOf(i);return r[l]}),g.apply(this,arguments)}l.getActiveKey=m,l.getNewestKeyPair=f}),98);
__d("WAWebSyncdRequestBuilderUtils",[],(function(t,n,r,o,a,i){"use strict";function e(e){return l(e.reverse(),function(e){return e.index}).reverse()}function l(e,t){var n=new Set;return e.filter(function(e){var r=t(e);return n.has(r)?!1:(n.add(r),!0)})}i.compactPatch=e}),66);
__d("WAWebSyncdRequestBuilder",["Promise","WAWebGetPendingMutation","WAWebSyncdRequestBuilderBuild","WAWebSyncdRequestBuilderUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){var a=new Map,i=new Map;yield(e||(e=n("Promise"))).all(t.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebGetPendingMutation").getSyncPendingMutationsByCollectionInTransaction(e),n=t.map(function(e){return e.id}).filter(Boolean);i.set(e,n);var r=o("WAWebSyncdRequestBuilderUtils").compactPatch(t);a.set(e,r)});return function(t){return e.apply(this,arguments)}})()));var l=yield o("WAWebSyncdRequestBuilderBuild").buildSyncIqNode(a,r);return{syncIqNode:l.syncIqNode,collectionWithPendingMutationsIds:i,collectionWithEncryptedMutations:l.collectionWithEncryptedMutations,localCollectionVersions:l.localCollectionVersions,collectionsToSkip:l.collectionsToSkip}}),u.apply(this,arguments)}l.default=s}),98);
__d("WAWebSyncdEncryptMutationsWrapper",["WALogger","WAWebEncryptionManagerSelector","WAWebGetSyncAction","WAWebProtobufsServerSync.pb","WAWebSyncdCrypto","WAWebSyncdError","WAWebSyncdKeyCache","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r=o("WAWebEncryptionManagerSelector").syncdEncryptionManager().encryptMutation,a=t.index,i=t.operation,l=n.keyId,s=n.keyData,u;switch(i){case o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET:break;case o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE:{if(u=yield o("WAWebGetSyncAction").getSyncActionInTransaction(a),!u)throw new(o("WAWebSyncdError")).SyncdFatalError("no corresponding set mutation");var c=u.keyId,d=yield o("WAWebSyncdKeyCache").getKeyData(c);if(d==null)throw new(o("WAWebSyncdError")).SyncdFatalError("no key data for corresponding mutation");l=c,s=d}}try{var m=yield r(t,l,s),p=m.indexMac,_=m.indexAndValueCipherText,f=o("WAWebSyncdCrypto").valueMacFromIndexAndValueCipherText(_);return babelHelpers.extends({},t,{keyId:l,keyData:s,indexMac:p,indexAndValueCipherText:_,valueMac:f})}catch(t){var g=t instanceof Error?t.message:String(t);throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: encryption failed: ",""])),g).sendLogs("syncd: encryption failed"),t}}),u.apply(this,arguments)}l.encryptMutation=s}),98);
__d("WAWebSyncdMMSUpload",["WAWebSyncdGatingUtils"],(function(t,n,r,o,a,i,l){"use strict";var e=100,s=2e3,u=10,c=100;function d(t){var n=Math.min(s,Math.max(o("WAWebSyncdGatingUtils").getSyncdInlineMutationsMaxCount(),e));return t.length>n}function m(e){var t=Math.min(c,Math.max(o("WAWebSyncdGatingUtils").getSyncdPatchProtobufMaxSize(),u))*1e3;return e.byteLength>t}l.exceedInlineMutationCount=d,l.exceedPatchProtobufSize=m}),98);
__d("WAWebSyncdRequestBuilderBuild",["Promise","WABase64","WABaseGlobals","WAJids","WALogger","WAMediaCalculateFilehash","WASyncdConst","WASyncdKeyManagementUtils","WASyncdKeyTypes","WAWap","WAWebABProps","WAWebBrokerGlobalAppState","WAWebGetCollectionVersion","WAWebGetSyncAction","WAWebProtobufSyncAction.pb","WAWebProtobufsServerSync.pb","WAWebSyncdAntiTampering","WAWebSyncdCryptoUtils","WAWebSyncdEncryptMutationsWrapper","WAWebSyncdKeyManagement","WAWebSyncdMMSUpload","WAWebSyncdNetCallbacksApi","WAWebSyncdRequestBuilderTypesConverter","WAWebSyncdRequestEncode","WAWebSyncdUtils","WAWebSyncdWamAppState","asyncToGeneratorRuntime","encodeProtobuf","sortBy"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=5;function m(e,t){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield f(e,t),r=n.collectionNodes,a=n.collectionWithEncryptedMutations,i=n.localCollectionVersions,l=n.collectionsToSkip,s=_(o("WAWap").wap("sync",null,r));return{syncIqNode:s,collectionWithEncryptedMutations:a,localCollectionVersions:i,collectionsToSkip:l}}),p.apply(this,arguments)}function _(e){return o("WAWap").wap("iq",{id:o("WAWap").generateId(),to:o("WAWap").S_WHATSAPP_NET,type:"set",xmlns:"w:sync:app:state"},e)}function f(e,t){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncd: start _buildCollectionNodes"])));var a=[],i=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WAWebGetCollectionVersion").getCollectionVersionInTransaction(e).then(function(e){return e==null?void 0:e.version}),i,l;if(t!=null&&t.length>0)if(n==null)o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: skipping "," in sync iq patch because initial full sync\n        is incomplete"])),e),a.push(e);else{var u=yield h(e,t,r),c=u.patchNode,d=u.encryptedMutations;i=c,l=d}return{collection:e,version:n,patchNode:i,encryptedMutations:l}});return function(n,r){return e.apply(this,arguments)}})(),l=new Map,d=new Map,m=[];t.forEach(function(e,t){return m.push(i(t,e))});var p=yield(c||(c=n("Promise"))).all(m),_=p.map(function(e){var t=e.collection,n=e.version,r=e.patchNode,a=e.encryptedMutations;return a&&d.set(t,a),l.set(t,n),o("WAWap").wap("collection",{name:o("WAWap").CUSTOM_STRING(t),return_snapshot:n===void 0?"true":"false",version:o("WAWap").INT(n!=null?n:o("WASyncdConst").DEFAULT_COLLECTION_VERSION)},r)});return o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: end _buildCollectionNodes"]))),{collectionNodes:_,collectionWithEncryptedMutations:d,localCollectionVersions:l,collectionsToSkip:a}}),g.apply(this,arguments)}function h(e,t,n){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){var a=yield o("WAWebSyncdKeyManagement").getActiveKey(!C(t)),i=yield k(e,t,a),l=i.map(function(e){return o("WAWebSyncdEncryptMutationsWrapper").encryptMutation(e,a)}),s=yield(c||(c=n("Promise"))).all(l),u=s.map(function(e){return{indexMac:e.indexMac,valueMac:e.valueMac,operation:e.operation}}),d=yield o("WAWebSyncdAntiTampering").computeLtHash(e,u,r),m=d.ltHash,p=yield o("WAWebSyncdAntiTampering").computeOutgoingSnapshotAndPatchMacs(e,m,s,a.keyData),_=p.snapshotMac,f=p.patchMac;s.map(function(e){e.patchMac=f});var g=s.map(function(e){return E(e.keyId,e.operation,e.indexMac,e.indexAndValueCipherText)}),h=L(g),y=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebSyncdNetCallbacksApi").uploadSyncExternalPatch(h),t=yield b(e,h);return S(t,a.keyId,_,f)});return function(){return e.apply(this,arguments)}})(),v;o("WAWebSyncdMMSUpload").exceedInlineMutationCount(g)?v=yield y():(v=R(g,a.keyId,_,f),o("WAWebSyncdMMSUpload").exceedPatchProtobufSize(v)&&(v=yield y()));var I=o("WAWap").wap("patch",null,v);return{patchNode:I,encryptedMutations:s}}),y.apply(this,arguments)}function C(e){return r("WAWebBrokerGlobalAppState").isLogoutInProgress&&e.some(function(e){return o("WAWebSyncdUtils").getMutationNameFromIndex(e.index)===o("WASyncdConst").Actions.Sentinel})}function b(e,t){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=e.mediaKey,r=e.directPath,a=e.encFilehash,i=e.handle,l=yield o("WAMediaCalculateFilehash").calculateFilehash(t);return{mediaKey:n,directPath:r,handle:i,fileSizeBytes:t.byteLength,fileSha256:o("WABase64").decodeB64(l),fileEncSha256:a}}),v.apply(this,arguments)}function S(e,t,n,r){var a=o("WAJids").extractDeviceId(o("WABaseGlobals").getMyDeviceJid());return o("WAWebSyncdRequestEncode").encodeSyncdPatch({keyId:{id:o("WASyncdKeyTypes").fromSyncKeyId(t)},externalMutations:e,snapshotMac:n,patchMac:r,deviceIndex:a})}function R(e,t,n,r){var a=o("WAJids").extractDeviceId(o("WABaseGlobals").getMyDeviceJid()),i=o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufSyncAction.pb").PatchDebugDataSpec,{isSenderPrimary:!1,senderPlatform:o("WAWebProtobufSyncAction.pb").PatchDebugData$Platform.WEB}).readBuffer();return o("WAWebSyncdRequestEncode").encodeSyncdPatch({keyId:{id:o("WASyncdKeyTypes").fromSyncKeyId(t)},mutations:e,snapshotMac:n,patchMac:r,deviceIndex:a,clientDebugData:i})}function L(e){return o("WAWebSyncdRequestEncode").encodeSyncdMutations({mutations:e})}function E(e,t,n,r){return{operation:t,record:{keyId:{id:o("WASyncdKeyTypes").fromSyncKeyId(e)},index:{blob:n},value:{blob:r}}}}function k(e,t,n){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield o("WAWebGetSyncAction").getSyncActionsByCollectionsInTransaction([e]),a=t,i=T(r,t,n.keyId);a=a.concat(i);var l=D(r,a,n.keyId);return o("WAWebSyncdWamAppState").addKeyRotationRemoveCount(l.length),a=a.concat(l),a}),I.apply(this,arguments)}function T(e,t,n){var a=e.filter(function(e){return!t.map(function(e){return e.index}).includes(e.index)&&!o("WAWebSyncdCryptoUtils").syncKeyIdsEqual(e.keyId,n)});a=r("sortBy")(a,function(e){return o("WASyncdKeyManagementUtils").getKeyEpoch(e.keyId)});var i=Math.min(d,o("WAWebABProps").getABPropConfigValue("syncd_additional_mutations_count"));return a=a.slice(0,i),o("WAWebSyncdRequestBuilderTypesConverter").syncActionsToPendingMutations(a,o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET)}function D(e,t,n){var r=t.filter(function(e){return e.operation===o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET}).map(function(e){return e.index}),a=e.filter(function(e){return r.includes(e.index)}),i=a.filter(function(e){return!o("WAWebSyncdCryptoUtils").syncKeyIdsEqual(e.keyId,n)});return o("WAWebSyncdRequestBuilderTypesConverter").syncActionsToPendingMutations(i,o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.REMOVE)}l.buildSyncIqNode=m,l._generateMutationsToUpload=k}),98);
__d("WAWebSyncdUploadFatalErrorMetric",["WATimeUtils","WAWebABProps","WAWebAppTracker","WAWebMdFatalErrorWamEvent","WAWebProtobufSyncAction.pb","WAWebSchemaSyncActions","WAWebSyncBootstrap","WAWebSyncdCollectionsStateMachine","WAWebSyncdUtils","WAWebUserPrefsAppStateSync","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime","decodeProtobuf"],(function(t,n,r,o,a,i,l){var e=o("WATimeUtils").unixTime();function s(e,t,n,r,o,a,i,l,s,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x,$){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a,i,l,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x,$,P,N){var M={mdFatalErrorCode:t,collection:n?o("WAWebSyncdUtils").collectionNameToMetric(n):void 0,isBootstrap:r("WAWebSyncBootstrap").isSyncDCriticalDataSyncInProcess()},w=o("WAWebUserPrefsMultiDevice").getPairingTimestamp(),A=w!=null?(o("WATimeUtils").unixTime()-w)*1e3:void 0;if(M=babelHelpers.extends({},M,{timeSinceRefreshMs:(o("WATimeUtils").unixTime()-e)*1e3,timeSincePairingMs:A,patchSnapshotMutationCount:a,patchVersion:i,isFatal:l,isWebLthashConsistent:s,macFatalCollectionNameMismatch:u,macFatalCurrentLthashMismatch:c,macFatalNewLthashMismatch:d,macFatalPatchVersionMismatch:m,macFatalNewLthashSubtractMismatch:p,macFatalNumberHasOverrideMutation:_,macFatalNumberNumAddMutation:f,macFatalNumberNumRemoveMutation:g,macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:h,isPatchSenderPrimary:y,macFatalDidUseMacFetchFallback:C,macFatalHasMissingRemove:b,macFatalNumberAddMismatch:v,macFatalNumberRemoveMismatch:S,macFatalDidPreviousPatchFailPostSaveValidation:R,macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash:L,isPreviousPatchAnIncomingPatch:E,isPreviousPatchSenderPrimary:k,isSenderIndexSameAsPreviousSenderIndex:I,didBootstrapFromSnapshot:T,isThereAnotherSyncdCompanion:D,isPureSyncdSession:x,lidMigrationStage:$,recoveryRequestDurationMs:P,recoveryStatus:N}),M=babelHelpers.extends({},M,{appContext:o("WAWebAppTracker").AppTracker.getAppContext()}),o("WAWebABProps").getABPropConfigValue("web_syncd_fatal_fields_from_L1104589PRV2")){var F=yield o("WAWebUserPrefsMultiDevice").getRecentMailboxAgeDays(),O=yield o("WAWebUserPrefsAppStateSync").getLastPeriodicAppStateSyncTs(),B=r("WAWebSyncdCollectionsStateMachine").getCollectionMinFailureTime();M=babelHelpers.extends({},M,{mailboxAgeDays:F==null?void 0:F,daysSinceLastPeriodicSync:O==null?void 0:Math.trunc((o("WATimeUtils").unixTime()-O)/60/60/24),hoursSinceFirstFiniteFailure:B==null?void 0:Math.trunc((o("WATimeUtils").unixTimeMs()-B)/1e3/60/60)});var W=yield o("WAWebSchemaSyncActions").getSyncActionsTable().get('["primary_version","current"]'),q=yield o("WAWebSchemaSyncActions").getSyncActionsTable().get('["primary_version","session_start"]');if(W||q){var U,V,H,G,z=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,W==null?void 0:W.binarySyncData).value,j=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,q==null?void 0:q.binarySyncData).value;M=babelHelpers.extends({},M,{currentPrimaryAppVersion:(U=z==null||(V=z.primaryVersionAction)==null?void 0:V.version)!=null?U:void 0,sessionStartPrimaryAppVersion:(H=j==null||(G=j.primaryVersionAction)==null?void 0:G.version)!=null?H:void 0})}}yield new(o("WAWebMdFatalErrorWamEvent")).MdFatalErrorWamEvent(M).commitAndWaitForFlush(!0)}),u.apply(this,arguments)}l.uploadFatalErrorMetric=s}),98);
__d("WAWebRequestSyncdSnapshotRecovery",["Promise","WALogger","WANullthrows","WAPromiseTimeout","WAResolvable","WASyncdConst","WASyncdKeyTypes","WATextEncoding","WATimeUtils","WAWebProtobufSyncAction.pb","WAWebProtobufsE2E.pb","WAWebProtobufsServerSync.pb","WAWebSendNonMessageDataRequest","WAWebSyncdCrypto","WAWebSyncdKeyCache","asyncToGeneratorRuntime","encodeProtobuf","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m=o("WATextEncoding").newTextDecoder(),p=6e4,_=(function(){function t(){this.recoveryPromise=new Map,this.recoveryInflight=null}var a=t.prototype;return a.requestRecoveryWithTimeout=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){try{var n=yield o("WAPromiseTimeout").promiseTimeout(this.requestRecoveryFromPrimary(t),p);return n}catch(t){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[syncd recovery] error occured during recovery request ",""])),t),null}});function r(e){return t.apply(this,arguments)}return r})(),a.requestRecoveryFromPrimary=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=null;try{this.recoveryInflight!=null&&(yield this.recoveryInflight.promise),this.recoveryInflight=new(o("WAResolvable")).Resolvable,this.recoveryPromise.has(e)||this.recoveryPromise.set(e,new(o("WAResolvable")).Resolvable),yield o("WAWebSendNonMessageDataRequest").sendPeerDataOperationRequest(o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_SYNCD_SNAPSHOT_FATAL_RECOVERY,{collectionName:e,timestamp:o("WATimeUtils").unixTime()});var n=yield r("WANullthrows")(this.recoveryPromise.get(e)).promise;if(n==null||String(n==null?void 0:n.collectionName)!==String(e))throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[syncd recovery] Null response or collection name missmatch. Collection name: ",", expected: ",""])),n==null?void 0:n.collectionName,e),r("err")("syncd recovery: null or collection name missmatch");t=yield this.convertSyncdSnapshotRecoveryResponseToSnapshot(n)}catch(e){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[syncd recovery] error occured during response processing ",""])),e)}return this.recoveryInflight!=null&&this.recoveryInflight.resolve(),this.recoveryPromise.set(e,new(o("WAResolvable")).Resolvable),t});function t(t){return e.apply(this,arguments)}return t})(),a.convertSyncdSnapshotRecoveryResponseToSnapshot=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.mutationRecords,a=e.collectionName,i=e.collectionLthash,l=e.version;if(l==null)throw r("err")("syncd recovery: syncdVersion is null");var s=yield(d||(d=n("Promise"))).all(t.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.keyId,n=e.value,i=e.mac;if(n==null||t==null)throw r("err")("syncd recovery: unexpected null value in mutation record");var l=n.index,s=n.version;if(l==null||s==null||i==null)throw r("err")("syncd recovery: unexpected null value in mutation value");var u=null;try{u=yield o("WAWebSyncdKeyCache").getKeyData(o("WASyncdKeyTypes").toSyncKeyId(t))}catch(e){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[syncd recovery] error occured during key data retrieval. error: ",""])),e instanceof Error&&e.name).sendLogs("syncd-recovery-key-data-error")}var d=yield o("WAWebSyncdCrypto").generateEncryptionKeys(r("WANullthrows")(u)),p=d.indexKey,_=yield o("WAWebSyncdCrypto").generateIndexMac(r("WANullthrows")(p),r("WANullthrows")(l)),f=o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,n).readBuffer(),g=o("WASyncdConst").CollectionName.cast(a);if(g==null)throw r("err")("syncd recovery: invalid collection name");var h={index:m.decode(l),action:null,binarySyncData:f,operation:o("WAWebProtobufsServerSync.pb").SyncdMutation$SyncdOperation.SET,version:s,keyId:o("WASyncdKeyTypes").toSyncKeyId(t),indexMac:_,valueMac:i,collection:g};return h});return function(t){return e.apply(this,arguments)}})()));return{collectionLthash:r("WANullthrows")(i),version:Number(l.version),decryptedMutations:s}});function t(t){return e.apply(this,arguments)}return t})(),a.resolveRecoveryPromise=function(t,n){var e=this.recoveryPromise.get(t);e!=null&&e.resolve(n)},t})(),f=new _;l.SyncdSnapshotRecoveryModule=f}),98);
__d("WAWebApiPrivacyDisallowedList",["WALogger","WAWebSchemaPrivacyDisallowedList","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var t=yield o("WAWebSchemaPrivacyDisallowedList").getPrivacyDisallowedListTable().all();return c(t)}catch(t){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["privacy_settings_drawer: get all privacy disallowed lists failed"]))).verbose().devConsole(t).sendLogs("privacy_settings_drawer: get all privacy disallowed lists failed"),{about:null,groupadd:null,last:null,profile:null}}}),u.apply(this,arguments)}function c(e){var t={about:null,groupadd:null,last:null,profile:null};return e.forEach(function(e){switch(e.id){case o("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.About:t.about=e;return;case o("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.GroupAdd:t.groupadd=e;return;case o("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.LastSeen:t.last=e;return;case o("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.ProfilePicture:t.profile=e;return}}),t}l.queryDisallowedLists=s,l.disallowedRowsToLists=c}),98);
__d("WAWebApiPrivacyEphemerality",["WALogger","WAWebABProps","WAWebSchemaChat","WAWebSchemaGroupMetadata","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var t=yield o("WAWebSchemaChat").getChatTable().greaterThan(["ephemeralDuration"],0,{shouldDecrypt:!1}),n=t.length,r=t.filter(function(e){return e.disappearingModeInitiatedByMe===!0}).length,a=yield o("WAWebSchemaGroupMetadata").getGroupMetadataTable().greaterThan(["ephemeralDuration"],0),i=o("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_groups")?a.filter(function(e){return e.disappearingModeInitiatedByMe===!0}).length:0,l=r+i;return{isEphemeralMessagingUser:l>0,countEphemeralThreadsEnabledByMe:l,countEphemeralThreads:n}}catch(t){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["ephemerality_daily_logs: retrieving current ephemerality information failed"]))).verbose().devConsole(t).sendLogs("ephemerality_daily_logs: retrieving current ephemerality information failed"),{isEphemeralMessagingUser:null,countEphemeralThreadsEnabledByMe:null,countEphemeralThreads:null}}}),u.apply(this,arguments)}l.queryEphemeralityDailyLogInfo=s}),98);
__d("WAWebEstimateFtsStorageApi",["Promise","WALogger","WANullthrows","WAWebDbUsageApiUtils","WAWebIndexedDB","WAWebScanDbRowApi","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c="fts-storage",d=15e3;function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=t===void 0?{sampleRows:d}:t,i=a.sampleRows,l=Date.now(),m=i,p=r("WANullthrows")(r("WAWebIndexedDB")),_=yield o("WAWebDbUsageApiUtils").getDatabase(p,c),f=_.transaction(_.objectStoreNames,"readonly"),g=0,h=0,y=function*(t){var e=f.objectStore(t),n=yield o("WAWebDbUsageApiUtils").promisifyRequest(e.count());if(n===0)return 1;var r=Math.min(m,n);h=r;var a=0;yield o("WAWebDbUsageApiUtils").objectStoreIterator(e,function(e){return a+=o("WAWebScanDbRowApi").estimateSize(e,t),h--,h>0});var i=Math.round(a*(n/(r-h)));g+=i,o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Estimated FTS "," size: "," KB, fetched rows: ",""])),t,i/1e3,r-h)};for(var C of f.objectStoreNames)yield*y(C);var b=Date.now()-l;return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Estimated FTS size: "," KB, fetched rows: "," took: "," ms"])),g/1e3,h,b),(u||(u=n("Promise"))).resolve(g)}),p.apply(this,arguments)}l.getEstimatedFTSDbSize=m}),98);
__d("WAWebWamEnumLidMigrationSourceType",[],(function(t,n,r,o,a,i){var e=Object.freeze({PEER:1,HISTORY:2});i.LID_MIGRATION_SOURCE_TYPE=e}),66);
__d("WAWebLidMigrationDailyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumLidMigrationSourceType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({LidMigrationDaily:[5842,{completedMigrations:[1,e.TYPES.STRING],lidMigrationSource:[7,o("WAWebWamEnumLidMigrationSourceType").LID_MIGRATION_SOURCE_TYPE],numberOfChatsWithClientAssignedLid:[8,e.TYPES.INTEGER],numberOfDeprecatedChats:[9,e.TYPES.INTEGER],numberOfLidBroadcastLists:[10,e.TYPES.INTEGER],numberOfLidGroups:[11,e.TYPES.INTEGER],numberOfPnBroadcastLists:[12,e.TYPES.INTEGER],numberOfPnChatsWithoutMapping:[5,e.TYPES.INTEGER],numberOfPnGroups:[13,e.TYPES.INTEGER],numberOfPnhCtwaThreadsKnownMapping:[2,e.TYPES.INTEGER],numberOfPnhCtwaThreadsMissingMapping:[3,e.TYPES.INTEGER],numberOfSplitThreads:[4,e.TYPES.INTEGER],numberOfUserChatsWithoutAccountLid:[6,e.TYPES.INTEGER]},[1,1,1],"regular"]},{LidMigrationDaily:[]});l.LidMigrationDailyWamEvent=s}),98);
__d("WAWebWamEnumInAppNotificationAlertStyle",[],(function(t,n,r,o,a,i){var e=Object.freeze({NONE:1,BANNERS:2,ALERTS:3});i.IN_APP_NOTIFICATION_ALERT_STYLE=e}),66);
__d("WAWebWamEnumNotificationSoundTone",[],(function(t,n,r,o,a,i){var e=Object.freeze({DEFAULT:1,CUSTOM:2});i.NOTIFICATION_SOUND_TONE=e}),66);
__d("WAWebWamEnumUnreadBadgeSettingType",[],(function(t,n,r,o,a,i){var e=Object.freeze({CURRENT_UNREAD_COUNT:0,CLEAR_ON_APP_OPEN:1});i.UNREAD_BADGE_SETTING_TYPE=e}),66);
__d("WAWebNotificationSettingWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumInAppNotificationAlertStyle","WAWebWamEnumNotificationSoundTone","WAWebWamEnumUnreadBadgeSettingType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({NotificationSetting:[3684,{groupReactionNotification:[1,e.TYPES.BOOLEAN],groupShowNotification:[2,e.TYPES.BOOLEAN],groupSoundTone:[3,o("WAWebWamEnumNotificationSoundTone").NOTIFICATION_SOUND_TONE],inAppNotificationAlertStyle:[4,o("WAWebWamEnumInAppNotificationAlertStyle").IN_APP_NOTIFICATION_ALERT_STYLE],inAppNotificationSound:[5,e.TYPES.BOOLEAN],inAppNotificationVibrate:[6,e.TYPES.BOOLEAN],messageReactionNotification:[7,e.TYPES.BOOLEAN],messageShowNotification:[8,e.TYPES.BOOLEAN],messageSoundTone:[9,o("WAWebWamEnumNotificationSoundTone").NOTIFICATION_SOUND_TONE],offlineNotification:[11,e.TYPES.BOOLEAN],recommendedChannelsNotificationSetting:[19,e.TYPES.BOOLEAN],showPreview:[10,e.TYPES.BOOLEAN],statusNotificationPriority:[14,e.TYPES.BOOLEAN],statusNotificationVibration:[15,e.TYPES.BOOLEAN],statusReactionNotification:[16,e.TYPES.BOOLEAN],statusReminderNotification:[12,e.TYPES.BOOLEAN],statusShowNotification:[18,e.TYPES.BOOLEAN],statusSoundTone:[17,o("WAWebWamEnumNotificationSoundTone").NOTIFICATION_SOUND_TONE],unreadBadgeSetting:[13,o("WAWebWamEnumUnreadBadgeSettingType").UNREAD_BADGE_SETTING_TYPE]},[1,1,1],"regular"]},{NotificationSetting:[]});l.NotificationSettingWamEvent=s}),98);
__d("WAWebPnhDailyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumTypeOfGroupEnum"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({PnhDaily:[3806,{communityId:[1,e.TYPES.STRING],mappingMissing:[7,e.TYPES.INTEGER],pnhIndicatorClicksChat:[2,e.TYPES.INTEGER],pnhIndicatorClicksInfoScreen:[3,e.TYPES.INTEGER],reactionDeleteCount:[4,e.TYPES.INTEGER],reactionOpenTrayCount:[5,e.TYPES.INTEGER],totalContacts:[8,e.TYPES.INTEGER],typeOfGroup:[6,o("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM]},[1,1,1],"regular"]},{PnhDaily:[]});l.PnhDailyWamEvent=s}),98);
__d("WAWebWamEnumPrivacyHighlightCategoryEnum",[],(function(t,n,r,o,a,i){var e=Object.freeze({E2EE:0});i.PRIVACY_HIGHLIGHT_CATEGORY_ENUM=e}),66);
__d("WAWebWamEnumPrivacyHighlightSurfaceEnum",[],(function(t,n,r,o,a,i){var e=Object.freeze({GOLDEN_BOX_CONTACT:0,GOLDEN_BOX_GROUP:1,GOLDEN_BOX_BROADCAST:2,INFO_SCREEN_CONTACT:3,INFO_SCREEN_GROUP:4,INFO_SCREEN_BROADCAST:5,CALLS_LIST:6,CHATS_LIST:7,STATUS_LIST:8,LINKED_DEVICES_SCREEN:9,CALLING_SCREEN_AUDIO:10,CALLING_SCREEN_VIDEO:11,SPLIT_VIEW_HOME_PLACEHOLDER:12});i.PRIVACY_HIGHLIGHT_SURFACE_ENUM=e}),66);
__d("WAWebPrivacyHighlightDailyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPrivacyHighlightCategoryEnum","WAWebWamEnumPrivacyHighlightSurfaceEnum"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({PrivacyHighlightDaily:[3522,{dialogAppearCount:[1,e.TYPES.INTEGER],dialogSelectCount:[2,e.TYPES.INTEGER],narrativeAppearCount:[3,e.TYPES.INTEGER],privacyHighlightCategory:[4,o("WAWebWamEnumPrivacyHighlightCategoryEnum").PRIVACY_HIGHLIGHT_CATEGORY_ENUM],privacyHighlightSurface:[5,o("WAWebWamEnumPrivacyHighlightSurfaceEnum").PRIVACY_HIGHLIGHT_SURFACE_ENUM]},[1,1,1],"regular"]},{PrivacyHighlightDaily:[]});l.PrivacyHighlightDailyWamEvent=s}),98);
__d("WAWebPttDailyWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({PttDaily:[2938,{pttCancelBroadcast:[9,e.TYPES.INTEGER],pttCancelGroup:[8,e.TYPES.INTEGER],pttCancelIndividual:[7,e.TYPES.INTEGER],pttCancelInterop:[42,e.TYPES.INTEGER],pttCancelNewsletter:[32,e.TYPES.INTEGER],pttDraftReviewBroadcast:[15,e.TYPES.INTEGER],pttDraftReviewGroup:[14,e.TYPES.INTEGER],pttDraftReviewIndividual:[13,e.TYPES.INTEGER],pttDraftReviewInterop:[43,e.TYPES.INTEGER],pttDraftReviewNewsletter:[33,e.TYPES.INTEGER],pttFastplaybackBroadcast:[21,e.TYPES.INTEGER],pttFastplaybackGroup:[20,e.TYPES.INTEGER],pttFastplaybackIndividual:[19,e.TYPES.INTEGER],pttFastplaybackInterop:[44,e.TYPES.INTEGER],pttFastplaybackNewsletter:[34,e.TYPES.INTEGER],pttLockBroadcast:[12,e.TYPES.INTEGER],pttLockGroup:[11,e.TYPES.INTEGER],pttLockIndividual:[10,e.TYPES.INTEGER],pttLockInterop:[45,e.TYPES.INTEGER],pttLockNewsletter:[35,e.TYPES.INTEGER],pttOutOfChatBroadcast:[29,e.TYPES.INTEGER],pttOutOfChatGroup:[30,e.TYPES.INTEGER],pttOutOfChatIndividual:[31,e.TYPES.INTEGER],pttOutOfChatInterop:[46,e.TYPES.INTEGER],pttOutOfChatNewsletter:[36,e.TYPES.INTEGER],pttPausedRecordBroadcast:[22,e.TYPES.INTEGER],pttPausedRecordGroup:[23,e.TYPES.INTEGER],pttPausedRecordIndividual:[24,e.TYPES.INTEGER],pttPausedRecordInterop:[47,e.TYPES.INTEGER],pttPausedRecordNewsletter:[37,e.TYPES.INTEGER],pttPlaybackBroadcast:[18,e.TYPES.INTEGER],pttPlaybackGroup:[17,e.TYPES.INTEGER],pttPlaybackIndividual:[16,e.TYPES.INTEGER],pttPlaybackInterop:[48,e.TYPES.INTEGER],pttPlaybackNewsletter:[38,e.TYPES.INTEGER],pttRecordBroadcast:[3,e.TYPES.INTEGER],pttRecordGroup:[2,e.TYPES.INTEGER],pttRecordIndividual:[1,e.TYPES.INTEGER],pttRecordInterop:[49,e.TYPES.INTEGER],pttRecordNewsletter:[39,e.TYPES.INTEGER],pttSendBroadcast:[6,e.TYPES.INTEGER],pttSendGroup:[5,e.TYPES.INTEGER],pttSendIndividual:[4,e.TYPES.INTEGER],pttSendInterop:[50,e.TYPES.INTEGER],pttSendNewsletter:[40,e.TYPES.INTEGER],pttStopTapBroadcast:[25,e.TYPES.INTEGER],pttStopTapGroup:[26,e.TYPES.INTEGER],pttStopTapIndividual:[27,e.TYPES.INTEGER],pttStopTapInterop:[51,e.TYPES.INTEGER],pttStopTapNewsletter:[41,e.TYPES.INTEGER]},[1,1,1],"regular"]},{PttDaily:[]});l.PttDailyWamEvent=s}),98);
__d("WAWebScreenLockSettingsDataWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({ScreenLockSettingsData:[4802,{screenAutoLockDuration:[1,o("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,1],"regular"]},{ScreenLockSettingsData:[]});l.ScreenLockSettingsDataWamEvent=e}),98);
__d("WAWebChatLockDailyWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({ChatLockDaily:[4214,{folderChatsCount:[1,e.TYPES.INTEGER],folderOpenCount:[2,e.TYPES.INTEGER],lockFolderHidden:[5,e.TYPES.BOOLEAN],newAddChatCount:[3,e.TYPES.INTEGER],newRemoveChatCount:[4,e.TYPES.INTEGER],secretCodeActive:[6,e.TYPES.BOOLEAN]},[1,1,1],"regular"]},{ChatLockDaily:[]});l.ChatLockDailyWamEvent=s}),98);
__d("WAWebSubmitChatLockDailyStats",["WAWebChatLockDailyWamEvent"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.chatLockFolderChatsCount,n=e.chatLockFolderOpenCount,r=e.chatLockNewAddChatCount,a=e.chatLockNewRemoveChatCount,i=e.chatLockLockFolderHidden,l=e.chatLockSecretCodeActive;if(!(t===0||n===0||r===0||a===0)){var s=new(o("WAWebChatLockDailyWamEvent")).ChatLockDailyWamEvent({folderChatsCount:t,folderOpenCount:n,newAddChatCount:r,newRemoveChatCount:a});i!=null&&s.set({lockFolderHidden:i}),l!=null&&s.set({secretCodeActive:l}),s.commit()}}l.submitChatLockDailyStats=e}),98);
__d("WAWebUserPrefsContactManagement",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){var e=1;function s(){var e=r("WAWebUserPrefsStore").getUser(o("WAWebUserPrefsKeys").UserPrefs.SyncContactToAddressbookCounts),t=typeof e=="object"?e:null,n=typeof(t==null?void 0:t.enabledCount)=="number"?t.enabledCount:0,a=typeof(t==null?void 0:t.disabledCount)=="number"?t.disabledCount:0;return{enabledCount:n,disabledCount:a}}function u(e){r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").UserPrefs.SyncContactToAddressbookCounts,e)}function c(t){var n=s(),r=d();r!==t?t?(n.enabledCount++,n.enabledCount>=e&&(n.disabledCount=0)):(n.disabledCount++,n.disabledCount>=e&&(n.enabledCount=0)):!t&&n.enabledCount<e?n.enabledCount=0:t&&n.disabledCount<e&&(n.disabledCount=0),u(n)}function d(){var t=s();return t.enabledCount>=e}l.setSyncToAddressbookLastSetting=c,l.getSyncToAddressbookDefaultSetting=d}),98);
__d("WAWebWaFsSingleEmojiMessageDailyWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WaFsSingleEmojiMessageDaily:[5602,{animatedEmojiEnabled:[1,e.TYPES.BOOLEAN],animatedEmojiReceiveCnt:[2,e.TYPES.INTEGER],animatedEmojiSendCnt:[3,e.TYPES.INTEGER],emojiClickCnt:[4,e.TYPES.INTEGER],emojiReplyCount:[5,e.TYPES.INTEGER],pauseAnimationCnt:[6,e.TYPES.INTEGER],replayAnimationCnt:[7,e.TYPES.INTEGER],singleEmojiReceiveCnt:[8,e.TYPES.INTEGER],singleEmojiSendCnt:[9,e.TYPES.INTEGER]},[1,1,1],"regular"]},{WaFsSingleEmojiMessageDaily:[]});l.WaFsSingleEmojiMessageDailyWamEvent=s}),98);
__d("WAWebWamEnumPsTestEnumField",[],(function(t,n,r,o,a,i){var e=Object.freeze({TEST_VALUE1:1,TEST_VALUE2:2});i.PS_TEST_ENUM_FIELD=e}),66);
__d("WAWebTestAnonymousDailyIdWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPsTestEnumField"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({TestAnonymousDailyId:[2958,{psTestEnumField:[1,o("WAWebWamEnumPsTestEnumField").PS_TEST_ENUM_FIELD],psTestFloatField:[2,o("WAWebWamCodegenUtils").TYPES.NUMBER]},[1,1,1],"private",248614979]},{TestAnonymousDailyId:[]});l.TestAnonymousDailyIdWamEvent=e}),98);
__d("WAWebTestAnonymousDailyWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({TestAnonymousDaily:[2328,{},[1,1,1],"private",113760892]},{TestAnonymousDaily:[]});l.TestAnonymousDailyWamEvent=e}),98);
__d("WAWebTestAnonymousIdLessWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({TestAnonymousIdLess:[3004,{psTimeSinceLastEventInMin:[1,o("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,1],"private",0]},{TestAnonymousIdLess:[]});l.TestAnonymousIdLessWamEvent=e}),98);
__d("WAWebTestAnonymousMonthlyIdWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({TestAnonymousMonthlyId:[2960,{},[1,20,1e3],"private",191000728]},{TestAnonymousMonthlyId:[]});l.TestAnonymousMonthlyIdWamEvent=e}),98);
__d("WAWebTestAnonymousWeeklyIdWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({TestAnonymousWeeklyId:[2956,{psTestBooleanField:[2,e.TYPES.BOOLEAN],psTestStringField:[3,e.TYPES.STRING],psTimeSinceLastEventInMin:[1,e.TYPES.INTEGER]},[1,1,1],"private",42196056]},{TestAnonymousWeeklyId:[]});l.TestAnonymousWeeklyIdWamEvent=s}),98);
__d("WAWebWamPrivateStatsUtils",["WAWebTestAnonymousDailyIdWamEvent","WAWebTestAnonymousDailyWamEvent","WAWebTestAnonymousIdLessWamEvent","WAWebTestAnonymousMonthlyIdWamEvent","WAWebTestAnonymousWeeklyIdWamEvent"],(function(t,n,r,o,a,i,l){function e(){new(o("WAWebTestAnonymousDailyWamEvent")).TestAnonymousDailyWamEvent().commit(),new(o("WAWebTestAnonymousWeeklyIdWamEvent")).TestAnonymousWeeklyIdWamEvent().commit(),new(o("WAWebTestAnonymousIdLessWamEvent")).TestAnonymousIdLessWamEvent().commit()}function s(){new(o("WAWebTestAnonymousDailyIdWamEvent")).TestAnonymousDailyIdWamEvent().commit(),new(o("WAWebTestAnonymousMonthlyIdWamEvent")).TestAnonymousMonthlyIdWamEvent().commit()}l.logDailyPrivateStatsTestEvents=e,l.logUiActionShadowPrivateStatsTestEvents=s}),98);
__d("WAWebWebDynamicSamplingTestEventWithSamplingWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({WebDynamicSamplingTestEventWithSampling:[5320,{},[100,100,1e4],"regular"]},{WebDynamicSamplingTestEventWithSampling:[]});l.WebDynamicSamplingTestEventWithSamplingWamEvent=e}),98);
__d("WAWebWebDynamicSamplingTestEventWithoutSamplingWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({WebDynamicSamplingTestEventWithoutSampling:[5322,{},[1,1,1],"regular"]},{WebDynamicSamplingTestEventWithoutSampling:[]});l.WebDynamicSamplingTestEventWithoutSamplingWamEvent=e}),98);
__d("WAWebWebcFtsStorageWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({WebcFtsStorage:[3642,{ftsTotalSize:[1,o("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,1],"regular"]},{WebcFtsStorage:[]});l.WebcFtsStorageWamEvent=e}),98);
__d("WAWebTasksDailyStatsTask",["Promise","WALogger","WAStorageEstimator","WATimeUtils","WAWebABProps","WAWebABPropsGlobals","WAWebApiPrivacyDisallowedList","WAWebApiPrivacyEphemerality","WAWebBlocklistMigration","WAWebCommunityHomeActionWamEvent","WAWebCommunityTabActionWamEvent","WAWebContactCollection","WAWebContactManagementGating","WAWebCurrentUser","WAWebDailyAggregatedStatsCollection","WAWebDailyWamEvent","WAWebEphemeralityResolver","WAWebEstimateFtsStorageApi","WAWebInactiveGroupLidMigration","WAWebKeepInChatNotifWamEvent","WAWebLid1X1MigrationGating","WAWebLidAwareContactsDB","WAWebLidMigrationDailyWamEvent","WAWebLidMigrationUtils","WAWebLidStatusMigrationGating","WAWebMediaStore","WAWebMuteCollection","WAWebNotificationConstants","WAWebNotificationEngagementWamEvent","WAWebNotificationSettingWamEvent","WAWebPnhDailyWamEvent","WAWebPrivacyHighlightDailyWamEvent","WAWebPttDailyWamEvent","WAWebSchemaChat","WAWebScreenLockSettingsDataWamEvent","WAWebSubmitChatLockDailyStats","WAWebUserPrefsCartLidMigration","WAWebUserPrefsContactManagement","WAWebUserPrefsFavoritesLidMigration","WAWebUserPrefsGeneral","WAWebUserPrefsInfoStore","WAWebUserPrefsLabelAssociationsLidMigration","WAWebUserPrefsMultiDevice","WAWebUserPrefsNotifications","WAWebUserPrefsPhoneNumberHidingThreadPromotionMigration","WAWebUserPrefsScreenLock","WAWebUserPrefsTypes","WAWebUsernameTypes","WAWebWaFsSingleEmojiMessageDailyWamEvent","WAWebWamEnumLidMigrationSourceType","WAWebWamEnumNotificationSettingType","WAWebWamEnumNotificationSoundTone","WAWebWamEnumPrivacyHighlightCategoryEnum","WAWebWamEnumPrivacyHighlightSurfaceEnum","WAWebWamEnumPrivacySettingsContactsBuckets","WAWebWamEnumPrivacySettingsValueType","WAWebWamEnumTypeOfGroupEnum","WAWebWamPrivateStatsUtils","WAWebWebDynamicSamplingTestEventWithSamplingWamEvent","WAWebWebDynamicSamplingTestEventWithoutSamplingWamEvent","WAWebWebcFtsStorageWamEvent","WAWebWebcStorageStatWamEvent","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","gkx","justknobx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p;function _(e){if(e.goldenBoxContactNarrativeAppearCount>0||e.goldenBoxContactDialogAppearCount>0||e.goldenBoxContactDialogSelectCount>0){var t=new(o("WAWebPrivacyHighlightDailyWamEvent")).PrivacyHighlightDailyWamEvent({privacyHighlightCategory:o("WAWebWamEnumPrivacyHighlightCategoryEnum").PRIVACY_HIGHLIGHT_CATEGORY_ENUM.E2EE,privacyHighlightSurface:o("WAWebWamEnumPrivacyHighlightSurfaceEnum").PRIVACY_HIGHLIGHT_SURFACE_ENUM.GOLDEN_BOX_CONTACT,narrativeAppearCount:e.goldenBoxContactNarrativeAppearCount,dialogAppearCount:e.goldenBoxContactDialogAppearCount,dialogSelectCount:e.goldenBoxContactDialogSelectCount});t.commit()}if(e.goldenBoxGroupNarrativeAppearCount>0||e.goldenBoxGroupDialogAppearCount>0||e.goldenBoxGroupDialogSelectCount>0){var n=new(o("WAWebPrivacyHighlightDailyWamEvent")).PrivacyHighlightDailyWamEvent({privacyHighlightCategory:o("WAWebWamEnumPrivacyHighlightCategoryEnum").PRIVACY_HIGHLIGHT_CATEGORY_ENUM.E2EE,privacyHighlightSurface:o("WAWebWamEnumPrivacyHighlightSurfaceEnum").PRIVACY_HIGHLIGHT_SURFACE_ENUM.GOLDEN_BOX_GROUP,narrativeAppearCount:e.goldenBoxGroupNarrativeAppearCount,dialogAppearCount:e.goldenBoxGroupDialogAppearCount,dialogSelectCount:e.goldenBoxGroupDialogSelectCount});n.commit()}if(e.infoScreenGroupNarrativeAppearCount>0||e.infoScreenGroupDialogAppearCount>0||e.infoScreenGroupDialogSelectCount>0){var r=new(o("WAWebPrivacyHighlightDailyWamEvent")).PrivacyHighlightDailyWamEvent({privacyHighlightCategory:o("WAWebWamEnumPrivacyHighlightCategoryEnum").PRIVACY_HIGHLIGHT_CATEGORY_ENUM.E2EE,privacyHighlightSurface:o("WAWebWamEnumPrivacyHighlightSurfaceEnum").PRIVACY_HIGHLIGHT_SURFACE_ENUM.INFO_SCREEN_GROUP,narrativeAppearCount:e.infoScreenGroupNarrativeAppearCount,dialogAppearCount:e.infoScreenGroupDialogAppearCount,dialogSelectCount:e.infoScreenGroupDialogSelectCount});r.commit()}if(e.chatsListNarrativeAppearCount>0||e.chatsListDialogAppearCount>0||e.chatsListDialogSelectCount>0){var a=new(o("WAWebPrivacyHighlightDailyWamEvent")).PrivacyHighlightDailyWamEvent({privacyHighlightCategory:o("WAWebWamEnumPrivacyHighlightCategoryEnum").PRIVACY_HIGHLIGHT_CATEGORY_ENUM.E2EE,privacyHighlightSurface:o("WAWebWamEnumPrivacyHighlightSurfaceEnum").PRIVACY_HIGHLIGHT_SURFACE_ENUM.CHATS_LIST,narrativeAppearCount:e.chatsListNarrativeAppearCount,dialogAppearCount:e.chatsListDialogAppearCount,dialogSelectCount:e.chatsListDialogSelectCount});a.commit()}if(e.statusListNarrativeAppearCount>0||e.statusListDialogAppearCount>0||e.statusListDialogSelectCount>0){var i=new(o("WAWebPrivacyHighlightDailyWamEvent")).PrivacyHighlightDailyWamEvent({privacyHighlightCategory:o("WAWebWamEnumPrivacyHighlightCategoryEnum").PRIVACY_HIGHLIGHT_CATEGORY_ENUM.E2EE,privacyHighlightSurface:o("WAWebWamEnumPrivacyHighlightSurfaceEnum").PRIVACY_HIGHLIGHT_SURFACE_ENUM.STATUS_LIST,narrativeAppearCount:e.statusListNarrativeAppearCount,dialogAppearCount:e.statusListDialogAppearCount,dialogSelectCount:e.statusListDialogSelectCount});i.commit()}if(e.callingScreenAudioNarrativeAppearCount>0||e.callingScreenAudioDialogAppearCount>0||e.callingScreenAudioDialogSelectCount>0){var l=new(o("WAWebPrivacyHighlightDailyWamEvent")).PrivacyHighlightDailyWamEvent({privacyHighlightCategory:o("WAWebWamEnumPrivacyHighlightCategoryEnum").PRIVACY_HIGHLIGHT_CATEGORY_ENUM.E2EE,privacyHighlightSurface:o("WAWebWamEnumPrivacyHighlightSurfaceEnum").PRIVACY_HIGHLIGHT_SURFACE_ENUM.CALLING_SCREEN_AUDIO,narrativeAppearCount:e.callingScreenAudioNarrativeAppearCount,dialogAppearCount:e.callingScreenAudioDialogAppearCount,dialogSelectCount:e.callingScreenAudioDialogSelectCount});l.commit()}}function f(){var e=!o("WAWebMuteCollection").MuteCollection.globalReactionsMute(),t=!!o("WAWebUserPrefsNotifications").getIgnoreNondirectGroupMsg(),n=o("WAWebABProps").getABPropConfigValue("wa_web_enable_granular_notifications"),r=new(o("WAWebNotificationSettingWamEvent")).NotificationSettingWamEvent;n?r.set({groupReactionNotification:o("WAWebMuteCollection").MuteCollection.getGlobalGroupNotificationReactionsEnabled(),groupShowNotification:o("WAWebMuteCollection").MuteCollection.getGlobalGroupNotificationsEnabled(),groupSoundTone:o("WAWebMuteCollection").MuteCollection.getGlobalGroupSoundsEnabled()?o("WAWebWamEnumNotificationSoundTone").NOTIFICATION_SOUND_TONE.DEFAULT:void 0,messageReactionNotification:o("WAWebMuteCollection").MuteCollection.getGlobalNotificationReactionsEnabled(),messageShowNotification:o("WAWebMuteCollection").MuteCollection.getGlobalNotificationsEnabled(),messageSoundTone:o("WAWebMuteCollection").MuteCollection.getGlobalSoundsEnabled()?o("WAWebWamEnumNotificationSoundTone").NOTIFICATION_SOUND_TONE.DEFAULT:void 0,statusReactionNotification:o("WAWebMuteCollection").MuteCollection.getGlobalStatusNotificationReactionsEnabled(),statusShowNotification:o("WAWebMuteCollection").MuteCollection.getGlobalStatusNotificationsEnabled(),statusSoundTone:o("WAWebMuteCollection").MuteCollection.getGlobalStatusSoundsEnabled()?o("WAWebWamEnumNotificationSoundTone").NOTIFICATION_SOUND_TONE.DEFAULT:void 0,showPreview:o("WAWebUserPrefsNotifications").getGlobalPreviews(),offlineNotification:o("WAWebUserPrefsNotifications").getGlobalOfflineNotifications()}):r.set({groupReactionNotification:t&&e,groupShowNotification:t,groupSoundTone:o("WAWebWamEnumNotificationSoundTone").NOTIFICATION_SOUND_TONE.DEFAULT,inAppNotificationSound:o("WAWebUserPrefsNotifications").getGlobalSounds(),messageReactionNotification:e,messageShowNotification:o("WAWebUserPrefsNotifications").getGlobalNotifications(),messageSoundTone:o("WAWebWamEnumNotificationSoundTone").NOTIFICATION_SOUND_TONE.DEFAULT,showPreview:o("WAWebUserPrefsNotifications").getGlobalPreviews(),offlineNotification:o("WAWebUserPrefsNotifications").getGlobalOfflineNotifications()}),r.commit()}function g(){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WAWebABPropsGlobals").logClientExposurePulseEventFromDailyStatsTask();var t=yield y(),n=yield S(),a=yield k(),i=yield T(),l=D(),s=yield x(),u=babelHelpers.extends({},t,n,a,l,s);o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["WamDailyStats: "]))).devConsole(u);var c=new(o("WAWebDailyWamEvent")).DailyWamEvent;c.set(u),c.commit(),f();var d=yield b();new(o("WAWebLidMigrationDailyWamEvent")).LidMigrationDailyWamEvent(d).commit();var m=new(o("WAWebWebcFtsStorageWamEvent")).WebcFtsStorageWamEvent;m.set({ftsTotalSize:i}),m.commit();var p=new(o("WAWebScreenLockSettingsDataWamEvent")).ScreenLockSettingsDataWamEvent;p.set(P()),p.commit();var g=o("WAWebUserPrefsMultiDevice").getPairingTimestamp(),h=new(o("WAWebWebcStorageStatWamEvent")).WebcStorageStatWamEvent;h.set({webcStorageQuota:a.storageTotalSize,webcStorageUsage:a.storageUsed,webcAgeOfStorage:g!=null?o("WATimeUtils").unixTimeWithoutClockSkewCorrection()-g:-1,webcPackingEnabled:!1}),h.commit();var C=yield o("WAWebUserPrefsGeneral").getOfflineNotificationEngagement();if(C){var v,R;new(o("WAWebNotificationEngagementWamEvent")).NotificationEngagementWamEvent({isWebBackgroundSyncNotif:!0,totalNotifShown:(v=C.totalNotifShown)!=null?v:0,totalNotifTapToOpen:(R=C.totalNotifTapToOpen)!=null?R:0}).commit(),o("WAWebUserPrefsGeneral").clearOfflineNotificationContentEngagement()}var L=yield o("WAWebUserPrefsGeneral").getNotificationEngagement();if(L){var E,I;new(o("WAWebNotificationEngagementWamEvent")).NotificationEngagementWamEvent({totalNotifShown:(E=L.totalNotifShown)!=null?E:0,totalNotifTapToOpen:(I=L.totalNotifTapToOpen)!=null?I:0}).commit(),o("WAWebUserPrefsGeneral").clearNotificationContentEngagement()}o("WAWebWamPrivateStatsUtils").logDailyPrivateStatsTestEvents();var $=o("WAWebDailyAggregatedStatsCollection").DailyAggregatedStatsCollection.toArray().filter(function(e){return e.shouldBeSubmitted()});o("WAWebDailyAggregatedStatsCollection").DailyAggregatedStatsCollection.remove($),$.forEach(function(e){var t=new(o("WAWebPttDailyWamEvent")).PttDailyWamEvent({pttCancelBroadcast:e.pttCancelBroadcast,pttCancelGroup:e.pttCancelGroup,pttCancelIndividual:e.pttCancelIndividual,pttCancelNewsletter:e.pttCancelNewsletter,pttDraftReviewBroadcast:e.pttDraftReviewBroadcast,pttDraftReviewGroup:e.pttDraftReviewGroup,pttDraftReviewIndividual:e.pttDraftReviewIndividual,pttDraftReviewNewsletter:e.pttDraftReviewNewsletter,pttFastplaybackBroadcast:e.pttFastplaybackBroadcast,pttFastplaybackGroup:e.pttFastplaybackGroup,pttFastplaybackIndividual:e.pttFastplaybackIndividual,pttFastplaybackNewsletter:e.pttFastplaybackNewsletter,pttLockBroadcast:e.pttLockBroadcast,pttLockGroup:e.pttLockGroup,pttLockIndividual:e.pttLockIndividual,pttLockNewsletter:e.pttLockNewsletter,pttOutOfChatBroadcast:e.pttOutOfChatBroadcast,pttOutOfChatGroup:e.pttOutOfChatGroup,pttOutOfChatIndividual:e.pttOutOfChatIndividual,pttOutOfChatNewsletter:e.pttOutOfChatNewsletter,pttPlaybackBroadcast:e.pttPlaybackBroadcast,pttPlaybackGroup:e.pttPlaybackGroup,pttPlaybackIndividual:e.pttPlaybackIndividual,pttPlaybackNewsletter:e.pttPlaybackNewsletter,pttRecordBroadcast:e.pttRecordBroadcast,pttRecordGroup:e.pttRecordGroup,pttRecordIndividual:e.pttRecordIndividual,pttRecordNewsletter:e.pttRecordNewsletter,pttSendBroadcast:e.pttSendBroadcast,pttSendGroup:e.pttSendGroup,pttSendIndividual:e.pttSendIndividual,pttSendNewsletter:e.pttSendNewsletter,pttPausedRecordBroadcast:e.pttPausedRecordBroadcast,pttPausedRecordGroup:e.pttPausedRecordGroup,pttPausedRecordIndividual:e.pttPausedRecordIndividual,pttPausedRecordNewsletter:e.pttPausedRecordNewsletter});t.commit(),_(e),new(o("WAWebCommunityTabActionWamEvent")).CommunityTabActionWamEvent({communityTabGroupNavigations:e.communityTabGroupNavigations,communityTabToHomeViews:e.communityTabToHomeViews,communityTabViews:e.communityTabViews,communityTabViewsViaContextMenu:e.communityTabViewsViaContextMenu}).commit(),e.communityHome!=null&&Object.keys(e.communityHome).forEach(function(t){var n=r("WAWebWid").user(t);if(n!=null){var a=e.communityHome[t],i=a.communityHomeGroupDiscoveries,l=a.communityHomeGroupJoins,s=a.communityHomeGroupNavigations,u=a.communityHomeViews;new(o("WAWebCommunityHomeActionWamEvent")).CommunityHomeActionWamEvent({communityHomeId:n,communityHomeGroupDiscoveries:i,communityHomeGroupJoins:l,communityHomeGroupNavigations:s,communityHomeViews:u}).commit()}}),e.pnhCagActions!=null&&Object.keys(e.pnhCagActions).forEach(function(t){var n=e.pnhCagActions[t],r=n.pnhIndicatorClicksChat,a=n.pnhIndicatorClicksInfoScreen,i=n.reactionDeleteCount,l=n.reactionOpenTrayCount;new(o("WAWebPnhDailyWamEvent")).PnhDailyWamEvent({communityId:t,pnhIndicatorClicksChat:r,pnhIndicatorClicksInfoScreen:a,reactionDeleteCount:i,reactionOpenTrayCount:l,typeOfGroup:o("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM.DEFAULT_SUBGROUP}).commit()});var n=new(o("WAWebKeepInChatNotifWamEvent")).KeepInChatNotifWamEvent({kicGroupNotificationTaps:e.kicGroupNotificationTaps,kicGroupNotifications:e.kicGroupNotifications,kicNotificationTaps:e.kicNotificationTaps,kicNotifications:e.kicNotifications});n.commit(),o("WAWebABProps").getABPropConfigValue("single_emoji_logging_enabled")&&new(o("WAWebWaFsSingleEmojiMessageDailyWamEvent")).WaFsSingleEmojiMessageDailyWamEvent({animatedEmojiSendCnt:e.animatedEmojiSend,emojiReplyCount:e.emojiReply,singleEmojiSendCnt:e.singleEmojiSend}).commit(),o("WAWebSubmitChatLockDailyStats").submitChatLockDailyStats(e)}),new(o("WAWebWebDynamicSamplingTestEventWithoutSamplingWamEvent")).WebDynamicSamplingTestEventWithoutSamplingWamEvent().commit(),new(o("WAWebWebDynamicSamplingTestEventWithSamplingWamEvent")).WebDynamicSamplingTestEventWithSamplingWamEvent().commit()}),h.apply(this,arguments)}function y(){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebUserPrefsInfoStore").deviceInfo.get();return{languageCode:e.lg,locationCode:e.lc,osBuildNumber:e.osBuild,simMcc:parseInt(e.mcc,10),simMnc:parseInt(e.mnc,10)}}),C.apply(this,arguments)}function b(){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e,t,n,a,i=[];i.push("con"),i.push("id"),i.push("ss"),i.push("sk"),o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&i.push("ch_jid"),o("WAWebLidStatusMigrationGating").getLidStatusSendEnabled()&&i.push("st_lid"),o("WAWebUserPrefsFavoritesLidMigration").isFavoritesMigrationComplete()&&i.push("fav"),o("WAWebUserPrefsCartLidMigration").isCartLidMigrationComplete()&&i.push("cart"),o("WAWebUserPrefsLabelAssociationsLidMigration").isLabelAssociationsMigrationComplete()&&i.push("lab");var l=o("WAWebUserPrefsPhoneNumberHidingThreadPromotionMigration").isPhoneNumberHidingThreadPromotionMigrationComplete();l&&i.push("pnh_lid"),o("WAWebBlocklistMigration").isBlocklistMigrated()&&i.push("bl_lid"),o("WAWebInactiveGroupLidMigration").isInactiveGroupLidMigrationComplete()&&i.push("inactg");var m=yield o("WAWebSchemaChat").getChatTable().all(),p,_,f;try{if(p=m.filter(function(e){var t=o("WAWebWidFactory").createWid(e.id);return t.isRegularUser()&&o("WAWebLidMigrationUtils").toLid(t)==null}),_=m.filter(function(e){var t=o("WAWebWidFactory").createWid(e.id);return t.isRegularUser()&&e.accountLid==null}),o("WAWebCurrentUser").isEmployee()){var g=function(t){var e,n,r=o("WAWebWidFactory").createWid(t.id);return"chat id: "+r.toLogString()+", account lid: "+(t.accountLid==null?"null":o("WAWebWidFactory").createWid(t.accountLid).toLogString())+", mapping: "+((e=(n=o("WAWebLidMigrationUtils").toLid(r))==null?void 0:n.toLogString())!=null?e:"null")};o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["getLidMigrationStatus: PN chat without mapping: ",""])),p.slice(0,5).map(g).join(",")),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["getLidMigrationStatus: chats without account_lid: ",""])),_.slice(0,5).map(g).join(","))}if(r("justknobx")._("5315")){var h=0,y=0;m.forEach(function(e){var t=o("WAWebWidFactory").createWid(e.id);t.isLid()&&e.lidOriginType===o("WAWebUsernameTypes").LidOriginType.PNH_CTWA&&(o("WAWebLidMigrationUtils").toPn(t)==null?y++:h++)}),f={numberOfPnhCtwaThreadsKnownMapping:h,numberOfPnhCtwaThreadsMissingMapping:y},l&&(y>0||h>0)&&(o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["getLidMigrationStatus: switching back PNH thread migration to unmigrated. Found "," threads with missing mapping and "," threads with known mapping"])),y,h),o("WAWebUserPrefsPhoneNumberHidingThreadPromotionMigration").setPhoneNumberHidingThreadPromotionMigrationState("unmigrated"))}}catch(e){o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["getLidMigrationStatus: ",""])),e)}var C=o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.lidMigrationSource()===o("WAWebUserPrefsTypes").LidMigrationSource.HISTORY?o("WAWebWamEnumLidMigrationSourceType").LID_MIGRATION_SOURCE_TYPE.HISTORY:o("WAWebWamEnumLidMigrationSourceType").LID_MIGRATION_SOURCE_TYPE.PEER;return babelHelpers.extends({completedMigrations:i.join(","),numberOfPnChatsWithoutMapping:(e=(t=p)==null?void 0:t.length)!=null?e:-1,numberOfUserChatsWithoutAccountLid:o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()?(n=(a=_)==null?void 0:a.length)!=null?n:-1:void 0,lidMigrationSource:C},f)}),v.apply(this,arguments)}function S(){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e,t,n,r;o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["getPrivacySettings"])));var a=o("WAWebUserPrefsGeneral").getUserPrivacySettings(),i={receiptsEnabled:a.readReceipts!=="none"},l=yield o("WAWebApiPrivacyDisallowedList").queryDisallowedLists();i.privacySettingsAbout=L(a.about),i.privacySettingsAboutExceptNum=a.about==="contact_blacklist"?E((e=l.about)==null?void 0:e.disallowedList.length):null,i.privacySettingsGroups=L(a.groupAdd),i.privacySettingsGroupsExceptNum=a.groupAdd==="contact_blacklist"?E((t=l.groupadd)==null?void 0:t.disallowedList.length):null,i.privacySettingsLastSeen=L(a.lastSeen),i.privacySettingsLastSeenExceptNum=a.lastSeen==="contact_blacklist"?E((n=l.last)==null?void 0:n.disallowedList.length):null,i.privacySettingsProfilePhoto=L(a.profilePicture),i.privacySettingsProfilePhotoExceptNum=a.profilePicture==="contact_blacklist"?E((r=l.profile)==null?void 0:r.disallowedList.length):null;var s=o("WAWebEphemeralityResolver").getEphemeralDurationForUser(o("WAWebContactCollection").ContactCollection.getMeContact());if(i.defaultDisappearingDuration=s!=null?s:0,o("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_daily_logs")){i.isDefaultDisappearingMessagingUser=i.defaultDisappearingDuration!==0;var u=yield o("WAWebApiPrivacyEphemerality").queryEphemeralityDailyLogInfo(),c=u.isEphemeralMessagingUser,d=u.countEphemeralThreadsEnabledByMe,p=u.countEphemeralThreads;i.isEphemeralMessagingUser=c,i.countEphemeralThreads=p,i.countEphemeralThreadsEnabledByMe=d}return i}),R.apply(this,arguments)}function L(e){if(e==null)return null;switch(e){case"all":return o("WAWebWamEnumPrivacySettingsValueType").PRIVACY_SETTINGS_VALUE_TYPE.EVERYONE;case"contacts":return o("WAWebWamEnumPrivacySettingsValueType").PRIVACY_SETTINGS_VALUE_TYPE.MY_CONTACTS;case"contact_blacklist":return o("WAWebWamEnumPrivacySettingsValueType").PRIVACY_SETTINGS_VALUE_TYPE.MY_CONTACTS_EXCEPT;case"none":return o("WAWebWamEnumPrivacySettingsValueType").PRIVACY_SETTINGS_VALUE_TYPE.NOBODY}}function E(e){return e==null?null:e===0?o("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B0:e<5?o("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B1:e<10?o("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B5:e<15?o("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B10:e<20?o("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B15:e<30?o("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B20:e<40?o("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B30:e<50?o("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B40:e<60?o("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B50:e<70?o("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B60:e<80?o("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B70:e<90?o("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B80:e<100?o("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B90:o("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B100}function k(){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=r("WAWebLidAwareContactsDB").equals(["isAddressBookContact"],1).then(function(e){return e.filter(function(e){return!r("WAWebWid").isStringLid(e.id)}).length}),t=o("WAStorageEstimator").estimateStorage(),a=o("WAWebMediaStore").LruMediaStore.count(),i=r("WAWebLidAwareContactsDB").count(),l=o("WAWebContactCollection").ContactCollection.getFilteredContacts({}).length,s=yield(p||(p=n("Promise"))).all([t,e,a,i]),u=s[0],c=s[1],d=s[2],m=s[3],_=0,f=0,g=0;if(u.success){var h=u.value,y=h.quota,C=h.usage;_=y-C,f=y,g=C}return{addressbookWhatsappSize:N(c,10),storageAvailSize:N(_,100),storageTotalSize:N(f,100),storageUsed:N(g,100),mediaFolderFileCount:d,webcContactsTableSize:N(m,10),webcFilteredContactsSize:l}}),I.apply(this,arguments)}function T(){return o("WAWebEstimateFtsStorageApi").getEstimatedFTSDbSize()}function D(){var e=o("WAWebWamEnumNotificationSettingType").NOTIFICATION_SETTING_TYPE.UNKNOWN;if(window.Notification!=null)switch(window.Notification.permission){case o("WAWebNotificationConstants").PERMISSION_ALLOWED:e=o("WAWebWamEnumNotificationSettingType").NOTIFICATION_SETTING_TYPE.ALLOWED;break;case o("WAWebNotificationConstants").PERMISSION_DENIED:e=o("WAWebWamEnumNotificationSettingType").NOTIFICATION_SETTING_TYPE.BLOCKED;break;default:e=o("WAWebWamEnumNotificationSettingType").NOTIFICATION_SETTING_TYPE.UNKNOWN}var t;return o("WAWebContactManagementGating").contactManagementEnabled()&&(t=o("WAWebUserPrefsContactManagement").getSyncToAddressbookDefaultSetting()),{osNotificationSetting:e,isContactSyncToOsDefaultOn:t}}function x(){return $.apply(this,arguments)}function $(){return $=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=[],t=[],n=window.navigator.mediaCapabilities;if(n!=null){var r={width:800,height:600,bitrate:1e4,framerate:30},o={type:"record"},a={type:"file"},i={contentType:'video/mp4; codecs="avc1.42000a"'},l={contentType:'video/mp4; codecs="hev1.1.6.L93.B0"'},s={contentType:'video/mp4; codecs="av01.0.00M.08"'},u={contentType:'video/mp4; codecs="vp09.00.51.08.01.01.01.01.00"'},c=babelHelpers.extends({},o,{video:babelHelpers.extends({},i,r)}),d=babelHelpers.extends({},o,{video:babelHelpers.extends({},l,r)}),m=babelHelpers.extends({},o,{video:babelHelpers.extends({},s,r)}),p=babelHelpers.extends({},o,{video:babelHelpers.extends({},u,r)}),_=babelHelpers.extends({},a,{video:babelHelpers.extends({},i,r)}),f=babelHelpers.extends({},a,{video:babelHelpers.extends({},l,r)}),g=babelHelpers.extends({},a,{video:babelHelpers.extends({},s,r)}),h=babelHelpers.extends({},a,{video:babelHelpers.extends({},u,r)});if(n.encodingInfo!=null){try{(yield n.encodingInfo(c)).supported&&e.push("avc")}catch(e){}try{(yield n.encodingInfo(d)).supported&&e.push("hevc")}catch(e){}try{(yield n.encodingInfo(m)).supported&&e.push("av1")}catch(e){}try{(yield n.encodingInfo(p)).supported&&e.push("vp9")}catch(e){}}if(n.decodingInfo!=null){try{(yield n.decodingInfo(_)).supported&&t.push("avc")}catch(e){}try{(yield n.decodingInfo(f)).supported&&t.push("hevc")}catch(e){}try{(yield n.decodingInfo(g)).supported&&t.push("av1")}catch(e){}try{(yield n.decodingInfo(h)).supported&&t.push("vp9")}catch(e){}}}return{supportedEncoders:e.join(","),supportedDecoders:t.join(",")}}),$.apply(this,arguments)}function P(){return{screenAutoLockDuration:o("WAWebUserPrefsScreenLock").getScreenLockDurationForLogging()}}function N(e,t){return r("gkx")("26258")?Math.round(e/t)*t:e}l.logDailyStats=g,l.getLidMigrationStatus=b}),98);
__d("WAWebAccountLinkingGatingUtils",["WAWebABProps"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebABProps").getABPropConfigValue("web_waffle")}l.accountLinkingEnabled=e}),98);
__d("WAWebApiTextStatus",["Promise","WATimeUtils","WAWebLidAwareContactsDB","WAWebModelStorageUtils","WAWebTextStatusGatingUtils","WAWebTextStatusUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(){var t=o("WATimeUtils").unixTime();return o("WAWebTextStatusGatingUtils").receiveTextStatusEnabled()?o("WAWebModelStorageUtils").getStorage().lock(["contact"],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield r("WAWebLidAwareContactsDB").lessThan(["textStatusExpiryTs"],t);if(!(!e||e.length===0)){var n=e.map(function(e){return{id:e.id,textStatusString:void 0,textStatusEmoji:void 0,textStatusExpiryTs:void 0,textStatusEphemeralDuration:void 0,textStatusLastUpdateTime:o("WAWebTextStatusUtils").CLEAR_TEXT_STATUS_LAST_UPDATE_TIME_VAL}});return r("WAWebLidAwareContactsDB").bulkCreateOrMerge(n,"ApiTextStatus.updateExpiredTextStatusOfContact")}})):(e||(e=n("Promise"))).resolve()}l.updateExpiredTextStatusOfContact=s}),98);
__d("WAWebUtmBizPrefs",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){function e(e,t){var n=c(),a=Date.now();n[e]=babelHelpers.extends({addedTime:a},t),r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").KEYS.CHAT_UTM,JSON.stringify(n))}function s(e){var t=c();delete t[e],r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").KEYS.CHAT_UTM,JSON.stringify(t))}function u(e){var t=r("WAWebUserPrefsStore").getUser(o("WAWebUserPrefsKeys").KEYS.CHAT_UTM);if(t==null)return null;try{return JSON.parse(t)[e]}catch(e){return null}}function c(){var e=r("WAWebUserPrefsStore").getUser(o("WAWebUserPrefsKeys").KEYS.CHAT_UTM);if(e==null)return{};try{var t;return(t=JSON.parse(e))!=null?t:{}}catch(e){return{}}}function d(){r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").KEYS.CHAT_UTM,JSON.stringify({}))}l.persistUtmtoLocalStorage=e,l.removeUtmFromLocalStorage=s,l.getUtmFromLocalStorage=u,l.getAllUtmsFromLocalStorage=c,l.clearAllUtmFromLocalStorage=d}),98);
__d("WAWebUtmBizUtils",["WAWebBizGatingUtils","WAWebMsgGetters","WAWebStateUtils"],(function(t,n,r,o,a,i,l){function e(e,t){return e.contact.isEnterprise&&!c(t)&&!s(e,t)}function s(e,t){var n=u(e);if(n==null||n.t==null)return!1;var r=n.t*1e3;return r>t.addedTime}function u(e){for(var t=o("WAWebStateUtils").unproxy(e),n=t.msgs.length-1;n>=0;n--){var r=t.msgs.at(n);if(r&&!o("WAWebMsgGetters").getIsSentByMe(r))return r}}function c(e){var t=Date.now(),n=o("WAWebBizGatingUtils").utmTrackingExpirationInHours()*60*60*1e3;return e.addedTime+n<=t}l.isUtmValid=e,l.hasUtmExpired=c}),98);
__d("WAWebCleanUtmJob",["WAJobOrchestratorTypes","WAPromiseCallSync","WAWebOrchestratorNonPersistedJob","WAWebUtmBizPrefs","WAWebUtmBizUtils"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("cleanExpiredUtm",function(){return s()},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.BEST_EFFORT}).waitUntilCompleted()}function s(){return o("WAPromiseCallSync").promiseCallSync(function(){var e=o("WAWebUtmBizPrefs").getAllUtmsFromLocalStorage();Object.keys(e).forEach(function(t){var n=e[t];o("WAWebUtmBizUtils").hasUtmExpired(n)&&o("WAWebUtmBizPrefs").removeUtmFromLocalStorage(t)})})}l.cleanExpiredUtmJob=e}),98);
__d("WAWebDBPurgeExpiredRecords",["Promise","WAWeb-moment","WAWebDBMapOrphansToProviders","WAWebDBOrphanDbSerialization","WAWebMsgType","WAWebSchemaMessage","WAWebSchemaMessageOrphans","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a){var i=r("WAWeb-moment")().subtract(t,"days").unix(),l=r("WAWeb-moment")().subtract(a,"days").unix(),s=yield o("WAWebSchemaMessageOrphans").getMessageOrphanTable().between(["t"],0,i),u=new Set(s.map(function(e){return e.parentMsgKey})),c=yield o("WAWebSchemaMessage").getMessageTable().bulkGet(Array.from(u)),d=new Set(c.filter(function(e){return e&&e.type===o("WAWebMsgType").MSG_TYPE.UNKNOWN}).map(function(e){return e==null?void 0:e.id})),m=s.filter(function(e){return!d.has(e.parentMsgKey)||e.t<l}).map(o("WAWebDBOrphanDbSerialization").orphanFromDbRow),p=yield o("WAWebDBMapOrphansToProviders").mapOrphansToProviders(m),_=[];for(var f of p.entries()){var g=f[0],h=f[1];g.onRecordsPurged!=null&&_.push(g.onRecordsPurged(h))}yield(e||(e=n("Promise"))).all(_);var y=m.map(function(e){return e.msgKey});return o("WAWebSchemaMessageOrphans").getMessageOrphanTable().bulkRemove(y)}),u.apply(this,arguments)}l.purgeExpiredOrphanRecords=s}),98);
__d("WAWebDownloads3PDSignalsDatabaseApi",["WATimeUtils","WAWebSchemaDownload3PDSignals","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=30,s=30;function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebSchemaDownload3PDSignals").getDownload3PDSignalsTable().createOrReplace(e)}),c.apply(this,arguments)}function d(){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebSchemaDownload3PDSignals").getDownload3PDSignalsTable().all()}),m.apply(this,arguments)}function p(){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=e,n=o("WATimeUtils").unixTimeMs()-t*o("WATimeUtils").DAY_MILLISECONDS;return o("WAWebSchemaDownload3PDSignals").getDownload3PDSignalsTable().greaterThan(["timestamp"],n)}),_.apply(this,arguments)}function f(){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("WATimeUtils").unixTimeMs()-s*o("WATimeUtils").DAY_MILLISECONDS,t=yield o("WAWebSchemaDownload3PDSignals").getDownload3PDSignalsTable().lessThan(["timestamp"],e);t.length!==0&&(yield o("WAWebSchemaDownload3PDSignals").getDownload3PDSignalsTable().bulkRemove(t.map(function(e){return e.id})))}),g.apply(this,arguments)}l.addOrEdit3PDSignal=u,l.getAll3PDSignals=d,l.getRecent3PDSignals=p,l.cleanup3PDSignalsTable=f}),98);
__d("WAWebFalcoStorageClearJob",["WAJobOrchestratorTypes","WAWebClearFalcoBufferApi","WAWebOrchestratorNonPersistedJob"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("clearFalcoBuffer",function(e){return o("WAWebClearFalcoBufferApi").maybeClearFalcoBuffer()},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.BEST_EFFORT}).waitUntilCompleted()}l.clearFalcoBufferJob=e}),98);
__d("WAWebJobLoadQuickPromotions",["WATaskScheduler","WAWebBackendApi","WAWebBizGatingUtils","WAWebCTWAConstants","WAWebFetchQuickPromotions","WAWebSchemaQuickPromotions","WAWebTasksTaskType"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebBackendApi").frontendSendAndReceive("getUserLocale").then(function(t){return o("WAWebSchemaQuickPromotions").getQuickPromotionsTable().all().then(function(n){if(n.sort(function(e,t){return e.data.qpConfigPriority-t.data.qpConfigPriority}),o("WAWebBizGatingUtils").qpGraphQLEnabled()){var r=o("WAWebBizGatingUtils").qpSurfaceIdsUsingGraphQL(),a=n.filter(function(e){if(e==null)return!1;var n=o("WAWebCTWAConstants").KNOWN_QP_SURFACES.get(e.surfaceId);if(n==null)return!1;var a=r.has(n);return a&&e.locale!==t});if(a.length>0){if(e==="app-launch"){o("WAWebFetchQuickPromotions").fetchQuickPromotions().then(function(){o("WATaskScheduler").rescheduleNow(o("WAWebTasksTaskType").TaskType.FETCH_QUICK_PROMOTIONS)});return}if(e==="fetch-success")return}}o("WAWebBackendApi").frontendFireAndForget("loadedQuickPromotions",{promotions:n})})})}l.loadQuickPromotions=e}),98);
__d("WAWebJobUpdateQPSurfaces",["Promise","WALogger","WATimeUtils","WAWebCTWAConstants","WAWebJobLoadQuickPromotions","WAWebModelStorageUtils","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e){var t,n,r,o,a,i=(t=e.qpConfigPacing)==null?void 0:t.userInfo;return{impressions:(n=i==null?void 0:i.impressionCount)!=null?n:0,primaryClicks:(r=i==null?void 0:i.primaryClickCount)!=null?r:0,secondaryClicks:(o=i==null?void 0:i.secondaryClickCount)!=null?o:0,dismisses:(a=i==null?void 0:i.dismissClickCount)!=null?a:0}}function d(e,t){var n,r,o,a,i,l=e.tracking,s=(n=t.qpConfigPacing)==null?void 0:n.userInfo,u=c(t),d=l.dismisses-((r=s==null?void 0:s.dismissClickCount)!=null?r:0),m=l.primaryClicks-((o=s==null?void 0:s.primaryClickCount)!=null?o:0),p=l.secondaryClicks-((a=s==null?void 0:s.secondaryClickCount)!=null?a:0),_=l.impressions-((i=s==null?void 0:s.impressionCount)!=null?i:0);d>0&&(u.dismisses+=d),m>0&&(u.primaryClicks+=m),p>0&&(u.secondaryClicks+=p),_>0&&(u.impressions+=_);var f=l.lastImpressionTs,g=l.lastPrimaryClickTs,h=l.lastSecondaryClickTs,y=l.lastDismissTs;return f!=null&&(u.lastImpressionTs=f),g!=null&&(u.lastPrimaryClickTs=g),h!=null&&(u.lastSecondaryClickTs=h),y!=null&&(u.lastDismissTs=y),u}function m(e,t,n){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r,a){if(t.length===0)return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["updateQPSurfaces: no surfaces"]))),(u||(u=n("Promise"))).resolve();var i=t.map(function(e){return e.id}),l=new Set(i);if(l.size!==i.length)return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["updateQPSurfaces: found duplicated surface"]))),(u||(u=n("Promise"))).resolve();var m=new Map;t.forEach(function(e){o("WAWebCTWAConstants").KNOWN_QP_SURFACES.has(e.id)&&e.promotions.forEach(function(t){m.set(t.id,{promotion:t,surfaceId:e.id})})}),yield o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateQPSurfaces",function(){return o("WAWebModelStorageUtils").getStorage().lock(["quick-promotions"],(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e[0],o=yield t.anyOf(["surfaceId"],i),l=a==null?void 0:a.locale,s=o.map(function(e){var n=e.id,o=m.get(n);if(o==null)return t.remove(n);var a=d(e,o.promotion),i={data:o.promotion,ts:r,tracking:a};return l!=null&&(i.locale=l),m.delete(n),t.merge(n,i)});yield(u||(u=n("Promise"))).all(s);var p=Array.from(m.values()),_=p.map(function(e){var t=e.promotion,n=e.surfaceId,o={id:t.id,surfaceId:n,data:t,ts:r,tracking:c(t)};return l!=null&&(o=babelHelpers.extends({},o,{locale:l})),o});yield t.bulkCreate(_)});return function(t){return e.apply(this,arguments)}})())}).waitUntilCompleted(),yield o("WAWebJobLoadQuickPromotions").loadQuickPromotions("fetch-success")}),p.apply(this,arguments)}function _(e,t){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){return m(e,t)}),f.apply(this,arguments)}function g(e,t){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WATimeUtils").unixTime();return m(e,n,{locale:t})}),h.apply(this,arguments)}l.updateQPSurfacesFromNotification=_,l.updateQPSurfacesFromGraphQLFetch=g}),98);
__d("WAWebCommonCTWAQplHelpers",["WAWebGraphQLServerError","WAWebQplQuickPerformanceLoggerModule"],(function(t,n,r,o,a,i,l){function e(e){var t=e.error,n=e.markerId,r=e.errorAnnotationName,a=e.errorMessageAnnotationName;if(t instanceof o("WAWebGraphQLServerError").GraphQLServerError){var i,l;o("WAWebQplQuickPerformanceLoggerModule").QPL.markerAnnotate(n,{string:(l={},l[r]=(i=t.name)!=null?i:"UNKNOWN",l[a]=t.source.errors.map(function(e){var t;return"["+e.code+"] "+((t=e.message)!=null?t:"")}).join("|"),l)})}else if(t instanceof Error){var s,u,c;o("WAWebQplQuickPerformanceLoggerModule").QPL.markerAnnotate(n,{string:(c={},c[r]=(s=t.name)!=null?s:"UNKNOWN",c[a]=(u=t.message)!=null?u:"",c)})}else{var d;o("WAWebQplQuickPerformanceLoggerModule").QPL.markerAnnotate(n,{string:(d={},d[r]=String(t),d[a]="",d)})}}l.qplAnnotateGraphQLError=e}),98);
__d("WAWebFetchQuickPromotionsQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="23863939843202957"}),null);
__d("WAWebFetchQuickPromotionsQuery.graphql",["WAWebFetchQuickPromotionsQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"nux_ids"},{defaultValue:null,kind:"LocalArgument",name:"trigger_context"}],t=[{kind:"Literal",name:"include_holdouts",value:!0},{kind:"Literal",name:"supports_client_side_filters",value:!0},{kind:"Variable",name:"surface_nux_ids",variableName:"nux_ids"},{kind:"Variable",name:"trigger_context",variableName:"trigger_context"}],r={alias:null,args:null,kind:"ScalarField",name:"surface_nux_id",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"client_ttl_seconds",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"priority",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"is_holdout",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"log_eligibility_waterfall",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"promotion_id",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"is_server_force_pass",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"ab_prop_name",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"surface_delay_in_seconds",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"encrypted_logging_data",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"client_side_dry_run",storageKey:null},g=[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],h=[{kind:"InlineDataFragmentSpread",name:"WAWebFetchQuickPromotionsQuery_QPText",selections:g,args:null,argumentDefinitions:[]}],y={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"title",plural:!1,selections:h,storageKey:null},C={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},b=[{alias:null,args:null,kind:"ScalarField",name:"jpeg_thumbnail",storageKey:null}],v={alias:null,args:null,concreteType:"WAQPMediaDetails",kind:"LinkedField",name:"wa_light_mode_media_details",plural:!1,selections:b,storageKey:null},S={alias:null,args:null,concreteType:"WAQPMediaDetails",kind:"LinkedField",name:"wa_dark_mode_media_details",plural:!1,selections:b,storageKey:null},R={alias:null,args:null,kind:"ScalarField",name:"accessibility_text_for_image",storageKey:null},L={alias:null,args:null,kind:"ScalarField",name:"is_dismissible",storageKey:null},E={alias:null,args:null,concreteType:"QPContentAttributeDescriptor",kind:"LinkedField",name:"content_attributes",plural:!1,selections:[{alias:null,args:null,concreteType:"WhatsappQPColors",kind:"LinkedField",name:"wa_banner_background_color",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"light_mode_highlight_color",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dark_mode_highlight_color",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"light_mode_background_color",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dark_mode_background_color",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"wa_primary_cta_alternative_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"wa_eligible_duration_after_impression_in_seconds",storageKey:null}],storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},I={alias:null,args:null,concreteType:"WAQPContentAttribute",kind:"LinkedField",name:"wa_qp_content_attributes_do_not_use",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},k],storageKey:null},T={alias:null,args:null,kind:"ScalarField",name:"clause_type",storageKey:null},D=[{alias:null,args:null,kind:"ScalarField",name:"filter_name",storageKey:null},{alias:null,args:null,concreteType:"QPFilterParameter",kind:"LinkedField",name:"parameters",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},k],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"passes_if_client_not_supported",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"filter_result",storageKey:null}],x={kind:"InlineDataFragmentSpread",name:"WAWebFetchQuickPromotionsQuery_QPWAFilterClause",selections:[T,{alias:null,args:null,concreteType:"QuickPromotionFlattenedFilter",kind:"LinkedField",name:"filters",plural:!0,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebFetchQuickPromotionsQuery_QPWAFilter",selections:D,args:null,argumentDefinitions:[]}],storageKey:null}],args:null,argumentDefinitions:[]},$={alias:null,args:null,concreteType:"QPUserInteractionInfo",kind:"LinkedField",name:"user_interaction_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"impression_max_instances",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"impression_count_for_user",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dismiss_max_instances",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dismiss_click_count_for_user",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"primary_click_max_instances",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"primary_click_count_for_user",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"secondary_click_count_for_user",storageKey:null}],storageKey:null},P={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"title",plural:!1,selections:g,storageKey:null},N={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},M={alias:null,args:null,concreteType:"QuickPromotionFlattenedFilter",kind:"LinkedField",name:"filters",plural:!0,selections:D,storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebFetchQuickPromotionsQuery",selections:[{alias:null,args:t,concreteType:"QuickPromotionBatchFetchSurface",kind:"LinkedField",name:"quick_promotion_batch_fetch_root",plural:!0,selections:[r,{alias:null,args:null,concreteType:"QuickPromotionSurfaceEligiblePromotionsConnection",kind:"LinkedField",name:"eligible_promotions",plural:!1,selections:[{alias:null,args:null,concreteType:"QuickPromotionSurfaceEligiblePromotionsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{kind:"RequiredField",field:o,action:"LOG",path:"quick_promotion_batch_fetch_root.eligible_promotions.edges.client_ttl_seconds"},{kind:"RequiredField",field:a,action:"LOG",path:"quick_promotion_batch_fetch_root.eligible_promotions.edges.priority"},{kind:"RequiredField",field:i,action:"LOG",path:"quick_promotion_batch_fetch_root.eligible_promotions.edges.is_holdout"},{kind:"RequiredField",field:l,action:"LOG",path:"quick_promotion_batch_fetch_root.eligible_promotions.edges.log_eligibility_waterfall"},{kind:"RequiredField",field:{alias:null,args:null,concreteType:"TimeRange",kind:"LinkedField",name:"time_range",plural:!1,selections:[{kind:"RequiredField",field:s,action:"LOG",path:"quick_promotion_batch_fetch_root.eligible_promotions.edges.time_range.start"},{kind:"RequiredField",field:u,action:"LOG",path:"quick_promotion_batch_fetch_root.eligible_promotions.edges.time_range.end"}],storageKey:null},action:"LOG",path:"quick_promotion_batch_fetch_root.eligible_promotions.edges.time_range"},{alias:null,args:null,concreteType:"QuickPromotion",kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebFetchQuickPromotionsQuery_QuickPromotion",selections:[c,d,m,p,_,f,{alias:null,args:null,concreteType:"QuickPromotionCreative",kind:"LinkedField",name:"creatives",plural:!0,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebFetchQuickPromotionsQuery_QPCreative",selections:[y,{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"content",plural:!1,selections:h,storageKey:null},{alias:null,args:null,concreteType:"QuickPromotionAction",kind:"LinkedField",name:"primary_action",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebFetchQuickPromotionsQuery_QPAction",selections:[y,C],args:null,argumentDefinitions:[]}],storageKey:null},v,S,R,L],args:null,argumentDefinitions:[]}],storageKey:null},E,I,{alias:null,args:null,concreteType:"QuickPromotionFlattenedFilterClause",kind:"LinkedField",name:"contextual_filters_for_wa_do_not_use",plural:!1,selections:[x,{alias:null,args:null,concreteType:"QuickPromotionFlattenedFilterClause",kind:"LinkedField",name:"clauses",plural:!0,selections:[x,{alias:null,args:null,concreteType:"QuickPromotionFlattenedFilterClause",kind:"LinkedField",name:"clauses",plural:!0,selections:[x,{alias:null,args:null,concreteType:"QuickPromotionFlattenedFilterClause",kind:"LinkedField",name:"clauses",plural:!0,selections:[x],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},$],args:null,argumentDefinitions:[]}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebFetchQuickPromotionsQuery",selections:[{alias:null,args:t,concreteType:"QuickPromotionBatchFetchSurface",kind:"LinkedField",name:"quick_promotion_batch_fetch_root",plural:!0,selections:[r,{alias:null,args:null,concreteType:"QuickPromotionSurfaceEligiblePromotionsConnection",kind:"LinkedField",name:"eligible_promotions",plural:!1,selections:[{alias:null,args:null,concreteType:"QuickPromotionSurfaceEligiblePromotionsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[o,a,i,l,{alias:null,args:null,concreteType:"TimeRange",kind:"LinkedField",name:"time_range",plural:!1,selections:[s,u],storageKey:null},{alias:null,args:null,concreteType:"QuickPromotion",kind:"LinkedField",name:"node",plural:!1,selections:[c,d,m,p,_,f,{alias:null,args:null,concreteType:"QuickPromotionCreative",kind:"LinkedField",name:"creatives",plural:!0,selections:[P,{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"content",plural:!1,selections:g,storageKey:null},{alias:null,args:null,concreteType:"QuickPromotionAction",kind:"LinkedField",name:"primary_action",plural:!1,selections:[P,C],storageKey:null},v,S,R,L,N],storageKey:null},E,I,{alias:null,args:null,concreteType:"QuickPromotionFlattenedFilterClause",kind:"LinkedField",name:"contextual_filters_for_wa_do_not_use",plural:!1,selections:[T,M,{alias:null,args:null,concreteType:"QuickPromotionFlattenedFilterClause",kind:"LinkedField",name:"clauses",plural:!0,selections:[T,M,{alias:null,args:null,concreteType:"QuickPromotionFlattenedFilterClause",kind:"LinkedField",name:"clauses",plural:!0,selections:[T,M,{alias:null,args:null,concreteType:"QuickPromotionFlattenedFilterClause",kind:"LinkedField",name:"clauses",plural:!0,selections:[T,M],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},$,N],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:n("WAWebFetchQuickPromotionsQuery_facebookRelayOperation"),metadata:{},name:"WAWebFetchQuickPromotionsQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebFetchQuickPromotionsQuery_QPAction.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={kind:"InlineDataFragment",name:"WAWebFetchQuickPromotionsQuery_QPAction"};a.exports=e}),null);
__d("WAWebFetchQuickPromotionsQuery_QPCreative.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={kind:"InlineDataFragment",name:"WAWebFetchQuickPromotionsQuery_QPCreative"};a.exports=e}),null);
__d("WAWebFetchQuickPromotionsQuery_QPText.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={kind:"InlineDataFragment",name:"WAWebFetchQuickPromotionsQuery_QPText"};a.exports=e}),null);
__d("WAWebFetchQuickPromotionsQuery_QPWAFilter.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={kind:"InlineDataFragment",name:"WAWebFetchQuickPromotionsQuery_QPWAFilter"};a.exports=e}),null);
__d("WAWebFetchQuickPromotionsQuery_QPWAFilterClause.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={kind:"InlineDataFragment",name:"WAWebFetchQuickPromotionsQuery_QPWAFilterClause"};a.exports=e}),null);
__d("WAWebFetchQuickPromotionsQuery_QuickPromotion.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={kind:"InlineDataFragment",name:"WAWebFetchQuickPromotionsQuery_QuickPromotion"};a.exports=e}),null);
__d("WAWebProtobufsQuickPromotionSurfaces.pb",["$InternalEnum","WAProtoConst"],(function(t,n,r,o,a,i,l){var e,s=n("$InternalEnum")({TRUE:1,FALSE:2,UNKNOWN:3}),u=n("$InternalEnum")({PASS_BY_DEFAULT:1,FAIL_BY_DEFAULT:2}),c=n("$InternalEnum")({AND:1,OR:2,NOR:3}),d={},m={},p={},_={};d.name="QP",d.internalSpec={},m.name="QP$FilterClause",m.internalSpec={clauseType:[1,(e=o("WAProtoConst")).FLAGS.REQUIRED|e.TYPES.ENUM,c],clauses:[2,e.FLAGS.REPEATED|e.TYPES.MESSAGE,m],filters:[3,e.FLAGS.REPEATED|e.TYPES.MESSAGE,p]},p.name="QP$Filter",p.internalSpec={filterName:[1,e.FLAGS.REQUIRED|e.TYPES.STRING],parameters:[2,e.FLAGS.REPEATED|e.TYPES.MESSAGE,_],filterResult:[3,e.TYPES.ENUM,s],clientNotSupportedConfig:[4,e.FLAGS.REQUIRED|e.TYPES.ENUM,u]},_.name="QP$FilterParameters",_.internalSpec={key:[1,e.TYPES.STRING],value:[2,e.TYPES.STRING]},l.QP$FilterResult=s,l.QP$FilterClientNotSupportedConfig=u,l.QP$ClauseType=c,l.QPSpec=d,l.QP$FilterClauseSpec=m,l.QP$FilterSpec=p,l.QP$FilterParametersSpec=_}),98);
__d("WAWebFetchQuickPromotions",["Promise","WABase64","WACustomError","WALogger","WAPromiseRetryLoop","WAPromiseTimeout","WAQplTypes","WAWebBackendApi","WAWebBizGatingUtils","WAWebBuildConstants","WAWebCTWAConstants","WAWebCommonCTWAQplHelpers","WAWebFetchAdAccountToken","WAWebFetchQuickPromotionsQuery.graphql","WAWebFetchQuickPromotionsQuery_QPAction.graphql","WAWebFetchQuickPromotionsQuery_QPCreative.graphql","WAWebFetchQuickPromotionsQuery_QPText.graphql","WAWebFetchQuickPromotionsQuery_QPWAFilter.graphql","WAWebFetchQuickPromotionsQuery_QPWAFilterClause.graphql","WAWebFetchQuickPromotionsQuery_QuickPromotion.graphql","WAWebJobUpdateQPSurfaces","WAWebL10NCountryCodes","WAWebNetworkStatus","WAWebOrchestratorNonPersistedJob","WAWebProtobufsQuickPromotionSurfaces.pb","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebRelayClient","WAWebUserPrefsMeUser","WAWebWebp","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R={type:"error"},L=1,E=1e3,k=3e3,I=e!==void 0?e:e=n("WAWebFetchQuickPromotionsQuery.graphql"),T=s!==void 0?s:s=n("WAWebFetchQuickPromotionsQuery_QuickPromotion.graphql"),D=u!==void 0?u:u=n("WAWebFetchQuickPromotionsQuery_QPCreative.graphql"),x=c!==void 0?c:c=n("WAWebFetchQuickPromotionsQuery_QPAction.graphql"),$=d!==void 0?d:d=n("WAWebFetchQuickPromotionsQuery_QPText.graphql"),P=m!==void 0?m:m=n("WAWebFetchQuickPromotionsQuery_QPWAFilterClause.graphql"),N=p!==void 0?p:p=n("WAWebFetchQuickPromotionsQuery_QPWAFilter.graphql");function M(e){o("WAWebCommonCTWAQplHelpers").qplAnnotateGraphQLError({error:e,markerId:o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.FETCH_QUICK_PROMOTIONS,errorAnnotationName:"fetch_promotions_error",errorMessageAnnotationName:"fetch_promotions_error_message"})}function w(){return o("WAWebBizGatingUtils").qpGraphQLEnabled()?o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("fetchQuickPromotions",function(){return o("WAWebBackendApi").frontendSendAndReceive("getUserLocale").then(function(e){return A(e)})}).waitUntilCompleted():(S||(S=n("Promise"))).resolve({type:"not-enabled"})}function A(e){return r("WAWebNetworkStatus").waitIfOffline().then(function(){return o("WAPromiseTimeout").promiseTimeout(F(e),G()).then(function(t){return t.type==="success"?(o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["fetchQuickPromotions: success"]))),o("WAWebJobUpdateQPSurfaces").updateQPSurfacesFromGraphQLFetch(t.quickPromotions,e).then(function(){return o("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.FETCH_QUICK_PROMOTIONS,o("WAQplTypes").QuickLogActionType.SUCCESS),t}).catch(function(e){return o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["fetchQuickPromotions: failed while saving to the DB: ",""])),String(e)).devConsole(e),M(e),o("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.FETCH_QUICK_PROMOTIONS,o("WAQplTypes").QuickLogActionType.FAIL),{type:"error"}})):(t.type,o("WALogger").WARN(g||(g=babelHelpers.taggedTemplateLiteralLoose(['fetchQuickPromotions: failed as "','"'])),t.type),t)}).catch(function(e){if(e instanceof o("WACustomError").TimeoutError)return o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.FETCH_QUICK_PROMOTIONS,"fetch_promotions_end"),o("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.FETCH_QUICK_PROMOTIONS,o("WAQplTypes").QuickLogActionType.ABORTED),o("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(['fetchQuickPromotions: failed as "timeout"']))),{type:"timeout"};throw e})})}function F(e){return o("WAWebQplQuickPerformanceLoggerModule").QPL.markerStart(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.FETCH_QUICK_PROMOTIONS),o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.FETCH_QUICK_PROMOTIONS,"fetch_promotions_start"),o("WAWebFetchAdAccountToken").fetchToken().then(function(t){return t.type==="success"?O(t.token,e).then(function(e){return e.type==="success"?(o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.FETCH_QUICK_PROMOTIONS,"fetch_promotions_end"),e):(o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.FETCH_QUICK_PROMOTIONS,"fetch_promotions_end"),o("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.FETCH_QUICK_PROMOTIONS,o("WAQplTypes").QuickLogActionType.FAIL),e.type==="auth-failure"?o("WAWebFetchAdAccountToken").markTokenAsInvalid():e.type,e)}):(t.type,t)})}function O(e,t){var n=L,r=function(o){return B(e,t).then(function(e){if(e.type==="success")o(e);else{var t=n>0;n--,t||o(e)}}).catch(function(e){var t=n>0;if(n--,!t)throw e})},a=new(o("WAPromiseRetryLoop")).PromiseRetryLoop({name:"fetchQuickPromotions",timer:{algo:{type:"exponential",first:E},max:k},code:r});return a.start(),a.promise()}function B(e,t){var r,a=Array.from(o("WAWebBizGatingUtils").qpSurfaceIdsUsingGraphQL());if(a.length===0)return(S||(S=n("Promise"))).resolve({type:"not-enabled"});var i=(r=o("WAWebUserPrefsMeUser").getMaybeMePnUser())==null?void 0:r.user;if(i==null)return(S||(S=n("Promise"))).resolve({type:"error"});var l=o("WAWebL10NCountryCodes").getCountryShortcodeByPhone(i),s;return o("WAWebRelayClient").fetchQuery(I,{nux_ids:a,trigger_context:{wa_smb_trigger_context:{is_from_wa_smb:!0,app_version:o("WAWebBuildConstants").VERSION_BASE,country:l,locale:t}}},{environmentType:"facebook",accessToken:e,getInlineDataReader:function(t){s=t}}).then(function(e){if(e==null)return R;var t=e.quick_promotion_batch_fetch_root,n=new Map;return a.forEach(function(e){var t=H(e);if(t==null){o("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["fetchQuickPromotions: could not find "," in reverse mapping"])),e).sendLogs("quick-promotions-graphql-missing-surface");return}n.set(e,{id:t,promotions:[]})}),t.forEach(function(e){var t=e.surface_nux_id,r=e.eligible_promotions;if(!(t==null||r==null)){var a=n.get(t);if(a==null){o("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["fetchQuickPromotions: received unexpected nux ID ",""])),t);return}var i=r.edges;i.forEach(function(e){if(e!=null){var t=e.node,n=e.priority,r=e.time_range,i=e.is_holdout,l=e.log_eligibility_waterfall,u=e.client_ttl_seconds;if(t!=null){var c=s(T,t),d=c.promotion_id,m=c.creatives,p=c.is_server_force_pass,_=c.content_attributes,f=c.ab_prop_name,g=c.wa_qp_content_attributes_do_not_use,h=c.contextual_filters_for_wa_do_not_use,y=c.surface_delay_in_seconds,C=c.user_interaction_info,S=c.encrypted_logging_data,R=c.client_side_dry_run;if(!(d==null||p==null||_==null||y==null)){var L=_.wa_eligible_duration_after_impression_in_seconds,E=_.wa_banner_background_color,k=_.wa_primary_cta_alternative_url;if(L!=null){var I=m.map(function(e){return s(D,e)}),P=I[0],N,M,w,A,F;if(P!=null){var O=P.primary_action,B=P.title,W=P.content,q=P.wa_dark_mode_media_details,V=P.wa_light_mode_media_details,H=P.accessibility_text_for_image;if(B==null||W==null)return;if(M=s($,B).text,w=s($,W).text,O!=null){var G=s(x,O),z=G.title,j=G.url;if(z!=null){var K=s($,z);K.text!=null&&(N={text:K==null?void 0:K.text,deepLink:j,universalLink:k})}}if(A=P.is_dismissible,H!=null){var Q;try{(V==null?void 0:V.jpeg_thumbnail)!=null&&(Q={elementValue:new Uint8Array(o("WABase64").decodeB64(V.jpeg_thumbnail))})}catch(e){o("WALogger").ERROR(b||(b=babelHelpers.taggedTemplateLiteralLoose(["fetchQuickPromotions: failed to decode base64 for light mode media details"])))}var X;try{(q==null?void 0:q.jpeg_thumbnail)!=null&&(X={elementValue:new Uint8Array(o("WABase64").decodeB64(q.jpeg_thumbnail))})}catch(e){o("WALogger").ERROR(v||(v=babelHelpers.taggedTemplateLiteralLoose(["fetchQuickPromotions: failed to decode base64 for dark mode media details"])))}F={description:H,light:Q,dark:X}}}if(!(M==null||w==null||A==null)){var Y=E!=null?{lightHighlight:E.light_mode_highlight_color,lightBackground:E.light_mode_background_color,darkHighlight:E.dark_mode_highlight_color,darkBackground:E.dark_mode_background_color}:void 0,J=g.reduce(function(e,t){var n=t.name,r=t.value;return n==null||r==null||e.push({key:n,value:r}),e},[]),Z;if(C!=null){var ee=C.dismiss_click_count_for_user,te=C.impression_count_for_user,ne=C.primary_click_count_for_user,re=C.secondary_click_count_for_user,oe=C.dismiss_max_instances,ae=C.impression_max_instances,ie=C.primary_click_max_instances;if(te==null||ne==null||re==null||ee==null||ae==null||ie==null||oe==null)return;Z={promotionConfig:{maxImpressions:ae,maxDismisses:oe,maxPrimaryClicks:ie,maxSecondaryClicks:0},userInfo:{impressionCount:te,primaryClickCount:ne,secondaryClickCount:re,dismissClickCount:ee}}}var le=h!=null?U(h,s):void 0,se=S!=null?{elementValue:o("WAWebWebp").stringToUint8(S)}:void 0,ue={id:d,qpConfigPriority:n,qpConfigDismissable:A?"true":"false",qpConfigEligibilityDurationMs:L*1e3,qpConfigEndTimeSeconds:r.end,qpConfigExperimentKey:f,qpConfigExposureHoldout:i?"true":"false",qpConfigForcePass:p?"true":"false",qpConfigLogEligibilityWaterfall:l?"true":"false",qpConfigStartTimeSeconds:r.start,qpConfigSurfaceDelayTimeSeconds:y,qpConfigTtlSeconds:u,qpConfigClientSideDryRun:R===!0?"true":"false",titleElementValue:M,textElementValue:w,colors:Y,contentAttributes:{attribute:J},image:F,primaryAction:N,qpConfigPacing:Z,qpConfigFilterRules:le,header:void 0,instanceId:void 0,qpConfigDeterministic:"true",qpConfigImpressionCooldown:-1,qpConfigInstanceLogData:se,qpConfigMaxImpressions:-1,qpConfigTemplateName:"whatsapp_banner",qpConfigTriggersTrigger:[],secondaryAction:void 0};a.promotions.push(ue)}}}}}})}}),{type:"success",quickPromotions:Array.from(n.values(),function(e){var t=e.id,n=e.promotions;return{id:t,promotions:[].concat(n)}})}}).catch(function(e){return M(e),o("WAWebFetchAdAccountToken").hasGraphQLAuthError(e)?{type:"auth-failure"}:R})}function W(e){switch(e){case"AND_TYPE":return o("WAWebProtobufsQuickPromotionSurfaces.pb").QP$ClauseType.AND;case"OR_TYPE":return o("WAWebProtobufsQuickPromotionSurfaces.pb").QP$ClauseType.OR;case"NOR_TYPE":return o("WAWebProtobufsQuickPromotionSurfaces.pb").QP$ClauseType.NOR;default:throw r("err")("Unexpected future filter clause type")}}function q(e){switch(e){case"PASS":return o("WAWebProtobufsQuickPromotionSurfaces.pb").QP$FilterResult.TRUE;case"FAIL":return o("WAWebProtobufsQuickPromotionSurfaces.pb").QP$FilterResult.FALSE;case"UNKNOWN":return o("WAWebProtobufsQuickPromotionSurfaces.pb").QP$FilterResult.UNKNOWN;default:throw r("err")("Unexpected future filter result")}}function U(e,t){var n=t(P,e),r=n.clause_type,o=n.filters,a=e.clauses;if(r!=null){var i=a!=null?a.map(function(e){return U(e,t)}).filter(Boolean):[],l=o.map(function(e){return V(e,t)}).filter(Boolean),s={clauseType:W(r),clauses:i,filters:l};return s}}function V(e,t){var n=t(N,e),r=n.filter_name,a=n.parameters,i=n.passes_if_client_not_supported,l=n.filter_result;if(r!=null){var s=a.reduce(function(e,t){var n=t.key,r=t.value;return n==null||r==null||e.push({key:n,value:r}),e},[]),u={filterName:r,parameters:s,clientNotSupportedConfig:i===!0?o("WAWebProtobufsQuickPromotionSurfaces.pb").QP$FilterClientNotSupportedConfig.PASS_BY_DEFAULT:o("WAWebProtobufsQuickPromotionSurfaces.pb").QP$FilterClientNotSupportedConfig.FAIL_BY_DEFAULT,filterResult:l!=null?q(l):void 0};return u}}function H(e){for(var t of o("WAWebCTWAConstants").KNOWN_QP_SURFACES.entries()){var n=t[0],r=t[1];if(r===e)return n}}function G(){return o("WAWebFetchAdAccountToken").getMaximumAdAccountFetchTimeoutSeconds()*1e3+o("WAWebCTWAConstants").QP_FETCH_TIMEOUT_MS*(L+1)}l.fetchQuickPromotions=w}),98);
__d("WAWebWamEnumWebcWindowNavigatorWebdriverType",[],(function(t,n,r,o,a,i){var e=Object.freeze({FALSE:0,TRUE:1,UNDEFINED:2});i.WEBC_WINDOW_NAVIGATOR_WEBDRIVER_TYPE=e}),66);
__d("WAWebBrowserFeatures",["WAMd5","WAPlatformEstimate"],(function(t,n,r,o,a,i,l){"use strict";function e(){return navigator.plugins.length}function s(){var e,t;return(e=(t=navigator.mimeTypes)==null?void 0:t.length)!=null?e:0}function u(){return"Notification"in window&&Notification.permission!=="denied"}function c(){return"pdfViewerEnabled"in navigator&&navigator.pdfViewerEnabled===!0}function d(){var e,t;return screen.height!==((e=screen)==null?void 0:e.availHeight)||screen.width!==((t=screen)==null?void 0:t.availWidth)}function m(){return"share"in navigator&&"canShare"in navigator}function p(){return"chrome"in window}function _(){return window.history.length}function f(){return window.innerWidth+"x"+window.innerHeight}function g(){try{var e=document.createElement("canvas"),t=e.getContext("2d");return t==null?"":(e.width=120,e.height=20,t.font="14px 'Arial'",t.fillStyle="#fff",t.fillRect(0,0,120,20),t.fillStyle="rgba(102, 204, 0, 0.7)",t.fillText("whatsapp web",2,15),r("WAMd5")(e.toDataURL()))}catch(e){return""}}function h(){return{pluginCount:e(),mimeTypeCount:s(),hasNotificationPermission:u(),isPDFViewerEnabled:c(),hasTaskbar:d(),hasWebShare:m(),hasChrome:p(),platformEstimate:r("WAPlatformEstimate")(),historyLength:_(),viewPortSize:f(),canvasFingerprint:g()}}l.default=h}),98);
__d("WAWebWamFingerprint",["WAExternalInjectedSources","WAFPUtils","WAWebBrowserFeatures","WAWebDeviceFeatures"],(function(t,n,r,o,a,i,l){function e(){return babelHelpers.extends({webdriver:self.navigator.webdriver,browserEngine:o("WAFPUtils").DETECTED_BROWSER_ENGINE},r("WAWebBrowserFeatures")(),r("WAExternalInjectedSources")(),r("WAWebDeviceFeatures")())}l.default=e}),98);
__d("WAWebWebcFingerprintWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumBrowserEngineName","WAWebWamEnumPlatformName","WAWebWamEnumWebcWindowNavigatorWebdriverType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WebcFingerprint:[1704,{browserEngine:[26,o("WAWebWamEnumBrowserEngineName").BROWSER_ENGINE_NAME],connectionRtt:[37,e.TYPES.INTEGER],cpuMake:[38,e.TYPES.STRING],deviceMemory:[39,e.TYPES.STRING],extentionIds:[27,e.TYPES.STRING],externalSources:[36,e.TYPES.STRING],gpuMake:[40,e.TYPES.STRING],hasChrome:[28,e.TYPES.BOOLEAN],hasTaskbar:[29,e.TYPES.BOOLEAN],hasWebShare:[30,e.TYPES.BOOLEAN],historyLength:[41,e.TYPES.INTEGER],mimeTypeCount:[31,e.TYPES.INTEGER],notificationPermission:[32,e.TYPES.BOOLEAN],pdfViewerEnabled:[33,e.TYPES.BOOLEAN],peripherals:[42,e.TYPES.STRING],platformEstimate:[34,o("WAWebWamEnumPlatformName").PLATFORM_NAME],pluginCount:[35,e.TYPES.INTEGER],screenResolution:[43,e.TYPES.STRING],sessionStorageLength:[44,e.TYPES.INTEGER],timezone:[45,e.TYPES.STRING],touchPresence:[46,e.TYPES.BOOLEAN],viewportSize:[47,e.TYPES.STRING],waUlCookie:[48,e.TYPES.STRING],webcCanvasFingerprint:[25,e.TYPES.STRING],webcWebglFingerprint:[24,e.TYPES.STRING],webcWebglRenderer:[23,e.TYPES.STRING],webcWebglVendor:[22,e.TYPES.STRING],webcWindowNavigatorWebdriver:[21,o("WAWebWamEnumWebcWindowNavigatorWebdriverType").WEBC_WINDOW_NAVIGATOR_WEBDRIVER_TYPE]},[1,1,1],"regular"]},{WebcFingerprint:[]});l.WebcFingerprintWamEvent=s}),98);
__d("WAWebWamFingerprintReporter",["WAWebWamEnumWebcWindowNavigatorWebdriverType","WAWebWamFingerprint","WAWebWebcFingerprintWamEvent"],(function(t,n,r,o,a,i,l){function e(){var e=r("WAWebWamFingerprint")(),t={webcWindowNavigatorWebdriver:e.webdriver===!0?o("WAWebWamEnumWebcWindowNavigatorWebdriverType").WEBC_WINDOW_NAVIGATOR_WEBDRIVER_TYPE.TRUE:e.webdriver===!1?o("WAWebWamEnumWebcWindowNavigatorWebdriverType").WEBC_WINDOW_NAVIGATOR_WEBDRIVER_TYPE.FALSE:o("WAWebWamEnumWebcWindowNavigatorWebdriverType").WEBC_WINDOW_NAVIGATOR_WEBDRIVER_TYPE.UNDEFINED,browserEngine:e.browserEngine,hasChrome:e.hasChrome,hasTaskbar:e.hasTaskbar,hasWebShare:e.hasWebShare,mimeTypeCount:e.mimeTypeCount,notificationPermission:e.hasNotificationPermission,pdfViewerEnabled:e.isPDFViewerEnabled,pluginCount:e.pluginCount,platformEstimate:e.platformEstimate,extentionIds:e.extensionIds,externalSources:e.externalSources,historyLength:e.historyLength,viewportSize:e.viewPortSize,cpuMake:e.cpuPlatform,deviceMemory:e.deviceMemory,screenResolution:e.screenResolution,connectionRtt:e.connectionRoundTripTime,touchPresence:e.touchPresence,sessionStorageLength:e.sessionStorageLength,webcCanvasFingerprint:e.canvasFingerprint},n=new(o("WAWebWebcFingerprintWamEvent")).WebcFingerprintWamEvent(t);n.commit()}l.logFingerprintToWam=e}),98);
__d("WAWebFingerprintJob",["Promise","WAJobOrchestratorTypes","WAWebOrchestratorNonPersistedJob","WAWebWamFingerprintReporter"],(function(t,n,r,o,a,i,l){var e;function s(){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("collectWebFingerprints",function(){return o("WAWebWamFingerprintReporter").logFingerprintToWam(),(e||(e=n("Promise"))).resolve()},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.LOW}).waitUntilCompleted()}l.sendWamFingerprintJob=s}),98);
__d("WAWebReportDbVerionsJob",["WAJobOrchestratorTypes","WAWebLocalSchemaVersions","WAWebOrchestratorNonPersistedJob","WAWebSchemaVersions","WAWebWebDbVersionNonAnonymousWamEvent","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("reportDbVersions",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebLocalSchemaVersions").getLocalSchemaVersions();e.forEach(function(e,t){new(o("WAWebWebDbVersionNonAnonymousWamEvent")).WebDbVersionNonAnonymousWamEvent({webDbName:o("WAWebSchemaVersions").convertDBName(t),webDbVersionNumber:e}).commit()})}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.BEST_EFFORT,maxTimeoutMs:1e3*30}).waitUntilCompleted()}l.reportDbVersionsJob=e}),98);
__d("WAWebSyncdWamUtils",["WABase64","WASyncdConst","WATimeUtils","WAWebGetSyncKey","WAWebSchemaSyncActions","WAWebSyncdUtils","WAWebWamEnumMutationCountBucket","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){function e(){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=new Map,t=yield o("WAWebSchemaSyncActions").getSyncActionsTable().all();return t.map(function(t){var n,r=o("WAWebSyncdUtils").getMutationNameFromIndex(t.index),a=(n=e.get(r))!=null?n:{action:r,applied:0,invalid:0,orphan:0,unsupported:0,failed:0};switch(t.actionState){case o("WASyncdConst").SyncActionState.Success:case o("WASyncdConst").SyncActionState.Skipped:{a.applied++;break}case o("WASyncdConst").SyncActionState.Malformed:{a.invalid++;break}case o("WASyncdConst").SyncActionState.Orphan:{a.orphan++;break}case o("WASyncdConst").SyncActionState.Unsupported:{a.unsupported++;break}case o("WASyncdConst").SyncActionState.Failed:{a.failed++;break}}e.set(r,a)}),e}),s.apply(this,arguments)}function u(e){if(e<0)throw r("err")("cannot convert negative number to a bucket");return e===0?o("WAWebWamEnumMutationCountBucket").MUTATION_COUNT_BUCKET.ZERO:e===1?o("WAWebWamEnumMutationCountBucket").MUTATION_COUNT_BUCKET.ONE:e<10?o("WAWebWamEnumMutationCountBucket").MUTATION_COUNT_BUCKET.LT10:e<100?o("WAWebWamEnumMutationCountBucket").MUTATION_COUNT_BUCKET.LT100:e<500?o("WAWebWamEnumMutationCountBucket").MUTATION_COUNT_BUCKET.LT500:e<1e3?o("WAWebWamEnumMutationCountBucket").MUTATION_COUNT_BUCKET.LT1K:e<5e3?o("WAWebWamEnumMutationCountBucket").MUTATION_COUNT_BUCKET.LT5K:o("WAWebWamEnumMutationCountBucket").MUTATION_COUNT_BUCKET.GTE5K}function c(){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebSchemaSyncActions").getSyncActionsTable().get('["primary_version","session_start"]');return e==null?void 0:e.timestamp}),d.apply(this,arguments)}function m(){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebGetSyncKey").getAllSyncKeysInTransaction(),t=yield o("WAWebSchemaSyncActions").getSyncActionsTable().all(),n=yield c(),r=n==null?void 0:Math.round((o("WATimeUtils").unixTimeMs()-n)/(1e3*3600*24));return _(e,t,r)}),p.apply(this,arguments)}function _(e,t,n){var r=t.map(function(e){return o("WABase64").encodeB64(e.keyId)}),a=Array.from(new Set(r)),i=new Map;for(var l of r)i.set(l,(i.get(l)||0)+1);var s=Array.from(i.values()).sort(),u=s.length,c=Math.floor(u*.8)-1,d=Math.floor(u*.95)-1;return{totalKeyCount:e.length,keysUsedInSnapshotCount:a.length,p80MuationsPerKey:s[c],p95MuationsPerKey:s[d],syncdSessionLengthDays:n}}l.generateActionStatCounts=e,l.convertToBucket=u,l.getKeyStats=m,l.getKeyStatsInternal=_}),98);
__d("WAWebSyncdReportKeyStatsJob",["WAJobOrchestratorTypes","WAWebOrchestratorNonPersistedJob","WAWebSyncdKeyCountWamEvent","WAWebSyncdWamUtils","asyncToGeneratorRuntime","gkx"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("reportSyncdKeyStats",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!r("gkx")("26258")){var e=yield o("WAWebSyncdWamUtils").getKeyStats(),t={keysUsedInSnapshotCount:e.keysUsedInSnapshotCount,p80MuationsPerKey:e.p80MuationsPerKey,p95MuationsPerKey:e.p95MuationsPerKey,totalKeyCount:e.totalKeyCount};e.syncdSessionLengthDays!=null&&(t.syncdSessionLengthDays=e.syncdSessionLengthDays),new(o("WAWebSyncdKeyCountWamEvent")).SyncdKeyCountWamEvent(t).commit()}}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.BEST_EFFORT,maxTimeoutMs:1e3*30}).waitUntilCompleted()}l.reportSyncdKeyStatsJob=e}),98);
__d("WAWebSyncdReportSyncdStatJob",["WAJobOrchestratorTypes","WAWebMdAppStateSyncMutationStatsWamEvent","WAWebOrchestratorNonPersistedJob","WAWebSyncdWamUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("reportSyncdStats",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebSyncdWamUtils").generateActionStatCounts();for(var t of e.values()){var n;new(o("WAWebMdAppStateSyncMutationStatsWamEvent")).MdAppStateSyncMutationStatsWamEvent({syncdAction:t.action,applied:(n=o("WAWebSyncdWamUtils")).convertToBucket(t.applied),invalid:n.convertToBucket(t.invalid),orphan:n.convertToBucket(t.orphan),unsupported:n.convertToBucket(t.unsupported),failed:n.convertToBucket(t.failed)}).commit()}}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.BEST_EFFORT,maxTimeoutMs:1e3*30}).waitUntilCompleted()}),s.apply(this,arguments)}l.reportSyncdStatsJob=e}),98);
__d("WAWebTasksDefinitions",["Promise","WALogger","WATaskScheduler","WATimeUtils","WAWebABProps","WAWebABPropsLocalStorage","WAWebAbPropsSyncJob","WAWebAccountLinkingGatingUtils","WAWebAccountLinkingScheduledJobs","WAWebApiChat","WAWebApiParticipantStore","WAWebApiTasksScheduledTime","WAWebApiTextStatus","WAWebBizGatingUtils","WAWebCleanUtmJob","WAWebContactSyncBridge","WAWebDBPurgeExpiredRecords","WAWebDBReportingTokenUtils","WAWebDownloads3PDSignalsDatabaseApi","WAWebFalcoStorageClearJob","WAWebFetchQuickPromotions","WAWebFingerprintJob","WAWebGalaxyFlowsUtils","WAWebInactiveGroupLidMigrationJob","WAWebLogDailyStatsJob","WAWebLogHistorySyncStatusAfterPairingJob","WAWebMessagingGatingUtils","WAWebMobilePlatforms","WAWebNewsletterCleanupTasks","WAWebNonAddressBookContactsJob","WAWebNonMessageDataRequestMediaHandlingUtils","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebReportDbVerionsJob","WAWebRestartRecentSyncJob","WAWebSyncContactsJob","WAWebSyncdAntiTampering","WAWebSyncdReportKeyStatsJob","WAWebSyncdReportSyncdStatJob","WAWebSyncdRequestAllSyncdMissingKeysJob","WAWebSyncdSyncAllCollectionsJob","WAWebTasksTaskType","WAWebUserPrefsHistorySync","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime","cr:4857","cr:4940","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T=[(I=o("WAWebTasksTaskType")).TaskType.CLEAN_TC_TOKENS,I.TaskType.LOG_DAILY_STATS,I.TaskType.ROTATE_KEY,I.TaskType.SYNC_AB_PROPS,I.TaskType.SYNC_CONTACTS,I.TaskType.REPORT_SYNCD_ACTION_STAT,I.TaskType.LT_HASH_CHECK,I.TaskType.REQUEST_ALL_SYNCD_MISSING_KEYS,I.TaskType.REPORT_SYNCD_KEY_STATS,I.TaskType.SYNCD_SYNC_ALL_COLLECTIONS,I.TaskType.CLEAN_ORPHAN_ADD_ONS,I.TaskType.CLEAN_EXPIRED_UTM,I.TaskType.SEND_NON_MESSAGE_DATA_REQUEST,I.TaskType.LOG_HISTORY_SYNC_STATUS_AFTER_PAIRING,I.TaskType.DELETE_NEWSLETTER_PREVIEW_CHATS,I.TaskType.REPORT_DB_VERSIONS,I.TaskType.UPDATE_EXPIRED_TEXT_STATUS,I.TaskType.RESTART_RECENT_SYNC,I.TaskType.CLEANUP_REPORTING_TABLE,I.TaskType.WAFFLE_SCHEDULED_TASKS,I.TaskType.CLEAR_GALAXY_FLOWS_CACHE,I.TaskType.CLEAR_FALCO_BUFFER,I.TaskType.SEND_WAM_FINGERPRINT,I.TaskType.INACTIVE_GROUP_LID_MIGRATION],D=[I.TaskType.FETCH_QUICK_PROMOTIONS,I.TaskType.CLEANUP_3PD_SIGNALS_TABLE],x=[I.TaskType.LOG_DB_ROW_COUNTS,I.TaskType.MONITOR_DB_STORAGE];function $(t){switch(t){case o("WAWebTasksTaskType").TaskType.MONITOR_DB_STORAGE:return(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(r("gkx")("26258"))return o("WATaskScheduler").DO_NOT_RESCHEDULE;var t=yield n("cr:4857")==null?void 0:n("cr:4857").shouldMonitorDbStorageUsageJob();return t?o("WATimeUtils").HOUR_SECONDS:o("WATaskScheduler").DO_NOT_RESCHEDULE});return function(t){return e.apply(this,arguments)}})();case o("WAWebTasksTaskType").TaskType.CLEAN_TC_TOKENS:return(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(t)o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["CleanTcToken skip first run"])));else try{yield o("WAWebApiChat").pruneExpiredTcTokens(),yield o("WAWebApiChat").pruneExpiredOrphanTcTokens()}catch(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Failed to delete the expired TcTokens with error: ",""])),e).verbose().devConsole(e)}return o("WATimeUtils").DAY_SECONDS});return function(e){return t.apply(this,arguments)}})();case o("WAWebTasksTaskType").TaskType.UPDATE_EXPIRED_TEXT_STATUS:return(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e)o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Update expired text status skip first run"])));else try{yield o("WAWebApiTextStatus").updateExpiredTextStatusOfContact()}catch(e){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Failed to update the expired text status of contacts with error: ",""])),e).verbose().devConsole(e)}return o("WATimeUtils").DAY_SECONDS});return function(t){return e.apply(this,arguments)}})();case o("WAWebTasksTaskType").TaskType.LOG_DAILY_STATS:return function(){return o("WAWebLogDailyStatsJob").logDailyStatsJob().catch(function(e){o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Failed to log daily stats: ",""])),e).verbose().devConsole(e)}).then(function(){return o("WATimeUtils").DAY_SECONDS})};case o("WAWebTasksTaskType").TaskType.LOG_DB_ROW_COUNTS:{if(!r("gkx")("26258")){var a=120,i=7200;return function(){return self.setTimeout(function(){n("cr:4940")==null||n("cr:4940").logStorageTableRowCounts().catch(function(e){o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Failed to log table row counts from a task: ",""])),e).verbose().devConsole(e)})},a*1e3),(k||(k=n("Promise"))).resolve(i)}}return function(){return(k||(k=n("Promise"))).resolve(o("WATaskScheduler").DO_NOT_RESCHEDULE)}}case o("WAWebTasksTaskType").TaskType.ROTATE_KEY:return(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return e?o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["RotateKeyTask skip first run"]))):yield o("WAWebPersistedJobManager").getJobManager().waitUntilCompleted(o("WAWebPersistedJobDefinitions").jobSerializers.rotateKey()),27*o("WATimeUtils").DAY_SECONDS});return function(t){return e.apply(this,arguments)}})();case o("WAWebTasksTaskType").TaskType.SYNC_AB_PROPS:return(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return e||(yield o("WAWebAbPropsSyncJob").syncABPropsTask()),o("WAWebABPropsLocalStorage").getRefresh()});return function(t){return e.apply(this,arguments)}})();case o("WAWebTasksTaskType").TaskType.SYNC_CONTACTS:return(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!e){try{yield o("WAWebNonAddressBookContactsJob").getNonAddressBookContactsAndMarkAllContactsDirty()}catch(e){o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Failed to sync non-address book contacts with error: ",""])),e).verbose().devConsole(e)}try{yield o("WAWebContactSyncBridge").doFullContactSync()}catch(e){o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["syncContacts: contact sync failed, error: ",""])),e).verbose().tags("non-sad","contact-sync").sendLogs("syncContacts: contact sync failed")}}return o("WAWebSyncContactsJob").getContactSyncRefreshSeconds()});return function(t){return e.apply(this,arguments)}})();case o("WAWebTasksTaskType").TaskType.REPORT_SYNCD_ACTION_STAT:return(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return e||(yield o("WAWebSyncdReportSyncdStatJob").reportSyncdStatsJob()),o("WATimeUtils").DAY_SECONDS});return function(t){return e.apply(this,arguments)}})();case o("WAWebTasksTaskType").TaskType.LT_HASH_CHECK:return(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebABProps").getABPropConfigValue("lthash_check_hours");return t===0?24*o("WATimeUtils").HOUR_SECONDS:(e||(yield o("WAWebSyncdAntiTampering").checkLtHash("abc")),t*o("WATimeUtils").HOUR_SECONDS)});return function(t){return e.apply(this,arguments)}})();case o("WAWebTasksTaskType").TaskType.REQUEST_ALL_SYNCD_MISSING_KEYS:return(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return e||(yield o("WAWebSyncdRequestAllSyncdMissingKeysJob").requestAllSyncdMissingKeysJob()),o("WATimeUtils").HOUR_SECONDS*6});return function(t){return e.apply(this,arguments)}})();case o("WAWebTasksTaskType").TaskType.REPORT_SYNCD_KEY_STATS:return(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return e||(yield o("WAWebSyncdReportKeyStatsJob").reportSyncdKeyStatsJob()),r("gkx")("26258")?o("WATimeUtils").DAY_SECONDS*3:o("WATimeUtils").DAY_SECONDS});return function(t){return e.apply(this,arguments)}})();case o("WAWebTasksTaskType").TaskType.SYNCD_SYNC_ALL_COLLECTIONS:return(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebABProps").getABPropConfigValue("syncd_periodic_sync_days");return t===0?(o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncdPeriodicSyncDays is 0, skipping sync"]))),o("WATimeUtils").DAY_SECONDS):(e||(yield o("WAWebSyncdSyncAllCollectionsJob").syncdSyncAllCollectionsJob()),o("WATimeUtils").DAY_SECONDS*t)});return function(t){return e.apply(this,arguments)}})();case o("WAWebTasksTaskType").TaskType.CLEAN_ORPHAN_ADD_ONS:{var l=30,E=90;return n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{yield o("WAWebDBPurgeExpiredRecords").purgeExpiredOrphanRecords(l,E)}catch(e){o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to delete the expired orphan add-on messages with error: ",""])),e).verbose().devConsole(e)}return o("WATimeUtils").DAY_SECONDS})}case o("WAWebTasksTaskType").TaskType.CLEAN_PAST_PARTICIPANTS:return n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{yield o("WAWebApiParticipantStore").pruneExpiredPastParticipants()}catch(e){o("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["Failed to delete the expired orphan reactions with error: ",""])),e).verbose().devConsole(e)}return o("WATimeUtils").DAY_SECONDS});case o("WAWebTasksTaskType").TaskType.CLEAN_EXPIRED_UTM:return function(){return o("WAWebBizGatingUtils").isUtmTrackingEnabled()?o("WAWebCleanUtmJob").cleanExpiredUtmJob().catch(function(e){o("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["Failed to clean expired UTM: ",""])),e).verbose().devConsole(e)}).then(function(){return o("WATimeUtils").DAY_SECONDS}):(k||(k=n("Promise"))).resolve(o("WATaskScheduler").DO_NOT_RESCHEDULE)};case o("WAWebTasksTaskType").TaskType.SEND_NON_MESSAGE_DATA_REQUEST:return n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return yield o("WAWebNonMessageDataRequestMediaHandlingUtils").retryNonMessageDataRequestJob(),o("WATimeUtils").HOUR_SECONDS*23});case o("WAWebTasksTaskType").TaskType.DELETE_NEWSLETTER_PREVIEW_CHATS:return n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return yield o("WAWebNewsletterCleanupTasks").deletePreviewNewsletters(),o("WATimeUtils").HOUR_SECONDS*4});case o("WAWebTasksTaskType").TaskType.REPORT_DB_VERSIONS:return n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return yield o("WAWebReportDbVerionsJob").reportDbVersionsJob(),o("WATimeUtils").DAY_SECONDS*3});case o("WAWebTasksTaskType").TaskType.LOG_HISTORY_SYNC_STATUS_AFTER_PAIRING:return n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("WAWebUserPrefsMultiDevice").getPairingTimestamp();if(e!=null){var t,n=(t=yield o("WAWebUserPrefsHistorySync").getHistorySyncStatusAfterPairingLoggingCount())!=null?t:0;return n>=5?(o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[history sync] do not schedule job for logging history sync status as we've logged for more than 4 times."]))),o("WATaskScheduler").DO_NOT_RESCHEDULE):(yield o("WAWebLogHistorySyncStatusAfterPairingJob").logHistorySyncStatusAfterPairingJob(e,n),n===0?o("WATimeUtils").MINUTE_SECONDS*5:o("WATimeUtils").MINUTE_SECONDS*10)}return 10});case o("WAWebTasksTaskType").TaskType.RESTART_RECENT_SYNC:return n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("WAWebUserPrefsMultiDevice").getPairingTimestamp();if(e!=null){var t=(o("WATimeUtils").unixTime()-e)/60;return t>=5&&(yield o("WAWebRestartRecentSyncJob").restartRecentSyncJob()),o("WATimeUtils").MINUTE_SECONDS*5}return 10});case o("WAWebTasksTaskType").TaskType.CLEANUP_REPORTING_TABLE:return n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{yield o("WAWebDBReportingTokenUtils").cleanupReportingTable(o("WAWebMessagingGatingUtils").getReportingTagCleanupDays()),yield o("WAWebDBReportingTokenUtils").cleanupReportingTokenAndContent(o("WAWebMessagingGatingUtils").getReportingTokenCleanupDays())}catch(e){o("WALogger").ERROR(v||(v=babelHelpers.taggedTemplateLiteralLoose(["Failed to cleanup reporting token table: ",""])),e).tags("messaging","wa-ice","report-token").devConsole(e)}return o("WATimeUtils").DAY_SECONDS});case o("WAWebTasksTaskType").TaskType.CLEANUP_3PD_SIGNALS_TABLE:return n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{o("WAWebABProps").getABPropConfigValue("ctwa_download_3pd_signals")&&(yield o("WAWebDownloads3PDSignalsDatabaseApi").cleanup3PDSignalsTable())}catch(e){o("WALogger").ERROR(S||(S=babelHelpers.taggedTemplateLiteralLoose(["Failed to cleanup 3PD Signals table: ",""])),e).tags("3pd-signals").devConsole(e)}return o("WATimeUtils").DAY_SECONDS});case o("WAWebTasksTaskType").TaskType.FETCH_QUICK_PROMOTIONS:return n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WALogger").LOG(R||(R=babelHelpers.taggedTemplateLiteralLoose(["fetchQuickPromotions: fetching quick promotions"]))),yield o("WAWebFetchQuickPromotions").fetchQuickPromotions(),o("WAWebBizGatingUtils").qpGraphQLFetchIntervalMinutes()*o("WATimeUtils").MINUTE_SECONDS});case o("WAWebTasksTaskType").TaskType.WAFFLE_SCHEDULED_TASKS:return n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebAccountLinkingGatingUtils").accountLinkingEnabled()&&(yield o("WAWebAccountLinkingScheduledJobs").scheduledWaffleJobs()),o("WATimeUtils").DAY_SECONDS});case o("WAWebTasksTaskType").TaskType.CLEAR_GALAXY_FLOWS_CACHE:return n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return yield o("WAWebGalaxyFlowsUtils").clearGalaxyFlowsCache(),7*o("WATimeUtils").DAY_SECONDS});case o("WAWebTasksTaskType").TaskType.CLEAR_FALCO_BUFFER:return n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return yield o("WAWebFalcoStorageClearJob").clearFalcoBufferJob(),o("WATimeUtils").DAY_SECONDS});case o("WAWebTasksTaskType").TaskType.SEND_WAM_FINGERPRINT:return n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return yield o("WAWebFingerprintJob").sendWamFingerprintJob(),o("WATimeUtils").DAY_SECONDS*2});case o("WAWebTasksTaskType").TaskType.INACTIVE_GROUP_LID_MIGRATION:return n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{yield o("WAWebInactiveGroupLidMigrationJob").migrateInactiveGroupsToLid()}catch(e){o("WALogger").ERROR(L||(L=babelHelpers.taggedTemplateLiteralLoose(["Failed to run LID inactive group migration: ",""])),e).verbose().devConsole(e)}return o("WATimeUtils").DAY_SECONDS})}}function P(){return{scheduledTimeResolver:{get:function(t){return o("WAWebApiTasksScheduledTime").getTaskScheduledTime(String(t))},set:function(t,n){return o("WAWebApiTasksScheduledTime").updateTaskScheduledTime(String(t),n)}}}}function N(e){var t=$(e);t!=null&&(o("WALogger").LOG(E||(E=babelHelpers.taggedTemplateLiteralLoose(["maybeRegisterTask: registering task ",""])),e),o("WATaskScheduler").registerTask(e,t))}function M(){o("WATaskScheduler").startScheduler(P()),T.forEach(N),o("WAWebMobilePlatforms").isSMB()&&D.forEach(N),r("gkx")("26258")||x.forEach(N)}l.registerTasks=M}),98);
__d("WAWebTosGating",["WAWebABPropsInternalNumber","WAWebBizGatingUtils","WAWebBotGating","WAWebBotTos","WAWebBotTosIds","WAWebHandleMsgTypes.flow","WAWebTos","WaWebPDFNCommonUtils"],(function(t,n,r,o,a,i,l){function e(e){if(o("WAWebBizGatingUtils").tos3GatingEnabled()){var t;if(o("WAWebTos").TosManager.getState(o("WAWebTos").TOS_3_ID)==="NOT_ACCEPTED"&&((t=e.privacyMode)==null?void 0:t.hostStorage)===o("WAWebHandleMsgTypes.flow").HostStorageEnumType.Facebook&&!o("WAWebABPropsInternalNumber").getFbBrandedNumber(e.id.user))return!0}return!1}function s(e){return o("WAWebBotTos").hasAcceptedNonBlockingBotTos()||o("WaWebPDFNCommonUtils").hasAcceptedTos(String(o("WAWebBotGating").getMasterBotNoticeId()))?!1:!!(e.id.isPnBot()&&!o("WAWebBotTos").hasSeenAgentTos()&&!o("WAWebBotTos").hasSeenShortcutTos()||e.id.isFbidBot()&&!o("WAWebBotTos").hasSeenUgcTos())}function u(){return o("WAWebBotTos").hasSeenInvokeTos()?!1:!o("WAWebBotTos").canShowBotTos(o("WAWebBotTosIds").getBotInvokeTosId())}l.shouldBlockByTos=e,l.shouldBlockByBotTos=s,l.shouldBlockBotInvokeAsTosNotAvailable=u}),98);
__d("WAWebElevatedPushNamesFlag",["WAWebABProps","WAWebChatGetters","WAWebContactGetters","WAWebFrontendChatGetters","WAWebFrontendContactGetters","WAWebStateUtils"],(function(t,n,r,o,a,i,l){function e(e){if(!e)return!1;var t=o("WAWebStateUtils").unproxy(e);return o("WAWebChatGetters").getIsGroup(t)&&(o("WAWebFrontendChatGetters").getIsCAG(t)||t.getParticipantCount()>2)}function s(e){if(!e)return!1;var t=o("WAWebStateUtils").unproxy(e);return o("WAWebChatGetters").getIsGroup(t)&&(o("WAWebFrontendChatGetters").getIsCAG(t)||t.getParticipantCount()>2)&&o("WAWebABProps").getABPropConfigValue("elevated_push_names_v2_m2_enabled")}function u(e){if(e==null)return!1;var t=o("WAWebStateUtils").unproxy(e),n=o("WAWebContactGetters").getNotifyName(t);return o("WAWebFrontendContactGetters").getFormattedName(t)===o("WAWebFrontendContactGetters").getFormattedUsernameOrPhone(t)&&n!=null&&n!==""}l.elevatedPushNamesEnabled=e,l.elevatedPushNamesM2Enabled=s,l.pushNameCanBeUsed=u}),98);
__d("WAWebMediaTypes",["$InternalEnum","WAWebMsgType"],(function(t,n,r,o,a,i,l){var e=Object.freeze({preview:"body",mediaKey:"mediaKey",mediaKeyTimestamp:"mediaKeyTimestamp",size:"size",filehash:"filehash",mimetype:"mimetype",duration:"duration",pageCount:"pageCount",fullHeight:"height",fullWidth:"width",type:"type",filename:"filename",caption:"caption",isGif:"isGif",gifAttribution:"gifAttribution",sidecar:"streamingSidecar",subtype:"subtype",firstFrameLength:"firstFrameLength",firstFrameSidecar:"firstFrameSidecar",isAnimated:"isAnimated",isLottie:"isLottie",isVcardOverMmsDocument:"isVcardOverMmsDocument",isViewOnce:"isViewOnce",waveform:"waveform",staticUrl:"staticUrl",accessibilityLabel:"accessibilityLabel"}),s=Object.freeze({body:"preview",directPath:"directPath",mediaKey:"mediaKey",mediaKeyTimestamp:"mediaKeyTimestamp",size:"size",filehash:"filehash",mimetype:"mimetype",duration:"duration",pageCount:"pageCount",height:"fullHeight",width:"fullWidth",type:"type",filename:"filename",caption:"caption",isGif:"isGif",gifAttribution:"gifAttribution",streamingSidecar:"sidecar",subtype:"subtype",firstFrameLength:"firstFrameLength",firstFrameSidecar:"firstFrameSidecar",isAnimated:"isAnimated",isLottie:"isLottie",isVcardOverMmsDocument:"isVcardOverMmsDocument",isViewOnce:"isViewOnce",waveform:"waveform",staticUrl:"staticUrl",stickerPackId:"stickerPackId",stickerPackName:"stickerPackName",stickerPackPublisher:"stickerPackPublisher",accessibilityLabel:"accessibilityLabel"}),u=Object.keys(s),c=["filehash","height","mimetype","size","type","width","stickerPackId","stickerPackName","stickerPackPublisher","accessibilityLabel"],d=[].concat(u,["deprecatedMms3Url","encFilehash","streamable"]),m=Object.freeze({VIDEO:Object.freeze(["aspectRatio","fullWidth","fullHeight","preview","duration","durationFloat","isViewOnce","fullPreviewData","staticUrl"]),PTV:Object.freeze(["aspectRatio","fullWidth","fullHeight","preview","duration","durationFloat","isViewOnce","fullPreviewData","staticUrl"]),AUDIO:Object.freeze(["duration","waveform"]),IMAGE:Object.freeze(["aspectRatio","fullWidth","fullHeight","preview","isViewOnce","fullPreviewData","staticUrl"]),PRODUCT:Object.freeze(["aspectRatio","fullWidth","fullHeight","preview"]),STICKER:Object.freeze(["animationDuration","singleLoopDuration","emojis","firstFrameLength","firstFrameSidecar","isAnimated","isAvatar","isAiSticker","isLottie","isFirstParty","isFromStickerMaker","stickerPackId","stickerPackName","stickerPackPublisher","stickerMakerSourceType","fullWidth","fullHeight","preview","rgbaBuffer","rgbaWidth","rgbaHeight","aspectRatio","extractedLottieSticker","accessibilityLabel"]),STICKER_PACK:Object.freeze([]),DOCUMENT:Object.freeze(["aspectRatio","pageCount","preview","isVcardOverMmsDocument","parsedVcards","fullPreviewData","fullPreviewSize"]),RAW:Object.freeze(["mediaBlob","size","loadedSize","filehash","progressiveStage"]),BIZ_COVER_PHOTO:Object.freeze([])}),p=["type","filename","caption","isGif","gifAttribution","mimetype","pageCount","sidecar","subtype","isViewOnce","accessibilityLabel"],_=n("$InternalEnum").Mirrored(["INIT","EXISTS","PREPARING","REUPLOADING","FETCHING","PROCESSING","NEED_POKE","ERROR_MISSING","ERROR_UNSUPPORTED","PROGRESSIVE_READY","RESOLVED"]),f=n("$InternalEnum").Mirrored(["INIT","PREPARING","UPLOADING","FINALIZING","NEED_UPLOAD","ERROR_FILE_NOT_READABLE","ERROR_MISSING","ERROR_TOO_LARGE","UPLOADED"]),g=n("$InternalEnum").Mirrored(["INIT","EXISTS","PREPARING","UPLOADING","FINALIZING","SENDING","REUPLOADING","FETCHING","DECRYPTING","RESOLVED","NEED_POKE","NEED_UPLOAD","ERROR_FILE_NOT_READABLE","ERROR_MISSING","ERROR_TOO_LARGE","ERROR_UNSUPPORTED","PROGRESSIVE_READY","REMOTE_UPLOADING","REMOTE_NEED_UPLOAD"]),h={IMAGE:"image",VIDEO:"video",PTV:"ptv",AUDIO:"audio",PTT:"ptt",STICKER:"sticker",DOCUMENT:"document",PRODUCT:"product",BIZ_COVER_PHOTO:"biz-cover-photo",UNKNOWN:"unknown",STICKER_PACK:"sticker-pack",MESSAGE_HISTORY_BUNDLE:o("WAWebMsgType").MSG_TYPE.MESSAGE_HISTORY_BUNDLE},y=Object.freeze({VIDEO:"VIDEO",PTV:"PTV",IMAGE:"IMAGE",AUDIO:"AUDIO",STICKER:"STICKER",DOCUMENT:"DOCUMENT",PRODUCT:"PRODUCT",BIZ_COVER_PHOTO:"BIZ_COVER_PHOTO"});l.MEDIA_TO_MSG=e,l.MSG_TO_MEDIA=s,l.MAPPED_MSG_PROPS=u,l.MAPPED_STICKER_PROPS=c,l.MEDIA_MSG_PROPS=d,l.FIELDS=m,l.MSG_SPECIFIC_FIELDS=p,l.DownloadStage=_,l.UploadStage=f,l.MediaDataStage=g,l.OUTWARD_TYPES=h,l.TYPE=y}),98);
__d("WAWebOrderItemGetters",["WAWebGetters","WAWebGettersCaches","WAWebMediaData","WAWebMediaTypes"],(function(t,n,r,o,a,i,l){var e=o("WAWebGetters").createGetterFactories({createCache:o("WAWebGettersCaches").createOrderItemCache}),s=e.field,u=e.computed,c=e.clearCacheFor,d=c,m=s("thumbnailUrl"),p=u(function(e){var t=e[0];return new(r("WAWebMediaData"))({mediaStage:t!=null?o("WAWebMediaTypes").MediaDataStage.RESOLVED:o("WAWebMediaTypes").MediaDataStage.PREPARING,renderableUrl:t!=null?""+t:null})},[m]);l.clearOrderItemGetterCacheFor=d,l.getMediaData=p}),98);
__d("WAWebMediaMetadata",["WALogger","WAWebMediaCryptoEligibilityUtils","err"],(function(t,n,r,o,a,i,l){var e,s;function u(t){var n=t.mediaObject;if(!n)throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),t.id.toString(),t.type).devConsole(t).sendLogs("media-fault: mediaMetadata msg without mediaObject"),r("err")("msg.mediaMetadata with no mediaObject");var a=o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMsg(t)?n.entries.getEntryByEncFilehash({encFilehash:t.encFilehash,deprecatedMms3Url:t.deprecatedMms3Url}):n.entries.getUnencryptedEntry(t.filehash,t.directPath);if(!a)throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),t.id.toString(),t.type).devConsole(t).sendLogs("media-fault: mediaMetadata no entry"),r("err")("msg.mediaMetadata with entry mismatch");var i=t.mediaData;return{url:o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMsg(t)?a.deprecatedMms3Url:null,directPath:a.directPath,encFilehash:a.getEncfilehash(),mediaKey:a.getMediaKey(),mediaKeyTimestamp:a.getMediaKeyTimestamp(),filehash:t.filehash,type:i.type,mimetype:i.mimetype,filename:i.filename,duration:i.duration,width:i.fullWidth,height:i.fullHeight,firstFrameLength:i.firstFrameLength,isAnimated:i.isAnimated,isLottie:i.isLottie,thumbnailDirectPath:t.thumbnailDirectPath,thumbnailSha256:t.thumbnailSha256,thumbnailEncSha256:t.thumbnailEncSha256,thumbnailHeight:t.thumbnailHeight,thumbnailWidth:t.thumbnailWidth,metadataUrl:t.metadataUrl,waveform:t.waveform,staticUrl:t.staticUrl}}l.mediaMetadata=u}),98);
__d("WAWebWamEnumEntryPoint",[],(function(t,n,r,o,a,i){var e=Object.freeze({SETTINGS_CONTACTS:1,CONTACTS_LIST:2,CONTACTS_MENU:3,CONTACTPICKER_LIST:4,CONTACTPICKER_MENU:5,EMPTY_CONVERSATIONS:6,EMPTY_CONTACTS:7,INVITE_NON_WA_CONTACT:8,EMPTY_CALLS:9,CHATS_LIST:10,CHANNEL_THREAD:11,CHANNEL_INFO:12,CHAT_THREAD:13,CHAT_HOME:14,CHAT_INFO_PAGE:15,SEARCH_FILTER:16,BUSINESS_HOME:17,OVERFLOW_MENU:18,BUSINESS_TOOLS:19,SETTINGS:20,APP_STORE:21,ACCOUNT_SETTINGS:22,CHAT_LONG_PRESS_OPTIONS:23,CHAT_SELECT_OPTIONS:24,CHAT_SWIPE:25,CHAT_MORE_OPTIONS:26,DEEP_LINK:27,ALERT:28,KEYBOARD_SHORTCUTS:29,ADD_EDIT_PRODUCT:30,AI_HUB_CHAT:31,TOPICS_CHECKLIST:32,LEARNING_SUMMARY:33,CATALOG_PRODUCT_DETAILS:34,AI_HOME:35,MESSAGE:36,KNOWLEDGE_REPO:37,COACHING_INDICATOR:38,SPAM_FOLDER:39,SAMPLE_RESPONSE_BOTTOMSHEET:40,CHAT_BANNER:41,CHAT_ATTACHMENT_MENU:42,ORDERS:43,PROFILE_EDIT:44,ONBOARDING:45,COACHING_ENTRYPOINT_BUTTON:46,COACHING_INLINE_FEEDBACK_BUTTONS:47,MESSAGE_HEADER:48,MESSAGE_CTA:49,NOTIFICATION:50,BB_HOME:51,BB_THREAD:52,BB_THREAD_BANNER:53,BB_HOME_USED_ALL_BB_CREDIT_MV_BANNER:54,BB_HOME_USED_MOST_BB_CREDIT_MV_BANNER:55,BB_THREAD_USED_ALL_BB_CREDIT_MV_BANNER:56,BB_THREAD_USED_MOST_BB_CREDIT_MV_BANNER:57,BB_THREAD_NEED_MORE_CREDIT_MV_BANNER:58,BB_REVIEW_USED_ALL_BB_CREDIT_MV_BANNER:59,BB_REVIEW_USED_MOST_BB_CREDIT_MV_BANNER:60,BB_REVIEW_NEED_MORE_CREDIT_MV_BANNER:61,MESSAGE_CAPPING_NUX:62,ADVANCED_TOOLS_BOTTOM_SHEET:63,DEEP_LINK_CHAT_PSA:64,NAV_BAR:65,SMB_ONBOARDING_FLOW:66,CLIENT_ERROR_FOREGROUND:67,ALERTS_CENTER_HOME:68,POST_ONBOARDING:69,APP_LAUNCH:70,PRODUCT_INFO_LIST:71});i.ENTRY_POINT=e}),66);
__d("WAWebWamEnumOppositePlatformEnum",[],(function(t,n,r,o,a,i){var e=Object.freeze({CONSUMER:0,BUSINESS:1});i.OPPOSITE_PLATFORM_ENUM=e}),66);
__d("WAWebWamEnumSmbFeatureNameEnum",[],(function(t,n,r,o,a,i){var e=Object.freeze({NOTES:0,GEN_AI_AGENT:1,BROADCAST_LIST:2,BIZ_APP_ONBOARDING:3,BUSINESS_TOOLS_HOME:4,CATALOG:5,BUSINESS_PROFILE:6,LEARNING_HUB:7,BUSINESS_BROADCAST:8,ALERTS_CENTER:9,GOOGLE_ELIGIBILITY_OPT_OUT:10});i.SMB_FEATURE_NAME_ENUM=e}),66);
__d("WAWebWamEnumSmbUserActionTypeEnum",[],(function(t,n,r,o,a,i){var e=Object.freeze({VIEW:0,CLICK:1,ENTER:2,SCROLL:3,SCAN:4,API:5,EDIT:6,DELETE:7,SEARCH:8,DISMISS:9});i.SMB_USER_ACTION_TYPE_ENUM=e}),66);
__d("WAWebSmbUserJourneyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumChatFilterActionTypes","WAWebWamEnumEntryPoint","WAWebWamEnumOppositePlatformEnum","WAWebWamEnumSmbFeatureNameEnum","WAWebWamEnumSmbUserActionTypeEnum","WAWebWamEnumSurfaceType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({SmbUserJourney:[5462,{actionType:[1,o("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES],contactIsSaved:[2,e.TYPES.BOOLEAN],entryPoint:[3,o("WAWebWamEnumEntryPoint").ENTRY_POINT],extraAttributes:[4,e.TYPES.STRING],oppositePlatform:[5,o("WAWebWamEnumOppositePlatformEnum").OPPOSITE_PLATFORM_ENUM],prevSurface:[14,o("WAWebWamEnumSurfaceType").SURFACE_TYPE],recipientSize:[12,e.TYPES.INTEGER],seqId:[7,e.TYPES.INTEGER],smbFeatureName:[8,o("WAWebWamEnumSmbFeatureNameEnum").SMB_FEATURE_NAME_ENUM],smbUserActionType:[13,o("WAWebWamEnumSmbUserActionTypeEnum").SMB_USER_ACTION_TYPE_ENUM],smbUserSessionId:[9,e.TYPES.STRING],surface:[10,o("WAWebWamEnumSurfaceType").SURFACE_TYPE],userActionTarget:[11,e.TYPES.STRING]},[1,1,1],"regular"]},{SmbUserJourney:[]});l.SmbUserJourneyWamEvent=s}),98);
__d("WAWebSMBUserJourneyLogger",["WAWebPonyfillsCryptoRandomUUID","WAWebSmbUserJourneyWamEvent","WAWebUnifiedSession"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(){var e;this.$1=(e=o("WAWebUnifiedSession").UnifiedSessionManager.getSessionId())!=null?e:r("WAWebPonyfillsCryptoRandomUUID")(),this.$2=0,this.$3=new Map}var t=e.prototype;return t.setEntryPoint=function(t,n){this.$3.set(n,t)},t.clearEntryPoint=function(t){this.$3.delete(t)},t.log=function(t){var e=new(o("WAWebSmbUserJourneyWamEvent")).SmbUserJourneyWamEvent;e.smbFeatureName=t.featureName,e.smbUserActionType=t.userActionType,e.surface=t.surface,e.smbUserSessionId=this.$1,e.seqId=this.$2,t.entryPoint!=null&&this.$3.set(t.featureName,t.entryPoint);var n=this.$3.get(t.featureName);n!=null&&(e.entryPoint=n),t.userActionTarget!=null&&(e.userActionTarget=t.userActionTarget),t.extraAttributes!=null&&(e.extraAttributes=JSON.stringify(t.extraAttributes)),e.commit(),this.$2+=1},e})(),s=new e;l.SMBUserJourneyLogger=s}),98);
__d("WAWebMediaProduct",["$InternalEnum","WAWebFileUtils","WAWebMmsMediaTypes","WAWebSMBUserJourneyLogger","WAWebUploadManager","WAWebWamEnumMediaUploadResultType","WAWebWamEnumSmbFeatureNameEnum","WAWebWamEnumSmbUserActionTypeEnum","WAWebWamEnumSurfaceType","WAWebWamEnumUploadOriginType","WAWebWamMediaMetricUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=n("$InternalEnum")({ImageUpload:"image_upload"});function s(t,n){o("WAWebSMBUserJourneyLogger").SMBUserJourneyLogger.log({userActionType:o("WAWebWamEnumSmbUserActionTypeEnum").SMB_USER_ACTION_TYPE_ENUM.API,surface:t?o("WAWebWamEnumSurfaceType").SURFACE_TYPE.ADD_ITEM:o("WAWebWamEnumSurfaceType").SURFACE_TYPE.EDIT_ITEM,featureName:o("WAWebWamEnumSmbFeatureNameEnum").SMB_FEATURE_NAME_ENUM.CATALOG,userActionTarget:e.ImageUpload,extraAttributes:n})}function u(e,t,n,r){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a){var i=yield o("WAWebFileUtils").blobToArrayBuffer(e.forceToBlob()).then(function(e){return r("WAWebUploadManager").unencryptedUpload({file:e,hash:t,signal:new AbortController().signal,type:o("WAWebMmsMediaTypes").MEDIA_TYPES.PRODUCT_CATALOG_IMAGE,uploadOrigin:o("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.PRODUCT_CATALOG,isViewOnce:!1,generateThumbnailOnServer:!1}).then(function(e){return s(a,{media_upload_result:o("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.OK,media_upload_index:n}),e}).catch(function(e){throw s(a,{media_upload_result:o("WAWebWamMediaMetricUtils").getMetricUploadErrorResultType(e),media_upload_index:n}),e})});return new URL(i.directPath,"https://mmg.whatsapp.net").toString()}),c.apply(this,arguments)}l.uploadProductImage=u}),98);
__d("WAWebMediaVideoStreaming",[],(function(t,n,r,o,a,i){function e(e){var t=e.mediaObject;return t?t.videoStreamingInfo(e.id.toString()):null}i.videoStreamingInfo=e}),66);
__d("WAWebMedia",["WAWebCheckMediaExistence","WAWebClearMediaForChat","WAWebDownloadProgressiveJpegThumbnail","WAWebDownloadStatusThumbnail","WAWebDownloadVideoThumbnail","WAWebManuallySetMedia","WAWebMediaCancelDownloadMsg","WAWebMediaCancelUploadMsg","WAWebMediaDownloadMsg","WAWebMediaForwardMediaMsg","WAWebMediaMetadata","WAWebMediaMsgRegistration","WAWebMediaPrep","WAWebMediaProduct","WAWebMediaResumeUploadMsg","WAWebMediaStickers","WAWebMediaVideoStreaming","WAWebPrepRawMedia"],(function(t,n,r,o,a,i){var e=importNamespace("WAWebDownloadVideoThumbnail").downloadVideoThumbnail,l=importNamespace("WAWebMediaPrep").MediaPrep,s=importNamespace("WAWebCheckMediaExistence").checkMediaExistence,u=importNamespace("WAWebClearMediaForChat").clearMediaForChat,c=importNamespace("WAWebMediaDownloadMsg").downloadMsg,d=importNamespace("WAWebDownloadProgressiveJpegThumbnail").downloadProgressiveJpegThumbnail,m=importNamespace("WAWebDownloadStatusThumbnail").downloadStatusThumbnail,p=importNamespace("WAWebMediaForwardMediaMsg").forwardMediaMsg,_=importNamespace("WAWebManuallySetMedia").manuallySetMedia,f=importNamespace("WAWebPrepRawMedia").prepRawMedia,g=importNamespace("WAWebMediaResumeUploadMsg").resumeUploadMsg;Object.keys(importNamespace("WAWebMediaCancelDownloadMsg")).forEach(function(e){e==="default"||e==="__esModule"||(i[e]=importNamespace("WAWebMediaCancelDownloadMsg")[e])}),Object.keys(importNamespace("WAWebMediaCancelUploadMsg")).forEach(function(e){e==="default"||e==="__esModule"||(i[e]=importNamespace("WAWebMediaCancelUploadMsg")[e])}),Object.keys(importNamespace("WAWebMediaMetadata")).forEach(function(e){e==="default"||e==="__esModule"||(i[e]=importNamespace("WAWebMediaMetadata")[e])}),Object.keys(importNamespace("WAWebMediaMsgRegistration")).forEach(function(e){e==="default"||e==="__esModule"||(i[e]=importNamespace("WAWebMediaMsgRegistration")[e])}),Object.keys(importNamespace("WAWebMediaProduct")).forEach(function(e){e==="default"||e==="__esModule"||(i[e]=importNamespace("WAWebMediaProduct")[e])}),Object.keys(importNamespace("WAWebMediaStickers")).forEach(function(e){e==="default"||e==="__esModule"||(i[e]=importNamespace("WAWebMediaStickers")[e])}),Object.keys(importNamespace("WAWebMediaVideoStreaming")).forEach(function(e){e==="default"||e==="__esModule"||(i[e]=importNamespace("WAWebMediaVideoStreaming")[e])}),i.downloadVideoThumbnail=e,i.MediaPrep=l,i.checkMediaExistence=s,i.clearMediaForChat=u,i.downloadMsg=c,i.downloadProgressiveJpegThumbnail=d,i.downloadStatusThumbnail=m,i.forwardMediaMsg=p,i.manuallySetMedia=_,i.prepRawMedia=f,i.resumeUploadMsg=g}),66);
__d("WAWebWamEnumWebcRmrReasonCode",[],(function(t,n,r,o,a,i){var e=Object.freeze({OTHER:0,MSG_CLICK:1,STICKER_PANEL_ICON:2,MEDIA_VIEWER:3,VIDEO_STREAMING:4,STATUS_V3:5,MULTI_SELECT_DOWNLOAD:6,DOCUMENT_DOWNLOAD:7,PIP:8,STICKER_PANEL_STICKER:9,SEND_TO_CHAT:10,UPLOAD:11,MSG_INIT:12,MSG_UPDATE:13,MSG_DELETE:14,MSG_RENDER:15});i.WEBC_RMR_REASON_CODE=e}),66);
__d("WAWebMediaAutoDownloadQueue",["$InternalEnum","WAConcurrentPriorityPromiseQueue","WALogger","WAWebMedia","WAWebMediaDownloadMmsThumbnail","WAWebMiscGatingUtils","WAWebMsgGetters","WAWebMsgModelPropUtils","WAWebMsgModelUtils","WAWebMsgType","WAWebStickerMimeUtils","WAWebStickerModel","WAWebUserPrefsGeneral","WAWebWamEnumWebcRmrReasonCode","asyncToGeneratorRuntime","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=n("$InternalEnum")({MEDIA:"media",MMS_THUMBNAIL:"mms_thumbnail"}),m=32*1024*1024,p=512*1024,_=5,f=512,g=500*1024;function h(e){var t=e.type===o("WAWebMsgType").MSG_TYPE.STICKER&&e.mimetype===o("WAWebStickerMimeUtils").WhatsAppLottieStickerMimeType&&e.isLottie===!0&&e.isAnimated===!0;return t||o("WAWebMsgModelPropUtils").isTrusted(e.unsafe())}function y(e){switch(e.type){case o("WAWebMsgType").MSG_TYPE.AUDIO:case o("WAWebMsgType").MSG_TYPE.PTT:return o("WAWebUserPrefsGeneral").getAutoDownloadAudio();case o("WAWebMsgType").MSG_TYPE.STICKER:case o("WAWebMsgType").MSG_TYPE.IMAGE:return o("WAWebUserPrefsGeneral").getAutoDownloadPhotos();case o("WAWebMsgType").MSG_TYPE.VIDEO:case o("WAWebMsgType").MSG_TYPE.PTV:return e.isGif&&e.size<g?o("WAWebUserPrefsGeneral").getAutoDownloadPhotos():o("WAWebUserPrefsGeneral").getAutoDownloadVideos();case o("WAWebMsgType").MSG_TYPE.DOCUMENT:return o("WAWebUserPrefsGeneral").getAutoDownloadDocuments()}return!1}function C(e){switch(e.type){case o("WAWebMsgType").MSG_TYPE.IMAGE:case o("WAWebMsgType").MSG_TYPE.VIDEO:case o("WAWebMsgType").MSG_TYPE.PTV:case o("WAWebMsgType").MSG_TYPE.DOCUMENT:return e.size<=m;case o("WAWebMsgType").MSG_TYPE.AUDIO:case o("WAWebMsgType").MSG_TYPE.PTT:return e.size<p;case o("WAWebMsgType").MSG_TYPE.STICKER:return!0}return!1}var b=(function(){function t(){this.$1=new(r("WAConcurrentPriorityPromiseQueue"))(_,{photos:2,videos:1,audio:1,documents:1,mms_thumbnail:4})}var a=t.prototype;return a.getEnqueuedTasksCount=function(){return this.$1.getEnqueuedTasksCount()},a.clearQueue=function(){this.$1.clearQueue()},a.$2=function(){return o("WAWebMiscGatingUtils").webMediaAutoDownloadEnabled()&&o("WAWebUserPrefsGeneral").getAutoDownloadPhotos()&&this.getEnqueuedTasksCount()<f},a.enqueue=function(t,n,r){if(t instanceof o("WAWebStickerModel").StickerModel)return this.$2()?(this.$3({sticker:t}),!0):!1;var e=t,a=o("WAWebMiscGatingUtils").webMediaAutoDownloadEnabled()&&n===d.MEDIA&&!o("WAWebMsgGetters").getIsNewsletterMsg(e)&&h(e)&&e.isNewMsg&&y(e)&&C(e)&&this.getEnqueuedTasksCount()<f;if(a)switch(e.type){case o("WAWebMsgType").MSG_TYPE.AUDIO:case o("WAWebMsgType").MSG_TYPE.PTT:return this.$4({message:e,group:"audio",chat:r}),!0;case o("WAWebMsgType").MSG_TYPE.IMAGE:case o("WAWebMsgType").MSG_TYPE.STICKER:return this.$4({message:e,group:"photos",chat:r}),!0;case o("WAWebMsgType").MSG_TYPE.VIDEO:case o("WAWebMsgType").MSG_TYPE.PTV:return e.isGif&&e.size<g?(this.$4({message:e,group:"photos",chat:r}),!0):(this.$4({message:e,group:"videos",chat:r}),!0);case o("WAWebMsgType").MSG_TYPE.DOCUMENT:return this.$4({message:e,group:"documents",chat:r}),!0}if(n===d.MMS_THUMBNAIL){if(e.type===o("WAWebMsgType").MSG_TYPE.DOCUMENT||o("WAWebMsgModelUtils").typeIsUrl(e))return this.$5({message:e,group:"mms_thumbnail",chat:r}),!0;if(e.type===o("WAWebMsgType").MSG_TYPE.IMAGE||e.type===o("WAWebMsgType").MSG_TYPE.VIDEO||e.type===o("WAWebMsgType").MSG_TYPE.PTV)return this.$6({message:e,group:"mms_thumbnail"}),!0}return!1},a.$3=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=t.sticker;if(!a.mediaObject){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Sticker mediaObject does not exist for media at enqueue time ",""])),r("gkx")("26258")?"":a.id).sendLogs("Sticker mediaObject does not exist for media at enqueue time");return}yield this.$1.enqueue(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!a.mediaObject){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Sticker mediaObject does not exist for media at download time ",""])),r("gkx")("26258")?"":a.id).sendLogs("Sticker mediaObject does not exist for media at download time");return}yield a.downloadMedia()}),{group:"photos",priority:1})});function a(e){return t.apply(this,arguments)}return a})(),a.$4=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.message,a=e.group;if(!t.mediaObject){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["mediaObject does not exist for media at enqueue time ",""])),r("gkx")("26258")?"":t.id).sendLogs("mediaObject does not exist for media at enqueue time");return}yield this.$1.enqueue(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!t.mediaObject){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["mediaObject does not exist for media at download time ",""])),r("gkx")("26258")?"":t.id).sendLogs("mediaObject does not exist for media at download time",{sampling:0});return}y(t)&&(yield t.downloadMedia({downloadEvenIfExpensive:!1,rmrReason:o("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.OTHER,isUserInitiated:!1,isAutoDownload:!0}))}),{group:a,priority:-t.t})});function t(t){return e.apply(this,arguments)}return t})(),a.$5=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.message,o=e.chat,a=e.group;yield this.$1.enqueue(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield r("WAWebMediaDownloadMmsThumbnail")({msg:t,chat:o})}),{group:a,priority:-t.t})});function t(t){return e.apply(this,arguments)}return t})(),a.$6=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.message,r=e.group;yield this.$1.enqueue(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield o("WAWebMedia").downloadStatusThumbnail({msg:t})}),{group:r,priority:-t.t})});function t(t){return e.apply(this,arguments)}return t})(),t})(),v=new b;l.AutoDownloadTypes=d,l.MAX_AUTO_DOWNLOAD_SIZE=m,l.AUDIO_AUTO_DOWNLOAD_SIZE_LIMIT=p,l.shouldTrustMedia=h,l.shouldAutoDownloadMedia=y,l.validateMediaSize=C,l.AutoDownloadQueue=v}),98);
__d("WAWebMediaData",["WALogger","WAWebBaseModel","WAWebFeatureDetectionSwSupport","WAWebMediaCleanFileName","WAWebMediaInMemoryBlobCache","WAWebMediaTypes"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=(function(t){function n(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.type=o("WAWebBaseModel").prop(o("WAWebMediaTypes").OUTWARD_TYPES.UNKNOWN),e.directPath=o("WAWebBaseModel").prop(),e.mediaKey=o("WAWebBaseModel").prop(),e.mediaKeyTimestamp=o("WAWebBaseModel").prop(),e.encFilehash=o("WAWebBaseModel").prop(),e.mediaStage=o("WAWebBaseModel").prop(o("WAWebMediaTypes").MediaDataStage.INIT),e.size=o("WAWebBaseModel").prop(),e.loadedSize=o("WAWebBaseModel").prop(),e.filehash=o("WAWebBaseModel").prop(),e.mimetype=o("WAWebBaseModel").prop(),e.mediaBlob=o("WAWebBaseModel").prop(),e.renderableUrl=o("WAWebBaseModel").prop(),e.fullHeight=o("WAWebBaseModel").prop(),e.fullWidth=o("WAWebBaseModel").prop(),e.aspectRatio=o("WAWebBaseModel").prop(),e.rgbaBuffer=o("WAWebBaseModel").prop(),e.rgbaHeight=o("WAWebBaseModel").prop(),e.rgbaWidth=o("WAWebBaseModel").prop(),e.animationDuration=o("WAWebBaseModel").prop(0),e.animatedAsNewMsg=o("WAWebBaseModel").prop(!1),e.isAnimated=o("WAWebBaseModel").prop(),e.isFirstParty=o("WAWebBaseModel").prop(),e.isFromStickerMaker=o("WAWebBaseModel").prop(),e.isAvatar=o("WAWebBaseModel").prop(),e.isAiSticker=o("WAWebBaseModel").prop(),e.isLottie=o("WAWebBaseModel").prop(),e.stickerPackId=o("WAWebBaseModel").prop(),e.stickerPackName=o("WAWebBaseModel").prop(),e.stickerPackPublisher=o("WAWebBaseModel").prop(),e.stickerMakerSourceType=o("WAWebBaseModel").prop(),e.singleLoopDuration=o("WAWebBaseModel").prop(),e.firstFrameLength=o("WAWebBaseModel").prop(),e.firstFrameSidecar=o("WAWebBaseModel").prop(),e.emojis=o("WAWebBaseModel").prop(),e.accessibilityLabel=o("WAWebBaseModel").prop(),e.progressiveStage=o("WAWebBaseModel").prop(),e.isViewOnce=o("WAWebBaseModel").prop(!1),e.staticUrl=o("WAWebBaseModel").prop(),e.preview=o("WAWebBaseModel").prop(),e.sidecar=o("WAWebBaseModel").prop(),e.duration=o("WAWebBaseModel").prop(),e.durationFloat=o("WAWebBaseModel").prop(),e.isGif=o("WAWebBaseModel").prop(),e.gifAttribution=o("WAWebBaseModel").prop(),e.streamable=o("WAWebBaseModel").derived(function(){return this.isStreamable()},["isGif","isViewOnce","mediaStage","sidecar","type","swStreamingSupported"]),e.swStreamingSupported=o("WAWebBaseModel").prop(!1),e.$MediaData$p_1=o("WAWebBaseModel").prop(!1),e.filename=o("WAWebBaseModel").prop(),e.pageCount=o("WAWebBaseModel").prop(),e.documentPreview=o("WAWebBaseModel").prop(),e.isVcardOverMmsDocument=o("WAWebBaseModel").prop(!1),e.parsedVcards=o("WAWebBaseModel").prop(),e.extractedLottieSticker=o("WAWebBaseModel").prop(),e.fullPreviewSize=o("WAWebBaseModel").prop(),e.fullPreviewData=o("WAWebBaseModel").prop(),e.subtype=o("WAWebBaseModel").prop(),e.waveform=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.initialize=function(){t.prototype.initialize.call(this)},a.set=function(n,r,o){var e,a=o;if(typeof n=="string"){var i;e=(i={},i[n]=r,i)}else e=n,a=r;return e=_(e),t.prototype.set.call(this,e,a)},a.isStreamable=function(){return this.isStreamableType()&&this.listenToServiceWorkerSupport()&&!this.isViewOnce},a.$MediaData$p_2=function(t){this.swStreamingSupported=t},a.listenToServiceWorkerSupport=function(){return this.$MediaData$p_1?this.swStreamingSupported:(this.listenTo(r("WAWebFeatureDetectionSwSupport"),"change:streamingSupported",this.$MediaData$p_2),this.swStreamingSupported=!!r("WAWebFeatureDetectionSwSupport").streamingSupported,this.$MediaData$p_1=!0,this.swStreamingSupported)},a.isStreamableType=function(){return this.type===o("WAWebMediaTypes").OUTWARD_TYPES.VIDEO&&!this.isGif&&(this.mediaStage===o("WAWebMediaTypes").MediaDataStage.INIT||this.mediaStage===o("WAWebMediaTypes").MediaDataStage.FETCHING||this.mediaStage===o("WAWebMediaTypes").MediaDataStage.DECRYPTING||this.mediaStage===o("WAWebMediaTypes").MediaDataStage.RESOLVED)&&this.fullWidth!=null&&this.fullHeight!=null&&!!(this.sidecar&&this.sidecar.byteLength>0)},a.isDownloadable=function(){if(this.isViewOnce)return!1;var t=this.renderableUrl!=null;if(t)return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["MediaData.isDownloadable: hasRenderableUrl = ",""])),t),!0;var n=o("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.has(this.filehash);if(n)return o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["MediaData.isDownloadable: hasCachedBlob = ",""])),n),!0;var r=this.mediaStage===o("WAWebMediaTypes").MediaDataStage.EXISTS||this.mediaStage===o("WAWebMediaTypes").MediaDataStage.PROGRESSIVE_READY;return r?(o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["MediaData.isDownloadable: hasValidMediaStage = "," (stage: ",")"])),r,this.mediaStage),!0):(o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["MediaData.isDownloadable: no conditions met, returning false"]))),!1)},n})(o("WAWebBaseModel").BaseModel);d.Proxy="mediaData";var m=o("WAWebBaseModel").defineModel(d);m.TYPE=o("WAWebMediaTypes").OUTWARD_TYPES;var p=m;function _(e){if(e.filename&&e.type===m.TYPE.DOCUMENT){var t=o("WAWebMediaCleanFileName").cleanFilename(e.filename);return babelHelpers.extends({},e,{filename:t,caption:t})}return e}l.default=p}),98);
__d("WAWebMediaOpaqueData",["Promise","WABase64","WALogger","WANullthrows","WAShiftTimer","WAWebFileUtils","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_=[],f=new(o("WAShiftTimer")).ShiftTimer(h),g=(function(){function t(){this._retainCount=1,this._inAutoreleasePool=!1,this.released=!1,this._b64=void 0,this.blob=void 0,this._url=void 0,this._mimetype=void 0,this._released=void 0}var a=t.prototype;return a.retain=function(){if(this.released)throw o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["OpaqueData:retain called on released OpaqueData"]))),r("err")("OpaqueData:retain called on released OpaqueData");this._retainCount++},a.autorelease=function(){this.released?o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["OpaqueData:autorelease called on released object"]))):this._retainCount===0?o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["OpaqueData:autorelease too many release calls"]))):this._retainCount===1?(this._retainCount=0,this._inAutoreleasePool||(this._inAutoreleasePool=!0,_.push(this),f.onOrBefore(1e3))):this._retainCount--},a.autoreleaseWhenPromiseCompletes=function(t){var e=this,n=function(){e.autorelease()};t.then(n,n)},a.throwIfReleased=function(t){if(this.released)throw o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose([""," called on released OpaqueData"])),t),r("err")(t+" called on released OpaqueData");this._retainCount===0&&o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose([""," called on unretained OpaqueData"])),t)},a.url=function(){return this.throwIfReleased("OpaqueData:url"),this._url!=null&&this._url!==""?this._url:this._b64!=null&&this._b64!==""?(this._url="data:image/jpeg;base64,"+this._b64,this._url):(this._url=window.URL.createObjectURL(r("WANullthrows")(this.blob,"unexpected empty blob")),this._url)},a.getBlob=function(){return this.blob},a.getBase64=function(){return this._b64},a.validate=function(){return this._released===!0?(p||(p=n("Promise"))).resolve(!1):this.blob?o("WAWebFileUtils").validateBlob(this.blob):(p||(p=n("Promise"))).resolve(!0)},a.size=function(){return this.throwIfReleased("OpaqueData:size"),this.blob?this.blob.size:this._b64!=null?o("WABase64").sizeWhenB64Decoded(this._b64):(o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["OpaqueData:size returned 0"]))).sendLogs("opaque-data-size-0"),0)},a.formData=function(t){return this.throwIfReleased("OpaqueData:formData"),this.forceToBlob()},a.type=function(){return this.throwIfReleased("OpaqueData:type"),this._mimetype!=null&&this._mimetype!==""?this._mimetype:"undefined"},a.forceToBlob=function(){this.throwIfReleased("OpaqueData:forceToBlob");var e=this.blob;if(e)return e;var t=this._b64;if(t!=null&&t!==""){this._b64=void 0,this._url=void 0;var n=this._mimetype;return this.blob=new Blob([o("WABase64").decodeB64(t)],n!=null&&n!==""?{type:n}:void 0)}throw r("err")("OpaqueData:forceToBlob no b64 or blob")},a._releaseImpl=function(){this._mimetype=void 0;var e=this.blob;e?(this.blob=void 0,this._url!=null&&this._url!==""&&(window.URL.revokeObjectURL(this._url),this._url=void 0)):(this._b64=void 0,this._url=void 0)},a.isBlobEqual=function(t){return t?this.blob===t.blob:!this.blob},t})();g.createFromBase64Jpeg=function(e){return new(p||(p=n("Promise")))(function(t){var n=new g;return n._b64=e,n._mimetype="image/jpeg",t(n)})},g.createFromData=function(e,t){return new(p||(p=n("Promise")))(function(n){var r=new g;return r.blob=e instanceof Blob&&e.type===t?e:new Blob([e],{type:t}),r._mimetype=t,n(r)})};function h(){var e=_;_=[];for(var t=0;t<e.length;t++){var n=e[t];n._inAutoreleasePool=!1,n._retainCount===0&&!n.released&&(n.released=!0,n._releaseImpl())}}l.default=g}),98);
__d("WAWebGetThumbnailTypeForMediaChatMsg",["WAWebMmsMediaTypes","WAWebMsgGetters"],(function(t,n,r,o,a,i,l){function e(e){var t=e.msg,n=o("WAWebMsgGetters").getIsNewsletterMsg(t);return n?o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_THUMBNAIL_LINK:o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_LINK}l.default=e}),98);
__d("WAWebGetThumbnailTypeForMediaDocumentMsg",["WAWebMmsMediaTypes"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_DOCUMENT}l.default=e}),98);
__d("WAWebGetThumbnailTypeForMediaImageMsg",["WAWebMmsMediaTypes"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_IMAGE}l.default=e}),98);
__d("WAWebGetThumbnailTypeForMediaInteractiveMsg",["WAWebInteractiveMessageHeaderMediaType","WAWebMmsMediaTypes","err"],(function(t,n,r,o,a,i,l){function e(e){var t=e.msg,n=t.interactiveHeader;if((n==null?void 0:n.mediaType)!=null)switch(n.mediaType){case o("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.DOCUMENT:return o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_DOCUMENT;case o("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.VIDEO:return o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_VIDEO;default:break}throw r("err")("getThumbnailTypeForMediaMsg: unsupported msg type")}l.default=e}),98);
__d("WAWebGetThumbnailTypeForMediaStickerPackMsg",["WAWebMmsMediaTypes"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_STICKER_PACK}l.default=e}),98);
__d("WAWebGetThumbnailTypeForMediaVideoMsg",["WAWebMmsMediaTypes"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_VIDEO}l.default=e}),98);
__d("WAWebMessagePluginGetThumbnailTypeForMediaMsgRegistry",["WAWebGetThumbnailTypeForMediaChatMsg","WAWebGetThumbnailTypeForMediaDocumentMsg","WAWebGetThumbnailTypeForMediaImageMsg","WAWebGetThumbnailTypeForMediaInteractiveMsg","WAWebGetThumbnailTypeForMediaStickerPackMsg","WAWebGetThumbnailTypeForMediaVideoMsg"],(function(t,n,r,o,a,i,l){var e=[{type:"album",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"audio",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"biz_content_placeholder",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"buttons_response",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"chat",subtype:"url",getThumbnailTypeForMediaMsg:r("WAWebGetThumbnailTypeForMediaChatMsg")},{type:"chat",subtype:void 0,getThumbnailTypeForMediaMsg:r("WAWebGetThumbnailTypeForMediaChatMsg")},{type:"ciphertext",subtype:"bot_unavailable_fanout",getThumbnailTypeForMediaMsg:null},{type:"ciphertext",subtype:"fanout",getThumbnailTypeForMediaMsg:null},{type:"ciphertext",subtype:"hosted_unavailable_fanout",getThumbnailTypeForMediaMsg:null},{type:"ciphertext",subtype:"view_once_unavailable_fanout",getThumbnailTypeForMediaMsg:null},{type:"ciphertext",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"comment",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"debug_placeholder",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"document",subtype:void 0,getThumbnailTypeForMediaMsg:r("WAWebGetThumbnailTypeForMediaDocumentMsg")},{type:"event_creation",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"event_edit_encrypted",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"event_response",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"group-history",subtype:"message_history_bundle",getThumbnailTypeForMediaMsg:null},{type:"groups_v4_invite",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"hsm",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"image",subtype:void 0,getThumbnailTypeForMediaMsg:r("WAWebGetThumbnailTypeForMediaImageMsg")},{type:"interactive",subtype:void 0,getThumbnailTypeForMediaMsg:r("WAWebGetThumbnailTypeForMediaInteractiveMsg")},{type:"interactive_response",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"keep_in_chat",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"list",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"list_response",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"location",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"message_edit_encrypted",subtype:"message_edit",getThumbnailTypeForMediaMsg:null},{type:"multi_vcard",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"native_flow",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"newsletter_admin_invite",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"newsletter_follower_invite",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"newsletter_question_response",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"notification_template",subtype:"contact_info_card",getThumbnailTypeForMediaMsg:null},{type:"order",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"payment",subtype:"ciphertext",getThumbnailTypeForMediaMsg:null},{type:"payment",subtype:"futureproof",getThumbnailTypeForMediaMsg:null},{type:"payment",subtype:"invite",getThumbnailTypeForMediaMsg:null},{type:"payment",subtype:"request",getThumbnailTypeForMediaMsg:null},{type:"payment",subtype:"send",getThumbnailTypeForMediaMsg:null},{type:"pin_message",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"pinned_message",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"poll_creation",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"poll_result_snapshot",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"poll_update",subtype:"poll_vote",getThumbnailTypeForMediaMsg:null},{type:"product",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"admin_revoke",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"bot_feedback",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"bot_memu_onboarding",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"bot_request_welcome",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"ephemeral_setting",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"ephemeral_sync_response",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"event_edit_decrypted",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"history_sync_notification",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"limit_sharing_system_message",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"member_label",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"message_edit",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"message_edit_decrypted",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"message_history_notice",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"sender_revoke",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"share_phone_number",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"status_group_mention_message",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"status_mention_message",getThumbnailTypeForMediaMsg:null},{type:"ptt",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"ptv",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"reaction",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"reaction_enc",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"request_phone_number",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"revoked",subtype:"admin",getThumbnailTypeForMediaMsg:null},{type:"revoked",subtype:"sender",getThumbnailTypeForMediaMsg:null},{type:"rich_response",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"status_notification",subtype:"status_notification_message",getThumbnailTypeForMediaMsg:null},{type:"sticker",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"sticker-pack",subtype:void 0,getThumbnailTypeForMediaMsg:r("WAWebGetThumbnailTypeForMediaStickerPackMsg")},{type:"template_button_reply",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"unknown",subtype:"payment_action_request_declined",getThumbnailTypeForMediaMsg:null},{type:"unknown",subtype:"payment_transaction_request_cancelled",getThumbnailTypeForMediaMsg:null},{type:"unknown",subtype:"phone",getThumbnailTypeForMediaMsg:null},{type:"unknown",subtype:"phone_only_feature",getThumbnailTypeForMediaMsg:null},{type:"unknown",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"vcard",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"video",subtype:void 0,getThumbnailTypeForMediaMsg:r("WAWebGetThumbnailTypeForMediaVideoMsg")}];l.default=e}),98);
__d("WAWebMessagePluginGetThumbnailTypeForMediaMsg",["WAWebMessagePluginGetThumbnailTypeForMediaMsgRegistry","WAWebPluginCreateRegistryLookup"],(function(t,n,r,o,a,i,l){var e=o("WAWebPluginCreateRegistryLookup").createMsgTypeRegistryLookup(r("WAWebMessagePluginGetThumbnailTypeForMediaMsgRegistry"));function s(t){var n=t.msg,r=e(n.type,n.subtype);return r==null||r.getThumbnailTypeForMediaMsg==null?void 0:r.getThumbnailTypeForMediaMsg(t)}l.getThumbnailTypeForMediaMsg=s}),98);
__d("WAWebMediaDownloadMmsThumbnail",["Promise","WAAbortError","WABase64","WALogger","WANullthrows","WAWebDownloadManager","WAWebFrontendMsgGetters","WAWebMediaCryptoEligibilityUtils","WAWebMediaOpaqueData","WAWebMessagePluginGetThumbnailTypeForMediaMsg","WAWebMmsMediaTypes","WAWebMsgType","WAWebSerializeError","asyncToGeneratorRuntime","isStringNullOrEmpty","justknobx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g;function h(e){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.msg,a=t.chat,i=t.isPreload,l=t.signal;if(r("justknobx")._("1023")){var m=o("WAWebFrontendMsgGetters").getAsUrl(n.unsafe()),p=m==null?void 0:m.faviconMMSMetadata,_=p==null?void 0:p.thumbnailSha256;if(!(m==null||p==null||r("isStringNullOrEmpty")(p.thumbnailDirectPath)||_==null)){var f=p.thumbnail==null;if(!f){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMMSFavicon: skipping"])));return}o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMMSFavicon: start"])));try{var g=yield o("WAWebDownloadManager").downloadManager.downloadAndMaybeDecrypt({directPath:p.thumbnailDirectPath,encFilehash:p.thumbnailEncSha256,filehash:_,mediaKey:p.mediaKey,mediaKeyTimestamp:p.mediaKeyTimestamp,type:r("WANullthrows")(o("WAWebMessagePluginGetThumbnailTypeForMediaMsg").getThumbnailTypeForMediaMsg({msg:n})),signal:l||new AbortController().signal,userDownloadAttemptCount:0,isPreload:i,chatWid:a==null?void 0:a.id});if(g){var h=o("WABase64").encodeB64(g);m.faviconMMSMetadata=babelHelpers.extends({},m.faviconMMSMetadata,{thumbnail:h}),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMMSFavicon: success"])))}}catch(e){if(e.name===o("WAAbortError").ABORT_ERROR){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMMSFavicon aborted"])));return}o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMMSFavicon: error\n",""],["media.downloadMMSFavicon: error\\n",""])),r("WAWebSerializeError")(e)).verbose()}}}}),y.apply(this,arguments)}function C(e){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.msg,n=e.chat,a=e.isPreload,i=e.signal,l=t.thumbnailSha256,s=t.thumbnailEncSha256,u=t.thumbnailDirectPath,c=t.mediaKey,d=t.mediaKeyTimestamp;if(!(r("isStringNullOrEmpty")(u)||r("isStringNullOrEmpty")(l))&&!(o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMsg(t)&&(s==null||c==null||d==null))&&!((t.type===o("WAWebMsgType").MSG_TYPE.DOCUMENT||t.type===o("WAWebMsgType").MSG_TYPE.INTERACTIVE)&&o("WAWebMmsMediaTypes").getMsgMediaType(t)===o("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT&&(t.thumbnailHeight==null||t.thumbnailWidth==null))){var g=o("WAWebFrontendMsgGetters").getAsUrl(t.unsafe());if(!(g&&(g.thumbnailHeight==null||g.thumbnailWidth==null))){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMmsThumbnail: start"])));try{var h=yield o("WAWebDownloadManager").downloadManager.downloadAndMaybeDecrypt({directPath:u,encFilehash:s,filehash:l,mediaKey:c,mediaKeyTimestamp:d,type:r("WANullthrows")(o("WAWebMessagePluginGetThumbnailTypeForMediaMsg").getThumbnailTypeForMediaMsg({msg:t})),signal:i||new AbortController().signal,userDownloadAttemptCount:0,isPreload:a,chatWid:n==null?void 0:n.id});if(g)g.thumbnailHQ=o("WABase64").encodeB64(h);else{var y=r("WANullthrows")(t.mediaObject,"mediaObject cannot be null for thumbnail download"),C={fullPreviewData:yield r("WAWebMediaOpaqueData").createFromData(h,"image/jpeg")};t.type===o("WAWebMsgType").MSG_TYPE.DOCUMENT&&(C.fullPreviewSize={height:r("WANullthrows")(t.thumbnailHeight),width:r("WANullthrows")(t.thumbnailWidth)}),y.consolidate(C)}o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMmsThumbnail: success"])))}catch(e){if(e.name===o("WAAbortError").ABORT_ERROR){o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMmsThumbnail aborted"])));return}o("WALogger").WARN(f||(f=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMmsThumbnail: error\n",""],["media.downloadMmsThumbnail: error\\n",""])),r("WAWebSerializeError")(e)).verbose()}}}}),b.apply(this,arguments)}function v(e){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield(g||(g=n("Promise"))).all([h(e),C(e)])}),S.apply(this,arguments)}l.default=v}),98);
__d("WAWebMediaGetUploadOriginForChat",["WAWebChatGetters","WAWebFrontendChatGetters","WAWebStateUtils","WAWebWamEnumUploadOriginType"],(function(t,n,r,o,a,i,l){function e(e){if(!e)return o("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.UNKNOWN;var t=o("WAWebStateUtils").unproxy(e);return o("WAWebChatGetters").getIsNewsletter(t)?o("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.CHANNEL:o("WAWebChatGetters").getIsGroup(t)?o("WAWebFrontendChatGetters").getIsCAG(t)?o("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.COMMUNITY:o("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.CHAT_GROUP:o("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.CHAT_PERSONAL}l.default=e}),98);
__d("WAWebDownloadManagerErrors",["WAWebBackendErrors"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){var t;return t=e.call(this,404)||this,t.name="MediaNotOnPhone",t}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBackendErrors").ServerStatusCodeError);l.MediaNotOnPhone=e}),98);
__d("WAWebMediaEntry",["Promise","WABase64Equal","WAIsMediaKeyReusable","WALogger","WATimeUtils","WAWebMediaHosts","WAWebMmsClientFormatDownloadUrl","WAWebMmsOperationsConst","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u=["filehash","handle","metadataUrl","fbid","thumbnailDirectPath","thumbnailSha256"],c=["mediaKey","mediaKeyTimestamp","encFilehash"],d,m={PROBABLY_ON_SERVER:"PROBABLY_ON_SERVER",PROBABLY_OFF_SERVER:"PROBABLY_OFF_SERVER",UNKNOWN:"UNKNOWN"},p=(function(){function e(t){if(this.useBackupUrl=!1,this.constructor===e)throw r("err")("AbstractMediaEntry is an abstract class");this.deprecatedMms3Url=t.deprecatedMms3Url,this.serverStatus=m.UNKNOWN,this.sidecar=t.sidecar,this.directPath=t.directPath,this.firstFrameSidecar=t.firstFrameSidecar,this.type=t.type,this.scansSidecar=t.scansSidecar,this.scanLengths=t.scanLengths,this.staticUrl=t.staticUrl}var t=e.prototype;return t.markWhetherOnServer=function(t){this.serverStatus=t?m.PROBABLY_ON_SERVER:m.PROBABLY_OFF_SERVER},t.getMediaKey=function(){return null},t.getMediaKeyTimestamp=function(){return null},t.getEncfilehash=function(){return null},t.getFilehash=function(){return null},t.getThumbnailDirectPath=function(){return null},t.getThumbnailSha256=function(){return null},t.validateForDownloads=function(){return this.serverStatus!==m.PROBABLY_OFF_SERVER},e})(),_=(function(e){function t(t){var n,r=t.filehash,o=t.handle,a=t.metadataUrl,i=t.fbid,l=t.thumbnailDirectPath,s=t.thumbnailSha256,c=babelHelpers.objectWithoutPropertiesLoose(t,u);return n=e.call(this,c)||this,n.filehash=r,n.handle=o,n.metadataUrl=a,n.fbid=i,n.thumbnailDirectPath=l,n.thumbnailSha256=s,n}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getFilehash=function(){return this.filehash},n.getThumbnailDirectPath=function(){return this.thumbnailDirectPath},n.getThumbnailSha256=function(){return this.thumbnailSha256},t})(p),f=(function(e){function t(t){var n,r=t.mediaKey,o=t.mediaKeyTimestamp,a=t.encFilehash,i=babelHelpers.objectWithoutPropertiesLoose(t,c);return n=e.call(this,i)||this,n.mediaKey=r,n.mediaKeyTimestamp=o,n.encFilehash=a,n}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a.canReuseMediaKey=function(){if(this.directPath==null)return!1;var e=o("WATimeUtils").castToUnixTime(this.mediaKeyTimestamp);return o("WAIsMediaKeyReusable").isMediaKeyReusable(e)},a.getMediaKey=function(){return this.mediaKey},a.getMediaKeyTimestamp=function(){return this.mediaKeyTimestamp},a.getEncfilehash=function(){return this.encFilehash},a.url=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e||{},a=t.useFallback,i=t.forceHashUrl,l=this.encFilehash;if(l==null||l==="")return(d||(d=n("Promise"))).reject(r("err")("media_entry: encFilehash does not exist"));var s=yield o("WAWebMediaHosts").mediaHosts.getHostsInfo({operation:r("WAWebMmsOperationsConst").DOWNLOAD,encFilehash:l,type:this.type}),u=s.selectedHost,c=s.fallbackHost,m=a&&c?c:u;return r("WAWebMmsClientFormatDownloadUrl")({directPath:i?null:this.directPath,encFilehash:l,hostname:m.hostname,type:this.type})});function t(t){return e.apply(this,arguments)}return t})(),t})(p),g=(function(){function t(){this.entries=[]}var n=t.prototype;return n.$1=function(n){var t=n.foundEntry,r=n.mediaKey,a=n.mediaKeyTimestamp,i=n.encFilehash,l=n.sidecar,s=n.directPath,u=n.firstFrameSidecar,c=n.scansSidecar,d=n.scanLengths,m=n.deprecatedMms3Url,p=n.staticUrl;if(t instanceof f&&r!=null&&r!==""&&!o("WABase64Equal").b64Equal(t.mediaKey,r)){var _=t.mediaKey.replace("=","").split("\n")[0],g=r.replace("=","").split("\n")[0];return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["media-fault: mediaKey changed for the same MMS3 url. type:",". equal?:",". Debug:\n",""],["media-fault: mediaKey changed for the same MMS3 url. type:",". equal?:",". Debug:\\n",""])),t.type,_===g,JSON.stringify({before:{hasDirectPath:!!t.directPath,hasEncFilehash:!!t.encFilehash,hasMediaKey:!!t.mediaKey,hasDeprecatedMms3Url:!!t.deprecatedMms3Url},after:{hasDirectPath:!!s,hasEncFilehash:!!i,hasDeprecatedMms3Url:!!m}},null,2)).sendLogs("media-key-mismatch-same-mms3-url"),null}return t instanceof f&&a!=null&&(t.mediaKeyTimestamp=a),l&&(t.sidecar=l),u&&(t.firstFrameSidecar=u),c&&(t.scansSidecar=c),d!=null&&d.length&&(t.scanLengths=d),p&&(t.staticUrl=p),t.directPath=s,t},n.updateEntry=function(t){var e=t.deprecatedMms3Url,n=t.mediaKey,r=t.mediaKeyTimestamp,o=t.encFilehash,a=t.type,i=t.sidecar,l=t.directPath,s=t.firstFrameSidecar,u=t.scansSidecar,c=t.scanLengths,d=t.staticUrl,m=this.getEntryByEncFilehash({encFilehash:o,deprecatedMms3Url:e});if(m)return this.$1({foundEntry:m,mediaKey:n,mediaKeyTimestamp:r,encFilehash:o,sidecar:i,directPath:l,firstFrameSidecar:s,scansSidecar:u,scanLengths:c,deprecatedMms3Url:e,staticUrl:d})},n.addUnencryptedEntry=function(t){var e=this.updateUnencryptedEntry({filehash:t.filehash,directPath:t.directPath});if(e)return e.handle=t.handle,e.metadataUrl=t.metadataUrl,e.fbid=t.fbid,e;var n=new _({deprecatedMms3Url:t.directPath,filehash:t.filehash,type:t.type,directPath:t.directPath,handle:t.handle,metadataUrl:t.metadataUrl,thumbnailDirectPath:t.thumbnailDirectPath,thumbnailSha256:t.thumbnailSha256,fbid:t.fbid});return this.entries.push(n),n},n.updateUnencryptedEntry=function(t){var e=t.directPath!=null?this.getUnencryptedEntry(t.filehash,t.directPath):null;return!e||!(e instanceof _)?null:(t.directPath!=null&&(e.directPath=t.directPath),e)},n.addEntry=function(t){var e=t.deprecatedMms3Url,n=t.mediaKey,r=t.mediaKeyTimestamp,a=t.encFilehash,i=t.type,l=t.sidecar,u=t.directPath,c=t.firstFrameSidecar,d=t.scansSidecar,m=t.scanLengths,p=t.staticUrl,_=t.debugHint;a==null&&o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Media type "," from "," is missing encFilehash"])),i,_).devConsole(t).sendLogs("media-entry-missing-upload-hash-"+i+"-"+_);var g=this.entries,h=this.getEntryByEncFilehash({encFilehash:a,deprecatedMms3Url:e}),y=h?this.$1({foundEntry:h,mediaKey:n,mediaKeyTimestamp:r,encFilehash:a,sidecar:l,directPath:u,firstFrameSidecar:c,scansSidecar:d,scanLengths:m,deprecatedMms3Url:e,staticUrl:p}):null;if(y instanceof f)return y;if(!n)return null;var C=new f({deprecatedMms3Url:e,mediaKey:n,mediaKeyTimestamp:r,encFilehash:a,type:i,sidecar:l,directPath:u,firstFrameSidecar:c,scansSidecar:d,scanLengths:m,staticUrl:p});return g.push(C),C},n.$2=function(t){var e=t.encFilehash,n=t.deprecatedMms3Url;return e==null?"mms3:"+n:e},n.has=function(t){return this.getEntryByEncFilehash(t)instanceof f},n.hasUnencryptedEntry=function(t){return t.filehash==null||t.directPath==null?!1:this.getUnencryptedEntry(t.filehash,t.directPath)instanceof _},n.getEntryByEncFilehash=function(t){var e=this,n=this.$2(t);return this.entries.find(function(t){return t instanceof f&&e.$2({encFilehash:t.encFilehash,deprecatedMms3Url:t.deprecatedMms3Url})===n})},n.getUnencryptedEntry=function(t,n){return this.entries.find(function(e){return e instanceof _&&e.filehash===t&&e.directPath===n})},n.$3=function(t){return this.entries.filter(function(e){return t?e instanceof f:e instanceof _})},n.getUploadEntry=function(t){return h(this),this.$3(t)[0]},n.getDownloadEntry=function(t){return h(this),this.$3(t).find(function(e){return e.validateForDownloads()})},n.clearEntries=function(){this.entries=[]},t})();function h(e){e.entries.sort(function(e,t){var n=y(t)-y(e);if(n!==0)return n;var r=e.getMediaKeyTimestamp(),o=t.getMediaKeyTimestamp();return r==null||o==null?n:o-r})}function y(e){var t=0;switch(e.serverStatus){case m.PROBABLY_ON_SERVER:t+=200;break;case m.PROBABLY_OFF_SERVER:break;case m.UNKNOWN:t+=100;break}return e.getEncfilehash()!=null&&(t+=20),t}l.AbstractMediaEntry=p,l.UnencryptedMediaEntry=_,l.EncryptedMediaEntry=f,l.MediaEntryList=g}),98);
__d("WAWebMmsConst",[],(function(t,n,r,o,a,i){var e=100;i.FILE_PROGRESS_THROTTLE_WAIT_MS=e}),66);
__d("WAWebWamEnumStickerErrorType",[],(function(t,n,r,o,a,i){var e=Object.freeze({DECOMPRESSION:2,SENDER_VALIDATION:3,RECEIVER_VALIDATION:4});i.STICKER_ERROR_TYPE=e}),66);
__d("WAWebStickerErrorWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumStickerErrorType"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({StickerError:[5024,{stickerErrorType:[1,o("WAWebWamEnumStickerErrorType").STICKER_ERROR_TYPE]},[1,1,1],"regular"]},{StickerError:[]});l.StickerErrorWamEvent=e}),98);
__d("WAWebWamEnumStickerLatencyAction",[],(function(t,n,r,o,a,i){var e=Object.freeze({DECOMPRESSION:2});i.STICKER_LATENCY_ACTION=e}),66);
__d("WAWebStickerLatencyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumStickerLatencyAction"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({StickerLatency:[5026,{size:[1,o("WAWebWamCodegenUtils").TYPES.INTEGER],stickerLatencyAction:[2,o("WAWebWamEnumStickerLatencyAction").STICKER_LATENCY_ACTION],stickerLatencyTtAction:[3,o("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,1],"regular"]},{StickerLatency:[]});l.StickerLatencyWamEvent=e}),98);
__d("WAWebWebcProgressiveImageWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WebcProgressiveImage:[2226,{webcFirstRenderScans:[1,e.TYPES.INTEGER],webcFirstRenderT:[2,e.TYPES.TIMER],webcFullQualityT:[4,e.TYPES.TIMER],webcMidQualityT:[3,e.TYPES.TIMER]},[1,1,10],"regular"]},{WebcProgressiveImage:[]});l.WebcProgressiveImageWamEvent=s}),98);
__d("WAWebMediaMmsV4Download",["WAAbortError","WABlobToArrayBuffer","WACustomError","WAFilteredCatch","WALogger","WANullthrows","WARaceSignal","WAWebABProps","WAWebCryptoImageStreamer","WAWebDownloadManager","WAWebDownloadManagerErrors","WAWebEnvironment","WAWebFileUtils","WAWebInMemoryLottieStickerCache","WAWebMediaCryptoEligibilityUtils","WAWebMediaDataUtils","WAWebMediaEntry","WAWebMediaInMemoryBlobCache","WAWebMediaLoad","WAWebMediaOpaqueData","WAWebMediaTypes","WAWebMimeTypes","WAWebMiscErrors","WAWebMmsClientErrors","WAWebMmsConst","WAWebMmsMediaTypes","WAWebODS","WAWebStickerErrorWamEvent","WAWebStickerLatencyWamEvent","WAWebStickerMimeUtils","WAWebStickerUtils","WAWebVcardParsingUtils","WAWebWamEnumStickerErrorType","WAWebWamEnumStickerLatencyAction","WAWebWebcProgressiveImageWamEvent","asyncToGeneratorRuntime","err","fflate","isStringNullOrEmpty","lodash"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WACustomError").customError("NoEntryAfterRMR")),E=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WACustomError").customError("MissingEncFilehash")),k={THUMBNAIL:1,LOW:2,MID:3,FULL:4},I=new WeakMap;function T(e){e.getDownloadPromises().forEach(function(e){var t;if(e!=null){var n=(t=I.get(e))==null?void 0:t.abort;n!=null&&(I.delete(e),n())}})}function D(e){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.mimetype,n=e.mediaObject,r=e.mediaBlob,a=e.mediaType,i=e.rmrReason,l=e.downloadOrigin,s=e.chatWid;n.mediaBlob||(yield o("WAWebMediaDataUtils").gatherAndSetMetadata(n,r),yield N({mimetype:t,mediaObject:n,downloadEvenIfExpensive:!1,mediaType:a,rmrReason:i,downloadOrigin:l,chatWid:s}))}),x.apply(this,arguments)}function $(e){return P.apply(this,arguments)}function P(){return P=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n,a=e.mimetype,i=r("lodash").throttle(function(t){e.mediaObject.consolidate({loadedSize:t.loaded})},o("WAWebMmsConst").FILE_PROGRESS_THROTTLE_WAIT_MS),l=yield o("WAWebDownloadManager").downloadManager.downloadAndMaybeDecrypt({shouldSequenceDownload:e.shouldSequenceDownload,directPath:e.directPath,encFilehash:e.encFilehash,filehash:e.objFilehash,isFinalRmrRetry:e.isFinalRmrRetry,mediaKey:e.mediaKey,mediaKeyTimestamp:e.mediaKeyTimestamp,signal:e.signal,staticUrl:e.staticUrl,type:e.mediaType,mimetype:a,onDecryptStart:function(){e.mediaObject.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.PROCESSING})},onProgress:i,userDownloadAttemptCount:e.mediaObject.userDownloadAttemptCount,downloadOrigin:e.downloadOrigin,mode:e.mode,progressiveJpegOpts:q({scanLengths:e.scanLengths,scansSidecar:e.scansSidecar,mimetype:a,mediaObject:e.mediaObject,signal:e.signal}),isViewOnce:e.isViewOnce,imageDimensions:e.mediaType===o("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE?{fileHeight:(t=e.mediaObject.contentInfo.fullHeight)!=null?t:0,fileWidth:(n=e.mediaObject.contentInfo.fullWidth)!=null?n:0}:void 0,chatWid:e.chatWid}),s=a!=null&&a!==""?a:o("WAWebMimeTypes").getMediaMimeType(e.mediaType,new Uint8Array(l));return new Blob([l],{type:s})}),P.apply(this,arguments)}function N(e){return M.apply(this,arguments)}function M(){return M=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=t.mimetype,i=t.mediaObject,l=t.downloadEvenIfExpensive,b=t.mediaType,v=t.signal,S=t.rmrReason,R=t.rmrData,k=t.downloadOrigin,T=t.shouldThrow,D=t.isVcardOverMmsDocument,x=t.mode,P=t.isAutoDownload,M=t.isFinalRmrRetry,w=t.isViewOnce,A=t.chatWid,F=t.shouldSequenceDownload,O=F===void 0?!1:F,B=T===!0,W=P!==!0||r("WAWebEnvironment").isWindows;if(i){var q=i.filehash;if(!r("isStringNullOrEmpty")(q)){var U=H(i,b);U&&W&&(U.shouldStoreInMemory=!0);var V=i.getDownloadPromise(b);if(V)return V;if(i.downloadStage!==o("WAWebMediaTypes").DownloadStage.ERROR_MISSING&&i.downloadStage!==o("WAWebMediaTypes").DownloadStage.PREPARING){if(i.mediaBlob){var z=yield i.mediaBlob.validate();if(z){i.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.RESOLVED});return}i.clearBlob(),i.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.NEED_POKE}),i.notifyMsgsAsync();return}var j=o("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.get(q),K,Q,X=new AbortController;return r("WARaceSignal")([X.signal,v].filter(Boolean),function(t){var v,T,F=(function(){var u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(j)Q=j;else{var n,u,c;if(K=i.entries.getDownloadEntry(o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(b)),!K)if(l&&o("WAWebMediaCryptoEligibilityUtils").isRmrSupportedForMediaType(b)){if(yield o("WAWebDownloadManager").downloadManager.rmr({mediaObject:i,signal:t,rmrReason:S,rmrData:R}),K=i.entries.getDownloadEntry(o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(b)),!K){if(b!==o("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER)throw new L;return}}else{if(!o("WAWebMediaCryptoEligibilityUtils").isRmrSupportedForMediaType(b))throw new(o("WAWebDownloadManagerErrors")).MediaNotOnPhone;i.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.NEED_POKE});return}i.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.FETCHING}),K=r("WANullthrows")(K);var d=K,m=d.scansSidecar,p=d.scanLengths,_=d.directPath,f=d.staticUrl;if(K instanceof o("WAWebMediaEntry").EncryptedMediaEntry&&K.getEncfilehash()==null){var g;throw(g=K)==null||g.markWhetherOnServer(!1),new E}var h=yield $({directPath:_,encFilehash:(n=K)==null?void 0:n.getEncfilehash(),objFilehash:q,isFinalRmrRetry:M,mediaKey:(u=K)==null?void 0:u.getMediaKey(),mediaKeyTimestamp:(c=K)==null?void 0:c.getMediaKeyTimestamp(),signal:t,staticUrl:f,mediaType:b,mediaObject:i,downloadOrigin:k,mode:x,scanLengths:p,mimetype:a,scansSidecar:m,isViewOnce:w,chatWid:A,shouldSequenceDownload:O});G(b)?Q=yield o("WAWebMediaLoad").transcode(h):Q=h}if(Q.type===o("WAWebStickerMimeUtils").WhatsAppLottieStickerMimeType&&(o("WAWebInMemoryLottieStickerCache").InMemoryLottieStickerCache.has(q)||(yield o("WAWebInMemoryLottieStickerCache").extractAndSetLottieJSONInMemoryCache(q,Q)),i.consolidate({isLottie:!0})),Q.type==="text/vcard"&&D===!0)try{var y=yield o("WAWebFileUtils").blobToText(Q);if(y){var C=o("WAWebVcardParsingUtils").parseMultiVcard(y);C.length>0?i.consolidate({parsedVcards:C}):o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).tags("non-sad").sendLogs("vcard_over_mms:Failed to parse vcard over mms contents")}}catch(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Failed to retrieve blob text contents ",""])),String(e)).tags("non-sad").sendLogs("vcard_over_mms:blobToText failed with error: "+String(e))}if(o("WAWebMediaDataUtils").shouldUseMediaCache(b)){var I=H(i,b);(I!=null&&I.shouldStoreInMemory||W)&&(o("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.put(q,Q),yield o("WAWebMediaDataUtils").gatherAndSetMetadataNoOpaque(i,Q))}else{var v=yield r("WAWebMediaOpaqueData").createFromData(Q,Q.type);yield o("WAWebMediaDataUtils").gatherAndSetMetadata(i,v)}return i.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.RESOLVED}),i.clearDownloadPromise(b),i.resolveWhenConsolidated()});return function(){return u.apply(this,arguments)}})(),U=F().catch((T=o("WAFilteredCatch")).filteredCatch(o("WAWebMmsClientErrors").MediaNotFoundError,(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!K||(K.markWhetherOnServer(!1),!l))throw e;return yield o("WAWebDownloadManager").downloadManager.rmr({mediaObject:i,signal:new AbortController().signal,rmrReason:S,rmrData:R}),i.clearDownloadPromise(b),N({mimetype:a,mediaObject:i,downloadEvenIfExpensive:!1,mediaType:b,rmrReason:S,rmrData:R,downloadOrigin:k,isFinalRmrRetry:!0,isVcardOverMmsDocument:D,mode:x,isAutoDownload:P,chatWid:A})});return function(t){return e.apply(this,arguments)}})())).catch(T.filteredCatch(o("WAWebMiscErrors").MediaUnsupportedError,function(e){if(i.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.ERROR_UNSUPPORTED}),o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia: media unsupported error: ",", ",", ",""])),e.name,e.message,a||""),o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed! ",""])),e.message).tags("non-sad").sendLogs("downloadMedia: media unsupported error:"),B)throw e})).catch(T.filteredCatch(o("WAWebDownloadManagerErrors").MediaNotOnPhone,function(e){if(i.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.ERROR_MISSING}),B)throw e})).catch(T.filteredCatch([L,E],function(e){if(i.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.ERROR_MISSING}),!(e===L&&b===o("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER)&&(o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Unexpected download error: ",""])),e.name).devConsole(e.message,e.stack),o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).tags("non-sad").sendLogs("unexpected download error: "+e.name),B))throw e})).catch(T.filteredCatch([o("WAWebMiscErrors").MediaDecryptionError,o("WAWebMiscErrors").MediaHashMismatch],function(e){var t=i.progressiveStage;if(X.abort(),i.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.NEED_POKE,progressiveStage:null}),i.notifyMsgsAsync(),i.delete(),o("WAWebCryptoImageStreamer").deleteFromInMemoryMediaBlobCache(q,t),B)throw e})).catch(function(e){if(i.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.NEED_POKE}),e instanceof o("WAWebMiscErrors").MediaLoadError){if(o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia: media unsupported error: ",", ",", ",""])),e.name,e.message,a||""),o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed! ",""])),e.message).tags("non-sad").sendLogs("downloadMedia: media load error:",{sampling:0}),B)throw e;return}if(e instanceof o("WAWebMiscErrors").TranscodeBlobTooLargeError){if(o("WALogger").WARN(f||(f=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia: error: ",", ",""])),e.message,a||""),o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed! ",""])),e.message).tags("non-sad").sendLogs("downloadMedia: transcode blob too large",{sampling:0}),B)throw e;return}if(e instanceof o("WAWebMiscErrors").UnableToPlayVideoError){if(o("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia: error: ",", ",""])),e.message,a||""),o("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed! ",""])),e.message).tags("non-sad").sendLogs("downloadMedia: unable to play video",{sampling:0}),B)throw e;return}if(e.name===o("WAAbortError").ABORT_ERROR){if(B)throw e;return}if(o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia: error"]))).devConsole(e.name,e.message,e.stack),B)throw e}).finally(function(){i.clearDownloadPromise(b)});return I.set(U,{abort:function(){X.abort()},shouldStoreInMemory:((v=H(i,b))==null?void 0:v.shouldStoreInMemory)||W}),i.setDownloadPromise(U,b),U})}}}}),M.apply(this,arguments)}var w=function(t){var e=/animation\/animation.json$/,n=Object.keys(t).find(function(t){return e.test(t)});return n!=null?t[n]:void 0};function A(e,t){return F.apply(this,arguments)}function F(){return F=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){try{var n=new(o("WAWebStickerLatencyWamEvent")).StickerLatencyWamEvent({size:e.size,stickerLatencyAction:o("WAWebWamEnumStickerLatencyAction").STICKER_LATENCY_ACTION.DECOMPRESSION}),a=self.performance.now(),i=yield o("WABlobToArrayBuffer").blobToArrayBuffer(e),l=new Uint8Array(i),s=o("fflate").unzipSync(l),u=w(s);if(!u)throw r("err")("animationContents missing");if(u){var c=new TextDecoder("utf-8").decode(u),d=yield o("WAWebStickerUtils").isLottieStickerFirstParty(s,c);if(!d)throw o("WALogger").ERROR(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[extractLottieJSON] Lottie sticker is not first party"]))),r("WAWebODS")==null||r("WAWebODS").incr("web.stickers.lottie_sticker_not_first_party"),r("err")("Lottie sticker is not first party");return n.stickerLatencyTtAction=Math.ceil(self.performance.now()-a),o("WAWebABProps").getABPropConfigValue("gimmick_phase_two_logging_enabled")&&n.commit(),c}}catch(e){o("WAWebABProps").getABPropConfigValue("gimmick_phase_two_logging_enabled")&&new(o("WAWebStickerErrorWamEvent")).StickerErrorWamEvent({stickerErrorType:o("WAWebWamEnumStickerErrorType").STICKER_ERROR_TYPE.DECOMPRESSION}).commit(),o("WALogger").DEV(v||(v=babelHelpers.taggedTemplateLiteralLoose(["Failed to extract Lottie Sticker for trimmed-filehash: "," "])),t.slice(0,10)),o("WALogger").ERROR(S||(S=babelHelpers.taggedTemplateLiteralLoose(["Failed to extract Lottie Sticker zip file ",""])),String(e)).tags("non-sad").sendLogs("lottie_sticker:Failed to extract Lottie Sticker zip file")}}),F.apply(this,arguments)}function O(e){return B.apply(this,arguments)}function B(){return B=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.mimetype,n=e.mediaObject,a=e.mediaType,i=n.filehash;if(!r("isStringNullOrEmpty")(i)&&n.downloadStage===o("WAWebMediaTypes").DownloadStage.INIT&&!(yield U(n))){var l=o("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.get(i),s=new AbortController;if(l){n.downloadStage===o("WAWebMediaTypes").DownloadStage.INIT&&n.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.EXISTS});return}var u=n.entries.getDownloadEntry(o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(a));if(!u){n.downloadStage===o("WAWebMediaTypes").DownloadStage.INIT&&n.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.NEED_POKE});return}if(!(u instanceof o("WAWebMediaEntry").UnencryptedMediaEntry)){var c=u.getEncfilehash();if(r("isStringNullOrEmpty")(c)){u.markWhetherOnServer(!1),n.downloadStage===o("WAWebMediaTypes").DownloadStage.INIT&&n.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.NEED_POKE});return}try{r("isStringNullOrEmpty")(u.staticUrl)&&(yield o("WAWebDownloadManager").downloadManager.checkExistence({directPath:u.directPath,encFilehash:c,signal:s.signal,type:a})),n.downloadStage===o("WAWebMediaTypes").DownloadStage.INIT&&n.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.EXISTS})}catch(e){n.downloadStage===o("WAWebMediaTypes").DownloadStage.INIT&&n.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.NEED_POKE}),o("WALogger").LOG(R||(R=babelHelpers.taggedTemplateLiteralLoose(["checkExistence: error"]))).devConsole(e.name,e.message,e.stack)}}}}),B.apply(this,arguments)}function W(e,t){return!!(e&&t&&e.length>=2&&e.length*10===t.byteLength)}function q(e){var t=e.scanLengths,n=e.scansSidecar,a=e.mimetype,i=e.mediaObject,l=e.signal;if(!W(t,n))return null;var s=new(o("WAWebWebcProgressiveImageWamEvent")).WebcProgressiveImageWamEvent({webcFirstRenderScans:0});return{mimetype:a,scansSidecar:r("WANullthrows")(n),scanLengths:r("WANullthrows")(t),onProgressiveUpdate:function(t){l.aborted||i.downloadStage!==o("WAWebMediaTypes").DownloadStage.RESOLVED&&(i.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.PROGRESSIVE_READY,progressiveStage:t}),s.webcFirstRenderScans||(s.webcFirstRenderScans=t,s.markWebcFirstRenderT()),t>=k.MID&&!s.webcMidQualityT&&s.markWebcMidQualityT(),t===k.FULL&&!s.webcFullQualityT&&(s.markWebcFullQualityT(),s.commit()))}}}function U(e){return V.apply(this,arguments)}function V(){return V=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!e.mediaBlob)return!1;var t=yield e.mediaBlob.validate();return t?(e.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.RESOLVED}),!0):(e.clearBlob(),e.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.NEED_POKE}),e.notifyMsgsAsync(),!1)}),V.apply(this,arguments)}function H(e,t){var n=e.getDownloadPromise(t);return n?I.get(n):null}function G(e){return e===o("WAWebMmsMediaTypes").MEDIA_TYPES.PTT||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTT||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.AUDIO||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_AUDIO}l.NoEntryAfterRMR=L,l.MissingEncFilehash=E,l.cancelDownloadMedia=T,l.manuallySetMedia=D,l.downloadMedia=N,l.getContentsOfLottieJSONFile=w,l.extractLottieJSON=A,l.checkExistence=O}),98);
__d("WAWebHDMediaUtils",["WAWebABProps"],(function(t,n,r,o,a,i,l){function e(e,t){var n=Math.max(e,t);return n>=o("WAWebABProps").getABPropConfigValue("original_quality_image_min_edge")}function s(e,t){if(!o("WAWebABProps").getABPropConfigValue("hd_video_label_enabled"))return!1;var n=[Math.max(e,t),Math.min(e,t)],r=n[0],a=n[1];return a>=o("WAWebABProps").getABPropConfigValue("hd_video_definition_min_edge")?!0:r>o("WAWebABProps").getABPropConfigValue("hd_video_definition_max_edge")&&a>=o("WAWebABProps").getABPropConfigValue("hd_video_definition_min_edge_with_max_edge")}l.isHdPhoto=e,l.isHdVideo=s}),98);
__d("WAWebWamEnumDownloadOriginType",[],(function(t,n,r,o,a,i){var e=Object.freeze({CHAT_PERSONAL:1,CHAT_GROUP:2,STATUS_USER:3,STATUS_ADS:4,PRODUCT_CATALOG:5,GDPR:6,STICKER_PICKER:7,PROFILE_PICTURE:8,BLOKS:9,P2B:10,MESSAGE_HISTORY_SYNC:11,COMMUNITY:12,CHANNEL:13,BROADCAST:14,INTEROP:15,WAMO_STATUS:16,WAMO_BIZ_PROFILE:17,WAMO_PREFERENCES:18,RICH_ORDER_STATUS:19});i.DOWNLOAD_ORIGIN_TYPE=e}),66);
__d("WAWebMediaGetDownloadOriginFromUploadOrigin",["WAWebWamEnumDownloadOriginType","WAWebWamEnumUploadOriginType"],(function(t,n,r,o,a,i,l){function e(e){switch(e){case o("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.CHAT_PERSONAL:return o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHAT_PERSONAL;case o("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.CHANNEL:return o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHANNEL;case o("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.COMMUNITY:return o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.COMMUNITY;default:return o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHAT_GROUP}}l.getDownloadOriginFromUploadOrigin=e}),98);
__d("WAWebMediaMmsV4Upload",["Promise","WAAbortError","WAFilteredCatch","WALogger","WAMediaCalculateFilehash","WAWebCreateMediaUploadMetrics","WAWebDownloadManagerErrors","WAWebEnvironment","WAWebFileUtils","WAWebHDMediaUtils","WAWebMediaCryptoEligibilityUtils","WAWebMediaDataUtils","WAWebMediaEntry","WAWebMediaGatingUtils","WAWebMediaGetDownloadOriginFromUploadOrigin","WAWebMediaInMemoryBlobCache","WAWebMediaLoad","WAWebMediaMmsV4Download","WAWebMediaStore","WAWebMediaTypes","WAWebMiscErrors","WAWebMmsClientErrors","WAWebMmsConst","WAWebMmsMediaTypes","WAWebUploadManager","WAWebWamEnumWebcRmrReasonCode","asyncToGeneratorRuntime","err","lodash"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p=new WeakMap;function _(e){e.getUploadPromises().forEach(function(e){if(e!=null){var t=p.get(e);t!=null&&(p.delete(e),t())}})}var f={SUCCESS:"success",CANCELLATION:"cancellation",ERROR:"error",TIMEOUT:"timeout"};function g(e){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n,a=e.blob,i=e.canEnableFastForward,l=i===void 0?!0:i,s=e.forwardedFromWeb,u=e.mediaKeyInfo,c=e.mediaObject,d=e.mediaType,m=e.signal,p=e.uploadEntry,_=e.uploadOrigin,f=e.isViewOnce,g=e.earlyUpload;if(p instanceof o("WAWebMediaEntry").EncryptedMediaEntry&&p!=null&&p.canReuseMediaKey()&&l)return r("WAWebCreateMediaUploadMetrics")(d,_,0,s,f).handleCheckExistingSuccess(),p;var h=yield g;if(h!=null)return c.entries.addEntry({deprecatedMms3Url:h.url,mediaKey:h.mediaKey,mediaKeyTimestamp:h.mediaKeyTimestamp,encFilehash:h.encFilehash,type:d,sidecar:h.sidecar,directPath:h.directPath,firstFrameSidecar:h.firstFrameSidecar,debugHint:"upload"});var y=function(){c.consolidate({uploadStage:o("WAWebMediaTypes").UploadStage.FINALIZING})},C=r("lodash").throttle(function(e,t){var n=e.loaded+t;Number.isFinite(n)&&c.consolidate({loadedSize:n})},o("WAWebMmsConst").FILE_PROGRESS_THROTTLE_WAIT_MS),b=u?u.key:p==null?void 0:p.getMediaKey(),v=u?u.timestamp:p==null?void 0:p.getMediaKeyTimestamp(),S=yield r("WAWebUploadManager").encryptAndUpload({blob:a,mediaKey:b,mediaKeyTimestamp:v,type:d,signal:m,userUploadAttemptCount:c.userUploadAttemptCount,forwardedFromWeb:s,uploadOrigin:_,onProgress:C,onFinalize:y,isViewOnce:f,isHdPhoto:d===o("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE&&o("WAWebHDMediaUtils").isHdPhoto((t=c.contentInfo.fullHeight)!=null?t:0,(n=c.contentInfo.fullWidth)!=null?n:0)}),R=S.directPath,L=S.encFilehash,E=S.mediaKey,k=S.mediaKeyTimestamp,I=S.url,T=S.sidecar,D=S.firstFrameSidecar;return c.entries.addEntry({deprecatedMms3Url:I,mediaKey:E,mediaKeyTimestamp:k,encFilehash:L,type:d,sidecar:T,directPath:R,firstFrameSidecar:D,debugHint:"upload"})}),h.apply(this,arguments)}function y(e){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.blob,n=e.mediaObject,a=e.mediaType,i=e.signal,l=e.uploadOrigin,s=e.isViewOnce,u=e.calculateToken,c=yield o("WAWebFileUtils").blobToArrayBuffer(t),d=yield o("WAMediaCalculateFilehash").calculateFilehash(c),m=yield r("WAWebUploadManager").unencryptedUpload({file:c,isViewOnce:s,signal:i,type:a,uploadOrigin:l,hash:d,token:yield u==null?void 0:u(d),generateThumbnailOnServer:o("WAWebMediaGatingUtils").isThumbnailGenerationOnServerEnabledForMediaType(a)});return n.entries.addUnencryptedEntry({directPath:m.directPath,debugHint:"upload",filehash:d,type:a,handle:m.handle,metadataUrl:m.metadataUrl,thumbnailDirectPath:m.thumbnailDirectPath,thumbnailSha256:m.thumbnailSha256,fbid:m.fbid})}),C.apply(this,arguments)}function b(e){return S(e,g)}function v(e){return S(e,y)}function S(t,a){var i=t.mimetype,l=t.canEnableFastForward,_=l===void 0?!0:l,g=t.mediaObject,h=t.mediaType,y=t.forwardedFromWeb,C=t.uploadOrigin,b=t.mediaKeyInfo,v=t.isViewOnce,S=t.earlyUpload,L=t.calculateToken,E=b,k=g.getUploadPromise(h);if(k)return k;var I=new AbortController,T=I.signal,D=(m||(m=n("Promise"))).resolve().then(function(){g.consolidate({uploadStage:o("WAWebMediaTypes").UploadStage.UPLOADING})}).then(function(){return R({mediaObject:g,mimetype:i,mediaType:h,abortSignal:T,uploadOrigin:C})}).then((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n;if(_&&(n=g.entries.getUploadEntry(o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(h))),n instanceof o("WAWebMediaEntry").EncryptedMediaEntry&&E&&n.mediaKey!==E.key){var i,l,u=E;o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["uploadEntry.mediaKey and mediaKeyInfo.mediaKey should be the same, mediaType: ",""])),h).sendLogs("media-keys-not-the-same-"+h);var c=!g.entries.entries.some(function(e){return e.getMediaKey()===u.key});if(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[_uploadMediaAndManageErrors]: isNewEntry: "," uploadEntry.mediaKey length "," - mediaKeyInfo.mediaKey length ",""])),c,(i=n.mediaKey)==null?void 0:i.length,(l=u.key)==null?void 0:l.length),h===o("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER)E=null;else throw r("err")("uploadEntry.mediaKey and mediaKeyInfo.mediaKey should be the same")}var d=yield a({blob:t,canEnableFastForward:_,forwardedFromWeb:y,mediaKeyInfo:E,mediaObject:g,mediaType:h,signal:T,uploadEntry:n,uploadOrigin:C,isViewOnce:v,earlyUpload:S,calculateToken:L});if(!d)throw r("err")("could not create media entry");if((h===o("WAWebMmsMediaTypes").MEDIA_TYPES.PTT||h===o("WAWebMmsMediaTypes").MEDIA_TYPES.AUDIO)&&!o("WAWebMediaDataUtils").canPlayOgg())if(o("WAWebMediaDataUtils").shouldUseMediaCache(h)){var m=g.filehash;if(m&&g.mediaBlob){var p=yield o("WAWebMediaLoad").transcode(g.mediaBlob.formData());o("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.put(m,p)}}else g.mediaBlob&&(yield o("WAWebMediaDataUtils").gatherAndSetMetadata(g,g.mediaBlob));var f=g.filehash;if(r("WAWebEnvironment").isWindows&&f!=null){var b=yield o("WAWebFileUtils").blobToArrayBuffer(t);yield o("WAWebMediaStore").LruMediaStore.put(f,b)}return d});return function(e){return t.apply(this,arguments)}})()).then(function(e){var t;if(T.aborted)throw new(o("WAAbortError")).AbortError;return g.consolidate({uploadStage:o("WAWebMediaTypes").UploadStage.UPLOADED}),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["MediaAlgo.uploadMedia: success"]))).devConsole((t=e.getEncfilehash())!=null?t:e.getFilehash()),{kind:f.SUCCESS,mediaEntry:e}}).catch(function(e){throw e.name===o("WAAbortError").ABORT_ERROR?o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["MediaAlgo.uploadMedia: canceled"]))).devConsole(e):o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["MediaAlgo.uploadMedia: ",""])),e).devConsole(e),e}).finally(function(){g.clearUploadPromise(h)}).catch(o("WAFilteredCatch").filteredCatch(o("WAWebMiscErrors").FileNotReadableError,function(){return g.consolidate({uploadStage:o("WAWebMediaTypes").UploadStage.ERROR_FILE_NOT_READABLE}),{kind:f.ERROR}})).catch(o("WAFilteredCatch").filteredCatch(o("WAWebDownloadManagerErrors").MediaNotOnPhone,function(){return g.consolidate({uploadStage:o("WAWebMediaTypes").UploadStage.ERROR_MISSING}),{kind:f.ERROR}})).catch(o("WAFilteredCatch").filteredCatch(o("WAWebMmsClientErrors").MediaTooLargeError,function(){return g.consolidate({uploadStage:o("WAWebMediaTypes").UploadStage.ERROR_TOO_LARGE}),{kind:f.ERROR}})).catch(function(e){return g.consolidate({uploadStage:o("WAWebMediaTypes").UploadStage.NEED_UPLOAD}),e.name===o("WAAbortError").ABORT_ERROR?{kind:f.CANCELLATION}:{kind:f.ERROR}});return p.set(D,function(){I.abort()}),g.setUploadPromise(D,h),D}function R(e){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.mediaObject,n=e.mimetype,a=e.mediaType,i=e.abortSignal,l=e.uploadOrigin,s=e.chatWid,u=E(t);if(u)return u;if(yield o("WAWebMediaMmsV4Download").downloadMedia({mimetype:n,mediaObject:t,downloadEvenIfExpensive:!0,mediaType:a,signal:i,rmrReason:o("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.UPLOAD,downloadOrigin:o("WAWebMediaGetDownloadOriginFromUploadOrigin").getDownloadOriginFromUploadOrigin(l),mode:"manual",chatWid:s}),t.downloadStage===o("WAWebMediaTypes").DownloadStage.ERROR_MISSING)throw new(o("WAWebDownloadManagerErrors")).MediaNotOnPhone;var c=E(t);if(c)return c;throw r("err")("cant upload media w/out mediaBlob after download")}),L.apply(this,arguments)}function E(e){var t=e.mediaBlob;if(t)return t.formData();if(e.filehash)return o("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.get(e.filehash)}l.cancelUploadMedia=_,l.UploadMediaResultKind=f,l.uploadMedia=b,l.uploadUnencryptedMedia=v,l.getOrDownloadBlob=R,l.getBlobFromMediaObject=E}),98);
__d("WAWebMediaObject",["Promise","WALogger","WANullthrows","WAShiftTimer","WAWebAck","WAWebCryptoCreateMediaKeys","WAWebInteractiveMessageHeaderMediaType","WAWebMedia","WAWebMediaCryptoEligibilityUtils","WAWebMediaDataUtils","WAWebMediaEntry","WAWebMediaOpaqueData","WAWebMediaTypes","WAWebMmsMediaTypes","WAWebMsgType","WAWebRequestMediaReuploadBridge","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h=(function(){function t(){var e=this;this.msgs=[],this.$1=new(o("WAShiftTimer")).ShiftTimer(function(){S(e),$(e)}),this.callOnConsolidate=null,this.$2=null,this.$3=0,this.saveMedia=null,this.stickers=[],this.stickerPacks=[],this.entries=new(o("WAWebMediaEntry")).MediaEntryList,this.downloadStage=o("WAWebMediaTypes").DownloadStage.INIT,this.uploadStage=o("WAWebMediaTypes").UploadStage.INIT,this.userUploadAttemptCount=0,this.userDownloadAttemptCount=0,this.$4=null,this.$5=null,this.$6=null,this.$7=null,this.mediaBlob=null,this.size=void 0,this.loadedSize=void 0,this.filehash=void 0,this.contentInfo={},this.progressiveStage=void 0,this.parsedVcards=null,this.extractedLottieSticker=null}var a=t.prototype;return a.encryptedDownloadPromise_TESTONLY=function(){return this.$4},a.unencryptedDownloadPromise_TESTONLY=function(){return this.$5},a.consolidate=function(n){if(n.downloadStage){var t;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[","] mediaObject.downloadStage: ",""])),(t=this.filehash)==null?void 0:t.slice(0,10),String(n.downloadStage))}return y(this,n)?(this.notifyMsgsAsync(),!0):!1},a.clearBlob=function(t){var e=this.mediaBlob;e&&(this.mediaBlob=null,e.autorelease()),(t==null?void 0:t.reset)===!0&&this.$8()},a.$8=function(){this.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.INIT})},a.contentFields=function(){var e=this.type||o("WAWebMediaTypes").TYPE.DOCUMENT;return o("WAWebMediaTypes").FIELDS[e]},a.resolveWhenConsolidated=function(){var e=this;return this.$1.ts?new(g||(g=n("Promise")))(function(t){e.callOnConsolidate?e.callOnConsolidate.push(t):e.callOnConsolidate=[t]}):(g||(g=n("Promise"))).resolve()},a.notifyMsgsAsync=function(){this.$1.debounce(0)},a.addMsg=function(t){for(var e=this.msgs,n=0;n<e.length;n++){var r=e[n],a=r[0],i=r[1];a===t&&!i&&o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("redundant-media-msg")}e.push([t,!1]),this.notifyMsgsAsync()},a.removeMsg=function(t){for(var e=this.msgs,n=!1,r=0;!n&&r<e.length;r++){var o=e[r],a=o[0],i=o[1];a===t&&!i&&(e[r][1]=!0,n=!0)}},a.hasAssociatedMsgsOrStickers=function(){for(var e=this.msgs,t=0;t<e.length;t++)if(!e[t][1])return!0;return this.hasAssociatedStickers()||this.hasAssociatedStickerPacks()},a.associatedMsgs=function(){for(var e=this.msgs,t=[],n=0;n<e.length;n++){var r=e[n],o=r[0],a=r[1];a||t.push(o)}return t},a.rmr=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this.associatedStickers();if(t.length>0){var a=this.associatedMsgs().filter(function(e){return e!=null});if(a.length===0)return o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["The sticker associated message has been deleted."]))),(g||(g=n("Promise"))).resolve(200)}var i=this.msgs.find(function(e){var t=e[0],n=e[1];return!n&&!t.isUnsentPhoneMsg()})||[null],l=i[0];if(!l)return o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: rmr called on MediaObject with no msg"),(g||(g=n("Promise"))).reject(r("err")("rmr called on MediaObject with no msg"));e.onMsgSelect(l);var s=yield r("WAWebRequestMediaReuploadBridge")(l);if(s.status===200){var m=l.mediaData.type;if(m==="unknown")return(g||(g=n("Promise"))).reject(r("err")("rmr called on MediaData with unknown type"));var p=s.isMD?this.entries.updateEntry({deprecatedMms3Url:l.deprecatedMms3Url,encFilehash:l.encFilehash,directPath:s.directPath}):this.entries.addEntry({deprecatedMms3Url:s.url,mediaKey:s.mediaKey||r("WANullthrows")(l.mediaKey),mediaKeyTimestamp:s.mediaKeyTimestamp,encFilehash:s.encFilehash,type:m,directPath:s.directPath,debugHint:"rmr"});p||o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: rmr entry can not be found"),p==null||p.markWhetherOnServer(!0)}return s.status});function t(t){return e.apply(this,arguments)}return t})(),a.msgProps=function(t){var e={};R(e,this,o("WAWebMediaTypes").FIELDS.RAW),R(e,this.contentInfo,this.contentFields()),R(e,t,o("WAWebMediaTypes").MSG_SPECIFIC_FIELDS),e.preview=this.contentInfo._preview;var n={};for(var r in e){var a=o("WAWebMediaTypes").MEDIA_TO_MSG[r];a&&(n[a]=e[r])}return n},a.delete=function(){this.saveMedia=null,o("WAWebMedia").cancelDownloadMedia(this),o("WAWebMedia").cancelUploadMedia(this),this.clearBlob()},a.runProcessIfNotRunBefore=function(t,r,o){var e=this,a=this.$2;a||(a=this.$2={}),!Object.prototype.hasOwnProperty.call(a,t)&&(this.$3++,a[t]=(g||(g=n("Promise"))).resolve(o).then(r).then(function(t){return void e.consolidate(t)}).finally(function(){e.$3--,e.$3===0&&e.notifyMsgsAsync()}))},a.getPendingProcess=function(t){return this.$3===0||!this.$2||!Object.prototype.hasOwnProperty.call(this.$2,t)?(g||(g=n("Promise"))).resolve():this.$2[t]},a.videoStreamingInfo=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(this.type!==o("WAWebMediaTypes").TYPE.VIDEO){o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["type: ",""])),String(this.type)).sendLogs("media-fault: media streaming info request for non-video type");return}var t=this.entries.getDownloadEntry(!0);if(!t||!t.sidecar||!(t instanceof o("WAWebMediaEntry").EncryptedMediaEntry))return null;var a=yield(g||(g=n("Promise"))).all([r("WAWebCryptoCreateMediaKeys")(o("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO,t.mediaKey),t.url()]),i=a[0],l=a[1];return{cryptoKeys:babelHelpers.extends({},i,{cipherKey:i.encKey,sidecar:t.sidecar}),streamData:{clientUrl:l,size:this.size,msgKey:e}}});function t(t){return e.apply(this,arguments)}return t})(),a.addStickerPack=function(t){for(var e=this.stickerPacks,n=0;n<e.length;n++){var r=e[n],a=r[0],i=r[1];a===t&&!i&&o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("redundant-sticker-pack-add")}e.push([t,!1]),this.notifyMsgsAsync()},a.addSticker=function(t){for(var e=this.stickers,n=0;n<e.length;n++){var r=e[n],a=r[0],i=r[1];a===t&&!i&&o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("redundant-sticker-add")}e.push([t,!1]),this.notifyMsgsAsync()},a.removeSticker=function(t){for(var e=this.stickers,n=!1,r=0;!n&&r<e.length;r++){var o=e[r],a=o[0],i=o[1];a===t&&!i&&(e[r][1]=!0,n=!0)}},a.removeStickerPack=function(t){for(var e=this.stickerPacks,n=!1,r=0;!n&&r<e.length;r++){var o=e[r],a=o[0],i=o[1];a===t&&!i&&(e[r][1]=!0,n=!0)}},a.hasAssociatedStickers=function(){return this.stickers.some(function(e){var t=e[0],n=e[1];return!n})},a.hasAssociatedStickerPacks=function(){return this.stickerPacks.some(function(e){var t=e[0],n=e[1];return!n})},a.associatedStickers=function(){return this.stickers.reduce(function(e,t){var n=t[0],r=t[1];return r?e:e.concat(n)},[])},a.getUploadPromise=function(t){return o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(t)?this.$6:this.$7},a.setUploadPromise=function(t,n){o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(n)?this.$6=t:this.$7=t},a.clearUploadPromise=function(t){o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(t)?this.$6=null:this.$7=null},a.getUploadPromises=function(){return[this.$6,this.$7]},a.getDownloadPromise=function(t){return o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(t)?this.$4:this.$5},a.setDownloadPromise=function(t,n){o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(n)?this.$4=t:this.$5=t},a.clearDownloadPromise=function(t){o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(t)?this.$4=null:this.$5=null},a.getDownloadPromises=function(){return[this.$4,this.$5]},a.toJSON=function(){return{mediaBlob:this.mediaBlob,size:this.size,filehash:this.filehash,type:this.type,contentInfo:this.contentInfo,downloadStage:this.downloadStage,uploadStage:this.uploadStage}},t})();function y(e,t){var n=e.contentInfo,r=!1,o=C(t.type);o&&!e.type&&(e.type=o,r=!0);var a=t.downloadStage,i=t.uploadStage;a&&a!==e.downloadStage&&(e.downloadStage=a,r=!0),i&&i!==e.uploadStage&&(e.uploadStage=i,r=!0),t.resolvedPreview&&!n.preview&&(t.resolvedPreview.retain(),n.preview=t.resolvedPreview,r=!0),t.progressiveStage!==void 0&&t.progressiveStage!==e.progressiveStage&&(e.progressiveStage=t.progressiveStage,r=!0);var l=t.mediaBlob;l&&!l.isBlobEqual(e.mediaBlob)&&(e.mediaBlob&&e.clearBlob(),l.retain(),e.mediaBlob=l,e.size=l.size(),r=!0),t.size!=null&&t.size!==0&&(e.size==null||t.size<e.size)&&(e.size=t.size,r=!0);var s=t.loadedSize;s!=null&&s!==e.loadedSize&&(e.loadedSize=s,r=!0),t.filehash&&!e.filehash&&(e.filehash=t.filehash,r=!0),t.parsedVcards&&t.parsedVcards!==e.parsedVcards&&(e.parsedVcards=t.parsedVcards,r=!0),t.extractedLottieSticker!=null&&t.extractedLottieSticker!==e.extractedLottieSticker&&(e.extractedLottieSticker=t.extractedLottieSticker,r=!0);for(var u=e.contentFields(),c=0;c<u.length;c++){var d=u[c];switch(d){case"preview":t.preview&&!n._preview&&(e.runProcessIfNotRunBefore("preview",I,t.preview),n._preview=t.preview,r=!0);break;case"fullWidth":case"fullHeight":case"aspectRatio":{var m=t[d];m!=null&&m!==0&&n[d]!==m&&(n[d]=m,r=!0);break}case"animationDuration":case"singleLoopDuration":{var p=t[d];p!=null&&p!==n[d]&&(n[d]=p,r=!0);break}default:{var _=t[d];_!==void 0&&n[d]===void 0&&(n[d]=_,r=!0)}}}return(n.aspectRatio==null||n.aspectRatio===0)&&(n.fullWidth!=null&&n.fullWidth!==0&&n.fullHeight!=null&&n.fullHeight!==0?(n.aspectRatio=n.fullWidth/n.fullHeight,r=!0):n.preview&&e.runProcessIfNotRunBefore("aspectRatio",D,n.preview)),r}function C(e){switch(e){case o("WAWebMediaTypes").OUTWARD_TYPES.IMAGE:case o("WAWebMediaTypes").OUTWARD_TYPES.PRODUCT:return o("WAWebMediaTypes").TYPE.IMAGE;case o("WAWebMediaTypes").OUTWARD_TYPES.VIDEO:return o("WAWebMediaTypes").TYPE.VIDEO;case o("WAWebMediaTypes").OUTWARD_TYPES.PTV:return o("WAWebMediaTypes").TYPE.PTV;case o("WAWebMediaTypes").OUTWARD_TYPES.STICKER:return o("WAWebMediaTypes").TYPE.STICKER;case o("WAWebMediaTypes").OUTWARD_TYPES.AUDIO:case o("WAWebMediaTypes").OUTWARD_TYPES.PTT:return o("WAWebMediaTypes").TYPE.AUDIO;case o("WAWebMediaTypes").OUTWARD_TYPES.DOCUMENT:default:return}}function b(e){switch(e){case"VIDEO":case"PTV":return 3;case"IMAGE":return 2;case"AUDIO":return 4;case"STICKER":return 16;case"DOCUMENT":return 8;case"PRODUCT":return 18;case"BIZ_COVER_PHOTO":throw r("err")("web media type is invalid: "+e);default:throw r("err")("web media type is invalid: "+e)}}function v(e){var t;if(((t=e.interactiveHeader)==null?void 0:t.mediaType)!=null)switch(e.interactiveHeader.mediaType){case o("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.DOCUMENT:return o("WAWebMediaTypes").OUTWARD_TYPES.DOCUMENT;case o("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.VIDEO:return o("WAWebMediaTypes").OUTWARD_TYPES.VIDEO;case o("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.IMAGE:return o("WAWebMediaTypes").OUTWARD_TYPES.IMAGE;case o("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.PRODUCT:return o("WAWebMediaTypes").OUTWARD_TYPES.PRODUCT}}function S(e){var t={};R(t,e,o("WAWebMediaTypes").FIELDS.RAW),R(t,e.contentInfo,e.contentFields()),e.mediaBlob&&(t.renderableUrl=e.mediaBlob.url());for(var n=e.msgs,r=n.length,a=0;a<r;a++){var i=n[a],l=i[0],s=i[1];if(l!=null&&!s){if(l.type!==o("WAWebMsgType").MSG_TYPE.CIPHERTEXT){t.mediaStage=L(l,e);for(var u=0;u<o("WAWebMediaTypes").MSG_SPECIFIC_FIELDS.length;u++){var c=o("WAWebMediaTypes").MSG_SPECIFIC_FIELDS[u];c==="accessibilityLabel"&&t.accessibilityLabel!=null&&l.type===o("WAWebMsgType").MSG_TYPE.STICKER&&l.set("accessibilityLabel",t.accessibilityLabel),t[c]=l.get(o("WAWebMediaTypes").MEDIA_TO_MSG[c])}t.type===o("WAWebMsgType").MSG_TYPE.INTERACTIVE&&(t.type=v(l))}else{delete t.mediaStage;for(var d=0;d<o("WAWebMediaTypes").MSG_SPECIFIC_FIELDS.length;d++)delete t[o("WAWebMediaTypes").MSG_SPECIFIC_FIELDS[d]]}l.mediaData.set(t)}}for(var m=n.length-1;m>=0;m--)n[m][1]&&n.splice(m,1);var p=e.callOnConsolidate;p&&(e.callOnConsolidate=null,p.forEach(function(e){return void e()})),e.saveMedia&&e.saveMedia(e)}function R(e,t,n){for(var r=0;r<n.length;r++){var o=n[r];e[o]=t[o]}}function L(e,t){if(t.filehash){if(e.id.fromMe&&e.ack<o("WAWebAck").ACK.SENT)return e.local||o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: unsent media system message not local"),k(t)}else return o("WAWebMediaTypes").MediaDataStage.PREPARING;return E(t)}function E(e){switch(e.downloadStage){case o("WAWebMediaTypes").DownloadStage.INIT:return o("WAWebMediaTypes").MediaDataStage.INIT;case o("WAWebMediaTypes").DownloadStage.EXISTS:return o("WAWebMediaTypes").MediaDataStage.EXISTS;case o("WAWebMediaTypes").DownloadStage.PREPARING:return o("WAWebMediaTypes").MediaDataStage.PREPARING;case o("WAWebMediaTypes").DownloadStage.REUPLOADING:return o("WAWebMediaTypes").MediaDataStage.REUPLOADING;case o("WAWebMediaTypes").DownloadStage.FETCHING:return o("WAWebMediaTypes").MediaDataStage.FETCHING;case o("WAWebMediaTypes").DownloadStage.PROCESSING:return o("WAWebMediaTypes").MediaDataStage.DECRYPTING;case o("WAWebMediaTypes").DownloadStage.NEED_POKE:return o("WAWebMediaTypes").MediaDataStage.NEED_POKE;case o("WAWebMediaTypes").DownloadStage.ERROR_MISSING:return o("WAWebMediaTypes").MediaDataStage.ERROR_MISSING;case o("WAWebMediaTypes").DownloadStage.ERROR_UNSUPPORTED:return o("WAWebMediaTypes").MediaDataStage.ERROR_UNSUPPORTED;case o("WAWebMediaTypes").DownloadStage.RESOLVED:return o("WAWebMediaTypes").MediaDataStage.RESOLVED;case o("WAWebMediaTypes").DownloadStage.PROGRESSIVE_READY:return o("WAWebMediaTypes").MediaDataStage.PROGRESSIVE_READY}}function k(e){switch(e.uploadStage){case o("WAWebMediaTypes").UploadStage.INIT:return o("WAWebMediaTypes").MediaDataStage.PREPARING;case o("WAWebMediaTypes").UploadStage.PREPARING:return o("WAWebMediaTypes").MediaDataStage.PREPARING;case o("WAWebMediaTypes").UploadStage.UPLOADING:return o("WAWebMediaTypes").MediaDataStage.UPLOADING;case o("WAWebMediaTypes").UploadStage.NEED_UPLOAD:return o("WAWebMediaTypes").MediaDataStage.NEED_UPLOAD;case o("WAWebMediaTypes").UploadStage.ERROR_MISSING:return o("WAWebMediaTypes").MediaDataStage.ERROR_MISSING;case o("WAWebMediaTypes").UploadStage.ERROR_TOO_LARGE:return o("WAWebMediaTypes").MediaDataStage.ERROR_TOO_LARGE;case o("WAWebMediaTypes").UploadStage.UPLOADED:return o("WAWebMediaTypes").MediaDataStage.SENDING;case o("WAWebMediaTypes").UploadStage.ERROR_FILE_NOT_READABLE:return o("WAWebMediaTypes").MediaDataStage.ERROR_FILE_NOT_READABLE;case o("WAWebMediaTypes").UploadStage.FINALIZING:return o("WAWebMediaTypes").MediaDataStage.FINALIZING}}function I(e){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield r("WAWebMediaOpaqueData").createFromBase64Jpeg(e);return t.autorelease(),{resolvedPreview:t}}),T.apply(this,arguments)}function D(e){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebMediaDataUtils").getImageWidthHeight(e),n=t.width,r=t.height;return{aspectRatio:n/r}}),x.apply(this,arguments)}function $(e){var t={};R(t,e,o("WAWebMediaTypes").FIELDS.RAW),R(t,e.contentInfo,e.contentFields()),e.mediaBlob&&(t.renderableUrl=e.mediaBlob.url());var n=E(e);e.stickers=e.stickers.filter(function(e){var t=e[0],n=e[1];return!n}),e.stickers.forEach(function(e){var r=e[0],o=e[1];r.mediaData.set(babelHelpers.extends({},t,{mediaStage:n}))}),e.stickerPacks=e.stickerPacks.filter(function(e){var t=e[0],n=e[1];return!n}),e.stickerPacks.forEach(function(e){var r=e[0],o=e[1];r.mediaData.set(babelHelpers.extends({},t,{mediaStage:n}))}),e.callOnConsolidate&&(e.callOnConsolidate.forEach(function(e){return void e()}),e.callOnConsolidate=null),e.saveMedia&&e.saveMedia(e)}l.MediaObject=h,l.consolidate=y,l.webMediaTypeToWamMediaType=b,l.getInteractiveMsgMediaType=v}),98);
__d("WAWebEncodeRgbaToWebp",["Promise","WAWebMiscErrors","WAWebRgbaToWebpWorkerResource","WorkerBundleResource"],(function(t,n,r,o,a,i,l){var e;function s(t,a,i,l){var s=l!=null?l:{},u=s.quality,c=u===void 0?90:u,d=s.ensureExtendedFormat,m=d===void 0?!1:d;return new(e||(e=n("Promise")))(function(e,n){var l=o("WorkerBundleResource").createDedicatedWebWorker(r("WAWebRgbaToWebpWorkerResource"));l.onerror=function(e){l.terminate(),n(new(o("WAWebMiscErrors")).EncodeWebpError("worker error",e))},l.onmessageerror=function(e){l.terminate(),n(new(o("WAWebMiscErrors")).EncodeWebpError("worker message error",e))},l.onmessage=function(t){l.terminate(),e(t.data.blob)},l.postMessage({type:"message",message:{rgbaData:t,width:a,height:i,quality:c,ensureExtendedFormat:m}})})}l.default=s}),98);
__d("WAWebImageGeometry",[],(function(t,n,r,o,a,i){function e(e,t){return typeof e!="number"||e<0||e!==e?{width:t,height:t}:e>1?{width:t,height:Math.max(t/e,1)}:{width:Math.max(t*e,1),height:t}}function l(e,t,n){var r=t!=null?t:n,o=e!=null?e:n;return r>o?r>n&&(o*=n/r,r=n):o>n&&(r*=n/o,o=n),{width:Math.max(r,1),height:Math.max(o,1)}}i.aspectRatioScaled=e,i.boundHeightWidth=l}),66);
__d("WAWebCanvasUtils",["Promise","WAWebABProps","WAWebDataUrlToBlob","WAWebEncodeRgbaToWebp","WAWebImageGeometry","WAWebMediaOpaqueData","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){var t=e.getContext("2d"),n=t.getImageData(0,0,e.width,e.height);return r("WAWebEncodeRgbaToWebp")(n.data,e.width,e.height,{ensureExtendedFormat:!0})}function u(t,r){if(r===void 0&&(r="image/jpeg"),Object.prototype.hasOwnProperty.call(HTMLCanvasElement.prototype,"toBlob")){var a=r==="image/jpeg"?o("WAWebABProps").getABPropConfigValue("web_jpeg_quality")/100:void 0;return new(e||(e=n("Promise")))(function(e){t.toBlob(e,r,a)})}return(e||(e=n("Promise"))).resolve(o("WAWebDataUrlToBlob").dataURLtoBlob(t.toDataURL(r)))}function c(e,t,n){t===void 0&&(t="image/jpeg");var r=e.toDataURL(t),a=o("WAWebDataUrlToBlob").dataURLtoBlob(r);if(a.size<=n)return e.toDataURL(t);for(var i=.9;i>=.1;i-=.1){var l=e.toDataURL(t,i),s=o("WAWebDataUrlToBlob").dataURLtoBlob(l);if(s.size<=n)return l}return null}function d(e,t,n){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){for(var o,a,i=n||{},l=(o=i.mimetype)!=null?o:"image/jpeg",s=(a=i.maxAttempts)!=null?a:10,c=.5,d=e,m=yield u(d,l),p=0;p<s&&!(m.size<=t);p++){var _=Math.floor(e.width*c),f=Math.floor(e.height*c);d=C(_,f);var g=d.getContext("2d");g.drawImage(e,0,0,_,f),m=yield u(d,l),c*=.5}return{opaqueData:yield r("WAWebMediaOpaqueData").createFromData(m,l),width:d.width,height:d.height,dataUrl:d.toDataURL("image/jpeg")}}),m.apply(this,arguments)}function p(e,t){var n=t.x||0,r=t.y||0;t.degrees&&(t.radians=t.degrees*(Math.PI/180)),e.translate(n,r),t.radians!=null&&e.rotate(t.radians),e.translate(-n,-r)}function _(e,t,n){var r=e.getContext("2d"),o=r.getImageData(0,0,t,n);e.width=t,e.height=n,r.putImageData(o,0,0)}function f(e){var t=e.getContext("2d"),n=e.width,r=e.height,o=t.getImageData(0,0,n,r),a=Math.max(n,r);e.width=a,e.height=a;var i=(a-n)/2,l=(a-r)/2;t.clearRect(0,0,n,r),t.putImageData(o,i,l,0,0,n,r)}function g(e,t){var n=e.getContext("2d"),r=b(e),a=o("WAWebImageGeometry").aspectRatioScaled(e.width/e.height,t),i=a.width,l=a.height;e.width=i,e.height=l,n.drawImage(r,0,0,i,l)}function h(e){var t=e.getContext("2d");t.fillStyle="rgb(247,247,247)",t.fillRect(0,0,e.width,e.height)}function y(e,t){var n=o("WAWebImageGeometry").boundHeightWidth(e.height,e.width,t),r=n.width,a=n.height;if(r>e.width&&a>e.height)return e;var i=document.createElement("canvas"),l=i.getContext("2d");return i.width=r,i.height=a,l.drawImage(e,0,0,r,a),i}function C(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n}function b(e){var t=C(e.width,e.height),n=t.getContext("2d");return n.drawImage(e,0,0),t}function v(e){var t=e.getContext("2d"),n=t.getImageData(0,0,e.width,e.height),r=n.data.length/4,o;for(o=0;o<r;o++){var a=n.data[4*o+3];if(a!==0)return!1}return!0}function S(e){var t=e.getContext("2d"),n=t.getImageData(0,0,e.width,e.height),r=n.data.length/4,o=1/0,a=1/0,i=0,l=0,s;for(s=0;s<r;s++){var u=n.data[4*s+3];if(u!==0){var c=s%e.width,d=Math.floor(s/e.width);c<o&&(o=c),c>i&&(i=c),d<a&&(a=d),d>l&&(l=d)}}return{left:o,top:a,right:i,bottom:l}}function R(e){if(!v(e)){var t=S(e),n=t.left,r=t.top,o=t.right,a=t.bottom,i=a-r,l=o-n,s=e.getContext("2d"),u=s.getImageData(n,r,l,i),c=C(l,i),d=c.getContext("2d");return d.putImageData(u,0,0),c}}function L(e,t,n){n===void 0&&(n="white");var r=document.createElement("canvas"),o=r.getContext("2d"),a=document.createElement("canvas"),i=a.getContext("2d"),l=t*2;r.width=a.width=e.width+l*2,r.height=a.height=e.height+l*2,o.drawImage(e,l,l),i.shadowColor=n,i.shadowBlur=1;for(var s=0;s<l;s++)i.drawImage(r,0,0),o.drawImage(a,0,0);return i.shadowColor="rgba(0,0,0,0)",i.drawImage(e,l,l),a}l.canvasToWebp=s,l.canvasToBlob=u,l.getResizedDataUrl=c,l.generateMicroThumb=d,l.rotate=p,l.resize=_,l.square=f,l.scale=g,l.fillBackgroundWithGray=h,l.contain=y,l.createCanvas=C,l.trim=R,l.addBorder=L}),98);
__d("WAWebChatEphemerality",["WALogger","WAWebChatGetters","WAWebEphemeralityTypes","WAWebStateUtils","WAWebUserPrefsMultiDevice"],(function(t,n,r,o,a,i,l){var e;function s(t){var n,r=o("WAWebStateUtils").unproxy(t),a=o("WAWebChatGetters").getIsGroup(r)?(n=r.groupMetadata)==null?void 0:n.ephemeralDuration:r.ephemeralDuration;return a==null||a===0?null:a<0?(o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[ephemeral] invalid duration of "," for chat ",""])),a,r.id.toLogString()),null):a}function u(e){var t=o("WAWebStateUtils").unproxy(e);return o("WAWebChatGetters").getIsGroup(t)||t.ephemeralSettingTimestamp===0?null:t.ephemeralSettingTimestamp}function c(e){var t=o("WAWebStateUtils").unproxy(e),n=s(t);return n!=null&&n!==0}function d(e){var t=o("WAWebStateUtils").unproxy(e);if(o("WAWebUserPrefsMultiDevice").getIsHostedMeAccountFromLocalStorage()&&!o("WAWebChatGetters").getIsGroup(t)||o("WAWebChatGetters").getIsPSA(t)||t.id.isBot())return!1;if(o("WAWebChatGetters").getIsGroup(t)){var n,r,a=(n=t.groupMetadata)==null?void 0:n.participants.getSuperAdmin();if(a!=null&&a.contact.isEnterprise||!((r=t.groupMetadata)!=null&&r.canSetEphemeralSetting())&&!c(t))return!1}return!(o("WAWebChatGetters").getIsBroadcast(t)||t.contact.isEnterprise)}function m(e){var t=o("WAWebStateUtils").unproxy(e);return t.disappearingModeInitiator!=null?t.disappearingModeInitiator:c(t)?o("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat:null}function p(e){var t=o("WAWebStateUtils").unproxy(e);return o("WAWebChatGetters").getIsGroup(t)?f(t):t.disappearingModeTrigger!=null?t.disappearingModeTrigger:c(t)?o("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings:null}function _(e){var t=o("WAWebStateUtils").unproxy(e);return o("WAWebChatGetters").getIsGroup(t)?g(t):t.disappearingModeInitiatedByMe!=null?t.disappearingModeInitiatedByMe:null}function f(e){var t,n=o("WAWebStateUtils").unproxy(e),r=(t=n.groupMetadata)==null?void 0:t.disappearingModeTrigger;return r==null?null:r}function g(e){var t,n=o("WAWebStateUtils").unproxy(e),r=(t=n.groupMetadata)==null?void 0:t.disappearingModeInitiatedByMe;return r==null?null:r}function h(e){var t,n=o("WAWebStateUtils").unproxy(e);return n.ephemeralDuration==null&&n.ephemeralSettingTimestamp==null&&n.disappearingModeInitiator==null?null:{duration:(t=n.ephemeralDuration)!=null?t:0,settingTimestamp:n.ephemeralSettingTimestamp,initiator:n.disappearingModeInitiator,disappearingModeTrigger:n.disappearingModeTrigger,initiatedByMe:n.disappearingModeInitiatedByMe}}l.getEphemeralSetting=s,l.getEphemeralSettingTimestamp=u,l.isEphemeralSettingOn=c,l.shouldShowEphemeralSetting=d,l.getDisappearingModeInitiator=m,l.getDisappearingModeTrigger=p,l.getDisappearingModeInitiatedByMe=_,l.getDisappearingModeTriggerGroups=f,l.getDisappearingModeInitiatedByMeGroups=g,l.getChatEphemeralityFields=h}),98);
__d("WAWebMediaConstants",[],(function(t,n,r,o,a,i){"use strict";var e=100,l=480,s=480,u=500,c=.4,d=3e3,m=1300;i.IMG_THUMB_MAX_EDGE=e,i.DOC_THUMB_MAX_EDGE=l,i.VIDEO_THUMB_MAX_EDGE=s,i.MAX_PORTRAIT_MEDIA_CAPTION_LENGTH=u,i.MEDIA_EDITOR_OUTLINE_TENSION=c,i.MMS_THUMBNAIL_UPLOAD_TIMEOUT=d,i.MICRO_THUMBNAIL_MAX_FILE_SIZE_BYTES=m}),66);
__d("WAWebMediaGatingShouldClearUploadedBlobs",["WAWebMmsMediaTypes"],(function(t,n,r,o,a,i,l){function e(e){return e===o("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT}l.default=e}),98);
__d("WAWebMediaInMemoryKeyCache",["WALruCache"],(function(t,n,r,o,a,i,l){var e=10,s={sizeLimit:e,getSize:function(t){return 1}};function u(){return!0}var c=new(o("WALruCache")).LruCache(s);l.shouldUseMediaKeyCache=u,l.MediaKeyCache=c}),98);
__d("WAWebMediaUpdateMsg",["WAWebDBUpdateMessageTable","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){yield o("WAWebDBUpdateMessageTable").updateMessageTable(e.id,t),e.set(t)}),s.apply(this,arguments)}l.default=e}),98);
__d("WAWebSendMsgResultAction",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["OK","ERROR_NETWORK","ERROR_EXPIRED","ERROR_CANCELLED","ERROR_UPLOAD","ERROR_UNKNOWN","ERROR_RATE_LIMIT"]);i.SendMsgResult=e}),66);
__d("WAWebMediaPrep",["invariant","Promise","WALogger","WAMediaCalculateFilehash","WANullthrows","WAPromiseCallSync","WATimeUtils","WAWebABProps","WAWebAck","WAWebAttachMenuGatingUtils","WAWebCanvasUtils","WAWebChatEphemerality","WAWebChatGetters","WAWebCryptoCalculateFilehash","WAWebCryptoRandomMediaKey","WAWebFrontendChatGetters","WAWebImageUtils","WAWebMediaConstants","WAWebMediaCryptoEligibilityUtils","WAWebMediaData","WAWebMediaDataUtils","WAWebMediaEntry","WAWebMediaGatingShouldClearUploadedBlobs","WAWebMediaGatingUtils","WAWebMediaGetUploadOriginForChat","WAWebMediaInMemoryBlobCache","WAWebMediaInMemoryKeyCache","WAWebMediaMmsV4Download","WAWebMediaMmsV4Upload","WAWebMediaOpaqueData","WAWebMediaStorage","WAWebMediaTypes","WAWebMediaUpdateMsg","WAWebMediaUploadMmsThumbnail","WAWebMessagePluginGenerateReportingTokenContent","WAWebMessagingGatingUtils","WAWebMmsMediaTypes","WAWebMsgDataUtils","WAWebMsgGetters","WAWebMsgType","WAWebNewsletterGatingUtils","WAWebNewsletterSendMsgAction","WAWebRecentStickerCollectionMd","WAWebSchemaChat","WAWebSendMsgChatAction","WAWebSendMsgResultAction","WAWebSendStatusMsgAction","WAWebStateUtils","WAWebURLUtils","WAWebWamEnumDownloadOriginType","WAWebWamEnumMessageSendResultType","WAWebWamEnumUploadOriginType","WAWebWamEnumWebcRmrReasonCode","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l,s){var e,u,c,d,m,p,_,f,g,h,y,C,b,v=(function(){function t(t,n){var a=this;this.baseType=t,this.mediaData=new(r("WAWebMediaData"))({mediaStage:o("WAWebMediaTypes").MediaDataStage.PREPARING}),this.$1=n.then(function(t){if(a.mediaData.set(t),!t.filehash)return t.mediaBlob||o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: no hash or blob"),o("WAWebCryptoCalculateFilehash").calculateFilehashFromBlob(t.mediaBlob).then(function(e){a.mediaData.filehash=e})},function(e){throw a.mediaData.mediaStage=o("WAWebMediaTypes").MediaDataStage.ERROR_UNSUPPORTED,e})}var a=t.prototype;return a.sendToChat=function(t,n,r){return o("WAPromiseCallSync").promiseCallSync(M,null,this,t,n,r)},a.waitForPrep=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return yield this.$1,this.mediaData});function t(){return e.apply(this,arguments)}return t})(),t})();function S(e,t){if(t.type==="product")return o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.PRODUCT_CATALOG;var n=o("WAWebStateUtils").unproxy(e);return o("WAWebChatGetters").getIsGroup(n)?o("WAWebFrontendChatGetters").getIsCAG(n)?o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.COMMUNITY:o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHAT_GROUP:o("WAWebChatGetters").getIsNewsletter(n)?o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHANNEL:o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHAT_PERSONAL}function R(e){var t=o("WAWebMmsMediaTypes").getMsgMediaType(e);return o("WAWebABProps").getABPropConfigValue("upload_document_thumb_mms_enabled")&&t===o("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT}var L=[o("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO,o("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE];function E(e){var t=o("WAWebMmsMediaTypes").getMsgMediaType(e);return L.includes(t)}function k(e){return e.type===o("WAWebMsgType").MSG_TYPE.DOCUMENT?R(e):e.type===o("WAWebMsgType").MSG_TYPE.STICKER_PACK?!0:o("WAWebMsgGetters").getIsStatus(e)?E(e):!1}function I(e){switch(e.type){case o("WAWebMsgType").MSG_TYPE.DOCUMENT:return o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_DOCUMENT;case o("WAWebMsgType").MSG_TYPE.IMAGE:return o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_IMAGE;case o("WAWebMsgType").MSG_TYPE.VIDEO:return o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_VIDEO;case o("WAWebMsgType").MSG_TYPE.STICKER_PACK:return o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_STICKER_PACK;default:throw r("err")("_getMediaTypeForThumbnails: attempt to create thumbnail for unsupported media type")}}function T(e){var t=e.uploadThumbnailResult,n=e.mediaResultEntry,a=e.uploadEncryptedThumbnail,i=e.fullPreviewSize,l=e.mediaType,s=e.mediaObject,c=t==null?void 0:t.mediaEntry;if(a===!0){if(c&&t&&i)return{thumbnailDirectPath:c.directPath,thumbnailSha256:t.filehash,thumbnailEncSha256:c.encFilehash,thumbnailHeight:i.height,thumbnailWidth:i.width};var d={thumbnailResultEntry:c,uploadThumbnailResult:t,fullPreviewSize:i};throw o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["upload failed: thumbnail data incomplete\nDebug info:",""],["upload failed: thumbnail data incomplete\\nDebug info:",""])),JSON.stringify(d)).devConsole(d).sendLogs("mms-thumbnail-data-incomplete"),r("err")("upload failed: thumbnail data incomplete")}var m=s.contentInfo,p=m.fullHeight,_=m.fullWidth;if(n.getThumbnailDirectPath()!=null&&n.getThumbnailSha256()!=null&&_!=null&&p!=null&&o("WAWebMediaGatingUtils").isThumbnailGenerationOnServerEnabledForMediaType(l))return{thumbnailDirectPath:n.getThumbnailDirectPath(),thumbnailSha256:n.getThumbnailSha256(),thumbnailHeight:p,thumbnailWidth:_}}function D(e){var t;return(t=e.wamMessageSendReporter)==null||t.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UPLOAD,isTerminal:!0}),o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UPLOAD}var x=function(t,n,r,a){return r.chatWid=n.id,r.downloadOrigin=S(n,a),r.isNewsletterMsg=o("WAWebChatGetters").getIsNewsletter(n),$(t,r)};function $(e,t){return e.waitForPrep().then(function(e){var t=e.mediaBlob;return t&&!(t instanceof r("WAWebMediaOpaqueData"))?r("WAWebMediaOpaqueData").createFromData(t,t.type).then(function(t){return e.mediaBlob=t,e}):e}).then(function(e){var n,a=e.filehash;a||o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: sendToChat filehash undefined");var i=o("WAWebMediaStorage").getOrCreateMediaObject(a),l=i.mediaBlob;l&&(l.retain(),e.mediaBlob instanceof r("WAWebMediaOpaqueData")&&e.mediaBlob.autorelease(),e.mediaBlob=l),e.mediaBlob instanceof r("WAWebMediaOpaqueData")&&(e.renderableUrl=e.mediaBlob.url()),i.consolidate(e.toJSON()),e.mediaBlob instanceof r("WAWebMediaOpaqueData")&&e.mediaBlob.autorelease();var s=o("WAWebMediaDataUtils").shouldUseMediaCache(o("WAWebMmsMediaTypes").castToV4(i.type));if(s&&e.mediaBlob instanceof r("WAWebMediaOpaqueData")){var u=e.mediaBlob.formData();o("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.put(a,u)}o("WAWebMediaMmsV4Download").downloadMedia({mimetype:e.mimetype,mediaObject:i,downloadEvenIfExpensive:!0,mediaType:o("WAWebMmsMediaTypes").msgToMediaType({type:e.type,isGif:e.isGif,isNewsletter:t.isNewsletterMsg===!0}),rmrReason:o("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.SEND_TO_CHAT,downloadOrigin:(n=t.downloadOrigin)!=null?n:o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHAT_PERSONAL,mode:"manual",chatWid:t.chatWid});var d=babelHelpers.extends({},i.msgProps(e));return d.caption=t.caption,t.isViewOnce===!0&&(d.isViewOnce=!0),d})}function P(e,t){return N.apply(this,arguments)}function N(){return N=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var a,i,l,u,c,m=e.mediaObject;m||o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: incorrect media object for created msg"),m||s(0,56330);var p=o("WAWebMmsMediaTypes").getMsgMediaType(e),_,f=(a=t.canEnableFastForward)!=null?a:!0;f===!0&&(_=m.entries.getUploadEntry(t.isMediaCryptoExpectedForChat===!0));var g=_ instanceof o("WAWebMediaEntry").EncryptedMediaEntry?{key:_.mediaKey,timestamp:_.mediaKeyTimestamp}:r("WAWebCryptoRandomMediaKey")(),h=m.contentInfo,y=h.fullPreviewData,C=h.fullPreviewSize,v=e.safe(),S=k(v),R=!y&&S,L=!C&&S,E=S,D=e.body;if((R||L||E)&&m.contentInfo.preview){var x=yield o("WAWebImageUtils").base64ImageToCanvas(m.contentInfo.preview.url()),$=R?o("WAWebABProps").getABPropConfigValue("web_pdf_thumbnail_size_in_bytes"):o("WAWebMediaConstants").MICRO_THUMBNAIL_MAX_FILE_SIZE_BYTES,P=yield o("WAWebCanvasUtils").generateMicroThumb(x,$,{mimetype:"image/jpeg",maxAttempts:10});y=m.contentInfo.preview,C={width:P.width,height:P.height},D=r("WAWebURLUtils").parseDataURL(P.dataUrl).data}var N=y&&C&&S,M=y&&N===!0?r("WAWebMediaUploadMmsThumbnail")({thumbnail:y,mediaKeyInfo:g,mediaType:r("WANullthrows")(I(v)),uploadOrigin:(i=t.uploadOriginForChat)!=null?i:o("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.UNKNOWN,forwardedFromWeb:!!e.forwardedFromWeb,isViewOnce:!!e.isViewOnce}):(b||(b=n("Promise"))).resolve(null),w={mimetype:e.mimetype,canEnableFastForward:t.canEnableFastForward,mediaObject:m,mediaType:p,forwardedFromWeb:!!e.forwardedFromWeb,uploadOrigin:(l=t.uploadOriginForChat)!=null?l:o("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.UNKNOWN,isViewOnce:!!e.isViewOnce,earlyUpload:t.earlyUpload},A=t.isMediaCryptoExpectedForChat===!0?o("WAWebMediaMmsV4Upload").uploadMedia(babelHelpers.extends({},w,{mediaKeyInfo:g})):o("WAWebMediaMmsV4Upload").uploadUnencryptedMedia(babelHelpers.extends({},w,{calculateToken:o("WAMediaCalculateFilehash").getRandomFilehash})),F=m.filehash;o("WAWebMediaInMemoryKeyCache").shouldUseMediaKeyCache()&&F!=null&&o("WAWebMediaInMemoryKeyCache").MediaKeyCache.put(F,g);var O=yield(b||(b=n("Promise"))).all([A,M]),B=O[0],W=O[1];r("WAWebMediaGatingShouldClearUploadedBlobs")(p)&&m.clearBlob({reset:!0});var q=B.mediaEntry;if(!q)return{mediaResult:B,mmsThumbnailData:null,body:D,fbid:null};o("WAWebMediaInMemoryKeyCache").shouldUseMediaKeyCache()&&F!=null&&o("WAWebMediaInMemoryKeyCache").MediaKeyCache.delete(F);var U=(u=T({uploadThumbnailResult:W,mediaResultEntry:q,uploadEncryptedThumbnail:N,mediaObject:m,fullPreviewSize:C,mediaType:p}))!=null?u:{},V=q instanceof o("WAWebMediaEntry").UnencryptedMediaEntry&&(c=q.fbid)!=null?c:null;return{mediaResult:B,mmsThumbnailData:U,body:D,fbid:V}}),N.apply(this,arguments)}function M(e,t,n,r){return w.apply(this,arguments)}function w(){return w=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,i){var l,s;o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Media:sendToChat chat ",""])),t.id.toLogString());try{if(!t.id.isStatus()){var u=yield o("WAWebSchemaChat").getChatTable().get(t.id.toString());if(u==null){var c;o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["sendMediaMsgToChat: chat "," not found in DB. model account lid: ",""])),t.id.toLogString(),(c=t.accountLid)==null?void 0:c.toLogString()).sendLogs("send-media-chat-not-found").tags("missing-lid")}else o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["sendMediaMsgToChat: chat "," found in DB. has account lid: ",""])),t.id.toLogString(),u.accountLid!=null)}}catch(e){o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["sendMediaMsgToChat: failed to check if chat exists"])))}var d=a.caption,v=a.footer,S=a.quotedMsg?a.quotedMsg.msgContextInfo(t.id):{},R=(l=a.productMsgOptions)!=null?l:{},L=o("WAWebChatEphemerality").isEphemeralSettingOn(t)?o("WAWebChatEphemerality").getEphemeralSetting(t):void 0,E=o("WAWebChatEphemerality").getEphemeralSettingTimestamp(t),k=o("WAWebChatEphemerality").getDisappearingModeInitiator(t),I,T=!1;t.isCAGAdmin()&&(T=!0);var $=(s=a.type)!=null?s:e.baseType;o("WAWebMessagingGatingUtils").isReportingTokenSendingEnabled()&&o("WAWebMessagePluginGenerateReportingTokenContent").isMsgTypeReportingTokenCompatible($)&&(T=!0),T&&(I=self.crypto.getRandomValues(new Uint8Array(32)));var N=babelHelpers.extends({},yield o("WAWebMsgDataUtils").genOutgoingMsgData(t,$),{type:$,caption:d,footer:v,quotedMsg:S.quotedMsg,quotedParticipant:S.quotedParticipant,quotedStanzaID:S.quotedStanzaID,quotedRemoteJid:S.quotedRemoteJid,mentionedJidList:a.mentionedJidList,groupMentions:a.groupMentions,isForwarded:a.isForwarded,forwardingScore:a.forwardingScore,forwardedNewsletterMessageInfo:a.forwardedNewsletterMessageInfo,multicast:a.multicast,forwardedFromWeb:a.forwardedFromWeb,ctwaContext:a.ctwaContext,ephemeralDuration:L,ephemeralSettingTimestamp:E,disappearingModeInitiator:k,messageSecret:I,isAvatar:a.isAvatar,viewMode:a.viewMode,parentMsgKey:a.parentMsgKey,associationType:a.associationType,isQuestion:a.isQuestion,questionReplyQuotedMessage:a.questionReplyQuotedMessage},R);if(a.type===o("WAWebMsgType").MSG_TYPE.STICKER_PACK){var M;N.description=a.description,N.isCaptionByUser=!!a.caption,N.thumbnailSha256=a.thumbnailSha256,N.stickers=a.stickers,N.stickerPackPublisher=a.publisher,N.size=(M=a.fileLength)!=null?M:0,N.stickerPackId=a.stickerPackId,N.thumbnailDirectPath=a.thumbnailDirectPath,N.thumbnailEncSha256=a.thumbnailEncSha256,N.trayIconFileName=a.trayIconFileName,N.stickerPackSize=a.stickerPackSize}a.type===o("WAWebMsgType").MSG_TYPE.DOCUMENT&&a.caption&&(N.isCaptionByUser=!0),a.isWamoSub===!0&&(N.isWamoSub=!0);var w,A;function F(e){return O.apply(this,arguments)}function O(){return O=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){w=e;var n=e.mediaObject;a.earlyUpload=i,a.isMediaCryptoExpectedForChat=o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForChat(t),a.uploadOriginForChat=r("WAWebMediaGetUploadOriginForChat")(t);var l=yield P(e,a),s=l.mediaResult,u=s.kind,c=s.mediaEntry,d=l.body,m=l.mmsThumbnailData;if(A=u,!c)throw r("err")("upload failed: media entry was not created");return yield r("WAWebMediaUpdateMsg")(w,babelHelpers.extends({deprecatedMms3Url:c.deprecatedMms3Url,directPath:c.directPath,mediaKey:c.getMediaKey(),mediaKeyTimestamp:c.getMediaKeyTimestamp(),filehash:r("WANullthrows")(n).filehash,encFilehash:c.getEncfilehash(),size:r("WANullthrows")(n).size,streamingSidecar:c.sidecar,firstFrameSidecar:c.firstFrameSidecar,body:d,stickerSentTs:o("WATimeUtils").unixTimeMs(),mediaHandle:c instanceof o("WAWebMediaEntry").UnencryptedMediaEntry?c.handle:null,metadataUrl:c instanceof o("WAWebMediaEntry").UnencryptedMediaEntry&&c.metadataUrl!=null&&o("WAWebMediaGatingUtils").isChannelVideoServerTranscodeUploadEnabled()?c.metadataUrl:null},m)),w}),O.apply(this,arguments)}var B;if(a.addEvenWhilePreparing===!0){var W=a.placeholderProps||{},q=babelHelpers.extends({},W,N),U=function(o){return w=o,x(e,t,a,N).then(function(e){return r("WAWebMediaUpdateMsg")(w,e)}).then(function(){return F(w)})};o("WAWebNewsletterGatingUtils").isNewsletterEnabled()&&o("WAWebChatGetters").getIsNewsletter(t)?B=o("WAWebNewsletterSendMsgAction").sendNewsletterMediaMsg(t,q,U):t.id.isStatus()?(B=o("WAWebSendStatusMsgAction").sendStatusMediaMsgAction(q,U),B=(b||(b=n("Promise"))).reject(r("err")("unsupported"))):B=o("WAWebSendMsgChatAction").addAndSendMsgToChat(t,q,U)[1]}else{var V=x(e,t,a,N).then(function(e){var t=a.useBasePropsType===!0?N.type:e.type;return babelHelpers.extends({},N,e,{type:t})});o("WAWebNewsletterGatingUtils").isNewsletterEnabled()&&o("WAWebChatGetters").getIsNewsletter(t)?B=o("WAWebNewsletterSendMsgAction").sendNewsletterMediaMsg(t,yield V,F):t.id.isStatus()?(B=o("WAWebSendStatusMsgAction").sendStatusMediaMsgAction(yield V,F),B=(b||(b=n("Promise"))).reject(r("err")("unsupported"))):B=o("WAWebSendMsgChatAction").addAndSendMsgToChat(t,V,F)[1]}return B.then(function(e){return{result:e,error:null}}).catch(function(e){return{result:null,error:e}}).then(function(e){var t,n=e.result,r=e.error;if((n==null?void 0:n.messageSendResult)===o("WAWebSendMsgResultAction").SendMsgResult.OK)return w.type===o("WAWebMediaTypes").OUTWARD_TYPES.STICKER&&w.isAvatar!==!0&&o("WAWebRecentStickerCollectionMd").RecentStickerCollectionMd.addStickerWithMediaData(w),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.OK};w&&(w.ack=o("WAWebAck").ACK.FAILED);var a=(t=w)==null||(t=t.mediaObject)==null?void 0:t.uploadStage;if(w&&o("WAWebMmsMediaTypes").getMsgMediaType(w)===o("WAWebMediaTypes").OUTWARD_TYPES.STICKER&&o("WAWebAttachMenuGatingUtils").areExpressionPanelsEnabledV2()){var i=a||"undefined";A===o("WAWebMediaMmsV4Upload").UploadMediaResultKind.ERROR&&o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["Sticker:sendToChat failed with expressions panel enabled"]))).tags("non-sad").sendLogs("sticker-send-fail-with-expressions-panel-enabled-uploadStage-"+i,{sampling:.01})}if(A===o("WAWebMediaMmsV4Upload").UploadMediaResultKind.CANCELLATION){var l;return o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Media:sendToChat canceled"]))).devConsole({result:n,uploadStage:a,error:r}),(l=w.wamMessageSendReporter)==null||l.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_CANCELLED,isTerminal:!0}),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_CANCELLED}}if(o("WALogger").WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["Media:sendToChat error\nresult: ","\nuploadStage: ","\nuploadResultKind: ","\nerror: ",""],["Media:sendToChat error\\nresult: ","\\nuploadStage: ","\\nuploadResultKind: ","\\nerror: ",""])),n,a,A,String(r)).devConsole(r),a!=null)switch(a){case o("WAWebMediaTypes").UploadStage.NEED_UPLOAD:case o("WAWebMediaTypes").UploadStage.ERROR_TOO_LARGE:return{messageSendResult:D(w)};case o("WAWebMediaTypes").UploadStage.ERROR_MISSING:return{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_EXPIRED};default:}return A===o("WAWebMediaMmsV4Upload").UploadMediaResultKind.ERROR?{messageSendResult:D(w)}:n!=null?n:(w&&o("WAWebMmsMediaTypes").getMsgMediaType(w)===o("WAWebMediaTypes").OUTWARD_TYPES.STICKER&&o("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["Sticker:sendToChat failed with unknown error"]))).sendLogs("sticker-send-fail-unknown-"+(o("WAWebAttachMenuGatingUtils").areExpressionPanelsEnabledV2()?"expression-panels":"old-panels")),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN})})}),w.apply(this,arguments)}l.MediaPrep=v,l.getMediaPropsNew=$,l.uploadMediaWithPrep=P,l.sendMediaMsgToChat=M}),98);
__d("WAWebMediaStorage",["WALogger","WAWebMediaDataUtils","WAWebMediaObject","WAWebMediaStore","WAWebMmsMediaTypes","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){var e,s={};function u(e,t){e.addMsg(t)}function c(e,t){t.mediaObject=null,e.removeMsg(t),!e.hasAssociatedMsgsOrStickers()&&(y(e.filehash,o("WAWebMediaDataUtils").shouldUseLruMediaStore(o("WAWebMmsMediaTypes").getMsgMediaType(t))),e.delete())}function d(){var e=s;s={};for(var t in e)e[t].delete()}function m(e){return Object.prototype.hasOwnProperty.call(s,e)?s[e]:s[e]=new(o("WAWebMediaObject")).MediaObject}function p(e){}function _(e,t){e.addStickerPack(t)}function f(e,t){t.mediaObject=null,e.removeStickerPack(t),!e.hasAssociatedMsgsOrStickers()&&(y(e.filehash),e.delete())}function g(e,t){e.addSticker(t)}function h(e,t){t.mediaObject=null,e.removeSticker(t),!e.hasAssociatedMsgsOrStickers()&&(y(e.filehash),e.delete())}var y=function(n,a){a===void 0&&(a=!0),!r("isStringNullOrEmpty")(n)&&(delete s[n],a&&o("WAWebMediaStore").LruMediaStore.del(n).catch(function(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[Media Storage] removing data (ArrayBuffer) from persistent storage "]))).devConsole(t)}))};l.associateMediaWithMsg=u,l.disassociateMediaFromMsg=c,l.delistAndDeleteAllMedia=d,l.getOrCreateMediaObject=m,l.clearMediaForChat=p,l.associateMediaWithStickerPack=_,l.disassociateMediaFromStickerPack=f,l.associateMediaWithSticker=g,l.disassociateMediaFromSticker=h}),98);
__d("WAWebMediaUploadMmsThumbnail",["WAAbortError","WACustomError","WAPromiseRaceAbort","WAPromiseTimeout","WAWebCryptoCalculateFilehash","WAWebMediaCryptoEligibilityUtils","WAWebMediaMmsV4Upload","WAWebMediaObject","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.thumbnail,a=e.mediaType,i=e.mediaKeyInfo,l=e.uploadOrigin,s=e.forwardedFromWeb,u=e.timeout,c=e.signal,d=e.isViewOnce,m=new(o("WAWebMediaObject")).MediaObject;try{return u==null?yield _():yield o("WAPromiseTimeout").promiseTimeout(_(),u)}catch(e){var p=e;if(p instanceof o("WACustomError").TimeoutError)return o("WAWebMediaMmsV4Upload").cancelUploadMedia(m),{kind:o("WAWebMediaMmsV4Upload").UploadMediaResultKind.TIMEOUT};throw p}function _(){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var e=yield r("WAPromiseRaceAbort")(o("WAWebCryptoCalculateFilehash").calculateFilehashFromBlob(t),c);m.filehash=e,m.mediaBlob=t;var n=o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(a)?o("WAWebMediaMmsV4Upload").uploadMedia:o("WAWebMediaMmsV4Upload").uploadUnencryptedMedia,u=yield r("WAPromiseRaceAbort")(n({mimetype:"image/jpeg",mediaObject:m,mediaType:a,forwardedFromWeb:s,uploadOrigin:l,mediaKeyInfo:i,isViewOnce:d}),c);return u.kind===o("WAWebMediaMmsV4Upload").UploadMediaResultKind.SUCCESS?babelHelpers.extends({},u,{filehash:e}):{kind:u.kind}}catch(e){var p=e;if(typeof p=="object"&&(e==null?void 0:e.name)===o("WAAbortError").ABORT_ERROR)return o("WAWebMediaMmsV4Upload").cancelUploadMedia(m),{kind:o("WAWebMediaMmsV4Upload").UploadMediaResultKind.CANCELLATION}}}),f.apply(this,arguments)}}),s.apply(this,arguments)}l.default=e}),98);
__d("WAWebMediaFileTooLargeError",["WACustomError","WAWebMiscErrors"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(t,n,r){var o;return o=e.call(this,"File ("+t+") size = "+r+" exceeds limit of "+n)||this,o.mediaType=t,o.uploadLimit=n,o.actualSize=r,o}return babelHelpers.inheritsLoose(t,e),t})(o("WACustomError").customError("MediaFileTooLarge",!0,o("WAWebMiscErrors").MediaFileError));l.default=e}),98);
__d("WAWebWamEnumDocumentType",[],(function(t,n,r,o,a,i){var e=Object.freeze({OTHER:1,IMAGE:2,VIDEO:3,AUDIO:4,DOCUMENT:5,COMPRESSED_FILE:6,EXECUTABLE:7,VCARD:8});i.DOCUMENT_TYPE=e}),66);
__d("WAWebSendDocumentWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumDocumentType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({SendDocument:[2172,{documentExt:[3,e.TYPES.STRING],documentPageSize:[4,e.TYPES.INTEGER],documentSize:[1,e.TYPES.NUMBER],documentType:[2,o("WAWebWamEnumDocumentType").DOCUMENT_TYPE]},[1,1,1],"regular"]},{SendDocument:[]});l.SendDocumentWamEvent=s}),98);
__d("WAWebProcessRawMediaLogging",["WAWebSendDocumentWamEvent","WAWebWamEnumDocumentType"],(function(t,n,r,o,a,i,l){var e,s=new Map([["ai",(e=o("WAWebWamEnumDocumentType")).DOCUMENT_TYPE.IMAGE],["ico",e.DOCUMENT_TYPE.IMAGE],["jpeg",e.DOCUMENT_TYPE.IMAGE],["jpg",e.DOCUMENT_TYPE.IMAGE],["png",e.DOCUMENT_TYPE.IMAGE],["ps",e.DOCUMENT_TYPE.IMAGE],["psd",e.DOCUMENT_TYPE.IMAGE],["svg",e.DOCUMENT_TYPE.IMAGE],["tif",e.DOCUMENT_TYPE.IMAGE],["tiff",e.DOCUMENT_TYPE.IMAGE],["3g2",e.DOCUMENT_TYPE.VIDEO],["3gp",e.DOCUMENT_TYPE.VIDEO],["avi",e.DOCUMENT_TYPE.VIDEO],["flv",e.DOCUMENT_TYPE.VIDEO],["h264",e.DOCUMENT_TYPE.VIDEO],["m4v",e.DOCUMENT_TYPE.VIDEO],["mkv",e.DOCUMENT_TYPE.VIDEO],["mov",e.DOCUMENT_TYPE.VIDEO],["mp4",e.DOCUMENT_TYPE.VIDEO],["mpg",e.DOCUMENT_TYPE.VIDEO],["mpeg",e.DOCUMENT_TYPE.VIDEO],["rm",e.DOCUMENT_TYPE.VIDEO],["vob",e.DOCUMENT_TYPE.VIDEO],["wmv",e.DOCUMENT_TYPE.AUDIO],["aif",e.DOCUMENT_TYPE.AUDIO],["cda",e.DOCUMENT_TYPE.AUDIO],["mpa",e.DOCUMENT_TYPE.AUDIO],["opus",e.DOCUMENT_TYPE.AUDIO],["ogg",e.DOCUMENT_TYPE.AUDIO],["wlp",e.DOCUMENT_TYPE.AUDIO],["amr",e.DOCUMENT_TYPE.AUDIO],["mp3",e.DOCUMENT_TYPE.AUDIO],["m4a",e.DOCUMENT_TYPE.AUDIO],["aac",e.DOCUMENT_TYPE.AUDIO],["wav",e.DOCUMENT_TYPE.AUDIO],["wma",e.DOCUMENT_TYPE.AUDIO],["pdf",e.DOCUMENT_TYPE.DOCUMENT],["doc",e.DOCUMENT_TYPE.DOCUMENT],["docx",e.DOCUMENT_TYPE.DOCUMENT],["ppt",e.DOCUMENT_TYPE.DOCUMENT],["pptx",e.DOCUMENT_TYPE.DOCUMENT],["xls",e.DOCUMENT_TYPE.DOCUMENT],["xlsx",e.DOCUMENT_TYPE.DOCUMENT],["txt",e.DOCUMENT_TYPE.DOCUMENT],["rtf",e.DOCUMENT_TYPE.DOCUMENT],["tex",e.DOCUMENT_TYPE.DOCUMENT],["csv",e.DOCUMENT_TYPE.DOCUMENT],["wpd",e.DOCUMENT_TYPE.DOCUMENT],["7z",e.DOCUMENT_TYPE.COMPRESSED_FILE],["arj",e.DOCUMENT_TYPE.COMPRESSED_FILE],["deb",e.DOCUMENT_TYPE.COMPRESSED_FILE],["pkg",e.DOCUMENT_TYPE.COMPRESSED_FILE],["rar",e.DOCUMENT_TYPE.COMPRESSED_FILE],["rpm",e.DOCUMENT_TYPE.COMPRESSED_FILE],["gz",e.DOCUMENT_TYPE.COMPRESSED_FILE],["z",e.DOCUMENT_TYPE.COMPRESSED_FILE],["zip",e.DOCUMENT_TYPE.COMPRESSED_FILE],["apk",e.DOCUMENT_TYPE.EXECUTABLE],["bat",e.DOCUMENT_TYPE.EXECUTABLE],["bin",e.DOCUMENT_TYPE.EXECUTABLE],["cgi",e.DOCUMENT_TYPE.EXECUTABLE],["pl",e.DOCUMENT_TYPE.EXECUTABLE],["com",e.DOCUMENT_TYPE.EXECUTABLE],["exe",e.DOCUMENT_TYPE.EXECUTABLE],["gadget",e.DOCUMENT_TYPE.EXECUTABLE],["jar",e.DOCUMENT_TYPE.EXECUTABLE],["msi",e.DOCUMENT_TYPE.EXECUTABLE],["py",e.DOCUMENT_TYPE.EXECUTABLE],["wsf",e.DOCUMENT_TYPE.EXECUTABLE]]);function u(e,t){var n,r,a=(n=e==null?void 0:e.split(".").pop())!=null?n:"",i=s.has(a)?a:"",l=(r=s.get(i))!=null?r:o("WAWebWamEnumDocumentType").DOCUMENT_TYPE.OTHER,u=new(o("WAWebSendDocumentWamEvent")).SendDocumentWamEvent({documentSize:t,documentType:l,documentExt:i});u.commit()}l.logSendDocumentEvent=u}),98);
__d("WAWebProcessRawMedia",["WAWebABProps","WAWebFileUtils","WAWebMediaDataUtils","WAWebMediaFileTooLargeError","WAWebMediaGatingUtils","WAWebMiscErrors","WAWebProcessRawMediaLogging","asyncToGeneratorRuntime","cr:10296","err"],(function(t,n,r,o,a,i,l){var e=2147483648;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a){var i;t.retain();try{var l,s,u=t.size(),c=(l=n("cr:10296")==null?void 0:n("cr:10296").isWindowsHybridTranscoderEnabled())!=null?l:!1,d;a.asDocument===!0?d=o("WAWebFileUtils").FILETYPE.DOCUMENT:a.asSticker===!0?d=o("WAWebFileUtils").FILETYPE.STICKER:a.asStickerPack===!0?d=o("WAWebFileUtils").FILETYPE.STICKER_PACK:d=o("WAWebFileUtils").typeFromMimetype(t.type());var m=(s=a.isVcardOverMmsDocument)!=null?s:!1;d==="document"&&o("WAWebProcessRawMediaLogging").logSendDocumentEvent(a.filename,u);var p=o("WAWebMediaGatingUtils").getUploadLimit(d,a.fileOrigin,m);if(d==="video"&&c&&u>=e)throw new(r("WAWebMediaFileTooLargeError"))(d,e,u);if(!c&&u>p)throw new(r("WAWebMediaFileTooLargeError"))(d,p,u);if(u<=0)throw new(o("WAWebMiscErrors")).MediaFileEmpty;var _;a.gifAttribution!=null?_=a.gifAttribution:a.asGif===!0&&(_=0);var f;switch(d){case"image":f=yield o("WAWebMediaDataUtils").processRawImage(t,{maxDimension:(i=a.maxDimension)!=null?i:o("WAWebABProps").getABPropConfigValue("web_image_max_edge"),minDimension:a.minDimension,transparency:a.transparency});break;case"sticker":f=yield o("WAWebMediaDataUtils").processRawSticker(t);break;case"video":case"audio":if(f=yield o("WAWebMediaDataUtils").processRawAudioVideo(t,!!a.isPtt,a.precomputedFields,a.asGif,_,t.type(),a.accessibilityLabel,a.setProgressPercentage,a.setMediaPreview,a.resetMediaPreview,a.setMimeType),c&&d==="video"&&f.size!=null&&f.size>p)throw new(r("WAWebMediaFileTooLargeError"))(d,p,f.size);break;case"document":case"sticker-pack":f=yield o("WAWebMediaDataUtils").processRawDocument(t,a.filename,m,a.documentPageCount,d);break;default:throw r("err")("Received unsupported mediaType: "+d)}return f}finally{t.autorelease()}}),u.apply(this,arguments)}l.processRawMedia=s}),98);
__d("WAWebRequestMediaReuploadManager",["Promise","WALogger","WANullthrows","WAWebMiscErrors","WAWebMmsMediaTypes","WAWebMsgGetters","WAWebSendServerErrorReceiptJob","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u=(function(){function t(){var t=this;this.$1=new Map,this.requestMediaReupload=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var a=e.id.id;if(o("WAWebMsgGetters").getIsNewsletterMsg(e))throw new(o("WAWebMiscErrors")).RMRNotSupportedOnNewsletterMessagesError(o("WAWebMmsMediaTypes").getMsgMediaType(e));var i=t.$1.get(a);if(i)return r("WANullthrows")(i.request);var l=new(s||(s=n("Promise")))(function(n,r){t.$1.set(a,{resolve:n,reject:r,msg:e})});return r("WANullthrows")(t.$1.get(a)).request=l,yield r("WAWebSendServerErrorReceiptJob")(e),l});return function(t){return e.apply(this,arguments)}})(),this.resolveMediaReupload=function(n){var r=n.msgId,a=n.result,i=n.directPath,l=t.$1.get(r);l!=null?(l.resolve({result:a,directPath:i}),t.$1.delete(r)):o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["resolveMediaReupload: msgId (",") is not found in _rmrRequests"])),r)},this.getMediaKey=function(e){var n;return(n=t.$1.get(e))==null?void 0:n.msg.mediaKey}}var a=t.prototype;return a.rmrRequests_TESTONLY=function(){return this.$1},t})(),c=new u;l.RequestMediaReuploadManagerImpl=u,l.RequestMediaReuploadManager=c}),98);
__d("WAWebDecodeWebpToRgba",["Promise","WAWebMiscErrors","WAWebWebpToRgbaWorkerResource","WorkerBundleResource"],(function(t,n,r,o,a,i,l){var e;function s(t){return new(e||(e=n("Promise")))(function(e,n){var a=o("WorkerBundleResource").createDedicatedWebWorker(r("WAWebWebpToRgbaWorkerResource"));a.onerror=function(e){a.terminate(),n(new(o("WAWebMiscErrors")).DecodeWebpResultsError("worker error",e))},a.onmessageerror=function(e){a.terminate(),n(new(o("WAWebMiscErrors")).DecodeWebpResultsError("worker message error",e))},a.onmessage=function(t){a.terminate();var n=t.data;e(n)},a.postMessage({type:"message",message:{webpBuffer:t}},[t])})}l.default=s}),98);
__d("WAWebSendMessageToMediaWorker",["Promise","WALogger","WAWebMediaWorkerResource","WebWorker"],(function(t,n,r,o,a,i,l){var e,s,u,c=m();function d(t){var r;return new(u||(u=n("Promise")))(function(n,a){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:sendMessageToMediaWorker"]))),r=c&&p(c)?m():c,r.setMessageHandler(function(e){try{e.type==="log"?o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["(via Milan) ",""])),e.msg):n(e)}catch(e){a(e)}}).setErrorHandler(function(e){a(new Error("Milan.onerror = "+(e!=null&&e.message?e.message:e)))}).execute(),r.postMessage(t)}).finally(function(){r&&(r.terminate(),(!c||!c.isCurrentState("constructed"))&&(c=m()))})}function m(){return new(r("WebWorker"))(r("WAWebMediaWorkerResource")).setAllowCrossPageTransition(!0)}function p(e){return e.isCurrentState("preparing")||e.isCurrentState("executing")}l.sendMessageToMediaWorker=d}),98);
__d("WAWebWebcMediaAnalyzedWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WebcMediaAnalyzed:[912,{webcMediaAnalyzeT:[3,e.TYPES.TIMER],webcMediaExtensions:[2,e.TYPES.STRING],webcMediaSupported:[1,e.TYPES.BOOLEAN]},[1,1,1],"regular"]},{WebcMediaAnalyzed:[]});l.WebcMediaAnalyzedWamEvent=s}),98);
__d("WAWebMediaAnalyzer",["WALogger","WAMediaWasmWorkerClient","WAWebMediaGatingUtils","WAWebSendMessageToMediaWorker","WAWebWebcMediaAnalyzedWamEvent","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g;function h(e,t){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r=new(o("WAWebWebcMediaAnalyzedWamEvent")).WebcMediaAnalyzedWamEvent,a=!1;try{var i=o("WAWebMediaGatingUtils").shouldUseWasmMediaWorkerForFile(t),l;if(i)l=yield C(t,n);else{var m={type:"prep",file:t,asGif:n},p=yield o("WAWebSendMessageToMediaWorker").sendMessageToMediaWorker(m),_=p.type,f=p.result,g=p.error,h=p.filename,y=p.file;switch(_){case"result":o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair approved file"]))),a=!!f,l=f;break;case"parsingError":o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["trouble parsing file "," (fossil ",") ",""])),y,h,String(g)),y&&o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair got parsing error! ",""])),String(g)).sendLogs("media-parsing-error"),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair rejected file (",")"])),String(g));break}}return[l,i]}catch(e){return o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair got error! ",""])),String(e)).sendLogs("media-detection-error"),[void 0,!1]}finally{if(r){var b=void 0;if(t.name){var v=t.name.split(".");v.length>1&&(b=v[v.length-1])}r.set({webcMediaSupported:a,webcMediaExtensions:b}),r.markWebcMediaAnalyzeT(),r.commit()}}}),y.apply(this,arguments)}function C(e,t){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[processVideoThroughWasm] start process video through wasm"])));var n=yield e.arrayBuffer(),r=yield o("WAMediaWasmWorkerClient").mp4RepairMuxInWorker({input:new Uint8Array(n),eventFlow:null});if(r.success)return o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[processVideoThroughWasm][success]"]))).devConsole(r),{type:"video/mp4",file:new Blob([r.value],{type:"video/mp4"}),isGif:t};switch(r.error){case"undefined-operation":case"worker-connection-runtime-error":case"invalid-media":case"runtime-error":case"internal-error":o("WALogger").WARN(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[processVideoThroughWasm][error] failed to repair video file"]))).devConsole(r);break;case"worker-connection-timeout":o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[processVideoThroughWasm][error] error ",""])),r.error).sendLogs("worker-connection-timeout-error");break;default:r.error,o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[processVideoThroughWasm][error] unrecognised error ",""])),r.error).sendLogs("media-analyzer-unrecognised-error");break}}),b.apply(this,arguments)}l.checkAndRepair=h}),98);
__d("WAWebWamEnumVideoTranscoderAlgorithmType",[],(function(t,n,r,o,a,i){var e=Object.freeze({WA_IPHONE:0,FB_IPHONE:1,WASM_MP4_CHECK_AND_REPAIR:2,WEB_MEDIA_WORKER:3,HYBRID_BRIDGE:4});i.VIDEO_TRANSCODER_ALGORITHM_TYPE=e}),66);
__d("WAWebWamEnumVideoTranscoderResultType",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNKNOWN:0,SUCCEEDED:1,FAILED:2,CANCELLED:3});i.VIDEO_TRANSCODER_RESULT_TYPE=e}),66);
__d("WAWebWamEnumVideoTranscoderSourceFormatType",[],(function(t,n,r,o,a,i){var e=Object.freeze({SLOMO:0,VIDEO:1,GIF:2});i.VIDEO_TRANSCODER_SOURCE_FORMAT_TYPE=e}),66);
__d("WAWebWamEnumVideoTranscoderTargetFormatType",[],(function(t,n,r,o,a,i){var e=Object.freeze({IMAGE:0,VIDEO:1,GIF:2});i.VIDEO_TRANSCODER_TARGET_FORMAT_TYPE=e}),66);
__d("WAWebVideoTranscoderWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumVideoTranscoderAlgorithmType","WAWebWamEnumVideoTranscoderResultType","WAWebWamEnumVideoTranscoderSourceFormatType","WAWebWamEnumVideoTranscoderTargetFormatType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({VideoTranscoder:[1802,{sourceAudioBitRate:[12,e.TYPES.NUMBER],sourceAudioCodec:[23,e.TYPES.STRING],sourceContainerFormat:[24,e.TYPES.STRING],sourceDuration:[8,e.TYPES.TIMER],sourceFileExtension:[25,e.TYPES.STRING],sourceFileSize:[7,e.TYPES.NUMBER],sourceFormat:[14,o("WAWebWamEnumVideoTranscoderSourceFormatType").VIDEO_TRANSCODER_SOURCE_FORMAT_TYPE],sourceFrameRate:[13,e.TYPES.NUMBER],sourceHeight:[10,e.TYPES.NUMBER],sourceMimeType:[26,e.TYPES.STRING],sourceVideoBitRate:[11,e.TYPES.NUMBER],sourceVideoCodec:[27,e.TYPES.STRING],sourceWidth:[9,e.TYPES.NUMBER],targetAudioBitRate:[20,e.TYPES.NUMBER],targetDuration:[16,e.TYPES.TIMER],targetFileSize:[15,e.TYPES.NUMBER],targetFormat:[22,o("WAWebWamEnumVideoTranscoderTargetFormatType").VIDEO_TRANSCODER_TARGET_FORMAT_TYPE],targetFrameRate:[21,e.TYPES.NUMBER],targetHeight:[18,e.TYPES.NUMBER],targetVideoBitRate:[19,e.TYPES.NUMBER],targetWidth:[17,e.TYPES.NUMBER],transcoderAlgorithm:[1,o("WAWebWamEnumVideoTranscoderAlgorithmType").VIDEO_TRANSCODER_ALGORITHM_TYPE],transcoderContainsVideocomposition:[5,e.TYPES.BOOLEAN],transcoderHasEdits:[6,e.TYPES.BOOLEAN],transcoderIsPassthrough:[4,e.TYPES.BOOLEAN],transcoderResult:[2,o("WAWebWamEnumVideoTranscoderResultType").VIDEO_TRANSCODER_RESULT_TYPE],transcoderT:[3,e.TYPES.TIMER]},[1,1,1],"regular"]},{VideoTranscoder:[]});l.VideoTranscoderWamEvent=s}),98);
__d("WAWebWaveformUtils",["WAPttComposerScaleWaveform","WAWebNewsletterGatingUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e=64;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(!o("WAWebNewsletterGatingUtils").isAudioFileWaveformSenderEnabled())return null;var n=yield t.arrayBuffer(),r=new AudioContext({sampleRate:8e3}),a=yield r.decodeAudioData(n),i=c(a,e);return new Uint8Array(i)}),u.apply(this,arguments)}function c(e,t){var n=e.getChannelData(0);return m(d(n,t))}function d(e,t){return r("WAPttComposerScaleWaveform")(Array.from(e,Math.abs),t)}function m(e){var t=Math.pow(Math.max.apply(Math,e),-1),n=e.map(function(e){return e*t});return n.map(function(e){return e*100})}l.computeWaveform=s}),98);
__d("WAWebMediaDataUtils",["Promise","WABase64","WAFilteredCatch","WALogger","WANullthrows","WAPromiseCallSync","WAWebABProps","WAWebCanvasUtils","WAWebDecodeWebpToRgba","WAWebDocumentUploadEnrichment","WAWebFileUtils","WAWebImageUtils","WAWebMediaAnalyzer","WAWebMediaCleanFileName","WAWebMediaConstants","WAWebMediaLoad","WAWebMediaOpaqueData","WAWebMediaTypes","WAWebMimeTypes","WAWebMiscErrors","WAWebMiscGatingUtils","WAWebMmsMediaTypes","WAWebNetworkGetResponseIfOnline","WAWebStickerUtils","WAWebURLUtils","WAWebVcardParsingUtils","WAWebVideoTranscoderWamEvent","WAWebWamEnumVideoTranscoderAlgorithmType","WAWebWamEnumVideoTranscoderResultType","WAWebWamEnumVideoTranscoderSourceFormatType","WAWebWamEnumVideoTranscoderTargetFormatType","WAWebWaveformUtils","WAWebWebpParseWebp","WAWebXHR","asyncToGeneratorRuntime","cr:10296","err","file-type","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f=2e4;function g(e){return O((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){t(e);var o=new Image;return yield new(_||(_=n("Promise")))(function(t,n){o.onload=t,o.onabort=function(){n(r("err")("getImageWidthHeight onabort"))},o.onerror=function(){n(r("err")("getImageWidthHeight onerror"))},o.src=e.url()}),{width:o.naturalWidth,height:o.naturalHeight}});return function(e){return t.apply(this,arguments)}})())}function h(e){return new(_||(_=n("Promise")))(function(t,n){var o=new Image,a=window.URL.createObjectURL(e);o.onload=function(){var e={width:o.naturalWidth,height:o.naturalHeight};window.URL.revokeObjectURL(a),t(e)},o.onabort=function(){window.URL.revokeObjectURL(a),n(r("err")("getImageWidthHeight onabort"))},o.onerror=function(){window.URL.revokeObjectURL(a),n(r("err")("getImageWidthHeight onerror"))},o.src=a})}function y(t){return o("WAWebFileUtils").blobToArrayBuffer(t).catch(function(t){throw o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["MediaUtils error: ",""])),t).devConsole(t),t})}function C(e){return O(function(t){t(e);var n=e.getBlob();if(n)return y(n);var a=r("WANullthrows")(e.getBase64(),"b64 should be defined");return o("WABase64").decodeB64(a)})}function b(e){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield y(e);return r("WAWebDecodeWebpToRgba")(t)}),v.apply(this,arguments)}function S(e){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield y(e);return o("WAWebWebpParseWebp").parseWebp(t)}),R.apply(this,arguments)}function L(e){return o("WAWebMediaLoad").videoWidthHeightDuration(e)}function E(e,t){return O((function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){n(e);var a=yield o("WAWebMediaLoad").transcode(e.forceToBlob(),t).then(function(e){return r("WAWebMediaOpaqueData").createFromData(e,e.type)});return n(a),a.autorelease(),a});return function(e){return a.apply(this,arguments)}})())}function k(e,t){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=t.transparency,r=t.minDimension,a=t.maxDimension,i=yield o("WAWebImageUtils").rotateAndResize(e,a,o("WAWebImageUtils").BLOB,{transparency:n,minDimension:r}),l=i.width,s=i.height,u=i.images;if(u==null||u.blob==null)throw new(o("WAWebMiscErrors")).MediaFileFailedLoad;return{width:l,height:s,size:u.blob.size}}),I.apply(this,arguments)}function T(e,t){return D.apply(this,arguments)}function D(){return D=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n,a=t.transparency,i=t.minDimension,l=t.maxDimension,u=e.forceToBlob(),c=yield o("WAWebImageUtils").rotateAndResize(u,l,o("WAWebImageUtils").BLOB|o("WAWebImageUtils").CANVAS,{transparency:a,minDimension:i}),d=c.width,m=c.height,p=c.images;if(p==null||p.canvas==null)throw new(o("WAWebMiscErrors")).MediaFileFailedLoad;var _=yield o("WAWebImageUtils").rotateAndResize(p.canvas,o("WAWebMediaConstants").IMG_THUMB_MAX_EDGE,o("WAWebImageUtils").DATA_URL|o("WAWebImageUtils").CANVAS),g=_.images;if(g==null||g.canvas==null)throw new(o("WAWebMiscErrors")).MediaFileFailedLoad;var h=o("WAWebCanvasUtils").getResizedDataUrl(g.canvas,"image/jpeg",f),y=h!=null&&h!==""?r("WAWebURLUtils").parseDataURL(h).data:null;return(y==null||y==="")&&o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["processRawImage: Failed to reach max thumbnail size, preview will be null"]))),{type:o("WAWebMediaTypes").OUTWARD_TYPES.IMAGE,mediaBlob:p.blob,mimetype:(n=p.blob)==null?void 0:n.type,fullWidth:d,fullHeight:m,preview:y}}),D.apply(this,arguments)}function x(e){return $.apply(this,arguments)}function $(){return $=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.forceToBlob(),n=yield o("WAWebImageUtils").rotateAndResize(t,o("WAWebABProps").getABPropConfigValue("web_image_max_edge"),o("WAWebImageUtils").BLOB,{transparency:!0}),a=n.width,i=n.height,l=n.images;if(l==null||l.blob==null)throw new(o("WAWebMiscErrors")).MediaFileFailedLoad;var s=yield o("WAWebImageUtils").toWebpSticker(l.blob),u=yield r("WAWebMediaOpaqueData").createFromData(s,s.type);return{type:o("WAWebMediaTypes").OUTWARD_TYPES.STICKER,mediaBlob:u,mimetype:s.type,fullWidth:a,fullHeight:i}}),$.apply(this,arguments)}function P(e,t,n,r,o,a,i,l,s,u,c){return N.apply(this,arguments)}function N(){return N=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,i,l,s,p,_,f,g,h){var y=!1;try{var C,b,v=e.forceToBlob(),S=v instanceof File?v.name:"",R=new(o("WAWebVideoTranscoderWamEvent")).VideoTranscoderWamEvent({sourceHeight:a==null?void 0:a.fullHeight,sourceWidth:a==null?void 0:a.fullWidth,sourceDuration:a==null?void 0:a.duration,sourceFileSize:e.size(),sourceFormat:i===!0?o("WAWebWamEnumVideoTranscoderSourceFormatType").VIDEO_TRANSCODER_SOURCE_FORMAT_TYPE.GIF:o("WAWebWamEnumVideoTranscoderSourceFormatType").VIDEO_TRANSCODER_SOURCE_FORMAT_TYPE.VIDEO,sourceMimeType:v.type,sourceFileExtension:S.split(".").pop()}),L=(C=n("cr:10296")==null?void 0:n("cr:10296").isWindowsHybridTranscoderEnabled())!=null?C:!1,E=v.type.startsWith("video/"),k=v.type==="video/mp4",I=k?(b=n("cr:10296")==null?void 0:n("cr:10296").isWindowsHybridTranscoderEnabledForMp4())!=null?b:!1:!0,T=L&&E&&I;R.startTranscoderT();var D=null;if(!T){var x=!1,$=yield o("WAWebMediaAnalyzer").checkAndRepair(v,!!i);D=$[0],x=$[1],D&&(R.transcoderAlgorithm=x?o("WAWebWamEnumVideoTranscoderAlgorithmType").VIDEO_TRANSCODER_ALGORITHM_TYPE.WASM_MP4_CHECK_AND_REPAIR:o("WAWebWamEnumVideoTranscoderAlgorithmType").VIDEO_TRANSCODER_ALGORITHM_TYPE.WEB_MEDIA_WORKER)}if(T||!D&&L){R.transcoderAlgorithm=o("WAWebWamEnumVideoTranscoderAlgorithmType").VIDEO_TRANSCODER_ALGORITHM_TYPE.HYBRID_BRIDGE;var P=yield n("cr:10296")==null?void 0:n("cr:10296").transcodeVideo(v,_,f,g,h);if(P!=null){var N=P[0],M=P[1];v=N,y=M,D={type:v.type,file:v,isGif:!1}}}if(R.markTranscoderT(),!D)throw R.set({transcoderResult:o("WAWebWamEnumVideoTranscoderResultType").VIDEO_TRANSCODER_RESULT_TYPE.FAILED}),R.commit(),o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["processRawAudioVideo bad video file ",""])),v.type).devConsole(v),new(o("WAWebMiscErrors")).InvalidMediaCheckRepairFailedType;var w=D.type,A=D.file;R.set({targetFileSize:A.size});var F=i===!0||D.isGif===!0;switch(o("WAWebFileUtils").typeFromMimetype(w)){case o("WAWebFileUtils").FILETYPE.VIDEO:{if(t)throw R.set({transcoderResult:o("WAWebWamEnumVideoTranscoderResultType").VIDEO_TRANSCODER_RESULT_TYPE.FAILED}),R.commit(),o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: ptt became video"),new(o("WAWebMiscErrors")).InvalidMediaFileType;R.set({targetFormat:o("WAWebWamEnumVideoTranscoderTargetFormatType").VIDEO_TRANSCODER_TARGET_FORMAT_TYPE.VIDEO,transcoderResult:o("WAWebWamEnumVideoTranscoderResultType").VIDEO_TRANSCODER_RESULT_TYPE.SUCCEEDED});var O={type:o("WAWebMediaTypes").OUTWARD_TYPES.VIDEO,mediaBlob:A,mimetype:w,isGif:F,gifAttribution:F?l||0:void 0,accessibilityLabel:p,size:A.size};if(a&&a.duration!=null&&a.fullHeight!=null&&a.fullHeight!==0&&a.fullWidth!=null&&a.fullWidth!==0&&!r("isStringNullOrEmpty")(a.preview)){var B=a.duration;return R.set({sourceHeight:a.fullHeight,sourceWidth:a.fullWidth,sourceDuration:B}),R.commit(),babelHelpers.extends({},O,{fullWidth:a.fullWidth,fullHeight:a.fullHeight,preview:a.preview,duration:B==null?void 0:B.toString()})}var W=yield o("WAWebImageUtils").generateVideoThumbsAndDuration({file:A,maxDimensions:[o("WAWebMediaConstants").IMG_THUMB_MAX_EDGE,o("WAWebMediaConstants").VIDEO_THUMB_MAX_EDGE],debugHint:"processRawAudioVideo"}),q=W.duration,U=W.thumbs,V=U[0],H=U[1],G=yield r("WAWebMediaOpaqueData").createFromBase64Jpeg(r("WAWebURLUtils").parseDataURL(H.url).data);return R.set({sourceHeight:V.fullHeight,sourceWidth:V.fullWidth,sourceDuration:q}),R.commit(),babelHelpers.extends({},O,{fullWidth:V.fullWidth,fullHeight:V.fullHeight,preview:r("WAWebURLUtils").parseDataURL(V.url).data,fullPreviewData:G,duration:q.toString()})}case o("WAWebFileUtils").FILETYPE.AUDIO:{var z,j,K=(z=a==null?void 0:a.duration)!=null?z:yield o("WAWebFileUtils").getAudioDuration(A),Q=(j=a==null?void 0:a.waveform)!=null?j:yield o("WAWebWaveformUtils").computeWaveform(A);return{type:t?o("WAWebMediaTypes").OUTWARD_TYPES.PTT:o("WAWebMediaTypes").OUTWARD_TYPES.AUDIO,mediaBlob:A,mimetype:w,duration:K.toString(),waveform:Q}}default:throw R.set({transcoderResult:o("WAWebWamEnumVideoTranscoderResultType").VIDEO_TRANSCODER_RESULT_TYPE.FAILED}),R.commit(),o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: audio/video became other"),r("err")("audio/video became "+w)}}catch(e){throw o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["processRawAudioVideo error: ",""])),e).devConsole(e),y&&g!=null&&g(),e}}),N.apply(this,arguments)}function M(e,t){return w.apply(this,arguments)}function w(){return w=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=e.type;if(n){if(o("WAWebMimeTypes").DOC_MIMES==="*"||o("WAWebMimeTypes").DOC_MIMES.includes(n))return n;throw new(o("WAWebMiscErrors")).InvalidMediaFileType("disallowed mimetype "+n)}else{var a=Math.min(o("WAWebMimeTypes").MIMETYPE_DETERMINING_LENGTH,e.size),i=yield y(e.slice(0,a)),l=new Uint8Array(i);if(o("WAWebMimeTypes").isMsCompoundFileBinaryFormat(l.subarray(0,8))){var s;return t!=null&&(s=o("WAWebFileUtils").getMimeTypeForFilepath(t))!=null?s:o("WAWebMimeTypes").MSCFB_MIME}var u=r("file-type")(l);if(u!=null&&u.mime){var c=o("WAWebMimeTypes").isAllowedDocumentMimetype(u.mime,t,!0);if(!r("isStringNullOrEmpty")(c))return c}else if(!r("isStringNullOrEmpty")(t)){var d=o("WAWebFileUtils").getMimeTypeForFilepath(t);if(!r("isStringNullOrEmpty")(d))return d}throw new(o("WAWebMiscErrors")).InvalidMediaFileType("type: "+String(e.type)+" name: "+String(t))}}),w.apply(this,arguments)}function A(e,t,n,r,o){return F.apply(this,arguments)}function F(){return F=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,i,l){var s,u,c=e.forceToBlob(),d=o("WAWebMediaCleanFileName").cleanFilename(c.name||(t!=null?t:"")),m=yield M(c,d),p=a?o("WAWebFileUtils").blobToText(c):null,f=yield(_||(_=n("Promise"))).all([o("WAWebDocumentUploadEnrichment").enrich(c,m),p]),g=f[0],h=f[1],y=(s=g==null||(u=g.microThumbnail)==null?void 0:u.dataUrl)!=null?s:g==null?void 0:g.thumbUrl,C=r("isStringNullOrEmpty")(y)?null:r("WAWebURLUtils").parseDataURL(y).data;return{type:l,mediaBlob:yield r("WAWebMediaOpaqueData").createFromData(c,m),mimetype:m,filename:d||void 0,documentPreview:g,preview:C,fullPreviewData:g==null?void 0:g.fullPreviewData,fullPreviewSize:g?{width:g.width,height:g.height}:null,pageCount:i!=null?i:g==null?void 0:g.pdfPages,isVcardOverMmsDocument:a,parsedVcards:h?o("WAWebVcardParsingUtils").parseMultiVcard(h):null}}),F.apply(this,arguments)}function O(e){var t=[];function n(e){e.retain(),t.push(e)}return o("WAPromiseCallSync").promiseCallSync(e,null,n).finally(function(){for(var e=0;e<t.length;e++)t[e].autorelease()})}function B(e){return W.apply(this,arguments)}function W(){return W=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield r("WAWebNetworkGetResponseIfOnline")(e,"GET",null,r("WAWebXHR").RESP_TYPE.ARRAY_BUFFER);return t?(_||(_=n("Promise"))).resolve({result:t.response,status:t.status}):(_||(_=n("Promise"))).resolve(null)}),W.apply(this,arguments)}function q(){return!!o("WAWebMediaLoad").canPlayOgg}function U(e,t){return V.apply(this,arguments)}function V(){return V=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){t.retain();var n,a;try{switch(e.type){case o("WAWebMediaTypes").TYPE.VIDEO:case o("WAWebMediaTypes").TYPE.PTV:{var i=t.forceToBlob(),l=yield o("WAWebImageUtils").generateVideoThumbsAndDuration({file:i,maxDimensions:[o("WAWebMediaConstants").VIDEO_THUMB_MAX_EDGE],debugHint:"gatherAndSetMetadata"}),s=l.thumbs,u=s[0],c=l.duration,d;o("WAWebMiscGatingUtils").isHighQualityVideoThumbnailsEnabled()&&(d=yield r("WAWebMediaOpaqueData").createFromBase64Jpeg(r("WAWebURLUtils").parseDataURL(u.url).data)),n={mediaBlob:t,renderableUrl:t.url(),fullWidth:u.fullWidth,fullHeight:u.fullHeight,duration:c!==void 0?""+Math.ceil(c):void 0,durationFloat:c,fullPreviewData:d};break}case o("WAWebMediaTypes").TYPE.AUDIO:{var m=yield E(t);m.retain(),n={mediaBlob:m,renderableUrl:m.url()},a=function(){return m.autorelease()};break}default:(e.type===o("WAWebMediaTypes").TYPE.IMAGE||e.type===o("WAWebMediaTypes").TYPE.STICKER)&&o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["object type: ",""])),e.type||"").sendLogs("Entering gatherAndSetMetadata (with OpaqueData) unexpectedly"),n={mediaBlob:t,renderableUrl:t.url()}}e.consolidate(n)}catch(n){if(n instanceof o("WAWebMiscErrors").MediaUnsupportedError)e.consolidate({mediaBlob:t,renderableUrl:t.url()});else throw n}finally{t.autorelease(),a!=null&&a()}}),V.apply(this,arguments)}function H(e,t){return G.apply(this,arguments)}function G(){return G=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var r=yield(_||(_=n("Promise"))).resolve().then(function(){switch(e.type){case o("WAWebMediaTypes").TYPE.VIDEO:case o("WAWebMediaTypes").TYPE.PTV:return L(t).then(function(e){return{fullWidth:e.width,fullHeight:e.height,duration:e.duration!==void 0?""+Math.ceil(e.duration):void 0,durationFloat:e.duration}});case o("WAWebMediaTypes").TYPE.IMAGE:return e.contentInfo.fullHeight!=null&&e.contentInfo.fullWidth!=null&&e.size===t.size?null:h(t).then(function(e){return{fullWidth:e.width,fullHeight:e.height,size:t.size}});case o("WAWebMediaTypes").TYPE.STICKER:return o("WAWebStickerUtils").parseStickerMetadata(t,e);case o("WAWebMediaTypes").TYPE.AUDIO:return{};default:return{}}}).catch(o("WAFilteredCatch").filteredCatch(o("WAWebMiscErrors").MediaUnsupportedError,function(t){throw e.consolidate({}),t}));r!=null&&e.consolidate(r)}),G.apply(this,arguments)}function z(e){return e===o("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.PRODUCT||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.PTT||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.AUDIO||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_IMAGE||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTT||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_AUDIO}function j(e){var t=e===o("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_IMAGE||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER,n=e===o("WAWebMmsMediaTypes").MEDIA_TYPES.AUDIO||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_AUDIO||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.GIF||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_GIF||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.PPIC||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.PRODUCT||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.PTT||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTT||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.PTV||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTV||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_VIDEO||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.TEMPLATE||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_DOCUMENT||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_IMAGE||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_LINK||e===o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_VIDEO;return t||n}function K(e,t){return new(_||(_=n("Promise")))(function(n){var r=new Image;r.setAttribute("crossorigin","anonymous"),r.onload=function(){var e=t.map(function(e){var t=e.width,n=e.height,o=e.minWidth,a=e.minHeight,i=e.imageFormat,l=e.imageFormatOptions,s=e.keepAspectRatio;if(o!=null&&r.width<o||a!=null&&r.height<a)return null;var u=document.createElement("canvas"),c=u.getContext("2d"),d=0,m=0,p,_;if(r.height>r.width){var f=r.height/r.width;p=t,_=f*t,m=-(_-n)/2}else{var g=r.width/r.height;_=n,p=g*n,d=-(p-t)/2}return s===!0?(u.width=p,u.height=_):(u.width=t,u.height=n),c.drawImage(r,d,m,p,_),{dataUrl:u.toDataURL(i,l).replace("data:image/jpeg;base64,",""),width:u.width,height:u.height}});n(e)},r.src=e})}function Q(e){return e?e.fullPreviewData?e.fullPreviewData.url():e.preview instanceof r("WAWebMediaOpaqueData")?e.preview.url():null:null}l.getImageWidthHeight=g,l.getImageWidthHeightNoOpaque=h,l.opaqueDataToArrayBuffer=C,l.decodeWebpToRGBANoOpaque=b,l.parseWebpNoOpaque=S,l.getImageMetadata=k,l.processRawImage=T,l.processRawSticker=x,l.processRawAudioVideo=P,l.getRawDocumentMimetype=M,l.processRawDocument=A,l.fetchMedia=B,l.canPlayOgg=q,l.gatherAndSetMetadata=U,l.gatherAndSetMetadataNoOpaque=H,l.shouldUseMediaCache=z,l.shouldUseLruMediaStore=j,l.getResizedThumbData=K,l.getHighestQualityThumbnailUrl=Q}),98);
__d("WAWebLruCacheMap",["WALruCache"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e){var t=e.sizeLimit,n=e.getSize;this.$1=new(o("WALruCache")).LruCache({sizeLimit:t,getSize:n!=null?n:function(){return 1}})}var t=e.prototype;return t.clear=function(){this.$1.clear()},t.delete=function(t){var e=this.has(t);return e?(this.$1.delete(t),!0):!1},t.get=function(t){return this.$1.get(t)},t.has=function(t){return this.$1.has(t)},t.set=function(t,n){return this.$1.put(t,n),this},t.iterateOnEach=function(t){this.$1.forEach(t)},babelHelpers.createClass(e,[{key:"size",get:function(){return this.$1.getCurrentSize()}}])})();l.LruCacheMap=e}),98);
__d("WAWebInMemoryLottieStickerCache",["WAWebABProps","WAWebLruCacheMap","WAWebMediaMmsV4Download","WAWebStickerErrorWamEvent","WAWebWamEnumStickerErrorType","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=5e3,s=new(o("WAWebLruCacheMap")).LruCacheMap({sizeLimit:e});function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WAWebMediaMmsV4Download").extractLottieJSON(t,e);if(n==null)return null;try{var r=JSON.parse(n);return d(r)?(s.set(e,r),r):null}catch(e){return o("WAWebABProps").getABPropConfigValue("gimmick_phase_two_logging_enabled")&&new(o("WAWebStickerErrorWamEvent")).StickerErrorWamEvent({stickerErrorType:o("WAWebWamEnumStickerErrorType").STICKER_ERROR_TYPE.RECEIVER_VALIDATION}).commit(),null}}),c.apply(this,arguments)}function d(e){var t=["v","ip","op","layers","fr","w","h"];return t.every(function(t){return Object.prototype.hasOwnProperty.call(e,t)})}l.InMemoryLottieStickerCache=s,l.extractAndSetLottieJSONInMemoryCache=u}),98);
__d("WAWebMediaInMemoryBlobCache",["WALogger","WALruCache","WAWebMediaStorage","WAWebMediaTypes","err","lodash"],(function(t,n,r,o,a,i,l){var e,s=25e7,u=(function(){function t(e){var t=this;if(e===void 0&&(e=s),this.$4=new Set,this.$5=new Set,this.getOrCreateURL=function(e){if(t.$3[e])return t.touch(e),t.$3[e];var n=t.get(e);if(!n)throw r("err")("There is no blob matching filehash: "+e+".");var o=window.URL.createObjectURL(n);return t.$3[e]=o,o},this.revokeURL=function(e,n){if(n){if(t.$3[e]!==n)throw r("err")("The url provided does not match the filehash.");delete t.$3[e],window.URL.revokeObjectURL(n)}},this.$8=r("lodash").throttle(function(){t.$4.forEach(function(e){window.URL.revokeObjectURL(t.$3[e]),delete t.$3[e]}),t.$4.clear()},0,{leading:!1}),e!=null&&e<0)throw r("err")("Size limit cannot be a negative number.");this.$2={},this.$3={},this.$1=new(o("WALruCache")).LruCache({sizeLimit:e,getSize:function(t){return t.size},onEvict:function(n,r){t.$3[n]&&t.$6(n)===0&&(t.revokeURL(n,t.$3[n]),o("WAWebMediaStorage").getOrCreateMediaObject(n).consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.INIT,progressiveStage:null}))},shouldEvict:function(n,r){return t.$6(n)===0}})}var n=t.prototype;return n.get=function(t){return this.$1.get(t)},n.has=function(t){return this.$1.has(t)},n.touch=function(t){this.get(t)},n.put=function(t,n){this.$1.put(t,n),this.$7()},n.delete=function(t){this.$1.delete(t),this.$7()},n.clear=function(){var e=this;this.$8.flush(),this.$2={},Object.keys(this.$3).forEach(function(t){e.$3[t]&&e.revokeURL(t,e.$3[t])}),this.$3={},this.$1.clear()},n.increaseUsageCount=function(t){this.$2[t]=this.$6(t)+1,this.$4.delete(t)},n.decreaseUsageCount=function(n){var t=this.$6(n);if(t<=0){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["InMemoryMediaBlobCache: Cannot decrease the usageCount to a negative number."]))).tags("media-in-memory-blob-cache").sendLogs("media-blob-cache-usage-count-negative-number");return}this.$2[n]=t-1,this.$2[n]===0&&(delete this.$2[n],this.$4.add(n),this.$8())},n.$6=function(t){return this.$2[t]||0},n.$7=function(){this.$5.forEach(function(e){return e()})},n.subscribe=function(t){var e=this;return this.$5.add(t),function(){e.$5.delete(t)}},n.getBlobCacheSnapshot=function(t){return this.has(t)},t})(),c=new u;l.InMemoryMediaBlobCacheImpl=u,l.InMemoryMediaBlobCache=c}),98);
__d("WAWebCheckMediaExistence",["WALogger","WAWebMediaMmsV4Download","WAWebMmsMediaTypes","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(yield t.waitForPhoneUpload(),!t.mediaObject){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["checkExistence msg without mediaObject, id: "," type: ",""])),t.id.toString(),t.type).devConsole(t).sendLogs("media-fault: checkExistence msg without mediaObject");return}yield o("WAWebMediaMmsV4Download").checkExistence({mimetype:t.mimetype,mediaObject:t.mediaObject,mediaType:o("WAWebMmsMediaTypes").getMsgMediaType(t)})}),u.apply(this,arguments)}l.checkMediaExistence=s}),98);
__d("WAWebClearMediaForChat",["WAWebMediaStorage"],(function(t,n,r,o,a,i,l){function e(e){o("WAWebMediaStorage").clearMediaForChat(e)}l.clearMediaForChat=e}),98);
__d("WAWebConsolidateMediaUpdate",["WALogger","WAWebMediaCryptoEligibilityUtils","WAWebMediaGetDownloadOriginForMsg","WAWebMediaMmsV4Download","WAWebMediaObject","WAWebMediaOpaqueData","WAWebMediaStorage","WAWebMediaTypes","WAWebMmsMediaTypes","WAWebMsgGetters","WAWebMsgType"],(function(t,n,r,o,a,i,l){var e,s;function u(e){var t={};if(o("WAWebMediaTypes").MAPPED_MSG_PROPS.forEach(function(n){var r=e[n],a=o("WAWebMediaTypes").MSG_TO_MEDIA[n];t[a]=r}),e.type===o("WAWebMsgType").MSG_TYPE.INTERACTIVE){var n=o("WAWebMediaObject").getInteractiveMsgMediaType(e);n&&(t.type=n)}return t}function c(t,n){if(t.isUnsentPhoneMsg()){t.mediaObject&&o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),t.id.toString(),t.type).devConsole(t).sendLogs("media-fault: consolidateMediaUpdate unsent message");var a=u(t);if(Object.prototype.hasOwnProperty.call(a,"preview")){var i=a.preview;delete a.preview,i&&r("WAWebMediaOpaqueData").createFromBase64Jpeg(i).then(function(e){t!=null&&t.mediaData&&t.isUnsentPhoneMsg()&&(t.mediaData.preview=e)})}t.mediaData.set(babelHelpers.extends({},a,{mediaStage:o("WAWebMediaTypes").MediaDataStage.REMOTE_NEED_UPLOAD}))}else d(t,t,n)}function d(e,t,n,a){var i=u(t),l=e.mediaObject,c=t.filehash,d=o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMsg(e);if(l)c&&c!==l.filehash&&(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["media:msg "," "," filehash"])),e.id.toString(),l.filehash?"changed":"added"),o("WAWebMediaStorage").disassociateMediaFromMsg(l,e),l=o("WAWebMediaStorage").getOrCreateMediaObject(c),e.mediaObject=l,o("WAWebMediaStorage").associateMediaWithMsg(l,e));else{c?l=o("WAWebMediaStorage").getOrCreateMediaObject(c):l=new(o("WAWebMediaObject")).MediaObject;var m=e.mediaData;m.aspectRatio!==void 0&&(i.aspectRatio=m.aspectRatio),e.mediaObject=l,o("WAWebMediaStorage").associateMediaWithMsg(l,e)}var p=!1,_=t.deprecatedMms3Url,f=t.mediaKey,g=t.mediaKeyTimestamp,h=t.encFilehash,y=t.type,C=t.streamingSidecar,b=t.firstFrameSidecar,v=t.directPath,S=t.scansSidecar,R=t.scanLengths,L=t.staticUrl;if(_||h||!d){var E;try{E=o("WAWebMmsMediaTypes").msgToMediaType({type:t.type,isGif:t.isGif,interactiveHeader:t.interactiveHeader,isNewsletter:o("WAWebMsgGetters").getIsNewsletterMsg(t)})}catch(e){E=~o("WAWebMmsMediaTypes").MEDIA_TYPE_VALUES.indexOf(y)?y:null}p=d?!l.entries.has({encFilehash:h,deprecatedMms3Url:_}):!l.entries.hasUnencryptedEntry({filehash:c,directPath:v});var k;p?E!=null&&(h!=null||!d)?d&&f!=null?k=l.entries.addEntry({deprecatedMms3Url:_,mediaKey:f,mediaKeyTimestamp:g,encFilehash:h,type:E,sidecar:C,directPath:v,firstFrameSidecar:b,scansSidecar:S,scanLengths:R,debugHint:"consolidate",staticUrl:L}):!d&&v!=null&&c!=null&&(k=l.entries.addUnencryptedEntry({debugHint:"consolidate",directPath:v,filehash:c,type:E})):p=!1:d&&f!=null&&f!==""?k=l.entries.updateEntry({deprecatedMms3Url:_,mediaKey:f,mediaKeyTimestamp:g,encFilehash:h,type:E,sidecar:C,directPath:v,firstFrameSidecar:b,scansSidecar:S,scanLengths:R,staticUrl:L}):!d&&c!=null&&(k=l.entries.updateUnencryptedEntry({filehash:c,directPath:v})),k||(p=!1),p&&l.downloadStage===o("WAWebMediaTypes").DownloadStage.ERROR_MISSING&&(i.downloadStage=o("WAWebMediaTypes").DownloadStage.INIT)}if(l.consolidate(i)||l.notifyMsgsAsync(),p&&l.downloadStage===o("WAWebMediaTypes").DownloadStage.NEED_POKE){var I;try{I=o("WAWebMmsMediaTypes").getMsgMediaType(e)}catch(n){if(!t.type)throw n;I=o("WAWebMmsMediaTypes").msgToMediaType({type:t.type,isGif:e.isGif,isNewsletter:o("WAWebMsgGetters").getIsNewsletterMsg(e)})}o("WAWebMediaMmsV4Download").downloadMedia({mimetype:t.mimetype,mediaObject:l,downloadEvenIfExpensive:!1,mediaType:I,rmrReason:n,downloadOrigin:r("WAWebMediaGetDownloadOriginForMsg")(e),chatWid:a})}}l.consolidateMediaUpdate=c,l.consolidateMediaUpdateWithValues=d}),98);
__d("WAWebDownloadProgressiveJpegThumbnail",["WAAbortError","WALogger","WANullthrows","WAWebDownloadManager","WAWebMediaOpaqueData","WAWebMmsMediaTypes","WAWebSerializeError","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.msg,a=t.chat,i=t.isPreload,l=t.signal;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["media.downloadProgressiveJpegThumbnail: start"])));try{var d,m=(d=r("WANullthrows"))(n.scanLengths),p=d(n.scansSidecar),_=d(n.mediaObject),f=d(_.filehash),g=n.encFilehash,h=n.directPath,y=yield o("WAWebDownloadManager").downloadManager.downloadAndMaybeDecrypt({directPath:h,encFilehash:g,filehash:f,mediaKey:n.mediaKey,mediaKeyTimestamp:n.mediaKeyTimestamp,type:o("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE,signal:l||new AbortController().signal,userDownloadAttemptCount:0,progressiveJpegOpts:{mimetype:"image/jpeg",scansSidecar:p,scanLengths:m,scanCount:1},isPreload:i,chatWid:a==null?void 0:a.id});_.consolidate({fullPreviewData:yield r("WAWebMediaOpaqueData").createFromData(y,"image/jpeg")}),o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["media.downloadProgressiveJpegThumbnail: success"])))}catch(e){if(e.name===o("WAAbortError").ABORT_ERROR){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["media.downloadProgressiveJpegThumbnail aborted"])));return}o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["media.downloadProgressiveJpegThumbnail: error\n",""],["media.downloadProgressiveJpegThumbnail: error\\n",""])),r("WAWebSerializeError")(e)).sendLogs("download-pjpeg-thumbnail-failed")}}),m.apply(this,arguments)}l.downloadProgressiveJpegThumbnail=d}),98);
__d("WAWebDownloadStatusThumbnail",["WAWebDownloadProgressiveJpegThumbnail","WAWebDownloadVideoThumbnail","WAWebMediaDownloadMmsThumbnail","WAWebMsgType","WAWebStatusGatingUtils","asyncToGeneratorRuntime","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.msg,n=e.isPreload,a=e.signal,i=t.encFilehash,l=t.thumbnailSha256,s=t.thumbnailEncSha256,u=t.thumbnailDirectPath;if(t.type===o("WAWebMsgType").MSG_TYPE.IMAGE&&t.scanLengths&&t.scansSidecar&&i){yield o("WAWebDownloadProgressiveJpegThumbnail").downloadProgressiveJpegThumbnail({msg:t,signal:a,isPreload:n});return}else if(t.type===o("WAWebMsgType").MSG_TYPE.VIDEO&&t.isGif!==!0&&o("WAWebStatusGatingUtils").isUpdatesTabInNavigationBarEnabled()){yield o("WAWebDownloadVideoThumbnail").downloadVideoThumbnail({msg:t});return}if(!r("isStringNullOrEmpty")(l)&&!r("isStringNullOrEmpty")(s)&&!r("isStringNullOrEmpty")(u)){yield r("WAWebMediaDownloadMmsThumbnail")({msg:t,signal:a,isPreload:n,chat:null});return}}),s.apply(this,arguments)}l.downloadStatusThumbnail=e}),98);
__d("WAWebDownloadVideoThumbnail",["WALogger","WANullthrows","WAPromiseLoop","WAWebDownloadManager","WAWebImageUtils","WAWebMediaConstants","WAWebMediaCryptoEligibilityUtils","WAWebMediaOpaqueData","WAWebMiscErrors","WAWebMmsMediaTypes","WAWebMsgGetters","WAWebMsgModelPropUtils","WAWebSerializeError","WAWebURLUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m=1,p=1.5;function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=t.msg,a=t.chat;return yield o("WAPromiseLoop").promiseLoop((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,i){try{var l=Math.max(parseInt(r.mediaData.duration,10),1),s={video:{size:r.mediaData.size,duration:l},secondsToDownload:i===0?m:p},u=yield o("WAWebDownloadManager").downloadManager.downloadAndMaybeDecrypt({directPath:r.directPath,encFilehash:r.encFilehash,filehash:r.filehash,mediaKey:r.mediaKey,mediaKeyTimestamp:r.mediaKeyTimestamp,type:o("WAWebMsgGetters").getIsNewsletterMsg(r)?o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_VIDEO:o("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO,signal:new AbortController().signal,userDownloadAttemptCount:0,partialVideoOpts:s,isPreload:!0,chatWid:a==null?void 0:a.id}),c=new Blob([u],{type:"video/mp4"}),d=yield o("WAWebImageUtils").generateVideoThumbsAndDuration({file:c,maxDimensions:[o("WAWebMediaConstants").VIDEO_THUMB_MAX_EDGE],debugHint:"downloadVideoThumbnail",throwOnBlack:!0}),_=d.thumbs,f=_[0];t(f)}catch(t){if(a==null&&t instanceof o("WAWebMiscErrors").UnableToPlayVideoError&&i===0){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["media.generateThumbnailFromVideo: retrying due to UnableToPlayVideoError"])));return}throw t}});return function(e,n,r){return t.apply(this,arguments)}})(),void 0)}),f.apply(this,arguments)}function g(e){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.msg,n=e.chat;if(o("WAWebMsgModelPropUtils").isTrusted(t.unsafe())&&(n==null?void 0:n.isSuspendedOrTerminated())!==!0){var a=t.encFilehash,i=t.filehash,l=t.directPath;if(!(!i||!l)&&!(o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMsg(t)&&!a)){var m=t.mediaData,p=m.fullPreviewData,f=m.fullWidth,g=m.fullHeight;if(!(p&&f!=null&&g!=null)){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["media.downloadVideoThumbnail: start"])));try{var h=yield _({msg:t,chat:n}),y=yield r("WAWebMediaOpaqueData").createFromBase64Jpeg(r("WAWebURLUtils").parseDataURL(h.url).data),C=r("WANullthrows")(t.mediaObject,"mediaObject cannot be null for thumbnail download"),b={fullPreviewData:y,fullWidth:h.fullWidth,fullHeight:h.fullHeight};C.consolidate(b),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["media.downloadVideoThumbnail: success"])))}catch(e){if(e instanceof o("WAWebImageUtils").BlackVideoThumbnailError){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["media.downloadVideoThumbnail: black thumbnail was generated, fallback to blurred thumbnail"])));return}o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["media.downloadVideoThumbnail: error\n",""],["media.downloadVideoThumbnail: error\\n",""])),r("WAWebSerializeError")(e)).verbose()}}}}}),h.apply(this,arguments)}l.downloadVideoThumbnail=g}),98);
__d("WAWebManuallySetMedia",["WAWebMediaGetDownloadOriginForMsg","WAWebMediaMmsV4Download","WAWebMediaOpaqueData","WAWebMmsMediaTypes"],(function(t,n,r,o,a,i,l){function e(e){var t=e.msg,n=e.media,a=e.rmrReason,i=e.chatWid,l=t.mediaObject;l&&r("WAWebMediaOpaqueData").createFromData(n,t.mimetype).then(function(e){o("WAWebMediaMmsV4Download").manuallySetMedia({mimetype:t.mimetype,mediaObject:l,mediaBlob:e,mediaType:o("WAWebMmsMediaTypes").getMsgMediaType(t),rmrReason:a,downloadOrigin:r("WAWebMediaGetDownloadOriginForMsg")(t),chatWid:i})})}l.manuallySetMedia=e}),98);
__d("WAWebMediaCancelDownloadMsg",["WALogger","WAWebMediaMmsV4Download"],(function(t,n,r,o,a,i,l){var e;function s(e){o("WAWebMediaMmsV4Download").cancelDownloadMedia(e)}function u(t){t.mediaObject?s(t.mediaObject):t.mediaObject||o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),t.id.toString(),t.type).devConsole(t).sendLogs("media-fault: cancelDownloadMsg msg without mediaObject")}l.cancelDownloadMedia=s,l.cancelDownloadMsg=u}),98);
__d("WAWebMediaCancelUploadMsg",["WALogger","WAWebMediaMmsV4Upload"],(function(t,n,r,o,a,i,l){var e;function s(e){o("WAWebMediaMmsV4Upload").cancelUploadMedia(e)}function u(t){t.mediaObject?s(t.mediaObject):o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),t.id.toString(),t.type).devConsole(t).sendLogs("media-fault: cancelUploadMsg msg without mediaObject")}l.cancelUploadMedia=s,l.cancelUploadMsg=u}),98);
__d("WAWebMediaDownloadMsg",["Promise","WALogger","WAWebMediaGetDownloadOriginForMsg","WAWebMediaMmsV4Download","WAWebMmsMediaTypes","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(t){var a=t.msg,i=t.isUserClick,l=t.mode,u=t.downloadEvenIfExpensive,c=t.rmrReason,d=t.rmrData,m=t.isAutoDownload,p=t.chatWid,_=t.shouldSequenceDownload,f=a.mediaObject;if(f){var g=f.getPendingProcess("fromDisk");return g.then(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){i&&f.userDownloadAttemptCount++,yield o("WAWebMediaMmsV4Download").downloadMedia({mimetype:a.mimetype,mediaObject:f,downloadEvenIfExpensive:u,mediaType:o("WAWebMmsMediaTypes").getMsgMediaType(a),rmrReason:c,rmrData:d,downloadOrigin:r("WAWebMediaGetDownloadOriginForMsg")(a),isVcardOverMmsDocument:a.isVcardOverMmsDocument,mode:l,isAutoDownload:m,isViewOnce:!!a.isViewOnce,chatWid:p,shouldSequenceDownload:_}),f.userDownloadAttemptCount=0}))}return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),a.id.toString(),a.type).devConsole(a).sendLogs("media-fault: downloadMsg msg without mediaObject"),(s||(s=n("Promise"))).resolve()}l.downloadMsg=u}),98);
__d("WAWebMediaFastForwardUtils",[],(function(t,n,r,o,a,i){"use strict";function e(e){var t=e.id;return!t.isPSA()&&!t.isCAPISupportAccount()&&!t.isBot()&&!t.isHosted()&&!t.isNewsletter()&&!e.isEnterprise}i.canEnableFastForward=e}),66);
__d("WAWebWamEnumStickerSendMessageType",[],(function(t,n,r,o,a,i){var e=Object.freeze({REGULAR:1,PAYMENTS:2});i.STICKER_SEND_MESSAGE_TYPE=e}),66);
__d("WAWebWamEnumStickerSendOriginType",[],(function(t,n,r,o,a,i){var e=Object.freeze({STICKER_SEARCH:1,FORWARD:2,STICKER_PICKER_TAB_RECENTS:3,STICKER_PICKER_TAB_FAVORITES:4,STICKER_PICKER_TAB_EMOTION:5,STICKER_PICKER_TAB_PACK:6,STICKER_PICKER_TAB_CONTEXTUAL_SUGGESTIONS:7,STICKER_MAKER:8,STICKER_STORE:9,AI_STICKER_CREATE:10,AI_STICKER_CREATE_TRAY:11,AI_STICKER_CREATE_CHAT:12,STATUS_QUICK_REPLY:13,DISCOVERY_PACK:14,STICKER_FROM_DEVICE_KEYBOARD:15,STICKER_PACK_INFO:16,CONVERSATION_STARTER:17,STICKER_SEARCH_TRENDING:18});i.STICKER_SEND_ORIGIN_TYPE=e}),66);
__d("WAWebStickerSendWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumStickerMakerSourceType","WAWebWamEnumStickerSendMessageType","WAWebWamEnumStickerSendOriginType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({StickerSend:[1840,{stickerIsAi:[7,e.TYPES.BOOLEAN],stickerIsAnimated:[3,e.TYPES.BOOLEAN],stickerIsAvatar:[6,e.TYPES.BOOLEAN],stickerIsFirstParty:[2,e.TYPES.BOOLEAN],stickerIsFromStickerMaker:[5,e.TYPES.BOOLEAN],stickerIsFromUserCreatedPack:[12,e.TYPES.BOOLEAN],stickerIsGiphy:[10,e.TYPES.BOOLEAN],stickerIsKlipy:[13,e.TYPES.BOOLEAN],stickerIsLottie:[9,e.TYPES.BOOLEAN],stickerIsTenor:[11,e.TYPES.BOOLEAN],stickerIsText:[14,e.TYPES.BOOLEAN],stickerMakerSourceType:[8,o("WAWebWamEnumStickerMakerSourceType").STICKER_MAKER_SOURCE_TYPE],stickerSendMessageType:[4,o("WAWebWamEnumStickerSendMessageType").STICKER_SEND_MESSAGE_TYPE],stickerSendOrigin:[1,o("WAWebWamEnumStickerSendOriginType").STICKER_SEND_ORIGIN_TYPE]},[1,1,1],"regular"]},{StickerSend:[]});l.StickerSendWamEvent=s}),98);
__d("WAWebMediaForwardMediaMsg",["Promise","WALogger","WAWebABProps","WAWebFrontendMsgGetters","WAWebGetNewsletterContextForForwardedMsg","WAWebMediaFastForwardUtils","WAWebMediaOpaqueData","WAWebMediaPrep","WAWebMediaTypes","WAWebMsgGetters","WAWebStickerSendWamEvent","WAWebWamEnumStickerSendOriginType","WAWebWebpMetadata","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e,t,n,r){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i,l){var c,d,m,p,_,f,g,h,y,C;i===void 0&&(i=!1),l===void 0&&(l=!1),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Prepping media msg"]))).devConsole(t);var b=t.mediaObject;if(!b)return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),t.id.toString(),t.type).devConsole(t).sendLogs("media-fault: forwardMediaMsg msg without mediaObject"),(u||(u=n("Promise"))).reject(r("err")("non initialized media"));var v=t.mediaData.toJSON();v.preview!=null&&(v.preview=b.contentInfo._preview),v.mediaBlob instanceof r("WAWebMediaOpaqueData")&&v.mediaBlob.retain();var S={mimetype:v.mimetype},R=v.isGif?babelHelpers.extends({},S,{isGif:!0}):S;v.type===o("WAWebMediaTypes").OUTWARD_TYPES.PTT&&!o("WAWebMsgGetters").getHasOriginatedFromNewsletter(t)&&(v.type=o("WAWebMediaTypes").OUTWARD_TYPES.AUDIO);var L={businessOwnerJid:t.businessOwnerJid,productId:t.productId,currencyCode:t.currencyCode,priceAmount1000:t.priceAmount1000,salePriceAmount1000:t.salePriceAmount1000,retailerId:t.retailerId,url:t.url,productImageCount:t.productImageCount,title:t.title,description:t.description},E=v.type===o("WAWebMediaTypes").OUTWARD_TYPES.DOCUMENT&&(t.isFromTemplate||t.isDynamicReplyButtonsMsg),k=E||v.type===o("WAWebMediaTypes").OUTWARD_TYPES.PRODUCT?t.caption:void 0;l&&(v.type===o("WAWebMediaTypes").OUTWARD_TYPES.IMAGE||v.type===o("WAWebMediaTypes").OUTWARD_TYPES.VIDEO||v.type===o("WAWebMediaTypes").OUTWARD_TYPES.DOCUMENT||v.type===o("WAWebMediaTypes").OUTWARD_TYPES.STICKER_PACK)&&(k=t.caption);var I=o("WAWebMediaFastForwardUtils").canEnableFastForward(a.contact),T=o("WAWebMediaFastForwardUtils").canEnableFastForward(o("WAWebFrontendMsgGetters").getChat(t).contact),D={forwardedFromWeb:!0,canEnableFastForward:I&&T,caption:k,type:t.type,mentionedJidList:t.mentionedJidList,groupMentions:t.groupMentions,footer:v.type===o("WAWebMediaTypes").OUTWARD_TYPES.PRODUCT?t.footer:void 0,addEvenWhilePreparing:!0,placeholderProps:R,isForwarded:o("WAWebMsgGetters").getShouldDisplayAsForwarded(t),forwardingScore:t.getForwardingScoreWhenForwarded(),multicast:i,productMsgOptions:L,isAvatar:(c=t.isAvatar)!=null?c:!1,forwardedNewsletterMessageInfo:o("WAWebGetNewsletterContextForForwardedMsg").getNewsletterContextForForwardedMsg(t),stickers:(d=t.stickers)!=null?d:void 0,publisher:(m=t.stickerPackPublisher)!=null?m:void 0,fileLength:(p=t.size)!=null?p:void 0,description:v.type===o("WAWebMediaTypes").OUTWARD_TYPES.STICKER_PACK&&t.description!=null?t.description:"",stickerPackId:(_=t.stickerPackId)!=null?_:void 0,thumbnailDirectPath:(f=t.thumbnailDirectPath)!=null?f:void 0,thumbnailSha256:(g=t.thumbnailSha256)!=null?g:void 0,thumbnailEncSha256:(h=t.thumbnailEncSha256)!=null?h:void 0,trayIconFileName:(y=t.trayIconFileName)!=null?y:void 0,stickerPackSize:(C=t.stickerPackSize)!=null?C:void 0},x=yield new(o("WAWebMediaPrep")).MediaPrep(v.type,(u||(u=n("Promise"))).resolve(v)).sendToChat(a,o("WAWebGetNewsletterContextForForwardedMsg").maybeStripNewsletterForwardMetadata({forwardable:D,destination:a.id,source:t.id.remote,isOriginalMsgForwarded:t.isForwarded,isQuestionOrQuestionReply:t.isQuestion||t.questionReplyQuotedMessage!=null}));if(v.type===o("WAWebMediaTypes").OUTWARD_TYPES.STICKER){var $,P,N,M,w={stickerSendOrigin:o("WAWebWamEnumStickerSendOriginType").STICKER_SEND_ORIGIN_TYPE.FORWARD,stickerIsAnimated:!!(($=t.mediaData)!=null&&$.isAnimated),stickerIsFirstParty:!!((P=t.mediaData)!=null&&P.isFirstParty),stickerIsFromStickerMaker:!!((N=t.mediaData)!=null&&N.isFromStickerMaker)};if(o("WAWebABProps").getABPropConfigValue("gimmick_phase_two_logging_enabled")){var A;w=babelHelpers.extends({},w,{stickerIsLottie:!!((A=t.mediaData)!=null&&A.isLottie)})}var F=new(o("WAWebStickerSendWamEvent")).StickerSendWamEvent(w),O=o("WAWebWebpMetadata").getStickerMakerSourceType((M=t.mediaData)==null?void 0:M.stickerMakerSourceType);O!=null&&(F.stickerMakerSourceType=O),F.commit()}return x}),d.apply(this,arguments)}l.forwardMediaMsg=c}),98);
__d("WAWebMediaGetDownloadOriginForMsg",["WAWebFrontendChatGetters","WAWebFrontendMsgGetters","WAWebMsgGetters","WAWebWamEnumDownloadOriginType"],(function(t,n,r,o,a,i,l){function e(e){if(o("WAWebFrontendMsgGetters").getAsProduct(e))return o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.PRODUCT_CATALOG;if(o("WAWebMsgGetters").getIsStatus(e))return o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.STATUS_USER;if(o("WAWebMsgGetters").getIsGroupMsg(e)){var t=o("WAWebFrontendMsgGetters").getChat(e);return t!=null&&o("WAWebFrontendChatGetters").getIsCAG(t)?o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.COMMUNITY:o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHAT_GROUP}return o("WAWebMsgGetters").getIsNewsletterMsg(e)?o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHANNEL:o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHAT_PERSONAL}l.default=e}),98);
__d("WAWebMediaMsgRegistration",["Promise","WALogger","WAWebConsolidateMediaUpdate","WAWebLidStatusMigrationGating","WAWebMediaDataUtils","WAWebMediaOpaqueData","WAWebMediaStorage","WAWebMediaTypes","WAWebWamEnumWebcRmrReasonCode"],(function(t,n,r,o,a,i,l){var e,s,u,c="change:ack "+o("WAWebMediaTypes").MEDIA_MSG_PROPS.map(function(e){return"change:"+e}).join(" ");function d(e){o("WAWebConsolidateMediaUpdate").consolidateMediaUpdate(e,o("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.MSG_UPDATE)}function m(e){e.off(null,d);var t=e.mediaObject;t&&o("WAWebMediaStorage").disassociateMediaFromMsg(t,e)}function p(e){!e.mimetype&&e.type===o("WAWebMediaTypes").OUTWARD_TYPES.IMAGE&&(e.mimetype="image/jpeg"),!e.mimetype&&e.type===o("WAWebMediaTypes").OUTWARD_TYPES.STICKER&&(e.mimetype="image/webp"),e.on(c,d),o("WAWebConsolidateMediaUpdate").consolidateMediaUpdate(e,o("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.MSG_INIT)}function _(t,n){t.isUnsentPhoneMsg()&&o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),t.id.toString(),t.type).devConsole(t).sendLogs("media-fault: registerMsgEarly msg without mediaObject");for(var r={},a=0;a<o("WAWebMediaTypes").MEDIA_MSG_PROPS.length;a++){var i=o("WAWebMediaTypes").MEDIA_MSG_PROPS[a],l=n[i];r[i]=l!==void 0?l:t[i]}!r.mimetype&&r.type===o("WAWebMediaTypes").OUTWARD_TYPES.IMAGE&&(n.mimetype=r.mimetype="image/jpeg"),t.on(c,d),o("WAWebConsolidateMediaUpdate").consolidateMediaUpdateWithValues(t,r,o("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.MSG_UPDATE);for(var s={},u=0;u<o("WAWebMediaTypes").MSG_SPECIFIC_FIELDS.length;u++){var m=o("WAWebMediaTypes").MSG_SPECIFIC_FIELDS[u];s[m]=r[o("WAWebMediaTypes").MEDIA_TO_MSG[m]]}t.mediaData.set(s)}function f(e){var t=e.mediaObject;if(t)return t.resolveWhenConsolidated();var a=e.mediaData;e.mediaData==null&&o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["prepareMsg: no media data v2. key: "," type: "," subtype: ",", is status migrated: ",""])),e.id.toString(),e.type,e.subtype,o("WAWebLidStatusMigrationGating").getLidStatusSendEnabled());var i=a.preview;return i instanceof r("WAWebMediaOpaqueData")&&a.aspectRatio===void 0&&(a.fullWidth===void 0||a.fullHeight===void 0)?o("WAWebMediaDataUtils").getImageWidthHeight(i).then(function(t){var n=t.width,r=t.height;e.mediaObject||e.mediaData.set({aspectRatio:n/r})}):(u||(u=n("Promise"))).resolve()}l.deregisterMsg=m,l.registerMsg=p,l.registerMsgEarly=_,l.prepareMsg=f}),98);
__d("WAWebMediaResumeUploadMsg",["Promise","WALogger","WAWebAck","WAWebFrontendMsgGetters","WAWebMediaEntry","WAWebMediaGetUploadOriginForChat","WAWebMediaInMemoryKeyCache","WAWebMediaMmsV4Upload","WAWebMediaUpdateMsg","WAWebMmsMediaTypes","WAWebMsgGetters","WAWebNewsletterSendMsgAction","WAWebSendMsgChatAction","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s;function u(t){var a,i=t.mediaObject;if(!i)return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),t.id.toString(),t.type).devConsole(t).sendLogs("media-fault: resumeUploadMsg msg without mediaObject"),(s||(s=n("Promise"))).resolve();i.userUploadAttemptCount++;var l=i.filehash,u=o("WAWebMediaInMemoryKeyCache").shouldUseMediaKeyCache()&&l!=null&&(a=o("WAWebMediaInMemoryKeyCache").MediaKeyCache.get(l))!=null?a:void 0;t.ack=o("WAWebAck").ACK.CLOCK;var c=o("WAWebMsgGetters").getIsNewsletterMsg(t)?o("WAWebMediaMmsV4Upload").uploadUnencryptedMedia:o("WAWebMediaMmsV4Upload").uploadMedia,d=c({mimetype:t.mimetype,mediaObject:i,mediaKeyInfo:u,mediaType:o("WAWebMmsMediaTypes").getMsgMediaType(t),forwardedFromWeb:!!t.forwardedFromWeb,uploadOrigin:r("WAWebMediaGetUploadOriginForChat")(o("WAWebFrontendMsgGetters").getChat(t)),isViewOnce:!!t.isViewOnce}).then((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n=e.mediaEntry;if(o("WAWebMediaInMemoryKeyCache").shouldUseMediaKeyCache()&&l!=null&&o("WAWebMediaInMemoryKeyCache").MediaKeyCache.delete(l),!n)throw r("err")("upload failed: media entry was not created");i.userUploadAttemptCount=0;var a={deprecatedMms3Url:n.deprecatedMms3Url,directPath:n.directPath,filehash:i.filehash,size:i.size,streamingSidecar:n.sidecar,firstFrameSidecar:n.firstFrameSidecar};return n instanceof o("WAWebMediaEntry").EncryptedMediaEntry?(a.mediaKey=n.mediaKey,a.mediaKeyTimestamp=n.mediaKeyTimestamp,a.encFilehash=n.encFilehash):n instanceof o("WAWebMediaEntry").UnencryptedMediaEntry&&(a.mediaHandle=n.handle),yield r("WAWebMediaUpdateMsg")(t,a),t});return function(t){return e.apply(this,arguments)}})()),m=o("WAWebMsgGetters").getIsNewsletterMsg(t)?o("WAWebNewsletterSendMsgAction").sendNewsletterMediaMsg(o("WAWebFrontendMsgGetters").getChat(t),t,function(){return d}):o("WAWebSendMsgChatAction").resendMsgToChat(o("WAWebFrontendMsgGetters").getChat(t),d);return m.catch(function(){t.ack=o("WAWebAck").ACK.FAILED})}l.resumeUploadMsg=u}),98);
__d("WAWebMediaStickers",["Promise","WAFilteredCatch","WALogger","WAWebDownloadManager","WAWebMediaEntry","WAWebMediaMmsV4Download","WAWebMediaPrep","WAWebMediaStorage","WAWebMediaTypes","WAWebMiscErrors","WAWebMmsMediaTypes","WAWebRecentStickerCollectionMd","WAWebWamEnumDownloadOriginType","WAWebWamEnumWebcRmrReasonCode","asyncToGeneratorRuntime","err","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_=125;function f(e){var t={};return o("WAWebMediaTypes").MAPPED_STICKER_PROPS.forEach(function(n){var r=e[n],a=o("WAWebMediaTypes").MSG_TO_MEDIA[n];t[a]=r}),t}function g(t){if(!t.filehash){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Unexpected sticker with no filehash"]))).devConsole(t).sendLogs("sticker-filehash-error");return}var n=o("WAWebMediaStorage").getOrCreateMediaObject(t.filehash);return o("WAWebMediaStorage").associateMediaWithSticker(n,t),n}function h(e){if(!e.filehash){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Unexpected sticker pack with no filehash"]))).devConsole(e).sendLogs("sticker-pack-filehash-error");return}var t=o("WAWebMediaStorage").getOrCreateMediaObject(e.filehash);return o("WAWebMediaStorage").associateMediaWithStickerPack(t,e),t}function y(e,t,n,a){var i=f(e);if(e.mediaData.set(i),!!t){e.mediaObject=t;var l=e.deprecatedMms3Url,s=e.encFilehash;if(!r("gkx")("26258")&&!s&&l&&o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["encFileHash missing from sticker "," but deprecatedMms3Url exists"])),a?"pack tray icon":"").devConsole(e).sendLogs("sticker-"+(a?"icon-":"")+"missing-upload-hash-but-url-exists"),(s||l)&&!t.entries.has({encFilehash:s,deprecatedMms3Url:l})){var c=t.entries.addEntry({deprecatedMms3Url:l,mediaKey:e.mediaKey,mediaKeyTimestamp:e.mediaKeyTimestamp,encFilehash:s,type:n,directPath:e.directPath,debugHint:"setMediaObjectValues"});c&&t.downloadStage===o("WAWebMediaTypes").DownloadStage.ERROR_MISSING&&(i.downloadStage=o("WAWebMediaTypes").DownloadStage.INIT)}t.consolidate(i)}}function C(e){y(e,e.mediaObject||g(e),o("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER,!1)}function b(e){var t=e.mediaObject;t&&o("WAWebMediaStorage").disassociateMediaFromSticker(t,e)}function v(e){y(e,e.mediaObject||h(e),o("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE,!0)}function S(e){var t=e.mediaObject;t&&o("WAWebMediaStorage").disassociateMediaFromStickerPack(t,e)}function R(e,t,n){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a){if(a===void 0&&(a=!0),e.isPlaceholder||e.isCreateButton)return e.mediaData.mediaStage=o("WAWebMediaTypes").MediaDataStage.PREPARING,(p||(p=n("Promise"))).resolve();var i=e.mediaObject;if(!i)return(p||(p=n("Promise"))).reject(r("err")("media-fault: downloadStickerOrStickerPackIcon sticker/stickerPack without mediaObject"));var l=t==="STICKER"?o("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.STICKER_PANEL_STICKER:o("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.STICKER_PANEL_ICON,s=!1;yield i.getPendingProcess("fromDisk").then(function(){if(!e.filehash||!e.mediaKey||!e.encFilehash)return s=!0,o("WAWebDownloadManager").downloadManager.rmr({mediaObject:i,signal:new AbortController().signal,rmrReason:l})}).then(function(){return o("WAWebMediaMmsV4Download").downloadMedia({mimetype:e.mimetype,mediaObject:e.mediaObject,downloadEvenIfExpensive:!0,mediaType:o("WAWebMmsMediaTypes").msgToMediaType({type:e.type,isGif:!1,isNewsletter:!1}),rmrReason:l,downloadOrigin:o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.STICKER_PICKER,shouldThrow:a})}).catch(o("WAFilteredCatch").filteredCatch(o("WAWebMiscErrors").RMRNotSupportedOnNewsletterMessagesError,function(t){if(t.mediaType!==o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER)throw o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Unexpected RMR error for media type ",""])),t.mediaType).devConsole(e,t).sendLogs("failed-to-download-sticker-rmr"),t}));var u=i.entries.getDownloadEntry(!0);s&&u instanceof o("WAWebMediaEntry").EncryptedMediaEntry&&o("WAWebRecentStickerCollectionMd").RecentStickerCollectionMd.updateStickerMediaData(e.filehash,u)}),L.apply(this,arguments)}function E(e){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Prepping sticker"]))).devConsole(e);var t=e.mediaObject,a=e.mediaData.toJSON();return a.fullWidth=_,a.fullHeight=_,t?new(o("WAWebMediaPrep")).MediaPrep(a.type,(p||(p=n("Promise"))).resolve(a)):(o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["id: ",""])),e.id).sendLogs("media-fault: prepSticker sticker without mediaObject"),new(o("WAWebMediaPrep")).MediaPrep(a.type,(p||(p=n("Promise"))).reject(r("err")("non initialized media"))))}l.registerSticker=C,l.deregisterSticker=b,l.registerStickerPackIcon=v,l.deregisterStickerPackIcon=S,l.downloadStickerOrStickerPackIcon=R,l.prepSticker=E}),98);
__d("WAWebPrepRawMedia",["Promise","WALogger","WAWebMediaPrep","WAWebMediaTypes","WAWebProcessRawMedia"],(function(t,n,r,o,a,i,l){var e,s;function u(t,r){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Prepping raw media"])));var a;r.isPtt===!0?a=o("WAWebMediaTypes").OUTWARD_TYPES.PTT:r.asDocument===!0?a=o("WAWebMediaTypes").OUTWARD_TYPES.DOCUMENT:r.asGif===!0?a=o("WAWebMediaTypes").OUTWARD_TYPES.VIDEO:r.isAudio===!0?a=o("WAWebMediaTypes").OUTWARD_TYPES.AUDIO:r.asSticker===!0?a=o("WAWebMediaTypes").OUTWARD_TYPES.STICKER:r.asStickerPack===!0?a=o("WAWebMediaTypes").OUTWARD_TYPES.STICKER_PACK:a=o("WAWebMediaTypes").OUTWARD_TYPES.UNKNOWN;var i=(s||(s=n("Promise"))).resolve(t).then(function(e){return e.autoreleaseWhenPromiseCompletes(i),o("WAWebProcessRawMedia").processRawMedia(e,r)});return new(o("WAWebMediaPrep")).MediaPrep(a,i)}l.prepRawMedia=u}),98);
__d("WAWebCryptoCalculateFilehash",["WALogger","WAMediaCalculateFilehash","WAWebFileUtils","WAWebMediaDataUtils","WAWebMediaOpaqueData","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){try{var n;return t instanceof r("WAWebMediaOpaqueData")?n=yield o("WAWebMediaDataUtils").opaqueDataToArrayBuffer(t):n=yield o("WAWebFileUtils").blobToArrayBuffer(t),yield o("WAMediaCalculateFilehash").calculateFilehash(n)}catch(n){var a=t instanceof r("WAWebMediaOpaqueData"),i=t instanceof r("WAWebMediaOpaqueData")?t.size():t.size;o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["calculateFilehashFromBlob failed: ",", size:",", isOpaqueData:",""])),n,i,a).sendLogs("calculate-filehash-from-blob-error");return}}),u.apply(this,arguments)}l.calculateFilehashFromBlob=s}),98);
__d("WAWebCryptoImageStreamer",["Promise","WAAlignChunkLengthsToMultipleOfAesBlockSize","WAArrayBufferUtils","WAArrayBuffersConcat","WACrypto","WACryptoAesCbc","WACryptoHmac","WACryptoUtils","WACustomError","WALogger","WANullthrows","WATypedArraysConcat","WAWebMediaInMemoryBlobCache","WAWebPromiseQueue","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f=(function(e){function t(t){return e.call(this,"Chunk "+t+" does not match sidecar")||this}return babelHelpers.inheritsLoose(t,e),t})(o("WACustomError").customError("ChunkValidationError")),g=10,h=16,y=new Uint8Array([2,2]),C=new Uint8Array([255,217]),b=(function(){function t(e){var t;this._alignedScanLengths=[],this._increasingScanLengths=[],this._lastDecryptedChunk=0,this._promiseQueue=new(o("WAWebPromiseQueue")).PromiseQueue,this._downloadedBytes=new ArrayBuffer(0);var n=e.cryptoKeys,r=e.scanLengths,a=e.scansSidecar,i=e.filehash,l=e.mimetype,s=e.debugString,u=e.onProgressiveUpdate;this._cryptoKeys=n,this._scanLengths=r,this._scansSideCar=a,this._filehash=i,this._mimetype=l,this._nextChunkIV=(t=this._cryptoKeys)==null?void 0:t.iv,this._decryptedChunks=new Array(r.length),this._onProgressiveUpdate=u,this._debugString=s}var a=t.prototype;return a.setCryptoKeys=function(t){this._cryptoKeys=t,this._nextChunkIV=t.iv},a._validateSidecar=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){t===0&&(this._nextChunkIV=n.iv);var a=n.macKey,i=this._scansSideCar.slice(t*g,t*g+g),l=r("WANullthrows")(this._nextChunkIV);this._nextChunkIV=e.slice(0-h);var s=o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[new Uint8Array(l),new Uint8Array(e)]),u=yield o("WACryptoHmac").hmacSha256(a,s,g);if(!o("WACryptoUtils").arrayBuffersEqual(u,i))throw new f(t)});function t(t,n,r){return e.apply(this,arguments)}return t})(),a._cleanupCipherTextAndIV=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=e,a=t===0,i=r.byteLength%h===0,l=!i,s;if(a)s=n.iv;else{var u=this._increasingScanLengths[t-1];s=this._downloadedBytes.slice(u-h,u)}if(l&&(r=r.slice(0,r.byteLength-g)),i){var c=yield v(r,n);return{cipherText:o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[new Uint8Array(r),new Uint8Array(c)]),iv:s}}return{cipherText:r,iv:s}});function t(t,n,r){return e.apply(this,arguments)}return t})(),a._getLastFullyLoadedChunkIndex=function(t){for(var e=0,n=0;n<this._alignedScanLengths.length;n++)if(e+=this._alignedScanLengths[n],t<e)return n;return this._alignedScanLengths.length},a._handleChunk=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){yield this._validateSidecar(t,n,r);var a=yield this._cleanupCipherTextAndIV(t,n,r),i=a.cipherText,l=a.iv,s=yield o("WACryptoAesCbc").aesCbcDecrypt(r.encKey,l,i),u=yield o("WACrypto").removeEncryptedPadding(s,y.buffer);return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["ImageStreamer: [","] Successfully decrypted chunk "," of "," total"])),this._debugString,n+1,this._scanLengths.length).devConsole({filehash:this._filehash}),u});function r(e,n,r){return t.apply(this,arguments)}return r})(),a._generateBlobFromFullyLoadedChunks=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,r=yield(_||(_=n("Promise"))).all(this._decryptedChunks.slice(0,e)),a=this._scanLengths.slice(0,e).reduce(function(e,t){return e+t},0),i=o("WATypedArraysConcat").concatTypedArrays(Uint8Array,r.map(function(e){return new Uint8Array(e)})).slice(0,a),l=o("WACryptoUtils").arrayBuffersEqual(C.buffer,i.slice(-C.length).buffer)?i:o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[i,C]),u=[l],c=this._mimetype!=null?new Blob(u,{type:this._mimetype}):new Blob(u),d=R(this._filehash,e);return o("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.put(d,c),o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["ImageStreamer: [","] Generated progressive image using "," chunks of "," total"])),this._debugString,e,this._scanLengths.length).devConsole({filehash:this._filehash}),(t=this._onProgressiveUpdate)==null||t.call(this,e),this._lastDecryptedChunk=e,l.buffer});function t(t){return e.apply(this,arguments)}return t})(),a._decryptFullyLoadedChunks=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){for(var o=0;o<t;o++)if(!this._decryptedChunks[o]){var a=o===0?0:this._increasingScanLengths[o-1],i=e.slice(a,a+this._alignedScanLengths[o]);yield(_||(_=n("Promise"))).all(this._decryptedChunks),this._decryptedChunks[o]||(this._decryptedChunks[o]=this._handleChunk(i,o,r))}});function t(t,n,r){return e.apply(this,arguments)}return t})(),a.handleProgress=function(t,r){var e=this;return this._promiseQueue.enqueue(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!e._alignedScanLengths.length){e._alignedScanLengths=o("WAAlignChunkLengthsToMultipleOfAesBlockSize").alignChunkLengthsToMultipleOfAesBlockSize(e._scanLengths,t);for(var n=0;n<e._alignedScanLengths.length;n++){var a=e._alignedScanLengths[n],i=n===0?a:e._increasingScanLengths[n-1]+a;e._increasingScanLengths.push(i)}}var l=typeof r=="string"?r.length:r.byteLength+e._downloadedBytes.byteLength,s=e._getLastFullyLoadedChunkIndex(l),_=e._cryptoKeys;if(s<=e._lastDecryptedChunk||_==null)return e._downloadedBytes=o("WAArrayBuffersConcat").concatArrayBuffers(e._downloadedBytes,typeof r=="string"?yield o("WAArrayBufferUtils").largeStringToArrayBuffer(r.slice(e._downloadedBytes.byteLength)):r),null;try{var g=typeof r=="string"?yield o("WAArrayBufferUtils").largeStringToArrayBuffer(r.slice(e._downloadedBytes.byteLength)):r;return e._downloadedBytes=o("WAArrayBuffersConcat").concatArrayBuffers(e._downloadedBytes,g),yield e._decryptFullyLoadedChunks(e._downloadedBytes,s,_),yield e._generateBlobFromFullyLoadedChunks(s)}catch(t){o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["ImageStreamer:handleProgress error: ",""])),t.message).devConsole({error:t,filehash:e._filehash,scanLengths:e._scanLengths,scansSidecar:e._scansSideCar,mimetype:e._mimetype});var h=t.message+", ["+e._debugString+"]"+("scanLengths length: "+e._scanLengths.length+", scansSidecar byteLength: "+e._scansSideCar.byteLength+".");t instanceof f?(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["ImageStreamer:chunk validation error: ",""])),h),o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["ImageStreamer:chunk validation error"]))).devConsole(t).tags("non-sad").sendLogs("ImageStreamer:chunk validation error",{sampling:.01})):(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["ImageStreamer:handleProgress error: ",""])),h),o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["ImageStreamer:handleProgress error"]))).devConsole(t).sendLogs("ImageStreamer:handleProgress error"))}}))},t})();function v(e,t){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=t.encKey,r=yield o("WACryptoAesCbc").aesCbcEncrypt(n,y,new Uint8Array(e.slice(0-h)));return r.slice(0-h)}),S.apply(this,arguments)}function R(e,t){return e+"-progressive-"+t}function L(e,t){if(t!=null&&Number.isInteger(t))for(var n=t;n>0;)o("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.delete(R(e,n)),n--;o("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.delete(e)}l.EOI_TAG=C,l.ImageStreamer=b,l.getProgressiveMediaCacheKey=R,l.deleteFromInMemoryMediaBlobCache=L}),98);
__d("WAWebDownloadAndDecryptCache",["WALogger","WAWebMediaDataUtils","WAWebMediaStore","WAWebSerializeError","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e){var t,n,r=(t=e.progressiveJpegOpts)==null?void 0:t.scanCount,o=(n=e.progressiveJpegOpts)==null?void 0:n.scanLengths;if(r!=null&&o)return e.filehash+"-"+r+"/"+o.length+"-scans";if(e.partialVideoOpts){var a=e.partialVideoOpts.secondsToDownload;return e.filehash+"-"+a+"-seconds"}return e.filehash}var c=(function(){function t(){}var a=t.prototype;return a.get=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){if(!o("WAWebMediaDataUtils").shouldUseLruMediaStore(n.type))return null;try{return yield o("WAWebMediaStore").LruMediaStore.get(u(n))}catch(t){return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.asyncCache.get error:\n",""],["downloadManager.asyncCache.get error:\\n",""])),r("WAWebSerializeError")(t)).verbose(),null}});function a(e,n){return t.apply(this,arguments)}return a})(),a.set=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){if(o("WAWebMediaDataUtils").shouldUseLruMediaStore(n.type))try{yield o("WAWebMediaStore").LruMediaStore.put(u(n),t)}catch(e){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.asyncCache.set error:\n",""],["downloadManager.asyncCache.set error:\\n",""])),r("WAWebSerializeError")(e)).verbose()}});function t(t,n,r){return e.apply(this,arguments)}return t})(),t})();l.getLRUStoreKey=u,l.DownloadAndDecryptCache=c}),98);
__d("WAWebWamEnumAiFetchMediaType",[],(function(t,n,r,o,a,i){var e=Object.freeze({IMAGE_SINGLE:1,GRID_HIGH_RES:2,GRID_LOW_RES:3,INLINE_HIGH_RES:4,INLINE_LOW_RES:5});i.AI_FETCH_MEDIA_TYPE=e}),66);
__d("WAWebWamEnumDownloadQualityType",[],(function(t,n,r,o,a,i){var e=Object.freeze({NORMAL_QUALITY:1,MID_QUALITY:2,INELIGIBLE_IMAGE_TOO_SMALL:3,INELIGIBLE_PARTIAL_HASHES_NOT_FOUND:4,ERROR_DETERMINING_ELIGIBILITY:5,NOT_DOWNLOADED_ENOUGH_BYTES_TO_DETERMINE_ELIGIBILITY:6});i.DOWNLOAD_QUALITY_TYPE=e}),66);
__d("WAWebWamEnumExpressPathDownloadState",[],(function(t,n,r,o,a,i){var e=Object.freeze({PARTIAL_OR_NONE:1,FULL:2,MEDIANOTIFY_RECEIVED_EP_DISABLED:3,SKIPPED_DIFF_POP:4,SKIPPED_AUTODOWNLOAD:5});i.EXPRESS_PATH_DOWNLOAD_STATE=e}),66);
__d("WAWebMediaDownload2WamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAiFetchMediaType","WAWebWamEnumBackendStoreType","WAWebWamEnumConnectionType","WAWebWamEnumDownloadOriginType","WAWebWamEnumDownloadQualityType","WAWebWamEnumExpressPathDownloadState","WAWebWamEnumHttpProtocolVersionType","WAWebWamEnumMediaDownloadModeType","WAWebWamEnumMediaDownloadResultType","WAWebWamEnumMediaType","WAWebWamEnumNetworkStackType","WAWebWamEnumPairedMediaType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MediaDownload2:[1590,{activeThreadCount:[55,e.TYPES.INTEGER],aiFetchMediaType:[62,o("WAWebWamEnumAiFetchMediaType").AI_FETCH_MEDIA_TYPE],appContext:[64,e.TYPES.STRING],appContextBitfield:[65,e.TYPES.INTEGER],clientMessageId:[50,e.TYPES.STRING],connectionType:[31,o("WAWebWamEnumConnectionType").CONNECTION_TYPE],daysSinceReceive:[46,e.TYPES.INTEGER],debugMediaException:[24,e.TYPES.STRING],debugMediaIp:[22,e.TYPES.STRING],debugUrl:[23,e.TYPES.STRING],deviceCount:[49,e.TYPES.INTEGER],downloadBytesTransferred:[20,e.TYPES.NUMBER],downloadConnectT:[15,e.TYPES.TIMER],downloadHttpCode:[18,e.TYPES.INTEGER],downloadIsReuse:[17,e.TYPES.BOOLEAN],downloadIsStreaming:[19,e.TYPES.BOOLEAN],downloadNetworkT:[16,e.TYPES.TIMER],downloadQuality:[37,o("WAWebWamEnumDownloadQualityType").DOWNLOAD_QUALITY_TYPE],downloadResumePoint:[14,e.TYPES.INTEGER],downloadTimeToFirstByteT:[21,e.TYPES.TIMER],estimatedBandwidth:[36,e.TYPES.NUMBER],estimatedBandwidthV2:[59,e.TYPES.NUMBER],expressPathBytesSaved:[42,e.TYPES.NUMBER],expressPathDownloadState:[56,o("WAWebWamEnumExpressPathDownloadState").EXPRESS_PATH_DOWNLOAD_STATE],expressPathTimeSavedMs:[43,e.TYPES.TIMER],fileHeight:[47,e.TYPES.INTEGER],fileWidth:[48,e.TYPES.INTEGER],hasLeveragedExpressPath:[44,e.TYPES.BOOLEAN],httpProtocolVersionType:[45,o("WAWebWamEnumHttpProtocolVersionType").HTTP_PROTOCOL_VERSION_TYPE],isProcessedVideo:[58,e.TYPES.BOOLEAN],isSenderPlatformCapi:[52,e.TYPES.BOOLEAN],isViewOnce:[41,e.TYPES.BOOLEAN],maxThreadCount:[57,e.TYPES.INTEGER],mediaId:[38,e.TYPES.INTEGER],networkStack:[30,o("WAWebWamEnumNetworkStackType").NETWORK_STACK_TYPE],overallAttemptCount:[4,e.TYPES.INTEGER],overallBackendStore:[39,o("WAWebWamEnumBackendStoreType").BACKEND_STORE_TYPE],overallConnBlockFetchT:[10,e.TYPES.TIMER],overallConnectionClass:[29,e.TYPES.STRING],overallCumT:[27,e.TYPES.TIMER],overallCumUserVisibleT:[60,e.TYPES.TIMER],overallCumV2T:[53,e.TYPES.TIMER],overallDecryptT:[12,e.TYPES.TIMER],overallDomain:[5,e.TYPES.STRING],overallDownloadMode:[11,o("WAWebWamEnumMediaDownloadModeType").MEDIA_DOWNLOAD_MODE_TYPE],overallDownloadOrigin:[35,o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE],overallDownloadResult:[25,o("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE],overallFileValidationT:[13,e.TYPES.TIMER],overallIsEncrypted:[28,e.TYPES.BOOLEAN],overallIsFinal:[26,e.TYPES.BOOLEAN],overallMediaSize:[7,e.TYPES.NUMBER],overallMediaType:[1,o("WAWebWamEnumMediaType").MEDIA_TYPE],overallMmsVersion:[6,e.TYPES.INTEGER],overallQueueT:[9,e.TYPES.TIMER],overallRetryCount:[3,e.TYPES.INTEGER],overallT:[8,e.TYPES.TIMER],overallUserVisibleT:[61,e.TYPES.TIMER],pairedMediaType:[63,o("WAWebWamEnumPairedMediaType").PAIRED_MEDIA_TYPE],prefetchOrder:[66,e.TYPES.INTEGER],sleepModeAffected:[51,e.TYPES.BOOLEAN],statusId:[67,e.TYPES.STRING],timeDelayed:[54,e.TYPES.TIMER],usedFallbackHint:[40,e.TYPES.STRING]},[1,1,50],"regular"]},{MediaDownload2:[]});l.MediaDownload2WamEvent=s}),98);
__d("WAWebCreateMediaDownloadMetrics",["WATimeUtils","WAWebABProps","WAWebAppTracker","WAWebMediaDownload2WamEvent","WAWebMmsDownloadUploadCrashLogger","WAWebMmsMediaTypes","WAWebWamEnumConnectionType","WAWebWamEnumMediaDownloadResultType","WAWebWamEnumNetworkStackType","WAWebWamGroupMetricCache","WAWebWamMediaMetricUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=o("WAWebWamMediaMetricUtils").generateMediaEventId(),r=new(o("WAWebMediaDownload2WamEvent")).MediaDownload2WamEvent({mediaId:n,connectionType:o("WAWebWamEnumConnectionType").CONNECTION_TYPE.HOSTNAME,overallMediaType:o("WAWebWamMediaMetricUtils").getMetricMediaType(e.type),overallMmsVersion:4,networkStack:o("WAWebWamEnumNetworkStackType").NETWORK_STACK_TYPE.NATIVE,overallDownloadMode:o("WAWebWamMediaMetricUtils").getMetricOverallDownloadModeType(e.type,e.downloadMode,e.isPrefetch),overallAttemptCount:e.userDownloadAttemptCount,overallDownloadOrigin:e.downloadOrigin,overallBackendStore:(t=o("WAWebWamMediaMetricUtils").getMetricBackendStore(e.directPath))!=null?t:void 0,isViewOnce:e.isViewOnce});if(o("WAWebAppTracker").AppTracker.start(o("WAWebAppTracker").AppTrackerType.MediaUL),e.type===o("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE&&o("WAWebABProps").getABPropConfigValue("hqp_log_enabled")&&r.set(babelHelpers.extends({},e.imageDimensions)),o("WAWebABProps").getABPropConfigValue("enable_days_since_receive_logging")&&e.mediaKeyTimestamp!=null){var a=e.mediaKeyTimestamp,i=Math.floor((o("WATimeUtils").unixTime()-a)/(1440*60));r.set({daysSinceReceive:i})}var l=e.chatWid;if(l){var s=yield o("WAWebWamGroupMetricCache").getGroupMetrics(l);(s==null?void 0:s.deviceCount)!=null&&r.set({deviceCount:s.deviceCount})}o("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(n,o("WAWebMmsDownloadUploadCrashLogger").ProgressType.DOWNLOAD_STARTED);var u=function(t){var e=t.hostName,n=t.hostClass,o=t.failCount;r.set({overallDomain:e,overallConnectionClass:n,overallRetryCount:o})},c=function(t){r.set({overallMediaSize:t,overallDownloadResult:o("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.OK,overallIsFinal:!0,downloadHttpCode:200}),o("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(n,o("WAWebMmsDownloadUploadCrashLogger").ProgressType.DOWNLOAD_FINISHED,{overallMediaSize:t})},d=function(t,n){r.set({overallDownloadResult:o("WAWebWamMediaMetricUtils").getMetricDownloadErrorResultType(t),overallIsFinal:n});var e=o("WAWebWamMediaMetricUtils").getStatusCode(t);e!=null&&(r.downloadHttpCode=e),r.markOverallCumT(),o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.MediaUL),o("WAWebAppTracker").attachWAMAppContext(r,r.overallCumT),r.commit(),o("WAWebWamMediaMetricUtils").logErrorUnknownDetails(r,t)},m=function(t){r.set({overallT:t})},p=function(t){var e=t.error,n=t.overallT,a=t.failCount,i=new(o("WAWebMediaDownload2WamEvent")).MediaDownload2WamEvent(r.all);i.set({mediaId:o("WAWebWamMediaMetricUtils").generateMediaEventId(),overallDownloadResult:o("WAWebWamMediaMetricUtils").getMetricDownloadErrorResultType(e),overallIsFinal:!1,overallT:n,overallRetryCount:a});var l=o("WAWebWamMediaMetricUtils").getStatusCode(e);l!=null&&(r.downloadHttpCode=l),r.markOverallCumT(),o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.MediaUL),o("WAWebAppTracker").attachWAMAppContext(r,r.overallCumT),i.commit(),o("WAWebWamMediaMetricUtils").logErrorUnknownDetails(i,e)},_=function(){r.startOverallDecryptT()},f=function(){r.markOverallDecryptT()},g=function(){r.markOverallCumT(),o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.MediaUL),o("WAWebAppTracker").attachWAMAppContext(r,r.overallCumT),r.commit()},h=function(){r.startDownloadNetworkT()},y=function(){r.markDownloadNetworkT()};return{mediaId:n,handleDownloadSuccess:c,handleDownloadHostFound:u,handleDownloadError:d,handleDownloadAttemptSuccess:m,handleDownloadAttemptError:p,handleDownloadAndDecryptSuccess:g,markDecryptionEnd:f,markDecryptionStart:_,startNetworkT:h,markNetworkT:y}}),s.apply(this,arguments)}l.createMediaDownloadMetrics=e}),98);
__d("WAWebCryptoDecryptMedia",["Promise","WACryptoAesCbc","WACryptoHmac","WACryptoUtils","WALogger","WAMediaCalculateFilehash","WATypedArraysCast","WATypedArraysConcat","WAWebMiscErrors","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=10;function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=t.mediaKeys,a=t.ciphertextHmac,i=t.expectedPlaintextHash,l=t.debugString;yield(c||(c=n("Promise"))).resolve();var m={mediaKeys:r};if(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["decryptMedia: [","] start"])),l).devConsole(m),a.byteLength<d)throw new(o("WAWebMiscErrors")).MediaDecryptionError("ciphertext too short: "+a.byteLength);var p=r.iv,_=r.encKey,f=r.macKey,g=o("WATypedArraysCast").castTypedArrays(Uint8Array,a);try{return yield o("WACryptoHmac").hmacSha256(f,o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[new Uint8Array(p),g.subarray(0,0-d)]),d).then(function(e){var t=g.buffer.slice(0-d);if(!o("WACryptoUtils").arrayBuffersEqual(e,t))throw new(o("WAWebMiscErrors")).MediaDecryptionError("decryptMedia: hmac mismatch");return o("WACryptoAesCbc").aesCbcDecrypt(_,p,g.subarray(0,0-d))}).then((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(i==null)return e;var t=yield o("WAMediaCalculateFilehash").calculateFilehash(e);if(t!==i)throw new(o("WAWebMiscErrors")).MediaDecryptionError("decryptMedia: "+o("WAWebMiscErrors").PLAINTEXT_HASH_MISMATCH_ERROR);return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["decryptMedia: [","] success"])),l).devConsole(m),e});return function(t){return e.apply(this,arguments)}})())}catch(e){throw o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["decryptMedia: [","] error"])),l).devConsole(m,e),e instanceof o("WAWebMiscErrors").MediaDecryptionError?e:new(o("WAWebMiscErrors")).MediaDecryptionError("decryption error: "+String(e)+"; stack: "+e.stack)}}),p.apply(this,arguments)}l.default=m}),98);
__d("WAWebGetMediaDownloadByterange",["WAAlignChunkLengthsToMultipleOfAesBlockSize","WAWebCryptoDecryptPartialMedia"],(function(t,n,r,o,a,i,l){function e(e){var t=e.partialVideoOpts,n=e.progressiveJpegOpts,r=e.scanCount;if(n&&r!=null)return{start:0,end:o("WAAlignChunkLengthsToMultipleOfAesBlockSize").alignChunkLengthsToMultipleOfAesBlockSize(n.scanLengths).slice(0,r).reduce(function(e,t){return e+t},0)};if(t){var a=t.video,i=a.size,l=a.duration,s=t.secondsToDownload,u=i*s/l,c=128*1024,d=Math.max(u,c),m=Math.ceil(d/o("WAWebCryptoDecryptPartialMedia").BLOCK_SIZE);return{start:0,end:m*o("WAWebCryptoDecryptPartialMedia").BLOCK_SIZE-1}}return null}l.default=e}),98);
__d("WAWebNetworkType",[],(function(t,n,r,o,a,i){function e(){return navigator.connection&&typeof navigator.connection.effectiveType=="string"?navigator.connection.effectiveType:null}i.getEffectiveNetworkType=e}),66);
__d("WAWebValidateMediaFilehash",["WAMediaCalculateFilehash","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WAMediaCalculateFilehash").calculateFilehash(e);return t===n}),s.apply(this,arguments)}l.validateFileash=e}),98);
__d("WAWebWamEnumWebcChatType",[],(function(t,n,r,o,a,i){var e=Object.freeze({INDIVIDUAL:0,GROUP:1,BROADCAST_LIST:2,COMMUNITY:3,NEWSLETTER:4});i.WEBC_CHAT_TYPE=e}),66);
__d("WAWebWebcMediaRmrWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMediaType","WAWebWamEnumWebcChatType","WAWebWamEnumWebcRmrReasonCode"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WebcMediaRmr:[1906,{messageMediaType:[10,o("WAWebWamEnumMediaType").MEDIA_TYPE],webcBrowserNetworkType:[2,e.TYPES.STRING],webcBrowserStorageQuotaBytes:[11,e.TYPES.INTEGER],webcBrowserStorageQuotaUsedBytes:[12,e.TYPES.INTEGER],webcChatPosition:[1,e.TYPES.INTEGER],webcChatType:[9,o("WAWebWamEnumWebcChatType").WEBC_CHAT_TYPE],webcMediaRmrError:[8,e.TYPES.BOOLEAN],webcMediaRmrT:[6,e.TYPES.TIMER],webcMediaSize:[7,e.TYPES.INTEGER],webcMessageIndex:[3,e.TYPES.INTEGER],webcMessageT:[5,e.TYPES.TIMER],webcRmrReason:[14,o("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE],webcRmrStatusCode:[13,e.TYPES.INTEGER]},[1,1,1],"regular"]},{WebcMediaRmr:[]});l.WebcMediaRmrWamEvent=s}),98);
__d("WAWebDownloadManager",["Promise","WAAsyncCache","WAConcurrentPriorityPromiseQueue","WALogger","WAMediaWasmWorkerClient","WAMemoizeConcurrent","WANullthrows","WAResultOrError","WAWebABProps","WAWebBackendErrors","WAWebCreateMediaDownloadMetrics","WAWebCryptoCreateMediaKeys","WAWebCryptoDecryptMedia","WAWebCryptoDecryptPartialMedia","WAWebCryptoImageStreamer","WAWebDownloadAndDecryptCache","WAWebDownloadManagerErrors","WAWebFrontendMsgGetters","WAWebGetMediaDownloadByterange","WAWebMediaCryptoEligibilityUtils","WAWebMediaDebugString","WAWebMediaObject","WAWebMediaTypes","WAWebMiscErrors","WAWebMmsClient","WAWebMmsClientErrors","WAWebMmsDownloadUploadCrashLogger","WAWebMmsMediaTypes","WAWebNetworkType","WAWebNoop","WAWebSerializeError","WAWebValidateMediaFilehash","WAWebWamEnumDownloadOriginType","WAWebWebcMediaRmrWamEvent","asyncToGeneratorRuntime","justknobx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S={PRELOAD_MMS_MEDIA:1,PRELOAD_MMS_THUMBNAIL:2},R=function(t){switch(t){case o("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_DOCUMENT:return S.PRELOAD_MMS_THUMBNAIL;case o("WAWebMmsMediaTypes").MEDIA_TYPES.HISTORY_SYNC:case o("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO:default:return S.PRELOAD_MMS_MEDIA}},L=function(){var t=this;this.preloader=new(r("WAConcurrentPriorityPromiseQueue"))(10,{thumbnail:4,histSyncChunk:3}),this.loadSequence=new(r("WAConcurrentPriorityPromiseQueue"))(r("justknobx")._("4675"),{thumbnail:5},r("justknobx")._("4676")),this.downloadAndMaybeDecrypt=r("WAAsyncCache")(function(e){return o("WAWebDownloadAndDecryptCache").getLRUStoreKey(e)},new(o("WAWebDownloadAndDecryptCache")).DownloadAndDecryptCache,function(a){var i=function(){return E(a).then((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(o("WAWebABProps").getABPropConfigValue("web_use_kaleidoscope_media_check_enabled")&&P(a.downloadOrigin)){var n,i=yield o("WAMediaWasmWorkerClient").kaleidoscopeClassifyInWorker({mediaType:o("WAWebMmsMediaTypes").mediaTypeToKaleidoscopeMediaType(a.type),rawMimeType:(n=a.mimetype)!=null?n:"application/octet-stream",input:t,eventFlow:{addPoint:r("WAWebNoop"),addAnnotations:r("WAWebNoop")}}).catch(function(t){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["kaleidoscopeClassifyInWorker: Unexpected runtime error: ",""])),t).devConsole(t).tags("kaleidoscope").sendLogs("kaleidoscope-error"),o("WAResultOrError").makeError("runtime-error")});i.success?o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["kaleidoscopeClassifiyInWorker success"]))):o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["kaleidoscopeClassifyInWorker failed: ",""])),i.error).tags("kaleidoscope").sendLogs("kaleidoscope-fail")}return t});return function(e){return t.apply(this,arguments)}})())},l={priority:-R(a.type),group:a.type===o("WAWebMmsMediaTypes").MEDIA_TYPES.HISTORY_SYNC?"histSyncChunk":"thumbnail",signal:a.signal};return a.isPreload===!0?t.preloader.enqueue(i,l):a.shouldSequenceDownload===!0?t.loadSequence.enqueue(i,babelHelpers.extends({},l,{group:"thumbnail"})):i()}),this.rmr=r("WAMemoizeConcurrent")(function(e){return e.mediaObject.filehash||""},I),this.checkExistence=r("WAMemoizeConcurrent")(function(e){return e.encFilehash},D),o("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.init()};function E(e){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.directPath,a=e.encFilehash,i=e.filehash,l=e.mediaKey,s=e.mediaKeyTimestamp,u=e.onDecryptStart,g=e.downloadOrigin,h=e.staticUrl,y=e.type,C=e.mode,b=e.progressiveJpegOpts,S=e.partialVideoOpts,R=e.onProgress,L=e.userDownloadAttemptCount,E=e.isViewOnce,k=e.imageDimensions,I=e.chatWid,T=o("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(y);if(l==null&&T)throw o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[DownloadManager] expected media key for media type ",""])),y).tags("media").sendLogs("missing-media-key-for-media-type-"+y),new(o("WAWebMiscErrors")).MediaDecryptionError("decryptMedia: missing key for type "+y);if(a==null&&T)throw o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[DownloadManager] expected encFilehash for media type ",""])),y).tags("media").sendLogs("missing-encfilehash-for-media-type-"+y),new(o("WAWebMiscErrors")).MediaDecryptionError("decryptMedia: missing encFilehash for type "+y);var D=b==null?void 0:b.scanCount,x=b!=null&&(b.scanCount==null||b.scanCount===b.scanLengths.length),P=x?null:D,N=yield o("WAWebCreateMediaDownloadMetrics").createMediaDownloadMetrics({directPath:t,downloadOrigin:g,type:y,userDownloadAttemptCount:L,isViewOnce:E,downloadMode:C,isPrefetch:b!=null&&!x,imageDimensions:k,chatWid:I,mediaKeyTimestamp:s}),M=N.handleDownloadSuccess,w=N.handleDownloadHostFound,A=N.handleDownloadError,F=N.handleDownloadAttemptSuccess,O=N.handleDownloadAttemptError,B=N.handleDownloadAndDecryptSuccess,W=N.markDecryptionStart,q=N.markDecryptionEnd,U=N.startNetworkT,V=N.markNetworkT,H=N.mediaId,G=e.signal||new AbortController().signal,z=o("WAWebMediaDebugString").getDebugString(i),j={directPath:t,encFilehash:a,staticUrl:h,type:y};o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.download: [","] start"])),z).devConsole(j);try{var K=$({progressiveJpegOpts:b,filehash:i,debugString:z}),Q=function(t){O(t),K!=null&&(K=$({progressiveJpegOpts:b,filehash:i,debugString:z}))},X=r("WAWebGetMediaDownloadByterange")({partialVideoOpts:S,progressiveJpegOpts:b,scanCount:P}),Y=P==null&&b?function(e,t){var n;(n=K)==null||n.handleProgress(e.total,t)}:null,J=T&&l!=null?r("WAWebCryptoCreateMediaKeys")(y,l).then(function(e){var t;return(t=K)==null||t.setCryptoKeys(e),e}):(v||(v=n("Promise"))).resolve(null),Z=yield(v||(v=n("Promise"))).all([J,n("asyncToGeneratorRuntime").asyncToGenerator(function*(){U();try{return yield r("WAWebMmsClient").download({directPath:t,filehash:T?r("WANullthrows")(a):i,staticUrl:h,type:y,signal:G,mode:C,byteRange:X,onData:Y,onDownloadHostFound:w,onDownloadAttemptSuccess:F,onDownloadAttemptError:Q,debugString:z,onProgress:R})}finally{V()}})()]),ee=Z[0],te=Z[1];M(te.byteLength);var ne=te;if(ee!=null){if(o("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(H,o("WAWebMmsDownloadUploadCrashLogger").ProgressType.DOWNLOAD_DECRYPTION_STARTED),u==null||u(),W(),P!=null&&X!=null){var re,oe=X.end-X.start;return r("WANullthrows")(yield(re=K)==null?void 0:re.handleProgress(oe,te))}else S?ne=yield o("WAWebCryptoDecryptPartialMedia").decryptPartialMedia({mediaKeys:ee,ciphertext:te}):ne=yield r("WAWebCryptoDecryptMedia")({mediaKeys:ee,ciphertextHmac:te,expectedPlaintextHash:i,debugString:z});q(),o("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(H,o("WAWebMmsDownloadUploadCrashLogger").ProgressType.DOWNLOAD_DECRYPTION_FINISHED)}else{var ae=S==null;if(ae){var ie=yield o("WAWebValidateMediaFilehash").validateFileash(ne,i);if(!ie)throw new(o("WAWebMiscErrors")).MediaHashMismatch}}return o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.download: [","] success"])),z).devConsole(j,ne),B(),ne}catch(t){throw t instanceof o("WAWebMmsClientErrors").MediaNotFoundError?(A(t,!!e.isFinalRmrRetry),o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.download: [","] expected error\n",""],["downloadManager.download: [","] expected error\\n",""])),z,r("WAWebSerializeError")(t)).verbose().devConsole(j)):(A(t,!0),o("WALogger").WARN(f||(f=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.download: [","] error\n",""],["downloadManager.download: [","] error\\n",""])),z,r("WAWebSerializeError")(t)).verbose().devConsole(j)),o("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(H,o("WAWebMmsDownloadUploadCrashLogger").ProgressType.DOWNLOAD_ERROR),t}}),k.apply(this,arguments)}function I(e){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.mediaObject,n=o("WAWebMediaDebugString").getDebugString(t.filehash),a={filehash:t.filehash,type:t.type};o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.rmr: [","] start"])),n).devConsole(a),t.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.REUPLOADING});var i=self.performance.now(),l=new(o("WAWebWebcMediaRmrWamEvent")).WebcMediaRmrWamEvent(babelHelpers.extends({},e.rmrData,{webcRmrReason:e.rmrReason})),s=o("WAWebNetworkType").getEffectiveNetworkType();s!=null&&(l.webcBrowserNetworkType=s),t.type&&(l.messageMediaType=o("WAWebMediaObject").webMediaTypeToWamMediaType(t.type)),t.size!=null&&(l.webcMediaSize=t.size);function u(e){var t=o("WAWebFrontendMsgGetters").getMaybeChat(e);l.webcChatType==null&&t&&(l.webcChatType=t.getWebcChatType()),l.webcMessageT==null&&(l.webcMessageT=e.t),l.messageMediaType=e.getWamMediaType()}try{var c=yield t.rmr({onMsgSelect:u});if(l.webcRmrStatusCode=c,o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.rmr: [","] status ",""])),n,c).devConsole(a),c===404)throw new(o("WAWebDownloadManagerErrors")).MediaNotOnPhone;if(c!==200)throw new(o("WAWebBackendErrors")).ServerStatusCodeError(c)}catch(e){throw l.webcMediaRmrError=!0,e instanceof o("WAWebMiscErrors").RMRNotSupportedOnNewsletterMessagesError?(e.mediaType===o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER||e.mediaType===o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER_PACK?t.consolidate({downloadStage:o("WAWebMediaTypes").DownloadStage.RESOLVED}):o("WALogger").WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.rmr: [","] error RMRNotSupportedOnNewsletterMessagesError","\n",""],["downloadManager.rmr: [","] error RMRNotSupportedOnNewsletterMessagesError","\\n",""])),n,e.message,e.stack).verbose().devConsole(a),e):e instanceof o("WAWebDownloadManagerErrors").MediaNotOnPhone?(o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.rmr: [","] error MediaNotOnPhone\n",""],["downloadManager.rmr: [","] error MediaNotOnPhone\\n",""])),n,r("WAWebSerializeError")(e)).verbose().devConsole(a),e):(o("WALogger").WARN(b||(b=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.rmr: [","] error ","\n",""],["downloadManager.rmr: [","] error ","\\n",""])),n,e.status||e.message,e.stack).verbose().devConsole(a),new(o("WAWebMiscErrors")).MediaNeedsReupload)}finally{l.webcMediaRmrT=Math.ceil(self.performance.now()-i),l.commit()}}),T.apply(this,arguments)}function D(e){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.directPath,n=e.encFilehash,o=e.signal,a=e.type;yield r("WAWebMmsClient").checkExistence({directPath:t,encFilehash:n,type:a,signal:o||new AbortController().signal})}),x.apply(this,arguments)}function $(e){var t=e.progressiveJpegOpts,n=e.filehash,r=e.debugString;return t==null?null:new(o("WAWebCryptoImageStreamer")).ImageStreamer({scanLengths:t.scanLengths,scansSidecar:t.scansSidecar,mimetype:t.mimetype,filehash:n,debugString:r,onProgressiveUpdate:t.onProgressiveUpdate})}function P(e){switch(e){case o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.PROFILE_PICTURE:case o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.STATUS_ADS:case o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.PRODUCT_CATALOG:case o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.MESSAGE_HISTORY_SYNC:case o("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.GDPR:return!1}return!0}var N=new L;l.downloadManager=N}),98);
__d("WAWebBaseCachePolicy",["WAWebEventEmitter"],(function(t,n,r,o,a,i,l){var e={LOAD:"LOAD",NONE:"NONE"},s=(function(e){function t(t,n){var r;return r=e.call(this)||this,r.collection=t,r.id=n,r}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.enableCaching=function(){},n.disableCaching=function(){},t})(r("WAWebEventEmitter"));s.policy=e.NONE,l.CACHE_POLICY=e,l.BaseCachePolicy=s}),98);
__d("WAWebLoadCachePolicy",["WAWebBaseCachePolicy","WAWebDebounce"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(t,n){var o;return o=e.call(this,t,n.id)||this,o.saveToCache=function(){o.collection.saveToCache()},o.$LoadCachePolicy$p_2=n.trigger||"all",o.$LoadCachePolicy$p_1=n.delay,o.$LoadCachePolicy$p_3=r("WAWebDebounce")(o.saveToCache,o.$LoadCachePolicy$p_1),o}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.enableCaching=function(){this.listenTo(this.collection,this.$LoadCachePolicy$p_2,this.$LoadCachePolicy$p_3)},n.disableCaching=function(){this.stopListening(this.collection,this.$LoadCachePolicy$p_2,this.$LoadCachePolicy$p_3)},t})(o("WAWebBaseCachePolicy").BaseCachePolicy);e.policy=o("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,l.default=e}),98);
__d("WAWebNoCachePolicy",["WAWebBaseCachePolicy"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(t,n){return e.call(this,t,n.id)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCachePolicy").BaseCachePolicy);e.policy=o("WAWebBaseCachePolicy").CACHE_POLICY.NONE,l.default=e}),98);
__d("WAWebCachePolicies",["WAWebLoadCachePolicy","WAWebNoCachePolicy"],(function(t,n,r,o,a,i,l){function e(e,t){switch(t.policy){case"LOAD":return new(r("WAWebLoadCachePolicy"))(e,t);case"NONE":return new(r("WAWebNoCachePolicy"))(e,t)}return new(r("WAWebNoCachePolicy"))(e,{id:"none",policy:"NONE"})}l.createCachePolicy=e}),98);
__d("WAWebBaseCollection",["Promise","WAFilteredCatch","WALogger","WATypeUtils","WAWebBackendErrors","WAWebBaseCachePolicy","WAWebCachePolicies","WAWebCollection","WAWebConnModel","WAWebMiscErrors","WAWebSocketConstants","WAWebSocketModel","WAWebUserPrefsStore","asyncToGeneratorRuntime","cr:5292","err","gkx","uniqueID"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f={QUERY:"QUERY",FIND:"FIND",UPDATE:"UPDATE"},g={}.toString(),h={id:"none",policy:o("WAWebBaseCachePolicy").CACHE_POLICY.NONE},y=(function(e){function t(t){var n;return n=e.call(this,t)||this,n.name="CollectionSilentQueryError",n.message=t,n}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),C=(function(t){function a(){var e;return e=t.call(this)||this,e._inflight={},e._cachePolicy=o("WAWebCachePolicies").createCachePolicy(e,e.constructor.cachePolicy||h),e._staleCollection=e.constructor.staleCollection||!1,e._staleCollection===!0&&e.listenTo(o("WAWebSocketModel").Socket,"change:stream",e._handleStreamChange),e._cachePolicy.enableCaching(),e._cachePolicy.constructor.policy===o("WAWebBaseCachePolicy").CACHE_POLICY.LOAD&&(e.listenTo(o("WAWebConnModel").Conn,"me_ready",e._updateFromCache),o("WAWebConnModel").Conn.meReadyTriggered&&e._updateFromCache()),e}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.initializeFromCache=function(t){this.add(t)},i.saveToCache=function(){if(o("WAWebConnModel").Conn.shouldSaveToCache()){var t=this._cachePolicy.id;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["baseCollection:saveToCache save: ",""])),String(t)),r("WAWebUserPrefsStore").setCollection(t,this.toJSON())}},i.add=function(a,i){var e=this;if(r("gkx")("26258")||(n("cr:5292")==null?void 0:n("cr:5292").currentTransaction)!=null&&o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Detected UI change inside a transaction in collection ",".\n      This can result in a consistency issue. See https://fburl.com/aleoj4tt item #1 for details."])),this.constructor.name),a){if(o("WAWebConnModel").Conn.blockStoreAdds)throw new(o("WAWebBackendErrors")).LogoutDrop("adding to store when blocking store adds");var l=Array.isArray(a)?a:[a];if(l.every(function(e){return e==null?void 0:e.isState})){var u=l.filter(function(t){return!e.get(t.id)});return u.length&&t.prototype.add.call(this,u,i),l}}return t.prototype.add.call(this,a,i)},i.findQuery=function(t,n){return this._query(f.QUERY,t,n)},i.find=function(t,a){return t?this._query(f.FIND,t,a):(o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Called find without an id"]))).sendLogs("find-without-id"),(_||(_=n("Promise"))).reject(r("err")("called find without an id")))},i.update=function(t,a){return t?this._query(f.UPDATE,t,a):(o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Called update without an id"]))).sendLogs("update-without-id"),(_||(_=n("Promise"))).reject(r("err")("called update without an id")))},i.gadd=function(t,n){if(this.modelClass.prototype.isIdType(t)){var e=this.get(t);return e||this.add({id:t},n)[0]}if(t.id){var o=n||{};return o.merge=!0,this.add(t,o)[0]}throw r("err")("gadd called without an id attr (id)")},i.gaddUp=function(t){var e=this._staleCollection;this.get(t.id)&&(e=!1);var n=babelHelpers.extends({stale:e},t),o=this.add(n,{merge:!0})[0];if(o){var a=o;return o.stale&&this.find(o.id),a}throw r("err")(".gaddUp called without an id attr (id)")},i.delete=function(){this._inflight={},this.reset()},i._handleResume=function(){switch(o("WAWebSocketModel").Socket.stream){case o("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED:if(!this._staleCollection)return;this.forEach(function(e){e&&(e.stale=!0)});break;case o("WAWebSocketConstants").SOCKET_STREAM.RESUMING:case o("WAWebSocketConstants").SOCKET_STREAM.SYNCING:case o("WAWebSocketConstants").SOCKET_STREAM.CONNECTED:break}},i._query=function(t,a,i){var e=this,l=o("WATypeUtils").isString(a)?a:a.toString();l===g&&(l=r("uniqueID")("collection_query_"));var s=t===f.QUERY?void 0:this.get(a),u="force-"+l;return(this._inflight[u]&&t===f.FIND||t===f.UPDATE)&&(l=u),this._inflight[l]?t===f.FIND&&s&&!s.stale?(_||(_=n("Promise"))).resolve(s):this._inflight[l]:!s||s.stale||t===f.UPDATE?this._inflight[l]=this._serverQuery(t,a,i).finally(function(){delete e._inflight[l]}).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").LogoutDrop,function(e){o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["LogoutDrop error: ",""])),e.toString()).devConsole(e)})).catch(function(e){if(e instanceof y)o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["baseCollection:query query promise rejected: ",""])),String(e));else throw e}):(_||(_=n("Promise"))).resolve(s)},i._serverQuery=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r;e===f.UPDATE?r=this._update(t,n):e===f.FIND?r=this.findImpl(t,n):r=this.findQueryImpl(t);var a=yield r;if(this._staleCollection){var i=Array.isArray(a)?a:[a];i.filter(Boolean).forEach(function(e){typeof e.stale=="undefined"&&(e.stale=!1)})}var l;if(n!=null&&n.set?l=this.set(a):l=this.add(a,{merge:!0}),Array.isArray(a))return l;if(l[0])return l[0];throw new(o("WAWebMiscErrors")).ModelCreateError("Unknown",a)});function t(t,n,r){return e.apply(this,arguments)}return t})(),i._update=function(t,n){return this.findImpl(t,n)},i._handleStreamChange=function(){this._handleResume(),this._cachePolicy.constructor.policy===o("WAWebBaseCachePolicy").CACHE_POLICY.LOAD&&this._updateFromCache()},i._updateFromCache=function(){var e=this._cachePolicy.id;this._cachePolicy.disableCaching(),o("WAWebConnModel").Conn.shouldSaveToCache()&&(o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["baseCollection:initFromCache load: ",""])),String(e)),this.initializeFromCache(r("WAWebUserPrefsStore").getCollection(e)),this._cachePolicy.enableCaching())},a})(r("WAWebCollection"));l.CollectionSilentQueryError=y,l.BaseCollection=C}),98);
__d("WAWebCollection",["WAArrayMove","WALogger","WAWebCollectionInternalUtils","WAWebEventEmitter","err","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m=(function(t){function n(e,n){var o;n===void 0&&(n={}),o=t.call(this)||this,n.parent&&(o.parent=n.parent);var a=o.constructor,i=a.model,l=a.comparator;if(!i)throw r("err")("Collection initialized without model. It is likely that you have a circular dependency. Set a breakpoint to find it and use inline `require` instead of `import` to avoid it.");o.modelClass=i,l&&(o._comparator=l),o._reset();var s=o;return Object.defineProperty(o,"length",{get:function(){return s._models.length}}),o}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.add=function(t,n){var e;return Array.isArray(t)?e=t.slice():e=t?[t]:[],this.set(e,babelHelpers.extends({merge:!1,add:!0,remove:!1},n))},a.set=function(n,r){var t=this;if(!n)return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["collection:set called with no models"]))),[];for(var a=babelHelpers.extends({add:!0,remove:!0,merge:!0},r),i,l,u,c,d=this._comparator&&a.sort!==!1,m=[],p=[],_={},f=a.add,g=a.merge,h=a.remove,y=a.at!=null?a.at:void 0,C=!d&&f===!0&&h===!0?[]:null,b=function(){if(c=n[S],t.isModel(c)&&(l=c),i=c.id,!i)return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["collection:set model has no id"]))),0;if(u=t.get(i),u){var e=u;h===!0&&(_[u.id.toString()]=!0),g===!0&&(c=l&&c===l?l.attributes:c,e.set(c,a),t._iterateAggregators(function(t){t.add([e])})),n[S]=e}else if(f===!0)if(l=n[S]=t._prepareModel(c,a),l){var r=l;m.push(r),t._addReference(r)}else return 0;if(l=u||l,!l)return 0;var d=l;C&&(!l.id||!_[l.id.toString()])&&C.push(d),_[d.id.toString()]=!0},v,S=0,R=n.length;S<R;S++)v=b();if(h===!0){for(var L=0,E=this.length;L<E;L++){l=this._models[L];var k=l;_[l.id.toString()]||p.push(k)}p.length&&this.remove(p,babelHelpers.extends({},a))}var I;if(m.length||C!=null&&C.length){if(d&&(I=!0),typeof y=="number"){var T;(T=this._models).splice.apply(T,[y,0].concat(m))}else for(var D=C||m,x=0,$=D.length;x<$;x++)this._models.push(D[x]);this._iterateAggregators(function(e){e.add(m)})}if(I&&this.sort({silent:!0}),a.silent!==!0){for(var P=0,N=m.length;P<N;P++)l=m[P],l.trigger?l.trigger("add",l,this,a):this.trigger("add",l,this,a);(I||C!=null&&C.length)&&this.trigger("sort",this,a)}return n},a.remove=function(t,n){n===void 0&&(n={});for(var e,r,o,a,i=Array.isArray(t)?t.slice():[t],l=[],s=0,u=i.length;s<u;s++)if(a=i[s],!!a&&(o=a instanceof this.modelClass?a.id:a,e=l[s]=this.get(o),e)){var c=e;this._deIndex(e),r=this._models.indexOf(e),this._models.splice(r,1),n.silent!==!0&&(n.index=r,c.trigger?c.trigger("remove",e,this,n):this.trigger("remove",e,this,n)),this._removeReference(c)}return this._iterateAggregators(function(e){e.remove(l)}),l},a.reset=function(){for(var e=0,t=this._models.length;e<t;e++)this._removeReference(this._models[e]);this._reset(),this.trigger("reset",this)},a.sort=function(t){var e;return t===void 0&&(t={}),this._models.sort((e=t.comparator)!=null?e:this._comparator.bind(this)),t.silent!==!0&&this.trigger("sort",this,t),this},a.replaceId=function(t,n){var e=this.get(t);e&&(this._removeFromIndex(t),e.set({id:n}),this._addIndex(e))},a.reorderMutate=function(t,n){o("WAArrayMove").arrayMoveMutate(this._models,t,n)},a.get=function(t){return this._index[t]},a.assertGet=function(t){var e=this._index[t];if(!e)if(r("gkx")("26258"))o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("Collection:assertGet no result");else{var n=this.constructor.name+":assertGet";o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["no model with id ",""])),String(t)).sendLogs(n)}return e},a.at=function(t){return this._models[t]},a.serialize=function(){return this.map(function(e){return e.toJSON()})},a.toJSON=function(){return this.serialize()},a.isModel=function(t){return t instanceof this.modelClass},a.includes=function(t,n){return n===void 0&&(n=0),n===0?t instanceof this.modelClass?this.get(t.id)!=null:!1:this._models.includes(t,n)},a.indexOf=function(t,n){return this._models.indexOf(t,n)},a.lastIndexOf=function(t,n){return this._models.lastIndexOf(t,n)},a.every=function(t){return this._models.every(t)},a.some=function(t){return this._models.some(t)},a.forEach=function(t){this._models.forEach(t)},a.map=function(t){return this._models.map(t)},a.filter=function(t){return this._models.filter(t)},a.findFirst=function(t){return this._models.find(t)},a.reduce=function(t,n){return this._models.reduce(t,n)},a.slice=function(t,n){return this._models.slice(t,n)},a.where=function(t){return this.filter(function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},a.head=function(){return this._models[0]},a.last=function(){return this._models[this._models.length-1]},a.toArray=function(){return this._models.slice()},a.getModelsArray=function(){return this._models},a.reorder=function(t,n){return o("WAArrayMove").arrayMove(this._models,t,n)},a._reset=function(){this._models=[],this._index={},this._iterateAggregators(function(e){e.reset()},!1)},a._prepareModel=function(t,n){if(this.isModel(t))return t.collection==null&&(t.collection=this),t;var e=babelHelpers.extends({},n,{collection:this});try{return new this.modelClass(t,e)}catch(e){var r,a;o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["collection:_prepareModel for model "," exception: ",""])),(r=this==null||(a=this.modelClass)==null?void 0:a.name)!=null?r:"",e.stack).sendLogs("collection-model-creation-error");return}},a._addReference=function(t){this._addIndex(t),t.collection||(t.collection=this),t.on&&t.on("all",this._handleModelEvent,this)},a._removeReference=function(t){this===t.collection&&delete t.collection,this._deIndex(t),t.off&&t.off("all",this._handleModelEvent,this)},a._addIndex=function(t){this._index[t.id]=t},a._deIndex=function(t){delete this._index[t.id]},a._removeFromIndex=function(t){this.get(t)&&delete this._index[t]},a._handleModelEvent=function(t,n,r,o){var e=t.indexOf(":"),a=e===-1?t:t.slice(0,e);(a==="add"||a==="remove")&&r!==this||(a==="destroy"&&this.remove(n,o),this.trigger.apply(this,arguments))},a._iterateAggregators=function(t,n){var e;if(n===void 0&&(n=!0),this._aggregators==null){if(!n)return;this._aggregators=o("WAWebCollectionInternalUtils").groupMethodsByKind(this).aggregate}(e=this._aggregators)==null||e.forEach(t)},n})(r("WAWebEventEmitter"));l.default=m}),98);
__d("WAWebCollectionInternalUtils",["WAWebCollectionUtils"],(function(t,n,r,o,a,i,l){var e=function(t){return t!=null&&typeof t=="function"&&"kind"in t&&o("WAWebCollectionUtils").CollectionMethodKind.isValid(t.kind)?t:null};function s(t){var n=null;for(var r of Object.keys(t)){var a=e(t[r]);if(a)switch(a.kind){case o("WAWebCollectionUtils").CollectionMethodKind.Aggregate:{n||(n=[]),n.push(a);break}}}return{aggregate:n}}l.groupMethodsByKind=s}),98);
__d("WAWebCollectionUtils",["$InternalEnum","WALogger","WAWebSimpleCollection"],(function(t,n,r,o,a,i,l){var e,s=n("$InternalEnum").Mirrored(["Aggregate"]);function u(e){return Array.isArray(e)?JSON.stringify(e.map(u)):String(e)}var c=(function(e){function t(t,n){var r;r=e.call(this)||this,r._isWaitingForCollection=!1,r._rootCollection=t,r._key=n;var o=r;return Object.defineProperty(r,"_models",{get:function(){var e,t;return(e=(t=o._getAggregatedCollection())==null?void 0:t._models)!=null?e:[]}}),Object.defineProperty(r,"_index",{get:function(){var e,t;return(e=(t=o._getAggregatedCollection())==null?void 0:t._index)!=null?e:{}}}),r}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n._getAggregatedCollection=function(){var e;return(e=this._rootCollection.get(this._key))==null?void 0:e.collection},n.on=function(n,r,o){return e.prototype.on.call(this,n,r,o),this._maybeConnect(),this},n.off=function(n,r,o){return e.prototype.off.call(this,n,r,o),this._maybeDisconnect(),this},n._hasListeners=function(){var e=this._events;if(e==null)return!1;for(var t in e)if(e[t]!=null&&e[t].length>0)return!0;return!1},n._maybeConnect=function(){var e=this,t=this._getAggregatedCollection();if(t==null){if(this._isWaitingForCollection)return;this._isWaitingForCollection=!0,this._rootCollection.on("add",this._maybeConnect,this),this._disconnect=function(){e._rootCollection.off("add",e._maybeConnect,e)};return}if(this._isWaitingForCollection){var n;(n=this._disconnect)==null||n.call(this),this._isWaitingForCollection=!1}t.on("all",this._relayEvent,this),this._rootCollection.on("remove",this._handleCollectionRemove,this),this._disconnect=function(){t.off("all",e._relayEvent,e),e._rootCollection.off("remove",e._handleCollectionRemove,e)}},n._maybeDisconnect=function(){var e;this._hasListeners()||((e=this._disconnect)==null||e.call(this),this._disconnect=null)},n._handleCollectionRemove=function(t){if(this._key===t.id){var e;(e=this._disconnect)==null||e.call(this),this._disconnect=null,this._maybeConnect()}},n._relayEvent=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];this.trigger.apply(this,[t].concat(n))},t})(o("WAWebSimpleCollection").SimpleCollection);function d(e,t){t===void 0&&(t={});var n=t,r=n.subscribeToKey,a=n.subscribeToKeys,i=new(o("WAWebSimpleCollection")).SimpleCollection,l=new Map,d=function(t){if(r!=null){var e=function(){var n=function(){t.off("change:"+r,e)};_(t,n)};t.on("change:"+r,e)}if(a!=null){var n=function(){var e=function(){a.forEach(function(e){t.off("change:"+e,n)})};_(t,e)};a.forEach(function(e){t.on("change:"+e,n)})}},m=function(t,n){var e,r=(e=i.get(t))==null?void 0:e.collection;r&&(r.remove(n),r.length===0&&i.remove(t)),l.delete(n.id)},p=function(n){var t,r=e(n);if(r!=null){var a=l.get(n.id),s=u(r);a!=null&&s!==a&&m(a,n);var c=(t=i.get(s))==null?void 0:t.collection;c==null&&(c=new(o("WAWebSimpleCollection")).SimpleCollection,i.add({id:s,collection:c})),c.add(n),l.set(n.id,s),d(n)}},_=function(n,r){var t=l.get(n.id),o=e(n);if(o==null){t!=null&&(r(),m(t,n));return}if(t!==u(o))return r(),p(n)};return Object.assign(function(e){return new c(i,u(e))},{kind:s.Aggregate,add:function(t){t.forEach(function(e){p(e)})},remove:function(n){n.filter(Boolean).forEach(function(t){var n=u(e(t));m(n,t)})},reset:function(){i.forEach(function(e){var t=e.collection;t.reset()}),i.reset(),l.clear()}})}l.CollectionMethodKind=s,l.AggregatedProxyView=c,l.aggregated=d}),98);
__d("WAWebSimpleCollection",["WAWebBaseCollection"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=Object,l.SimpleCollection=e}),98);
__d("WAWebMsgModelFromData",["WAWebMsgModel"],(function(t,n,r,o,a,i,l){function e(t){return new(o("WAWebMsgModel")).Msg(babelHelpers.extends({},t,{paymentNoteMsg:t.paymentNoteMsg?e(t.paymentNoteMsg):void 0}))}l.msgModelFromMsgData=e}),98);
__d("WAWebDirectConnectionGatingUtils",["WALogger","WAWebABProps","WAWebBusinessProfileCollection","WAWebBusinessProfileVersioningBridge","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(){return(o("WAWebBusinessProfileVersioningBridge").getBusinessProfileQueryVersion()&o("WAWebBusinessProfileVersioningBridge").DIRECT_CONNECTION_FLAG)>0}function u(){return!o("WAWebABProps").getABPropConfigValue("web_abprop_direct_connection_md")}function c(e,t){return e===o("WAWebMsgType").MSG_TYPE.LIST&&t===o("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.PRODUCT_LIST}function d(){return o("WAWebABProps").getABPropConfigValue("web_abprop_direct_connection_md")}function m(){return o("WAWebABProps").getABPropConfigValue("web_abprop_direct_connection_md")}function p(){var e=o("WAWebABProps").getABPropConfigValue("direct_connection_business_numbers");return typeof e=="string"&&e.length>0?e.split(","):[]}function _(e,t,n){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){if(u()||!c(t,n)||!r)return!1;if(!s())return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] This web client cannot detect if the product list message recevied is coming from a direct connection business"]))),"unknown";var a=o("WAWebWidFactory").createWid(r),i=o("WAWebBusinessProfileCollection").BusinessProfileCollection.get(a);return(!i||!i.profileOptions)&&(i=yield o("WAWebBusinessProfileCollection").BusinessProfileCollection.find(a)),i.isBusinessDirectConnection()||!1}),f.apply(this,arguments)}function g(e,t,n){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield _(e,t,n);return r===!0&&!d()?{requiresDirectConnection:r,type:o("WAWebMsgType").MSG_TYPE.UNKNOWN,subtype:"phone_only_feature"}:{requiresDirectConnection:r}}),h.apply(this,arguments)}l.supportsDirectConnection=d,l.enablePostcodeInCatalog=m,l.directConnectionBusinessNumbersFromAbprop=p,l.genDirectConnectionMessageModifiers=g}),98);
__d("WAWebEmojiDownloadSuggestions",["JSResource","Promise","WAWebL10nGetRenderedLocale","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var t=new Set(["en_GB",o("WAWebL10nGetRenderedLocale").WAWebL10nGetRenderedLocale()]),r=yield(e||(e=n("Promise"))).all(Array.from(t).map(c));return r.filter(Boolean)}catch(e){return[]}}),u.apply(this,arguments)}function c(t){switch(t){case"en_GB":case"en_IN":case"en_OP":case"en_PI":case"en_UD":case"en_US":case"en_XA":return r("JSResource")("WAWebLocalesEmojiSuggestionEn").__setRef("WAWebEmojiDownloadSuggestions").load();case"pt_BR":case"pt_PT":return r("JSResource")("WAWebLocalesEmojiSuggestionPt").__setRef("WAWebEmojiDownloadSuggestions").load();case"de_DE":return r("JSResource")("WAWebLocalesEmojiSuggestionDe").__setRef("WAWebEmojiDownloadSuggestions").load();case"es_CL":case"es_CO":case"es_ES":case"es_LA":case"es_MX":case"es_VE":return r("JSResource")("WAWebLocalesEmojiSuggestionEs").__setRef("WAWebEmojiDownloadSuggestions").load();case"it_IT":return r("JSResource")("WAWebLocalesEmojiSuggestionIt").__setRef("WAWebEmojiDownloadSuggestions").load();case"ru_RU":return r("JSResource")("WAWebLocalesEmojiSuggestionRu").__setRef("WAWebEmojiDownloadSuggestions").load();case"ar_AR":return r("JSResource")("WAWebLocalesEmojiSuggestionAr").__setRef("WAWebEmojiDownloadSuggestions").load();case"tr_TR":return r("JSResource")("WAWebLocalesEmojiSuggestionTr").__setRef("WAWebEmojiDownloadSuggestions").load();case"uk_UA":return r("JSResource")("WAWebLocalesEmojiSuggestionUk").__setRef("WAWebEmojiDownloadSuggestions").load();case"bn_IN":return r("JSResource")("WAWebLocalesEmojiSuggestionBn").__setRef("WAWebEmojiDownloadSuggestions").load();case"hi_IN":case"hi_FB":return r("JSResource")("WAWebLocalesEmojiSuggestionHi").__setRef("WAWebEmojiDownloadSuggestions").load();case"hu_HU":return r("JSResource")("WAWebLocalesEmojiSuggestionHu").__setRef("WAWebEmojiDownloadSuggestions").load();case"ms_MY":return r("JSResource")("WAWebLocalesEmojiSuggestionMs").__setRef("WAWebEmojiDownloadSuggestions").load();case"pl_PL":return r("JSResource")("WAWebLocalesEmojiSuggestionPl").__setRef("WAWebEmojiDownloadSuggestions").load();case"ro_RO":return r("JSResource")("WAWebLocalesEmojiSuggestionRo").__setRef("WAWebEmojiDownloadSuggestions").load();case"th_TH":return r("JSResource")("WAWebLocalesEmojiSuggestionTh").__setRef("WAWebEmojiDownloadSuggestions").load();case"ur_PK":return r("JSResource")("WAWebLocalesEmojiSuggestionUr").__setRef("WAWebEmojiDownloadSuggestions").load();case"id_ID":return r("JSResource")("WAWebLocalesEmojiSuggestionId").__setRef("WAWebEmojiDownloadSuggestions").load();case"fa_IR":return r("JSResource")("WAWebLocalesEmojiSuggestionFa").__setRef("WAWebEmojiDownloadSuggestions").load();case"mr_IN":return r("JSResource")("WAWebLocalesEmojiSuggestionMr").__setRef("WAWebEmojiDownloadSuggestions").load();case"gu_IN":return r("JSResource")("WAWebLocalesEmojiSuggestionGu").__setRef("WAWebEmojiDownloadSuggestions").load();case"fr_FR":case"fr_CA":return r("JSResource")("WAWebLocalesEmojiSuggestionFr").__setRef("WAWebEmojiDownloadSuggestions").load();case"zh_TW":return r("JSResource")("WAWebLocalesEmojiSuggestionZhTw").__setRef("WAWebEmojiDownloadSuggestions").load();case"zh_CN":return r("JSResource")("WAWebLocalesEmojiSuggestionZhCn").__setRef("WAWebEmojiDownloadSuggestions").load();case"zh_HK":return r("JSResource")("WAWebLocalesEmojiSuggestionZhHk").__setRef("WAWebEmojiDownloadSuggestions").load();case"nl_NL":case"nl_BE":return r("JSResource")("WAWebLocalesEmojiSuggestionNl").__setRef("WAWebEmojiDownloadSuggestions").load();case"cs_CZ":return r("JSResource")("WAWebLocalesEmojiSuggestionCs").__setRef("WAWebEmojiDownloadSuggestions").load();case"sk_SK":return r("JSResource")("WAWebLocalesEmojiSuggestionSk").__setRef("WAWebEmojiDownloadSuggestions").load();default:return(e||(e=n("Promise"))).resolve(null)}}l.downloadEmojiSuggestions=s}),98);
__d("WAWebEmojiKeywordToUnicode",["WAArraysShallowEqual","WALogger","WAWebEmojiDownloadSuggestions","WAWebEmojiSearch","WAWebEventsWaitForBbEvent","WAWebL10N","WAWebNoop","WAWebStreamModel","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u=null;function c(t){return u!=null?o("WAWebEmojiSearch").emojiSearch(t,u):(o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Emoji Trie is not loaded."]))).sendLogs("Emoji Trie is not loaded"),[])}var d=null,m=[];function p(){f();var e=["en"],t=r("WAWebL10N").getNormalizedLocale();if(t!=="en"&&e.push(t),!r("WAArraysShallowEqual")(m,e)){m=e;var a=o("WAWebEmojiDownloadSuggestions").downloadEmojiSuggestions().then((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){d===a&&(u=yield o("WAWebEmojiSearch").emojiLocaleDictsToTrie(e))});return function(t){return e.apply(this,arguments)}})()).catch(r("WAWebNoop")).finally(function(){d===a&&(d=null)});d=a}}var _=!1;function f(){if(!_){try{r("WAWebL10N").on("locale_change",function(){p()})}catch(e){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[emoji-trie] subscription to locale_change failed: ",", stack: ",""])),e,e.stack).sendLogs("[emoji-trie] subscription to locale_change failed: "+e.message)}r("WAWebEventsWaitForBbEvent")(o("WAWebStreamModel").Stream,"change:mode",function(){return o("WAWebStreamModel").Stream.mode===o("WAWebStreamModel").StreamMode.MAIN}).then(function(){p()}),_=!0}}l.emojiKeywordToUnicodeSearch=c,l.updateEmojiTrie=p}),98);
__d("WAWebEmojiSearch",["WALogger","WATrie","WAWebEmoji","WAWebRecentEmojiCollection","asyncToGeneratorRuntime","justknobx","once","requireDeferred"],(function(t,n,r,o,a,i,l){var e,s=r("requireDeferred")("WAFtsMultiLangTokenizer").__setRef("WAWebEmojiSearch"),u=["\uD83D\uDE02","\uD83E\uDD23","\u2764","\uD83E\uDD7A","\uD83E\uDD70","\uD83D\uDE18","\uD83D\uDE2D","\uD83D\uDE0D","\uD83D\uDE01","\uD83D\uDE4F","\uD83D\uDE05","\uD83D\uDE06","\uD83D\uDE0A","\uD83D\uDE42","\uD83D\uDE14","\uD83E\uDD73","\uD83D\uDE12","\u263A","\uD83C\uDF82","\uD83D\uDC4D","\uD83D\uDC96","\uD83D\uDE22","\uD83D\uDE44","\uD83D\uDE0F","\uD83D\uDE0E","\uD83D\uDC8B","\uD83D\uDE1E","\uD83D\uDE09","\uD83D\uDC4F","\uD83D\uDE43","\uD83D\uDE21","\uD83D\uDE00","\uD83D\uDE04","\uD83D\uDE07","\uD83E\uDD29","\uD83D\uDE0C","\uD83E\uDD14","\uD83C\uDF39","\uD83D\uDE0B","\uD83D\uDC97","\uD83E\uDD17","\uD83D\uDC95","\uD83D\uDC94","\uD83D\uDE1A","\u2639","\uD83D\uDE03","\uD83C\uDF89","\uD83D\uDD25","\uD83E\uDD74","\uD83D\uDE33"],c=["SMILEYS_PEOPLE","ANIMALS_NATURE","FOOD_DRINK","ACTIVITY","TRAVEL_PLACES","OBJECTS","SYMBOLS","FLAGS","VARIATION"];function d(e,t){var n=[];if(e){var r=_(e.toLowerCase(),t);n=Array.from(new Set(r))}return n}function m(e,t){if(!t)return[];if(e.length<=5)return t.getMatches(e);var n=e.substring(0,5).trim(),r=t.getMatches(n);return r=r.filter(function(t){return t.keyword.startsWith(e)}),r}function p(e){return e.map(o("WAWebEmoji").EmojiUtil.normalizeEmoji).filter(Boolean)}function _(t,n){var a,i=s.getModuleIfRequireable();i?a=new i:o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["WAFtsMultiLangTokenizer not loaded"]))).sendLogs("WAFtsMultiLangTokenizer not loaded");var l;if(a&&r("justknobx")._("2148")){var c=Array.from(a.tokenize(t)),d=c.map(function(e){return m(e,n)});d.length===0?l=[]:d.length===1?l=d[0]:l=d.reduce(function(e,t){return e.filter(function(e){return t.map(function(e){return e.value}).includes(e.value)})},d[0])}else l=m(t,n);var _=p(l.flatMap(function(e){return e.value})),f=p(l.filter(function(e){return e.keyword===t}).flatMap(function(e){return e.value})),h=b(p(o("WAWebRecentEmojiCollection").RecentEmojiCollection.map(function(e){return e.id})),_),y=b(p(u),_),C=b(v(h,y),f);return v(C,g(f),h,y,g(_))}var f=r("once")(function(){var e=new Map,t=0;for(var n of c){var r=o("WAWebEmoji").EmojiUtil.getEmojisInCategory(n);for(var a of r)e.set(a,t),t++}return e});function g(e){var t=f();return e.toSorted(function(e,n){var r,o,a=(r=t.get(e))!=null?r:Number.MAX_SAFE_INTEGER,i=(o=t.get(n))!=null?o:Number.MAX_SAFE_INTEGER;return a-i})}function h(e){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e[0];e.length>1&&(t=babelHelpers.extends({},t,e[1]));var n=yield s.load(),o=new n,a;return r("justknobx")._("2148")?a=Object.entries(t).flatMap(function(e){var t=e[0],n=e[1],r=t.toLowerCase(),a=Array.from(o.tokenize(r));return a.map(function(e){return{value:n,keyword:e,shortKeyword:e.substring(0,5)}})}):a=Object.entries(t).flatMap(function(e){var t=e[0],n=e[1],r=t.toLowerCase(),o=r.substring(0,5);return{value:n,keyword:r,shortKeyword:o}}),C(a,"shortKeyword")}),y.apply(this,arguments)}function C(e,t){var n=r("WATrie").fromForwardsStrings(e.map(function(e){return e[t]}),e);return{getMatches:function(t){return n.search(t)}}}function b(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.length===0?[]:t.length===1?t[0]:t.reduce(function(e,t){return e.filter(function(e){return t.includes(e)})},t[0])}function v(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.from(new Set(t.flat(1)))}l.emojiSearch=d,l.emojiLocaleDictsToTrie=h}),98);
__d("WAWebAddWebpMetadata",["WATypedArraysConcat","WAWebWebp","WAWebWebpMetadata","err"],(function(t,n,r,o,a,i,l){function e(e,t){var n=new Uint8Array(e);if(!o("WAWebWebp").isExtendedFile(n))throw r("err")("Not extended");var a=o("WAWebWebpMetadata").toRawWebpMetadata(t),i=u(a),l=o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[n,i]);l.set(o("WAWebWebp").numberToLittleEndian(l.byteLength-8),4);var s=l.buffer;return s}function s(e,t){return o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[o("WAWebWebp").stringToUint8(e),o("WAWebWebp").numberToLittleEndian(t)])}function u(e){var t=new TextEncoder,n=JSON.stringify(e),r=t.encode(n),a=c(r),i=[s(o("WAWebWebp").Chunk.EXIF,a.byteLength),a];r.byteLength%2!==0&&i.push(new Uint8Array([0]));var l=o("WATypedArraysConcat").concatTypedArrays(Uint8Array,i);return l}function c(e){var t,n=o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[(t=o("WAWebWebp")).stringToUint8("II"),new Uint8Array([42,0]),t.numberToLittleEndian(8),new Uint8Array([1,0]),t.stringToUint8("AW"),new Uint8Array([7,0]),t.numberToLittleEndian(e.byteLength),t.numberToLittleEndian(22),e]);return n}l.addWebpMetadata=e}),98);
__d("WAWebMediaCacheModel",["WALogger","WAWebBaseModel","WAWebODS","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m={DATA_URL:1,BLOB:2,CANVAS:4},p=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.key=o("WAWebBaseModel").session(),t.value=o("WAWebBaseModel").session(),t.id=o("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e),t.getStringKey=function(t){throw r("err")("Not implemented")};var n=t.prototype;return n.isKeyEqual=function(n){return t.getStringKey(n)===t.getStringKey(this.key)},n.toString=function(){return t.getStringKey(this.key)},t})(o("WAWebBaseModel").BaseModel),_=o("WAWebBaseModel").defineModel(p),f=(function(t){function n(){return t.apply(this,arguments)||this}babelHelpers.inheritsLoose(n,t),n.getStringKey=function(t){var e=t.file,n=e.name+"-"+e.size+"-"+e.lastModified;return n};var a=n.prototype;return a.isMaxDimensionSame=function(n){return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[resize-rotate-media-cache] maxDimension is the same "," === ",""])),this.key.maxDimension,n.maxDimension),this.key.maxDimension===n.maxDimension},a.isOutputTypeSame=function(t){return o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[resize-rotate-media-cache] outputType is the same ",""])),(this.key.outputType&t.outputType)===t.outputType),(this.key.outputType&t.outputType)===t.outputType},a.isOptsSame=function(t){o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[resize-rotate-media-cache] opts is the same "," === ",""])),JSON.stringify(this.key.opts),JSON.stringify(t.opts));var e=this.key.opts,n=t.opts;return(e==null?void 0:e.fitToSquare)===(n==null?void 0:n.fitToSquare)&&(e==null?void 0:e.minDimension)===(n==null?void 0:n.minDimension)&&(e==null?void 0:e.transparency)===(n==null?void 0:n.transparency)},a.isKeyEqual=function(t){var e=n.getStringKey(t)===n.getStringKey(this.key);if(!e)return o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[resize-rotate-media-cache] key is not equal"]))),!1;var a=this.isMaxDimensionSame(t),i=this.isOutputTypeSame(t),l=this.isOptsSame(t),s=a&&i&&l;return s?(r("WAWebODS").incr("web.app.resizeRotateMediaCache.sameFileSameOption"),!0):(o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[resize-rotate-media-cache] sameFileDifferentOption,",", "," ",""])),a,i,l),r("WAWebODS").incr("web.app.resizeRotateMediaCache.sameFileDifferentOption"),!1)},n})(p),g=o("WAWebBaseModel").defineModel(f);l.ImageOutputTypes=m,l.MediaCache=_,l.ResizeRotateMediaCacheImpl=f,l.ResizeRotateMediaCache=g}),98);
__d("WAWebMediaJpeg",["WABinary","WAProgressiveJpegMarkers","err"],(function(t,n,r,o,a,i,l){function e(e){var t=new(o("WABinary")).Binary;return t.writeBytes(255,216,255,224,0,16,74,70,73,70,0),t.writeUint16(e.version),t.writeUint8(e.densityUnits),t.writeUint16(e.xDensity),t.writeUint16(e.yDensity),t.writeBytes(0,0),t.readByteArrayView()}function s(t){var n=new(o("WABinary")).Binary(t),a=new(o("WABinary")).Binary(t),i=new(o("WABinary")).Binary,l=2,s=2,u=!1,c=!1,d=!1,m=!1,p,_={version:257,densityUnits:0,xDensity:1,yDensity:1};if(!(n.readUint8()===o("WAProgressiveJpegMarkers").MARKER_PREFIX&&n.readUint8()===o("WAProgressiveJpegMarkers").MARKERS.SOI))throw r("err")("SOI marker not at the start of the file.");a.advance(l);for(var f=void 0;f!=null||n.size();){if(f===void 0){var g=n.readUint8();if(g!==o("WAProgressiveJpegMarkers").MARKER_PREFIX)throw r("err")("0x"+g.toString(16)+" is not a marker prefix.");f=n.readUint8()}switch(f){case o("WAProgressiveJpegMarkers").MARKERS.APP0:if(c)p=n.readUint16(),a.advance(p+l),n.advance(n.size()-a.size());else{if(p=n.readUint16(),n.readString(5)!=="JFIF\0")throw r("err")("APP0 marker missing 'JFIF' magic bytes.");m=!0,_.version=n.readUint16(),_.densityUnits=n.readUint8(),_.xDensity=n.readUint16(),_.yDensity=n.readUint16(),a.advance(p+l),n.advance(n.size()-a.size()),c=!0}break;case o("WAProgressiveJpegMarkers").MARKERS.SOS:{if(!d&&!m)throw r("err")("Missing magic bytes marker.");n.advance(n.readUint16()-s);for(var h=void 0,y=void 0,C=n.readUint8();n.size();){if(y=n.readUint8(),h=C===o("WAProgressiveJpegMarkers").MARKER_PREFIX&&!o("WAProgressiveJpegMarkers").SOS_STREAM.includes(y),h){f=y;break}C=y}i.writeByteArray(a.readByteArrayView(a.size()-n.size()-l));continue}case o("WAProgressiveJpegMarkers").MARKERS.APP1:if(p=n.readUint16(),!d&&n.readString(6)!=="Exif\0\0")throw r("err")("APP1 marker missing 'EXIF' magic bytes.");d=!0,a.advance(p+l),n.advance(n.size()-a.size());break;case o("WAProgressiveJpegMarkers").MARKERS.APP13:case o("WAProgressiveJpegMarkers").MARKERS.COM:if(!d&&!m)throw r("err")("Missing magic bytes marker.");p=n.readUint16(),a.advance(p+l),n.advance(n.size()-a.size());break;case o("WAProgressiveJpegMarkers").MARKERS.EOI:if(!d&&!m)throw r("err")("Missing magic bytes marker.");u=!0,i.writeByteArray(a.readByteArrayView(l));break;case o("WAProgressiveJpegMarkers").MARKERS.SOF0:case o("WAProgressiveJpegMarkers").MARKERS.SOF1:case o("WAProgressiveJpegMarkers").MARKERS.SOF2:case o("WAProgressiveJpegMarkers").MARKERS.SOF3:case o("WAProgressiveJpegMarkers").MARKERS.SOF5:case o("WAProgressiveJpegMarkers").MARKERS.SOF6:case o("WAProgressiveJpegMarkers").MARKERS.SOF7:case o("WAProgressiveJpegMarkers").MARKERS.SOF9:case o("WAProgressiveJpegMarkers").MARKERS.SOF10:case o("WAProgressiveJpegMarkers").MARKERS.SOF11:case o("WAProgressiveJpegMarkers").MARKERS.SOF13:case o("WAProgressiveJpegMarkers").MARKERS.SOF14:case o("WAProgressiveJpegMarkers").MARKERS.SOF15:case o("WAProgressiveJpegMarkers").MARKERS.DQT:case o("WAProgressiveJpegMarkers").MARKERS.DHT:case o("WAProgressiveJpegMarkers").MARKERS.DRI:if(!d&&!m)throw r("err")("Missing magic bytes marker.");p=n.readUint16(),i.writeByteArray(a.readByteArrayView(l+p)),n.advance(n.size()-a.size());break;case o("WAProgressiveJpegMarkers").MARKERS.APP2:case o("WAProgressiveJpegMarkers").MARKERS.APP3:case o("WAProgressiveJpegMarkers").MARKERS.APP4:case o("WAProgressiveJpegMarkers").MARKERS.APP5:case o("WAProgressiveJpegMarkers").MARKERS.APP6:case o("WAProgressiveJpegMarkers").MARKERS.APP7:case o("WAProgressiveJpegMarkers").MARKERS.APP8:case o("WAProgressiveJpegMarkers").MARKERS.APP9:case o("WAProgressiveJpegMarkers").MARKERS.APP10:case o("WAProgressiveJpegMarkers").MARKERS.APP11:case o("WAProgressiveJpegMarkers").MARKERS.APP12:case o("WAProgressiveJpegMarkers").MARKERS.APP14:case o("WAProgressiveJpegMarkers").MARKERS.APP15:throw r("err")("Received unexpected APP marker 0x"+f.toString(16));default:throw r("err")("Did not understand marker: 0x"+f.toString(16))}if(f=void 0,u)break}if(!u)throw r("err")("No EOI tag found.");var b=e(_);return new Blob([b,i.readByteArrayView()],{type:"image/jpeg"})}l.cleanJPEG=s}),98);
__d("WAWebStickerConstants",[],(function(t,n,r,o,a,i){var e=512,l=8,s=36,u=156,c=20,d=1440*60;i.STICKER_DIMENSION=e,i.STICKER_BORDER_WIDTH=l,i.STICKER_PADDING=s,i.STICKER_LIST_ITEM_HEIGHT=u,i.STICKER_MAKER_IMAGE_PADDING=c,i.STICKER_PACK_FETCH_TIMEOUT=d}),66);
__d("WAWebImageUtils",["Promise","WACustomError","WAExponentialBackoff","WALogger","WAPromiseProps","WAWebAddWebpMetadata","WAWebCanvasUtils","WAWebFileUtils","WAWebImageGeometry","WAWebMediaCacheCollection","WAWebMediaCacheModel","WAWebMediaJpeg","WAWebMediaLoad","WAWebMiscErrors","WAWebModernizr","WAWebNoop","WAWebPREGatingUtils","WAWebStickerConstants","WAWebUA","WAWebWebpMetadata","asyncToGeneratorRuntime","err","exif-component"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WACustomError").customError("BlackVideoThumbnailError"));g.message="Generated video thumbnail is black";var h=function(t){var e=t.video,n=t.fullWidth,r=t.fullHeight,a=t.maxDimension,i=document.createElement("canvas"),l=o("WAWebImageGeometry").boundHeightWidth(r,n,a),s=l.width,u=l.height;i.width=s,i.height=u;var c=i.getContext("2d");c.drawImage(e,0,0,s,u);var d=c.getImageData(0,0,s,u),m=i.toDataURL("image/jpeg"),p={url:m,width:s,height:u,fullWidth:n,fullHeight:r};return{thumb:p,imageData:d}};function y(e){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=t.file,i=t.maxDimensions,l=t.debugHint,c=t.throwOnBlack,d=c===void 0?!1:c,m=yield o("WAWebMediaLoad").loadVideo(a),p=m.video,_=m.fullWidth,y=m.fullHeight;if(o("WAWebUA").UA.isBuggyVideoLoad){var C=50,b=5e3/C;return o("WAExponentialBackoff").exponentialBackoff({minTimeout:C,maxTimeout:C,retries:b,signal:new AbortController().signal,factor:1},function(t,a){var u=[],c;for(c of i){var m=h({video:p,fullHeight:y,fullWidth:_,maxDimension:c}),C=m.thumb,v=m.imageData;if(w(v)){if(a<b)return a===0&&o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["generateVideoThumbsAndDuration: Setting video.currentTime to 0 to attempt to unblock the video"]))),p.currentTime=0,t(r("err")("retry"));if(o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["generateVideoThumbsAndDuration: Failed to generate video thumbnail from ",""])),l).sendLogs("thumbnail-generation-failed-"+l,{sampling:.001}),d)throw new g}u.push(C)}var S={duration:~~p.seekable.end(0),thumbs:u};return o("WAWebMediaLoad").disposeVideo(p),(f||(f=n("Promise"))).resolve(S)})}try{var v=i.map(function(e){var t=h({video:p,fullHeight:y,fullWidth:_,maxDimension:e}),n=t.thumb,r=t.imageData;if(w(r)&&(o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["generateVideoThumbsAndDuration: Failed to generate video thumbnail from ",""])),l).sendLogs("thumbnail-generation-failed-"+l,{sampling:.001}),d))throw new g;return n});return{duration:~~p.seekable.end(0),thumbs:v}}finally{o("WAWebMediaLoad").disposeVideo(p)}}),C.apply(this,arguments)}function b(e,t,n,r,o,a,i,l){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a,i,l,s){s===void 0&&(s=o("WAWebMediaCacheModel").ImageOutputTypes.DATA_URL);var u=e instanceof HTMLCanvasElement?e:yield o("WAWebMediaLoad").loadImage(e),c=document.createElement("canvas"),d=c.getContext("2d");i==null||l==null?(c.height=a,c.width=r,d.drawImage(u,t,n,r,a)):(c.height=l,c.width=i,d.drawImage(u,t,n,r,a,0,0,i,l));var m={};P(m,c,s);var p=yield o("WAPromiseProps").promiseProps(m);return{images:p,width:r,height:a}}),v.apply(this,arguments)}var S=new(o("WAWebMediaCacheCollection")).WAWebMediaResizeRotateCacheCollection;function R(e,t,n,r){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,i){var l=e instanceof File?{file:e,maxDimension:t,outputType:a,opts:i}:null;if(l!=null){var s=S.getModelsArray().find(function(e){return e.isKeyEqual(l)}),u=s==null?void 0:s.value;if(o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[WAWebImageUtils]: cachedValue: exists ",""])),u!=null),s&&u&&s.isKeyEqual(l)&&o("WAWebPREGatingUtils").isPREMediaUploadCacheEnabled())return(f||(f=n("Promise"))).resolve(u)}var p=i!=null?i:{},_=p.transparency,g=_===void 0?!1:_,h=p.fitToSquare,y=h===void 0?!1:h,C=p.minDimension,b=C===void 0?0:C,v=new ArrayBuffer(0),R,L,E;e instanceof HTMLCanvasElement?(L=(f||(f=n("Promise"))).resolve(e),E=f.resolve(v)):(R=window.URL.createObjectURL(e),L=o("WAWebMediaLoad").loadImage(R),E=o("WAWebFileUtils").blobToArrayBuffer(e).catch(function(e){return o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["ImageUtils::rotateAndResize error: ",""])),e).devConsole(e),v}));var k=o("WAPromiseProps").promiseProps({buffer:E,image:L}).then(function(e){var n,i=e.buffer,l=e.image,s={};try{s=r("exif-component")(i)}catch(e){}var u=0;if(!((n=o("WAWebModernizr").getModernizr())!=null&&n.exiforientation))switch(s.orientation||"UNKNOWN"){case"right-top":u=1;break;case"left-bottom":u=-1;break;case"bottom-right":u=2;break}var c=document.createElement("canvas"),d=l.naturalWidth||l.width,p=l.naturalHeight||l.height,_=Math.max(d,p),f=c.getContext("2d"),h={};if(u)switch(u){case 1:case-1:{var C=Math.max(d,p),v=C/2;c.width=c.height=C,g||o("WAWebCanvasUtils").fillBackgroundWithGray(c),o("WAWebCanvasUtils").rotate(f,{x:v,y:v,degrees:u*90}),u===1?f.drawImage(l,0,C-p):f.drawImage(l,C-d,0),o("WAWebCanvasUtils").rotate(f,{x:v,y:v,degrees:u*-90}),o("WAWebCanvasUtils").resize(c,p,d),y&&o("WAWebCanvasUtils").square(c),_<b&&o("WAWebCanvasUtils").scale(c,b);var S=o("WAWebCanvasUtils").contain(c,t);return P(h,S,a,g),o("WAPromiseProps").promiseProps(h).then(function(e){return{width:S.width,height:S.height,images:e}})}case 2:{var R=o("WAWebImageGeometry").boundHeightWidth(p,d,t),L=c.width=R.width,E=c.height=R.height;return g||o("WAWebCanvasUtils").fillBackgroundWithGray(c),o("WAWebCanvasUtils").rotate(f,{x:L/2,y:E/2,degrees:u*90}),f.drawImage(l,0,0,L,E),o("WAWebCanvasUtils").rotate(f,{x:L/2,y:E/2,degrees:u*-90}),y&&o("WAWebCanvasUtils").square(c),_<b&&o("WAWebCanvasUtils").scale(c,b),P(h,c,a,g),o("WAPromiseProps").promiseProps(h).then(function(e){return{width:c.width,height:c.height,images:e}})}}else{var k=o("WAWebImageGeometry").boundHeightWidth(p,d,t),I,T,D=a&o("WAWebMediaCacheModel").ImageOutputTypes.BLOB;if(i&&D&&d===k.width&&p===k.height)try{var x=o("WAWebMediaJpeg").cleanJPEG(i);h.blob=x,D=!1,I=d,T=p}catch(e){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Could not parse JPEG: ",""])),e.message)}return(D||a&~o("WAWebMediaCacheModel").ImageOutputTypes.BLOB)&&(c.width=k.width,c.height=k.height,g||o("WAWebCanvasUtils").fillBackgroundWithGray(c),f.drawImage(l,0,0,c.width,c.height),y&&(o("WAWebCanvasUtils").square(c),h.blob=void 0),_<b&&(o("WAWebCanvasUtils").scale(c,b),h.blob=void 0),I=c.width,T=c.height,P(h,c,a,g)),o("WAPromiseProps").promiseProps(h).then(function(e){return{width:I,height:T,images:e}})}}).finally(r("WAWebNoop")),I=yield k;if(l!=null&&o("WAWebPREGatingUtils").isPREMediaUploadCacheEnabled()){var T=new(o("WAWebMediaCacheModel")).ResizeRotateMediaCache({id:o("WAWebMediaCacheModel").ResizeRotateMediaCacheImpl.getStringKey(l),key:l,value:I});S.add(T)}return k}),L.apply(this,arguments)}function E(e,t){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){try{var n=yield e.arrayBuffer(),r=o("WAWebAddWebpMetadata").addWebpMetadata(n,t),a=new Uint8Array(r),i=new Blob([a],{type:"image/webp"});return i}catch(t){return o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["addMetadataToSticker: Unable to add metadata to Sticker"]))).sendLogs("unable-to-add-sticker-metadata"),e}}),k.apply(this,arguments)}function I(e){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){try{var t=window.URL.createObjectURL(e),n=yield o("WAWebMediaLoad").loadImage(t);window.URL.revokeObjectURL(t);var r=o("WAWebStickerConstants").STICKER_DIMENSION,a=o("WAWebCanvasUtils").createCanvas(r,r),i=a.getContext("2d"),l=o("WAWebImageGeometry").aspectRatioScaled(n.width/n.height,r),s=l.width,u=l.height,c=(r-s)/2,d=(r-u)/2;i.drawImage(n,c,d,s,u);var m=yield o("WAWebCanvasUtils").canvasToWebp(a),p=yield E(m,{isFirstParty:!1,isFromStickerMaker:!0,emojis:[],stickerPackPublisher:"WhatsApp Sticker Maker",stickerMakerSourceType:o("WAWebWebpMetadata").StickerMakerSourceType.WebStickerMaker});return p}catch(e){throw o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Webp sticker file generation failed: "]))).devConsole(e),e}}),T.apply(this,arguments)}function D(e){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){try{var t=yield o("WAWebMediaLoad").loadImage(e),n=document.createElement("canvas");n.width=t.naturalWidth,n.height=t.naturalHeight;var r=n.getContext("2d");return o("WAWebCanvasUtils").fillBackgroundWithGray(n),r.drawImage(t,0,0),o("WAWebCanvasUtils").canvasToBlob(n)}catch(t){throw new(o("WAWebMiscErrors")).MediaDragDropError("unable to render image",e)}}),x.apply(this,arguments)}function $(e){if(!e)return!1;var t=new Image;return t.src=e,!!t.complete}function P(e,t,r,a){a===void 0&&(a=!1);var i=a?"image/png":"image/jpeg";!e.blob&&r&o("WAWebMediaCacheModel").ImageOutputTypes.BLOB&&(e.blob=o("WAWebCanvasUtils").canvasToBlob(t,i)),!e.dataUrl&&r&o("WAWebMediaCacheModel").ImageOutputTypes.DATA_URL&&(e.dataUrl=(f||(f=n("Promise"))).resolve(t.toDataURL(i))),!e.canvas&&r&o("WAWebMediaCacheModel").ImageOutputTypes.CANVAS&&(e.canvas=(f||(f=n("Promise"))).resolve(t))}function N(e){return M.apply(this,arguments)}function M(){return M=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebMediaLoad").loadImage(e),n=o("WAWebCanvasUtils").createCanvas(t.width,t.height),r=n.getContext("2d");return r.drawImage(t,0,0),n}),M.apply(this,arguments)}function w(e){for(var t=e.data,n=e.width,r=e.height,o=0;o<r;o++){var a=Math.round(o*(n/r)),i=o*n+a,l=i*4,s=t[l];if(s!==0)return!1;var u=t[l+1];if(u!==0)return!1;var c=e.data[l+2];if(c!==0)return!1;var d=e.data[l+3];if(d!==0&&d!==255)return!1}return!0}l.DATA_URL=o("WAWebMediaCacheModel").ImageOutputTypes.DATA_URL,l.BLOB=o("WAWebMediaCacheModel").ImageOutputTypes.BLOB,l.CANVAS=o("WAWebMediaCacheModel").ImageOutputTypes.CANVAS,l.BlackVideoThumbnailError=g,l.generateVideoThumbsAndDuration=y,l.crop=b,l.rotateAndResize=R,l.toWebpSticker=I,l.urlToFile=D,l.isCached=$,l.base64ImageToCanvas=N}),98);
__d("WAWebMediaCacheCollection",["WAWebBaseCollection","WAWebMediaCacheModel"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebMediaCacheModel").MediaCache,e.staleCollection=!0;var s=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.add=function(n,r){var t=e.prototype.add.call(this,n,r);if(this.length>this.constructor.maxsize){var o=this.length-this.constructor.maxsize,a=this.slice(0,o);this.remove(a)}return t},t})(o("WAWebBaseCollection").BaseCollection);s.model=o("WAWebMediaCacheModel").ResizeRotateMediaCache,s.staleCollection=!0,s.maxsize=5,l.WAWebMediaCacheCollection=e,l.WAWebMediaResizeRotateCacheCollection=s}),98);
__d("WAWebUIRefreshGatingUtils",["WATimeUtils","WAWebABProps","WAWebEnvironment","WAWebGetSpecialAbProps","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebUserPrefsUiRefresh","gkx","justknobx"],(function(t,n,r,o,a,i,l){var e=r("justknobx")._("3750");function s(){return e&&r("WAWebEnvironment").isWeb===!0}var u=function(){var e=o("WAWebUserPrefsMeUser").getMaybeMeDevicePn();if((e==null?void 0:e.getDeviceId())!==1)return!1;var t=o("WAWebUserPrefsMultiDevice").getPairingTimestamp(),n=o("WATimeUtils").castToUnixTime(t!=null?t:o("WATimeUtils").unixTime()),r=o("WATimeUtils").happenedWithin(n,300);return r},c=function(){return o("WAWebGetSpecialAbProps").getSpecialAbpropValue("web_ui_refresh_m1")===!0||o("WAWebABProps").getABPropConfigValue("web_ui_refresh_m1")===!0};function d(){if(!s())return!0;var e=o("WAWebUserPrefsUiRefresh").getNuxViewCount();return e>0||o("WAWebUserPrefsUiRefresh").getUiRefreshNuxAcked()}function m(){return r("gkx")("26256")?r("gkx")("6024"):_()||f()||c()&&d()}function p(){return c()&&!d()}function _(){return r("WAWebEnvironment").isWindows===!0&&r("justknobx")._("2772")===!0}function f(){return r("WAWebEnvironment").isGuest}function g(){return _()||o("WAWebABProps").getABPropConfigValue("web_other_items_on_navbar_enabled")&&m()}function h(){return o("WAWebABProps").getABPropConfigValue("web_new_chat_flow_refresh_variant")}function y(){var e;return(e=o("WAWebGetSpecialAbProps").getSpecialAbpropValue("wa_web_favicons_update_m1"))!=null?e:!1}l.isUiRefreshNuxEnabledOnPlatform=s,l.isFirstPairedDeviceWithin5Minutes=u,l.uiRefreshM1Enabled=m,l.uiRefreshM1EnabledNotUpdated=p,l.checkIfShouldBeEnabledInWindowsEnv=_,l.sideNavSecondarySectionEnabled=g,l.newChatFlowRefreshVariant=h,l.isFaviconsUpdateEnabled=y}),98);
__d("WAWebLoggerDebugInfo",["WAWebABPropsSaga","WAWebConnModel","WAWebCrashlogConstants","WAWebEnvironment","WAWebL10N","WAWebLid1X1MigrationGating","WAWebTasksDailyStatsTask","WAWebUA","WAWebUIRefreshGatingUtils","WAWebUserPrefsGeneral","WAWebUserPrefsMeUser","WAWebWam","WAWebWamGlobals","asyncToGeneratorRuntime","gkx"],(function(t,n,r,o,a,i,l){var e=new Map([["appIsBetaRelease","is-beta"],["appVersion","version"],["browserVersion","browser-version"],["deviceName","os"],["mcc","phone-mcc"],["mnc","phone-mnc"],["webc_bucket","exp-bucket"],["webcPhoneAppVersion","phone-app-version"],["webcPhoneCharging","is-phone-charging"],["webcPhoneDeviceManufacturer","phone-manufacturer"],["webcPhoneDeviceModel","phone-model"],["webcPhoneOsVersion","phone-os-version"],["webcPhonePlatform","phone-os"],["webcWebPlatform","platform"],["webcProtoVersion","protocol-version"],["deviceID","device-id"],["webcWebArch","device-arch"],["webcWebDeviceManufacturer","device-manufacturer"],["webcWebDeviceModel","device-model"],["webcWebOsReleaseNumber","device-release"],["deviceVersion","os-version"],["userAgent","user-agent"],["mdEnabled","md-enabled"],["hasMdCompanion","has-md-companion"],["entityId","entity id"],["isLidMigrated","is_lid_migrated"],["lidCompletedMigrations","lid_completed_migrations"],["isUiRefreshEnabled","ui-refresh-enabled"]]);function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){o("WAWebWam").Wam.initialize();var t=babelHelpers.extends({},o("WAWebWamGlobals").Global.all,{webcWebPlatform:o("WAWebCrashlogConstants").CLB_PLATFORM,webcPhonePlatform:o("WAWebConnModel").Conn.platform,webcProtoVersion:String(o("WAWebConnModel").Conn.protoVersion)});r("WAWebEnvironment").isWindows&&(t.subplatform=o("WAWebCrashlogConstants").CLB_SUBPLATFORM),r("gkx")("26259")?t.releaseChannel="intern":r("gkx")("26258")&&(t.releaseChannel="production");var n=o("WAWebUserPrefsMeUser").getMaybeMeDevicePn();if(n&&(t.deviceID=n.toString()),r("gkx")("11584")){t.saga_copy=o("WAWebABPropsSaga").getIsSagaV1Enabled().toString();var a=o("WAWebUserPrefsMeUser").getMePnUserOrThrow();t.pn=a.user.toString()}var i={};for(var l in t){var s=t[l];s!=null&&(i[l]=s)}i.debugIsExternalBeta=yield o("WAWebUserPrefsGeneral").getWhatsAppWebExternalBetaJoinedIdb(),i.isLidMigrated=o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated(),i.isUiRefreshEnabled=o("WAWebUIRefreshGatingUtils").uiRefreshM1Enabled();var u=yield o("WAWebTasksDailyStatsTask").getLidMigrationStatus();if(u.completedMigrations!=null&&(i.lidCompletedMigrations=u.completedMigrations),e){var d=e.supportTag,m=e.addUserAgentDetails,p=e.convertFields,_=e.entityId,f=e.addLanguageFields,g=e.user_review_score;if(d!=null&&(i.context=d),_!=null&&(i.entityId=_),g!=null&&(i.user_review_score=g),m===!0&&(i.userAgent=o("WAWebUA").UA.parser.getUA()),f===!0&&(i.lc=r("WAWebL10N").getRegion(),i.lg=r("WAWebL10N").getLanguage()),p===!0){var h=c(i);return h}}return i}),u.apply(this,arguments)}function c(t){var n={};for(var r of Object.entries(t)){var o,a=r[0],i=r[1];n[(o=e.get(a))!=null?o:a]=i}return n}l.getDebugInfo=s}),98);
__d("WAWebDocumentUploadEnrichment",["Promise","WALogger","WAPromiseTimeout","WAWebMimeTypes","WAWebPDFUtils"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t){var r;switch(o("WAWebMimeTypes").previewType(t)){case"pdf":r=c(e);break;default:r=(s||(s=n("Promise"))).resolve()}return o("WAPromiseTimeout").promiseTimeout(r,3e3,"Document enrichment timeout").catch(function(){return null})}function c(t){var n;return o("WAWebPDFUtils").fileToPdf(t).then(function(e){return n=e,o("WAWebPDFUtils").pdfToImg(e,1)}).catch(function(t){return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["pdf preview generation failed"]))).devConsole(t),null}).finally(function(){n&&o("WAWebPDFUtils").releasePdf(n)})}l.enrich=u}),98);
__d("WAXMultiSitePdfWorkerResourceControllerRouteBuilder",["jsRouteBuilder"],(function(t,n,r,o,a,i,l){var e=r("jsRouteBuilder")("/static_resources/webworker/pdf-worker/",Object.freeze({}),void 0),s=e;l.default=s}),98);
__d("WAWebPDFWorkerSrc",["WAXMultiSitePdfWorkerResourceControllerRouteBuilder"],(function(t,n,r,o,a,i,l){function e(){return r("WAXMultiSitePdfWorkerResourceControllerRouteBuilder").buildUri({}).toString()}l.getWorkerSrc=e}),98);
__d("WAWebPDFUtils",["JSResourceForInteraction","Promise","WABackoffUtils","WAPromiseDelays","WAPromiseLoop","WAPromiseProps","WAWebABProps","WAWebCanvasUtils","WAWebImageUtils","WAWebMediaConstants","WAWebMediaOpaqueData","WAWebMiscErrors","WAWebPDFWorkerSrc","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(){return o("WAPromiseLoop").promiseLoop(function(e,t,n){var a=o("WAPromiseDelays").delayMs(o("WABackoffUtils").expBackoff(n,12e4,0,0));return r("JSResourceForInteraction")("pdfjs-dist").__setRef("WAWebPDFUtils").load().then(function(t){t.GlobalWorkerOptions.workerSrc=o("WAWebPDFWorkerSrc").getWorkerSrc(),e({GlobalWorkerOptions:t.GlobalWorkerOptions,getDocument:t.getDocument})}).catch(function(){return a})})}function u(e){var t=URL.createObjectURL(e);return s().then(function(e){return e.getDocument({url:t,isEvalSupported:!1}).promise})}function c(e){return e.destroy()}function d(t,a){var i=document.createElement("canvas");return t.getPage(a).then(function(e){var t=e.getViewport({scale:1}),n=i.getContext("2d");i.height=t.height,i.width=t.width;var r={canvasContext:n,viewport:t};return e.render(r).promise}).then(function(){var t;return o("WAPromiseProps").promiseProps({blob:o("WAWebCanvasUtils").canvasToBlob(i),thumbnail:(t=o("WAWebImageUtils")).rotateAndResize(i,o("WAWebMediaConstants").DOC_THUMB_MAX_EDGE,t.DATA_URL|t.CANVAS|t.BLOB),microThumbnail:o("WAWebABProps").getABPropConfigValue("upload_document_thumb_mms_enabled")?o("WAWebCanvasUtils").generateMicroThumb(i,o("WAWebABProps").getABPropConfigValue("web_pdf_thumbnail_size_in_bytes"),{mimetype:"image/jpeg",maxAttempts:10}):(e||(e=n("Promise"))).resolve(null)})}).then(function(e){return e}).then((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n=e.blob,a=e.thumbnail,i=e.microThumbnail,l=a.images,s=l.canvas,u=l.blob,c=l.dataUrl;if(s==null||u==null||c==null)throw new(o("WAWebMiscErrors")).MediaFileFailedLoad;return{url:URL.createObjectURL(n),thumbUrl:c,width:s.width,height:s.height,fullPreviewData:yield r("WAWebMediaOpaqueData").createFromData(u,"image/jpeg"),fullPreviewSize:{width:s.width,height:s.height},pdfPages:t.numPages,microThumbnail:i}});return function(t){return e.apply(this,arguments)}})())}l.fileToPdf=u,l.releasePdf=c,l.pdfToImg=d}),98);
__d("WAWebPrivacyMode_WORKER_INCOMPATIBLE",["WAWebContactCollection","WAWebWid"],(function(t,n,r,o,a,i,l){function e(e){if(r("WAWebWid").isUser(e)){var t=o("WAWebContactCollection").ContactCollection.get(e);return t==null?void 0:t.privacyMode}}l.getPrivacyModeFromModel=e}),98);
__d("WAWebWebcResourceLoadWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WebcResourceLoad:[688,{webcResourceCached:[3,e.TYPES.BOOLEAN],webcResourceDuration:[2,e.TYPES.TIMER],webcResourceName:[1,e.TYPES.STRING]},[1,1e3,2e3],"regular"]},{WebcResourceLoad:[]});l.WebcResourceLoadWamEvent=s}),98);
__d("WAWebWamResourceLoadReporter",["WALogger","WAWebWebcResourceLoadWamEvent"],(function(t,n,r,o,a,i,l){var e;function s(){var t,n=(t=window.performance)==null?void 0:t.timing;if(!(n&&window.performance.getEntriesByType)){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["MetricReporter:logResourceLoads metrics not provided by browser!"]))).devConsole("red");return}var r=window.performance.timing.fetchStart===window.performance.timing.domainLookupEnd,a=window.performance.getEntriesByType("resource"),i=document.createElement("a");a.forEach(function(e){e.initiatorType!=="xmlhttprequest"&&(i.href=e.name,new(o("WAWebWebcResourceLoadWamEvent")).WebcResourceLoadWamEvent({webcResourceName:i.pathname+i.search+i.hash,webcResourceDuration:Math.round(e.duration),webcResourceCached:r}).commit())})}l.default=s}),98);
__d("WAWebWamEnumWebcAppcacheStatusCode",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNCACHED:0,IDLE:1,CHECKING:2,DOWNLOADING:3,UPDATEREADY:4,OBSOLETE:5});i.WEBC_APPCACHE_STATUS_CODE=e}),66);
__d("WAWebWamEnumWebcNavigationType",[],(function(t,n,r,o,a,i){var e=Object.freeze({NAVIGATE_NEXT:0,RELOAD:1,BACK_FORWARD:2,UNDEFINED:255});i.WEBC_NAVIGATION_TYPE=e}),66);
__d("WAWebWebcPageLoadWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebcAppcacheStatusCode","WAWebWamEnumWebcNavigationType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WebcPageLoad:[642,{webcAppcacheStatus:[29,o("WAWebWamEnumWebcAppcacheStatusCode").WEBC_APPCACHE_STATUS_CODE],webcCached:[30,e.TYPES.BOOLEAN],webcConnectEnd:[10,e.TYPES.TIMER],webcConnectStart:[9,e.TYPES.TIMER],webcDomComplete:[19,e.TYPES.TIMER],webcDomContentLoadedEventEnd:[18,e.TYPES.TIMER],webcDomContentLoadedEventStart:[17,e.TYPES.TIMER],webcDomInteractive:[16,e.TYPES.TIMER],webcDomLoading:[15,e.TYPES.TIMER],webcDomainLookupEnd:[8,e.TYPES.TIMER],webcDomainLookupStart:[7,e.TYPES.TIMER],webcExeDone:[23,e.TYPES.TIMER],webcExeStart:[22,e.TYPES.TIMER],webcFetchStart:[6,e.TYPES.TIMER],webcInitialMountT:[38,e.TYPES.TIMER],webcInitialNavMountT:[39,e.TYPES.TIMER],webcInitialPanel:[42,e.TYPES.STRING],webcInitialPanelMountStartT:[43,e.TYPES.TIMER],webcInitialPanelMountT:[40,e.TYPES.TIMER],webcInitialPanelRenderT:[46,e.TYPES.TIMER],webcJsLoadT:[37,e.TYPES.TIMER],webcLoadEventEnd:[21,e.TYPES.TIMER],webcLoadEventStart:[20,e.TYPES.TIMER],webcLoadInForeground:[53,e.TYPES.BOOLEAN],webcMainScriptEnd:[45,e.TYPES.TIMER],webcMainScriptStart:[44,e.TYPES.TIMER],webcNativeLoadT:[36,e.TYPES.TIMER],webcNavigation:[32,o("WAWebWamEnumWebcNavigationType").WEBC_NAVIGATION_TYPE],webcPageLoadId:[54,e.TYPES.STRING],webcPageLoadT:[34,e.TYPES.TIMER],webcParallellyFetched:[41,e.TYPES.BOOLEAN],webcQrCode:[31,e.TYPES.BOOLEAN],webcRedirectCount:[33,e.TYPES.NUMBER],webcRedirectEnd:[5,e.TYPES.TIMER],webcRedirectStart:[4,e.TYPES.TIMER],webcRequestStart:[12,e.TYPES.TIMER],webcResponseEnd:[14,e.TYPES.TIMER],webcResponseStart:[13,e.TYPES.TIMER],webcSecureConnectionStart:[11,e.TYPES.TIMER],webcUnloadEventEnd:[3,e.TYPES.TIMER],webcUnloadEventStart:[2,e.TYPES.TIMER],webcWsAttempts:[28,e.TYPES.NUMBER],webcWsNormal:[27,e.TYPES.TIMER],webcWsOpening:[24,e.TYPES.TIMER],webcWsPairing:[25,e.TYPES.TIMER],webcWsSyncing:[26,e.TYPES.TIMER]},[1,1,1],"regular"]},{WebcPageLoad:[]});l.WebcPageLoadWamEvent=s}),98);
__d("WAWebWamPageLoadReporter",["Promise","WALogger","WAWebAppScreen","WAWebPageLoadLogging","WAWebStreamModel","WAWebWam","WAWebWamResourceLoadReporter","WAWebWebcPageLoadWamEvent","once"],(function(t,n,r,o,a,i,l){var e,s,u,c=new(o("WAWebWebcPageLoadWamEvent")).WebcPageLoadWamEvent,d,m={},p,_,f=!1,g=!1;function h(){return{uiTimingComplete:f,wsTimingComplete:g}}var y=new(u||(u=n("Promise")))(function(e){return p=function(){f=!0,e()}}),C=new u(function(e){return _=function(){g=!0,e()}}),b=!1,v;function S(e,t,n){R(e);var r=Math.floor(self.performance.now());m[e]=r,n&&(m.socketSequence=t,_())}function R(e){switch(e){case o("WAWebStreamModel").StreamInfo.OPENING:o("WAWebPageLoadLogging").addPageLoadQplPoint("webc_ws_opening");break;case o("WAWebStreamModel").StreamInfo.PAIRING:o("WAWebPageLoadLogging").addPageLoadQplPoint("webc_ws_pairing");break;case o("WAWebStreamModel").StreamInfo.NORMAL:o("WAWebPageLoadLogging").addPageLoadQplPoint("webc_ws_normal");break;default:return}}function L(e){o("WAWebPageLoadLogging").addPageLoadQplPoint("webc_initial_panel_mount_t"),d=e}function E(e){c!=null&&c.set({webcInitialPanel:e})}function k(){p()}window.document&&(v=!document.hidden,document.addEventListener("visibilitychange",T)),u.all([y,C]).then(function(){D(),r("WAWebWamResourceLoadReporter")(),b||(b=!0,o("WAWebWam").Wam.resumeJobs())});function I(e){return!self.performance||!self.performance.timing||!self.performance.timing.navigationStart?null:e-self.performance.timing.navigationStart}function T(){c&&document.hidden&&(v=!1)}function D(){var t;if(!((t=self.performance)!=null&&t.timing&&self.performance.navigation)){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["MetricReporter:logPageLoad metrics not provided by browser!"]))).devConsole("red");return}if(!c)return;var n=c,r=self.performance.timing,a=self.performance.navigation,i=r.navigationStart,l=r.loadEventEnd-i;if(l<=0){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["MetricReporter:logPageLoad delayed"]))).devConsole("blue"),self.setTimeout(D,1e4);return}function u(e){var t=r[e];return t&&I(t)}n.set({webcPageLoadT:l,webcUnloadEventStart:u("unloadEventStart"),webcUnloadEventEnd:u("unloadEventEnd"),webcRedirectStart:u("redirectStart"),webcRedirectEnd:u("redirectEnd"),webcFetchStart:u("fetchStart"),webcDomainLookupStart:u("domainLookupStart"),webcDomainLookupEnd:u("domainLookupEnd"),webcConnectStart:u("connectStart"),webcConnectEnd:u("connectEnd"),webcSecureConnectionStart:u("secureConnectionStart"),webcRequestStart:u("requestStart"),webcResponseStart:u("responseStart"),webcResponseEnd:u("responseEnd"),webcDomLoading:u("domLoading"),webcDomInteractive:u("domInteractive"),webcDomContentLoadedEventStart:u("domContentLoadedEventStart"),webcDomContentLoadedEventEnd:u("domContentLoadedEventEnd"),webcDomComplete:u("domComplete"),webcLoadEventStart:u("loadEventStart"),webcLoadEventEnd:u("loadEventEnd"),webcCached:r.fetchStart===r.domainLookupEnd,webcNavigation:a.type,webcRedirectCount:a.redirectCount,webcWsOpening:m.OPENING,webcWsPairing:m.PAIRING,webcWsSyncing:m.SYNCING,webcWsNormal:m.NORMAL,webcWsAttempts:m.socketSequence,webcQrCode:!m.SYNCING,webcInitialPanelMountT:d-i,webcLoadInForeground:v,webcPageLoadId:o("WAWebPageLoadLogging").getPageLoadId()}),x(n),n.commit(),window.document&&document.removeEventListener("visibilitychange",T),c=null}function x(e){var t;(t=o("WAWebPageLoadLogging")).addPageLoadValidationData("webc_ws_opening",{wam:e.webcWsOpening}),t.addPageLoadValidationData("webc_ws_pairing",{wam:e.webcWsPairing}),t.addPageLoadValidationData("webc_ws_normal",{wam:e.webcWsNormal}),t.addPageLoadValidationData("webc_initial_panel_mount_t",{wam:e.webcInitialPanelMountT}),t.addPageLoadValidationData("webc_initial_panel_mount_start_t",{wam:e.webcInitialPanelMountStartT}),t.addPageLoadValidationData("webc_initial_panel_render_t",{wam:e.webcInitialPanelRenderT}),t.setWamCompleteForValidation()}var $=(function(){function e(e){this.$4=!1,this.$3=e.label,this.$1=e.startProperty,this.$2=e.endProperty}var t=e.prototype;return t.start=function(){var e;this.$4=!0,c!=null&&c.set((e={},e[this.$1]=I(Date.now()),e))},t.end=function(){var e;c!=null&&c.set((e={},e[this.$2]=I(Date.now()),e))},t.hasStarted=function(){return this.$4},e})();function P(e){W.hasStarted()||N(e)&&(E(e),W.start(),o("WAWebPageLoadLogging").addPageLoadQplPoint("webc_initial_panel_mount_start_t"),window.requestAnimationFrame(function(){W.end(),o("WAWebPageLoadLogging").addPageLoadQplPoint("webc_initial_panel_render_t"),A("initialPanelRenderTRecorded")}))}function N(e){return e!==o("WAWebAppScreen").AppScreen.SYNCING}var M=!1,w=!1;function A(e){e==="initialPanelMountTRecorded"&&(M=!0),e==="initialPanelRenderTRecorded"&&(w=!0),M&&w&&k()}var F=r("once")(function(){L(Date.now()),A("initialPanelMountTRecorded")}),O=new $({label:"PageLoad.webcExe",startProperty:"webcExeStart",endProperty:"webcExeDone"}),B=new $({label:"PageLoad.webcMainScript",startProperty:"webcMainScriptStart",endProperty:"webcMainScriptEnd"}),W=new $({label:"PageLoad.webcInitialPanelRender",startProperty:"webcInitialPanelMountStartT",endProperty:"webcInitialPanelRenderT"});l.getWamPageLoadTimingCompletion=h,l.streamInfoChange=S,l.logWamPageLoad=D,l.maybeLogInitialScreenRenderStart=P,l.logFirstRenderMountTimeOnce=F,l.exeTimer=O,l.mainScriptTimer=B}),98);
__d("WAWebAccountLinkingConstants",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["Active","Paused","Unlinked","Unknown"]),l="AccountLinkKey",s="MIIEfTCCA2WgAwIBAgIUTRB3DSS1IoPy5PHlIVftCO3ytEswDQYJKoZIhvcNAQEL\nBQAweTEoMCYGA1UEAwwfRmFjZWJvb2sgUm9vdGNhbmFsIFByb2QgUm9vdCBDQTEL\nMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlmb3JuaWExEzARBgNVBAcMCk1lbmxv\nIFBhcmsxFjAUBgNVBAoMDUZhY2Vib29rIEluYy4wHhcNMTgwMjIxMDAwNjQzWhcN\nNDgwMjIxMDAwNjQzWjB5MSgwJgYDVQQDDB9GYWNlYm9vayBSb290Y2FuYWwgUHJv\nZCBSb290IENBMQswCQYDVQQGEwJVUzETMBEGA1UECAwKQ2FsaWZvcm5pYTETMBEG\nA1UEBwwKTWVubG8gUGFyazEWMBQGA1UECgwNRmFjZWJvb2sgSW5jLjCCASIwDQYJ\nKoZIhvcNAQEBBQADggEPADCCAQoCggEBAO04IfUs0M4IPVwJHLAFSTulY1/R/cEk\nhDlIKmpRA3IiSG7eAgBxWuvUZti2zm4G0ftPVUJOqjhavu+EOW9iT6WBZojtRNsF\nkJKJIBrfwg3A9i2BMF7PUsDNMRkRnUmiZeQ5HY/sPLYCwp6rYLaUHC5E+73y9ByS\nssnmlJCPTsv+OgdFpFHJaSf0YOL33xheHDrdElYAibh4dOtg4v7lWh/D1vpLi4Y1\ngFD8BICeUIZe622gRnj84hCkkbE6kJyCqO3l2FXMPYZjhlUa8vRE4qsUUCAZmamW\nNDGKDH5z2EuC3glVU9B5NJdfn3FXh7/Pv49sV70hs+pGkOwwuhsJ1dUCAwEAAaOB\n/DCB+TAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBT6a6rC4jjPN1kw0KTesLkl\nsYoajDCBtgYDVR0jBIGuMIGrgBT6a6rC4jjPN1kw0KTesLklsYoajKF9pHsweTEo\nMCYGA1UEAwwfRmFjZWJvb2sgUm9vdGNhbmFsIFByb2QgUm9vdCBDQTELMAkGA1UE\nBhMCVVMxEzARBgNVBAgMCkNhbGlmb3JuaWExEzARBgNVBAcMCk1lbmxvIFBhcmsx\nFjAUBgNVBAoMDUZhY2Vib29rIEluYy6CFE0Qdw0ktSKD8uTx5SFX7Qjt8rRLMA4G\nA1UdDwEB/wQEAwIBhjANBgkqhkiG9w0BAQsFAAOCAQEAW9EUmvvxgcxEPfxB7G7R\nwxwk6m4xPBTc0UArnWCLZRmRBmaKYPovC0brhKF7Dfn9IcXEhhmsLRnBy/1xtbWG\nW1kQzQeIUaDgXymE+dmnmorhuwepwELcsX7UB1RM0HoES3Z0Y2EvS4/iz5Q3GMEb\n/J5FVduXkm+NClL+6qAn4xHGpwGsa2Prpe8f9UZTCCiwwfT9IxvRpe/oTeE9G3VK\nUIb2ZHo1/PQSXAAxcyYAjVBHpiSW/C0iI5qqy9Lie27rkaShHA4X8xEkX0VfRRQF\n40UYnDkeEcv4yUiVBDTefvTzBpB2WihYr/FzBBkKF/9PBE+5uM8458vAmItA8vrr\nWA==\n",u=n("$InternalEnum")({ACCOUNT_LINKED:1,ACCOUNT_UNLINKED:2,SETTINGS_CHANGED:3,STATE_DELETED:4,STATE_SUSPENDED:5,CLIENT_RESYNC:6,CROSSPOST_FB_FAILED:7}),c=n("$InternalEnum")({UNLINKED:1,ACTIVE:2,PAUSED:3});i.AccountLinkState=e,i.AccountLinkKey=l,i.ProdRootCertificatePem=s,i.AccountLinkingNotificationEvent=u,i.AccountLinkingStateExists=c}),66);
__d("WAWebAccountLinkingCryptoUtils",["WALogger","WAWebAccountLinkingConstants","WAWebDirectConnectionX509","asyncToGeneratorRuntime","lodash"],(function(t,n,r,o,a,i,l){var e,s,u;function c(){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield self.crypto.subtle.generateKey({name:"RSA-OAEP",hash:"SHA-1",modulusLength:2048,publicExponent:new Uint8Array([1,0,1])},!0,["encrypt","decrypt"]),t=e.privateKey,n=e.publicKey;return{privateKey:t,publicKey:n}}),d.apply(this,arguments)}function m(){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return self.crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}),p.apply(this,arguments)}function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t[0],a=t[1],i,l;if(r("lodash").isEqual(n.subject,a.issuer))i=n,l=a;else if(r("lodash").isEqual(a.subject,n.issuer))i=a,l=n;else return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] Certificate Chain Validation Failed"]))),null;var s=yield g(),u=yield o("WAWebDirectConnectionX509").validateCertificates([i,l],[s]);return u.result?l:null}),f.apply(this,arguments)}function g(){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e="-----BEGIN CERTIFICATE-----",t="-----END CERTIFICATE-----",n=e+"\n"+o("WAWebAccountLinkingConstants").ProdRootCertificatePem+"\n"+t,r=yield o("WAWebDirectConnectionX509").extractCertificates(n);return r.length!==1&&o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] Root certificate failed extraction"]))),r[0]}),h.apply(this,arguments)}function y(e){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=new TextEncoder,n=t.encode(e),r=self.crypto.getRandomValues(new Uint8Array(12)),o=yield m(),a=yield self.crypto.subtle.encrypt({name:"AES-GCM",iv:r,length:256},o,n),i=new Uint8Array(a),l=i.slice(-16),s=i.slice(0,-16);return{key:o,cipherText:s,tag:l,iv:r}}),C.apply(this,arguments)}function b(e,t,n,r){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var o=new Uint8Array(t.length+r.length);o.set(t),o.set(r,t.length);var a=yield self.crypto.subtle.decrypt({name:"AES-GCM",iv:n,length:256},e,o);return a}),v.apply(this,arguments)}function S(e,t){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){return self.crypto.subtle.encrypt({name:"RSA-OAEP",padding:"OAEP"},e,t)}),R.apply(this,arguments)}function L(e,t){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){return self.crypto.subtle.decrypt({name:"RSA-OAEP",padding:"OAEP"},e,t)}),E.apply(this,arguments)}function k(e,t){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){t===void 0&&(t=!1);var n=yield self.crypto.subtle.exportKey("spki",e),r=new Uint8Array(n),o=btoa(Array.from(r).map(function(e){return String.fromCharCode(e)}).join(""));return t?"-----BEGIN PUBLIC KEY-----\n"+o+"\n-----END PUBLIC KEY-----\n":"-----BEGIN PUBLIC KEY-----"+o+"-----END PUBLIC KEY-----"}),I.apply(this,arguments)}function T(e,t,n){return D.apply(this,arguments)}function D(){return D=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=["encrypt","decrypt"]);var r=t?"-----BEGIN PRIVATE KEY-----":"-----BEGIN PUBLIC KEY-----",a=t?"-----END PRIVATE KEY-----":"-----END PUBLIC KEY-----",i=e;e.includes(r)&&(i=e.substring(e.indexOf(r)+r.length,e.indexOf(a))),i=i.replace(/\s/g,"");try{for(var l=atob(i),s=new Uint8Array(l.length),c=0;c<l.length;c++)s[c]=l.charCodeAt(c);var d=t?"pkcs8":"spki";return self.crypto.subtle.importKey(d,s,{name:"RSA-OAEP",hash:"SHA-1"},!0,n)}catch(e){throw o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Error converting PEM to CryptoKey: ",""])),String(e)),e}}),D.apply(this,arguments)}function x(e,t){return $.apply(this,arguments)}function $(){return $=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield T(e,!1,["encrypt"]),r=yield T(t,!0,["decrypt"]);return{publicKey:n,privateKey:r}}),$.apply(this,arguments)}function P(e){return N.apply(this,arguments)}function N(){return N=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield self.crypto.subtle.exportKey("raw",e);return new Uint8Array(t)}),N.apply(this,arguments)}function M(e){return w.apply(this,arguments)}function w(){return w=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield self.crypto.subtle.importKey("raw",e,"AES-GCM",!0,["encrypt","decrypt"]);return t}),w.apply(this,arguments)}l.generateRSAKeys=c,l.generateAESKey=m,l.validateCertificateChain=_,l.encryptWithAES=y,l.decryptWithAES=b,l.encryptWithRSA=S,l.decryptWithRSA=L,l.cryptoKeyToPem=k,l.convertTestKeys=x,l.cryptoKeyToBinary=P,l.binaryToCryptoKey=M}),98);
__d("WAWebProtobufsMdStorageAccountLinkingOpaqueData.pb",["WAProtoConst"],(function(t,n,r,o,a,i,l){var e={};e.name="AccountLinkingOpaqueData",e.internalSpec={accesstoken:[1,o("WAProtoConst").TYPES.STRING],fbid:[2,o("WAProtoConst").TYPES.STRING],nonce:[3,o("WAProtoConst").TYPES.STRING]},l.AccountLinkingOpaqueDataSpec=e}),98);
__d("WAWebOpaqueDataEncryption",["WAWebProtobufsMdStorageAccountLinkingOpaqueData.pb","decodeProtobuf","encodeProtobuf"],(function(t,n,r,o,a,i,l){var e=new Set(["accesstoken","fbid","nonce"]);function s(t){var n={};Object.keys(t).forEach(function(r){e.has(r)&&(n[r]=t[r],delete t[r])});var r=o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsMdStorageAccountLinkingOpaqueData.pb").AccountLinkingOpaqueDataSpec,n);return r.readBuffer()}function u(e){var t=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsMdStorageAccountLinkingOpaqueData.pb").AccountLinkingOpaqueDataSpec,e);return t}l.moveEncFieldToOpaqueData=s,l.moveOpaqueDataToEncField=u}),98);
__d("WAWebAccountLinkingDBOperations",["WAWebAccountLinkingConstants","WAWebAccountLinkingSchema","WAWebOpaqueDataEncryption","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebAccountLinkingSchema").getTable().createOrReplace(e)}function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebAccountLinkingSchema").getTable().get(o("WAWebAccountLinkingConstants").AccountLinkKey),n=babelHelpers.extends({},t,{linkState:e});return o("WAWebAccountLinkingSchema").getTable().createOrReplace(n)}),u.apply(this,arguments)}function c(e,t){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WAWebAccountLinkingSchema").getTable().get(o("WAWebAccountLinkingConstants").AccountLinkKey);if(n!=null){var r=babelHelpers.extends({},n,{nonce:e,fbid:t});return r.accountLinkingOpaqueData=o("WAWebOpaqueDataEncryption").moveEncFieldToOpaqueData(r),o("WAWebAccountLinkingSchema").getTable().createOrReplace(r)}}),d.apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield g();if(t!=null){var n=babelHelpers.extends({},t,{accesstoken:e});return n.accountLinkingOpaqueData=o("WAWebOpaqueDataEncryption").moveEncFieldToOpaqueData(n),o("WAWebAccountLinkingSchema").getTable().createOrReplace(n)}}),p.apply(this,arguments)}function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebAccountLinkingSchema").getTable().get(o("WAWebAccountLinkingConstants").AccountLinkKey),n=e+Date.now()/1e3,r=babelHelpers.extends({},t,{pingInterval:n});return o("WAWebAccountLinkingSchema").getTable().createOrReplace(r)}),f.apply(this,arguments)}function g(){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e,t=yield o("WAWebAccountLinkingSchema").getTable().get("AccountLinkKey");if(((e=t)==null?void 0:e.accountLinkingOpaqueData)!=null){var n,r=o("WAWebOpaqueDataEncryption").moveOpaqueDataToEncField((n=t)==null?void 0:n.accountLinkingOpaqueData);t=babelHelpers.extends({},t,{accesstoken:r.accesstoken,fbid:r.fbid,nonce:r.nonce})}return t}),h.apply(this,arguments)}function y(){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield g();return e==null||e.pingInterval==null?0:e.pingInterval}),C.apply(this,arguments)}function b(e){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebAccountLinkingSchema").getTable().get(o("WAWebAccountLinkingConstants").AccountLinkKey),n=e.fbCrosspostingDestinationId,r=e.igCrosspostingDestinationId,a=babelHelpers.extends({},t,{fbCrosspostingDestinationId:n,igCrosspostingDestinationId:r,foAToWALinkEligibility:e.foAToWALinkEligibility});return o("WAWebAccountLinkingSchema").getTable().createOrReplace(a)}),v.apply(this,arguments)}function S(){return o("WAWebAccountLinkingSchema").getTable().clear()}l.createOrUpdateAccountLinkingState=e,l.updateAccountLinkingState=s,l.updateAccountLinkingData=c,l.updateAccesstoken=m,l.updatePingInterval=_,l.getAccountLinkingData=g,l.getPingExpirationTime=y,l.updateServiceData=b,l.purgeWaffleData=S}),98);
__d("WAWebAccountLinkingUtils",["WAWebAccountLinkingConstants"],(function(t,n,r,o,a,i,l){function e(e){switch(e){case 0:return o("WAWebAccountLinkingConstants").AccountLinkState.Active;case 1:return o("WAWebAccountLinkingConstants").AccountLinkState.Paused;case 2:return o("WAWebAccountLinkingConstants").AccountLinkState.Unlinked;default:return o("WAWebAccountLinkingConstants").AccountLinkState.Unknown}}function s(){var e=navigator.globalPrivacyControl;return e!=null?e:!1}l.mapToAccountLinkState=e,l.checkGPCSetting=s}),98);
__d("WAWebWaffleFXServiceDataQueryV2Mutation.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{alias:null,args:null,concreteType:"WaffleFXServiceDataResponse",kind:"LinkedField",name:"waffle_fx_service_data",plural:!1,selections:[{alias:null,args:null,concreteType:"WaffleFXServiceData",kind:"LinkedField",name:"services",plural:!1,selections:[{alias:null,args:null,concreteType:"WaffleCAL",kind:"LinkedField",name:"waffle_sxs",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"waffle_di",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"waffle_da",storageKey:null},{alias:null,args:null,concreteType:"WaffleXSetting",kind:"LinkedField",name:"waffle_xss",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"waffle_iaxe",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"waffle_x_surface",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"WaffleAfsEligibility",kind:"LinkedField",name:"waffle_afs",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"waffle_wes",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"WhatsAppFoaToWaLinkEligibility",kind:"LinkedField",name:"foa_to_wa_link_eligibility",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_eligible_to_link_to_unlinked_fb",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_eligible_to_link_to_linked_fb",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_eligible_to_link_to_unlinked_ig",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_eligible_to_link_to_linked_ig",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_eligible_to_link_to_unlinked_rl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_eligible_to_link_to_linked_rl",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"WAWebWaffleFXServiceDataQueryV2Mutation",selections:e,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"WAWebWaffleFXServiceDataQueryV2Mutation",selections:e},params:{id:"9475021792620702",metadata:{},name:"WAWebWaffleFXServiceDataQueryV2Mutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("WAWebWaffleFXServiceDataQueryV2Mutation",["WAWebWaffleFXServiceDataQueryV2Mutation.graphql"],(function(t,n,r,o,a,i,l){var e,s=e!==void 0?e:e=n("WAWebWaffleFXServiceDataQueryV2Mutation.graphql"),u=s;l.default=u}),98);
__d("WAWebWaffleFXWAMOUpdateUOOMMutation.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{alias:null,args:null,kind:"ScalarField",name:"xfb_waffle_fx_wamo_update_uoom",storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"WAWebWaffleFXWAMOUpdateUOOMMutation",selections:e,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"WAWebWaffleFXWAMOUpdateUOOMMutation",selections:e},params:{id:"10031635203620145",metadata:{},name:"WAWebWaffleFXWAMOUpdateUOOMMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("WAWebWaffleFXWAMOUpdateUOOMMutation",["WAWebWaffleFXWAMOUpdateUOOMMutation.graphql"],(function(t,n,r,o,a,i,l){var e,s=e!==void 0?e:e=n("WAWebWaffleFXWAMOUpdateUOOMMutation.graphql"),u=s;l.default=u}),98);
__d("WAWebAccountLinkingAPI",["WALogger","WASmaxWaffleGetCertificateRPC","WASmaxWaffleRefreshAccessTokensRPC","WASmaxWaffleStateExistsRPC","WASmaxWaffleWFPingRPC","WAWebAPIParser","WAWebAccountLinkingConstants","WAWebAccountLinkingCryptoUtils","WAWebAccountLinkingDBOperations","WAWebAccountLinkingGatingUtils","WAWebAccountLinkingUtils","WAWebDirectConnectionX509","WAWebProtobufsE2E.pb","WAWebRelayClient","WAWebSendNonMessageDataRequest","WAWebUserPrefsGeneral","WAWebWaffleFXServiceDataQueryV2Mutation","WAWebWaffleFXWAMOUpdateUOOMMutation","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S;function R(){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=Math.floor(Date.now()/1e3);try{var n=yield o("WASmaxWaffleGetCertificateRPC").sendGetCertificateRPC({hasPasswordPem:!0,hasPayloadEncCertificates:!0,timestampElementValue:t});if(n.name==="GetCertificateResponseSuccess"){var r,a=n.value.replyGetCertificateResponseMixin,i=(r=a.encryptionPem)==null?void 0:r.elementValue;if(i!=null){var l=String.fromCharCode.apply(null,i),u=yield o("WAWebDirectConnectionX509").extractCertificates(l),c=yield o("WAWebAccountLinkingCryptoUtils").validateCertificateChain(u);return c!=null?c.getPublicKey({algorithm:{algorithm:{name:"RSA-OAEP",hash:{name:"SHA-1"}},usages:["encrypt"]}}):(o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] Fetching valid certificate failed"]))),null)}return null}}catch(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["fetchValidCertificate failed: ",""])),e)}}),L.apply(this,arguments)}function E(){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield o("WAWebSendNonMessageDataRequest").sendPeerDataOperationRequest(o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.WAFFLE_LINKING_NONCE_FETCH,{})}),k.apply(this,arguments)}function I(){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebAccountLinkingDBOperations").getAccountLinkingData();if(e!=null){var t=e.nonce,n=e.fbid,r=yield o("WAWebAccountLinkingCryptoUtils").generateRSAKeys(),a=r.publicKey,i=r.privateKey,l=yield o("WAWebAccountLinkingCryptoUtils").cryptoKeyToPem(a,!0),s={version:1,timestamp:Date.now(),nonce:t,client_pub_key:l,client_pub_key_type:"RSA 2048"},c=yield R();if(c==null){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] fetchValidCertificate failed"])));return}var d=yield o("WAWebAccountLinkingCryptoUtils").encryptWithAES(JSON.stringify(s)),m=d.tag,p=d.iv,_=d.cipherText,f=d.key,g=yield o("WAWebAccountLinkingCryptoUtils").cryptoKeyToBinary(f),h=yield o("WAWebAccountLinkingCryptoUtils").encryptWithRSA(c,g);if(n!=null){var y=yield o("WASmaxWaffleRefreshAccessTokensRPC").sendRefreshAccessTokensRPC({rSAEncryptionMetadataMixinArgs:{encryptedKeyElementValue:h,nonceElementValue:p,encryptedDataElementValue:_,authTagElementValue:m},timestampElementValue:Date.now(),fbidElementValue:n});if(y.name==="RefreshAccessTokensResponseSuccess"){var C=o("WAWebAPIParser").parseRSAEncryptionMetadataMixin(y.value.encryptionMetadataRSAEncryptionMetadataMixin),b=C.key,v=C.nonce,S=C.tag,L=C.data,E=yield o("WAWebAccountLinkingCryptoUtils").decryptWithRSA(i,b),k=yield o("WAWebAccountLinkingCryptoUtils").binaryToCryptoKey(E),I=yield o("WAWebAccountLinkingCryptoUtils").decryptWithAES(k,L,v,S),T=new TextDecoder("utf-8"),D=T.decode(I),x=JSON.parse(D),$=x.data,P=JSON.parse($);yield o("WAWebAccountLinkingDBOperations").updateAccesstoken(P.access_token)}}}}),T.apply(this,arguments)}function D(){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebAccountLinkingDBOperations").getAccountLinkingData();if(e!=null){var t=e.fbid,n=e.accesstoken;if(n!=null){var r={version:1,timestamp:Date.now(),access_token:n},a=yield R();if(a==null){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] fetchValidCertificate failed"])));return}var i=yield o("WAWebAccountLinkingCryptoUtils").encryptWithAES(JSON.stringify(r)),l=i.tag,s=i.iv,u=i.cipherText,_=i.key,f=yield o("WAWebAccountLinkingCryptoUtils").cryptoKeyToBinary(_),g=yield o("WAWebAccountLinkingCryptoUtils").encryptWithRSA(a,f);if(t!=null){var h=yield o("WASmaxWaffleWFPingRPC").sendWFPingRPC({rSAEncryptionMetadataMixinArgs:{encryptedKeyElementValue:g,nonceElementValue:s,encryptedDataElementValue:u,authTagElementValue:l},timestampElementValue:Date.now(),fbidElementValue:t});if(o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Ping Response: ",""])),h),h.name==="WFPingResponseSuccess"){var y=h.value.pingIntervalElementValue;yield o("WAWebAccountLinkingDBOperations").updatePingInterval(y)}else o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] Ping failed"])))}else o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] Ping failed due to null waEntFbid"])))}}}),x.apply(this,arguments)}function $(){return P.apply(this,arguments)}function P(){return P=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WASmaxWaffleStateExistsRPC").sendStateExistsRPC({timestampElementValue:Date.now()});if(o("WALogger").DEV(_||(_=babelHelpers.taggedTemplateLiteralLoose(["State Exists Response: ",""])),e),e.name==="StateExistsResponseSuccess"){o("WALogger").DEV(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] State exists response success"])));var t=o("WAWebAccountLinkingConstants").AccountLinkingStateExists.cast(e.value.wfStateElementValue);if(t!=null)return t;o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] Failed to parse state exists response"])))}}),P.apply(this,arguments)}function N(){return M.apply(this,arguments)}function M(){return M=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] Fetching service data"])));var e=yield o("WAWebAccountLinkingDBOperations").getAccountLinkingData();if(e!=null){var t=e.accesstoken,n=yield o("WAWebRelayClient").commitMutation(r("WAWebWaffleFXServiceDataQueryV2Mutation"),{},{accessToken:t});if(n==null){o("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] Fetching service data result"])));return}var a=o("WAWebAPIParser").parseServiceData(n);if(a==null){o("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] Fetching service data failed"])));return}yield o("WAWebAccountLinkingDBOperations").updateServiceData(a)}}),M.apply(this,arguments)}function w(){return A.apply(this,arguments)}function A(){return A=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").DEV(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] Updating UOOM data"])));var e=yield o("WAWebAccountLinkingDBOperations").getAccountLinkingData();if(e!=null){var t=e.accesstoken,n=yield o("WAWebRelayClient").commitMutation(r("WAWebWaffleFXWAMOUpdateUOOMMutation"),{},{accessToken:t});if(n==null){o("WALogger").ERROR(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] Updating UOOM data result"])));return}n.xfb_waffle_fx_wamo_update_uoom===!0&&(o("WALogger").DEV(S||(S=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] Updating UOOM data success"]))),o("WAWebUserPrefsGeneral").setGPCcompleted(!0))}}),A.apply(this,arguments)}function F(){return O.apply(this,arguments)}function O(){return O=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){!o("WAWebUserPrefsGeneral").getGPCCompleted()&&o("WAWebAccountLinkingUtils").checkGPCSetting()&&o("WAWebAccountLinkingGatingUtils").accountLinkingEnabled()&&(yield w())}),O.apply(this,arguments)}l.fetchValidCertificate=R,l.requestNonceFromPrimary=E,l.refreshAccessToken=I,l.ping=D,l.stateExists=$,l.fetchServiceData=N,l.updateUOOMData=w,l.checkAndTriggerUOOMMutation=F}),98);
__d("WAWebAccountLinkingScheduledJobs",["WALogger","WAWebAccountLinkingAPI","WAWebAccountLinkingDBOperations","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield o("WAWebAccountLinkingDBOperations").getPingExpirationTime(),n=Date.now()/1e3;n>t?(yield o("WAWebAccountLinkingAPI").ping(),yield o("WAWebAccountLinkingAPI").fetchServiceData()):o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[WAFFLE] Cannot ping yet"])))}),u.apply(this,arguments)}l.scheduledWaffleJobs=s}),98);
__d("WAWebAlbumsFormatAlbumMessageText",["fbt","WAWebAlbumMessageUtils","WAWebFbtIntlList","WAWebMessageAssociationUIUtils"],(function(t,n,r,o,a,i,l,s){function e(e){var t=e.associatedMessages,n=e.msg,a=o("WAWebAlbumMessageUtils").getAlbumPhotoAndVideoCountText(t!=null?t:o("WAWebMessageAssociationUIUtils").getHiddenAssociatedMessages(n.id));return a.length===0?s._(/*BTDS*/"\u00c1lbum"):r("WAWebFbtIntlList")(a,r("WAWebFbtIntlList").CONJUNCTIONS.NONE,r("WAWebFbtIntlList").DELIMITERS.COMMA).toString()}l.default=e}),226);
__d("WAWebAlbumMessageUtils",["fbt","WAWebFrontendMsgGetters"],(function(t,n,r,o,a,i,l,s){function e(e){var t=e.reduce(function(e,t){return o("WAWebFrontendMsgGetters").getAsImage(t)?e.photoCount+=1:o("WAWebFrontendMsgGetters").getAsVideo(t)&&(e.videoCount+=1),e},{photoCount:0,videoCount:0}),n=t.photoCount,r=t.videoCount,a=n>0?s._(/*BTDS*/"_j{\"*\":\"{photo-count} fotos\",\"_1\":\"1 foto\"}",[s._plural(n,"photo-count")]):null,i=r>0?s._(/*BTDS*/"_j{\"*\":\"{video-count} videos\",\"_1\":\"1 video\"}",[s._plural(r,"video-count")]):null;return[a,i].filter(Boolean)}l.getAlbumPhotoAndVideoCountText=e}),226);
__d("WAWebBizAiAgentGating",["WAWebABProps"],(function(t,n,r,o,a,i,l){"use strict";function e(){return o("WAWebABProps").getABPropConfigValue("biz_ai_smb_agents_automatic_reply_enabled")}function s(){return o("WAWebABProps").getABPropConfigValue("biz_ai_web_ai_hub_tap_cta_show_alert")}function u(){return o("WAWebABProps").getABPropConfigValue("biz_ai_auto_save_enabled")}function c(){return o("WAWebABProps").getABPropConfigValue("biz_ai_in_thread_unmute_v2")}function d(){return o("WAWebABProps").getABPropConfigValue("biz_ai_coaching_enabled")}function m(){return o("WAWebABProps").getABPropConfigValue("biz_ai_agent_thread_status_history_sync_enabled")}l.isAiAgentAutoReplyEnabled=e,l.isAiHubTapCtaShowAlertEnabled=s,l.isAiAgentAutoSaveEnabled=u,l.isAiMuteUnmuteV2Enabled=c,l.isAiCoachingEnabled=d,l.isAiAgentThreadStatusHistorySyncEnabled=m}),98);
__d("WAWebBizAiAgentStatusUtils",["WAWebBizAiAgentGating","WAWebBusinessProfileCollection","WAWebContactGetters","WAWebMobilePlatforms","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){function e(){var e=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),t=o("WAWebBusinessProfileCollection").BusinessProfileCollection.get(e);return(t==null?void 0:t.isBizBot1p)===!0}function s(t){var n=o("WAWebContactGetters").getIsMe(t.contact),r=o("WAWebContactGetters").getIsAiHub(t.contact);return o("WAWebMobilePlatforms").isSMB()&&o("WAWebBizAiAgentGating").isAiAgentAutoReplyEnabled()&&!n&&t.id.isUserNotPSA()&&e()&&!r}function u(e){return e.capiThreadControl===o("WAWebProtobufsE2E.pb").Message$CloudAPIThreadControlNotification$CloudAPIThreadControl.CONTROL_TAKEN}function c(e){return u(e)&&!e.forceDismissAiAgentBlockBar}function d(e){return u(e)}function m(e){return e.attempToEnableAi===!0}l.hasOnboardedAiAgent=e,l.isChatEligibleForAiAgent=s,l.isChatAiEnabled=u,l.shouldShowAiAgentBlockBar=c,l.shouldMuteNotification=d,l.tryToEnableAiAgent=m}),98);
__d("WAWebWamEnumBotBizActionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({BOT_BIZ_CARD_CLICK:1,BOT_BIZ_CARD_MESSAGE_CLICK:2,BOT_BIZ_CARD_VIEW_AI_CLICK:3,BOT_BIZ_DEEPLINK_CLICK:4,BOT_BIZ_NUX_APPEAR:5,BOT_BIZ_NUX_DISMISS:6,BOT_BIZ_NUX_SELECT:7,BOT_BIZ_INFO_CHAT_CLICK:8,BOT_BIZ_NUX_CONTINUE_CLICKED:9,BOT_BIZ_NUX_DISMISS_AUTO_ACCEPT:10,BOT_BIZ_NUX_APPEAR_MERGED:11,BOT_BIZ_NUX_APPEAR_NEW:12});i.BOT_BIZ_ACTION_TYPE=e}),66);
__d("WAWebWamEnumBotBizEntryPoint",[],(function(t,n,r,o,a,i){var e=Object.freeze({SHARED_BOT_BIZ_CARD:1,SHARED_BOT_BIZ_DEEPLINK:2,BOT_BIZ_CHAT:3});i.BOT_BIZ_ENTRY_POINT=e}),66);
__d("WAWebWamEnumBotBizType",[],(function(t,n,r,o,a,i){var e=Object.freeze({BOT_BIZ_3P:1,BOT_BIZ_1P:2});i.BOT_BIZ_TYPE=e}),66);
__d("WAWebBotBizJourneyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumBotBizActionType","WAWebWamEnumBotBizEntryPoint","WAWebWamEnumBotBizType","WAWebWamEnumBotType"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({BotBizJourney:[4868,{appSessionId:[1,o("WAWebWamCodegenUtils").TYPES.STRING],botBizActionType:[5,o("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE],botBizEntryPoint:[6,o("WAWebWamEnumBotBizEntryPoint").BOT_BIZ_ENTRY_POINT],botBizType:[7,o("WAWebWamEnumBotBizType").BOT_BIZ_TYPE],botType:[4,o("WAWebWamEnumBotType").BOT_TYPE]},[1,1,1],"regular"]},{BotBizJourney:[]});l.BotBizJourneyWamEvent=e}),98);
__d("WAWebBizBotLogging",["WAWebBotBizJourneyWamEvent","WAWebBotGating","WAWebChatEntryPoint","WAWebGetSharedSessionId","WAWebWamEnumBotBizActionType","WAWebWamEnumBotBizEntryPoint","WAWebWamEnumBotBizType","WAWebWamEnumBotType"],(function(t,n,r,o,a,i,l){function e(e){if(o("WAWebBotGating").isBizBot3pEnabled()){var t=new(o("WAWebBotBizJourneyWamEvent")).BotBizJourneyWamEvent({appSessionId:o("WAWebGetSharedSessionId").getSharedSessionId(),botBizEntryPoint:o("WAWebWamEnumBotBizEntryPoint").BOT_BIZ_ENTRY_POINT.SHARED_BOT_BIZ_CARD,botBizActionType:m(e),botBizType:c("3p"),botType:d("3p")});t.commit()}}function s(){if(o("WAWebBotGating").isBizBot3pEnabled()){var e=new(o("WAWebBotBizJourneyWamEvent")).BotBizJourneyWamEvent({appSessionId:o("WAWebGetSharedSessionId").getSharedSessionId(),botBizEntryPoint:o("WAWebWamEnumBotBizEntryPoint").BOT_BIZ_ENTRY_POINT.SHARED_BOT_BIZ_DEEPLINK,botBizActionType:o("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_DEEPLINK_CLICK,botBizType:c("3p"),botType:d("3p")});e.commit()}}function u(e,t,n){if(!(e==="3p"&&!o("WAWebBotGating").isBizBot3pEnabled()||e==="1p"&&!o("WAWebBotGating").isBizBot1pEnabled())){var r;switch(n){case o("WAWebChatEntryPoint").ChatEntryPoint.Vcard:r=o("WAWebWamEnumBotBizEntryPoint").BOT_BIZ_ENTRY_POINT.SHARED_BOT_BIZ_CARD;break;case o("WAWebChatEntryPoint").ChatEntryPoint.Chatlist:r=o("WAWebWamEnumBotBizEntryPoint").BOT_BIZ_ENTRY_POINT.BOT_BIZ_CHAT;break;default:r=void 0}var a=new(o("WAWebBotBizJourneyWamEvent")).BotBizJourneyWamEvent({appSessionId:o("WAWebGetSharedSessionId").getSharedSessionId(),botBizActionType:m(t),botBizEntryPoint:r,botBizType:c(e),botType:d(e)});a.commit()}}function c(e){switch(e){case"1p":return o("WAWebWamEnumBotBizType").BOT_BIZ_TYPE.BOT_BIZ_1P;case"3p":return o("WAWebWamEnumBotBizType").BOT_BIZ_TYPE.BOT_BIZ_3P}}function d(e){switch(e){case"1p":return o("WAWebWamEnumBotType").BOT_TYPE.BOT_1P_BIZ;case"3p":return o("WAWebWamEnumBotType").BOT_TYPE.BOT_3P_BIZ}}function m(e){switch(e){case"card_click":return o("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_CARD_CLICK;case"message_click":return o("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_CARD_MESSAGE_CLICK;case"view_ai_click":return o("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_CARD_VIEW_AI_CLICK;case"nux_appear":return o("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_NUX_APPEAR;case"nux_dismiss":return o("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_NUX_DISMISS;case"nux_select":return o("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_NUX_SELECT;case"nux_view_new":return o("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_NUX_APPEAR_NEW;case"nux_view_merged":return o("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_NUX_APPEAR_MERGED;case"nux_dismiss_auto_accept":return o("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_NUX_DISMISS_AUTO_ACCEPT;case"nux_continue_clicked":return o("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_NUX_CONTINUE_CLICKED}}l.logBizBot3pContactCardJourneyEvent=e,l.logBizBot3pDeepLinkClickEvent=s,l.logBizBotNuxJourneyEvent=u}),98);
__d("WAWebAiSignalOutlineIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="ai-signal-outline";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=20,R=20;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 20 20",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",color:"#54656F",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.19034 10.2424L7.79758 7.00011C7.4331 6.15148 6.22737 6.15148 5.86289 7.00011L4.4701 10.2424C4.36364 10.4904 4.16571 10.6878 3.9173 10.7941L0.637898 12.1963C-0.208188 12.5581 -0.213946 13.7529 0.628605 14.1227L3.78312 15.5076C4.02005 15.6115 4.21025 15.7991 4.31737 16.0342L5.84374 19.3845C6.22211 20.215 7.40911 20.2021 7.76927 19.3636L9.19034 16.0552C9.29686 15.8073 9.49472 15.6099 9.74322 15.5036L12.9929 14.114C13.8434 13.7503 13.8434 12.5473 12.9929 12.1837L9.74322 10.7941C9.49472 10.6878 9.29686 10.4904 9.19034 10.2424ZM4.58674 13.6761C4.58686 13.6762 4.58697 13.6762 4.58709 13.6763C5.27402 13.9778 5.82616 14.5219 6.13738 15.205L6.13739 15.205L6.77638 16.6076L7.3527 15.2659L7.35274 15.2658C7.66229 14.5452 8.23699 13.9725 8.9568 13.6647L8.95686 13.6647L10.1632 13.1488L8.95686 12.633L8.95679 12.633C8.237 12.3251 7.66229 11.7524 7.35274 11.0319L7.35271 11.0318L6.83023 9.81548L6.30784 11.0316C6.30781 11.0316 6.30777 11.0317 6.30773 11.0318C5.99811 11.7527 5.4232 12.3252 4.70395 12.6329L4.7036 12.633L3.44069 13.173L4.58674 13.6761ZM7.70052 7.7895C7.70046 7.78964 7.7004 7.78979 7.70033 7.78993L7.70052 7.7895ZM12.2066 12.275L12.2065 12.2751L12.2066 12.275ZM5.93202 18.5733C5.93188 18.5737 5.93175 18.574 5.93162 18.5743L5.93162 18.5743L5.93202 18.5733ZM10.9046 3.45455C11.3049 3.45455 11.6308 3.12973 11.6308 2.72728C11.6308 2.32481 11.3049 2 10.9046 2C10.5044 2 10.1785 2.32485 10.1785 2.72728C10.1785 3.12969 10.5044 3.45455 10.9046 3.45455ZM17.2133 6.97379L17.6637 8.98554L15.697 8.36987L17.2133 6.97379ZM13.6308 2.72728C13.6308 4.23351 12.4103 5.45455 10.9046 5.45455C9.39905 5.45455 8.17847 4.23352 8.17847 2.72728C8.17847 1.22104 9.39905 0 10.9046 0C12.4103 0 13.6308 1.22105 13.6308 2.72728ZM18.0943 4.15827C18.4524 4.2704 18.7236 4.56517 18.8056 4.93156L19.9746 10.1529C20.0566 10.5193 19.937 10.9016 19.6609 11.1559C19.3847 11.4101 18.9939 11.4977 18.6358 11.3855L13.5313 9.78762C13.1732 9.67549 12.902 9.38071 12.82 9.01433C12.7379 8.64795 12.8575 8.26561 13.1337 8.01136L17.0692 4.38795C17.3453 4.1337 17.7361 4.04614 18.0943 4.15827Z",fill:"currentColor"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.AiSignalOutlineIcon=m}),98);
__d("WAWebBizBotConsumerContentVariant",["$InternalEnum","WANullthrows","WAWebABProps"],(function(t,n,r,o,a,i,l){"use strict";var e=n("$InternalEnum")({ROW:0,INDIA:1,BRAZIL:2});function s(){return r("WANullthrows")(e.cast(o("WAWebABProps").getABPropConfigValue("biz_ai_tos_variant")))}l.BizBotConsumerContentVariant=e,l.getBizBotConsumerContentVariant=s}),98);
__d("WAWebBusinessDataSharingIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="business-data-sharing";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=18,R=20;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 20 18",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{d:"M14.3 9.30005C14.1 9.10005 14 8.86238 14 8.58705C14 8.31238 14.0917 8.08338 14.275 7.90005L16.175 6.00005H2.00005C1.71672 6.00005 1.47938 5.90405 1.28805 5.71205C1.09605 5.52072 1.00005 5.28338 1.00005 5.00005C1.00005 4.71672 1.09605 4.47905 1.28805 4.28705C1.47938 4.09572 1.71672 4.00005 2.00005 4.00005H16.175L14.275 2.10005C14.0917 1.91672 14 1.68738 14 1.41205C14 1.13738 14.1 0.900049 14.3 0.700049C14.4834 0.516716 14.7167 0.425049 15 0.425049C15.2834 0.425049 15.5167 0.516716 15.7 0.700049L19.3 4.30005C19.4 4.40005 19.4711 4.50838 19.5131 4.62505C19.5544 4.74172 19.5751 4.86672 19.5751 5.00005C19.5751 5.13338 19.5544 5.25838 19.5131 5.37505C19.4711 5.49172 19.4 5.60005 19.3 5.70005L15.7 9.30005C15.5 9.50005 15.2627 9.59572 14.988 9.58705C14.7127 9.57905 14.4834 9.48338 14.3 9.30005ZM4.30005 17.3L0.700049 13.7C0.600049 13.6 0.529382 13.4917 0.488049 13.375C0.446049 13.2584 0.425049 13.1334 0.425049 13C0.425049 12.8667 0.446049 12.7417 0.488049 12.625C0.529382 12.5084 0.600049 12.4 0.700049 12.3L4.30005 8.70005C4.48338 8.51672 4.71272 8.42071 4.98805 8.41205C5.26272 8.40405 5.50005 8.50005 5.70005 8.70005C5.90005 8.88338 6.00405 9.11238 6.01205 9.38705C6.02072 9.66238 5.92505 9.90005 5.72505 10.1L3.82505 12H18C18.2834 12 18.5207 12.0957 18.712 12.287C18.904 12.479 19 12.7167 19 13C19 13.2834 18.904 13.5207 18.712 13.712C18.5207 13.904 18.2834 14 18 14H3.82505L5.72505 15.9C5.90838 16.0834 6.00405 16.3167 6.01205 16.6C6.02072 16.8834 5.92505 17.1167 5.72505 17.3C5.54172 17.5 5.30838 17.6 5.02505 17.6C4.74172 17.6 4.50005 17.5 4.30005 17.3Z",fill:"currentColor"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.BusinessDataSharingIcon=m}),98);
__d("WAWebDoubleChevronInCircleIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="double-chevron-in-circle";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=19,R=19;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 19 19",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{d:"M5.79303 5.94909C6.10056 5.64155 6.59918 5.64155 6.90672 5.94909L9.87657 8.91893C10.1841 9.22647 10.1841 9.72509 9.87657 10.0326L6.90672 13.0025C6.59918 13.31 6.10056 13.31 5.79303 13.0025C5.48549 12.6949 5.48549 12.1963 5.79303 11.8888L8.20603 9.47578L5.79303 7.06278C5.48549 6.75524 5.48549 6.25662 5.79303 5.94909Z",fill:"currentColor"}),c.jsx("path",{d:"M9.99302 5.94909C10.3006 5.64155 10.7992 5.64155 11.1067 5.94909L14.0766 8.91893C14.3841 9.22647 14.3841 9.72509 14.0766 10.0326L11.1067 13.0025C10.7992 13.31 10.3006 13.31 9.99302 13.0025C9.68549 12.6949 9.68549 12.1963 9.99302 11.8888L12.406 9.47578L9.99302 7.06278C9.68549 6.75524 9.68549 6.25662 9.99302 5.94909Z",fill:"currentColor"}),c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.2569 9.5037C18.2569 14.3372 14.3386 18.2555 9.50517 18.2555C4.67171 18.2555 0.753418 14.3372 0.753418 9.5037C0.753418 4.67024 4.67171 0.751953 9.50517 0.751953C14.3386 0.751953 18.2569 4.67024 18.2569 9.5037ZM16.6819 9.5037C16.6819 13.4673 13.4688 16.6805 9.50517 16.6805C5.54156 16.6805 2.32842 13.4673 2.32842 9.5037C2.32842 5.54009 5.54156 2.32695 9.50517 2.32695C13.4688 2.32695 16.6819 5.54009 16.6819 9.5037Z",fill:"currentColor"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.DoubleChevronInCircleIcon=m}),98);
__d("WAWebWdsPictoMetaDataDoubleChevronIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="wds-picto-meta-data-double-chevron";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=70,R=70;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 70 70",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{d:"M19.8366 43.656L28.5011 34.983L19.8498 26.3365C18.5433 25.03 18.5433 22.9195 19.8498 21.613C21.1563 20.3065 23.2668 20.3065 24.5733 21.613L35.6031 32.638C36.9096 33.9445 36.9096 36.055 35.6031 37.3615L24.5601 48.413C23.2536 49.7195 21.1431 49.7195 19.8366 48.413C18.5636 47.1065 18.5301 44.9625 19.8366 43.656Z",fill:"#25D366"}),c.jsx("path",{d:"M45.2512 34.983L36.5867 43.656C35.2802 44.9625 35.3137 47.1065 36.5867 48.413C37.8932 49.7195 40.0037 49.7195 41.3102 48.413L52.3532 37.3615C53.6597 36.055 53.6597 33.9445 52.3532 32.638L41.3234 21.613C40.0169 20.3065 37.9064 20.3065 36.5999 21.613C35.2934 22.9195 35.2934 25.03 36.5999 26.3365L45.2512 34.983Z",fill:"#25D366"}),c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M68.5 35C68.5 16.508 53.492 1.5 35 1.5C16.508 1.5 1.5 16.508 1.5 35C1.5 53.492 16.508 68.5 35 68.5C53.492 68.5 68.5 53.492 68.5 35ZM8.2 35C8.2 20.193 20.193 8.2 35 8.2C49.807 8.2 61.8 20.193 61.8 35C61.8 49.807 49.807 61.8 35 61.8C20.193 61.8 8.2 49.807 8.2 35Z",fill:"#25D366"}),c.jsx("path",{d:"M19.8366 43.656L28.5011 34.983L19.8498 26.3365C18.5433 25.03 18.5433 22.9195 19.8498 21.613C21.1563 20.3065 23.2668 20.3065 24.5733 21.613L35.6031 32.638C36.9096 33.9445 36.9096 36.055 35.6031 37.3615L24.5601 48.413C23.2536 49.7195 21.1431 49.7195 19.8366 48.413C18.5636 47.1065 18.5301 44.9625 19.8366 43.656Z",stroke:"#111B21",strokeWidth:1.5}),c.jsx("path",{d:"M45.2512 34.983L36.5867 43.656C35.2802 44.9625 35.3137 47.1065 36.5867 48.413C37.8932 49.7195 40.0037 49.7195 41.3102 48.413L52.3532 37.3615C53.6597 36.055 53.6597 33.9445 52.3532 32.638L41.3234 21.613C40.0169 20.3065 37.9064 20.3065 36.5999 21.613C35.2934 22.9195 35.2934 25.03 36.5999 26.3365L45.2512 34.983Z",stroke:"#111B21",strokeWidth:1.5}),c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M68.5 35C68.5 16.508 53.492 1.5 35 1.5C16.508 1.5 1.5 16.508 1.5 35C1.5 53.492 16.508 68.5 35 68.5C53.492 68.5 68.5 53.492 68.5 35ZM8.2 35C8.2 20.193 20.193 8.2 35 8.2C49.807 8.2 61.8 20.193 61.8 35C61.8 49.807 49.807 61.8 35 61.8C20.193 61.8 8.2 49.807 8.2 35Z",stroke:"#111B21",strokeWidth:1.5})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.WdsPictoMetaDataDoubleChevronIcon=m}),98);
__d("WAWebBizBotTosContent.react",["fbt","WAWebAiSignalOutlineIcon.react","WAWebBizBotConsumerContentVariant","WAWebBox.react","WAWebBusinessDataSharingIcon.react","WAWebDoubleChevronInCircleIcon.react","WAWebExternalLink.react","WAWebFaqUrl","WAWebFlex.react","WAWebText.react","WAWebUISpacing","WAWebWdsPictoMetaDataDoubleChevronIcon.react","react","stylex"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=o("react")),d={centerText:{textAlign:"x2b8uid",$$css:!0},iconUpdatedUI:{color:"x110helo",$$css:!0},sectionDescription:{color:"x14ug900",$$css:!0},sectionIcon:{width:"xvy4d1p",$$css:!0}};function m(){var t=o("WAWebBizBotConsumerContentVariant").getBizBotConsumerContentVariant(),n=t===o("WAWebBizBotConsumerContentVariant").BizBotConsumerContentVariant.INDIA?null:c.jsx(o("WAWebFlex.react").FlexItem,{xstyle:o("WAWebUISpacing").uiMargin.vert16,children:c.jsx(o("WAWebWdsPictoMetaDataDoubleChevronIcon.react").WdsPictoMetaDataDoubleChevronIcon,{width:67})}),a=c.jsx(o("WAWebText.react").WAWebTextLarge,{weight:"medium",textAlign:"center",children:s._(/*BTDS*/"Recibe ayuda r\u00e1pida en los chats de empresas que usan la IA de Meta")}),i={icon:c.jsx(o("WAWebAiSignalOutlineIcon.react").AiSignalOutlineIcon,{width:24,height:24,iconXstyle:d.iconUpdatedUI}),title:s._(/*BTDS*/"Las empresas entrenan a la IA para darte respuestas \u00fatiles sobre sus productos y servicios.")},l=t===o("WAWebBizBotConsumerContentVariant").BizBotConsumerContentVariant.ROW?{icon:c.jsx(o("WAWebDoubleChevronInCircleIcon.react").DoubleChevronInCircleIcon,{width:24,height:24,iconXstyle:d.iconUpdatedUI}),title:s._(/*BTDS*/"Este \u00edcono indica que Meta, la empresa matriz de WhatsApp, recibe estos chats para mejorar la {=m2}. Puedes dejar de chatear en cualquier momento. {=m5}",[s._implicitParam("=m2",c.jsx(o("WAWebExternalLink.react").ExternalLink,{href:o("WAWebFaqUrl").getMetaGenAiGuideUrl(),children:s._(/*BTDS*/"IA en Meta")})),s._implicitParam("=m5",c.jsx(o("WAWebExternalLink.react").ExternalLink,{href:o("WAWebFaqUrl").getBizBotTosLearnMoreUrl(),children:s._(/*BTDS*/"M\u00e1s informaci\u00f3n")}))])}:t===o("WAWebBizBotConsumerContentVariant").BizBotConsumerContentVariant.INDIA?{icon:c.jsx(o("WAWebBusinessDataSharingIcon.react").BusinessDataSharingIcon,{width:24,height:24,iconXstyle:d.iconUpdatedUI}),title:s._(/*BTDS*/"Meta, la empresa matriz de WhatsApp, recibe estos chats para mejorar la calidad de la IA. Puedes dejar de chatear en cualquier momento. {=m2}",[s._implicitParam("=m2",c.jsx(o("WAWebExternalLink.react").ExternalLink,{href:o("WAWebFaqUrl").getBizBotTosLearnMoreUrl(),children:s._(/*BTDS*/"M\u00e1s informaci\u00f3n")}))])}:t===o("WAWebBizBotConsumerContentVariant").BizBotConsumerContentVariant.BRAZIL?{icon:c.jsx(o("WAWebDoubleChevronInCircleIcon.react").DoubleChevronInCircleIcon,{width:24,height:24,iconXstyle:d.iconUpdatedUI}),title:s._(/*BTDS*/"Este \u00edcono indica que Meta, la empresa matriz de WhatsApp, recibe estos chats y puede usarlos para mejorar la {=m2}.",[s._implicitParam("=m2",c.jsx(o("WAWebExternalLink.react").ExternalLink,{href:o("WAWebFaqUrl").getPrivacyPolicyGenaiUrl(),children:s._(/*BTDS*/"IA en Meta")}))])}:(function(){throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+t)})(),u=t===o("WAWebBizBotConsumerContentVariant").BizBotConsumerContentVariant.BRAZIL?s._(/*BTDS*/"Tus mensajes personales permanecen cifrados de extremo a extremo. Al chatear, indicas que aceptas las {=m2} y la {=m6} de Meta. Obt\u00e9n m\u00e1s informaci\u00f3n sobre tus {=m8} y c\u00f3mo {=m12}. El uso que haces de WhatsApp est\u00e1 sujeto a la {=m15}.",[s._implicitParam("=m2",c.jsx(o("WAWebExternalLink.react").ExternalLink,{href:o("WAWebFaqUrl").getPrivacyPolicyGenaiUrl(),children:s._(/*BTDS*/"Condiciones de la IA")})),s._implicitParam("=m6",c.jsx(o("WAWebExternalLink.react").ExternalLink,{href:o("WAWebFaqUrl").getBotPrivacyPolicyUrl(),children:s._(/*BTDS*/"Pol\u00edtica de privacidad")})),s._implicitParam("=m8",c.jsx(o("WAWebExternalLink.react").ExternalLink,{href:o("WAWebFaqUrl").getWhatsappBrazilBizBotRightsUrl(),children:s._(/*BTDS*/"derechos")})),s._implicitParam("=m12",c.jsx(o("WAWebExternalLink.react").ExternalLink,{href:o("WAWebFaqUrl").getWhatsappBrazilBizBotObjectUrl(),children:s._(/*BTDS*/"objeto")})),s._implicitParam("=m15",c.jsx(o("WAWebExternalLink.react").ExternalLink,{href:o("WAWebFaqUrl").getWhatsappPrivacyPolicyBrazilUrl(),children:s._(/*BTDS*/"Pol\u00edtica de privacidad de WhatsApp")}))]):s._(/*BTDS*/"Tus mensajes personales permanecen cifrados de extremo a extremo. Cuando chateas, indicas que aceptas las {=m2} y la {=m5} de Meta.",[s._implicitParam("=m2",c.jsx(o("WAWebExternalLink.react").ExternalLink,{href:o("WAWebFaqUrl").getBotTermsUrl(),children:s._(/*BTDS*/"Condiciones de la IA")})),s._implicitParam("=m5",c.jsx(o("WAWebExternalLink.react").ExternalLink,{href:o("WAWebFaqUrl").getBotPrivacyPolicyUrl(),children:s._(/*BTDS*/"Pol\u00edtica de privacidad")}))]);return c.jsxs(o("WAWebFlex.react").FlexColumn,{align:"center",xstyle:o("WAWebUISpacing").uiMargin.vertAuto,children:[n,c.jsx(r("WAWebBox.react"),{flex:!0,direction:"vertical",rowGap:8,xstyle:[o("WAWebUISpacing").uiMargin.top16,o("WAWebUISpacing").uiMargin.bottom8],children:a}),[i,l].filter(Boolean).map(function(t,n){var a=t.icon,i=t.title;return c.jsxs(o("WAWebFlex.react").FlexRow,{columnGap:24,className:(e||(e=r("stylex")))(o("WAWebUISpacing").uiMargin.vert10,o("WAWebUISpacing").uiPadding.horiz8),align:"center",children:[c.jsx(o("WAWebFlex.react").FlexItem,{shrink:0,xstyle:d.sectionIcon,children:a}),c.jsx(o("WAWebFlex.react").FlexItem,{xstyle:d.sectionDescription,children:i})]},n)}),c.jsx(r("WAWebBox.react"),{xstyle:o("WAWebUISpacing").uiMargin.vert8,children:c.jsx(o("WAWebText.react").WAWebTextMuted,{xstyle:d.centerText,children:u})})]})}m.displayName=m.name+" [from "+i.id+"]",l.default=m}),226);
__d("WAWebBizBotTos.react",["WAWebBizBotLogging","WAWebBizBotTosContent.react","WAWebBotTos","WAWebConfirmPopup.react","WAWebFbtCommon","WAWebModalManager","WAWebTos","asyncToGeneratorRuntime","react","useWAWebFocusOnMount","useWAWebListener"],(function(t,n,r,o,a,i,l){var e=["ref"],s,u,c=u||(u=o("react")),d=s||(s=r("react")),m=c.useEffect,p=c.useImperativeHandle,_=c.useState;function f(t){var a=t.ref,i=babelHelpers.objectWithoutPropertiesLoose(t,e),l=i.onAccept,s=i.chatEntryPoint,u=_(!1),c=u[0],f=u[1],g=o("WAWebBotTos").hasSeenBotTos();o("useWAWebListener").useListener(o("WAWebTos").TosManager,"change",function(){o("WAWebBotTos").hasAcceptedBizBotTos()&&o("WAWebModalManager").ModalManager.close()}),p(a,function(){return{close:function(){o("WAWebModalManager").ModalManager.close()}}});var h=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){f(!0);try{return yield o("WAWebBotTos").acceptBizBotTos(),yield l==null?void 0:l(),o("WAWebModalManager").ModalManager.close(),!0}catch(e){return!1}finally{f(!1)}});return function(){return e.apply(this,arguments)}})(),y=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WAWebBizBotLogging").logBizBotNuxJourneyEvent("1p","nux_continue_clicked",s),yield h().then(function(e){e&&o("WAWebBizBotLogging").logBizBotNuxJourneyEvent("1p","nux_select",s)})});return function(){return e.apply(this,arguments)}})(),C=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WAWebBizBotLogging").logBizBotNuxJourneyEvent("1p","nux_dismiss",s),yield h().then(function(e){e&&o("WAWebBizBotLogging").logBizBotNuxJourneyEvent("1p","nux_dismiss_auto_accept",s)})});return function(){return e.apply(this,arguments)}})(),b=function(){C()},v=r("useWAWebFocusOnMount")();return m(function(){o("WAWebBizBotLogging").logBizBotNuxJourneyEvent("1p",g?"nux_view_merged":"nux_view_new",s)},[]),d.jsx(o("WAWebConfirmPopup.react").ConfirmPopup,{testid:void 0,okText:r("WAWebFbtCommon")("OK"),onOK:y,okSpinner:c===!0,onOverlayClick:b,ref:v,children:d.jsx(r("WAWebBizBotTosContent.react"),{})})}f.displayName=f.name+" [from "+i.id+"]",l.default=f}),98);
__d("WAWebBizBotTosUtils",["Promise","WAWebBizBotTos.react","WAWebBotGating","WAWebBotTos","WAWebBotTypes","WAWebChatEntryPoint","WAWebContactGetters","WAWebCreateBizBotSysMsgAction","WAWebModalManager","asyncToGeneratorRuntime","react"],(function(t,n,r,o,a,i,l){var e,s,u=s||(s=r("react"));function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a;if(!(!o("WAWebBotGating").isBizBot1pEnabled()||!((a=t.contact.businessProfile)!=null&&a.isBizBot1p)||o("WAWebBotTos").hasSeenBizBotTos(o("WAWebBotTypes").BizBotType.BIZ_1P)||o("WAWebContactGetters").getIsMe(t.contact)))return new(e||(e=n("Promise")))(function(e){var a;o("WAWebModalManager").ModalManager.open(u.jsx(r("WAWebBizBotTos.react"),{onAccept:n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield o("WAWebCreateBizBotSysMsgAction").maybeCreateBizBot1pDisclosureSysMsg(t),e()}),onCancel:e,chatEntryPoint:(a=t.chatEntryPoint)!=null?a:o("WAWebChatEntryPoint").ChatEntryPoint.Unknown}),{blockClose:!0})})}),d.apply(this,arguments)}l.maybeShowBizBot1pTos=c}),98);
__d("WAWebMuteGetters",["WAWebGetters","WAWebGettersCaches"],(function(t,n,r,o,a,i,l){var e=o("WAWebGetters").createGetterFactories({createCache:o("WAWebGettersCaches").createMuteCache}),s=e.field,u=e.computed,c=e.clearCacheFor,d=c,m=s("callExpiration"),p=s("expiration"),_=u(function(e){var t=e[0];return!!t},[p]),f=u(function(e){var t=e[0];return!!t},[m]);l.clearMuteGetterCacheFor=d,l.getCallExpiration=m,l.getExpiration=p,l.getIsMuted=_,l.getIsCallMuted=f}),98);
__d("WAWebNotificationMuteReason",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["ParentMsgMissing","GlobalMute","AppState","MutedChat","ArchivedChat","OfflineResumeInProgress","IgnoreGroupMsg","GroupFlood","ReactionFlood","NonHydratedReaction","MutedStatus","AlreadyNotifiedKic","KicOnNonEphemeralChat","KicOnNonOriginalMsg","KicByMe","UserLeftGroupKic","IgnoreAddedToCommunityHome","IgnoreFutureProof","IgnoreBizContentPlaceholder","IgnoreCallMsgs","IgnoreBotMsgs","IgnoreInternalSilentTag","IgnoreHiddenViewModeMsgs","AIRepliesOn","MutedStatusReaction","IgnoreViewedMsgs","GroupSafetyCheck"]),l=e;i.default=l}),66);
__d("WAWebAiHandoffNotification",["fbt","WAWebBaseNotification","WAWebFrontendContactGetters","WAWebGetNotificationStrings","WAWebMuteGetters","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebNotificationMuteReason","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l,s){var e=(function(e){function t(t){var n,r=t.chat;return n=e.call(this)||this,n.chat=r,n}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a.shouldPlaySound=function(){return e.prototype.shouldPlaySound.call(this)?o("WAWebNotificationHelpers").shouldPlaySoundGranular(this.chat):!1},a.shouldShowBanner=function(){return e.prototype.shouldShowBanner.call(this)?o("WAWebNotificationHelpers").shouldEnableNotificationGranular(this.chat):!1},a.shouldMute=function(t){return o("WAWebNotificationHelpers").shouldMuteDueToAppState(t)?r("WAWebNotificationMuteReason").AppState:o("WAWebMuteGetters").getIsMuted(this.chat.mute)?r("WAWebNotificationMuteReason").MutedChat:this.chat.archive?r("WAWebNotificationMuteReason").ArchivedChat:o("WAWebNotificationHelpers").isOfflineResumeInProgress()?r("WAWebNotificationMuteReason").OfflineResumeInProgress:null},a.buildKey=function(){return"handoff:"+this.chat.id.toString()},a.getIcon=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebNotificationIconUtils").getChatNotificationIcon(this.chat,this.abortController.signal)});function t(){return e.apply(this,arguments)}return t})(),a.getBannerOptions=function(){return{wid:this.chat.id,title:u(),body:o("WAWebGetNotificationStrings").getNotificationBody(babelHelpers.extends({},c(this.chat)))}},t})(o("WAWebBaseNotification").WABaseNotification);function u(){return s._(/*BTDS*/"WhatsApp Business AI").toString()}function c(e){var t=o("WAWebFrontendContactGetters").getFormattedName(e.contact),n=s._(/*BTDS*/"La conversaci\u00f3n de {name} requiere tu atenci\u00f3n.",[s._param("name",t)]);return{body:n.toString()}}l.AiHandoffNotification=e,l.getNotificationTitle=u,l.getNotificationParts=c}),226);
__d("WAWebOrderRequestMsg.flow",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["SMB_META_CATALOG","NATIVE","UNKNOWN"]);i.CatalogType=e}),66);
__d("WAWebLinkedCatalogHelper",["WAWebBusinessProfileCollection","WAWebBusinessProfileTypes","WAWebCatalogCollection","WAWebMobilePlatforms","WAWebOrderRequestMsg.flow","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){"use strict";function e(){var e=o("WAWebUserPrefsMeUser").getMePnUserOrThrow();return s(e)}function s(e){var t,n=o("WAWebUserPrefsMeUser").getMePnUserOrThrow();if(o("WAWebMobilePlatforms").isSMB()&&n.equals(e)){var r=o("WAWebCatalogCollection").CatalogCollection.get(e);return(r==null?void 0:r.catalogType)===o("WAWebOrderRequestMsg.flow").CatalogType.SMB_META_CATALOG}var a=o("WAWebBusinessProfileCollection").BusinessProfileCollection.get(e);return(a==null||(t=a.profileOptions)==null?void 0:t.commerceExperience)===o("WAWebBusinessProfileTypes").CommerceExperienceTypes.META_CATALOG}l.shouldHideComponentForSMBLinkedCatalog=e,l.isLinkedCatalog=s}),98);
__d("WAWebWamEnumCatalogEntryPoint",[],(function(t,n,r,o,a,i){var e=Object.freeze({CATALOG_ENTRY_POINT_PROFILE:1,CATALOG_ENTRY_POINT_SETTINGS:2,CATALOG_ENTRY_POINT_MESSAGE:3,CATALOG_ENTRY_POINT_ATTACHMENT_PANEL:4,CATALOG_ENTRY_POINT_NUX:5,CATALOG_ENTRY_POINT_DEEPLINK:6,CATALOG_ENTRY_POINT_CHAT:7,CATALOG_ENTRY_POINT_ORDER_MESSAGE:8,CATALOG_ENTRY_POINT_INVOICE_ATTACHMENT_PANEL:9,CATALOG_ENTRY_POINT_PRODUCT_LIST_MESSAGE:10,CATALOG_ENTRY_POINT_TOP_BAR:11,CATALOG_ENTRY_POINT_PROFILE_ITEM_CLICK:12,CATALOG_ENTRY_POINT_PROFILE_SEE_ALL:13,CATALOG_ENTRY_POINT_QUOTED_PRODUCT:14,CATALOG_ENTRY_POINT_CATALOG_MESSAGE:15,CATALOG_ENTRY_QBM:16,CATALOG_ENTRY_POINT_ADS_DEEPLINK:17,CATALOG_ENTRY_POINT_WA_PAGES:18,CATALOG_ENTRY_POINT_DIRECTORY_BARE_TIPS:19,CATALOG_ENTRY_POINT_BIZ_ACTION_BAR:20,CATALOG_ENTRY_POINT_BIZ_ONBOARDING:21,CATALOG_ENTRY_POINT_TRUST_CARD:22,CATALOG_ENTRY_POINT_FLOWS:23,CATALOG_ENTRY_POINT_BIZ_AI_HOME:24,CATALOG_ENTRY_POINT_BUSINESS_HOME:25,CATALOG_ENTRY_POINT_LEARNING_HUB:26});i.CATALOG_ENTRY_POINT=e}),66);
__d("WAWebWamEnumCatalogViewAction",[],(function(t,n,r,o,a,i){var e=Object.freeze({ACTION_CARD_ITEM_CLICK:2,ACTION_CARD_MORE_CLICK:3,ACTION_LIST_IMPRESSION:4,ACTION_DETAIL_IMAGE_CLICK:6,ACTION_DETAIL_LINK_CLICK:7,ACTION_FULL_IMAGE_SWIPE:11,ACTION_DETAIL_IMPRESSION:12,ACTION_REPORT_PRODUCT:13,ACTION_SEND_PRODUCT_MESSAGE:14,ACTION_REPORT_PRODUCT_SUCCESS:15,ACTION_REPORT_PRODUCT_FAILURE:16,ACTION_QUOTED_PRODUCT_IN_CONVERSATION_CLICK:17,ACTION_PRODUCT_IN_CONVERSATION_CLICK:18,ACTION_SHARE_CATALOG_LINK_CLICK:19,ACTION_SHARE_PRODUCT_LINK_CLICK:20,ACTION_CATALOG_IN_CONVERSATION_CLICK:21,ACTION_SHARE_CATALOG_VIA_WA_LINK_CLICK:22,ACTION_SHARE_PRODUCT_VIA_WA_LINK_CLICK:23,ACTION_SHARE_CATALOG_COPY_LINK_CLICK:24,ACTION_SHARE_PRODUCT_COPY_LINK_CLICK:25,ACTION_CHAT_CATALOG_ICON_CLICK:26,ACTION_MESSAGE_BUSINESS_BUTTON_CLICK:27,ACTION_CART_ADD_PRODUCT:28,ACTION_CART_EDIT_PRODUCT:29,ACTION_CART_DELETE_PRODUCT:30,ACTION_CART_ABANDON:31,ACTION_CART_ICON_CLICK:32,ACTION_CART_SNACKBAR_CLICK:33,ACTION_SEND_ORDER_MESSAGE:34,ACTION_ORDER_LIST_IMPRESSION:35,ACTION_QUOTED_PRODUCT_MESSAGE_SEND:36,ACTION_CART_LIST_IMPRESSION:37,ACTION_ORDER_MESSAGE_CLICK:38,ACTION_ORDER_LIST_ITEM_CLICK:39,ACTION_PLM_CART_CTA_CLICK:40,ACTION_CART_CHAT_ICON_CLICK:42,ACTION_CREATE_CART:43,ACTION_PLP_PRODUCT_VARIANT_BOTTOM_SHEET_OPEN:44,ACTION_PLP_PRODUCT_VARIANT_CHANGE:45,ACTION_PDP_PRODUCT_VARIANT_CHANGE:46,ACTION_PLP_BOTTOM_SHEET_SEE_MORE_DETAILS:47,ACTION_UPDATE_VARIANT_SELECTION:48,ACTION_VIEW_PRODUCT_VARIANTS_BOTTOM_SHEET:49,ACTION_WATCH_PRODUCT_VIDEO:50,ACTION_DETAIL_VIDEO_CLICK:51,ACTION_FULL_VIDEO_SWIPE:52,ACTION_LIST_LOAD:53,ACTION_DETAIL_LOAD:54});i.CATALOG_VIEW_ACTION=e}),66);
__d("WAWebWamEnumDeepLinkOpenFrom",[],(function(t,n,r,o,a,i){var e=Object.freeze({DEEP_LINK_EXTERNAL:1,DEEP_LINK_WA_LINK_CLICK:2,QR_CODE_SHEET:3,DEEP_LINK_BANNER:4,DEEP_LINK_SMB_NOTIFICATION:5,DEEP_LINK_MESSENGER_APP:6});i.DEEP_LINK_OPEN_FROM=e}),66);
__d("WAWebBizCatalogViewWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumBizPlatform","WAWebWamEnumCatalogEntryPoint","WAWebWamEnumCatalogViewAction","WAWebWamEnumDeepLinkOpenFrom","WAWebWamEnumEntryPointConversationInitiated"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({BizCatalogView:[3006,{adId:[26,e.TYPES.STRING],bizPlatform:[14,o("WAWebWamEnumBizPlatform").BIZ_PLATFORM],cartToggle:[13,e.TYPES.BOOLEAN],catalogCategoryId:[19,e.TYPES.STRING],catalogEntryPoint:[2,o("WAWebWamEnumCatalogEntryPoint").CATALOG_ENTRY_POINT],catalogEventSampled:[11,e.TYPES.BOOLEAN],catalogOwnerJid:[10,e.TYPES.STRING],catalogReportReasonCode:[8,e.TYPES.STRING],catalogSessionId:[3,e.TYPES.STRING],catalogViewAction:[1,o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION],collectionId:[15,e.TYPES.STRING],collectionIndex:[16,e.TYPES.STRING],deepLinkOpenFrom:[12,o("WAWebWamEnumDeepLinkOpenFrom").DEEP_LINK_OPEN_FROM],entryPointConversationInitiated:[22,o("WAWebWamEnumEntryPointConversationInitiated").ENTRY_POINT_CONVERSATION_INITIATED],entryPointConversionApp:[20,e.TYPES.STRING],entryPointConversionSource:[21,e.TYPES.STRING],hasVariants:[23,e.TYPES.BOOLEAN],isNewProductAddedToCart:[7,e.TYPES.BOOLEAN],isOrderMsgAttached:[5,e.TYPES.BOOLEAN],orderId:[4,e.TYPES.STRING],productId:[9,e.TYPES.STRING],productIndex:[17,e.TYPES.STRING],quantity:[6,e.TYPES.INTEGER],sequenceNumber:[18,e.TYPES.INTEGER],variantTypes:[24,e.TYPES.STRING],variantsExtraAttributes:[25,e.TYPES.STRING]},[1,1,1],"private",0]},{BizCatalogView:[]});l.BizCatalogViewWamEvent=s}),98);
__d("WAWebWamEnumCatalogBizAction",[],(function(t,n,r,o,a,i){var e=Object.freeze({ACTION_PRODUCT_ADD_CLICKED:1,ACTION_PRODUCT_ADD_SUCCESS:2,ACTION_PRODUCT_ADD_FAILED:3,ACTION_PRODUCT_EDIT_CLICKED:4,ACTION_PRODUCT_EDIT_SUCCESS:5,ACTION_PRODUCT_EDIT_FAILED:6,ACTION_PRODUCT_DELETE_CLICKED:7,ACTION_PRODUCT_DELETE_SUCCESS:8,ACTION_PRODUCT_DELETE_FAILED:9,ACTION_APPEAL_PRODUCT_CLICKED:10,ACTION_APPEAL_PRODUCT_SUCCESS:11,ACTION_APPEAL_PRODUCT_FAILED:12,ACTION_CREATE_PRODUCT_CATALOG:13,ACTION_CREATE_PRODUCT_CATALOG_SUCCESS:14,ACTION_CREATE_PRODUCT_CATALOG_FAILED:15,ACTION_CATALOG_MENU_ITEM_CLICKED:16,ACTION_PRODUCT_RESUBMIT_CLICKED:17,ACTION_START_IMPORT_FLOW:18,ACTION_IMPORT_POST:19,ACTION_CARD_ITEM_CLICK:21,ACTION_CARD_MORE_CLICK:22,ACTION_LIST_IMPRESSION:23,ACTION_DETAIL_IMAGE_CLICK:25,ACTION_DETAIL_LINK_CLICK:26,ACTION_FULL_IMAGE_SWIPE:30,ACTION_DETAIL_IMPRESSION:31,ACTION_QUOTED_PRODUCT_IN_CONVERSATION_CLICK:32,ACTION_PRODUCT_IN_CONVERSATION_CLICK:33,ACTION_SEND_PRODUCT_MESSAGE:34,ACTION_ONBOARD_IMPRESSION:35,ACTION_SHARE_CATALOG_LINK_CLICK:36,ACTION_SHARE_PRODUCT_LINK_CLICK:37,ACTION_CATALOG_IN_CONVERSATION_CLICK:38,ACTION_SHARE_CATALOG_VIA_WA_LINK_CLICK:39,ACTION_SHARE_PRODUCT_VIA_WA_LINK_CLICK:40,ACTION_SHARE_CATALOG_COPY_LINK_CLICK:41,ACTION_SHARE_PRODUCT_COPY_LINK_CLICK:42,ACTION_SEND_CATALOG_CLICK:43,ACTION_ORDER_MESSAGE_CLICK:44,ACTION_ORDER_LIST_IMPRESSION:45,ACTION_ORDER_LIST_ITEM_CLICK:46,ACTION_MESSAGE_BUSINESS_BUTTON_CLICK:47,ACTION_QUOTED_PRODUCT_MESSAGE_SEND:48,ACTION_CART_ADD_PRODUCT:49,ACTION_CART_ICON_CLICK:50,ACTION_CART_SNACKBAR_CLICK:51,ACTION_CART_LIST_IMPRESSION:52,ACTION_CART_EDIT_PRODUCT:53,ACTION_CART_DELETE_PRODUCT:54,ACTION_CART_ABANDON:55,ACTION_SEND_ORDER_MESSAGE:56,ACTION_MENU_CLICK:57,ACTION_PRODUCT_HIDE_CLICKED:58,ACTION_PRODUCT_HIDE_SUCCESS:59,ACTION_PRODUCT_HIDE_CANCELLED:60,ACTION_PRODUCT_HIDE_FAILED:61,ACTION_PRODUCT_UNHIDE_CLICKED:62,ACTION_PRODUCT_UNHIDE_SUCCESS:63,ACTION_PRODUCT_UNHIDE_CANCELLED:64,ACTION_PRODUCT_UNHIDE_FAILED:65,ACTION_CATALOG_LIST_MENU_CLICKED:66,ACTION_CATALOG_LIST_MENU_CLICKED_WITH_ADVERTISE_SHOWN:67,ACTION_COLLECTION_CREATE_CLICKED:68,ACTION_COLLECTION_CREATED:69,ACTION_MENU_COLLECTIONS_CLICK:70,ACTION_COLLECTION_RENAME_CLICKED:71,ACTION_COLLECTION_RENAME_CANCELLED:72,ACTION_COLLECTION_RENAMED:73,ACTION_COLLECTION_DELETE_CLICKED:74,ACTION_COLLECTION_DELETE_CANCELLED:75,ACTION_COLLECTION_DELETED:76,ACTION_COLLECTION_ASSIGN_ITEMS:77,ACTION_COLLECTION_UNASSIGN_ITEMS:78,ACTION_COLLECTION_CHANGE_ORDER:80,ACTION_COLLECTION_ITEM_CHANGE_ORDER:81,ACTION_ERROR_SAVING_ITEM:82,ACTION_MEDIA_DELETE_SUCCESS:83,ACTION_SAVING_PRODUCT_PROGRESS_BAR:84,ACTION_CONTINUE_SAVING_PRODUCT:85,ACTION_ABORT_SAVING_PRODUCT:86,ACTION_CLICK_SAVE_PRODUCT:87,ACTION_CHOOSE_PRODUCT_INTENT:88,ACTION_DETAIL_VIDEO_CLICK:89,ACTION_WATCH_PRODUCT_VIDEO:90,ACTION_FULL_VIDEO_SWIPE:91,ACTION_PROCEED_TO_REPLACE_MEDIA:92,ACTION_PRODUCT_LINK_SHARE_TO_STATUS_BTN_IMPRESSION:93,ACTION_PRODUCT_LINK_SHARE_TO_STATUS_BTN_CLICKED:94,ACTION_CATALOG_LINK_SHARE_TO_STATUS_BTN_IMPRESSION:95,ACTION_CATALOG_LINK_SHARE_TO_STATUS_BTN_CLICKED:96});i.CATALOG_BIZ_ACTION=e}),66);
__d("WAWebCatalogBizWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCatalogBizAction","WAWebWamEnumCatalogEntryPoint","WAWebWamEnumDeepLinkOpenFrom","WAWebWamEnumLastMessageDirection"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({CatalogBiz:[1722,{adId:[19,e.TYPES.STRING],cartToggle:[13,e.TYPES.BOOLEAN],catalogAppealReason:[4,e.TYPES.STRING],catalogBizAction:[1,o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION],catalogEntryPoint:[7,o("WAWebWamEnumCatalogEntryPoint").CATALOG_ENTRY_POINT],catalogSessionId:[3,e.TYPES.STRING],collectionCount:[18,e.TYPES.INTEGER],collectionId:[14,e.TYPES.STRING],collectionIndex:[15,e.TYPES.STRING],deepLinkOpenFrom:[8,o("WAWebWamEnumDeepLinkOpenFrom").DEEP_LINK_OPEN_FROM],entryPointConversionSource:[20,e.TYPES.STRING],errorCode:[5,e.TYPES.INTEGER],extraAttributes:[24,e.TYPES.STRING],isOrderMsgAttached:[10,e.TYPES.BOOLEAN],lastMessageDirection:[21,o("WAWebWamEnumLastMessageDirection").LAST_MESSAGE_DIRECTION],messageDepth:[22,e.TYPES.INTEGER],orderId:[9,e.TYPES.STRING],productCount:[6,e.TYPES.INTEGER],productId:[2,e.TYPES.STRING],productIds:[12,e.TYPES.STRING],productIndex:[16,e.TYPES.STRING],quantity:[11,e.TYPES.INTEGER],threadIdHmac:[23,e.TYPES.STRING]},[1,1,1],"regular"]},{CatalogBiz:[]});l.CatalogBizWamEvent=s}),98);
__d("WAWebProductCatalogSession",["WALogger"],(function(t,n,r,o,a,i,l){var e,s="accidental_session",u=(function(){function t(e){this.accidental=e||!1,this.initSessionId()}var n=t.prototype;return n.isAccidental=function(){return this.accidental},n.initSessionId=function(){this.sessionId=this.newSessionId()},n.newSessionId=function(){return this.sessionId=Math.floor(2147483648*Math.random()),this.sessionId},n.toString=function(){var t=""+this.sessionId;return this.accidental&&(o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Session ID requested without being set, returning a randon accidental session. Please investigate."]))),t=s+"_"+t),t},t})();l.ProductCatalogSession=u}),98);
__d("WAWebProductCatalogContext",["WAWebProductCatalogSession","WAWebWamEnumBizPlatform"],(function(t,n,r,o,a,i,l){function e(e,t,n){return e===void 0&&(e=new(o("WAWebProductCatalogSession")).ProductCatalogSession),t===void 0&&(t=o("WAWebWamEnumBizPlatform").BIZ_PLATFORM.UNKNOWN),{type:"product_catalog",session:e,entryPoint:n,bizPlatform:t}}function s(){return e(new(o("WAWebProductCatalogSession")).ProductCatalogSession(!0))}function u(e){return c(e).session.toString()}function c(e){return e.type==="product_catalog"?e:s()}function d(e){return{catalogSessionId:e.session.toString(),bizPlatform:e.bizPlatform,catalogEntryPoint:e.entryPoint}}l.buildProductCatalogContext=e,l.getProductCatalogSessionId=u,l.getProductCatalogContext=c,l.toDataForCatalogViewEvents=d}),98);
__d("WAWebProductCatalogEventUtils",["WAWebBizCatalogViewWamEvent","WAWebBizGatingUtils","WAWebCatalogBizWamEvent","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){var e=["isOwner","catalogBizAction","catalogViewAction","bizActionConfig","bizPlatform","catalogOwnerJid"],s=function(t){var e;return r("isStringNullOrEmpty")(t.catalogOwnerJid)?t.catalogOwnerWid?e=t.catalogOwnerWid:t.product&&(e=t.product.catalogWid):e=o("WAWebWidFactory").createWid(t.catalogOwnerJid),e instanceof r("WAWebWid")&&o("WAWebUserPrefsMeUser").isMeAccount(e)},u=function(n){var t=n.isOwner,r=n.catalogBizAction,a=n.catalogViewAction,i=n.bizActionConfig,l=n.bizPlatform,s=n.catalogOwnerJid,u=babelHelpers.objectWithoutPropertiesLoose(n,e);if(r&&t){new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent(babelHelpers.extends({catalogBizAction:r},u,i)).commit();return}if(a&&o("WAWebBizGatingUtils").isPSForCatalogViewEnabled()){new(o("WAWebBizCatalogViewWamEvent")).BizCatalogViewWamEvent(babelHelpers.extends({catalogViewAction:a,bizPlatform:l,catalogOwnerJid:s},u)).commit();return}};l.isCatalogOwner=s,l.logCatalogViewOrBizEvent=u}),98);
__d("WAWebProductCatalogLogEvents",["WAWebBizCatalogUtils","WAWebBizCatalogViewWamEvent","WAWebCatalogBizWamEvent","WAWebProductCatalogContext","WAWebProductCatalogEventUtils","WAWebProductCatalogSession","WAWebUserPrefsMeUser","WAWebWamEnumCatalogBizAction","WAWebWamEnumCatalogEntryPoint","WAWebWamEnumCatalogViewAction","WAWebWidFactory","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){function e(e){var t=e.catalogOwnerWid,n=e.catalogContext;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({},o("WAWebProductCatalogContext").toDataForCatalogViewEvents(n),{isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({catalogOwnerWid:t}),catalogOwnerJid:t.toJid()}))}function s(e){var t=e.product,n=e.catalogContext;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({product:t}),catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_CARD_ITEM_CLICK},o("WAWebProductCatalogContext").toDataForCatalogViewEvents(n),{catalogOwnerJid:t.catalogWid.toJid()}))}function u(e){var t=e.catalogOwnerWid,n=e.catalogContext;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({catalogOwnerWid:t}),catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_CARD_MORE_CLICK,catalogOwnerJid:t.toJid()},o("WAWebProductCatalogContext").toDataForCatalogViewEvents(n)))}function c(e){var t=e.catalogOwnerWid,n=e.catalogContext,r=e.cartToggle;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({catalogOwnerWid:t}),catalogViewAction:o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_LIST_IMPRESSION,catalogOwnerJid:t.toJid(),cartToggle:r},o("WAWebProductCatalogContext").toDataForCatalogViewEvents(n)))}function d(e){var t=e.catalogOwnerWid,n=e.catalogContext,r=o("WAWebProductCatalogEventUtils").isCatalogOwner({catalogOwnerWid:t});o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({isOwner:r,catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_SHARE_CATALOG_LINK_CLICK,catalogViewAction:o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_SHARE_CATALOG_LINK_CLICK,catalogOwnerJid:t.toJid()},o("WAWebProductCatalogContext").toDataForCatalogViewEvents(n)))}function m(e){var t=e.product,n=e.catalogContext;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({catalogOwnerJid:t.catalogWid.toJid(),isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({product:t})},o("WAWebProductCatalogContext").toDataForCatalogViewEvents(n)))}function p(e){var t=e.product,n=e.catalogContext;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({product:t}),catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_DETAIL_IMAGE_CLICK,catalogViewAction:o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_DETAIL_IMAGE_CLICK,catalogOwnerJid:t.catalogWid.toJid(),productId:t.id.toString()},o("WAWebProductCatalogContext").toDataForCatalogViewEvents(n)))}function _(e){var t=e.product,n=e.catalogContext;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({catalogOwnerJid:t.catalogWid.toJid(),isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({product:t}),catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_DETAIL_LINK_CLICK,catalogViewAction:o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_DETAIL_LINK_CLICK,productId:t.id.toString()},o("WAWebProductCatalogContext").toDataForCatalogViewEvents(n)))}function f(e){var t=e.product,n=e.catalogSessionId;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent({catalogOwnerJid:t.catalogWid.toJid(),isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({product:t}),catalogSessionId:n})}function g(e){var t=e.product,n=e.catalogSessionId;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent({catalogOwnerJid:t.catalogWid.toJid(),isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({product:t}),catalogSessionId:n})}function h(e){var t=e.product,n=e.catalogSessionId;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent({catalogOwnerJid:t.catalogWid.toJid(),isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({product:t}),catalogSessionId:n})}function y(e){var t=e.product,n=e.catalogSessionId;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent({catalogOwnerJid:t.catalogWid.toJid(),isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({product:t}),catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_FULL_IMAGE_SWIPE,catalogViewAction:o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_FULL_IMAGE_SWIPE,catalogSessionId:n,productId:t.id.toString()})}function C(e){var t=e.product,n=e.catalogContext,r=e.cartToggle,a=e.collectionId,i=o("WAWebBizCatalogUtils").getProductStatsInFetched(t.catalogWid.toString(),a,t);o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({catalogOwnerJid:t.catalogWid.toJid(),isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({product:t}),catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_DETAIL_IMPRESSION,catalogViewAction:o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_DETAIL_IMPRESSION,cartToggle:r},i,o("WAWebProductCatalogContext").toDataForCatalogViewEvents(n)))}function b(e){var t=e.product,n=e.catalogSessionId,r=e.reason;new(o("WAWebBizCatalogViewWamEvent")).BizCatalogViewWamEvent({catalogViewAction:o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_REPORT_PRODUCT_SUCCESS,catalogSessionId:n,catalogOwnerJid:t.catalogWid.toJid(),catalogReportReasonCode:r,productId:t.id.toString()}).commit()}function v(e){var t=e.product,n=e.catalogSessionId,r=e.reason;new(o("WAWebBizCatalogViewWamEvent")).BizCatalogViewWamEvent({catalogViewAction:o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_REPORT_PRODUCT_FAILURE,catalogOwnerJid:t.catalogWid.toJid(),catalogSessionId:n,catalogReportReasonCode:r,productId:t.id.toString()}).commit()}function S(e){var t=e.product,n=e.catalogContext,r=o("WAWebProductCatalogEventUtils").isCatalogOwner({product:t});o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({isOwner:r,catalogOwnerJid:t.catalogWid.toJid(),catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_QUOTED_PRODUCT_IN_CONVERSATION_CLICK},o("WAWebProductCatalogContext").toDataForCatalogViewEvents(n)))}function R(e){var t=e.product,n=e.catalogContext;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({product:t}),catalogOwnerJid:t.catalogWid.toJid(),catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_IN_CONVERSATION_CLICK},o("WAWebProductCatalogContext").toDataForCatalogViewEvents(n)))}function L(e){var t=e.product,n=e.catalogContext;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({product:t}),catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_SHARE_PRODUCT_LINK_CLICK,catalogOwnerJid:t.catalogWid.toJid(),catalogViewAction:o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_SHARE_PRODUCT_LINK_CLICK,productId:t.id.toString()},o("WAWebProductCatalogContext").toDataForCatalogViewEvents(n)))}function E(e,t){o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({product:e}),catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_MESSAGE_BUSINESS_BUTTON_CLICK,catalogOwnerJid:e.catalogWid.toJid(),catalogViewAction:o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_MESSAGE_BUSINESS_BUTTON_CLICK,productId:e.id.toString()},o("WAWebProductCatalogContext").toDataForCatalogViewEvents(t)))}function k(e,t){var n,a=!1,i="";e.businessOwnerJid!=null&&(i=e.businessOwnerJid,a=o("WAWebUserPrefsMeUser").getMePnUserOrThrow().equals(o("WAWebWidFactory").createWid(i))),o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent({isOwner:a,catalogOwnerJid:i,catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_QUOTED_PRODUCT_MESSAGE_SEND,catalogViewAction:o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_QUOTED_PRODUCT_MESSAGE_SEND,productId:e==null||(n=e.productId)==null?void 0:n.toString(),catalogSessionId:r("isStringNullOrEmpty")(t)?new(o("WAWebProductCatalogSession")).ProductCatalogSession().toString():t})}function I(e){var t=e.product,n=e.catalogContext;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({product:t}),catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_SHARE_PRODUCT_COPY_LINK_CLICK,catalogOwnerJid:t.catalogWid.toJid(),catalogViewAction:o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_SHARE_PRODUCT_COPY_LINK_CLICK,productId:t.id.toString()},o("WAWebProductCatalogContext").toDataForCatalogViewEvents(n)))}function T(e){var t=e.product,n=e.catalogContext;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({product:t}),catalogOwnerJid:t.catalogWid.toJid(),catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_SHARE_PRODUCT_VIA_WA_LINK_CLICK,catalogViewAction:o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_SHARE_PRODUCT_VIA_WA_LINK_CLICK,productId:t.id.toString()},o("WAWebProductCatalogContext").toDataForCatalogViewEvents(n)))}function D(e){var t=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_CATALOG_IN_CONVERSATION_CLICK,catalogEntryPoint:o("WAWebWamEnumCatalogEntryPoint").CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_ATTACHMENT_PANEL,catalogSessionId:e});t.commit()}function x(e){var t=e.product,n=e.catalogSessionId;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent({isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({product:t}),catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_SEND_PRODUCT_MESSAGE,catalogOwnerJid:t.catalogWid.toJid(),catalogViewAction:o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_SEND_PRODUCT_MESSAGE,catalogSessionId:n,productId:t.id.toString()})}function $(e){var t=e.catalogOwnerWid,n=e.catalogSessionId,r=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_SEND_CATALOG_CLICK,catalogSessionId:n});r.commit()}function P(e){var t=e.catalogOwnerWid,n=e.catalogContext;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({catalogOwnerWid:t}),catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_SHARE_CATALOG_COPY_LINK_CLICK,catalogOwnerJid:t.toJid(),catalogViewAction:o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_SHARE_CATALOG_COPY_LINK_CLICK},o("WAWebProductCatalogContext").toDataForCatalogViewEvents(n)))}function N(e){var t=e.catalogOwnerWid,n=e.catalogContext;o("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers.extends({catalogOwnerJid:t.toJid(),isOwner:o("WAWebProductCatalogEventUtils").isCatalogOwner({catalogOwnerWid:t}),catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_SHARE_CATALOG_VIA_WA_LINK_CLICK,catalogViewAction:o("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_SHARE_CATALOG_VIA_WA_LINK_CLICK},o("WAWebProductCatalogContext").toDataForCatalogViewEvents(n)))}function M(e,t){var n={has_catalog:t},r=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_ADD_CLICKED,catalogSessionId:e.session.toString(),catalogEntryPoint:e.entryPoint,extraAttributes:JSON.stringify(n)});r.commit()}function w(e){var t=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_ADD_SUCCESS,catalogEntryPoint:e.entryPoint,catalogSessionId:e.session.toString()});t.commit()}function A(e,t){var n=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_ADD_FAILED,catalogEntryPoint:e.entryPoint,catalogSessionId:e.session.toString(),errorCode:t});n.commit()}function F(e,t){var n=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_EDIT_CLICKED,productId:e.id.toString(),catalogEntryPoint:t.entryPoint,catalogSessionId:t.session.toString()});n.commit()}function O(e,t){var n=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_EDIT_SUCCESS,catalogEntryPoint:t.entryPoint,productId:e.id.toString(),catalogSessionId:t.session.toString()});n.commit()}function B(e,t,n){var r=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_EDIT_FAILED,catalogEntryPoint:t.entryPoint,productId:e.id.toString(),errorCode:n,catalogSessionId:t.session.toString()});r.commit()}function W(e,t,n){var r=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_DELETE_CLICKED,catalogEntryPoint:n.entryPoint,productId:e.id.toString(),productCount:t,catalogSessionId:n.session.toString()});r.commit()}function q(e,t,n){var r=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_DELETE_SUCCESS,catalogEntryPoint:n.entryPoint,productId:e.id.toString(),productCount:t,catalogSessionId:n.session.toString()});r.commit()}function U(e,t,n,r){var a=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_DELETE_FAILED,catalogEntryPoint:n.entryPoint,productId:e.id.toString(),productCount:t,errorCode:r,catalogSessionId:n.session.toString()});a.commit()}function V(e){var t=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_ONBOARD_IMPRESSION,catalogEntryPoint:e.entryPoint,catalogSessionId:e.session.toString()});t.commit()}function H(e){var t=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_CREATE_PRODUCT_CATALOG,catalogEntryPoint:e.entryPoint,catalogSessionId:e.session.toString()});t.commit()}function G(e){var t=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_CREATE_PRODUCT_CATALOG_SUCCESS,catalogEntryPoint:e.entryPoint,catalogSessionId:e.session.toString()});t.commit()}function z(e,t){var n=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_CREATE_PRODUCT_CATALOG_FAILED,catalogEntryPoint:e.entryPoint,errorCode:t,catalogSessionId:e.session.toString()});n.commit()}function j(e){var t=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_APPEAL_PRODUCT_CLICKED,catalogEntryPoint:o("WAWebWamEnumCatalogEntryPoint").CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_SETTINGS,catalogSessionId:e});t.commit()}function K(e){var t=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_APPEAL_PRODUCT_SUCCESS,catalogEntryPoint:o("WAWebWamEnumCatalogEntryPoint").CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_SETTINGS,catalogSessionId:e});t.commit()}function Q(e,t){var n=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_APPEAL_PRODUCT_FAILED,catalogEntryPoint:o("WAWebWamEnumCatalogEntryPoint").CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_SETTINGS,errorCode:t,catalogSessionId:e});n.commit()}function X(e,t){var n=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_MENU_CLICK,catalogEntryPoint:t==null?void 0:t.entryPoint,catalogSessionId:t==null?void 0:t.session.toString(),productId:e});n.commit()}function Y(e,t){var n=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_HIDE_CLICKED,catalogEntryPoint:t.entryPoint,catalogSessionId:t.session.toString(),productId:e});n.commit()}function J(e,t){var n=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_HIDE_SUCCESS,catalogEntryPoint:t.entryPoint,catalogSessionId:t.session.toString(),productId:e});n.commit()}function Z(e,t){var n=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_HIDE_CANCELLED,catalogEntryPoint:t.entryPoint,catalogSessionId:t.session.toString(),productId:e});n.commit()}function ee(e,t){var n=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_HIDE_FAILED,catalogEntryPoint:t.entryPoint,catalogSessionId:t.session.toString(),productId:e});n.commit()}function te(e,t){var n=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_UNHIDE_CLICKED,catalogEntryPoint:t.entryPoint,catalogSessionId:t.session.toString(),productId:e});n.commit()}function ne(e,t){var n=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_UNHIDE_SUCCESS,catalogEntryPoint:t.entryPoint,catalogSessionId:t.session.toString(),productId:e});n.commit()}function re(e,t){var n=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_UNHIDE_CANCELLED,catalogEntryPoint:t.entryPoint,catalogSessionId:t.session.toString(),productId:e});n.commit()}function oe(e,t){var n=new(o("WAWebCatalogBizWamEvent")).CatalogBizWamEvent({catalogBizAction:o("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_UNHIDE_FAILED,catalogEntryPoint:t.entryPoint,catalogSessionId:t.session.toString(),productId:e});n.commit()}l.logBusinessProfileCatalogView=e,l.logProfileProductClick=s,l.logCarouselViewMoreClick=u,l.logCatalogListView=c,l.logCatalogShareLinkClick=d,l.logCatalogListDetailClick=m,l.logDetailImageClick=p,l.logDetailLinkClick=_,l.logImageCarouselModalView=f,l.logImageListClick=g,l.logFullImageView=h,l.logImageNavigate=y,l.logProductDetailView=C,l.logReportProductSuccess=b,l.logReportProductFailure=v,l.logProductInquiryClick=S,l.logProductMsgClick=R,l.logProductShareLinkClick=L,l.logProductMessageBusinessClick=E,l.logProductMessageBusinessSend=k,l.logShareProductCopyLinkClick=I,l.logShareProductViaWALinkClick=T,l.logCatalogAttachmentButtonClick=D,l.logProductMessageSent=x,l.logSendCatalogClick=$,l.logShareCatalogCopyLinkClick=P,l.logShareCatalogViaWALinkClick=N,l.logAddProductClick=M,l.logAddProductSuccess=w,l.logAddProductFailed=A,l.logEditProductClick=F,l.logEditProductSuccess=O,l.logEditProductFailed=B,l.logDeleteProductClick=W,l.logDeleteProductSuccess=q,l.logDeleteProductFailed=U,l.logCatalogOnboardImpression=V,l.logCreateProductCatalogClick=H,l.logCreateProductCatalogSuccess=G,l.logCreateProductCatalogFailed=z,l.logAppealProductCatalogClick=j,l.logAppealProductCatalogSuccess=K,l.logAppealProductCatalogFailed=Q,l.logCatalogContextMenuClick=X,l.logCatalogProductHideClick=Y,l.logCatalogProductHideSuccess=J,l.logCatalogProductHideCancelled=Z,l.logCatalogProductHideFailed=ee,l.logCatalogProductShowClick=te,l.logCatalogProductShowSuccess=ne,l.logCatalogProductShowCancelled=re,l.logCatalogProductShowFailed=oe}),98);
__d("WAWebProductCatalogMetaLinkingGatingUtils",["fbt","WAWebABProps","WAWebBizGatingUtils","WAWebBusinessProfileCollection","WAWebBusinessProfileTypes","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l,s){"use strict";function e(){return s._(/*BTDS*/"Cat\u00e1logo conectado. Visual\u00edzalo con la aplicaci\u00f3n m\u00f3vil de WhatsApp.")}function u(){if(!g())return!1;var e=o("WAWebBusinessProfileCollection").BusinessProfileCollection.get(o("WAWebUserPrefsMeUser").getMePnUserOrThrow());return h(e)}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return g()?p(e):!1}),d.apply(this,arguments)}function m(){if(o("WAWebBizGatingUtils").isCatalogVariantsViewingEnabled()||g())return!1;var e=o("WAWebBusinessProfileCollection").BusinessProfileCollection.get(o("WAWebUserPrefsMeUser").getMePnUserOrThrow());return h(e)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebBusinessProfileCollection").BusinessProfileCollection.fetchBizProfile(e);return h(t)}),_.apply(this,arguments)}function f(e){return h(e)}function g(){return o("WAWebABProps").getABPropConfigValue("meta_catalog_linking_m2_enabled")}function h(e){var t;return y()?!0:o("WAWebBizGatingUtils").isCatalogVariantsViewingEnabled()?!1:(e==null||(t=e.profileOptions)==null?void 0:t.commerceExperience)===o("WAWebBusinessProfileTypes").CommerceExperienceTypes.META_CATALOG}function y(){var e=window.location.search,t=new URLSearchParams(e);return t.get("force_disable_catalog")==="1"}l.getDisabledMetaLinkedCatalogTooltipText=e,l.shouldShowMetaLinkedDisabledCatalogTooltipForSelf=u,l.shouldShowMetaLinkedDisabledCatalogTooltip=c,l.shouldDisableCatalogDueToMetaLinkingForSelf=m,l.shouldDisableCatalogDueToMetaLinking=p,l.shouldDisableCatalogDueToMetaLinkingForProfile=f,l.linkedCatalogDisabledTooltipEnabled=g}),226);
__d("WAWebRestoreBotProfilesFromDb",["WALogger","WAWebBotProfileCollection","WAWebSchemaBotProfile","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m=["id","prompts","commands"];function p(){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield o("WAWebSchemaBotProfile").getBotProfileTable().all();t.forEach(function(t){var n=t.id,r=t.prompts,a=t.commands,i=babelHelpers.objectWithoutPropertiesLoose(t,m),l;try{l=o("WAWebWidFactory").createUserWidOrThrow(n)}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["restore-bot-profiles: invalid id"]))).sendLogs("restore-bot-profiles: invalid id");return}var p=[];if(r)try{p=JSON.parse(r),Array.isArray(p)||(p=[],o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["restore-bot-profiles: prompts are not an array"]))).sendLogs("restore-bot-profiles: prompts are not an array"))}catch(e){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["restore-bot-profiles: prompts parsing failed"]))).sendLogs("restore-bot-profiles: prompts parsing failed")}var _=[];if(a!=null)try{_=JSON.parse(a),Array.isArray(_)||(_=[],o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["restore-bot-profiles: commands are not an array"]))).sendLogs("restore-bot-profiles: commands are not an array"))}catch(e){o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["restore-bot-profiles: commands parsing failed"]))).sendLogs("restore-bot-profiles: commands parsing failed")}o("WAWebBotProfileCollection").BotProfileCollection.gadd(babelHelpers.extends({id:l,commands:_,prompts:p},i))})}),_.apply(this,arguments)}l.restoreBotProfilesFromDb=p}),98);
__d("WAWebRequestBotList",["WALogger","WASmaxBotBotListRPC","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s;function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield o("WASmaxBotBotListRPC").sendBotListRPC({botV:"2"});switch(t.name){case"BotListResponseSuccessV2":{var n=t.value,a=n.botDefaultJid,i=n.botSection,l=[];return i.forEach(function(e){e.bot.forEach(function(e){var t=e.jid,n=e.personaId;l.push({id:o("WAWebWidFactory").createWid(t),isDefault:t===a,personaId:n})})}),l}case"BotListResponseSuccessV3":throw r("err")(t.name+" is not implemented");case"BotListResponseError":{var s=t.value.errorBotListErrors.value,u=s.code,c=s.text;return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[bot] requestBotList failed"]))).devConsole("[bot] requestBotList failed with code "+u+", "+c),[]}}}),c.apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WASmaxBotBotListRPC").sendBotListRPC({botV:"3",botBhash:e});switch(t.name){case"BotListResponseSuccessV3":{var n=t.value,a=n.botDefault,i=n.botSection,l=n.botBhash,u=[];return i.forEach(function(e){e.bot.forEach(function(e){var t=e.jid,n=e.personaId;u.push({id:o("WAWebWidFactory").createWid(t),isDefault:t===(a==null?void 0:a.jid),personaId:n})})}),{botList:u,botBhash:l}}case"BotListResponseSuccessV2":throw r("err")(t.name+" is not implemented");case"BotListResponseError":{var c=t.value.errorBotListErrors.value,d=c.code,m=c.text;return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[bot] requestBotList failed"]))).devConsole("[bot] requestBotList failed with code "+d+", "+m),null}}}),m.apply(this,arguments)}l.requestBotList=u,l.requestUgcBotList=d}),98);
__d("WAWebBotProfileCategory",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum")({SYNTHETIC:"synthetic",LIVING:"living",FICTIONAL:"fictional",HISTORICAL:"historical"});i.BotProfileCategory=e}),66);
__d("WAWebRequestBotProfiles",["Promise","WALogger","WAWebBackendErrors","WAWebBotProfileCategory","WAWebUsync","WAWebUsyncUser","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s;function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(t.length===0)return(s||(s=n("Promise"))).resolve([]);var a=new(o("WAWebUsync")).USyncQuery().withContext("interactive").withMode("query").withBotProfileProtocol();t.forEach(function(e){var t=e.id,n=e.personaId;a.withUser(new(o("WAWebUsyncUser")).USyncUser().withId(t).withPersonaId(n))});var i=yield a.execute(),l=i.error.all||i.error.status;if(l)throw new(o("WAWebBackendErrors")).ServerStatusCodeError(l.errorCode,l.errorText);var u=i.list;if(!u.length){var c=t.map(function(e){return e.id.toString()});return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Bot ids ",""])),c.join(", ")).sendLogs("noStatusDataForBots"),(s||(s=n("Promise"))).reject(r("err")("no status data returned for user"))}return u.map(function(e){var t,n=e.bot,r=e.id;return{id:r,name:n.name,attrs:n.attributes,description:n.description,category:(t=o("WAWebBotProfileCategory").BotProfileCategory.cast(n.category))!=null?t:o("WAWebBotProfileCategory").BotProfileCategory.SYNTHETIC,isDefault:n.isDefault,prompts:n.prompts,personaId:n.personaId,commands:n.commands,commandsDescription:n.commandsDescription,isMetaCreated:n.isMetaCreated,creatorName:n.creatorName,creatorProfileUrl:n.creatorProfileUrl,posingAsProfessional:n.posingAsProfessional,lastUpdateTs:Date.now()}})}),c.apply(this,arguments)}l.requestBotProfiles=u}),98);
__d("WAWebInitializeBots",["WALogger","WATimeUtils","WAWebABProps","WAWebBotGating","WAWebCmd","WAWebPersistBotProfiles","WAWebRequestBotList","WAWebRequestBotProfiles","WAWebRestoreBotProfilesFromDb","WAWebRuntimeEnvironmentUtils","WAWebUserPrefsBot","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m;function p(){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebRuntimeEnvironmentUtils").isWorker()){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[bot] skipping bot initialization in worker"])));return}if(!o("WAWebBotGating").isBotEnabled()){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[bot] not initializing bots due to feature being disabled"])));return}var t=y(),r=o("WATimeUtils").unixTime(),a=o("WAWebABProps").getABPropConfigValue("bonsai_update_interval"),i;t+a<r?(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[bot] requesting bots from server"]))),yield g(),i=a):(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[bot] restoring bots from DB"]))),yield o("WAWebRestoreBotProfilesFromDb").restoreBotProfilesFromDb(),i=t+a-r),self.setTimeout(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield p()}),i*1e3),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[bot] initializing bots complete, next fetch at ",""])),r+i)}),_.apply(this,arguments)}var f=500;function g(){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=[];if(o("WAWebBotGating").isUgcBotEnabled()){var t=yield o("WAWebRequestBotList").requestUgcBotList(o("WAWebUserPrefsBot").getUgcBotListLastBhash());if(t){var n=t.botList.length;if(n>f){o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["getBotProfilesFromServer: exceed max number of UGC bot: ",""])),n).sendLogs("exceed-max-ugc-bots"),C();return}o("WAWebUserPrefsBot").setUgcBotListLastBhash(t.botBhash),e=t.botList}}else e=yield o("WAWebRequestBotList").requestBotList();var r=yield o("WAWebRequestBotProfiles").requestBotProfiles(e);yield o("WAWebPersistBotProfiles").persistBotProfiles(r),C()}),h.apply(this,arguments)}o("WAWebCmd").Cmd.on("on_ab_props_update",function(){p()}),o("WAWebCmd").Cmd.on("ab_props_loaded",function(){p()});function y(){return o("WAWebBotGating").isUgcBotEnabled()?o("WAWebUserPrefsBot").getUgcBotListLastRequestedTimestamp():o("WAWebUserPrefsBot").getBotListLastRequestedTimestamp()}function C(){o("WAWebBotGating").isUgcBotEnabled()?o("WAWebUserPrefsBot").setUgcBotListLastRequestedTimestamp(o("WATimeUtils").unixTime()):o("WAWebUserPrefsBot").setBotListLastRequestedTimestamp(o("WATimeUtils").unixTime())}l.initializeBots=p}),98);
__d("WAWebPersistBotProfiles",["WAWebBotProfileCollection","WAWebSchemaBotProfile","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=["id","prompts","commands"];function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){yield o("WAWebSchemaBotProfile").getBotProfileTable().bulkCreateOrMerge(t.map(function(t){var n=t.id,r=t.prompts,o=t.commands,a=babelHelpers.objectWithoutPropertiesLoose(t,e);return babelHelpers.extends({id:n.toString(),prompts:JSON.stringify(r),commands:JSON.stringify(o)},a)})),t.forEach(function(e){return o("WAWebBotProfileCollection").BotProfileCollection.gadd(babelHelpers.extends({id:e.id},e))})}),u.apply(this,arguments)}l.persistBotProfiles=s}),98);
__d("WAWebCreateBizBotSysMsgAction",["WAWebBotSystemMsg","WAWebBotTypes","WAWebDBProcessMessage","WAWebMsgModelFromData","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e.bizBotSystemMsgType!==o("WAWebBotTypes").BizBotType.BIZ_1P){var t=o("WAWebBotSystemMsg").genBizBot1pDisclosureMessage(e.id);e.msgs.add(o("WAWebMsgModelFromData").msgModelFromMsgData(t)),yield o("WAWebDBProcessMessage").storeMessages([t],e.id),yield e.updateBizBotSysMsgCreated(o("WAWebBotTypes").BizBotType.BIZ_1P)}}),s.apply(this,arguments)}l.maybeCreateBizBot1pDisclosureSysMsg=e}),98);
__d("WAWebHandleBizBotAutomatedTypeAction",["WALogger","WAWebApiBusinessProfile","WAWebBotGating","WAWebBotSystemMsg","WAWebBotTos","WAWebBotTypes","WAWebBotUtils","WAWebChatCollection","WAWebContactSystemMsg","WAWebDBProcessMessage","WAWebMsgModelFromData","WAWebPrivacyModeSystemMsg","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e,t,n){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){var a=o("WAWebChatCollection").ChatCollection.get(t);if(a&&!o("WAWebBotUtils").isMetaAiBot(t)){var i=n;if(!i){var l,s=yield o("WAWebApiBusinessProfile").getBusinessProfileRow(t.toString());i=(l=o("WAWebBotTypes").BizBotAutomatedType.cast(s==null?void 0:s.automatedType))!=null?l:o("WAWebBotTypes").BizBotAutomatedType.UNKNOWN}var u=r!=null?r:o("WAWebBotTypes").BizBotAutomatedType.UNKNOWN;i!==u&&(o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[biz-bot] handle automatedType transition for ",". prev: ",", next: ",""])),a.id.toString(),i,u),i===o("WAWebBotTypes").BizBotAutomatedType.UNKNOWN&&u===o("WAWebBotTypes").BizBotAutomatedType.PARTIAL_1P?yield p(a):i===o("WAWebBotTypes").BizBotAutomatedType.UNKNOWN&&u===o("WAWebBotTypes").BizBotAutomatedType.FULL_3P?yield f(a):i===o("WAWebBotTypes").BizBotAutomatedType.FULL_3P&&u===o("WAWebBotTypes").BizBotAutomatedType.UNKNOWN&&(yield h(a)))}}),m.apply(this,arguments)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!(!o("WAWebBotTos").hasAcceptedBizBotTos()||e.bizBotSystemMsgType===o("WAWebBotTypes").BizBotType.BIZ_1P)){var t=o("WAWebBotSystemMsg").genBizBot1pDisclosureMessage(e.id);if(yield o("WAWebDBProcessMessage").storeMessages([t],t.id.remote),o("WAWebBotGating").isBizBot1pEnabled()){var n=o("WAWebMsgModelFromData").msgModelFromMsgData(t);e.msgs.add(n)}yield e.updateBizBotSysMsgCreated(o("WAWebBotTypes").BizBotType.BIZ_1P),o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[biz-bot] created 1p system message for ",""])),e.id.toString())}}),_.apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!(!o("WAWebBotTos").hasAcceptedBizBotTos()||e.bizBotSystemMsgType===o("WAWebBotTypes").BizBotType.BIZ_3P)){var t=o("WAWebBotSystemMsg").genBizBot3pDisclosureMessage(e.id);yield o("WAWebDBProcessMessage").storeMessages([t],t.id.remote);var n=o("WAWebMsgModelFromData").msgModelFromMsgData(t);e.msgs.add(n),yield e.updateBizBotSysMsgCreated(o("WAWebBotTypes").BizBotType.BIZ_3P),o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[biz-bot] created 3p system message for ",""])),e.id.toString())}}),g.apply(this,arguments)}function h(e){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e.bizBotSystemMsgType!=null){var t=e.id,n,a=o("WAWebPrivacyModeSystemMsg").getReducedPrivacyMode(e.contact.privacyMode);switch(a){case o("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.E2EE:n=o("WAWebContactSystemMsg").genEncryptNotificationMsg(t,"encrypt_now");break;case o("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.BSP:n=o("WAWebContactSystemMsg").genNonE2ENotificationMsg(t,"biz_privacy_mode_to_bsp");break;case o("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.FB:n=o("WAWebContactSystemMsg").genNonE2ENotificationMsg(t,"biz_privacy_mode_to_fb");break;case o("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.HOSTED_GROUP:n=o("WAWebContactSystemMsg").genNonE2ENotificationMsg(t,"is_capi_hosted_group");break}if(!n)throw r("err")("Unhandled privacy mode");yield o("WAWebDBProcessMessage").storeMessages([n],n.id.remote);var i=o("WAWebMsgModelFromData").msgModelFromMsgData(n);e.msgs.add(i),yield e.updateBizBotSysMsgCreated(null),o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[biz-bot] created generic privacy system message for ",""])),e.id.toString())}}),y.apply(this,arguments)}l.handleBizBotAutomatedTypeTransition=d}),98);
__d("WAWebHandleBizBotWelcomeMsgProtocolModeAction",["WALogger","WAWebApiBusinessProfile","WAWebBotGating","WAWebBotTypes","WAWebBotWelcomeRequestSync","WAWebChatCollection","WAWebSyncdCoreApi","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t,n){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){if(o("WAWebBotGating").isBizBot3pAvailable()){var a=o("WAWebChatCollection").ChatCollection.get(t);if(a){var i=n;if(!i){var l,u=yield o("WAWebApiBusinessProfile").getBusinessProfileRowLidAware(t.toString());i=(l=o("WAWebBotTypes").BotWelcomeMsgProtocolModeType.cast(u==null?void 0:u.welcomeMsgProtocolMode))!=null?l:o("WAWebBotTypes").BotWelcomeMsgProtocolModeType.NONE}var c=r!=null?r:o("WAWebBotTypes").BotWelcomeMsgProtocolModeType.NONE;i!==c&&(o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[biz-bot] handle welcomeMsgProtocolMode transition for ",". prev: ",", next: ",""])),a.id.toString(),i,c),c===o("WAWebBotTypes").BotWelcomeMsgProtocolModeType.NONE&&(o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[biz-bot] reset welcome msg request flag to false"]))),yield d(a)))}}}),c.apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e.hasRequestedWelcomeMsg){e.hasRequestedWelcomeMsg=!1;var t=yield r("WAWebBotWelcomeRequestSync").getBotWelcomeRequestSetMutation(e.id,!1);yield o("WAWebSyncdCoreApi").lockForSync(["chat"],[t],(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t[0];return n.merge(e.id.toString(),{hasRequestedWelcomeMsg:!1})});return function(e){return t.apply(this,arguments)}})())}}),m.apply(this,arguments)}l.handleBizBotWelcomeMsgProtocolModeTransition=u}),98);
__d("WAWebBotProfileAction",["WAWebRequestBotProfiles","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=(yield o("WAWebRequestBotProfiles").requestBotProfiles([{id:e,isDefault:!1}]))[0];return t}),s.apply(this,arguments)}l.queryBotProfile=e}),98);
__d("WAWebBotProfileCollection",["WALogger","WAWebBaseCollection","WAWebBotGating","WAWebBotProfileAction","WAWebBotProfileModel","WAWebPersistBotProfiles","WAWebWidFactory","asyncToGeneratorRuntime","cr:10195"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p=(function(t){function r(){return t.apply(this,arguments)||this}babelHelpers.inheritsLoose(r,t);var a=r.prototype;return a.getDefaultBot=function(){return this.findFirst(function(e){return e.isDefault===!0})},a.findImpl=function(t){return this.$BotProfileCollectionImpl$p_1(t)},a.update=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r,a;if(!t.isFbidBot()){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["update only supports FBID bots"]))).devConsole(t);return}var i=(r=(a=this.get(t))==null?void 0:a.lastUpdateTs)!=null?r:0;if(i+o("WAWebBotGating").ugcBotProfileSyncInterval()>Date.now()){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[BotProfileCollection] skip updating bot profile"]))).devConsole({wid:t,lastUpdateTs:i});return}o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[BotProfileCollection] updating bot profile"]))).devConsole({wid:t,lastUpdateTs:i}),yield this.$BotProfileCollectionImpl$p_1(t)});function r(e,n){return t.apply(this,arguments)}return r})(),a.$BotProfileCollectionImpl$p_1=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebWidFactory").createWidFromWidLike(e);if(!t.isFbidBot())return o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["_findAndParse only supports FBID bots"]))).devConsole(t),null;var n=yield o("WAWebBotProfileAction").queryBotProfile(t);return o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[BotProfileCollection] query bot profile"]))).devConsole({wid:t,botProfile:n}),n?(yield o("WAWebPersistBotProfiles").persistBotProfiles([n]),babelHelpers.extends({},n)):(o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Unable to find bot profile with id"]))).devConsole(e),null)});function t(t){return e.apply(this,arguments)}return t})(),r})(o("WAWebBaseCollection").BaseCollection);p.model=r("WAWebBotProfileModel");var _=new p;l.BotProfileCollection=_}),98);
__d("WAWebBotProfileModel",["WAWebBaseModel","WAWebContactCollection","WAWebWid"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.name=o("WAWebBaseModel").prop(),t.attrs=o("WAWebBaseModel").prop(""),t.description=o("WAWebBaseModel").prop(),t.category=o("WAWebBaseModel").prop(),t.isDefault=o("WAWebBaseModel").prop(),t.prompts=o("WAWebBaseModel").prop(function(){return[]}),t.personaId=o("WAWebBaseModel").prop(),t.commands=o("WAWebBaseModel").prop(function(){return[]}),t.commandsDescription=o("WAWebBaseModel").prop(),t.isMetaCreated=o("WAWebBaseModel").prop(),t.creatorName=o("WAWebBaseModel").prop(),t.creatorProfileUrl=o("WAWebBaseModel").prop(),t.posingAsProfessional=o("WAWebBaseModel").prop(),t.lastUpdateTs=o("WAWebBaseModel").prop(),t.contact=o("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){e.prototype.initialize.call(this),this.addChild("contact",o("WAWebContactCollection").ContactCollection.gadd({id:this.id,name:this.name,verifiedName:this.name,shortName:this.name,pushName:this.name,isBusiness:!0,type:"out"}))},t})(o("WAWebBaseModel").BaseModel);e.Proxy="botProfile",e.idClass=r("WAWebWid");var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebChatLockUpdateDailyStats",["WAWebDailyAggregatedStatsCollection"],(function(t,n,r,o,a,i,l){"use strict";function e(e){e===void 0&&(e={});var t=o("WAWebDailyAggregatedStatsCollection").DailyAggregatedStatsCollection.gaddForToday();e.totalFolderChatsCount!=null&&(t.chatLockFolderChatsCount=e.totalFolderChatsCount),e.incFolderOpenCount!=null&&(t.chatLockFolderOpenCount+=e.incFolderOpenCount),e.lockFolderHidden!=null&&(t.chatLockLockFolderHidden=e.lockFolderHidden),e.incNewAddChatCount!=null&&(t.chatLockNewAddChatCount+=e.incNewAddChatCount),e.incNewRemoveChatCount!=null&&(t.chatLockNewRemoveChatCount+=e.incNewRemoveChatCount),e.secretCodeActive!=null&&(t.chatLockSecretCodeActive=e.secretCodeActive)}l.updateChatLockDailyStats=e}),98);
__d("WAWebAddOnModel",["WAWebBaseModel","WAWebModelUtils"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.ack=o("WAWebModelUtils").prop(),t.isSendFailure=o("WAWebModelUtils").session(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);l.AddOnBaseModel=e}),98);
__d("WAWebCommentModel",["WAWebAck","WAWebAddOnModel","WAWebBaseModel","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.parentMsgKey=o("WAWebBaseModel").prop(),t.t=o("WAWebBaseModel").prop(),t.author=o("WAWebBaseModel").prop(),t.read=o("WAWebBaseModel").prop(),t.ack=o("WAWebBaseModel").prop(),t.body=o("WAWebBaseModel").prop(),t.id=o("WAWebBaseModel").prop(),t.isSendFailure=o("WAWebBaseModel").prop(),t.isFailed=o("WAWebBaseModel").derived(function(){var e=o("WAWebUserPrefsMeUser").isMeAccount(this.author)&&this.ack!=null&&this.ack<o("WAWebAck").ACK.CLOCK;return e||!!this.isSendFailure},["ack","isSendFailure"]),t.subtype=o("WAWebBaseModel").prop(),t.protocolMessageKey=o("WAWebBaseModel").prop(),t.revokeTimestamp=o("WAWebBaseModel").prop(),t.isOverwrittenByRevoke=o("WAWebBaseModel").prop(),t.revokeSender=o("WAWebBaseModel").session(),t.startOfDaySkew=o("WAWebBaseModel").session(),t.startOfDay=o("WAWebBaseModel").session(),t.links=o("WAWebBaseModel").session(function(){return[]}),t.linksIndexParsed=o("WAWebBaseModel").session(0),t.phoneNumbers=o("WAWebBaseModel").session(function(){return[]}),t.phoneNumbersIndexParsed=o("WAWebBaseModel").session(0),t.type=o("WAWebBaseModel").prop(),t.messageSecret=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebAddOnModel").AddOnBaseModel);e.Proxy="comment";var s=o("WAWebBaseModel").defineModel(e);l.Comment=s}),98);
__d("WAWebCommentCollection",["WAWebBaseCollection","WAWebCollectionUtils","WAWebCommentModel","WAWebMsgGetters","WAWebMsgType"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.byParent=o("WAWebCollectionUtils").aggregated(function(e){return e.parentMsgKey}),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getByMsgKey=function(t){return this.findFirst(function(e){return e.id.equals(t)})},t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebCommentModel").Comment;function s(e){return new(o("WAWebCommentModel")).Comment({ack:e.ack,body:e.body,id:e.id,parentMsgKey:e.parentMsgKey,author:e.author,t:e.t,type:"comment",read:e.read,messageSecret:e.messageSecret})}function u(e){return new(o("WAWebCommentModel")).Comment({t:e.t,parentMsgKey:e.parentMsgKey,id:e.id,subtype:e.subtype,protocolMessageKey:e.protocolMessageKey,revokeTimestamp:e.revokeTimestamp,isOverwrittenByRevoke:!0,type:o("WAWebMsgType").MSG_TYPE.REVOKED,author:o("WAWebMsgGetters").getSender(e),revokeSender:e.revokeSender})}function c(e){return new(o("WAWebCommentModel")).Comment({t:e.t,parentMsgKey:e.parentMsgKey,id:e.id,type:"ciphertext",author:e.author,ack:e.ack})}var d=new e;l.createCommentModel=s,l.createCommentModelFromRevoke=u,l.createCommentModelFromPlaceholder=c,l.CommentCollection=d}),98);
__d("WAWebCommentNotification",["fbt","WANullthrows","WAWebBaseNotification","WAWebContactCollection","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebGetNotificationStrings","WAWebMsgCollection","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebNotificationMuteReason","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l,s){var e=(function(e){function t(t){var n,r=t.commentMsg;n=e.call(this)||this,n.commentMsg=r;var a=o("WAWebMsgCollection").MsgCollection.get(n.commentMsg.parentMsgKey);return a!=null&&(n.parentMsg=a),n}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a.shouldMute=function(t){return this.parentMsg==null?r("WAWebNotificationMuteReason").ParentMsgMissing:o("WAWebNotificationHelpers").shouldMuteDueToAppState(t)?r("WAWebNotificationMuteReason").AppState:o("WAWebNotificationHelpers").isMutedAndNotMentioned(this.parentMsg)?r("WAWebNotificationMuteReason").MutedChat:o("WAWebNotificationHelpers").isArchivedAndNotMentioned(this.parentMsg)?r("WAWebNotificationMuteReason").ArchivedChat:o("WAWebNotificationHelpers").isOfflineResumeInProgress()?r("WAWebNotificationMuteReason").OfflineResumeInProgress:null},a.shouldPlaySound=function(){if(!e.prototype.shouldPlaySound.call(this))return!1;var t=o("WAWebFrontendMsgGetters").getChat(this.commentMsg);return o("WAWebNotificationHelpers").shouldPlaySoundGranular(t)&&!o("WAWebNotificationHelpers").shouldSquelch(t,!1)},a.shouldShowBanner=function(){if(!e.prototype.shouldShowBanner.call(this))return!1;var t=o("WAWebFrontendMsgGetters").getChat(this.commentMsg);return o("WAWebNotificationHelpers").shouldEnableNotificationGranular(t)},a.getBannerOptions=function(){var e=o("WAWebFrontendMsgGetters").getChat(this.commentMsg);return{wid:e.id,title:o("WAWebNotificationHelpers").getNotificationTitle(e),body:o("WAWebGetNotificationStrings").getNotificationBody(babelHelpers.extends({},u(this.commentMsg)))}},a.buildKey=function(){return"comment:"+this.commentMsg.id.toString()},a.getIcon=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("WAWebFrontendMsgGetters").getChat(this.commentMsg);return o("WAWebNotificationIconUtils").getChatNotificationIcon(e,this.abortController.signal)});function t(){return e.apply(this,arguments)}return t})(),t})(o("WAWebBaseNotification").WABaseNotification);function u(e){var t=o("WAWebContactCollection").ContactCollection.get(r("WANullthrows")(e.author,"comment author cannot be null")),n=t?o("WAWebFrontendContactGetters").getFormattedUser(t):"",a=s._(/*BTDS*/"{name} respondi\u00f3 a tu mensaje de aviso.",[s._param("name",n)]);return{body:a.toString()}}l.WACommentNotification=e}),226);
__d("WAWebConsumerTransparencyInfoIconModel",["WAMd5","WATypeUtils","WAWebApiContact","WAWebLid1X1MigrationGating","WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){var e=function(t){var e,n=((e=r("WAWebUserPrefsStore").getMaybeMeDevicePn())!=null?e:"").toString(),o=t.toString();return r("WAMd5")(n+"-"+o)},s=(function(){function t(){this.chatIds=new Set;var e=r("WAWebUserPrefsStore").getUser(o("WAWebUserPrefsKeys").KEYS.CTWA_CONSUMER_TRANSPARENCY_INFO_ICON);e instanceof Array&&(this.chatIds=new Set(e.filter(o("WATypeUtils").isString)))}var n=t.prototype;return n.add=function(n){this.chatIds.add(e(n)),r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").KEYS.CTWA_CONSUMER_TRANSPARENCY_INFO_ICON,Array.from(this.chatIds))},n.shouldShowIcon=function(n){var t=this,r=[n];if(o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&n.isUser()){var a=o("WAWebApiContact").getAlternateUserWid(n);a!=null&&r.push(a)}return r.some(function(n){return t.chatIds.has(e(n))})},t})(),u=new s;l.ConsumerTransparencyInfoIconModel=u}),98);
__d("WAWebCommonCTWAConsumerTransparency",["WAWebBizGatingUtils","WAWebCommonCTWADataSharing","WAWebConsumerTransparencyInfoIconModel"],(function(t,n,r,o,a,i,l){var e=function(t){if(!t.contact.isBusiness)return!1;var e=o("WAWebConsumerTransparencyInfoIconModel").ConsumerTransparencyInfoIconModel.shouldShowIcon(t.id);return!(!e&&r("WAWebCommonCTWADataSharing").getCTWAEligibilityFromChat(t)==null)},s=function(){return!o("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiIndiaEnabled()&&(o("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiRowEnabled()||o("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiBrazilEnabled())},u=function(t,n,r){if(!(n==null||r==null)&&t.contact.isBusiness){var e=o("WAWebConsumerTransparencyInfoIconModel").ConsumerTransparencyInfoIconModel.shouldShowIcon(t.id);e||o("WAWebConsumerTransparencyInfoIconModel").ConsumerTransparencyInfoIconModel.add(t.id)}};l.shouldShowConsumerTransparencyDisclosure=e,l.shouldShowROWConsumerDisclosure=s,l.handleConsumerTransparencyForNewMsg=u}),98);
__d("WAWebCTWABizDataSharingJob",["WALogger","WASmaxBizSettingsGetPrivacySettingRPC","WASmaxBizSettingsSetPrivacySettingRPC","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u;function c(){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield o("WASmaxBizSettingsGetPrivacySettingRPC").sendGetPrivacySettingRPC();switch(t.name){case"GetPrivacySettingResponseError":{var n=t.value.errorPrivacySettingErrors.value,r=n.code,a=n.text;return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[ctwa][data_sharing] GetPrivacySettingResponseError: fetch data sharing setting failed"]))).devConsole("[ctwa][data_sharing] GetPrivacySettingResponseError: fetch data sharing setting failed "+r+", "+a),null}default:return t.name,t.value.privacySmbDataSharingSettingMixin.value}}),d.apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t={smbDataSharingSettingMixinArgs:{anyValue:e}},n=yield o("WASmaxBizSettingsSetPrivacySettingRPC").sendSetPrivacySettingRPC(t);switch(n.name){case"SetPrivacySettingResponseError":{var r=n.value.errorPrivacySettingErrors.value,a=r.code,i=r.text;return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[ctwa][data_sharing] SetPrivacySettingResponseError: changing data sharing setting failed"]))).devConsole("[ctwa][data_sharing] GetPrivacySettingResponseError: changing data sharing setting failed "+a+", "+i),null}default:{var l,c;return n.name,n.value.privacySmbDataSharingSettingMixin==null&&o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[ctwa][data_sharing] GetPrivacySettingResponseError: changing data sharing setting returned null value"]))).devConsole("[ctwa][data_sharing] GetPrivacySettingResponseError: changing data sharing setting returned null value"),(l=(c=n.value.privacySmbDataSharingSettingMixin)==null?void 0:c.value)!=null?l:null}}}),p.apply(this,arguments)}l.getCtwaBizDataSharingSettingJob=c,l.setCtwaBizDataSharingSettingJob=m}),98);
__d("WAWebCTWADataSharingModel",["WAWebEventEmitter"],(function(t,n,r,o,a,i,l){var e=null,s=new(r("WAWebEventEmitter")),u=function(n){e=n,s.trigger("update",e)},c=function(){return e},d=function(t){s.on("update",t)},m=function(t){s.off("update",t)},p={subscribeForUpdates:d,unsubscribeFromUpdates:m,setValue:u,getValue:c};l.CTWADataSharingModel=p}),98);
__d("WAWebDataSharingOptInCoolOffModel",["WATimeUtils","WAWebBizGatingUtils","WAWebUserPrefsKeys","WAWebUserPrefsStore","gkx"],(function(t,n,r,o,a,i,l){var e=null,s=function(){var t=o("WAWebBizGatingUtils").smbDataSharingOptInCoolOffSeconds();if(e==null){var n=r("WAWebUserPrefsStore").get(o("WAWebUserPrefsKeys").KEYS.CTWA_DATA_SHARING_COOL_OFF);e=o("WATimeUtils").castToUnixTime(typeof n=="number"?n:0)}return o("WATimeUtils").isInFuture(o("WATimeUtils").futureUnixTime(t,e))},u=function(){e=o("WATimeUtils").unixTime(),r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").KEYS.CTWA_DATA_SHARING_COOL_OFF,e)},c=function(){r("gkx")("26258")||(e=null,r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").KEYS.CTWA_DATA_SHARING_COOL_OFF,null))},d={isCoolOffActive:s,startCoolOff:u,resetCoolOffStartTimestamp:c};l.DataSharingOptInCoolOffModel=d}),98);
__d("WAWebDataSharingUpsellModel",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){var e=null,s=function(){if(e==null){var t=r("WAWebUserPrefsStore").get(o("WAWebUserPrefsKeys").KEYS.CTWA_DATA_SHARING_UPSELL_ACTIVE);e=t===!0}return e},u=function(){e!==!0&&(e=!0,r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").KEYS.CTWA_DATA_SHARING_UPSELL_ACTIVE,!0))},c={isUpsellEnabled:s,enableUpsell:u};l.default=c}),98);
__d("WAWebCommonCTWADataSharing",["WALogger","WASmaxInBizSettingsEnums","WAWebBizGatingUtils","WAWebCTWABizDataSharingJob","WAWebCTWADataSharingModel","WAWebChatModel","WAWebConversionTupleCollection","WAWebDataSharingOptInCoolOffModel","WAWebDataSharingUpsellModel","WAWebFrontendMsgGetters","WAWebGetCTWAEligibilityFromConversion","WAWebMsgModel","WAWebUserPrefsGeneral","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u=2,c={CHAT:"CHAT",MESSAGE:"MESSAGE"},d=function(t){var e=r("WAWebConversionTupleCollection").get(t.id);if(!e)return null;var n=e.conversionData,a=e.conversionSource;return o("WAWebGetCTWAEligibilityFromConversion").getCTWAEligibilityFromConversion({conversionData:n,conversionSource:a})},m=function(t){var e=r("WAWebConversionTupleCollection").get(t.id);if(e)return e.ctwaSignals},p=function(){var e=o("WAWebCTWADataSharingModel").CTWADataSharingModel.getValue(),t=o("WAWebUserPrefsGeneral").getCTWADataSharingCoolOffTimestamp(),n=t!=null,r=n&&o("WAWebBizGatingUtils").showDataSharingInSettingsAfterNuxDismiss(),a=o("WAWebUserPrefsGeneral").getCTWAMessageReceived(),i=a&&o("WAWebBizGatingUtils").showDataSharingInSettingsAfterCtwaMessageReceived();return(e===o("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE.true||e===o("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE.false||r||i)&&o("WAWebBizGatingUtils").shouldShowSMBDataSharingSettings()},_=function(t){return d(t)==null||!o("WAWebBizGatingUtils").smbDataSharingConsentEnabled()||o("WAWebDataSharingOptInCoolOffModel").DataSharingOptInCoolOffModel.isCoolOffActive()?!1:f(o("WAWebCTWADataSharingModel").CTWADataSharingModel.getValue())},f=function(t){return!!(t===o("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE.notset||t===o("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE.false&&o("WAWebBizGatingUtils").isCTWA3pdCooldownForOptedOutUsersEnabled()&&o("WAWebBizGatingUtils").isCTWAWeb3pdCooldownForOptedOutUsersEnabled()&&o("WAWebUserPrefsGeneral").getCTWADataSharingDisclosureShownCount()<u)},g=function(n,r){var t;if(r===c.CHAT)t=o("WAWebBizGatingUtils").isSMBLabelsDataSharingEnabledForChats;else if(r===c.MESSAGE)t=o("WAWebBizGatingUtils").isSMBLabelsDataSharingEnabledForMessages;else return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[ctwa][data_sharing] shouldShowLabelDataSharingDialog: target value must be a chat or a message"]))),!1;return d(n)==null||!t()||o("WAWebDataSharingOptInCoolOffModel").DataSharingOptInCoolOffModel.isCoolOffActive()?!1:f(o("WAWebCTWADataSharingModel").CTWADataSharingModel.getValue())},h=function(t,n,a){if(a<1||!o("WAWebBizGatingUtils").smbDataSharingConsentEnabled()||r("WAWebConversionTupleCollection").get(t.id)==null)return!1;var e=o("WAWebCTWADataSharingModel").CTWADataSharingModel.getValue(),i=e===o("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE.true,l=e===o("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE.false&&n==="order-create"&&r("WAWebDataSharingUpsellModel").isUpsellEnabled();return i||l},y=function(t){if(t.length===0)return!1;var e=[],n=t[0];if(n instanceof o("WAWebMsgModel").Msg){if(!o("WAWebBizGatingUtils").isSMBLabelsDataSharingEnabledForMessages())return!1;e.push(o("WAWebFrontendMsgGetters").getChat(n))}else{if(!o("WAWebBizGatingUtils").isSMBLabelsDataSharingEnabledForChats())return!1;t.forEach(function(t){t instanceof o("WAWebChatModel").Chat&&e.push(t)})}var a=e.some(function(e){return d(e)!=null});if(!a)return!1;var i=o("WAWebCTWADataSharingModel").CTWADataSharingModel.getValue(),l=i===o("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE.true,s=i===o("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE.false&&r("WAWebDataSharingUpsellModel").isUpsellEnabled();return l||s},C=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!o("WAWebBizGatingUtils").smbDataSharingConsentEnabled())return null;try{var e=yield o("WAWebCTWABizDataSharingJob").getCtwaBizDataSharingSettingJob();return e&&(o("WAWebCTWADataSharingModel").CTWADataSharingModel.setValue(e),e===o("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE.false&&r("WAWebDataSharingUpsellModel").enableUpsell()),e}catch(e){return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[ctwa][data_sharing] fetchDataSharingSettingAndUpdateModel: fetch data sharing setting failed"]))).devConsole(e),null}});return function(){return e.apply(this,arguments)}})(),b={SMB_DATA_SHARING_ALLOWED_SOURCE:o("WAWebGetCTWAEligibilityFromConversion").SMB_DATA_SHARING_ALLOWED_SOURCE,SmbDataSharingLabelTargetValues:c,getCTWAEligibilityFromChat:d,getCTWASignalsValueFromChat:m,shouldDisplayDataSharingSetting:p,shouldShowOrderDataSharingDialog:_,shouldShowLabelDataSharingDialog:g,shouldDisplayDataSharingOrderOptOutOrUpsell:h,shouldDisplayDataSharingLabelOptOutOrUpsell:y,fetchDataSharingSettingAndUpdateModel:C};l.default=b}),98);
__d("WAWebWamEnumCallInitiatorType",[],(function(t,n,r,o,a,i){var e=Object.freeze({BUSINESS:0,CONSUMER:1});i.CALL_INITIATOR_TYPE=e}),66);
__d("WAWebWamEnumCtwaConversionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({FIRST_MESSAGE:0,DEEP_CONVERSATION:1,FIRST_BIZ_REPLY:2,FIRST_CALL:3,FIRST_LONG_CALL:4,SECOND_MESSAGE:5,SECOND_BIZ_REPLY:6,THIRD_MESSAGE:7,CART_RECEIVED:8,ORDER_CREATED:9,FIRST_MESSAGE_CONTINUATION:10,FIRST_BIZ_REPLY_CONTINUATION:11,SECOND_MESSAGE_CONTINUATION:12,SECOND_BIZ_REPLY_CONTINUATION:13,THIRD_MESSAGE_CONTINUATION:14,FIRST_EXTRA_LONG_CALL:15});i.CTWA_CONVERSION_TYPE=e}),66);
__d("WAWebDeepLinkConversionWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCallInitiatorType","WAWebWamEnumCtwaChatCreationMode","WAWebWamEnumCtwaConversionType","WAWebWamEnumTrustBannerAction"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({DeepLinkConversion:[1432,{callInitiator:[8,o("WAWebWamEnumCallInitiatorType").CALL_INITIATOR_TYPE],ctwaChatCreationMode:[4,o("WAWebWamEnumCtwaChatCreationMode").CTWA_CHAT_CREATION_MODE],ctwaConversionType:[3,o("WAWebWamEnumCtwaConversionType").CTWA_CONVERSION_TYPE],ctwaSignals:[9,e.TYPES.STRING],deepLinkConversionData:[2,e.TYPES.STRING],deepLinkConversionSource:[1,e.TYPES.STRING],isPriority:[7,e.TYPES.BOOLEAN],trustBannerAction:[5,o("WAWebWamEnumTrustBannerAction").TRUST_BANNER_ACTION],trustBannerType:[6,e.TYPES.STRING]},[1,1,1],"regular"]},{DeepLinkConversion:[]});l.DeepLinkConversionWamEvent=s}),98);
__d("WAWebCommonCTWALogging",["WAArrayBufferUtils","WALogger","WATimeUtils","WAWebABProps","WAWebConnModel","WAWebConversionTupleModel","WAWebDeepLinkConversionWamEvent","WAWebFrontendMsgGetters","WAWebGetCTWAEligibilityFromConversion","WAWebMsgType","WAWebUserPrefsGeneral","WAWebUserPrefsMeUser","WAWebWamEnumCtwaConversionType"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_;function f(e){var t=o("WATimeUtils").unixTime()-o("WAWebConversionTupleModel").ConversionTupleExpiry;return e.t<t}function g(e,t){var n=t.indexOf(e);return n>=0?t[n-1]:null}function h(e,t){var n,r,o=g(e,t);return((n=e.from)==null?void 0:n.toString())===(o==null||(r=o.from)==null?void 0:r.toString())}function y(e){for(var t=0,n=e[e.length-1];n&&t<=6;){var r,a;if(f(n))return[null,t];if(n.ctwaContext)return[n,t];var i=g(n,e);if(!i)break;var l=!o("WAWebMsgType").SYSTEM_MESSAGE_TYPES.includes(n.type),s=((r=n.from)==null?void 0:r.toString())!==((a=i.from)==null?void 0:a.toString());l&&s&&t++,n=i}return[n,t]}function C(t,n){var r,a=(r=t.ctwaContext)!=null?r:{},i=a.conversionData,l=a.conversionSource;if(i==null||l==null){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["ctwa:dc-logging: Attempted to log a DC with no CTWA conversion data or source"])));return}var s={ctwaConversionType:o("WAWebWamEnumCtwaConversionType").CTWA_CONVERSION_TYPE[n],deepLinkConversionData:o("WAArrayBufferUtils").arrayBufferToString(i),deepLinkConversionSource:l};new(o("WAWebDeepLinkConversionWamEvent")).DeepLinkConversionWamEvent(s).commitAndWaitForFlush(!0)}function b(e,t){t===1?(o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["ctwa:dc-logging: FIRST_BIZ_REPLY"]))),C(e,"FIRST_BIZ_REPLY")):t===3?(o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["ctwa:dc-logging: SECOND_BIZ_REPLY"]))),C(e,"SECOND_BIZ_REPLY")):t===5&&(o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["ctwa:dc-logging: DEEP_CONVERSATION"]))),C(e,"DEEP_CONVERSATION"))}function v(e,t){t===0?(o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["ctwa:dc-logging: FIRST_MESSAGE"]))),C(e,"FIRST_MESSAGE")):t===2?(o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["ctwa:dc-logging: SECOND_MESSAGE"]))),C(e,"SECOND_MESSAGE")):t===4&&(o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["ctwa:dc-logging: THIRD_MESSAGE"]))),C(e,"THIRD_MESSAGE"))}function S(e){var t,n;if(o("WAWebConnModel").Conn.isSMB&&e.ctwaContext!=null&&!(e.ctwaContext.conversionSource!==o("WAWebGetCTWAEligibilityFromConversion").SMB_DATA_SHARING_ALLOWED_SOURCE||e.ctwaContext.conversionData==null)){var r=(t=o("WAWebUserPrefsMeUser").getMaybeMePnUser())==null?void 0:t.toString();if(r===((n=e.to)==null?void 0:n.toString())&&o("WAWebABProps").getABPropConfigValue("ctwa_show_ads_data_sharing_after_message")){var a=o("WAWebUserPrefsGeneral").getCTWAMessageReceived();a!==!0&&o("WAWebUserPrefsGeneral").setCTWAMessageReceived(!0)}}}function R(e){var t,n,r,a,i;if(o("WAWebABProps").getABPropConfigValue("wa_ctwa_web_dc_logging_enabled")&&!(!e||e.isNewMsg!==!0)&&o("WAWebConnModel").Conn.isSMB){var l=(t=o("WAWebUserPrefsMeUser").getMaybeMePnUser())==null?void 0:t.toString();if(l==null){o("WALogger").WARN(_||(_=babelHelpers.taggedTemplateLiteralLoose(["ctwa:dc-logging: Cannot get current user"]))).sendLogs("ctwa:dc-logging: Cannot get current user");return}var s=(n=(r=o("WAWebFrontendMsgGetters").getChat(e))==null?void 0:r.msgs.toArray())!=null?n:[];if(s.length!==0&&!(e.ctwaContext==null&&h(e,s))){var u=y(s),c=u[0],d=u[1];c&&(d>5||(l===((a=e.from)==null?void 0:a.toString())?b(c,d):l===((i=e.to)==null?void 0:i.toString())&&v(c,d)))}}}l.maybeSetCtwaMessageReceivedInUserPreferenceStore=S,l.logDeepConversation=R}),98);
__d("WAWebAdModel",["WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.ad=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="Ad";var s=o("WAWebBaseModel").defineModel(e);l.AdModel=s}),98);
__d("WAWebFetchAdsQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9191121574326058"}),null);
__d("WAWebFetchAdsQuery.graphql",["WAWebFetchAdsQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={defaultValue:null,kind:"LocalArgument",name:"options"},t={defaultValue:null,kind:"LocalArgument",name:"page_id"},r=[{kind:"Variable",name:"options",variableName:"options"},{kind:"Variable",name:"page_id",variableName:"page_id"}],o={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={kind:"InlineFragment",selections:[o],type:"Node",abstractKey:"__isNode"},i=[{kind:"Literal",name:"supported",value:"304s3R"}],l={alias:null,args:null,kind:"ScalarField",name:"formatted_for_lwi",storageKey:null},s={alias:null,args:[{kind:"Literal",name:"height",value:64},{kind:"Literal",name:"width",value:64}],kind:"ScalarField",name:"thumbnail_image_url",storageKey:"thumbnail_image_url(height:64,width:64)"},u=[{kind:"Literal",name:"metrics",value:["REACH","RESULTS"]}],c={alias:null,args:null,kind:"ScalarField",name:"reach",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"results",storageKey:null},m={alias:null,args:null,concreteType:"AdInsightsNode",kind:"LinkedField",name:"node",plural:!1,selections:[c,d],storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"boosting_status",storageKey:null},_={alias:null,args:null,concreteType:"AdsCreativeSpecification",kind:"LinkedField",name:"creative",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"body",storageKey:null}],storageKey:null},f={alias:null,args:null,concreteType:"AdsLWIAdGroupSpec",kind:"LinkedField",name:"adgroup_spec",plural:!0,selections:[_],storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},h=[o,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"boosting_info",plural:!1,selections:[g,{alias:null,args:null,concreteType:"CurrencyQuantity",kind:"LinkedField",name:"spent",plural:!1,selections:[l],storageKey:null},s],storageKey:null},{alias:null,args:null,concreteType:"AdCampaignGroup",kind:"LinkedField",name:"campaign_group",plural:!1,selections:[o,{alias:null,args:u,concreteType:"AdInsightsConnection",kind:"LinkedField",name:"ad_insights",plural:!1,selections:[{alias:null,args:null,concreteType:"AdInsightsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[m],storageKey:null}],storageKey:'ad_insights(metrics:["REACH","RESULTS"])'}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"spec",plural:!1,selections:[g,p,{alias:null,args:null,concreteType:"AdsLWIAdGroupSpec",kind:"LinkedField",name:"adgroup_spec",plural:!0,selections:[_,o],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,t],kind:"Fragment",metadata:null,name:"WAWebFetchAdsQuery",selections:[{kind:"RequiredField",field:{alias:null,args:null,concreteType:"CTWAAPI",kind:"LinkedField",name:"ctwa",plural:!1,selections:[{kind:"RequiredField",field:{alias:null,args:r,concreteType:"CTWAAPIAllPageAdsConnection",kind:"LinkedField",name:"all_page_ads",plural:!1,selections:[{alias:null,args:null,concreteType:"CTWAAPIAllPageAdsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{kind:"RequiredField",field:{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[a,{kind:"RequiredField",field:{alias:null,args:i,concreteType:null,kind:"LinkedField",name:"wrapper_renderer",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"CTWABoostedComponentWrapper",kind:"LinkedField",name:"boosted_component",plural:!1,selections:[{kind:"RequiredField",field:o,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.id"},{kind:"RequiredField",field:{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"boosting_info",plural:!1,selections:[{kind:"RequiredField",field:{alias:null,args:null,concreteType:"CurrencyQuantity",kind:"LinkedField",name:"spent",plural:!1,selections:[{kind:"RequiredField",field:l,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.boosting_info.spent.formatted_for_lwi"}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.boosting_info.spent"},{kind:"RequiredField",field:s,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.boosting_info.thumbnail_image_url"}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.boosting_info"},{kind:"RequiredField",field:{alias:null,args:null,concreteType:"AdCampaignGroup",kind:"LinkedField",name:"campaign_group",plural:!1,selections:[{kind:"RequiredField",field:o,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.campaign_group.id"},{alias:null,args:u,concreteType:"AdInsightsConnection",kind:"LinkedField",name:"ad_insights",plural:!1,selections:[{alias:null,args:null,concreteType:"AdInsightsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{kind:"RequiredField",field:m,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.campaign_group.ad_insights.edges.node"}],storageKey:null}],storageKey:'ad_insights(metrics:["REACH","RESULTS"])'}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.campaign_group"},{kind:"RequiredField",field:{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"spec",plural:!1,selections:[{kind:"RequiredField",field:p,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.spec.boosting_status"},{kind:"RequiredField",field:f,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.spec.adgroup_spec"}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.spec"}],storageKey:null}],type:"CTWAAdsManagementBoostedComponent",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"BoostedComponentAsyncWrapper",kind:"LinkedField",name:"async_request",plural:!1,selections:[{kind:"RequiredField",field:o,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.id"},{kind:"RequiredField",field:{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"boosting_info",plural:!1,selections:[{kind:"RequiredField",field:{alias:null,args:null,concreteType:"CurrencyQuantity",kind:"LinkedField",name:"spent",plural:!1,selections:[{kind:"RequiredField",field:l,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.boosting_info.spent.formatted_for_lwi"}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.boosting_info.spent"},{kind:"RequiredField",field:s,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.boosting_info.thumbnail_image_url"}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.boosting_info"},{kind:"RequiredField",field:{alias:null,args:null,concreteType:"AdCampaignGroup",kind:"LinkedField",name:"campaign_group",plural:!1,selections:[{kind:"RequiredField",field:o,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.campaign_group.id"},{alias:null,args:u,concreteType:"AdInsightsConnection",kind:"LinkedField",name:"ad_insights",plural:!1,selections:[{alias:null,args:null,concreteType:"AdInsightsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{kind:"RequiredField",field:{alias:null,args:null,concreteType:"AdInsightsNode",kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"RequiredField",field:c,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.campaign_group.ad_insights.edges.node.reach"},d],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.campaign_group.ad_insights.edges.node"}],storageKey:null}],storageKey:'ad_insights(metrics:["REACH","RESULTS"])'}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.campaign_group"},{kind:"RequiredField",field:{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"spec",plural:!1,selections:[{kind:"RequiredField",field:p,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.spec.boosting_status"},{kind:"RequiredField",field:f,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.spec.adgroup_spec"}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.spec"}],storageKey:null}],type:"LWIAdsManagementBoostedComponentAsyncRequest",abstractKey:null}],storageKey:'wrapper_renderer(supported:"304s3R")'},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer"}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node"}],storageKey:null}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads"}],storageKey:null},action:"THROW",path:"ctwa"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,e],kind:"Operation",name:"WAWebFetchAdsQuery",selections:[{alias:null,args:null,concreteType:"CTWAAPI",kind:"LinkedField",name:"ctwa",plural:!1,selections:[{alias:null,args:r,concreteType:"CTWAAPIAllPageAdsConnection",kind:"LinkedField",name:"all_page_ads",plural:!1,selections:[{alias:null,args:null,concreteType:"CTWAAPIAllPageAdsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,a,{alias:null,args:i,concreteType:null,kind:"LinkedField",name:"wrapper_renderer",plural:!1,selections:[g,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"CTWABoostedComponentWrapper",kind:"LinkedField",name:"boosted_component",plural:!1,selections:h,storageKey:null}],type:"CTWAAdsManagementBoostedComponent",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"BoostedComponentAsyncWrapper",kind:"LinkedField",name:"async_request",plural:!1,selections:h,storageKey:null}],type:"LWIAdsManagementBoostedComponentAsyncRequest",abstractKey:null}],storageKey:'wrapper_renderer(supported:"304s3R")'}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:n("WAWebFetchAdsQuery_facebookRelayOperation"),metadata:{},name:"WAWebFetchAdsQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebFetchAds",["Promise","WACustomError","WALogger","WAPromiseTimeout","WAQplTypes","WAWebBizGatingUtils","WAWebCTWAConstants","WAWebCommonAdsTypes","WAWebFetchAdAccountToken","WAWebFetchAdsQuery.graphql","WAWebOrchestratorNonPersistedJob","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebRelayClient"],(function(t,n,r,o,a,i,l){var e,s,u,c,d={type:"error"},m=e!==void 0?e:e=n("WAWebFetchAdsQuery.graphql"),p=90;function _(e){return o("WAWebBizGatingUtils").adManagementEnabled()?o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("fetchAds",function(){return f(e)}).waitUntilCompleted():(c||(c=n("Promise"))).resolve({type:"not-enabled"})}function f(e){return o("WAPromiseTimeout").promiseTimeout(g(e),o("WAWebCTWAConstants").MANAGE_ADS_FETCH_TIMEOUT_MS).catch(function(e){if(e instanceof o("WACustomError").TimeoutError)return o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_ADS,"fetch_ads_end"),o("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_ADS,o("WAQplTypes").QuickLogActionType.ABORTED),o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["fetchAdsWithTimeout: timeout"]))),{type:"timeout"};throw e})}function g(e){return o("WAWebQplQuickPerformanceLoggerModule").QPL.markerStart(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_ADS),o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_ADS,"fetch_ads_start"),o("WAWebFetchAdAccountToken").fetchToken().then(function(t){return t.type==="success"?h({token:t.token,pageId:e}).then(function(e){return o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_ADS,"fetch_ads_end"),e.type!=="success"?(o("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_ADS,o("WAQplTypes").QuickLogActionType.FAIL),e.type==="auth-failure"?o("WAWebFetchAdAccountToken").markTokenAsInvalid():e.type):(e.type,o("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_ADS,o("WAQplTypes").QuickLogActionType.SUCCESS)),e}):(t.type,t)})}function h(e){var t=e.token,n=e.pageId;return o("WAWebRelayClient").fetchQuery(m,{page_id:n,options:{from_n_days_ago:p}},{environmentType:"facebook",accessToken:t}).then(function(e){if(e==null)return d;var t=e.ctwa,n=t.all_page_ads,r=n.edges,o=r.reduce(function(e,t){var n=t.node,r=n.wrapper_renderer,o=r.boosted_component,a=r.async_request;return[o,a].forEach(function(t){if(t!=null){var n=y(t);n!=null&&e.push(n)}}),e},[]);return o.length<r.length?d:{type:"success",ads:o}}).catch(function(e){var t;return o("WAWebFetchAdAccountToken").hasGraphQLAuthError(e)?{type:"auth-failure"}:((e==null||(t=e.message)==null?void 0:t.startsWith("Relay:"))===!0&&o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["fetchAdsWithToken: Relay parser error ",""])),e.message).sendLogs("fetch-ads-relay-parser-error"),d)})}function y(e){var t,n,r,a=e.id,i=e.boosting_info,l=e.spec,s=e.campaign_group,u=i.thumbnail_image_url,c=i.spent,d=l.adgroup_spec,m=l.boosting_status,p=c.formatted_for_lwi,_=s.id,f=C(s),g=(t=f==null?void 0:f.reach)!=null?t:0,h=(n=f==null?void 0:f.conversations)!=null?n:0,y={adId:o("WAWebCommonAdsTypes").asAdId(a),thumbnailUrl:u,boostingStatus:(r=o("WAWebCommonAdsTypes").BoostingStatusEnum.cast(m))!=null?r:o("WAWebCommonAdsTypes").BoostingStatusEnum.UNKNOWN,budget:p,campaignGroupId:o("WAWebCommonAdsTypes").asAdCampaignGroupId(_),conversations:h,reach:g},b=d[0];if(b!=null){var v=b.creative;if(v!=null){var S=v.body;S!=null&&(y.creativeText=S)}}return y}function C(e){var t=e.ad_insights;if(t!=null){var n=t.edges,r=n.reduce(function(e,t){var n=t.node,r=n.reach,o=n.results;return e.push({reach:r!=null?r:0,conversations:o!=null?o:0}),e},[]);if(r.length!==0)return r[0]}}l.fetchAds=_}),98);
__d("WAWebAdCollection",["WAWebAdModel","WAWebBaseCollection","WAWebFetchAds","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.loadingInfo=null,babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var r=t.prototype;return r.loadAds=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this;if(this.loadingInfo!=null&&this.loadingInfo.pageId===e)return this.loadingInfo.promise;this.reset();var n=o("WAWebFetchAds").fetchAds(e).then(function(n){var r;n.type==="success"?(t.set(n.ads.map(function(e){return{id:e.adId,ad:e}})),r={result:"success",pageId:e}):n.type==="recovery-required"?r={result:"recovery-required",pageId:e,emailMask:n.emailMask}:(n.type,r={result:n.type,pageId:e}),t.trigger("ads-loaded",r)}).finally(function(){t.loadingInfo=null});return this.loadingInfo={promise:n,pageId:e},n});function t(t){return e.apply(this,arguments)}return t})(),t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebAdModel").AdModel;var s=new e;l.AdCollection=s}),98);
__d("WAWebDataSharing3pdLidCollection",["PerCustomerDataSharingModel","WAWebBaseCollection"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initializeFromCache=function(t){var e=t.map(function(e){return new(o("PerCustomerDataSharingModel")).PerCustomerDataSharingModel(babelHelpers.extends({id:e.lidRawString},e))});this.add(e)},n.isDataSharingEnabled=function(t){var e=this.get(t);return e?e.dataSharing3pdEnabled:!0},t})(o("WAWebBaseCollection").BaseCollection);e.model=o("PerCustomerDataSharingModel").PerCustomerDataSharingModel;var s=new e;l.DataSharing3pdLidCollection=s}),98);
__d("WAWebBackoff",["err"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e,t){var n;this.backoffIntervals=[].concat(e),this.cache=new Map,this.resetInterval=(n=t==null?void 0:t.resetInterval)!=null?n:null}var t=e.prototype;return t.add=function(t){if(this.get(t))throw r("err")("This entry already exists in the backoff cache");this.cache.set(t,{lastAttempt:Date.now(),intervals:[].concat(this.backoffIntervals),attempts:1})},t.remove=function(t){this.cache.delete(t)},t.get=function(t){return this.cache.get(t)},t.reset=function(t){this.remove(t),this.add(t)},t.shouldBackoff=function(t){var e=this.get(t);if(this.resetInterval!=null&&e!=null){var n=this.resetInterval,r=Date.now()-e.lastAttempt;if(r>=n)return this.remove(t),!1}if(e!=null){var o=e.intervals[0];if(o!=null){var a=Date.now()-e.lastAttempt;if(a<o)return!0}}return!1},t.markAttemptAndShiftInterval=function(t){var e=this.get(t);e!=null&&(e.lastAttempt=Date.now(),e.intervals.shift(),e.attempts++)},t.test=function(t){return this.shouldBackoff(t)?!0:(this.get(t)!=null?this.markAttemptAndShiftInterval(t):this.add(t),!1)},t.getCurrentInterval=function(t){var e=this.get(t);if(e!=null)return e.intervals[0]},e})();l.BackoffCache=e}),98);
__d("WAWebEphemeralGenerateSystemMessage",["WAWebContactSystemMsg","WAWebHandleSingleMsg","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t,n){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=o("WAWebContactSystemMsg").genDisappearingModeUpdateSystemMsg(e.id,t,n);yield o("WAWebHandleSingleMsg").handleSingleMsg({chatId:r.from,newMsg:r,handleSingleMsgOrigin:"ephemeralSystemMsg",preserveOrder:!1})}),s.apply(this,arguments)}function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebContactSystemMsg").genDisappearingModeUnsupportedSystemMsg(e.id);yield o("WAWebHandleSingleMsg").handleSingleMsg({chatId:t.from,newMsg:t,handleSingleMsgOrigin:"ephemeralUnsupportedSystemMsg",preserveOrder:!1})}),c.apply(this,arguments)}l.generateEphemeralNotificationTemplateSystemMessage=e,l.generateEphemeralUnsupportedNotificationTemplateSystemMessage=u}),98);
__d("WAWebEphemeralIsDurationAllowed",["WAWebMessagingGatingUtils"],(function(t,n,r,o,a,i,l){var e=[86400,604800,7776e3],s=[3600,43200];function u(t){return t<0?!1:!!(t===0||e.includes(t)||s.includes(t)&&o("WAWebMessagingGatingUtils").isDisappearingMessageTimerShorterOptionsEnabled())}l.isEphemeralDurationAllowed=u}),98);
__d("WAWebEphemeralOutOfSyncInfoWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumClientGroupSizeBucket"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({EphemeralOutOfSyncInfo:[3892,{groupSizeBucket:[1,o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET],incomingMessageEphemeralityDuration:[2,e.TYPES.INTEGER],isAGroup:[3,e.TYPES.BOOLEAN],isNewThreadForUser:[5,e.TYPES.BOOLEAN],otherDefaultModeDuration:[6,e.TYPES.INTEGER],threadEphemeralityDuration:[7,e.TYPES.INTEGER],threadId:[8,e.TYPES.STRING],userDefaultModeDuration:[9,e.TYPES.INTEGER]},[1,1,1],"regular"]},{EphemeralOutOfSyncInfo:[]});l.EphemeralOutOfSyncInfoWamEvent=s}),98);
__d("WAWebWamEnumEsrFailureReasonType",[],(function(t,n,r,o,a,i){var e=Object.freeze({ESR_ABPROP_OFF:1,DM_RELIABILITY_ABPROP_OFF:2,INVALID_MESSAGE_TYPE:3,OLDER_EPHEMERAL_SETTING_TIMESTAMP:4,NO_EPHEMERAL_INFO:5,ATTEMPTS_EXHAUSTED:6,NO_USER_INFO:7,NO_CHAT_SESSION:8,INVALID_EPHEMERAL_DURATION:9});i.ESR_FAILURE_REASON_TYPE=e}),66);
__d("WAWebWamEnumEsrSendResultType",[],(function(t,n,r,o,a,i){var e=Object.freeze({SUCCESS:1,ERROR:2});i.ESR_SEND_RESULT_TYPE=e}),66);
__d("WAWebEphemeralSyncResponseReceiveWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumDisappearingChatInitiatorType","WAWebWamEnumEphemeralityInitiatorType","WAWebWamEnumEphemeralityTriggerActionType","WAWebWamEnumEsrFailureReasonType","WAWebWamEnumEsrSendResultType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({EphemeralSyncResponseReceive:[4780,{clientDisappearingModeInitiator:[1,o("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE],clientEphemeralityDuration:[2,e.TYPES.INTEGER],clientEphemeralityInitiator:[3,o("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE],clientEphemeralitySettingTimestamp:[4,e.TYPES.INTEGER],clientEphemeralityTriggerAction:[5,o("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE],esrDisappearingModeInitiator:[6,o("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE],esrEphemeralityDuration:[7,e.TYPES.INTEGER],esrEphemeralityInitiator:[8,o("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE],esrEphemeralitySettingTimestamp:[9,e.TYPES.INTEGER],esrEphemeralityTriggerAction:[10,o("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE],esrFailureReason:[11,o("WAWebWamEnumEsrFailureReasonType").ESR_FAILURE_REASON_TYPE],esrResolveResult:[12,o("WAWebWamEnumEsrSendResultType").ESR_SEND_RESULT_TYPE],isAGroup:[13,e.TYPES.BOOLEAN],threadId:[14,e.TYPES.STRING]},[1,1,1],"regular"]},{EphemeralSyncResponseReceive:[]});l.EphemeralSyncResponseReceiveWamEvent=s}),98);
__d("WAWebEphemeralSyncResponseSendWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumDisappearingChatInitiatorType","WAWebWamEnumEphemeralityInitiatorType","WAWebWamEnumEphemeralityTriggerActionType","WAWebWamEnumEsrFailureReasonType","WAWebWamEnumEsrSendResultType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({EphemeralSyncResponseSend:[4778,{clientDisappearingModeInitiator:[1,o("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE],clientEphemeralityDuration:[2,e.TYPES.INTEGER],clientEphemeralityInitiator:[3,o("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE],clientEphemeralitySettingTimestamp:[4,e.TYPES.INTEGER],clientEphemeralityTriggerAction:[5,o("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE],esrDisappearingModeInitiator:[6,o("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE],esrEphemeralityDuration:[7,e.TYPES.INTEGER],esrEphemeralityInitiator:[8,o("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE],esrEphemeralitySettingTimestamp:[9,e.TYPES.INTEGER],esrEphemeralityTriggerAction:[10,o("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE],esrFailureReason:[11,o("WAWebWamEnumEsrFailureReasonType").ESR_FAILURE_REASON_TYPE],esrSendAttempt:[12,e.TYPES.INTEGER],esrSendResult:[13,o("WAWebWamEnumEsrSendResultType").ESR_SEND_RESULT_TYPE],isAGroup:[14,e.TYPES.BOOLEAN],messageDisappearingModeInitiator:[15,o("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE],messageEphemeralityDuration:[16,e.TYPES.INTEGER],messageEphemeralityInitiator:[17,o("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE],messageEphemeralitySettingTimestamp:[18,e.TYPES.INTEGER],messageEphemeralityTriggerAction:[19,o("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE],threadId:[20,e.TYPES.STRING]},[1,1,1],"regular"]},{EphemeralSyncResponseSend:[]});l.EphemeralSyncResponseSendWamEvent=s}),98);
__d("WAWebEphemeralSyncResponseWAM",["WAWebABProps","WAWebChatThreadLogging","WAWebEphemeralSyncResponseReceiveWamEvent","WAWebEphemeralSyncResponseSendWamEvent","WAWebEphemeralityWAMUtils","WAWebWamEnumEsrSendResultType","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebABProps").getABPropConfigValue("dm_reliability_logging")}function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.to,r=t.changes,a=t.incomingMsgSettings,i=t.localChatSettings,l=t.attempts;if(e()){var s=new(o("WAWebEphemeralSyncResponseSendWamEvent")).EphemeralSyncResponseSendWamEvent({threadId:yield o("WAWebChatThreadLogging").getChatThreadID(n.toJid()),esrSendResult:o("WAWebWamEnumEsrSendResultType").ESR_SEND_RESULT_TYPE.SUCCESS,isAGroup:!1,esrDisappearingModeInitiator:o("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiator(r.initiator),esrEphemeralityDuration:r.duration,esrEphemeralityInitiator:o("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiatedByMe(r.initiatedByMe),esrEphemeralitySettingTimestamp:r.settingTimestamp,esrEphemeralityTriggerAction:o("WAWebEphemeralityWAMUtils").getWamDisappearingModeTrigger(r.disappearingModeTrigger)});i!=null&&(i.initiator!=null&&s.set({clientDisappearingModeInitiator:o("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiator(i.initiator)}),i.disappearingModeTrigger!=null&&s.set({clientEphemeralityTriggerAction:o("WAWebEphemeralityWAMUtils").getWamDisappearingModeTrigger(i.disappearingModeTrigger)}),s.set({clientEphemeralityDuration:i.duration,clientEphemeralityInitiator:o("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiatedByMe(i.initiatedByMe),clientEphemeralitySettingTimestamp:i.settingTimestamp})),a!=null&&(a.initiator!=null&&s.set({messageDisappearingModeInitiator:o("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiator(a.initiator)}),a.disappearingModeTrigger!=null&&s.set({messageEphemeralityTriggerAction:o("WAWebEphemeralityWAMUtils").getWamDisappearingModeTrigger(a.disappearingModeTrigger)}),s.set({messageEphemeralityDuration:a.duration,messageEphemeralityInitiator:o("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiatedByMe(a.initiatedByMe),messageEphemeralitySettingTimestamp:a.settingTimestamp})),l!=null&&s.set({esrSendAttempt:l}),s.commit()}}),u.apply(this,arguments)}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.to,r=t.error,a=t.attempts;if(e()){var i=new(o("WAWebEphemeralSyncResponseSendWamEvent")).EphemeralSyncResponseSendWamEvent({threadId:yield o("WAWebChatThreadLogging").getChatThreadID(n.toJid()),esrFailureReason:r,esrSendResult:o("WAWebWamEnumEsrSendResultType").ESR_SEND_RESULT_TYPE.ERROR});a!=null&&i.set({esrSendAttempt:a}),i.commit()}}),d.apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.chat,r=t.incomingESRSettings,a=t.localChatSettings,i=t.failureReason;if(e()){var l=new(o("WAWebEphemeralSyncResponseReceiveWamEvent")).EphemeralSyncResponseReceiveWamEvent({threadId:yield o("WAWebChatThreadLogging").getChatThreadID(n.id.toJid()),isAGroup:!1});r!=null&&(r.initiator!=null&&l.set({esrDisappearingModeInitiator:o("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiator(r.initiator)}),r.disappearingModeTrigger!=null&&l.set({esrEphemeralityTriggerAction:o("WAWebEphemeralityWAMUtils").getWamDisappearingModeTrigger(r.disappearingModeTrigger)}),l.set({esrEphemeralityDuration:r.duration,esrEphemeralityInitiator:o("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiatedByMe(r.initiatedByMe),esrEphemeralitySettingTimestamp:r.settingTimestamp})),a!=null&&(a.initiator!=null&&l.set({clientDisappearingModeInitiator:o("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiator(a.initiator)}),a.disappearingModeTrigger!=null&&l.set({clientEphemeralityTriggerAction:o("WAWebEphemeralityWAMUtils").getWamDisappearingModeTrigger(a.disappearingModeTrigger)}),l.set({clientEphemeralityDuration:a.duration,clientEphemeralityInitiator:o("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiatedByMe(a.initiatedByMe),clientEphemeralitySettingTimestamp:a.settingTimestamp})),i!=null?l.set({esrResolveResult:o("WAWebWamEnumEsrSendResultType").ESR_SEND_RESULT_TYPE.ERROR,esrFailureReason:i}):l.set({esrResolveResult:o("WAWebWamEnumEsrSendResultType").ESR_SEND_RESULT_TYPE.SUCCESS}),l.commit()}}),p.apply(this,arguments)}l.sendEphemeralSyncResponseSendWamEvent=s,l.sendEphemeralSyncResponseSendErrorWamEvent=c,l.sendEphemeralSyncResponseReceiveWamEvent=m}),98);
__d("WAWebUpdateEphemeralSettingChatAction",["WALogger","WAWebDBChatEphemeralExemptionData","WAWebDBUpdateChatTable","WAWebEphemeralGenerateSystemMessage","WAWebEphemeralityTypes","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] updateChatEphemeralSettings"]))).devConsole(babelHelpers.extends({chat:t.id},n)),yield o("WAWebDBUpdateChatTable").updateChatTable(t.id,babelHelpers.extends({},n,{disappearingModeInitiator:n.disappearingModeInitiator,disappearingModeTrigger:n.disappearingModeTrigger!=null?n.disappearingModeTrigger:null})),t.set(n),o("WAWebDBChatEphemeralExemptionData").updateEphemeralDurationCache(t.id,t.ephemeralDuration)}),u.apply(this,arguments)}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield s(e,{ephemeralDuration:0,ephemeralSettingTimestamp:Date.now(),disappearingModeInitiator:o("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat}),yield o("WAWebEphemeralGenerateSystemMessage").generateEphemeralUnsupportedNotificationTemplateSystemMessage(e)}),d.apply(this,arguments)}l.updateChatEphemeralSettings=s,l.setChatAsEphemeralityUnsupported=c}),98);
__d("WAWebEphemeralSyncResponse",["WAJobOrchestratorTypes","WALogger","WATimeUtils","WAWebABProps","WAWebBackoff","WAWebChatCollection","WAWebChatEphemerality","WAWebChatGetters","WAWebChatThreadLogging","WAWebCommonMsgUtils","WAWebContactCollection","WAWebDBChatEphemeralExemptionData","WAWebDBUpdateChatTable","WAWebDBUpdateMessageTable","WAWebEphemeralGenerateSystemMessage","WAWebEphemeralIsDurationAllowed","WAWebEphemeralOutOfSyncInfoWamEvent","WAWebEphemeralSyncResponseWAM","WAWebEphemeralityResolver","WAWebMsgCollection","WAWebMsgEphemerality","WAWebMsgKey","WAWebMsgModel","WAWebMsgType","WAWebOrchestratorNonPersistedJob","WAWebSendMsgRecordAction","WAWebUpdateEphemeralSettingChatAction","WAWebUserPrefsMeUser","WAWebWamEnumEsrFailureReasonType","asyncToGeneratorRuntime","err","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L;function E(){return o("WAWebABProps").getABPropConfigValue("ephemeral_sync_response")}function k(){o("WAWebABProps").getABPropConfigValue("ephemeral_sync_response"),o("WAWebABProps").getABPropConfigValue("dm_reliability_logging")}function I(e){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] setting ephemeralOutOfSync on msg"]))).devConsole({msg:t});var n={ephemeralOutOfSync:!0};E()&&(yield o("WAWebDBUpdateMessageTable").updateMessageTable(t.id,n)),t.ephemeralOutOfSync=!0;var r=o("WAWebMsgCollection").MsgCollection.get(t.id);r&&r.set(n)}),T.apply(this,arguments)}function D(e){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebChatCollection").ChatCollection.get(e.id.remote);if(!t)throw r("err")("[DMResolve] chat model not found for ESR message");if(o("WAWebChatGetters").getIsGroup(t)){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] EPHEMERAL_SYNC_RESPONSE should not be processed for group chats ",""])),t.id.toLogString()).sendLogs("handle-ephemeral-sync-response");return}if(k(),!E()){o("WAWebEphemeralSyncResponseWAM").sendEphemeralSyncResponseReceiveWamEvent({chat:t,failureReason:o("WAWebWamEnumEsrFailureReasonType").ESR_FAILURE_REASON_TYPE.ESR_ABPROP_OFF});return}if(t.contact.isEnterprise){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] cannot process EPHEMERAL_SYNC_RESPONSE for enterprise contact ",""])),t.id.toLogString());return}o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] processing EPHEMERAL_SYNC_RESPONSE"]))).devConsole({chat:t,msg:e});var n={id:e.id,type:e.type,kind:e.kind,ephemeralDuration:e.ephemeralDuration,ephemeralSettingTimestamp:e.ephemeralSettingTimestamp,disappearingModeInitiator:e.disappearingModeInitiator,disappearingModeTrigger:e.disappearingModeTrigger,disappearingModeInitiatedByMe:e.disappearingModeInitiatedByMe},a=o("WAWebMsgEphemerality").getMsgEphemeralitySettings(n);if(a!=null){if(!o("WAWebEphemeralIsDurationAllowed").isEphemeralDurationAllowed(a.duration)){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] processEphemeralSyncResponse called with invalid setting "," seconds for chat ",""])),a.duration,t.id.toLogString()),o("WAWebEphemeralSyncResponseWAM").sendEphemeralSyncResponseReceiveWamEvent({chat:t,failureReason:o("WAWebWamEnumEsrFailureReasonType").ESR_FAILURE_REASON_TYPE.INVALID_EPHEMERAL_DURATION});return}var i=o("WAWebChatEphemerality").getChatEphemeralityFields(t);if(o("WAWebEphemeralityResolver").compareEphemeralityFields(i,a)){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] Received ESR, but chat and msg settings are already the same"]))).devConsole({originalChatEphemeralSetting:i,msgEphemeralSetting:a});return}o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] Updating chat due to EPHEMERAL_SYNC_RESPONSE"]))).devConsole({originalChatEphemeralSetting:i,msgEphemeralSetting:a}),t.ephemeralDuration=a.duration,t.ephemeralSettingTimestamp=o("WAWebEphemeralityResolver").resolveSettingTimestamp(a.settingTimestamp);var l=o("WAWebEphemeralityResolver").resolveDisappearingModeTrigger(a.disappearingModeTrigger),_=o("WAWebEphemeralityResolver").resolveDisappearingModeInitiator(a.initiator);t.disappearingModeInitiator=_,t.disappearingModeTrigger=l,t.disappearingModeInitiatedByMe=o("WAWebEphemeralityResolver").resolveDisappearingModeInitiatedByMe(a.initiatedByMe,a.initiator),yield o("WAWebDBUpdateChatTable").updateChatTable(t.id,{ephemeralDuration:t.ephemeralDuration,ephemeralSettingTimestamp:t.ephemeralSettingTimestamp,disappearingModeInitiator:_,disappearingModeTrigger:l,disappearingModeInitiatedByMe:t.disappearingModeInitiatedByMe}),o("WAWebDBChatEphemeralExemptionData").updateEphemeralDurationCache(t.id,t.ephemeralDuration);var f=o("WAWebEphemeralityResolver").resolveEphermalityDuration(i==null?void 0:i.duration)!==o("WAWebEphemeralityResolver").resolveEphermalityDuration(a==null?void 0:a.duration);f&&(yield o("WAWebEphemeralGenerateSystemMessage").generateEphemeralNotificationTemplateSystemMessage(t,a.duration,null)),o("WAWebEphemeralSyncResponseWAM").sendEphemeralSyncResponseReceiveWamEvent({chat:t,incomingESRSettings:a,localChatSettings:i})}}),x.apply(this,arguments)}var $=new(o("WAWebBackoff")).BackoffCache([1e3*60*3,1e3*60*15,1/0],{resetInterval:o("WATimeUtils").DAY_SECONDS});function P(e,t,n,r){return N.apply(this,arguments)}function N(){return N=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a){var i;if(k(),!E()||!e.isUser()||e.isPSA()||e.isBot()){o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] skip sending ESR: disabled or unsupported chat"])));return}if(r("gkx")("26256")){var l;window.esrCount=((l=window.esrCount)!=null?l:0)+1}var s=e.toString();if($.test(s)){var u;o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] Not sending ESR to "," due to back off limit"])),e).devConsole({currentBackoff:$.get(e.toString())});var c=(u=$.get(s))==null?void 0:u.attempts;c!=null&&o("WAWebEphemeralSyncResponseWAM").sendEphemeralSyncResponseSendErrorWamEvent({to:e,error:o("WAWebWamEnumEsrFailureReasonType").ESR_FAILURE_REASON_TYPE.ATTEMPTS_EXHAUSTED,attempts:c});return}var d=t.duration,m=t.settingTimestamp,p=t.initiator,h=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),y=new(r("WAWebMsgKey"))({fromMe:!0,remote:e,id:yield r("WAWebMsgKey").newId(),participant:void 0}),C={id:y,from:h,to:e,t:o("WATimeUtils").unixTime(),type:o("WAWebMsgType").MSG_TYPE.PROTOCOL,subtype:"ephemeral_sync_response",ephemeralDuration:d,ephemeralSettingTimestamp:m,disappearingModeInitiator:p},b=new(o("WAWebMsgModel")).Msg(C);return o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] Sending out EPHEMERAL_SYNC_RESPONSE"]))).devConsole({messageData:C}),o("WAWebEphemeralSyncResponseWAM").sendEphemeralSyncResponseSendWamEvent({to:e,changes:t,incomingMsgSettings:n,localChatSettings:a,attempts:(i=$.get(s))==null?void 0:i.attempts}),o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendMessage",function(){return o("WAWebSendMsgRecordAction").sendMsgRecord(b)},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}),N.apply(this,arguments)}function M(e,t){return!!(o("WAWebChatGetters").getIsUser(t)&&!t.contact.isEnterprise&&!e.id.fromMe&&o("WAWebMsgEphemerality").messageSupportsEphemerality(e.type))}function w(e,t){return A.apply(this,arguments)}function A(){return A=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n;if(o("WAWebABProps").getABPropConfigValue("out_of_sync_disappearing_messages_logging")){o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["logEphemeralOutOfSync"])));var r=(n=o("WAWebChatEphemerality").getEphemeralSetting(t))!=null?n:0,a=o("WAWebEphemeralityResolver").getEphemeralDurationForUser(o("WAWebContactCollection").ContactCollection.getMeContact()),i=o("WAWebEphemeralityResolver").getEphemeralDurationForUser(t.contact);new(o("WAWebEphemeralOutOfSyncInfoWamEvent")).EphemeralOutOfSyncInfoWamEvent({incomingMessageEphemeralityDuration:e!=null?e:0,isAGroup:o("WAWebChatGetters").getIsGroup(t),threadEphemeralityDuration:r,otherDefaultModeDuration:i!=null?i:0,userDefaultModeDuration:a!=null?a:0,threadId:yield o("WAWebChatThreadLogging").getChatThreadID(t.id.toJid()),isNewThreadForUser:t.msgs.length===0}).commit()}}),A.apply(this,arguments)}function F(e,t){return O.apply(this,arguments)}function O(){return O=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=e.type===o("WAWebMsgType").MSG_TYPE.PROTOCOL&&e.subtype==="ephemeral_setting";if(!M(e,t)&&!n){o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] dropping msg from ephemeral sync"]))).devConsole({msg:e,chat:t});return}var r=o("WAWebMsgEphemerality").getMsgEphemeralitySettings(e),a=o("WAWebChatEphemerality").getChatEphemeralityFields(t);o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] resolving ephemerality using existing chat DM settings:"]))).devConsole({incomingMsgSettings:r,localChatSettings:a,msg:e});var i=o("WAWebEphemeralityResolver").resolveExistingChatDMSettings(r,a),l=o("WAWebEphemeralityResolver").compareEphemeralityFields(a,i),s=o("WAWebEphemeralityResolver").compareEphemeralityFields(r,i);if(i==null||l&&s)o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] neither party is out-of-sync"]))).devConsole(i),$.remove(t.id.toString());else{if(o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] ESR resolution details: ",""])),JSON.stringify({msgId:e.id.toString(),resolution:i,incomingMsgSettings:r,localChatSettings:a})),!l){var u;o("WALogger").LOG(S||(S=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] local is out-of-sync, updating local chat DM settings"]))),yield o("WAWebUpdateEphemeralSettingChatAction").updateChatEphemeralSettings(t,{ephemeralSettingTimestamp:i.settingTimestamp,ephemeralDuration:i.duration,disappearingModeInitiator:i.initiator,disappearingModeTrigger:i.disappearingModeTrigger,disappearingModeInitiatedByMe:i.initiatedByMe}),!n&&i.duration!==((u=a==null?void 0:a.duration)!=null?u:0)&&(o("WALogger").LOG(R||(R=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] rendering DM system message as duration has changed"]))),yield o("WAWebEphemeralGenerateSystemMessage").generateEphemeralNotificationTemplateSystemMessage(t,i.duration,null))}if(!s&&(o("WALogger").LOG(L||(L=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] other party is out-of-sync, sending EPHEMERAL_SYNC_RESPONSE"]))),!o("WAWebCommonMsgUtils").isNotificationType(e.type,e.subtype))){var c,d=(c=r==null?void 0:r.duration)!=null?c:0;i.duration!==d&&(I(e),w(r==null?void 0:r.duration,t)),P(e.from,i,r,a)}}}),O.apply(this,arguments)}var B=P;l.processEphemeralSyncResponse=D,l.syncEphemeralSetting=F,l._sendEphemeralSyncResponse=B}),98);
__d("WAWebEphemeralFbtKic",["fbt","$InternalEnum","WALogger","WAWebContactCollection","WAWebContactGetters","WAWebFrontendContactGetters","WAWebMiscGatingUtils"],(function(t,n,r,o,a,i,l,s){var e,u,c,d,m,p,_,f,g,h,y,C,b=n("$InternalEnum").Mirrored(["SettingChangeByOthers","SettingChangeByYou","SettingChangeByUnknown","SettingChangeByOthersAsAdmin","SettingChangeByYouAsAdmin","SettingChangeByUnknownAsAdmin","Duration","OutOfSyncInfo","Explanation","ModeChangeByOthers","ModeChangeByYou"]);function v(e,t){return e===void 0&&(e=0),M(b.SettingChangeByOthers,e,t)}function S(e,t){return e===void 0&&(e=0),W(b.SettingChangeByOthers,e,t)}function R(e){return e===void 0&&(e=0),M(b.SettingChangeByYou,e)}function L(e){return e===void 0&&(e=0),M(b.SettingChangeByUnknown,e)}function E(e,t){return e===void 0&&(e=0),M(b.SettingChangeByOthersAsAdmin,e,t)}function k(e,t){return e===void 0&&(e=0),W(b.SettingChangeByOthersAsAdmin,e,t)}function I(e){return e===void 0&&(e=0),M(b.SettingChangeByYouAsAdmin,e)}function T(e){return e===void 0&&(e=0),M(b.SettingChangeByUnknownAsAdmin,e)}function D(e){return e===void 0&&(e=0),M(b.Duration,e)}function x(e){return e===void 0&&(e=0),M(b.OutOfSyncInfo,e)}function $(e){return e===void 0&&(e=0),M(b.Explanation,e)}function P(e,t){return e===void 0&&(e=0),M(b.ModeChangeByOthers,e,t)}function N(e){return e===void 0&&(e=0),M(b.ModeChangeByYou,e)}function M(t,n,r){if(n===void 0&&(n=0),n<0)return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralString "," is given invalid duration ",""])),t,n).sendLogs("invalid-duration"),"";if(n===0)return w(t,r);if(n<=60)return A(t,n,r);if(n<3600){var a=Math.floor(n/60);return F(t,a,r)}else if(n<=1440*60){var i=Math.floor(n/60/60);return O(t,i,r)}var l=Math.floor(n/24/60/60);return B(t,l,r)}function w(e,t){return e===b.SettingChangeByOthers&&t!=null?s._(/*BTDS*/"{person-name} desactiv\u00f3 los mensajes temporales.",[s._param("person-name",t)]):e===b.SettingChangeByYou?s._(/*BTDS*/"Desactivaste los mensajes temporales."):e===b.SettingChangeByUnknown?s._(/*BTDS*/"Se desactivaron los mensajes temporales."):e===b.SettingChangeByOthersAsAdmin&&t!=null?s._(/*BTDS*/"{person-name} desactiv\u00f3 los mensajes temporales. Haz clic para cambiar esto.",[s._param("person-name",t)]):e===b.SettingChangeByYouAsAdmin?s._(/*BTDS*/"Desactivaste los mensajes temporales. Haz clic para cambiar esto."):e===b.SettingChangeByUnknownAsAdmin?s._(/*BTDS*/"Se desactivaron los mensajes temporales. Haz clic para cambiar esto."):e===b.Duration?s._(/*BTDS*/"Desactivados"):e===b.OutOfSyncInfo?s._(/*BTDS*/"Este mensaje no desaparecer\u00e1 del chat. Es posible que el remitente tenga una versi\u00f3n desactualizada de WhatsApp."):(o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOffString is given invalid type ",""])),e).sendLogs("invalid-ephemeral-string-type"),"")}function A(e,t,n){var r=o("WAWebMiscGatingUtils").isDefaultDisappearingMessagesEnabled();return e===b.SettingChangeByOthers&&n!=null?s._(/*BTDS*/"_j{\"*\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_seconds"),s._param("person-name",n)]):e===b.SettingChangeByYou?s._(/*BTDS*/"_j{\"*\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_seconds")]):e===b.SettingChangeByUnknown?s._(/*BTDS*/"_j{\"*\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_seconds")]):e===b.SettingChangeByOthersAsAdmin&&n!=null?s._(/*BTDS*/"_j{\"*\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"4\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"_1\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\"}",[s._plural(t,"number_of_seconds"),s._param("person-name",n)]):e===b.SettingChangeByYouAsAdmin?s._(/*BTDS*/"_j{\"*\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"4\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"_1\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\"}",[s._plural(t,"number_of_seconds")]):e===b.SettingChangeByUnknownAsAdmin?s._(/*BTDS*/"_j{\"*\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"4\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"_1\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\"}",[s._plural(t,"number_of_seconds")]):e===b.Duration?s._(/*BTDS*/"_j{\"*\":\"{number_of_seconds} segundos\",\"4\":\"{number_of_seconds} segundo\",\"_1\":\"1 segundo\"}",[s._plural(t,"number_of_seconds")]):e===b.OutOfSyncInfo?s._(/*BTDS*/"_j{\"*\":\"Este mensaje desaparecer\\u00e1 de este chat despu\\u00e9s de {number_of_seconds} segundos de haber sido enviado, a menos que se use la opci\\u00f3n para conservarlo.\",\"4\":\"Este mensaje desaparecer\\u00e1 de este chat despu\\u00e9s de {number_of_seconds} segundo de haber sido enviado, a menos que se use la opci\\u00f3n para conservarlo.\",\"_1\":\"Este mensaje desaparecer\\u00e1 de este chat despu\\u00e9s de 1 segundo de haber sido enviado, a menos que se use la opci\\u00f3n para conservarlo.\"}",[s._plural(t,"number_of_seconds")]):e===b.Explanation?s._(/*BTDS*/"_j{\"*\":\"Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_seconds")]):e===b.ModeChangeByOthers?r?s._(/*BTDS*/"_j{\"*\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para establecer la duraci\\u00f3n predeterminada que desees.\",\"4\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para establecer la duraci\\u00f3n predeterminada que desees.\",\"_1\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para establecer la duraci\\u00f3n predeterminada que desees.\"}",[s._plural(t,"number_of_seconds"),s._param("person-name",n)]):s._(/*BTDS*/"_j{\"*\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para obtener m\\u00e1s informaci\\u00f3n.\",\"4\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para obtener m\\u00e1s informaci\\u00f3n.\",\"_1\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para obtener m\\u00e1s informaci\\u00f3n.\"}",[s._plural(t,"number_of_seconds"),s._param("person-name",n)]):e===b.ModeChangeByYou&&r?s._(/*BTDS*/"_j{\"*\":\"Usas una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar la duraci\\u00f3n predeterminada.\",\"4\":\"Usas una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar la duraci\\u00f3n predeterminada.\",\"_1\":\"Usas una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar la duraci\\u00f3n predeterminada.\"}",[s._plural(t,"number_of_seconds")]):(o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOnSecondsString is given type "," and name ",""])),e,n).sendLogs("invalid-ephemeral-string-type"),"")}function F(e,t,n){var r=o("WAWebMiscGatingUtils").isDefaultDisappearingMessagesEnabled();return e===b.SettingChangeByOthers&&n!=null?s._(/*BTDS*/"_j{\"*\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minutos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_minutes"),s._param("person-name",n)]):e===b.SettingChangeByYou?s._(/*BTDS*/"_j{\"*\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minutos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_minutes")]):e===b.SettingChangeByUnknown?s._(/*BTDS*/"_j{\"*\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minutos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_minutes")]):e===b.SettingChangeByOthersAsAdmin&&n!=null?s._(/*BTDS*/"_j{\"*\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minutos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"4\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"_1\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\"}",[s._plural(t,"number_of_minutes"),s._param("person-name",n)]):e===b.SettingChangeByYouAsAdmin?s._(/*BTDS*/"_j{\"*\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minutos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"4\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"_1\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\"}",[s._plural(t,"number_of_minutes")]):e===b.SettingChangeByUnknownAsAdmin?s._(/*BTDS*/"_j{\"*\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minutos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"4\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"_1\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\"}",[s._plural(t,"number_of_minutes")]):e===b.Duration?s._(/*BTDS*/"_j{\"*\":\"{number_of_minutes} minutos\",\"4\":\"{number_of_minutes} minuto\",\"_1\":\"1 minuto\"}",[s._plural(t,"number_of_minutes")]):e===b.OutOfSyncInfo?s._(/*BTDS*/"_j{\"*\":\"Este mensaje desaparecer\\u00e1 de este chat despu\\u00e9s de {number_of_minutes} minutos de haber sido enviado, a menos que se use la opci\\u00f3n para conservarlo.\",\"4\":\"Este mensaje desaparecer\\u00e1 de este chat despu\\u00e9s de {number_of_minutes} minuto de haber sido enviado, a menos que se use la opci\\u00f3n para conservarlo.\",\"_1\":\"Este mensaje desaparecer\\u00e1 de este chat despu\\u00e9s de 1 minuto de haber sido enviado, a menos que se use la opci\\u00f3n para conservarlo.\"}",[s._plural(t,"number_of_minutes")]):e===b.Explanation?s._(/*BTDS*/"_j{\"*\":\"Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minutos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_minutes")]):e===b.ModeChangeByOthers?r?s._(/*BTDS*/"_j{\"*\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minutos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para establecer la duraci\\u00f3n predeterminada que desees.\",\"4\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para establecer la duraci\\u00f3n predeterminada que desees.\",\"_1\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para establecer la duraci\\u00f3n predeterminada que desees.\"}",[s._plural(t,"number_of_minutes"),s._param("person-name",n)]):s._(/*BTDS*/"_j{\"*\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minutos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para obtener m\\u00e1s informaci\\u00f3n.\",\"4\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para obtener m\\u00e1s informaci\\u00f3n.\",\"_1\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para obtener m\\u00e1s informaci\\u00f3n.\"}",[s._plural(t,"number_of_minutes"),s._param("person-name",n)]):e===b.ModeChangeByYou&&r?s._(/*BTDS*/"_j{\"*\":\"Usas una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minutos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar la duraci\\u00f3n predeterminada.\",\"4\":\"Usas una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar la duraci\\u00f3n predeterminada.\",\"_1\":\"Usas una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar la duraci\\u00f3n predeterminada.\"}",[s._plural(t,"number_of_minutes")]):(o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOnMinutesString is given type "," and name ",""])),e,n).sendLogs("invalid-ephemeral-string-type"),"")}function O(e,t,n){var r=o("WAWebMiscGatingUtils").isDefaultDisappearingMessagesEnabled();return e===b.SettingChangeByOthers&&n!=null?s._(/*BTDS*/"_j{\"*\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} horas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_hours"),s._param("person-name",n)]):e===b.SettingChangeByYou?s._(/*BTDS*/"_j{\"*\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} horas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_hours")]):e===b.SettingChangeByUnknown?s._(/*BTDS*/"_j{\"*\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} horas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_hours")]):e===b.SettingChangeByOthersAsAdmin&&n!=null?s._(/*BTDS*/"_j{\"*\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} horas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"4\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"_1\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\"}",[s._plural(t,"number_of_hours"),s._param("person-name",n)]):e===b.SettingChangeByYouAsAdmin?s._(/*BTDS*/"_j{\"*\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} horas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"4\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"_1\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\"}",[s._plural(t,"number_of_hours")]):e===b.SettingChangeByUnknownAsAdmin?s._(/*BTDS*/"_j{\"*\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} horas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"4\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"_1\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\"}",[s._plural(t,"number_of_hours")]):e===b.Duration?s._(/*BTDS*/"_j{\"*\":\"{number_of_hours} horas\",\"4\":\"{number_of_hours} hora\",\"_1\":\"1 hora\"}",[s._plural(t,"number_of_hours")]):e===b.OutOfSyncInfo?s._(/*BTDS*/"_j{\"*\":\"Este mensaje desaparecer\\u00e1 de este chat despu\\u00e9s de {number_of_hours} horas de haber sido enviado, a menos que se use la opci\\u00f3n para conservarlo.\",\"4\":\"Este mensaje desaparecer\\u00e1 de este chat despu\\u00e9s de {number_of_hours} hora de haber sido enviado, a menos que se use la opci\\u00f3n para conservarlo.\",\"_1\":\"Este mensaje desaparecer\\u00e1 de este chat despu\\u00e9s de 1 hora de haber sido enviado, a menos que se use la opci\\u00f3n para conservarlo.\"}",[s._plural(t,"number_of_hours")]):e===b.Explanation?s._(/*BTDS*/"_j{\"*\":\"Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} horas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_hours")]):e===b.ModeChangeByOthers?r?s._(/*BTDS*/"_j{\"*\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} horas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para establecer la duraci\\u00f3n predeterminada que desees.\",\"4\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para establecer la duraci\\u00f3n predeterminada que desees.\",\"_1\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para establecer la duraci\\u00f3n predeterminada que desees.\"}",[s._plural(t,"number_of_hours"),s._param("person-name",n)]):s._(/*BTDS*/"_j{\"*\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} horas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para obtener m\\u00e1s informaci\\u00f3n.\",\"4\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para obtener m\\u00e1s informaci\\u00f3n.\",\"_1\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para obtener m\\u00e1s informaci\\u00f3n.\"}",[s._plural(t,"number_of_hours"),s._param("person-name",n)]):e===b.ModeChangeByYou&&r?s._(/*BTDS*/"_j{\"*\":\"Usas una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} horas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar la duraci\\u00f3n predeterminada.\",\"4\":\"Usas una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar la duraci\\u00f3n predeterminada.\",\"_1\":\"Usas una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar la duraci\\u00f3n predeterminada.\"}",[s._plural(t,"number_of_hours")]):(o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOnHoursString is given type "," and name ",""])),e,n).sendLogs("invalid-ephemeral-string-type"),"")}function B(e,t,n){var r=o("WAWebMiscGatingUtils").isDefaultDisappearingMessagesEnabled();return e===b.SettingChangeByOthers&&n!=null?s._(/*BTDS*/"_j{\"*\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00edas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_days"),s._param("person-name",n)]):e===b.SettingChangeByYou?s._(/*BTDS*/"_j{\"*\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00edas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_days")]):e===b.SettingChangeByUnknown?s._(/*BTDS*/"_j{\"*\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00edas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_days")]):e===b.SettingChangeByOthersAsAdmin&&n!=null?s._(/*BTDS*/"_j{\"*\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00edas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"4\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"_1\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\"}",[s._plural(t,"number_of_days"),s._param("person-name",n)]):e===b.SettingChangeByYouAsAdmin?s._(/*BTDS*/"_j{\"*\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00edas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"4\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"_1\":\"Activaste los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\"}",[s._plural(t,"number_of_days")]):e===b.SettingChangeByUnknownAsAdmin?s._(/*BTDS*/"_j{\"*\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00edas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"4\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"_1\":\"Se activaron los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\"}",[s._plural(t,"number_of_days")]):e===b.Duration?s._(/*BTDS*/"_j{\"*\":\"{number_of_days} d\\u00edas\",\"4\":\"{number_of_days} d\\u00eda\",\"_1\":\"1 d\\u00eda\"}",[s._plural(t,"number_of_days")]):e===b.OutOfSyncInfo?s._(/*BTDS*/"_j{\"*\":\"Este mensaje desaparecer\\u00e1 de este chat despu\\u00e9s de {number_of_days} d\\u00edas de haber sido enviado, a menos que se use la opci\\u00f3n para conservarlo.\",\"4\":\"Este mensaje desaparecer\\u00e1 de este chat despu\\u00e9s de {number_of_days} d\\u00eda de haber sido enviado, a menos que se use la opci\\u00f3n para conservarlo.\",\"_1\":\"Este mensaje desaparecer\\u00e1 de este chat despu\\u00e9s de 1 d\\u00eda de haber sido enviado, a menos que se use la opci\\u00f3n para conservarlo.\"}",[s._plural(t,"number_of_days")]):e===b.Explanation?s._(/*BTDS*/"_j{\"*\":\"Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00edas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos\",\"4\":\"Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos\",\"_1\":\"Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos\"}",[s._plural(t,"number_of_days")]):e===b.ModeChangeByOthers?r?s._(/*BTDS*/"_j{\"*\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00edas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para establecer la duraci\\u00f3n predeterminada que desees.\",\"4\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para establecer la duraci\\u00f3n predeterminada que desees.\",\"_1\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para establecer la duraci\\u00f3n predeterminada que desees.\"}",[s._plural(t,"number_of_days"),s._param("person-name",n)]):s._(/*BTDS*/"_j{\"*\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00edas, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para obtener m\\u00e1s informaci\\u00f3n.\",\"4\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00eda, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para obtener m\\u00e1s informaci\\u00f3n.\",\"_1\":\"{person-name} usa una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 d\\u00eda, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para obtener m\\u00e1s informaci\\u00f3n.\"}",[s._plural(t,"number_of_days"),s._param("person-name",n)]):e===b.ModeChangeByYou&&r?s._(/*BTDS*/"_j{\"*\":\"Usas una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00edas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar la duraci\\u00f3n predeterminada.\",\"4\":\"Usas una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar la duraci\\u00f3n predeterminada.\",\"_1\":\"Usas una duraci\\u00f3n predeterminada para los mensajes temporales en chats nuevos. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar la duraci\\u00f3n predeterminada.\"}",[s._plural(t,"number_of_days")]):(o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOnDaysString is given type "," and name ",""])),e,n).sendLogs("invalid-ephemeral-string-type"),"")}function W(e,t,n){if(t===void 0&&(t=0),t<0)return o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralString "," is given invalid duration ",""])),e,t).sendLogs("invalid-duration"),"";if(t===0)return q(e,n);if(t<=60)return U(e,t,n);if(t<3600){var r=Math.floor(t/60);return V(e,r,n)}else if(t<=1440*60){var a=Math.floor(t/60/60);return H(e,a,n)}var i=Math.floor(t/24/60/60);return G(e,i,n)}function q(e,t){return e===b.SettingChangeByOthers&&t!=null?s._(/*BTDS*/"{person-name} desactiv\u00f3 los mensajes temporales.",[s._param("person-name",t)]):e===b.SettingChangeByOthersAsAdmin&&t!=null?s._(/*BTDS*/"{person-name} desactiv\u00f3 los mensajes temporales. Haz clic para cambiar esto.",[s._param("person-name",t)]):(o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOffL10nComponent is given invalid type ",""])),e).sendLogs("invalid-ephemeral-string-type"),"")}function U(e,t,n){return e===b.SettingChangeByOthers&&n!=null?s._(/*BTDS*/"_j{\"*\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_seconds"),s._param("person-name",n)]):e===b.SettingChangeByOthersAsAdmin&&n!=null?s._(/*BTDS*/"_j{\"*\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"4\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_seconds} segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"_1\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 segundo de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\"}",[s._plural(t,"number_of_seconds"),s._param("person-name",n)]):(o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOnSecondsL10nComponent is given type "," and name ",""])),e,n).sendLogs("invalid-ephemeral-string-type"),"")}function V(e,t,n){return e===b.SettingChangeByOthers&&n!=null?s._(/*BTDS*/"_j{\"*\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minutos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_minutes"),s._param("person-name",n)]):e===b.SettingChangeByOthersAsAdmin&&n!=null?s._(/*BTDS*/"_j{\"*\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minutos de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"4\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_minutes} minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"_1\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 minuto de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\"}",[s._plural(t,"number_of_minutes"),s._param("person-name",n)]):(o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOnMinutesL10nComponent is given type "," and name ",""])),e,n).sendLogs("invalid-ephemeral-string-type"),"")}function H(e,t,n){return e===b.SettingChangeByOthers&&n!=null?s._(/*BTDS*/"_j{\"*\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} horas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_hours"),s._param("person-name",n)]):e===b.SettingChangeByOthersAsAdmin&&n!=null?s._(/*BTDS*/"_j{\"*\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} horas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"4\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_hours} hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"_1\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 hora de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\"}",[s._plural(t,"number_of_hours"),s._param("person-name",n)]):(o("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOnHoursL10nComponent is given type "," and name ",""])),e,n).sendLogs("invalid-ephemeral-string-type"),"")}function G(e,t,n){return e===b.SettingChangeByOthers&&n!=null?s._(/*BTDS*/"_j{\"*\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00edas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"4\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\",\"_1\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos.\"}",[s._plural(t,"number_of_days"),s._param("person-name",n)]):e===b.SettingChangeByOthersAsAdmin&&n!=null?s._(/*BTDS*/"_j{\"*\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00edas de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"4\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de {number_of_days} d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\",\"_1\":\"{person-name} activ\\u00f3 los mensajes temporales. Los mensajes nuevos desaparecer\\u00e1n de este chat despu\\u00e9s de 1 d\\u00eda de haber sido enviados, a menos que se use la opci\\u00f3n para conservarlos. Haz clic para cambiar esto.\"}",[s._plural(t,"number_of_days"),s._param("person-name",n)]):(o("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOnDaysL10nComponent is given type "," and name ",""])),e,n).sendLogs("invalid-ephemeral-string-type"),"")}function z(e){var t=o("WAWebContactCollection").ContactCollection.assertGet(e);if(o("WAWebContactGetters").getIsMe(t))return s._(/*BTDS*/"Conservado por ti");var n=o("WAWebFrontendContactGetters").getFormattedName(t);return s._(/*BTDS*/"Conservado por {person-name}",[s._param("person-name",n)])}z.displayName=z.name+" [from "+i.id+"]",l.getDisappearingMessageSettingOthersStringKic=v,l.getDisappearingMessageSettingOthersGroupStringKic=S,l.getDisappearingMessageSettingYouStringKic=R,l.getDisappearingMessageSettingUnknownStringKic=L,l.getDisappearingMessageSettingOthersAsAdminStringKic=E,l.getDisappearingMessageSettingOthersAsAdminGroupStringKic=k,l.getDisappearingMessageSettingYouAsAdminStringKic=I,l.getDisappearingMessageSettingUnknownAsAdminStringKic=T,l.getDisappearingMessageDurationStringKic=D,l.getDisappearingMessageOutOfSyncInfoStringKic=x,l.getDisappearingMessageExplanationStringKic=$,l.getDisappearingModeOtherStringKic=P,l.getDisappearingModeYouStringKic=N,l.getKeptByString=z}),226);
__d("WAWebDBEventInvalidateChatEvents",["WAWebDBMessageUtils","WAWebModelStorageUtils","WAWebMsgType","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebModelStorageUtils").getStorage().lock(["message"],(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t[0],r=yield n.between(["internalId"],o("WAWebDBMessageUtils").beginningOfChat(e),o("WAWebDBMessageUtils").endOfChat(e));yield n.bulkCreateOrMerge(r.filter(function(e){return e.type===o("WAWebMsgType").MSG_TYPE.EVENT_CREATION&&!e.eventInvalidated}).map(function(e){return{id:e.id,eventInvalidated:!0}}))});return function(e){return t.apply(this,arguments)}})())}l.invalidateChatEvents=e}),98);
__d("WAWebInvalidateEventsAction",["WALogger","WAWebDBEventInvalidateChatEvents","WAWebFrontendMsgGetters","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){try{yield o("WAWebDBEventInvalidateChatEvents").invalidateChatEvents(t.id),t.msgs.filter(function(e){return o("WAWebFrontendMsgGetters").getAsEventCreation(e)&&!e.eventInvalidated}).forEach(function(e){e.eventInvalidated=!0})}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[EVENTS] Failed to invalidate events with error: ",""])),t).devConsole(t)}}),u.apply(this,arguments)}l.invalidateEventMsgsForChat=s}),98);
__d("WAWebCollectionConstants",[],(function(t,n,r,o,a,i){var e="collection_has_synced",l=50,s=20;i.COLLECTION_HAS_SYNCED=e,i.PAGE_SIZE=l,i.MSG_PRELOAD_THRESHOLD=s}),66);
__d("WAWebEventMsgsCollection",["Promise","WAFilteredCatch","WALogger","WAWebBackendErrors","WAWebBaseCollection","WAWebCollectionConstants","WAWebFrontendMsgGetters","WAWebMsgCollection","WAWebMsgModel","WAWebNoop","WAWebSocketConstants","WAWebSocketModel"],(function(t,n,r,o,a,i,l){var e,s,u=(function(t){function a(e){var n;return n=t.call(this)||this,n.syncPromise=null,n.isFullySynced=!1,n.isInitialized=!1,n.chat=e,n.listenTo(o("WAWebSocketModel").Socket,"change:stream",function(){o("WAWebSocketModel").Socket.stream===o("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED?n.isFullySynced=!1:o("WAWebSocketModel").Socket.stream===o("WAWebSocketConstants").SOCKET_STREAM.CONNECTED&&n.delete()}),n}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.initialize=function(){if(this.isInitialized)return(s||(s=n("Promise"))).resolve();var e=this.chat.msgs;if(e==null)return(s||(s=n("Promise"))).resolve();e.length&&this.add(e.filter(c));var t=(s||(s=n("Promise"))).resolve();return this.chat.msgs.msgLoadState.noEarlierMsgs?this.isFullySynced=!0:t=this.queryEvents({recurse:!1}),this.isInitialized=!0,t},i.delete=function(){this.isFullySynced=!1,this.isInitialized=!1,t.prototype.delete.call(this)},i.queryEvents=function(a){var t=this,i=a.recurse;if(this.syncPromise)return this.syncPromise;if(this.isFullySynced)return(s||(s=n("Promise"))).resolve();var l,u=this.last();u&&(l=u.id);var d=(this.syncPromise=o("WAWebMsgCollection").MsgCollection.getEventMsgs(this.chat.id,o("WAWebCollectionConstants").PAGE_SIZE,l).then(function(e){(!e||e.length<o("WAWebCollectionConstants").PAGE_SIZE)&&(t.isFullySynced=!0),t.add(e.filter(c))}).then(function(){if(t.syncPromise=null,t.isFullySynced)t.trigger(o("WAWebCollectionConstants").COLLECTION_HAS_SYNCED);else if(i===!0)return t.trigger("partial_sync"),t.queryEvents({recurse:!0})}).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").E404,r("WAWebNoop"))).catch(function(t){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Event msg sync error: "]))).devConsole(t)})).finally(function(){t.syncPromise=null});return d},a})(o("WAWebBaseCollection").BaseCollection);u.model=o("WAWebMsgModel").Msg,u.comparator=function(e,t){return t.t-e.t};function c(e){return o("WAWebFrontendMsgGetters").getAsEventCreation(e)!=null}l.EventMsgsCollection=u}),98);
__d("WAWebEventResponseGetters",["WAWebGetters","WAWebGettersCaches"],(function(t,n,r,o,a,i,l){var e=o("WAWebGetters").createGetterFactories({createCache:o("WAWebGettersCaches").createEventResponseCache}),s=e.field,u=e.unsafeIdentityGetter,c=e.clearCacheFor,d=c,m=u,p=s("sender"),_=s("senderTimestampMs");l.clearEventResponseGetterCacheFor=d,l.getEventResponseUnsafe=m,l.getSender=p,l.getSenderTimestampMs=_}),98);
__d("WAWebFrontendEventResponseGetters",["WAWebEventResponseGetters","WAWebGetters","WAWebGettersCaches"],(function(t,n,r,o,a,i,l){var e=o("WAWebGetters").createGetterFactories({root:o("WAWebEventResponseGetters").getEventResponseUnsafe,createCache:o("WAWebGettersCaches").createFrontendEventResponseCache}),s=e.clearCacheFor,u=s;l.clearFrontendEventResponseGetterCacheFor=u}),98);
__d("WAWebEventResponseModel",["WAWebAddOnModel","WAWebBaseModel","WAWebEventResponseGetters","WAWebFrontendEventResponseGetters"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.parentMsgKey=o("WAWebBaseModel").prop(),t.eventResponse=o("WAWebBaseModel").prop(),t.senderTimestampMs=o("WAWebBaseModel").prop(),t.t=o("WAWebBaseModel").prop(),t.sender=o("WAWebBaseModel").prop(),t.read=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.delete=function(){e.prototype.delete.call(this),o("WAWebEventResponseGetters").clearEventResponseGetterCacheFor(this),o("WAWebFrontendEventResponseGetters").clearFrontendEventResponseGetterCacheFor(this)},t})(o("WAWebAddOnModel").AddOnBaseModel),s=o("WAWebBaseModel").defineModel(e);l.EventResponse=s}),98);
__d("WAWebEventResponseCollection",["WANullthrows","WAWebAck","WAWebBaseCollection","WAWebCollectionUtils","WAWebEventResponseModel","WAWebMsgGetters","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.byParent=o("WAWebCollectionUtils").aggregated(function(e){return e.parentMsgKey}),t.byIsFailedByMe=o("WAWebCollectionUtils").aggregated(function(e){return e.isSendFailure===!0||o("WAWebUserPrefsMeUser").isMeAccount(e.sender)&&e.ack!=null&&e.ack<o("WAWebAck").ACK.CLOCK}),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebEventResponseModel").EventResponse;function s(e){return new(o("WAWebEventResponseModel")).EventResponse(babelHelpers.extends({},e,{sender:r("WANullthrows")(o("WAWebMsgGetters").getSender(e))}))}var u=new e;l.createEventResponseModel=s,l.EventResponseCollection=u}),98);
__d("WAWebInitFavoritesFromStorage",["WAWebDBFavoriteDatabaseApi","WAWebFavoriteCollection"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebDBFavoriteDatabaseApi").getAllFavorites().then(function(e){o("WAWebFavoriteCollection").FavoriteCollection.initializeFromCache([].concat(e))})}l.restoreFavorites=e}),98);
__d("WAWebActionToast.react",["WAAbortError","WAPromiseDelays","WAWebNonEmptyString","WAWebNoop","WAWebToast.react","WAWebToastManager","err","react","uniqueID","useWAWebPrevious"],(function(t,n,r,o,a,i,l){var e,s,u=s||(s=o("react")),c=e||(e=r("react")),d=u.useCallback,m=u.useEffect,p=u.useMemo,_=u.useRef,f=u.useState,g=5e3,h={LEFT:"LEFT",RIGHT:"RIGHT"},y=function(t,n){if(!t)throw r("err")("ActionType must have text!");this.text=t,n&&(this.action=n.actionText,this.handler=n.actionHandler)};function C(e){var t;return o("WAWebNonEmptyString").asNonEmptyString(r("uniqueID")((t=o("WAWebNonEmptyString").asMaybeNonEmptyString(e))!=null?t:"action_toast"))}function b(e){var t=e.settleDuration,n=t===void 0?g:t,a=e.toastPosition,i=a===void 0?h.LEFT:a,l=e.initialAction,s=e.pendingAction,u=e.id,y=u===void 0?C():u,b=e.onDismiss,v=f(l),S=v[0],R=v[1],L=f(l),E=L[0],k=L[1],I=f(!0),T=I[0],D=I[1],x=r("useWAWebPrevious")(S),$=_(null),P=_(null),N=_(null),M=d(function(){E&&E.handler&&E.handler().catch(r("WAWebNoop"))},[E]);m(function(){l!==x&&(R(l),k(l),D(!0))},[l,x]);var w=p(function(){return new AbortController},[]),A=w.signal,F=d(function(){b!=null&&b(),w.abort(),o("WAWebToastManager").ToastManager.close(y)},[b,y,w]),O=function(t){$.current&&$.current.controller.abort();var e=new AbortController,a=e.signal,i=t.then(function(e){if(a.aborted)throw new(o("WAAbortError")).AbortError;k(e),D(!1)}).catch(function(e){if(e.name!==o("WAAbortError").ABORT_ERROR)k(e),D(!1);else throw e}).then(function(){return o("WAPromiseDelays").delayMs(n,A)}).then(function(){if(a.aborted)throw new(o("WAAbortError")).AbortError;b!=null&&b(),o("WAWebToastManager").ToastManager.close(y)}).catch(o("WAAbortError").catchAbort(r("WAWebNoop")));$.current={promise:i,controller:e}};m(function(){O(s)},[s]);var B=p(function(){if(E!=null){var e=E.action,t=E.handler;if(e!=null&&t!=null)return c.jsx(o("WAWebToast.react").ToastActionBtn,{buttonText:e,onClick:M,ref:P})}return null},[E,M]),W=p(function(){return T?null:c.jsx(o("WAWebToast.react").ToastDismissBtn,{onClick:F,ref:N})},[F,T]),q=p(function(){return B?P:W?N:null},[B,W]);return E?c.jsx(o("WAWebToast.react").ToastBody,{toastPosition:i,actionText:E.text,actionButtons:B!=null?B:void 0,dismissButton:W!=null?W:void 0,focusButtonRef:q}):null}b.displayName=b.name+" [from "+i.id+"]",l.ToastPosition=h,l.ActionType=y,l.genId=C,l.ActionToast=b}),98);
__d("WAWebAddToFavoritesAction",["fbt","WALogger","WATimeUtils","WAWebABProps","WAWebActionToast.react","WAWebConfirmPopup.react","WAWebDBFavoriteDatabaseApi","WAWebFavoriteCollection","WAWebFavoritesLogging","WAWebFavoritesSync","WAWebFbtCommon","WAWebInboxFiltersGatingUtils","WAWebL10NHelpers","WAWebListsGatingUtils","WAWebModalManager","WAWebSyncdCoreApi","WAWebToastManager","asyncToGeneratorRuntime","react"],(function(t,n,r,o,a,i,l,s){var e,u,c=u||(u=r("react"));function d(){return o("WAWebListsGatingUtils").isListsEnabled()?o("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?s._(/*BTDS*/"Adding to Favourites list"):s._(/*BTDS*/"A\u00f1adiendo a la lista de favoritos\u2026"):o("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?s._(/*BTDS*/"Adding to Favourites"):s._(/*BTDS*/"A\u00f1adiendo a Favoritos\u2026")}function m(){return o("WAWebListsGatingUtils").isListsEnabled()?o("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?s._(/*BTDS*/"Added to Favourites list"):s._(/*BTDS*/"Se a\u00f1adi\u00f3 a la lista de favoritos"):o("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?s._(/*BTDS*/"Added to Favourites"):s._(/*BTDS*/"A\u00f1adido a Favoritos")}function p(e,t){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a){var i;if(o("WAWebInboxFiltersGatingUtils").inboxFavoritesEnabled()){var l=yield o("WAWebDBFavoriteDatabaseApi").getAllFavorites(),u=(i=o("WAWebABProps").getABPropConfigValue("favorites_limit"))!=null?i:100;if(l.length+(Array.isArray(t)?t.length:1)>u){o("WAWebModalManager").ModalManager.open(c.jsx(o("WAWebConfirmPopup.react").ConfirmPopup,{onOK:function(){return o("WAWebModalManager").ModalManager.close()},okText:r("WAWebFbtCommon")("OK"),children:o("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?s._(/*BTDS*/"You can't add more than {favorites_limit} favourites",[s._param("favorites_limit",u)]):s._(/*BTDS*/"No puedes a\u00f1adir m\u00e1s de {favorites_limit} favoritos",[s._param("favorites_limit",u)])}));return}var p;if(Array.isArray(t)){var _=yield o("WAWebDBFavoriteDatabaseApi").getNextFavoriteOrderIndex();p=t.map(function(e){return{id:e.toString(),orderIndex:_++}})}else p=[babelHelpers.extends({},t)];a.entryPoint!=null&&o("WAWebFavoritesLogging").logAddingMessagingFavorites(p,a.entryPoint);var f=l.concat(p),g=o("WATimeUtils").unixTime(),h=yield r("WAWebFavoritesSync").getFavoritesMutation(f,g);o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[Favorites] addToFavoritesAction, mutation generated"]))).devConsole(h);var y=o("WAWebSyncdCoreApi").lockForSync(["favorite","chat"],[h],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebDBFavoriteDatabaseApi").addOrEditFavorites(p)})).then(function(){return o("WAWebFavoriteCollection").FavoriteCollection.add(p.map(function(e){return babelHelpers.extends({},e)}))});if(a.suppressToast===!0)yield y;else{var C=new(o("WAWebActionToast.react")).ActionType(d()),b=y.then(function(){return new(o("WAWebActionToast.react")).ActionType(m())});o("WAWebToastManager").ToastManager.open(c.jsx(o("WAWebActionToast.react").ActionToast,{id:o("WAWebActionToast.react").genId(),initialAction:C,pendingAction:b}))}}}),_.apply(this,arguments)}l.addToFavoritesAction=p}),226);
__d("WAWebRemoveFromFavoritesAction",["fbt","WALogger","WATimeUtils","WAWebActionToast.react","WAWebAddToFavoritesAction","WAWebDBFavoriteDatabaseApi","WAWebFavoriteCollection","WAWebFavoritesLogging","WAWebFavoritesSync","WAWebInboxFiltersGatingUtils","WAWebL10NHelpers","WAWebListsGatingUtils","WAWebSyncdCoreApi","WAWebToastManager","asyncToGeneratorRuntime","react"],(function(t,n,r,o,a,i,l,s){var e,u,c=u||(u=r("react"));function d(){return o("WAWebListsGatingUtils").isListsEnabled()?o("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?s._(/*BTDS*/"Removing from Favourites list"):s._(/*BTDS*/"Eliminando de la lista de favoritos\u2026"):o("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?s._(/*BTDS*/"Removing from Favourites"):s._(/*BTDS*/"Eliminando de Favoritos\u2026")}function m(){return o("WAWebListsGatingUtils").isListsEnabled()?o("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?s._(/*BTDS*/"Removed from Favourites list"):s._(/*BTDS*/"Se elimin\u00f3 de tu lista de favoritos"):o("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?s._(/*BTDS*/"Removed from Favourites"):s._(/*BTDS*/"Eliminado de Favoritos")}function p(e,t){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a){if(o("WAWebInboxFiltersGatingUtils").inboxFavoritesEnabled()){var i=t.toString();a.entryPoint!=null&&o("WAWebFavoritesLogging").logRemovingMessagingFavorites([i],a.entryPoint);var l=yield o("WAWebDBFavoriteDatabaseApi").getAllFavorites(),u=l.find(function(e){var t=e.id;return t===i}),p=l.filter(function(e){var t=e.id;return t!==i}),_=o("WATimeUtils").unixTime(),f=yield r("WAWebFavoritesSync").getFavoritesMutation(p,_);o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[Favorites] removeFromFavoritesAction, mutation generated"]))).devConsole(f);var g=o("WAWebSyncdCoreApi").lockForSync(["favorite","chat"],[f],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebDBFavoriteDatabaseApi").removeFavorites([i])})).then(function(){return o("WAWebFavoriteCollection").FavoriteCollection.remove([i])});if(a.suppressToast===!0)yield g;else{var h=new(o("WAWebActionToast.react")).ActionType(d()),y=g.then(function(){return new(o("WAWebActionToast.react")).ActionType(m(),u?{actionText:s._(/*BTDS*/"Deshacer"),actionHandler:function(){return o("WAWebAddToFavoritesAction").addToFavoritesAction(u,{entryPoint:a.entryPoint})}}:void 0)});o("WAWebToastManager").ToastManager.open(c.jsx(o("WAWebActionToast.react").ActionToast,{id:o("WAWebActionToast.react").genId(),initialAction:h,pendingAction:y}))}}}),_.apply(this,arguments)}l.removeFromFavoritesAction=p}),226);
__d("WAWebFavoriteCollection",["WAWebBaseCollection","WAWebContactCollection","WAWebFavoriteModel","WAWebWidFactory"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){var t;return t=e.call(this)||this,t.listenTo(t,"add",function(e){var t=o("WAWebContactCollection").ContactCollection.get(o("WAWebWidFactory").createWid(e.id));t&&t.set("isFavorite",!0)}),t.listenTo(t,"remove",function(e){var t=o("WAWebContactCollection").ContactCollection.get(o("WAWebWidFactory").createWid(e.id));t&&t.set("isFavorite",!1)}),t}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebFavoriteModel").Favorite;var s=new e;l.FavoriteCollection=s}),98);
__d("WAWebFavoriteModel",["WAWebBaseModel","WAWebFavoriteCollection"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.orderIndex=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getCollection=function(){return o("WAWebFavoriteCollection").FavoriteCollection},t})(o("WAWebBaseModel").BaseModel);e.Proxy="favorite";var s=o("WAWebBaseModel").defineModel(e);l.Favorite=s}),98);
__d("WAWebWamEnumFavoritesUpdateEntryPoint",[],(function(t,n,r,o,a,i){var e=Object.freeze({CONTACT_INFO:1,GROUP_INFO:2,CHAT_MORE_OPTIONS:3,CHAT_LONG_PRESS_OPTIONS:4,MESSAGE_FAVORITES_CONTACT_PICKER:5,FAVORITE_SETTINGS:6,FILTER_CONTEXT_MENU:7,FILTER_EMPTY_STATE_ACTION:8,FILTER_MANAGE_FAVORITE_ACTION:9,CALLING_TAB_FAVORITE_PICKER:10,CALLING_TAB_FAVORITE_EDIT:11,CHAT_CONTEXT_MENU:12,CHAT_HEADER_CONTEXT_MENU:13,CALL_LOG_LONG_PRESS_OPTIONS:14,CALL_LOG_MORE_OPTIONS:15});i.FAVORITES_UPDATE_ENTRY_POINT=e}),66);
__d("WAWebMessagingFavoritesUpdateWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumFavoritesUpdateEntryPoint"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MessagingFavoritesUpdate:[5460,{contactFavCountAfterUpdate:[1,e.TYPES.INTEGER],contactFavCountBeforeUpdate:[2,e.TYPES.INTEGER],favoritesUpdateEntryPoint:[3,o("WAWebWamEnumFavoritesUpdateEntryPoint").FAVORITES_UPDATE_ENTRY_POINT],groupFavCountAfterUpdate:[4,e.TYPES.INTEGER],groupFavCountBeforeUpdate:[5,e.TYPES.INTEGER]},[1,1,1],"regular"]},{MessagingFavoritesUpdate:[]});l.MessagingFavoritesUpdateWamEvent=s}),98);
__d("WAWebFavoritesLogging",["WALogger","WAWebFavoriteCollection","WAWebMessagingFavoritesUpdateWamEvent","WAWebWid"],(function(t,n,r,o,a,i,l){var e,s;function u(t,n){try{var a=0,i=0,l=0,s=0;o("WAWebFavoriteCollection").FavoriteCollection.forEach(function(e){r("WAWebWid").isGroup(e.id)?l++:a++}),i=a,s=l,t.forEach(function(e){r("WAWebWid").isGroup(e.id)?s++:i++}),new(o("WAWebMessagingFavoritesUpdateWamEvent")).MessagingFavoritesUpdateWamEvent({favoritesUpdateEntryPoint:n,contactFavCountBeforeUpdate:a,contactFavCountAfterUpdate:i,groupFavCountBeforeUpdate:l,groupFavCountAfterUpdate:s}).commit()}catch(t){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[Favorites] logAddingMessagingFavorites, error: ",""])),t).sendLogs("logAddingMessagingFavorites")}}function c(e,t){try{var n=0,a=0,i=0,l=0;o("WAWebFavoriteCollection").FavoriteCollection.forEach(function(e){r("WAWebWid").isGroup(e.id)?i++:n++}),a=n,l=i,e.forEach(function(e){r("WAWebWid").isGroup(e)?l--:a--}),a=Math.max(a,0),l=Math.max(l,0),new(o("WAWebMessagingFavoritesUpdateWamEvent")).MessagingFavoritesUpdateWamEvent({favoritesUpdateEntryPoint:t,contactFavCountBeforeUpdate:n,contactFavCountAfterUpdate:a,groupFavCountBeforeUpdate:i,groupFavCountAfterUpdate:l}).commit()}catch(e){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[Favorites] logRemovingMessagingFavorites, error: ",""])),e).sendLogs("logRemovingMessagingFavorites")}}l.logAddingMessagingFavorites=u,l.logRemovingMessagingFavorites=c}),98);
__d("WAWebGroupSafetyCheckModalLoadable",["JSResourceForInteraction","WAWebLazyLoadedRetriable","WAWebLoadingConfirmPopup.react","asyncToGeneratorRuntime","react","react-loadable"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=r("react")),u=r("WAWebLazyLoadedRetriable")(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield r("JSResourceForInteraction")("WAWebGroupSafetyCheckModal.react").__setRef("WAWebGroupSafetyCheckModalLoadable").load();return e}),"GroupSafetyCheckModal"),c=r("react-loadable")({loader:u,loading:function(t){return s.jsx(r("WAWebLoadingConfirmPopup.react"),{error:!!t.error})}});l.GroupSafetyCheckModalLoadable=c}),98);
__d("WAWebPsGroupOpenedWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({PsGroupOpened:[6236,{integrityGroupUserHashedId:[4,e.TYPES.STRING],isGroupSafetyCheckAbpropEnabled:[2,e.TYPES.BOOLEAN],isPartOfGroupSafetyCheckExperiment:[3,e.TYPES.BOOLEAN],openedGroupJid:[1,e.TYPES.STRING]},[1,1,1],"private",216763284]},{PsGroupOpened:[]});l.PsGroupOpenedWamEvent=s}),98);
__d("WAWebPsGroupSafetyCheckEnabledWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({PsGroupSafetyCheckEnabled:[6238,{didJoinByGil:[3,e.TYPES.BOOLEAN],integrityGroupUserHashedId:[4,e.TYPES.STRING],psSafetyCheckGroupJid:[1,e.TYPES.STRING],psWasSafetyCheckGroupInitiallyMuted:[2,e.TYPES.BOOLEAN],wasAddedByContact:[5,e.TYPES.BOOLEAN],willSafetyCheckBeSeen:[6,e.TYPES.BOOLEAN]},[1,1,1],"private",216763284]},{PsGroupSafetyCheckEnabled:[]});l.PsGroupSafetyCheckEnabledWamEvent=s}),98);
__d("WAWebWamEnumPsGroupSafetyCheckExitDialogActions",[],(function(t,n,r,o,a,i){var e=Object.freeze({GROUP_EXIT_DIALOG_DISMISS:0,GROUP_EXIT_DIALOG_EXIT:1,GROUP_EXIT_DIALOG_EXIT_AND_REPORT:2,COMMUNITY_EXIT_DIALOG_DISMISS:3,COMMUNITY_EXIT_DIALOG_EXIT:4,COMMUNITY_EXIT_DIALOG_EXIT_AND_DELETE:5});i.PS_GROUP_SAFETY_CHECK_EXIT_DIALOG_ACTIONS=e}),66);
__d("WAWebPsGroupSafetyCheckExitDialogWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPsGroupSafetyCheckExitDialogActions"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({PsGroupSafetyCheckExitDialog:[6252,{integrityGroupUserHashedId:[3,o("WAWebWamCodegenUtils").TYPES.STRING],psGroupSafetyCheckExitDialogAction:[1,o("WAWebWamEnumPsGroupSafetyCheckExitDialogActions").PS_GROUP_SAFETY_CHECK_EXIT_DIALOG_ACTIONS],psSafetyCheckGroupJid:[2,o("WAWebWamCodegenUtils").TYPES.STRING]},[1,1,1],"private",216763284]},{PsGroupSafetyCheckExitDialog:[]});l.PsGroupSafetyCheckExitDialogWamEvent=e}),98);
__d("WAWebPsGroupSafetyCheckSheetSeenWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({PsGroupSafetyCheckSheetSeen:[6240,{integrityGroupUserHashedId:[2,o("WAWebWamCodegenUtils").TYPES.STRING],psSafetyCheckGroupJid:[1,o("WAWebWamCodegenUtils").TYPES.STRING]},[1,1,1],"private",216763284]},{PsGroupSafetyCheckSheetSeen:[]});l.PsGroupSafetyCheckSheetSeenWamEvent=e}),98);
__d("WAWebWamEnumPsGroupSafetyCheckUiInteractions",[],(function(t,n,r,o,a,i){var e=Object.freeze({SEE_CHAT:0,EXIT_GROUP:1,EXIT_COMMUNITY:2,SEE_SCAM_EXAMPLES:3,PRIVACY_SETTINGS:4,HOW_TO_REPORT:5,DOUBLE_CHECK_LINKS:6,DISMISS:7,DRAG_DISMISS:8,X_BUTTON:9,BACK_BUTTON:10});i.PS_GROUP_SAFETY_CHECK_UI_INTERACTIONS=e}),66);
__d("WAWebPsGroupSafetyCheckUiInteractionsWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPsGroupSafetyCheckUiInteractions"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({PsGroupSafetyCheckUiInteractions:[6242,{integrityGroupUserHashedId:[3,o("WAWebWamCodegenUtils").TYPES.STRING],psSafetyCheckGroupJid:[1,o("WAWebWamCodegenUtils").TYPES.STRING],psSafetyCheckInteraction:[2,o("WAWebWamEnumPsGroupSafetyCheckUiInteractions").PS_GROUP_SAFETY_CHECK_UI_INTERACTIONS]},[1,1,1],"private",216763284]},{PsGroupSafetyCheckUiInteractions:[]});l.PsGroupSafetyCheckUiInteractionsWamEvent=e}),98);
__d("WAWebGroupSafetyCheckModalLoggingUtils",["WAWebGroupSafetyCheckGatingUtils","WAWebPsGroupOpenedWamEvent","WAWebPsGroupSafetyCheckEnabledWamEvent","WAWebPsGroupSafetyCheckExitDialogWamEvent","WAWebPsGroupSafetyCheckSheetSeenWamEvent","WAWebPsGroupSafetyCheckUiInteractionsWamEvent"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.groupJid;o("WAWebGroupSafetyCheckGatingUtils").groupSafetyCheckLoggingEnabled()&&new(o("WAWebPsGroupOpenedWamEvent")).PsGroupOpenedWamEvent({isGroupSafetyCheckAbpropEnabled:o("WAWebGroupSafetyCheckGatingUtils").groupSafetyCheckM2Enabled(),isPartOfGroupSafetyCheckExperiment:o("WAWebGroupSafetyCheckGatingUtils").groupSafetyCheckIsPartOfExperiment(),openedGroupJid:t}).commit()}function s(e){var t=e.groupJid,n=e.initiallyMuted;o("WAWebGroupSafetyCheckGatingUtils").groupSafetyCheckM2Enabled()&&new(o("WAWebPsGroupSafetyCheckEnabledWamEvent")).PsGroupSafetyCheckEnabledWamEvent({psSafetyCheckGroupJid:t,psWasSafetyCheckGroupInitiallyMuted:n}).commit()}function u(e){var t=e.groupJid;new(o("WAWebPsGroupSafetyCheckSheetSeenWamEvent")).PsGroupSafetyCheckSheetSeenWamEvent({psSafetyCheckGroupJid:t}).commit()}function c(e){var t=e.groupJid,n=e.interaction;new(o("WAWebPsGroupSafetyCheckUiInteractionsWamEvent")).PsGroupSafetyCheckUiInteractionsWamEvent({psSafetyCheckGroupJid:t,psSafetyCheckInteraction:n}).commit()}function d(e){var t=e.groupJid,n=e.interaction;new(o("WAWebPsGroupSafetyCheckExitDialogWamEvent")).PsGroupSafetyCheckExitDialogWamEvent({psSafetyCheckGroupJid:t,psGroupSafetyCheckExitDialogAction:n}).commit()}l.logGroupOpenEvent=e,l.logGroupSafetyCheckEnabledEvent=s,l.logGroupSafetyCheckModalSeenEvent=u,l.logGroupSafetyCheckUIInteractionsEvent=c,l.logGroupSafetyCheckExitDialogUIInteractionsEvent=d}),98);
__d("WAWebGroupSafetyCheckUtils",["WAWebChatGetters","WAWebCmd","WAWebFrontendMsgGetters","WAWebGroupSafetyCheckGatingUtils","WAWebGroupSafetyCheckModalLoadable","WAWebGroupSafetyCheckModalLoggingUtils","WAWebModalManager","WAWebMuteGetters","WAWebNotificationHelpers","WAWebStateUtils","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=r("react"));function u(e){var t;if(!e)return!1;var n=o("WAWebStateUtils").unproxy(e);return o("WAWebChatGetters").getIsGroup(n)&&!!((t=n.groupMetadata)!=null&&t.groupSafetyCheck)}function c(e,t,n){var r=n===!0&&!t,a=n===!1&&!t;r&&o("WAWebGroupSafetyCheckModalLoggingUtils").logGroupSafetyCheckEnabledEvent({groupJid:e.id.toJid(),initiallyMuted:o("WAWebMuteGetters").getIsMuted(e.mute)}),_(e,r,a)}function d(e,t){var n=o("WAWebStateUtils").unproxy(e),r=n.groupMetadata;if(r){var a=r.groupSafetyCheck;if(a===!0){var i=!t;_(n,i,!i)}}}function m(e){o("WAWebModalManager").ModalManager.open(s.jsx(o("WAWebGroupSafetyCheckModalLoadable").GroupSafetyCheckModalLoadable,{chat:e}),{transition:"modal-flow"})}function p(e){var t=o("WAWebFrontendMsgGetters").getChat(e);return o("WAWebNotificationHelpers").isMeUserMentionedOrQuoted(e)&&f(t)}function _(e,t,n){o("WAWebGroupSafetyCheckGatingUtils").groupSafetyCheckM2Enabled()&&(t?o("WAWebCmd").Cmd.muteChat(e,t,!1,!1):n&&o("WAWebCmd").Cmd.muteChat(e,!1,!1,!1))}function f(e){return u(e)&&!e.isTrusted()&&o("WAWebGroupSafetyCheckGatingUtils").groupSafetyCheckM2Enabled()}l.isGroupSafetyChecked=u,l.handleGroupSafetyCheckStateUpdate=c,l.handleIsTrustedChangeForGroupSafety=d,l.openGroupSafetyCheckModal=m,l.shouldMuteMentionWhileGroupSafetyChecked=p,l.shouldShowGroupSafetyCheckUI=f}),98);
__d("WAWebIndividualNewChatMessageCappingLimitGatingUtils",["WALogger","WAWebABProps","WAWebMobilePlatforms","WAWebSubscriptionCollection"],(function(t,n,r,o,a,i,l){var e;function s(){return o("WAWebABProps").getABPropConfigValue("wa_individual_new_chat_msg_capping_limit")}function u(){return o("WAWebABProps").getABPropConfigValue("wa_individual_new_chat_msg_latest_rampup_date")}function c(){return o("WAWebMobilePlatforms").isSMB()&&d()?!1:s()>0}function d(){var t=o("WAWebSubscriptionCollection").SubscriptionCollection.at(0);if(t==null)return!1;var n=t.newMessageCappingEnabled;if(n===!0)return!1;o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Subscription creation date: "," "])),t==null?void 0:t.creationTime);var r=(t==null?void 0:t.creationTime)!=null&&t.creationTime<u();return r}l.isIndividualNewChatMessageCappingEnabled=c}),98);
__d("WAWebIndividualNewChatMessageCappingLimitUtils",["WATimeUtils","WAWebContactGetters","WAWebIndividualNewChatMessageCappingLimitGatingUtils","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsTypes","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e="WANewChatMessageCappingData";function s(){if(!o("WAWebIndividualNewChatMessageCappingLimitGatingUtils").isIndividualNewChatMessageCappingEnabled())return!1;var t=o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(e);if(t==null)return!1;var n=o("WATimeUtils").unixTime(),r=n>t.cycle_end_timestamp;return r?(f(o("WAWebUserPrefsTypes").NewChatMessageCappingStatusType.NONE),!1):t.capping_status===o("WAWebUserPrefsTypes").NewChatMessageCappingStatusType.CAPPED}function u(){var t=o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(e),n=typeof(t==null?void 0:t.capping_status)=="string"?o("WAWebUserPrefsTypes").NewChatMessageCappingStatusType.cast(t.capping_status):null;return n!=null?n:o("WAWebUserPrefsTypes").NewChatMessageCappingStatusType.NONE}function c(){return o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(e)}function d(e){var t=e.chat,n=e.contact;return!o("WAWebContactGetters").getIsUser(n)||o("WAWebContactGetters").getIsMe(n)||o("WAWebContactGetters").getIsEnterprise(n)||o("WAWebContactGetters").getIsSupportAccount(n)||n.id.isBot()||o("WAWebContactGetters").getIsHosted(n)||o("WAWebContactGetters").getIsBroadcast(n)||o("WAWebContactGetters").getIsPSA(n)?!0:(t==null?void 0:t.getTcToken())!=null}function m(e){var t;return(t=o("WAWebUserPrefsTypes").NewChatMessageCappingStatusType.cast(e))!=null?t:o("WAWebUserPrefsTypes").NewChatMessageCappingStatusType.NONE}function p(e){var t;return(t=o("WAWebUserPrefsTypes").NewChatMessageCappingOTEStatusType.cast(e))!=null?t:o("WAWebUserPrefsTypes").NewChatMessageCappingOTEStatusType.ELIGIBLE}function _(e){var t;return(t=o("WAWebUserPrefsTypes").NewChatMessageCappingMVStatusType.cast(e))!=null?t:o("WAWebUserPrefsTypes").NewChatMessageCappingMVStatusType.NOT_ACTIVE}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(e);n!=null&&(yield o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(e,babelHelpers.extends({},n,{capping_status:t})))}),g.apply(this,arguments)}l.NEW_CHAT_MESSAGE_CAPPING_IDB_KEY=e,l.isUserCapped=s,l.getCappingStatus=u,l.getCappingData=c,l.canSendMsgWhileCapped=d,l.getCappingStatusType=m,l.getCappingOTEStatusType=p,l.getCappingMVStatusType=_,l.resetCappingStatus=f}),98);
__d("WAWebChatSearchFilters",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum")({UNREAD:"unread",FAVORITES:"favorites",GROUP:"group",BROADCAST:"broadcast",CONTACT:"contact",NON_CONTACT:"non_contact",ASSIGNED_TO_YOU:"assigned_to_you",PERSONAL:"personal",BUSINESS:"business",LABELS:"labels"}),l=function(n){switch(n){case e.UNREAD:case e.ASSIGNED_TO_YOU:case e.CONTACT:case e.GROUP:case e.LABELS:case e.FAVORITES:return!0;case e.BROADCAST:case e.NON_CONTACT:case e.BUSINESS:case e.PERSONAL:return!1}},s=function(n){switch(n){case e.UNREAD:case e.ASSIGNED_TO_YOU:return!0;case e.BROADCAST:case e.NON_CONTACT:case e.BUSINESS:case e.PERSONAL:case e.CONTACT:case e.GROUP:case e.LABELS:case e.FAVORITES:return!1}};i.SearchFilters=e,i.isFilterExcludedFromSearchTreatmentInInboxFlow=l,i.isFilterExcludedFromSearchTreatmentInNormalFlow=s}),66);
__d("WAWebWamEnumCtwaLabelType",[],(function(t,n,r,o,a,i){var e=Object.freeze({NEW_ORDER:0,PENDING_PAYMENT:1,PAID:2,ORDER_COMPLETE:3,NEW_CUSTOMER:4,DELIVERED:5,LEAD:6,FOLLOW_UP:7,APPOINTMENT:8,IMPORTANT:9,DO_NEW_ORDER:10,DO_LEAD:11});i.CTWA_LABEL_TYPE=e}),66);
__d("WAWebLabelConstants",["WAWebCTWAConstants","WAWebWamEnumCtwaLabelType"],(function(t,n,r,o,a,i,l){var e=["#FF9485","#64C4FF","#FFD429","#DFAEF0","#99B6C1","#55CCB3","#FF9DFF","#D3A91D","#6D7CCE","#D7E752","#00D0E2","#FFC5C7","#93CEAC","#F74848","#00A0F2","#83E422","#FFAF04","#B5EBFF","#9BA6FF","#9368CF"],s=["#A62C71","#90A841","#C1A03F","#792138","#AE8774","#F0B330","#B6B327","#C69FCC","#8B6990","#FF8A8C","#54C265","#FF7B6B","#26C4DC","#57C9FF","#74676A","#7E90A3","#5696FF","#6E257E","#7ACBA5","#243640"],u=Object.freeze({NEW_CUSTOMER:1,NEW_ORDER:2,PENDING_PAYMENT:3,PAID:4,ORDER_COMPLETE:5,IMPORTANT:6,FOLLOW_UP:7,LEAD:8}),c=Object.freeze({NEW_CUSTOMER:"New customer",NEW_ORDER:"New order",PENDING_PAYMENT:"Pending payment",PAID:"Paid",ORDER_COMPLETE:"Order complete",IMPORTANT:"Important",FOLLOW_UP:"Follow up",LEAD:"Lead"}),d=Object.freeze({NEW_CUSTOMER:"new_customer",NEW_ORDER:"new_order",PENDING_PAYMENT:"pending_payment",PAID:"paid",ORDER_COMPLETE:"order_complete",IMPORTANT:"important",FOLLOW_UP:"follow_up",LEAD:"lead"}),m=function(t){switch(t){case c.NEW_CUSTOMER:return u.NEW_CUSTOMER;case c.NEW_ORDER:return u.NEW_ORDER;case c.PENDING_PAYMENT:return u.PENDING_PAYMENT;case c.PAID:return u.PAID;case c.ORDER_COMPLETE:return u.ORDER_COMPLETE;case c.IMPORTANT:return u.IMPORTANT;case c.FOLLOW_UP:return u.FOLLOW_UP;case c.LEAD:return u.LEAD;default:return}},p=function(t){switch(t){case d.NEW_CUSTOMER:return o("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.NEW_CUSTOMER;case d.NEW_ORDER:return o("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.NEW_ORDER;case d.PENDING_PAYMENT:return o("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.PENDING_PAYMENT;case d.PAID:return o("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.PAID;case d.ORDER_COMPLETE:return o("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.ORDER_COMPLETE;case d.IMPORTANT:return o("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.IMPORTANT;case d.FOLLOW_UP:return o("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.FOLLOW_UP;default:return o("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.LEAD}},_=function(t){switch(t){case u.NEW_CUSTOMER:return c.NEW_CUSTOMER;case u.NEW_ORDER:case o("WAWebCTWAConstants").DETECTED_OUTCOME_NEW_ORDER_PREDEFINED_ID:return c.NEW_ORDER;case u.PENDING_PAYMENT:return c.PENDING_PAYMENT;case u.PAID:return c.PAID;case u.ORDER_COMPLETE:return c.ORDER_COMPLETE;case u.IMPORTANT:return c.IMPORTANT;case u.FOLLOW_UP:return c.FOLLOW_UP;case u.LEAD:case o("WAWebCTWAConstants").DETECTED_OUTCOME_LEAD_PREDEFINED_ID:return c.LEAD;default:return}},f=100,g=72;l.ANDROID_LABEL_COLOR_PALETTE=e,l.IPHONE_LABEL_COLOR_PALETTE=s,l.PREDEFINED_LABEL_IDS=u,l.PREDEFINED_LABEL_NAMES=c,l.mapLabelNameToPredefinedId=m,l.mapCustomLabelSubtypeToCTWALabelType=p,l.mapPredefinedIdToLabelName=_,l.LABEL_NAME_MAX_LENGTH=f,l.LISTS_ROW_HEIGHT=g}),98);
__d("WAWebListUtils",["fbt","WAWebBizGatingUtils","WAWebChatCollection","WAWebChatGetters","WAWebChatSearchFilters","WAWebConnModel","WAWebLabelCollection","WAWebLabelConstants","WAWebMobilePlatforms","WAWebSchemaLabel"],(function(t,n,r,o,a,i,l,s){var e=20,u=22;function c(){return o("WAWebConnModel").Conn.platform===o("WAWebMobilePlatforms").PLATFORMS.SMBI?o("WAWebLabelConstants").IPHONE_LABEL_COLOR_PALETTE:o("WAWebLabelConstants").ANDROID_LABEL_COLOR_PALETTE}function d(e){return c()[e]}var m=function(t,n){var e=parseInt(t.id,10),r=parseInt(n.id,10);return Number.isNaN(e)||Number.isNaN(r)?0:e-r},p=function(t){t.sort(m)},_=function(t){if(!o("WAWebBizGatingUtils").isLabelReorderingSyncFromPrimaryEnabled()){p(t);return}t.sort(function(e,t){var n=e.orderIndex-t.orderIndex;return n===0?m(e,t):n})},f=new Set([o("WAWebSchemaLabel").ListType.UNREAD,o("WAWebSchemaLabel").ListType.GROUPS,o("WAWebSchemaLabel").ListType.FAVORITES]);function g(e){return e==null?!1:f.has(e)}function h(){return o("WAWebBizGatingUtils").isCTWADetectedOutcomeWS1Enabled()&&o("WAWebLabelCollection").LabelCollection.getServerAssignedLabelIdMap().size>0?u:e}function y(e){if(o("WAWebBizGatingUtils").isCTWADetectedOutcomeWS1Enabled()){var t=h();return e?s._(/*BTDS*/"No puedes a\u00f1adir m\u00e1s de {max_count} listas",[s._param("max_count",t)]):s._(/*BTDS*/"No puedes a\u00f1adir m\u00e1s de {max_count} etiquetas",[s._param("max_count",t)])}return e?s._(/*BTDS*/"No puedes a\u00f1adir m\u00e1s de 20 listas"):s._(/*BTDS*/"No puedes a\u00f1adir m\u00e1s de 20 etiquetas")}function C(e){var t=s._(/*BTDS*/"Creaste el m\u00e1ximo n\u00famero de listas.");if(o("WAWebBizGatingUtils").isCTWADetectedOutcomeWS1Enabled()){var n=h();return e?t:s._(/*BTDS*/"No puedes a\u00f1adir m\u00e1s de {max_count} etiquetas",[s._param("max_count",n)])}return e?t:s._(/*BTDS*/"No puedes a\u00f1adir m\u00e1s de 20 etiquetas")}var b=function(t,n){var e,r;return t.filter===o("WAWebChatSearchFilters").SearchFilters.UNREAD||t.filter===o("WAWebChatSearchFilters").SearchFilters.GROUP||t.filter===o("WAWebChatSearchFilters").SearchFilters.FAVORITES?(e=n.get(String(t.filter)))!=null?e:0:(r=n.get(String(t.listId)))!=null?r:0};function v(){var e=o("WAWebLabelCollection").LabelCollection.toArray(),t=new Map,n=0,r=0,a=0;return e.forEach(function(e){t.set(e.id,0)}),o("WAWebChatCollection").ChatCollection.forEach(function(e){e.unreadCount!==0&&(e.archive||(n++,o("WAWebChatGetters").getIsGroup(e)&&r++,e.isFavorite&&a++,e.labels!=null&&e.labels.length>0&&(e.labels||[]).forEach(function(e){if(t.has(e)){var n,r=(n=t.get(e))!=null?n:0;t.set(e,r+1)}else t.set(e,1)})))}),t.set(String(o("WAWebChatSearchFilters").SearchFilters.UNREAD),n),t.set(String(o("WAWebChatSearchFilters").SearchFilters.GROUP),r),t.set(String(o("WAWebChatSearchFilters").SearchFilters.FAVORITES),a),t}l.getAllLabelColors=c,l.colorIndexToHex=d,l.sortLabels=_,l.isBuiltInList=g,l.getMaxLabelCount=h,l.getReachMaxLabelCountTextForBizLabelDrawer=y,l.getReachMaxLabelCountText=C,l.getUnreadChatsCountForFilter=b,l.getListsUnreadChatCountMap=v}),226);
__d("WAWebLabelGetters",["WAWebGetters","WAWebGettersCaches","WAWebListUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebGetters").createGetterFactories({createCache:o("WAWebGettersCaches").createLabelsCache}),s=e.field,u=e.computed,c=s("colorIndex"),d=s("color"),m=u(function(e){var t=e[0],n=e[1];if(n!=null)return o("WAWebListUtils").colorIndexToHex(n)},[d,c]);l.getHexColor=m}),98);
__d("WAWebIcLabelFilledIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="ic-label-filled";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=24,R=24;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 24 24",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{d:"m20.175 13.15-3.525 5a1.9 1.9 0 0 1-.712.625A2 2 0 0 1 15 19H5q-.824 0-1.412-.587A1.93 1.93 0 0 1 3 17V7q0-.824.587-1.412A1.93 1.93 0 0 1 5 5h10q.5 0 .938.225t.712.625l3.525 5q.375.525.375 1.15t-.375 1.15",fill:"currentColor"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.IcLabelFilledIcon=m}),98);
__d("WAWebLabelFilledIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="label-filled";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=24,R=24;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 24 24",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M15.393 5C16.314 5 17.167 5.447 17.685 6.182L21.812 12L21.346 12.657L17.686 17.816C17.166 18.553 16.314 19 15.393 19L5.81 18.992C4.262 18.992 3 17.738 3 16.19V7.81C3 6.261 4.262 5.008 5.809 5.008L15.393 5Z"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.LabelFilledIcon=m}),98);
__d("WAWebLabelStackIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="label-stack";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=24,R=24;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 24 24",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{fill:"currentColor",d:"M6.4 4.01c.03-.22.09-.41.17-.57a2.26 2.26 0 0 1 1.85-1.23c.33-.03.87-.04 1.63-.04h5.36l1.2.01a3.14 3.14 0 0 1 2.23 1.1l.74.93 2.05 2.68c.2.26.36.46.45.6a1.23 1.23 0 0 1 .23.76c0 .13-.01.25-.04.36-.04.12-.1.25-.19.39l-.45.61-.2.27a9 9 0 0 0-.41-.56l-.09-.1-2.13-2.78a24 24 0 0 0-.77-.96 4.47 4.47 0 0 0-3.05-1.5c-.3-.02-.7-.03-1.21-.03H8.19c-.77 0-1.3.01-1.61.04l-.19.02Z"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.LabelStackIcon=m}),98);
__d("useWAWebForceUpdate",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useReducer;function u(){var e=s(function(e){return e+1},0),t=e[0],n=e[1];return n}l.useForceUpdateDONOTUSE=u}),98);
__d("WAWebLabels.react",["WAWebABProps","WAWebBizGatingUtils","WAWebEmojiText.react","WAWebIcLabelFilledIcon.react","WAWebLabelCollection","WAWebLabelFilledIcon.react","WAWebLabelGetters","WAWebLabelStackIcon.react","WAWebListsGatingUtils","WAWebUISpacing","WDSText.react","react","stylex","useWAWebForceUpdate","useWAWebListener"],(function(t,n,r,o,a,i,l){var e,s,u,c=u||(u=r("react")),d=(e||(e=o("react"))).useMemo,m={container:{display:"x1rg5ohu",flexShrink:"x2lah0s",verticalAlign:"x16dsc37",$$css:!0},name:{flexShrink:"x2lah0s",fontSize:"x1f6kntn",lineHeight:"xggjnk3",color:"x14ug900",$$css:!0},labelFilter:{maxWidth:"x193iq5w",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0},labelFilterIconContainer:{display:"x78zum5",flexShrink:"x2lah0s",alignItems:"x6s0dn4",justifyContent:"xl56j7k",width:"xvy4d1p",height:"xxk0z11",$$css:!0},labelFilterPillIconContainer:{width:"xw4jnvo",height:"x1qx5ct2",$$css:!0},labelFilterName:{flexGrow:"x1iyjqo2",flexShrink:"xs83m0k",flexBasis:"xdl72j9",overflowX:"x6ikm8r",overflowY:"x10wlt62",lineHeight:"x1o2sk6j",textOverflow:"xlyipyv",whiteSpace:"xuxw1ft",$$css:!0},labelFilterPillName:{color:"xk4n5i7",lineHeight:"x1fc57z9",maxWidth:"x18tx2qf",$$css:!0},drawerTitle:{maxWidth:"x193iq5w",$$css:!0},drawerTitleIconContainer:{flexShrink:"x2lah0s",$$css:!0},drawerTitleName:{flexGrow:"x1iyjqo2",flexShrink:"xs83m0k",flexBasis:"xdl72j9",overflowX:"x6ikm8r",overflowY:"x10wlt62",fontSize:"x1jchvi3",textOverflow:"xlyipyv",whiteSpace:"xuxw1ft",$$css:!0},containerFull:{display:"x3nfvp2",alignItems:"x6s0dn4",$$css:!0},containerFullCircleIcon:{display:"x1rg5ohu",flexShrink:"x2lah0s",marginTop:"x1y332i5",color:"xhslqc4",$$css:!0},circleIconContainer:{display:"x78zum5",alignItems:"x6s0dn4",justifyContent:"xl56j7k",width:"x100vrsf",height:"x1vqgdyp",borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",$$css:!0},circleIcon:{color:"x17t9dm2",$$css:!0},circleIconSVG:{width:"xw4jnvo",height:"x1qx5ct2",$$css:!0},elipsifyName:{overflowX:"x6ikm8r",overflowY:"x10wlt62",whiteSpace:"xuxw1ft",textOverflow:"xlyipyv",maxWidth:"xw5ewwj",$$css:!0},labelStackIcon:{position:"x10l6tqk",top:"xxk6nc9",$$css:!0},nameWdsChip:{marginInlineStart:"x150mmf0",$$css:!0}};function p(e){if(e.length!==0){var t=Math.max.apply(Math,e.map(function(e){return parseInt(e,10)}));return Number.isNaN(t)?e[0]:t.toString()}}function _(e){var t=p(e);return t==null?null:o("WAWebLabelCollection").LabelCollection.get(t)}function f(e){var t=e.color,n=e.name,a=e.renderAsCircle,i=a===void 0?!1:a,l=e.theme,u=e.iconXstyle;if(o("WAWebABProps").getABPropConfigValue("wds_web_chip")&&l==="label-pill")return c.jsxs("div",{className:"x2lah0s x16dsc37 x3nfvp2 x6s0dn4",children:[c.jsx("span",{className:"x78zum5 x2lah0s x6s0dn4 xl56j7k xw4jnvo x1qx5ct2",children:c.jsx(o("WAWebIcLabelFilledIcon.react").IcLabelFilledIcon,{width:18,height:18,style:t!=null?{color:t}:{},iconXstyle:u,xstyle:n!=null&&m.containerFullCircleIcon})}),c.jsx(r("WDSText.react"),{type:"Body2Emphasized",colorName:"accentEmphasized",xstyle:m.nameWdsChip,children:n})]});var d=n!=null?c.jsx("span",babelHelpers.extends({},(s||(s=r("stylex"))).props(m.name,o("WAWebUISpacing").uiMargin.start3,(e.theme==="label-filter"||e.theme==="label-pill")&&m.labelFilterName,e.theme==="label-pill"&&m.labelFilterPillName,(e.theme==="label-filter"||e.theme==="label-pill")&&o("WAWebUISpacing").uiMargin.start8,e.theme==="drawer-title"&&m.drawerTitleName,e.theme==="drawer-title"&&o("WAWebUISpacing").uiMargin.start0,e.theme==="user-profile"&&m.elipsifyName),{children:c.jsx(o("WAWebEmojiText.react").EmojiText,{text:n})})):null,p=(s||(s=r("stylex")))(n==null&&!i&&m.container,i&&m.containerFull,n!=null&&!i&&m.containerFull,l==="label-filter"&&m.labelFilter,l==="drawer-title"&&m.drawerTitle),_=i&&t!=null?{backgroundColor:t}:{},f=i?c.jsx(o("WAWebLabelFilledIcon.react").LabelFilledIcon,{xstyle:m.circleIcon,iconXstyle:m.circleIconSVG}):c.jsx(o("WAWebIcLabelFilledIcon.react").IcLabelFilledIcon,{width:18,height:18,style:t!=null?{color:t}:{},iconXstyle:u,xstyle:n!=null&&m.containerFullCircleIcon});return c.jsxs("div",{className:p,children:[c.jsx("div",{"data-testid":void 0,className:s(i&&m.circleIconContainer,l==="drawer-title"&&m.drawerTitleIconContainer,l==="drawer-title"&&o("WAWebUISpacing").uiMargin.end20,l==="drawer-title"&&o("WAWebUISpacing").uiMargin.start4,(l==="label-filter"||l==="label-pill")&&m.labelFilterIconContainer,l==="label-pill"&&m.labelFilterPillIconContainer),style:_,children:f}),d]})}f.displayName=f.name+" [from "+i.id+"]";function g(e){"use no forget";var t=e.labels,n=e.showName,r=n===void 0?!1:n,a=e.renderAsCircle,i=a===void 0?!1:a,l=e.theme,s=e.iconXstyle,u=o("useWAWebForceUpdate").useForceUpdateDONOTUSE(),g=d(function(){return p(t)},[t]);if(o("useWAWebListener").useListener(g!=null?o("WAWebLabelCollection").LabelCollection:null,"label_updated_"+(g!=null?g:""),u),!o("WAWebBizGatingUtils").canDisplayLabel()&&!o("WAWebListsGatingUtils").isListsEnabled())return null;var h=_(t);if(!h||!h.name)return null;if(t.length===1){var y=o("WAWebLabelGetters").getHexColor(h),C=r?h.name:null;return c.jsx(f,{color:y,name:C,renderAsCircle:i,theme:l,iconXstyle:s})}var b=o("WAWebLabelGetters").getHexColor(h);return c.jsxs("div",{className:"x1rg5ohu x2lah0s x16dsc37 x1n2onr6 xvy4d1p xxk0z11","data-testid":void 0,children:[c.jsx(o("WAWebIcLabelFilledIcon.react").IcLabelFilledIcon,{width:18,height:18,style:b!=null?{color:b}:{},iconXstyle:s,xstyle:m.labelStackIcon}),c.jsx(o("WAWebLabelStackIcon.react").LabelStackIcon,{width:18,height:18,iconXstyle:s,xstyle:m.labelStackIcon})]})}g.displayName=g.name+" [from "+i.id+"]",l.getVisibleLabelId=p,l.Label=f,l.Labels=g}),98);
__d("WAWebBizLabelUtils",["WALogger","WAWebBizGatingUtils","WAWebCTWAConstants","WAWebChatCollection","WAWebChatModel","WAWebContactCollection","WAWebContactModel","WAWebLabelCollection","WAWebListItemParentType","WAWebMsgCollection","WAWebMsgModel","err"],(function(t,n,r,o,a,i,l){var e;function s(e){var t=m(e);e.labels=o("WAWebLabelCollection").LabelCollection.getLabelsForModel(e.id.toString(),t)}function u(e,t,n){t&&t.length>0&&t.forEach(function(t){if(!(o("WAWebBizGatingUtils").isCTWADetectedOutcomeWS1Enabled()&&!o("WAWebBizGatingUtils").isCTWADetectedOutcomeWS4Enabled()&&o("WAWebLabelCollection").LabelCollection.getServerAssignedLabelIdMap().has(t))){var r=t,a=null;if(o("WAWebBizGatingUtils").isCTWADetectedOutcomeWS1Enabled()&&o("WAWebBizGatingUtils").isCTWADetectedOutcomeWS4Enabled()&&o("WAWebLabelCollection").LabelCollection.getServerAssignedLabelIdMap().has(r)){a=o("WAWebLabelCollection").LabelCollection.getServerAssignedLabelIdMap().get(r);var i=_(a);if(i==null)return;r=i}var l=o("WAWebLabelCollection").LabelCollection.gadd({id:r});l.labelItemCollection.gadd({id:p(e,r,n),labelId:r,parentId:e,parentType:n,detectedOutcomeOriginalLabelPredefinedId:a}),n===o("WAWebListItemParentType").LabelItemParentType.Chat&&l.labelItemCollection.gadd({id:p(e,r,o("WAWebListItemParentType").LabelItemParentType.Contact),labelId:r,parentId:e,parentType:o("WAWebListItemParentType").LabelItemParentType.Contact})}})}function c(t,n,r){var a=o("WAWebLabelCollection").LabelCollection.get(n),i=a==null?void 0:a.labelItemCollection;if(!i){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["labelItemCollection does not exist for lableId ",""])),n);return}i.remove(p(t,n,r)),r===o("WAWebListItemParentType").LabelItemParentType.Chat&&i.remove(p(t,n,o("WAWebListItemParentType").LabelItemParentType.Contact))}function d(e){switch(e){case o("WAWebListItemParentType").LabelItemParentType.Chat:return o("WAWebChatCollection").ChatCollection;case o("WAWebListItemParentType").LabelItemParentType.Contact:return o("WAWebContactCollection").ContactCollection;case o("WAWebListItemParentType").LabelItemParentType.Msg:return o("WAWebMsgCollection").MsgCollection}}function m(e){if(e instanceof o("WAWebChatModel").Chat)return o("WAWebListItemParentType").LabelItemParentType.Chat;if(e instanceof r("WAWebContactModel"))return o("WAWebListItemParentType").LabelItemParentType.Contact;if(e instanceof o("WAWebMsgModel").Msg)return o("WAWebListItemParentType").LabelItemParentType.Msg;throw r("err")("getParentTypeFromModel: model is invalid")}function p(e,t,n){return e+"_"+t+"_"+n}function _(e){if(e==null)return null;var t=null;switch(e){case o("WAWebCTWAConstants").DETECTED_OUTCOME_NEW_ORDER_PREDEFINED_ID:t=o("WAWebCTWAConstants").NEW_ORDER_PREDEFINED_ID;break;case o("WAWebCTWAConstants").DETECTED_OUTCOME_LEAD_PREDEFINED_ID:t=o("WAWebCTWAConstants").LEAD_PREDEFINED_ID;break;default:return null}var n=o("WAWebLabelCollection").LabelCollection.findFirst(function(e){return e.predefinedId===t});return n!=null?n.id:null}function f(e){var t,n=(t=o("WAWebLabelCollection").LabelCollection.get(e))==null?void 0:t.predefinedId,r=null;switch(n){case o("WAWebCTWAConstants").NEW_ORDER_PREDEFINED_ID:r=o("WAWebCTWAConstants").DETECTED_OUTCOME_NEW_ORDER_PREDEFINED_ID;break;case o("WAWebCTWAConstants").LEAD_PREDEFINED_ID:r=o("WAWebCTWAConstants").DETECTED_OUTCOME_LEAD_PREDEFINED_ID;break;default:r=null}var a=o("WAWebLabelCollection").LabelCollection.getServerAssignedLabelIdMap().entries().find(function(e){var t=e[0],n=e[1];return n===r});return r==null||a==null?null:a[0]}l.initializeLabels=s,l.addToLabelCollection=u,l.removeLabelFromCollection=c,l.getParentCollection=d,l.getParentTypeFromModel=m,l.createLabelItemId=p,l.mapDOLabelPredefinedIdToManualLabelId=_,l.mapManualLabelIdToDetectedOutcomeLabelId=f}),98);
__d("WAWebLabelCollection",["fbt","$InternalEnum","WALogger","WAWebActionToast.react","WAWebAddToFavoritesAction","WAWebBaseCollection","WAWebBizGatingUtils","WAWebBizLabelUtils","WAWebChatCollection","WAWebEditLabelAssociationBridge","WAWebLabelModel","WAWebListItemParentType","WAWebListUtils","WAWebListsGatingUtils","WAWebMsgModel","WAWebNoop","WAWebRemoveFromFavoritesAction","WAWebSchemaLabel","WAWebSchemaLabelAssociation","WAWebToastManager","WAWebWid","lodash","react"],(function(t,n,r,o,a,i,l,s){var e,u,c=["id"],d,m=d||(d=r("react")),p=n("$InternalEnum").Mirrored(["IN_PROGRESS","SUCCESS","ERROR"]);function _(e,t){if(t)switch(e){case p.IN_PROGRESS:return s._(/*BTDS*/"A\u00f1adiendo a la lista\u2026");case p.SUCCESS:return s._(/*BTDS*/"Se a\u00f1adi\u00f3 a la lista");case p.ERROR:return s._(/*BTDS*/"No se pudo a\u00f1adir a la lista")}else switch(e){case p.IN_PROGRESS:return s._(/*BTDS*/"Actualizando la lista\u2026");case p.SUCCESS:return s._(/*BTDS*/"Se actualiz\u00f3 la lista");case p.ERROR:return s._(/*BTDS*/"No se pudo actualizar la lista")}}var f=(function(t){function n(){var e;return e=t.call(this)||this,e.$LabelCollectionImpl$p_1=new Map,e.listenTo(e,"remove",g),e}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.initializeFromCache=function(n){var e=this;if(o("WAWebBizGatingUtils").isCTWADetectedOutcomeWS1Enabled()){var r=n.filter(function(t){var n=t.type===o("WAWebSchemaLabel").ListType.SERVER_ASSIGNED;return n&&e.addToServerAssignedLabelIdMap(t.id,t.predefinedId),!n}),a=r.map(function(e){var t=e.id,n=babelHelpers.objectWithoutPropertiesLoose(e,c);return babelHelpers.extends({id:t},n)});this.add(a)}else t.prototype.initializeFromCache.call(this,n)},a.initializeAssociationsFromCache=function(t){t.forEach(function(e){var t=e.labelId,n=e.associationId,r=e.type;o("WAWebBizLabelUtils").addToLabelCollection(n,[t],r===o("WAWebSchemaLabelAssociation").LabelAssociationType.Jid?o("WAWebListItemParentType").LabelItemParentType.Chat:o("WAWebListItemParentType").LabelItemParentType.Msg)})},a.removeAllLabelsMD=function(t){return this.addOrRemoveLabelsMD((t.labels||[]).map(function(e){return{type:"remove",id:e}}),[t])},a.addOrRemoveLabelsMD=function(t,n){t.forEach(function(e){var t=e.id,a=e.listType,i=e.type;n.forEach(function(e){var n=o("WAWebBizLabelUtils").getParentTypeFromModel(e),l=e.id.toString();a===o("WAWebSchemaLabel").ListType.FAVORITES?e.id instanceof r("WAWebWid")&&(i==="add"?o("WAWebAddToFavoritesAction").addToFavoritesAction([e.id],{suppressToast:!0}).catch(r("WAWebNoop")):o("WAWebRemoveFromFavoritesAction").removeFromFavoritesAction(e.id,{suppressToast:!0}).catch(r("WAWebNoop"))):i==="add"?o("WAWebBizLabelUtils").addToLabelCollection(l,[t],n):o("WAWebBizLabelUtils").removeLabelFromCollection(l,t,n)})})},a.addOrRemoveLabels=function(n,r){var t=this;if(!(n.length===0||r.length===0)){var a=o("WAWebListsGatingUtils").isListsEnabled(),i=a&&r.some(function(e){var t,n;return((t=(n=e.labels)==null?void 0:n.length)!=null?t:0)>0||!(e instanceof o("WAWebMsgModel").Msg)&&e.isFavorite}),l=o("WAWebActionToast.react").genId(),u=new(o("WAWebActionToast.react")).ActionType(a?_(p.IN_PROGRESS,!i):s._(/*BTDS*/"_j{\"*\":\"Cambiando {count} etiquetas\\u2026\",\"_1\":\"Cambiando {count} etiqueta\"}",[s._plural(n.length),s._param("count",n.length)])),c=o("WAWebEditLabelAssociationBridge").editLabelAssociation(this.$LabelCollectionImpl$p_2(n),r).then(function(){t.addOrRemoveLabelsMD(n,r)}).then(function(){return new(o("WAWebActionToast.react")).ActionType(a?_(p.SUCCESS,!i):s._(/*BTDS*/"_j{\"*\":\"{count} etiquetas cambiadas\",\"4\":\"{count} etiqueta cambiada\",\"_1\":\"1 etiqueta cambiada\"}",[s._plural(n.length,"count")]))}).catch(function(t){return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["addingNewLabel dropped"]))).devConsole(t),new(o("WAWebActionToast.react")).ActionType(a?_(p.ERROR,!i):s._(/*BTDS*/"_j{\"*\":\"No se pudieron actualizar algunas etiquetas\",\"_1\":\"No se pudo actualizar la etiqueta\"}",[s._plural(n.length)]))});o("WAWebToastManager").ToastManager.open(m.jsx(o("WAWebActionToast.react").ActionToast,{id:l,initialAction:u,pendingAction:c}))}},a.$LabelCollectionImpl$p_2=function(t){return o("WAWebBizGatingUtils").isCTWADetectedOutcomeWS4Enabled()?t.map(function(e){if(e.type==="remove"){var t=o("WAWebBizLabelUtils").mapManualLabelIdToDetectedOutcomeLabelId(e.id);if(t!=null)return[babelHelpers.extends({},e,{listType:o("WAWebSchemaLabel").ListType.SERVER_ASSIGNED,id:t}),e]}return e}).flat(1):t},a.getLabelsForModel=function(t,n){return this.filter(function(e){return e.labelItemCollection.get(o("WAWebBizLabelUtils").createLabelItemId(t,e.id,n))}).map(function(e){return e.id})},a.getNextAvailableColor=function(){var e=o("WAWebListUtils").getAllLabelColors(),t=this.map(function(e){return e.colorIndex}).sort(function(e,t){return Number(e)-Number(t)});if(t.length===0)return 0;var n=t.findIndex(function(e,t){return e!==t});return n>=0?n:Math.floor(Math.random()*e.length)},a.getChatLabelsWithUnarchivedAssociations=function(){return this.filter(function(e){return e.count===0?!1:e.labelItemCollection.some(function(e){switch(e.parentType){case o("WAWebListItemParentType").LabelItemParentType.Chat:var t=o("WAWebChatCollection").ChatCollection.get(e.parentId);return!(t==null||t.archive===!0||t.isLocked===!0);case o("WAWebListItemParentType").LabelItemParentType.Contact:case o("WAWebListItemParentType").LabelItemParentType.Msg:return!1}})})},a.getActiveLists=function(){return this.filter(function(e){return e.isActive!==!1})},a.getChatLists=function(){return this.filter(function(e){return e.labelItemCollection.length===0?!0:e.labelItemCollection.some(function(e){switch(e.parentType){case o("WAWebListItemParentType").LabelItemParentType.Chat:{var t=o("WAWebChatCollection").ChatCollection.get(e.parentId);return!(t==null||t.isLocked===!0)}case o("WAWebListItemParentType").LabelItemParentType.Contact:case o("WAWebListItemParentType").LabelItemParentType.Msg:return!1}})})},a.getCustomLists=function(){return this.filter(function(e){return e.type===o("WAWebSchemaLabel").ListType.CUSTOM})},a.getServerAssignedLabelIdMap=function(){return this.$LabelCollectionImpl$p_1},a.addToServerAssignedLabelIdMap=function(t,n){n!=null&&!this.$LabelCollectionImpl$p_1.has(t)?this.$LabelCollectionImpl$p_1.set(t,n):n==null&&o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["label sync: malformed mutation, unexpected null predefinedId"])))},n})(o("WAWebBaseCollection").BaseCollection);f.model=o("WAWebLabelModel").Label,f.staleCollection=!0;function g(e){var t=e.labelItemCollection;t.toArray().forEach(function(e){var t=e.parentId,n=e.parentType,a=e.labelId,i=o("WAWebBizLabelUtils").getParentCollection(n).get(t);i&&(i.labels=r("lodash").remove(i.labels,function(e){return e!==a}))})}var h=new f;l.LabelCollection=h}),226);
__d("WAWebLabelItemModel",["WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.parentType=o("WAWebBaseModel").prop(),t.parentId=o("WAWebBaseModel").prop(),t.labelId=o("WAWebBaseModel").prop(),t.detectedOutcomeOriginalLabelPredefinedId=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="labelItem";var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebLabelItemCollection",["WAWebBaseCollection","WAWebBizLabelUtils","WAWebLabelItemModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){var t;return t=e.call(this)||this,t.listenTo(t,"add",s),t.listenTo(t,"remove",u),t}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=r("WAWebLabelItemModel");function s(e){c(e,!0)}function u(e){c(e,!1)}function c(e,t){var n=o("WAWebBizLabelUtils").getParentCollection(e.parentType).get(e.parentId);if(n){var r=n.labels||[];t?r.includes(e.labelId)||(n.labels=[e.labelId].concat(r)):n.labels=r.filter(function(t){return t!==e.labelId})}}l.LabelItemCollection=e}),98);
__d("WAWebLabelModel",["Promise","WAWebBaseModel","WAWebLabelCollection","WAWebLabelItemCollection","WAWebListItemParentType"],(function(t,n,r,o,a,i,l){var e,s=(function(t){function r(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.id=o("WAWebBaseModel").prop(),e.name=o("WAWebBaseModel").prop(),e.colorIndex=o("WAWebBaseModel").prop(),e.color=o("WAWebBaseModel").prop(),e.count=o("WAWebBaseModel").prop(0),e.messageCount=o("WAWebBaseModel").prop(0),e.chatCount=o("WAWebBaseModel").prop(0),e.orderIndex=o("WAWebBaseModel").prop(),e.predefinedId=o("WAWebBaseModel").prop(),e.isActive=o("WAWebBaseModel").prop(),e.type=o("WAWebBaseModel").prop(),e.isImmutable=o("WAWebBaseModel").prop(),e.stale=o("WAWebBaseModel").session(!0),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(r,t);var a=r.prototype;return a.initialize=function(){t.prototype.initialize.call(this),this.labelItemCollection=new(o("WAWebLabelItemCollection")).LabelItemCollection,this.$LabelImpl$p_1(),this.listenTo(this,"change:name",this.$LabelImpl$p_1),this.listenTo(this,"change:color",this.$LabelImpl$p_1),this.listenTo(this,"change:colorIndex",this.$LabelImpl$p_1),this.listenTo(this,"change:count",this.$LabelImpl$p_1),this.listenTo(this.labelItemCollection,"add",this.$LabelImpl$p_2),this.listenTo(this.labelItemCollection,"remove",this.$LabelImpl$p_2),this.orderIndex==null&&(this.orderIndex=Number(this.id))},a.findImpl=function(r){return(e||(e=n("Promise"))).resolve({id:r})},a.$LabelImpl$p_1=function(){this.name&&o("WAWebLabelCollection").LabelCollection.trigger("label_updated_"+this.id)},a.$LabelImpl$p_2=function(){var e=this.labelItemCollection.reduce(function(e,t){switch(t.parentType){case o("WAWebListItemParentType").LabelItemParentType.Chat:return e[0]++,e;case o("WAWebListItemParentType").LabelItemParentType.Msg:return e[1]++,e;default:return t.parentType,e}},[0,0]),t=e[0],n=e[1];this.messageCount=n,this.chatCount=t,this.count=t+n},r})(o("WAWebBaseModel").BaseModel);s.Proxy="label";var u=o("WAWebBaseModel").defineModel(s);l.Label=u}),98);
__d("WAWebMemberLabelUtils",[],(function(t,n,r,o,a,i){var e=3e3;function l(){return e}i.getBatchDelayMs=l}),66);
__d("WAWebMemberLabelBulkJob",["Promise","WABatcher","WALogger","WAWebMemberLabelUtils","WAWebSchemaMemberLabel","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(e){return new Map(e)}function d(e,t,n){var r=e.memberLabelMap.get(t);return r!=null&&r.lastEditTimestamp>n.lastEditTimestamp}function m(e){var t=e.chatId,n=e.member,r=e.memberLabel,o=e.prevRecord;if(!o)return{chatId:t,memberLabelMap:new Map([[n,r]])};var a=c(o.memberLabelMap);return d(o,n,r)?o:(a.set(n,r),babelHelpers.extends({},o,{memberLabelMap:a}))}function p(e){var t=e.prevRecord,n=e.member,r=c(t.memberLabelMap);return r.delete(n),babelHelpers.extends({},t,{memberLabelMap:r})}var _=(function(){return o("WABatcher").batch({delayMs:o("WAWebMemberLabelUtils").getBatchDelayMs()},(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=Array.from(new Set(t.map(function(e){return e.data.chatId}))),a=o("WAWebSchemaMemberLabel").getMemberLabelTable(),i=new Map((yield a.bulkGet(r)).filter(Boolean).map(function(e){return[e.chatId,e]})),l=[];for(var c of t){var d=c.type,_=c.data,f=_.chatId,g=_.member,h=_.memberLabel,y=i.get(f),C=null,b=!1;switch(d){case"UPSERT":{if(h==null){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[updateMemberLabelsBatched]: memberLabel is null for upsert operation"]))),l.push(null);continue}C=m({chatId:f,member:g,memberLabel:h,prevRecord:y}),b=!0;break}case"DELETE":{if(!y){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[updateMemberLabelsBatched]: no record found for chat ",""])),f),l.push(null);continue}C=p({prevRecord:y,member:g}),b=!0;break}}C!=null&&i.set(C.chatId,C),l.push(b?c:null)}var v=Array.from(i.values()),S=[],R=[];for(var L of v)L.memberLabelMap.size===0?S.push(L):R.push(L);return yield(u||(u=n("Promise"))).all([a.bulkRemove(S.map(function(e){return e.chatId})),a.bulkCreateOrReplace(R)]),l});return function(e){return t.apply(this,arguments)}})())})();l.updateMemberLabelsBatched=_}),98);
__d("WAWebMemberLabelHistorySync",["Promise","WALogger","WATimeUtils","WAWebBackendApi","WAWebLidMigrationUtils","WAWebMemberLabel.flow","WAWebMemberLabelBridgeApi","WAWebMemberLabelBulkJob","WAWebMemberLabelGating","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p;function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(o("WAWebMemberLabelGating").isMemberLabelInfraEnabled())try{var a=[],i=t.conversations.filter(function(e){var t=o("WAWebWidFactory").createWid(e.id);return t.isGroup()?e.participant.length>0:!1}).flatMap(function(t){var n=o("WAWebWidFactory").createWid(t.id),a=o("WAWebWidToJid").widToGroupJid(n);return t.participant.map(function(t){try{var n;if(t.memberLabel==null)return null;var i=o("WAWebWidFactory").createWid(t.userJid);if(!i)return null;var l=o("WAWebLidMigrationUtils").toUserLid(i);if(!l)return null;var u=o("WAWebWidToJid").userLidtoLidUserJid(l),c=t.memberLabel,d=o("WAWebMemberLabel.flow").castToMemberLabeString(String((n=c==null?void 0:c.label)!=null?n:"")),m=o("WATimeUtils").castToUnixTime(Number(c==null?void 0:c.labelTimestamp));return{chatId:a,member:u,label:d,lastEditTimestamp:m}}catch(t){return r("gkx")("26258")?o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Error processing member label"]))).sendLogs("Failed to handle member label change"):o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Error processing member label: ",""])),t).sendLogs("Failed to handle member label change"),null}}).filter(Boolean)});for(var l of i){var _=l.chatId,f=l.member,g=l.label,h=l.lastEditTimestamp;a.push(o("WAWebMemberLabelBridgeApi").createUpsert(_,f,{label:g,lastEditTimestamp:h}))}if(a.length===0)return;o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[history sync] processing "," member label updates"])),a.length);var y=yield(p||(p=n("Promise"))).all(a.map(o("WAWebMemberLabelBulkJob").updateMemberLabelsBatched)),C=y.filter(Boolean);if(C.length===0)return;o("WAWebBackendApi").frontendFireAndForget("updateMemberLabelCollection",{updates:C}),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[history sync] successfully processed "," member label updates"])),C.length)}catch(e){r("gkx")("26258")?o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Failed to process member labels from history sync"]))).sendLogs("Failed to process member labels from history sync"):o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Failed to process member labels from history sync: ",""])),e).sendLogs("Failed to process member labels from history sync")}}),f.apply(this,arguments)}l.processMemberLabels=_}),98);
__d("WAWebMemberLabelKey",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e){this.chatId=e.chatId,this.member=e.member;var t=[this.chatId,this.member];this.serialized=t.join("_")}var t=e.prototype;return t.toString=function(){return this.serialized},t.equals=function(n){return n instanceof e&&this.toString()===n.toString()},e})();i.default=e}),66);
__d("WAWebMemberLabelBridgeApi",["WALogger","WAWebMemberLabelCollection","WAWebMemberLabelKey"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t){return{type:"DELETE",data:{chatId:e,member:t}}}function c(e,t,n){return{type:"UPSERT",data:{chatId:e,member:t,memberLabel:n}}}var d={updateMemberLabelCollection:function(n){var t=n.updates;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[updateMemberLabelsModel] processing "," updates"])),t.length);var a=[],i=[];t.forEach(function(e){var t=e.type,n=e.data,l=n.chatId,u=n.member,c=n.memberLabel,d=new(r("WAWebMemberLabelKey"))({chatId:l,member:u});switch(t){case"UPSERT":{if(c==null){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[updateMemberLabelsModel] memberLabel is null for upsert operation"])));return}a.push({id:d,label:c.label,lastEditTimestamp:c.lastEditTimestamp});break}case"DELETE":{i.push(d);break}}}),a.length>0&&r("WAWebMemberLabelCollection").add(a,{merge:!0}),i.length>0&&r("WAWebMemberLabelCollection").remove(i)}};l.createDelete=u,l.createUpsert=c,l.MemberLabelBridgeApi=d}),98);
__d("WAWebMemberLabelModel",["WAWebBaseModel","WAWebMemberLabelKey"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.label=o("WAWebBaseModel").prop(),t.lastEditTimestamp=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="memberLabel",e.idClass=r("WAWebMemberLabelKey");var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebMemberLabelActions",["WAWebMemberLabelJob","WAWebMemberLabelKey","WAWebMemberLabelModel","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebMemberLabelJob").getMemberLabelsForGroups({chatId:e});if(t)return Array.from(t.entries()).map(function(t){var n=t[0],o=t[1],a=new(r("WAWebMemberLabelKey"))({chatId:e,member:n}),i=new(r("WAWebMemberLabelModel"));return i.id=a,i.label=o.label,i.lastEditTimestamp=o.lastEditTimestamp,i})}),s.apply(this,arguments)}l.getMemberLabelsForGroupAction=e}),98);
__d("WAWebMemberLabelCollection",["WAExponentialBackoff","WALogger","WAWebBaseCollection","WAWebMemberLabelActions","WAWebMemberLabelModel","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,e.$MemberLabelCollection$p_1=new Map,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.$MemberLabelCollection$p_2=function(t,n){var e=this;t&&t.length>0&&t.filter(Boolean).forEach(function(t){e.trigger(t.id.toString(),n(t))})},i.add=function(n,r){var e=t.prototype.add.call(this,n,r);return this.$MemberLabelCollection$p_2(e,function(e){return e}),e},i.remove=function(n,r){r===void 0&&(r={});var e=t.prototype.remove.call(this,n,r);return this.$MemberLabelCollection$p_2(e,function(){return null}),e},i.initializeLabelsForChat=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this.$MemberLabelCollection$p_1.get(e);if(t!=null)return t;var n=this.$MemberLabelCollection$p_3(e);return this.$MemberLabelCollection$p_1.set(e,n),n});function t(t){return e.apply(this,arguments)}return t})(),i.$MemberLabelCollection$p_3=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=this;try{yield o("WAExponentialBackoff").exponentialBackoff({minTimeout:1e3,retries:3,signal:new AbortController().signal},(function(){var i=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n,i){return o("WAWebMemberLabelActions").getMemberLabelsForGroupAction(t).then(function(e){e!=null&&a.add(e)}).catch(function(a){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[MemberLabelCollection][initialize]: Attempt "," failed for group ",""])),i+1,t).devConsole(a);var l=a instanceof Error?a:r("err")(String(a));return n(l)})});return function(e,t){return i.apply(this,arguments)}})())}catch(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MemberLabelCollection][initialize]: All retries failed for group ",""])),t).devConsole(e),this.$MemberLabelCollection$p_1.delete(t)}});function a(e){return t.apply(this,arguments)}return a})(),a})(o("WAWebBaseCollection").BaseCollection);u.model=r("WAWebMemberLabelModel");var c=new u;l.default=c}),98);
__d("WAWebMessageAssociationUIUtils",["WAWebFrontendMsgGetters","WAWebMessageAssociation.flow","WAWebMsgCollection","WAWebMsgType","WAWebPollCreationUtils","WAWebViewMode.flow","WAWebViewModeUtils"],(function(t,n,r,o,a,i,l){"use strict";var e=new Set([o("WAWebMsgType").MSG_TYPE.ALBUM,o("WAWebMsgType").MSG_TYPE.POLL_CREATION]);function s(t,n,r){return t==null?null:r&&e.has(n)?Math.min.apply(Math,[t].concat(r.map(function(e){var t=e.ack;return t}))):t}function u(e,t){return t===void 0&&(t=o("WAWebViewMode.flow").ViewModeSurface.CHAT),d(o("WAWebMsgCollection").MsgCollection.byParentMessage(e),t)}function c(e,t){return t===void 0&&(t=o("WAWebViewMode.flow").ViewModeSurface.CHAT),o("WAWebMsgCollection").MsgCollection.byChat(e).filter(function(e){var n=e.viewMode;return!o("WAWebViewModeUtils").isViewModeVisibleInSurface(t,n)})}function d(e,t){return e.filter(function(e){var n=e.associationType,r=e.parentMsgKey,a=e.viewMode,i=e.pendingDeleteForMe;return n!=null&&r!=null&&!i&&!o("WAWebViewModeUtils").isViewModeVisibleInSurface(t,a)})}function m(e){var t=e.parentMsgKey,n=e.duringDetach,r=n===void 0?!1:n,o=r?1:0;return u(t).length-o>0}function p(e){var t=e.parentMsg,n=e.duringDetach,r=n===void 0?!1:n;switch(t.type){case o("WAWebMsgType").MSG_TYPE.POLL_CREATION:{var a=o("WAWebFrontendMsgGetters").getAsPollCreation(t);return a==null?!0:a.pollContentType===o("WAWebPollCreationUtils").PollContentType.IMAGE&&u(t.id).length!==a.pollOptions.length}case o("WAWebMsgType").MSG_TYPE.ALBUM:default:return!m({parentMsgKey:t.id,duringDetach:r})}}function _(e){var t=e.associationType;if(!t)return!0;var n=e.parentMsgKey?o("WAWebMsgCollection").MsgCollection.get(e.parentMsgKey):null;switch(t){case o("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_POLL:return n!=null&&n.type===o("WAWebMsgType").MSG_TYPE.POLL_CREATION&&!p({parentMsg:n});default:return!0}}l.getLowestAckState=s,l.getHiddenAssociatedMessages=u,l.getHiddenViewModeMessagesForChat=c,l.filterOutVisibleAssociatedMessages=d,l.shouldHideParentMessage=p,l.shouldDisplayOrphanMessage=_}),98);
__d("WAWebGenerateProtocolMessageEditProto",["WAWebE2EProtoGenerator","WAWebE2EProtoUtils","WAWebMsgType","WAWebProtobufsE2E.pb","err","gkx"],(function(t,n,r,o,a,i,l){function e(e){var t,n=e.json,a=e.contextInfo,i=!!(n.matchedText||n.description||n.title),l,s=(t=n.editMsgType)!=null?t:o("WAWebMsgType").MSG_TYPE.CHAT;switch(s){case o("WAWebMsgType").MSG_TYPE.CHAT:{var u=babelHelpers.extends({},n,{type:o("WAWebMsgType").MSG_TYPE.CHAT,subtype:i?"url":void 0});l=o("WAWebE2EProtoGenerator").getProtobufMessage(u,void 0,a);break}case o("WAWebMsgType").MSG_TYPE.IMAGE:l={imageMessage:{caption:n.caption,contextInfo:a}};break;case o("WAWebMsgType").MSG_TYPE.VIDEO:l={videoMessage:{caption:n.caption,contextInfo:a}};break;case o("WAWebMsgType").MSG_TYPE.DOCUMENT:l={documentWithCaptionMessage:{message:{documentMessage:{caption:n.caption,contextInfo:a}}}};break;default:if(!r("gkx")("26258")&&s===o("WAWebMsgType").MSG_TYPE.AUDIO)l={audioMessage:{}};else throw r("err")("Unsupported edit msg type: "+s)}return{protocolMessage:{key:o("WAWebE2EProtoUtils").encodeKey(n.protocolMessageKey),type:o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.MESSAGE_EDIT,timestampMs:n.latestEditSenderTimestampMs,editedMessage:l}}}l.default=e}),98);
__d("WAWebGetMyAddOnsRPC",["WASmaxNewslettersMyAddOnsRPC","WAWebBackendErrors","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.count,n=e.newsletterJid,r=yield o("WASmaxNewslettersMyAddOnsRPC").sendMyAddOnsRPC({myAddonsLimit:t,myAddonsJid:n});switch(r.name){case"MyAddOnsResponseSuccess":return{messagesByNewsletter:r.value.myAddonsMessages};case"MyAddOnsResponseServerError":{var a=r.value.errorIQErrorInternalServerErrorMixin,i=a.code,l=a.text;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(i),l)}case"MyAddOnsResponseClientError":{var s=r.value.myAddonsClientErrors;switch(s.name){case"ItemNotFoundIQErrorResponse":{var u=s.value.errorIQErrorItemNotFoundMixin,c=u.code,d=u.text;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(c),d)}case"RateLimitedIQErrorResponse":{var m=s.value.errorIQErrorRateOverlimitMixin,p=m.code,_=m.text;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(p),_)}case"BadRequestIQErrorResponse":{var f=s.value.errorIQErrorBadRequestMixin,g=f.code,h=f.text;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(g),h)}case"UnauthorizedIQErrorResponse":{var y=s.value.errorIQErrorNotAuthorizedMixin,C=y.code,b=y.text;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(C),b)}}}}}),s.apply(this,arguments)}l.getMyNewsletterAddOnsRPC=e}),98);
__d("WAWebNewsletterGetMyAddOnsJob",["Promise","WAJobOrchestratorTypes","WAWebCRUDOperationsNewsletterMyVotes","WAWebDBCreateOrUpdateReactions","WAWebGetMyAddOnsRPC","WAWebNewsletterDBUtils","WAWebOrchestratorNonPersistedJob","WAWebPollOptionHashUtils","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getMyNewsletterAddOns",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield o("WAWebGetMyAddOnsRPC").getMyNewsletterAddOnsRPC(e),n=t.messagesByNewsletter;return u(n,e.newsletterJid)}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){var a=t.reduce(function(e,t){var n=t.message,o=t.jid,a=o!=null?o:r;return a==null||n.forEach(function(t){var n=d(t,a);n!=null&&e.reactions.push(n);var r=m(t,a);r!=null&&e.pollVotes.push(r)}),e},{reactions:[],pollVotes:[]});return yield(e||(e=n("Promise"))).all([o("WAWebDBCreateOrUpdateReactions").createOrUpdateReactions(a.reactions),o("WAWebCRUDOperationsNewsletterMyVotes").bulkCreateOrUpdateMyVotes(a.pollVotes)]),a}),c.apply(this,arguments)}function d(e,t){var n,r,a=o("WAWebNewsletterDBUtils").craftNewsletterMsgKeyFromServerId(e.serverId,t).toString(),i=e==null||(n=e.newsletterMyReactionMixin)==null?void 0:n.reactionCode,l=e==null||(r=e.newsletterMyReactionMixin)==null?void 0:r.reactionT;return i==null||l==null?null:{parentMsgKey:a,senderUserJid:o("WAWebUserPrefsMeUser").getMePnUserOrThrow().toString(),reactionText:i,timestamp:l*1e3,orphan:0,msgKey:a}}function m(e,t){var n=e.newsletterMyPollVoteMixin;if(n==null)return null;var r=n.votesT,a=n.votesVote;return{chatJid:t,msgServerId:e.serverId,serverTimestampMs:r*1e3,t:r,msgKey:o("WAWebNewsletterDBUtils").craftNewsletterMsgKeyFromServerId(e.serverId,t).toString(),votes:a.map(function(e){return o("WAWebPollOptionHashUtils").bufferToHex(e.elementValue)})}}l.getMyNewsletterAddOnsJob=s}),98);
__d("WAWebNewsletterLoadingStageManager",["$InternalEnum","WAWebBaseModel","WAWebModelUtils"],(function(t,n,r,o,a,i,l){var e=n("$InternalEnum").Mirrored(["None","Loading","Finished","Failed"]),s=(function(t){function n(){for(var n,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=t.call.apply(t,[this].concat(a))||this,n.stage=o("WAWebModelUtils").prop(e.None),babelHelpers.assertThisInitialized(n)||babelHelpers.assertThisInitialized(n)}babelHelpers.inheritsLoose(n,t);var r=n.prototype;return r.start=function(){this.stage=e.Loading},r.fail=function(){this.stage=e.Failed},r.end=function(){this.stage=e.Finished},n})(o("WAWebBaseModel").BaseModel);s.Proxy="newsletterLoadingStage";var u=o("WAWebBaseModel").defineModel(s),c=new u({id:"1"});l.NewsletterLoadingStage=e,l.NewsletterLoadingStageManager=c}),98);
__d("WAWebBootstrapNewsletter",["WALogger","WAQplTypes","WAWebNewsletterGatingUtils","WAWebNewsletterGetMyAddOnsJob","WAWebNewsletterLoadingStageManager","WAWebPrimaryFeaturesModel","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebQueryAndUpdateNewslettersMetadataAction","WAWebSyncdOrphan","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p=5e3,_=null;function f(){if(o("WAWebNewsletterGatingUtils").isNewsletterEnabled()){if(_!=null)return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[newsletter-bootstrap] Bootstrap already ongoing, returning"]))),_;if(!o("WAWebUserPrefsMultiDevice").getNewsletterWasBootstrapped()){if(o("WAWebNewsletterGatingUtils").isNewsletterEnabledOnPrimary())return _=g(),_;o("WAWebPrimaryFeaturesModel").PrimaryFeatures.on("change:newsletter",function(){if(o("WAWebNewsletterGatingUtils").isNewsletterEnabledOnPrimary())return _=g(),_})}}}function g(){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[newsletter-bootstrap] Bootstrap started"])));var e=o("WAWebQplQuickPerformanceLoggerModule").QPL.markerStart(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.NEWSLETTER_BOOSTRAP);o("WAWebNewsletterLoadingStageManager").NewsletterLoadingStageManager.start();try{var t=yield o("WAWebQueryAndUpdateNewslettersMetadataAction").queryAndUpdateAllNewsletterMetadataAction(o("WAWebQueryAndUpdateNewslettersMetadataAction").NewsletterMetadataUpdateEntryPoint.Bootstrap,{messageCount:1,addSystemMsgs:!0,qplEvent:e});o("WAWebNewsletterGatingUtils").isNewsletterReactionEnabled()&&(yield o("WAWebNewsletterGetMyAddOnsJob").getMyNewsletterAddOnsJob({count:p}).catch(function(e){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Failed to retrieve my reactions on bootstrap"]))).tags("newsletter").devConsole(e).sendLogs("newsletter-bootstrap-my-reactions-failed")})),o("WAWebUserPrefsMultiDevice").setNewsletterWasBootstrapped(),t.success?(yield o("WAWebSyncdOrphan").checkOrphanChats(t.chats.map(function(e){return e.id.toString()})),o("WAWebNewsletterLoadingStageManager").NewsletterLoadingStageManager.end(),e.end(o("WAQplTypes").QuickLogActionType.SUCCESS),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[newsletter-bootstrap] Bootstrap completed"])))):(e.end(o("WAQplTypes").QuickLogActionType.FAIL),o("WAWebNewsletterLoadingStageManager").NewsletterLoadingStageManager.fail(),o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[newsletter-bootstrap] Bootstrap failed"]))).tags("newsletter").sendLogs("newsletter-bootstrap-failed"))}catch(t){e.end(o("WAQplTypes").QuickLogActionType.FAIL),o("WAWebNewsletterLoadingStageManager").NewsletterLoadingStageManager.fail(),o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[newsletter-bootstrap] Bootstrap failed"]))).tags("newsletter").devConsole(t).sendLogs("newsletter-bootstrap-failed")}finally{_=null}}),h.apply(this,arguments)}l.bootstrapNewsletterBackend=f}),98);
__d("WAWebNewsletterStorageUtils",["WAWebCommonNewsletterEnums","WAWebNewsletterDBConstants"],(function(t,n,r,o,a,i,l){function e(e){switch(e){case o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber:return o("WAWebNewsletterDBConstants").NewsletterDBMembership.Subscriber;case o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin:return o("WAWebNewsletterDBConstants").NewsletterDBMembership.Admin;case o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest:return o("WAWebNewsletterDBConstants").NewsletterDBMembership.Guest;case o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner:return o("WAWebNewsletterDBConstants").NewsletterDBMembership.Owner}}function s(e){switch(e){case o("WAWebCommonNewsletterEnums").NewsletterPrivacy.Public:return 0;case o("WAWebCommonNewsletterEnums").NewsletterPrivacy.Private:return 1}}function u(e){switch(e){case o("WAWebCommonNewsletterEnums").WamoSubStatus.ACTIVE:return 0;case o("WAWebCommonNewsletterEnums").WamoSubStatus.INACTIVE:return 1}}function c(t){var n={id:t.id.toString()};if(t.creationTime!=null&&(n.creationTime=t.creationTime),t.name!=null&&(n.name=t.name),t.nameUpdateTime!=null&&(n.nameUpdateTime=t.nameUpdateTime),t.description!=null&&(n.description=t.description),t.descriptionUpdateTime!=null&&(n.descriptionUpdateTime=t.descriptionUpdateTime),t.handle!=null&&(n.handle=t.handle),t.inviteCode!=null&&(n.inviteCode=t.inviteCode),t.size!=null&&(n.size=t.size),t.verified!=null&&(n.verified=t.verified),t.membershipType!=null&&(n.membershipType=e(t.membershipType)),t.privacy!=null&&(n.privacy=s(t.privacy)),t.website!=null){var r;n.website=(r=t.website)==null?void 0:r.href}return t.reactionCodesSetting!=null&&(n.reactionCodesSetting=t.reactionCodesSetting),t.adminCount!=null&&(n.adminCount=t.adminCount),t.capabilities!=null&&(n.capabilities=new Set(Array.from(t.capabilities).map(function(e){return e}))),t.suspended!=null&&(n.suspended=t.suspended),t.geosuspended!=null&&(n.geosuspended=t.geosuspended),t.terminated!=null&&(n.terminated=t.terminated),t.wamoSubPlanId!=null&&(n.wamoSubPlanId=t.wamoSubPlanId),t.wamoSubStatus!=null&&(n.wamoSubStatus=u(t.wamoSubStatus)),n}l.mapNewsletterMembershipTypeForStorage=e,l.mapNewsletterWamoSubStatusForStorage=u,l.createNewsletterMetadataObjectForStorage=c}),98);
__d("WAWebNewsletterCleanupTasks",["WAWebBackendApi","WAWebCommonNewsletterEnums","WAWebNewsletterDeleteChatJob","WAWebNewsletterStorageUtils","WAWebSchemaNewsletterMetadata","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=o("WAWebNewsletterStorageUtils").mapNewsletterMembershipTypeForStorage(o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest);function s(){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield o("WAWebBackendApi").frontendSendAndReceive("getActiveNewsletter"),n=t==null?void 0:t.toJid(),r=yield o("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().all(),a=r.filter(function(t){return t.membershipType===e&&t.id!==n}).map(function(e){return e.id});yield o("WAWebNewsletterDeleteChatJob").bulkDeleteNewsletterChats(a.map(o("WAWebWidFactory").createWid))}),u.apply(this,arguments)}l.deletePreviewNewsletters=s}),98);
__d("WAWebMexFetchNewsletterDehydratedJobQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={defaultValue:null,kind:"LocalArgument",name:"fetch_wamo_sub"},t={defaultValue:null,kind:"LocalArgument",name:"input"},n=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"XWA2Newsletter",kind:"LinkedField",name:"xwa2_newsletter",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadMetadata",kind:"LinkedField",name:"thread_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"subscribers_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"verification",storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadSettings",kind:"LinkedField",name:"settings",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterReactionCodesSetting",kind:"LinkedField",name:"reaction_codes",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null},{condition:"fetch_wamo_sub",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterWamoSubMetadata",kind:"LinkedField",name:"wamo_sub",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"plan_id",storageKey:null}],storageKey:null}]}],storageKey:null},{condition:"fetch_wamo_sub",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterViewerMetadata",kind:"LinkedField",name:"viewer_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"wamo_sub_status",storageKey:null}],storageKey:null}]}],storageKey:null}];return{fragment:{argumentDefinitions:[e,t],kind:"Fragment",metadata:null,name:"WAWebMexFetchNewsletterDehydratedJobQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,e],kind:"Operation",name:"WAWebMexFetchNewsletterDehydratedJobQuery",selections:n},params:{id:"30328461880085868",metadata:{},name:"WAWebMexFetchNewsletterDehydratedJobQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebMexFetchNewsletterDehydratedJob",["WALogger","WAWebMexClient","WAWebMexFetchNewsletterDehydratedJobQuery.graphql","WAWebWid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t,n){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i){var l=e!==void 0?e:e=n("WAWebMexFetchNewsletterDehydratedJobQuery.graphql"),u=r("WAWebWid").isNewsletter(t)?"JID":"INVITE",c={input:{key:t,type:u,view_role:a},fetch_wamo_sub:i.fetchWamoSub===!0},d=yield o("WAWebMexClient").fetchQuery(l,c);return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] fetched verification, subscribers count and wamo sub for ",""])),t).tags("GQL","MEX").devConsole({response:d}),d}),c.apply(this,arguments)}l.mexGetNewsletterDehydrated=u}),98);
__d("WAWebMexFetchNewsletterJobQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={defaultValue:null,kind:"LocalArgument",name:"fetch_creation_time"},t={defaultValue:null,kind:"LocalArgument",name:"fetch_full_image"},n={defaultValue:null,kind:"LocalArgument",name:"fetch_viewer_metadata"},r={defaultValue:null,kind:"LocalArgument",name:"fetch_wamo_sub"},o={defaultValue:null,kind:"LocalArgument",name:"input"},a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},l=[a,{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"update_time",storageKey:null}],s=[a,i,{alias:null,args:null,kind:"ScalarField",name:"direct_path",storageKey:null}],u=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"XWA2Newsletter",kind:"LinkedField",name:"xwa2_newsletter",plural:!1,selections:[a,{alias:null,args:null,concreteType:"XWA2NewsletterState",kind:"LinkedField",name:"state",plural:!1,selections:[i],storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadMetadata",kind:"LinkedField",name:"thread_metadata",plural:!1,selections:[{condition:"fetch_creation_time",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null}]},{alias:null,args:null,concreteType:"XWA2NewsletterName",kind:"LinkedField",name:"name",plural:!1,selections:l,storageKey:null},{condition:"fetch_full_image",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{kind:"Literal",name:"type",value:"IMAGE"}],concreteType:"XWA2Picture",kind:"LinkedField",name:"picture",plural:!1,selections:s,storageKey:'picture(type:"IMAGE")'}]},{alias:"preview",args:[{kind:"Literal",name:"type",value:"PREVIEW"}],concreteType:"XWA2Picture",kind:"LinkedField",name:"picture",plural:!1,selections:s,storageKey:'picture(type:"PREVIEW")'},{alias:null,args:null,concreteType:"XWA2NewsletterDescription",kind:"LinkedField",name:"description",plural:!1,selections:l,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"invite",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"handle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"subscribers_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"verification",storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadSettings",kind:"LinkedField",name:"settings",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterReactionCodesSetting",kind:"LinkedField",name:"reaction_codes",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null},{condition:"fetch_wamo_sub",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterWamoSubMetadata",kind:"LinkedField",name:"wamo_sub",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"plan_id",storageKey:null}],storageKey:null}]}],storageKey:null},{condition:"fetch_viewer_metadata",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterViewerMetadata",kind:"LinkedField",name:"viewer_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"mute",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{condition:"fetch_wamo_sub",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"wamo_sub_status",storageKey:null}]}],storageKey:null}]}],storageKey:null}];return{fragment:{argumentDefinitions:[e,t,n,r,o],kind:"Fragment",metadata:null,name:"WAWebMexFetchNewsletterJobQuery",selections:u,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[o,n,t,e,r],kind:"Operation",name:"WAWebMexFetchNewsletterJobQuery",selections:u},params:{id:"9305958616175970",metadata:{},name:"WAWebMexFetchNewsletterJobQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebMexFetchNewsletterJob",["WALogger","WAWebMexClient","WAWebMexFetchNewsletterJobQuery.graphql","WAWebWid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t,n){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i){var l=e!==void 0?e:e=n("WAWebMexFetchNewsletterJobQuery.graphql"),u=r("WAWebWid").isNewsletter(t)?"JID":"INVITE",c=u!=="INVITE",d={input:{key:t,type:u,view_role:a},fetch_viewer_metadata:i.fetchViewerMetadata,fetch_full_image:c,fetch_creation_time:i.fetchCreationTime===!0,fetch_wamo_sub:i.fetchWamoSub===!0},m=yield o("WAWebMexClient").fetchQuery(l,d);return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] fetched get newsletter job for ",""])),t).tags("GQL","MEX").devConsole({response:m}),m}),c.apply(this,arguments)}l.mexGetNewsletter=u}),98);
__d("WAWebMexNewsletterParseUtils",["WAJids","WAWebCommonNewsletterEnums","WAWebNewsletterGatingUtils"],(function(t,n,r,o,a,i,l){function e(e){if(e!=null&&(e==null?void 0:e.id)!=null){var t,n,r,a,i,l,v,S,R,L,E,k,I,T,D,x,$,P,N,M,w,A,F,O,B=(t=e.thread_metadata)==null?void 0:t.creation_time,W=(n=e.thread_metadata)==null?void 0:n.invite,q=(r=e.thread_metadata)==null?void 0:r.name,U=(a=e.thread_metadata)==null?void 0:a.subscribers_count,V=(i=e.viewer_metadata)==null?void 0:i.mute,H=(l=e.thread_metadata)==null?void 0:l.verification,G=(v=e.state)==null?void 0:v.type,z=(S=e.thread_metadata)==null?void 0:S.description,j=(R=e.viewer_metadata)==null?void 0:R.role,K=(L=e.thread_metadata)==null?void 0:L.picture,Q=(E=e.thread_metadata)==null?void 0:E.preview,X=(k=e.thread_metadata)==null||(k=k.settings)==null||(k=k.reaction_codes)==null?void 0:k.value,Y=(I=e.thread_metadata)==null||(I=I.wamo_sub)==null?void 0:I.plan_id,J=(T=e.viewer_metadata)==null?void 0:T.wamo_sub_status,Z=babelHelpers.extends({idJid:o("WAJids").toNewsletterJid(e.id),newsletterCreationTimeMetadataMixin:(D=s(B))!=null?D:null,newsletterInviteLinkMetadataMixin:(x=u(W))!=null?x:null,newsletterNameMetadataMixin:($=c(q))!=null?$:null,newsletterSubscribersMetadataMixin:(P=d(U))!=null?P:null,newsletterMutedMetadataMixin:(N=m(V))!=null?N:null,newsletterVerificationMetadataMixin:(M=p(H))!=null?M:null,newsletterStateMetadataMixin:(w=_(G))!=null?w:null,newsletterDescriptionMetadataMixin:(A=f(z))!=null?A:null,newsletterMembershipMetadataMixin:(F=g(j))!=null?F:null,newsletterPictureMetadataMixin:(O=y([K,Q]))!=null?O:null,hasNewsletterLinkedAccountsMetadataMixin:!1,newsletterPrivacyMetadataMixin:null},X!=null&&{newsletterReactionCodesSettingMetadataMixin:h(X)});return o("WAWebNewsletterGatingUtils").isWamoSubExperienceEnabled()&&(Z.newsletterWamoSubPlanIdMetadataMixin=C(Y),Z.newsletterWamoSubStatusMetadataMixin=b(J)),Z}return null}function s(e){if(e!=null)return{creationTimeValue:Number(e)}}function u(e){if(e!=null)return{inviteCode:e}}function c(e){if(e!=null){var t;return{nameId:e.id,nameUpdateTime:Number(e==null?void 0:e.update_time),nameElementValue:(t=e==null?void 0:e.text)!=null?t:""}}}function d(e){if(e!=null)return{subscribersCount:Number(e)}}function m(e){if(e!=null){var t="undefined";return e.toLowerCase()==="off"?t="off":e.toLowerCase()==="on"&&(t="on"),{mutedState:t}}}function p(e){if(e!=null){var t=e.toLowerCase()==="unverified"?"unverified":"verified";return{verificationState:t}}}function _(e){var t;if((e==null?void 0:e.toLowerCase())==="active"?t="active":(e==null?void 0:e.toLowerCase())==="suspended"?t="suspended":(e==null?void 0:e.toLowerCase())==="geosuspended"&&(t="geosuspended"),t!=null)return{stateType:t}}function f(e){var t=e==null?void 0:e.text,n=e==null?void 0:e.update_time;if(e!=null&&t!=null&&n!=null)return{descriptionQueryDescriptionResponseMixin:{id:e.id,updateTime:Number(n),elementValue:t}}}function g(e){if(e!=null){var t;switch(e.toLowerCase()){case"admin":t="admin";break;case"guest":t="guest";break;case"owner":t="owner";break;case"subscriber":t="subscriber";break}if(t!=null)return{membershipType:t}}}function h(e){switch(e){case"ALL":return o("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.All;case"BLOCKLIST":return o("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.Blocklist;case"NONE":return o("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.None;case"BASIC":return o("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.Basic;default:return null}}function y(e){var t=[];for(var n of e)if(n!=null&&n!=null&&n.type!=null){var r=n.type.toLowerCase()==="image"?"image":"preview";n.direct_path!=null&&n.direct_path!==""&&n.id!=null&&n.type!=null?t.push({queryPictureDirectPathOrEmptyResponseMixinGroup:{name:"QueryPictureDirectPathResponse",value:{directPath:n.direct_path,type:r,id:n.id}}}):(n.direct_path===""||n.direct_path==null)&&t.push({queryPictureDirectPathOrEmptyResponseMixinGroup:{name:"QueryPictureEmptyResponse",value:{type:"image"}}})}return{picture:[].concat(t)}}function C(e){if(e!=null)return e}function b(e){if(e!=null)switch(e.toLowerCase()){case"active":return o("WAWebCommonNewsletterEnums").WamoSubStatus.ACTIVE;case"inactive":return o("WAWebCommonNewsletterEnums").WamoSubStatus.INACTIVE;default:return}}l.parseMexNewsletterResponse=e,l.toReactionCodesSettingMixin=h}),98);
__d("WAWebMexNewsletterUtils",["WAJids","WAWebBackendErrors","WAWebCommonNewsletterEnums","WAWebMexFetchNewsletterDehydratedJob","WAWebMexFetchNewsletterJob","WAWebMexNewsletterParseUtils","WAWebNewsletterGatingUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n,r,a,i,l=(t=e.queryPayloadsArgs.jidQueryIQPayload)==null?void 0:t.anyJid,s=(n=e.queryPayloadsArgs.inviteQueryIQPayload)==null?void 0:n.anyKey,c=(r=(a=e.queryPayloadsArgs.jidQueryIQPayload)==null?void 0:a.anyViewRole)!=null?r:(i=e.queryPayloadsArgs.inviteQueryIQPayload)==null?void 0:i.anyViewRole,d=l!=null?l:s;if(d!=null){var m;if(f(e)?m=yield o("WAWebMexFetchNewsletterDehydratedJob").mexGetNewsletterDehydrated(d,u(c),{fetchWamoSub:o("WAWebNewsletterGatingUtils").isWamoSubExperienceEnabled()}):m=yield o("WAWebMexFetchNewsletterJob").mexGetNewsletter(d,u(c),{fetchViewerMetadata:p(e),fetchCreationTime:_("hasNewsletterCreationTimeField",e),fetchWamoSub:o("WAWebNewsletterGatingUtils").isWamoSubExperienceEnabled()}),m==null)return;var g=o("WAWebMexNewsletterParseUtils").parseMexNewsletterResponse(m.xwa2_newsletter);return g}}),s.apply(this,arguments)}function u(e){if(e==null)return"GUEST";switch(e){case"admin":return"ADMIN";case"owner":return"OWNER";case"subscriber":return"SUBSCRIBER";default:return"GUEST"}}function c(e){switch(e){case"OWNER":return o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner;case"SUBSCRIBER":return o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber;case"ADMIN":return o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin;case"GUEST":return o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest}}function d(e){switch(e){case o("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.All:return"ALL";case o("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.Basic:return"BASIC";case o("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.None:return"NONE";case o("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.Blocklist:return"BLOCKLIST"}}function m(e){if(e!=null&&e.id!=null){var t,n,r,a;return((t=e.state)==null?void 0:t.type)==="SUSPENDED"&&(a={error:"423"}),((n=e.state)==null?void 0:n.type)==="NON_EXISTING"&&(r={error:"404"}),{jid:o("WAJids").toNewsletterJid(e.id),subscriberNotFoundMixin:r,newsletterSuspendedErrorMixin:a}}throw new(o("WAWebBackendErrors")).ServerStatusCodeError(500,"unexpected_mex_mutation_response")}function p(e){var t,n,r,o,a=!1,i=!1;return a=(t=e.queryPayloadsArgs.jidQueryIQPayload)==null||(t=t.allNewsletterMetadataIQRequestPayloadMixinArgs)==null?void 0:t.hasNewsletterMutedField,a===!0||(a=(n=e.queryPayloadsArgs.deprecatedInviteQueryIQPayload)==null||(n=n.allNewsletterMetadataIQRequestPayloadMixinArgs)==null?void 0:n.hasNewsletterMutedField,a===!0)||(i=(r=e.queryPayloadsArgs.jidQueryIQPayload)==null||(r=r.allNewsletterMetadataIQRequestPayloadMixinArgs)==null?void 0:r.hasNewsletterMembershipField,i===!0)||(i=(o=e.queryPayloadsArgs.deprecatedInviteQueryIQPayload)==null||(o=o.allNewsletterMetadataIQRequestPayloadMixinArgs)==null?void 0:o.hasNewsletterMembershipField,i===!0)}function _(e,t){var n,r,o,a=(n=(r=t.queryPayloadsArgs.jidQueryIQPayload)==null?void 0:r.allNewsletterMetadataIQRequestPayloadMixinArgs)!=null?n:t.queryPayloadsArgs.inviteQueryIQPayload;return a==null||((o=Object.getOwnPropertyDescriptor(a,e))==null?void 0:o.value)===!0}function f(e){var t=e.queryPayloadsArgs.jidQueryIQPayload;if(t!=null){var n=t.allNewsletterMetadataIQRequestPayloadMixinArgs;return n.hasNewsletterCreationTimeField!==!0&&n.hasNewsletterNameField!==!0&&n.hasNewsletterDescriptionField!==!0&&n.hasNewsletterInviteLinkField!==!0&&n.hasNewsletterHandleField!==!0&&n.hasNewsletterPrivacyField!==!0&&n.hasNewsletterLinkedAccountsField!==!0&&n.hasNewsletterStateField!==!0&&n.newsletterPictureFieldMixinArgs==null&&n.hasNewsletterMembershipField!==!0&&n.hasNewsletterMutedField!==!0&&n.hasNewsletterVerificationField===!0&&n.hasNewsletterSubscribersField===!0}return!1}l.handleMexGetNewsletter=e,l.mapRoleToMembership=c,l.mapReactionCodesSettingToMexInput=d,l.convertMutationResponse=m}),98);
__d("WAWebUserPrefsNewsletter",["$InternalEnum","WAWebNewsletterGatingUtils","WAWebTimedCache","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsKeys","WAWebUserPrefsStore","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(){var e=r("WAWebUserPrefsStore").get(o("WAWebUserPrefsKeys").MD_KEYS.NEWSLETTER_TAB_LAST_SEEN_TIMESTAMP),t=typeof e=="number"?e:0;return t}function s(e){r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").MD_KEYS.NEWSLETTER_TAB_LAST_SEEN_TIMESTAMP,e)}function u(){var e=o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(o("WAWebUserPrefsKeys").KEYS.WA_WEB_CACHED_RECOMMENDED_NEWSLETTERS);return o("WAWebTimedCache").getTimedCacheItemValue(e,o("WAWebNewsletterGatingUtils").getRecommendedNewslettersRefreshInterval())}function c(e){var t=o("WAWebTimedCache").createTimedCacheItem(e);return o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(o("WAWebUserPrefsKeys").KEYS.WA_WEB_CACHED_RECOMMENDED_NEWSLETTERS,t)}var d=n("$InternalEnum").Mirrored(["FULL","LIMITED"]),m=new(o("WAWebTimedCache")).TimedMapCache({mapLoad:function(){return o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(o("WAWebUserPrefsKeys").KEYS.WA_WEB_CACHED_NEWSLETTERS_SUBSCRIBERS)},mapStore:function(t){return o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(o("WAWebUserPrefsKeys").KEYS.WA_WEB_CACHED_NEWSLETTERS_SUBSCRIBERS,t)},getCacheTtlMs:o("WAWebNewsletterGatingUtils").getNewsletterSubscriberListCacheRefreshMs});function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t={view:d.LIMITED,newsletterJid:e},n={view:d.FULL,newsletterJid:e};yield m.remove(t),yield m.remove(n)}),_.apply(this,arguments)}var f=new(o("WAWebTimedCache")).TimedMapCache({mapLoad:function(){return o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(o("WAWebUserPrefsKeys").KEYS.WA_WEB_CACHED_NEWSLETTER_DIRECTORY_PAGES)},mapStore:function(t){return o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(o("WAWebUserPrefsKeys").KEYS.WA_WEB_CACHED_NEWSLETTER_DIRECTORY_PAGES,t)},getCacheTtlMs:o("WAWebNewsletterGatingUtils").getNewsletterDirectoryPageRefreshInterval}),g=new(o("WAWebTimedCache")).TimedMapCache({mapLoad:function(){return o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(o("WAWebUserPrefsKeys").KEYS.WA_WEB_CACHED_NEWSLETTER_DIRECTORY_CATERGORY_PREVIEW)},mapStore:function(t){return o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(o("WAWebUserPrefsKeys").KEYS.WA_WEB_CACHED_NEWSLETTER_DIRECTORY_CATERGORY_PREVIEW,t)},getCacheTtlMs:o("WAWebNewsletterGatingUtils").getNewsletterDirectoryCategoriesPreviewRefreshIntervalMs});l.getNewsletterTabLastSeenTimestamp=e,l.setNewsletterTabLastSeenTimestamp=s,l.getCachedRecommendedNewsletters=u,l.setCachedRecommendedNewsletters=c,l.ValidCachedNewsletterSubscriberKeys=d,l.NewsletterSubscribersCache=m,l.flushCachedNewsletterSubscribers=p,l.NewsletterDirectoryPageCache=f,l.NewsletterDirectoryCategoriesPreviewCache=g}),98);
__d("WAWebMexNewsletterRoleChangeNotificationHandler",["WALogger","WAWebBackendApi","WAWebMexNewsletterUtils","WAWebNewsletterGatingUtils","WAWebNewsletterMetadataJob","WAWebNewsletterStorageUtils","WAWebNewsletterValidationUtils","WAWebUserPrefsMeUser","WAWebUserPrefsNewsletter","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r,a=n.xwa2_notify_newsletter_admin_promote!=null?"promote":"demote",i=(r=n.xwa2_notify_newsletter_admin_promote)!=null?r:n.xwa2_notify_newsletter_admin_demote;if(i==null){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[mex][newsletter][notification][admin-","] Failed to process "," notification, null payload"])),a,a).tags("mex","newsletter").sendLogs("mex-newsletternotification-state-change-fail");return}try{var l=o("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(i.id),u=d(babelHelpers.extends({},i.user));if(!u)return;var c=o("WAWebNewsletterGatingUtils").isNewsletterMultiAdminLidMigrationEnabled()?o("WAWebUserPrefsMeUser").getMeLidUserOrThrow():o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),m=o("WAWebMexNewsletterUtils").mapRoleToMembership(i.user_new_role);if(m==null)return;u.equals(c)?(yield o("WAWebNewsletterMetadataJob").updateNewsletterMetadata({id:l,membershipType:o("WAWebNewsletterStorageUtils").mapNewsletterMembershipTypeForStorage(m)}),o("WAWebBackendApi").frontendFireAndForget("handleMyRoleChangeNotification",{jid:l})):o("WAWebBackendApi").frontendFireAndForget("handleOtherUserRoleChangeNotification",{jid:l,userId:u,newRole:m}),yield o("WAWebUserPrefsNewsletter").flushCachedNewsletterSubscribers(l),o("WAWebBackendApi").frontendFireAndForget("displayRoleChangeDesktopNotification",{notification:n})}catch(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[mex][newsletter][notification][admin-","] Failed to process "," notification, error parsing jid"])),a,a).tags("mex","newsletter").devConsole(e).sendLogs("mex-newsletternotification-state-change-fail-"+a)}}),c.apply(this,arguments)}function d(e){var t=e.id,n=e.pn;if(o("WAWebNewsletterGatingUtils").isNewsletterMultiAdminLidMigrationEnabled())return t==null?void 0:o("WAWebWidFactory").createUserWidOrThrow(t);if(n!=null)return o("WAWebWidFactory").createWid(n)}l.mexHandleNewsletterRoleChange=u,l.getUserIdFromPayload=d}),98);
__d("WAWebMexFetchNewsletterEnforcementsJobQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"newsletter_id"}],t=[{kind:"Variable",name:"channel_id",variableName:"newsletter_id"}],n={alias:null,args:null,kind:"ScalarField",name:"enforcement_creation_time",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"appeal_creation_time",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"appeal_state",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"enforcement_violation_category",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"enforcement_source",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"enforcement_id",storageKey:null},s={kind:"RequiredField",field:l,action:"THROW"},u={alias:null,args:null,kind:"ScalarField",name:"appeal_form_url",storageKey:null},c={alias:null,args:null,concreteType:"XWA2IPViolationReportData",kind:"LinkedField",name:"ip_violation_report_data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"report_fbid",storageKey:null},u,{alias:null,args:null,kind:"ScalarField",name:"reporter_email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reporter_name",storageKey:null}],storageKey:null},d={alias:null,args:null,concreteType:"XWA2EnforcementExtraData",kind:"LinkedField",name:"enforcement_extra_data",plural:!1,selections:[c],storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"server_msg_id",storageKey:null},p={kind:"InlineFragment",selections:[m],type:"XWA2ChannelServerMsgData",abstractKey:null},_={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"enforcement_target_data",plural:!1,selections:[p],storageKey:null},f={alias:null,args:null,concreteType:"XWA2AppealExtraData",kind:"LinkedField",name:"appeal_extra_data",plural:!1,selections:[u],storageKey:null},g={alias:null,args:null,concreteType:"XWA2EnforcingEntityData",kind:"LinkedField",name:"enforcing_entity_data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"enforcement_origin_workflow",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"enforcement_origin_legal_basis",storageKey:null},C={alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"country_codes",storageKey:null},v={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"enforcement_target_data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p],storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebMexFetchNewsletterEnforcementsJobQuery",selections:[{alias:null,args:t,concreteType:"XWA2ChannelEnforcementsResponse",kind:"LinkedField",name:"xwa2_channel_enforcements",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2BaseEnforcementData",kind:"LinkedField",name:"profile_picture_deletions",plural:!0,selections:[n,r,o,a,i,s,d],storageKey:null},{alias:null,args:null,concreteType:"XWA2BaseEnforcementData",kind:"LinkedField",name:"suspensions",plural:!0,selections:[r,n,o,a,s,i,{alias:null,args:null,concreteType:"XWA2EnforcementExtraData",kind:"LinkedField",name:"enforcement_extra_data",plural:!1,selections:[c,_,f],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWA2ViolatingMessagesEnforcementData",kind:"LinkedField",name:"violating_messages",plural:!0,selections:[{alias:null,args:null,concreteType:"XWA2BaseEnforcementData",kind:"LinkedField",name:"base_enforcement_data",plural:!1,selections:[n,r,o,s,a,i,d],storageKey:null},{kind:"RequiredField",field:m,action:"THROW"}],storageKey:null},{alias:null,args:null,concreteType:"XWA2GeosuspendedEnforcementData",kind:"LinkedField",name:"geosuspensions",plural:!0,selections:[{alias:null,args:null,concreteType:"XWA2BaseEnforcementData",kind:"LinkedField",name:"base_enforcement_data",plural:!1,selections:[{kind:"RequiredField",field:n,action:"THROW"},r,o,s,a,i,{alias:null,args:null,concreteType:"XWA2EnforcementExtraData",kind:"LinkedField",name:"enforcement_extra_data",plural:!1,selections:[c,_,f,g,h,y],storageKey:null}],storageKey:null},{kind:"RequiredField",field:C,action:"THROW"},b],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebMexFetchNewsletterEnforcementsJobQuery",selections:[{alias:null,args:t,concreteType:"XWA2ChannelEnforcementsResponse",kind:"LinkedField",name:"xwa2_channel_enforcements",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2BaseEnforcementData",kind:"LinkedField",name:"profile_picture_deletions",plural:!0,selections:[n,r,o,a,i,l,d],storageKey:null},{alias:null,args:null,concreteType:"XWA2BaseEnforcementData",kind:"LinkedField",name:"suspensions",plural:!0,selections:[r,n,o,a,l,i,{alias:null,args:null,concreteType:"XWA2EnforcementExtraData",kind:"LinkedField",name:"enforcement_extra_data",plural:!1,selections:[c,v,f],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWA2ViolatingMessagesEnforcementData",kind:"LinkedField",name:"violating_messages",plural:!0,selections:[{alias:null,args:null,concreteType:"XWA2BaseEnforcementData",kind:"LinkedField",name:"base_enforcement_data",plural:!1,selections:[n,r,o,l,a,i,d],storageKey:null},m],storageKey:null},{alias:null,args:null,concreteType:"XWA2GeosuspendedEnforcementData",kind:"LinkedField",name:"geosuspensions",plural:!0,selections:[{alias:null,args:null,concreteType:"XWA2BaseEnforcementData",kind:"LinkedField",name:"base_enforcement_data",plural:!1,selections:[n,r,o,l,a,i,{alias:null,args:null,concreteType:"XWA2EnforcementExtraData",kind:"LinkedField",name:"enforcement_extra_data",plural:!1,selections:[c,v,f,g,h,y],storageKey:null}],storageKey:null},C,b],storageKey:null}],storageKey:null}]},params:{id:"9808120992618220",metadata:{},name:"WAWebMexFetchNewsletterEnforcementsJobQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebMexFetchNewsletterEnforcementsJob",["WALogger","WATimeUtils","WAWebCommonNewsletterEnums","WAWebCountriesUtils","WAWebLocaleModules","WAWebMexClient","WAWebMexFetchNewsletterEnforcementsJobQuery.graphql","asyncToGeneratorRuntime","filterNulls"],(function(t,n,r,o,a,i,l){var e,s,u,c=e!==void 0?e:e=n("WAWebMexFetchNewsletterEnforcementsJobQuery.graphql");function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t={newsletter_id:e},n=yield o("WAWebMexClient").fetchQuery(c,t);o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER][WA-ICE][DSA] fetched all enforcements"]))).tags("GQL","MEX","wa-ice","DSA").devConsole({newsletterJid:e,response:n});var a=n==null?void 0:n.xwa2_channel_enforcements;if(a==null)return o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER][WA-ICE][DSA] MEX enforcements query returned empty response."]))).tags("GQL","MEX","wa-ice","DSA"),null;var i={profilePictureDeletions:[],suspensions:[],violatingMessages:[],geoSuspensions:[]};if(a.profile_picture_deletions!=null){var l=[];a.profile_picture_deletions.forEach(function(e){p(e)||l.push(f(e,o("WAWebCommonNewsletterEnums").EnforcementType.PROFILE_PICTURE_DELETION))}),i.profilePictureDeletions=l}if(a.suspensions!=null){var d=[];a.suspensions.forEach(function(e){var t;if(!p(e)){var n=f(e,o("WAWebCommonNewsletterEnums").EnforcementType.SUSPEND);n.enforcementType=((t=n.enforcementExtraData)==null||(t=t.enforcementTargetData)==null?void 0:t.serverId)!=null?o("WAWebCommonNewsletterEnums").EnforcementType.SUSPEND_INFORM:o("WAWebCommonNewsletterEnums").EnforcementType.SUSPEND,d.push(n)}}),i.suspensions=d}if(a.violating_messages!=null){var m=[];a.violating_messages.forEach(function(e){p(e.base_enforcement_data)||m.push(babelHelpers.extends({},f(e.base_enforcement_data,o("WAWebCommonNewsletterEnums").EnforcementType.VIOLATING_MSG),{serverId:parseInt(e.server_msg_id,10)}))}),i.violatingMessages=m}var _=a.geosuspensions;if(_!=null){var g=[];yield o("WAWebLocaleModules").getCountryData().then(function(e){_.forEach(function(t){var n,a,i;if(!p(t.base_enforcement_data)){var l=(n=t.country_codes)==null?void 0:n.map(function(t){var n=o("WAWebCountriesUtils").asISOCountryCode(t),r=e[t.toUpperCase()];return n!=null&&r!=null?{countryCode:n,countryName:r}:null}),s=o("WAWebCountriesUtils").asISOCountryCode(t.country_code),u=s!=null?e[s.toUpperCase()]:null,c=u!=null&&s!=null?{countryCode:s,countryName:u}:null,d;l!=null?d=r("filterNulls")(l):c!=null&&(d=[c]);var m=f(t.base_enforcement_data,o("WAWebCommonNewsletterEnums").EnforcementType.GEOSUSPEND);m.enforcementType=((a=m.enforcementExtraData)==null||(a=a.enforcementTargetData)==null?void 0:a.serverId)!=null?o("WAWebCommonNewsletterEnums").EnforcementType.GEOSUSPEND_INFORM:o("WAWebCommonNewsletterEnums").EnforcementType.GEOSUSPEND,d!=null&&((i=d)==null?void 0:i.length)>0&&g.push(babelHelpers.extends({},m,{countryCodes:d}))}})}).finally(function(){i.geoSuspensions=g})}return i}),m.apply(this,arguments)}function p(e){return e.appeal_creation_time==null&&e.appeal_state!=="NOT_APPEALED"&&e.appeal_state!=="NON_APPEALABLE"}function _(e){if(e==null)return null;var t=e==null?void 0:e.ip_violation_report_data,n=e==null?void 0:e.enforcement_target_data,r=e==null?void 0:e.enforcing_entity_data,o=e==null?void 0:e.appeal_extra_data,a=e==null?void 0:e.enforcement_origin_workflow,i=e==null?void 0:e.enforcement_origin_legal_basis,l=null;return t!=null&&(l={ipViolationReportData:{reportFbid:t.report_fbid,appealFormUrl:t.appeal_form_url,reporterEmail:t.reporter_email,reporterName:t.reporter_name}}),n!=null&&(l=babelHelpers.extends({},l,{enforcementTargetData:{serverId:parseInt(n.server_msg_id,10)}})),o!=null&&o.appeal_form_url!=null&&(l=babelHelpers.extends({},l,{appealExtraData:{appealFormUrl:o.appeal_form_url}})),r!=null&&r.name!=null&&(l=babelHelpers.extends({},l,{enforcingEntityData:{name:r.name}})),a!=null&&(l=babelHelpers.extends({},l,{enforcementOriginWorkflow:a})),i!=null&&(l=babelHelpers.extends({},l,{enforcementOriginLegalBasis:i})),l}function f(e,t){var n,r;return{appealCreationTime:o("WATimeUtils").castToUnixTime(parseInt((n=e.appeal_creation_time)!=null?n:0,10)),enforcementCreationTime:o("WATimeUtils").castToUnixTime(parseInt(e.enforcement_creation_time,10)),appealState:e.appeal_state,enforcementViolationCategory:e.enforcement_violation_category,enforcementId:e.enforcement_id,enforcementType:t,enforcementSource:(r=e.enforcement_source)!=null?r:null,enforcementExtraData:_(e.enforcement_extra_data)}}l.mexFetchNewsletterEnforcements=d}),98);
__d("WAWebNewsletterEnforcementAlertModelUtils",["WAWebWidFactory"],(function(t,n,r,o,a,i,l){function e(e,t,n){var r=[],a;return e==null||e.map(function(e){var i,l=(i=e.enforcementExtraData)==null||(i=i.enforcementTargetData)==null?void 0:i.serverId.toString(),s=l!=null?t==null?void 0:t.get(Number(l)):null,u=new Map,c={id:e.enforcementId,chatId:o("WAWebWidFactory").createWid(n),enforcementViolationCategory:e.enforcementViolationCategory,enforcementType:e.enforcementType,enforcementId:e.enforcementId,enforcementExtraData:e.enforcementExtraData,enforcementSource:e.enforcementSource,appealCreationTime:e.appealCreationTime,appealState:e.appealState,appealReason:null,countryCode:null,lastUpdated:Date.now(),serverMsgId:l,msgData:s};l!=null&&s!=null&&u.set(l,c),a={id:e.enforcementId,chatId:o("WAWebWidFactory").createWid(n),enforcementCreationTime:e.enforcementCreationTime,enforcementViolationCategory:e.enforcementViolationCategory,enforcementType:e.enforcementType,enforcementId:e.enforcementId,enforcementExtraData:e.enforcementExtraData,targetMsgMapForEvidence:u,lastUpdated:Date.now(),enforcementSource:e.enforcementSource,countryCodes:[],appeal:c},r.push(a)}),r}function s(e,t,n){var r=new Map;e.map(function(e){var a={id:e.enforcementId,chatId:o("WAWebWidFactory").createWid(n),enforcementViolationCategory:e.enforcementViolationCategory,enforcementType:e.enforcementType,enforcementId:e.enforcementId,enforcementExtraData:e.enforcementExtraData,enforcementSource:e.enforcementSource,appealCreationTime:e.appealCreationTime,appealState:e.appealState,appealReason:null,countryCode:null,lastUpdated:Date.now(),serverMsgId:e.serverId.toString(),msgData:t==null?void 0:t.get(e.serverId)};r.set(e.serverId.toString(),a)});var a=e[0];return a==null?null:{id:a.enforcementId,chatId:o("WAWebWidFactory").createWid(n),enforcementCreationTime:a.enforcementCreationTime,enforcementViolationCategory:a.enforcementViolationCategory,enforcementType:a.enforcementType,enforcementId:a.enforcementId,enforcementExtraData:a.enforcementExtraData,targetMsgMapForEvidence:r,lastUpdated:Date.now(),enforcementSource:a.enforcementSource,countryCodes:[],appeal:{id:a.enforcementId,chatId:o("WAWebWidFactory").createWid(n),enforcementViolationCategory:a.enforcementViolationCategory,enforcementType:a.enforcementType,enforcementId:a.enforcementId,enforcementExtraData:a.enforcementExtraData,enforcementSource:a.enforcementSource,appealCreationTime:a.appealCreationTime,appealState:a.appealState,appealReason:null,countryCode:null,lastUpdated:Date.now(),serverMsgId:a.serverId.toString(),msgData:t==null?void 0:t.get(a.serverId)}}}function u(e,t){var n=[],r;return e==null||e.map(function(e){var a={id:e.enforcementId,chatId:o("WAWebWidFactory").createWid(t),enforcementViolationCategory:e.enforcementViolationCategory,enforcementType:e.enforcementType,enforcementId:e.enforcementId,enforcementExtraData:e.enforcementExtraData,enforcementSource:e.enforcementSource,appealCreationTime:e.appealCreationTime,appealState:e.appealState,appealReason:null,countryCode:null,lastUpdated:Date.now(),serverMsgId:null,msgData:null};r={id:e.enforcementId,chatId:o("WAWebWidFactory").createWid(t),enforcementCreationTime:e.enforcementCreationTime,enforcementViolationCategory:e.enforcementViolationCategory,enforcementType:e.enforcementType,enforcementId:e.enforcementId,enforcementExtraData:e.enforcementExtraData,targetMsgMapForEvidence:null,lastUpdated:Date.now(),enforcementSource:e.enforcementSource,countryCodes:[],appeal:a},n.push(r)}),n}function c(e,t,n){var r=[],a;return e==null||e.map(function(e){var i,l=(i=e.enforcementExtraData)==null||(i=i.enforcementTargetData)==null?void 0:i.serverId.toString(),s=l!=null?t==null?void 0:t.get(Number(l)):null,u=new Map,c={id:e.enforcementId,chatId:o("WAWebWidFactory").createWid(n),enforcementViolationCategory:e.enforcementViolationCategory,enforcementType:e.enforcementType,enforcementId:e.enforcementId,enforcementExtraData:e.enforcementExtraData,enforcementSource:e.enforcementSource,appealCreationTime:e.appealCreationTime,appealState:e.appealState,appealReason:null,countryCode:e.countryCodes,lastUpdated:Date.now(),serverMsgId:l,msgData:s};l!=null&&s!=null&&u.set(l,c),a={id:e.enforcementId,chatId:o("WAWebWidFactory").createWid(n),enforcementCreationTime:e.enforcementCreationTime,enforcementViolationCategory:e.enforcementViolationCategory,enforcementType:e.enforcementType,enforcementId:e.enforcementId,enforcementExtraData:e.enforcementExtraData,targetMsgMapForEvidence:u,lastUpdated:Date.now(),enforcementSource:e.enforcementSource,countryCodes:e.countryCodes,appeal:c},r.push(a)}),r}function d(t,n,r){var o=[];if((t==null?void 0:t.suspensions)!=null&&o.push.apply(o,e(t==null?void 0:t.suspensions,n,r)),(t==null?void 0:t.geoSuspensions)!=null&&o.push.apply(o,c(t==null?void 0:t.geoSuspensions,n,r)),(t==null?void 0:t.profilePictureDeletions)!=null&&o.push.apply(o,u(t==null?void 0:t.profilePictureDeletions,r)),(t==null?void 0:t.violatingMessages)!=null){var a=s(t==null?void 0:t.violatingMessages,n,r);a!=null&&o.push(a)}return o}l.convertNewsletterBaseEnforcementTypeToNewsletterAlert=d}),98);
__d("WAWebGetNewsletterEnforcementAlertsJob",["WAJobOrchestratorTypes","WALogger","WAWebMexFetchNewsletterEnforcementsJob","WAWebNewsletterEnforcementAlertModelUtils","WAWebOrchestratorNonPersistedJob","WAWebSchemaNewsletterMetadata","WAWebSuspendInformDataModelUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(t,r){return r===void 0&&(r=o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION),o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getNewsletterEnforcementAlerts",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var n=yield o("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().get(t);if(n==null)return;var r=yield o("WAWebMexFetchNewsletterEnforcementsJob").mexFetchNewsletterEnforcements(t),a=yield o("WAWebSuspendInformDataModelUtils").populateMsgModels(Array.from(m(r)).sort(function(e,t){return e-t}),t);return{enforcementData:r!=null?o("WAWebNewsletterEnforcementAlertModelUtils").convertNewsletterBaseEnforcementTypeToNewsletterAlert(r,a,t):[],msgModelMap:a}}catch(t){throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] GET list of all enforcements for the given newsletter"]))).tags("GQL","MEX","DSA").devConsole({e:t}),t}}),{priority:r}).waitUntilCompleted()}function u(e){var t,n=e==null||(t=e.filter(function(e){var t;return((t=e.enforcementExtraData)==null||(t=t.enforcementTargetData)==null?void 0:t.serverId)!=null}))==null?void 0:t.map(function(e){var t,n;return(t=(n=e.enforcementExtraData)==null||(n=n.enforcementTargetData)==null?void 0:n.serverId)!=null?t:0});return n!=null&&n.length>0?n:[]}function c(e){var t=e==null?void 0:e.flatMap(function(e){return e.serverId});return t!=null&&t.length>0?t:[]}function d(e){return e==null?[]:e.reduce(function(e,t){var n,r=(n=t.enforcementExtraData)==null||(n=n.enforcementTargetData)==null?void 0:n.serverId;return r!=null&&e.push(r),e},[])}function m(e){if(e==null)return new Set([]);var t=e.suspensions,n=e.violatingMessages,r=e.geoSuspensions;return new Set([].concat(u(t),c(n),d(r)))}l.getNewsletterEnforcementAlerts=s}),98);
__d("WAWebMexCreateNewsletterJobMutation.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},r=[t,{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"update_time",storageKey:null}],o=[t,n,{alias:null,args:null,kind:"ScalarField",name:"direct_path",storageKey:null}],a=[{alias:null,args:[{kind:"Variable",name:"newsletter_input",variableName:"input"}],concreteType:"XWA2Newsletter",kind:"LinkedField",name:"xwa2_newsletter_create",plural:!1,selections:[t,{alias:null,args:null,concreteType:"XWA2NewsletterState",kind:"LinkedField",name:"state",plural:!1,selections:[n],storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadMetadata",kind:"LinkedField",name:"thread_metadata",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterName",kind:"LinkedField",name:"name",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterDescription",kind:"LinkedField",name:"description",plural:!1,selections:r,storageKey:null},{alias:null,args:[{kind:"Literal",name:"type",value:"IMAGE"}],concreteType:"XWA2Picture",kind:"LinkedField",name:"picture",plural:!1,selections:o,storageKey:'picture(type:"IMAGE")'},{alias:"preview",args:[{kind:"Literal",name:"type",value:"PREVIEW"}],concreteType:"XWA2Picture",kind:"LinkedField",name:"picture",plural:!1,selections:o,storageKey:'picture(type:"PREVIEW")'},{alias:null,args:null,kind:"ScalarField",name:"invite",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"handle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"verification",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"subscribers_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterViewerMetadata",kind:"LinkedField",name:"viewer_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"mute",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebMexCreateNewsletterJobMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebMexCreateNewsletterJobMutation",selections:a},params:{id:"8823471724422422",metadata:{},name:"WAWebMexCreateNewsletterJobMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("WAWebMexCreateNewsletterJob",["WALogger","WAWebMexClient","WAWebMexCreateNewsletterJobMutation.graphql","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t,n){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r,a){var i=e!==void 0?e:e=n("WAWebMexCreateNewsletterJobMutation.graphql"),l={input:{name:t,description:r,picture:a}},u=yield o("WAWebMexClient").fetchQuery(i,l);return o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] newsletter created via mex"]))).tags("GQL","MEX").devConsole({response:u}),u}),c.apply(this,arguments)}l.mexCreateNewsletter=u}),98);
__d("WAWebNewsletterCreateQueryJob",["WASmaxNewslettersCreateRPC","WAWebBackendErrors","WAWebMexCreateNewsletterJob","WAWebMexNewsletterParseUtils","WAWebNewsletterRpcUtils","WAWebURLUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){var t=e.name,n=e.description,r=e.picture;return c(t,n,r)}function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.name,n=e.description,r=e.picture,a=[{pictureType:"image"},{pictureType:"preview"}],i=yield o("WASmaxNewslettersCreateRPC").sendCreateRPC({createRequestMixinMixinArgs:{setNameMixinMixinArgs:{nameElementValue:t},setNewDescriptionMixinMixinArgs:n!=null?{descriptionElementValue:n}:void 0,setNewPictureMixinMixinArgs:r!=null?{pictureElementValue:r}:void 0,allNewsletterMetadataIQRequestPayloadMixinArgs:{hasNewsletterCreationTimeField:!0,hasNewsletterNameField:!0,newsletterPictureFieldMixinArgs:{pictureArgs:a},hasNewsletterDescriptionField:!0,hasNewsletterInviteLinkField:!0,hasNewsletterHandleField:!0,hasNewsletterSubscribersField:!0,hasNewsletterPrivacyField:!0,hasNewsletterVerificationField:!0,hasNewsletterLinkedAccountsField:!0,hasNewsletterMembershipField:!0,hasNewsletterMutedField:!0}}});switch(i.name){case"CreateResponseSuccess":return i.value.newsletterNewsletterWithMetadataIQResponsePayloadMixin;case"CreateResponseClientError":{var l=i.value.badRequestOrRateLimitedIQErrorResponseMixinGroup;switch(l.name){case"BadRequestIQErrorResponse":{var s=l.value.errorIQErrorBadRequestMixin,u=s.code,c=s.text;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(u),c)}case"RateLimitedIQErrorResponse":{var d=l.value.errorIQErrorRateOverlimitMixin,m=d.code,p=d.text;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(m),p)}}break}case"CreateResponseServerError":{var _=i.value.errorIQErrorInternalServerErrorMixin,f=_.code,g=_.text;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(f),g)}}}),u.apply(this,arguments)}function c(e,t,n){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a;n!=null&&(a=r("WAWebURLUtils").parseDataURL(n).data);var i=yield o("WAWebNewsletterRpcUtils").runWithBackoff(function(){return o("WAWebMexCreateNewsletterJob").mexCreateNewsletter(e,t,a)});return o("WAWebMexNewsletterParseUtils").parseMexNewsletterResponse(i.xwa2_newsletter_create)}),d.apply(this,arguments)}l.createNewsletterQuery=e}),98);
__d("WAWebNewsletterUpdateNewslettersRecordsJob",["WAJobOrchestratorTypes","WALogger","WAWebOrchestratorNonPersistedJob","WAWebSchemaChat"],(function(t,n,r,o,a,i,l){var e;function s(t){return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["updateNewsletterChatRecords"]))),o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateNewsletterChatRecords",function(){return o("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(t)},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}l.updateNewsletterChatRecords=s}),98);
__d("WAWebNewsletterCreateJob",["WABase64","WAJobOrchestratorTypes","WALogger","WAWebCreateChat","WAWebNewsletterCreateQueryJob","WAWebNewsletterMetadataJob","WAWebNewsletterModelUtils","WAWebNewsletterStorageUtils","WAWebNewsletterSystemMessages","WAWebNewsletterUpdateMsgsRecordsJob","WAWebNewsletterUpdateNewslettersRecordsJob","WAWebOrchestratorNonPersistedJob","WAWebURLUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(t){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("createNewsletter",function(){return o("WAWebNewsletterCreateQueryJob").createNewsletterQuery(t).then((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(t==null)return null;var n=o("WAWebNewsletterModelUtils").mapNewsletterToModels(t),r=n.chat,a=n.metadata;try{var i=o("WAWebNewsletterSystemMessages").genNewsletterCreationSystemMessages({id:r.id,name:r.name,t:a.creationTime,role:a.membershipType});return yield o("WAWebNewsletterUpdateNewslettersRecordsJob").updateNewsletterChatRecords([o("WAWebCreateChat").createNewsletterObjectForStorage(r)]),yield o("WAWebNewsletterUpdateMsgsRecordsJob").addNewsletterMsgsRecords(i),yield o("WAWebNewsletterMetadataJob").updateNewsletterMetadata(o("WAWebNewsletterStorageUtils").createNewsletterMetadataObjectForStorage(a)),{newsletter:t,msgs:i}}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][join-notification] Failed to update the db records"]))).tags("newsletter").devConsole(t).sendLogs("newsletter-join-notification-db-fail")}});return function(e){return t.apply(this,arguments)}})())},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function u(e){if(e==null)return null;var t=r("WAWebURLUtils").parseDataURL(e).data,n=o("WABase64").decodeB64(t);return new Uint8Array(n)}l.createNewsletter=s,l.encodePicture=u}),98);
__d("WAWebdbCRUDOperationsNewsletterReaction",["WAWebModelStorageUtils","WAWebSchemaNewsletterReactions","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){var t=new Map;return e.forEach(function(e){var n=e.parentMsgKey,r=n,o=t.get(r);o?o.serverTimestamp<=e.serverTimestamp&&t.set(r,e):t.set(r,e)}),o("WAWebModelStorageUtils").getStorage().lock(["newsletter-reactions"],(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n=e[0],r=Array.from(t.values()).map(function(e){return e.parentMsgKey}),o=yield n.anyOf(["parentMsgKey"],r);o.forEach(function(e){var n=e.parentMsgKey,r=t.get(n);r&&r.serverTimestamp<=e.serverTimestamp&&t.delete(n)}),yield n.bulkCreateOrReplace(Array.from(t.values()))});return function(t){return e.apply(this,arguments)}})())}function s(e){return o("WAWebModelStorageUtils").getStorage().lock(["newsletter-reactions"],(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t[0],r=e.parentMsgKey,o=yield d(r);if(o)yield n.bulkCreateOrReplace([o]);else{var a=babelHelpers.extends({emojiCountMap:new Map,serverTimestamp:0},e);yield n.createOrReplace(a)}});return function(e){return t.apply(this,arguments)}})())}function u(e){return o("WAWebSchemaNewsletterReactions").getTable().remove(e)}function c(e){return o("WAWebSchemaNewsletterReactions").getTable().bulkRemove(e)}function d(e){return o("WAWebSchemaNewsletterReactions").getTable().get(e)}l.createOrUpdateNewsletterReactions=e,l.createOrUpdateNewsletterReaction=s,l.removeNewsletterReactionsForParentMsg=u,l.bulkRemoveNewsletterReactionsForParentMsg=c,l.getNewsletterReaction=d}),98);
__d("WAWebNewsletterDeleteMessageAddOns",["Promise","WAJobOrchestratorTypes","WAWebOrchestratorNonPersistedJob","WAWebSchemaMessage","WAWebdbCRUDOperationsNewsletterReaction","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=[function(e){return o("WAWebdbCRUDOperationsNewsletterReaction").bulkRemoveNewsletterReactionsForParentMsg(e.map(function(e){return e}))}];function u(t){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("deleteNewsletterMessageAddOns",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var r=t.toString(),a=yield o("WAWebSchemaMessage").getMessageTable().startsWithAnyOf(["internalId"],[r]),i=a.map(function(e){return e.id});yield(e||(e=n("Promise"))).all(s.map(function(e){return e(i)}))}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}l.deleteNewsletterMessageAddOns=u}),98);
__d("WAWebNewsletterDeleteChatJob",["Promise","WALogger","WAWebChatDeleteBridge","WAWebNewsletterDeleteMessageAddOns","WAWebOrchestratorNonPersistedJob","WAWebSchemaNewsletterMetadata","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(t){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("deleteNewsletterChat",function(){return t.isNewsletter()?o("WAWebChatDeleteBridge").deleteFromStorage(t):(o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[deleteNewsletterChat][job] Trying to delete a non-newsletter chat"]))).tags("newsletter").devConsole(t).sendLogs("delete-non-newsletter-chat"),(s||(s=n("Promise"))).resolve())}).waitUntilCompleted()}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.map(function(e){return e.toJid()});yield(s||(s=n("Promise"))).all(e.map(function(e){return o("WAWebNewsletterDeleteMessageAddOns").deleteNewsletterMessageAddOns(e)})),yield s.all(e.map(function(e){return o("WAWebChatDeleteBridge").deleteFromStorage(e)})),yield o("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().bulkRemove(t)}),d.apply(this,arguments)}l.deleteNewsletterChat=u,l.bulkDeleteNewsletterChats=c}),98);
__d("WAWebNewsletterGetAdminCapabilitiesJob",["WAJobOrchestratorTypes","WALogger","WAWebMexFetchNewsletterAdminCapabilitiesJob","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(t){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getNewsletterAdminCapabilities",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{return o("WAWebMexFetchNewsletterAdminCapabilitiesJob").mexFetchNewsletterAdminCapabilities(t)}catch(t){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[NEWSLETTER][getNewsletterAdminCapabilities] Fetching admin capabilities failed, returning default value of empty array"]))).devConsole({e:t}),new Set}}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}l.getNewsletterAdminCapabilities=s}),98);
__d("WAWebMexFetchNewsletterAdminCountJobQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"newsletter_id"}],t=[{kind:"Variable",name:"newsletter_id",variableName:"newsletter_id"}],n={alias:null,args:null,kind:"ScalarField",name:"admin_count",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebMexFetchNewsletterAdminCountJobQuery",selections:[{alias:null,args:t,concreteType:"XWA2NewsletterAdmin",kind:"LinkedField",name:"xwa2_newsletter_admin",plural:!1,selections:[n],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebMexFetchNewsletterAdminCountJobQuery",selections:[{alias:null,args:t,concreteType:"XWA2NewsletterAdmin",kind:"LinkedField",name:"xwa2_newsletter_admin",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:"29186079397702825",metadata:{},name:"WAWebMexFetchNewsletterAdminCountJobQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebMexFetchNewsletterAdminCountJob",["WALogger","WAWebMexClient","WAWebMexFetchNewsletterAdminCountJobQuery.graphql","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u=e!==void 0?e:e=n("WAWebMexFetchNewsletterAdminCountJobQuery.graphql");function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n={newsletter_id:e},r=yield o("WAWebMexClient").fetchQuery(u,n);return o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] fetched admin count"]))).tags("GQL","MEX").devConsole({newsletterJid:e,response:r}),(t=r.xwa2_newsletter_admin)==null?void 0:t.admin_count}),d.apply(this,arguments)}l.mexFetchNewsletterAdminCount=c}),98);
__d("WAWebNewsletterGetAdminCountJob",["WAJobOrchestratorTypes","WALogger","WAWebMexFetchNewsletterAdminCountJob","WAWebNewsletterModelUtils","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(t){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getNewsletterAdminCount",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var n=yield o("WAWebMexFetchNewsletterAdminCountJob").mexFetchNewsletterAdminCount(t);return n!=null?n:o("WAWebNewsletterModelUtils").DEFAULT_NEWSLETTER_ADMIN_COUNT}catch(t){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[NEWSLETTER][getNewsletterAdminCount] Fetching admin count failed, returning default value of 0"]))).devConsole({e:t}),o("WAWebNewsletterModelUtils").DEFAULT_NEWSLETTER_ADMIN_COUNT}}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}l.getNewsletterAdminCount=s}),98);
__d("WAWebNewsletterGetMessageUpdatesQuery",["Promise","WANullthrows","WASmaxNewslettersGetNewsletterMessageUpdatesRPC","WATimeUtils","WAWebBackendErrors","WAWebNewsletterRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t){return o("WAWebNewsletterRpcUtils").runWithBackoff(function(){return u(e,t)})}function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){var a=r.since,i=r.count,l=r.cursor,s=yield o("WASmaxNewslettersGetNewsletterMessageUpdatesRPC").sendGetNewsletterMessageUpdatesRPC({iqTo:t,messageUpdatesCount:i,messageUpdatesSince:a,messageUpdatesBeforeOrAfterMixinMixinGroupArgs:d(l)});switch(s.name){case"GetNewsletterMessageUpdatesResponseSuccess":{var u,c=s.value.messageUpdatesMessagesNewsletterMessageResponsePayloadMixin;return{updates:c.message,timestamp:(u=c.t)!=null?u:o("WATimeUtils").unixTime()}}case"GetNewsletterMessageUpdatesResponseServerError":{var m=s.value.errorIQErrorInternalServerErrorMixin,p=m.code,_=m.text;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(p),_)}case"GetNewsletterMessageUpdatesResponseClientError":{var f=s.value.getNewsletterMessageUpdatesClientErrors;switch(f.name){case"ItemNotFoundIQErrorResponse":{var g=f.value.errorIQErrorItemNotFoundMixin,h=g.code,y=g.text;return(e||(e=n("Promise"))).reject(new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(h),y))}case"RateLimitedIQErrorResponse":{var C=f.value.errorIQErrorRateOverlimitMixin,b=C.code,v=C.text;return(e||(e=n("Promise"))).reject(new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(b),v))}case"BadRequestIQErrorResponse":{var S=f.value.errorIQErrorBadRequestMixin,R=S.code,L=S.text;return(e||(e=n("Promise"))).reject(new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(R),L))}case"SuspendedIQErrorResponse":{var E=f.value.errorIQErrorLockedMixin,k=E.code,I=E.text;return(e||(e=n("Promise"))).reject(new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(k),I))}case"UnavailableForLegalReasonsResponse":{var T=f.value.errorIQErrorUnavailableForLegalReasonsGenericMixin,D=T.code,x=T.text;return(e||(e=n("Promise"))).reject(new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(D),x))}}}}}),c.apply(this,arguments)}function d(e){return e.after!=null?{messageUpdatesAfterMixin:{messageUpdatesAfter:e.after}}:{messageUpdatesBeforeMixin:{messageUpdatesBefore:r("WANullthrows")(e.before)}}}l.getNewsletterMessageUpdatesQuery=s}),98);
__d("WAWebNewsletterGetMessageUpdatesJob",["WAJobOrchestratorTypes","WAWebNewsletterBackendAddOnsUtils","WAWebNewsletterGetMessageUpdatesQuery","WAWebOrchestratorNonPersistedJob","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=["ids"];function s(t,r){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getNewsletterMessageUpdates",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var n=r.ids,a=babelHelpers.objectWithoutPropertiesLoose(r,e),i=yield o("WAWebNewsletterGetMessageUpdatesQuery").getNewsletterMessageUpdatesQuery(t,a),l=i.updates,s=i.timestamp,u=yield o("WAWebNewsletterBackendAddOnsUtils").getMsgsAndAddOnsFromUpdates(l,o("WAWebWidFactory").createWid(t),s);return yield o("WAWebNewsletterBackendAddOnsUtils").updateAddOnDbRecords(babelHelpers.extends({},u,{ids:n,timestamp:s})),babelHelpers.extends({},u,{timestamp:s,ids:n})}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}l.getNewsletterMessageUpdates=s}),98);
__d("WAWebNewsletterGetMessagesQueryJob",["Promise","WALogger","WASmaxNewslettersGetNewsletterMessagesRPC","WATimeUtils","WAWebBackendErrors","WAWebNewsletterGatingUtils","WAWebNewsletterQueryUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e){if((e==null?void 0:e.before)!=null)return{beforeMixin:{messagesBefore:e.before}};if((e==null?void 0:e.after)!=null)return{afterMixin:{messagesAfter:e.after}}}function c(e,t,n){var r=o("WAWebNewsletterQueryUtils").getNewsletterMessagesQueryParams(e);return m(r,t,n)}function d(e){var t=e.inviteCode,n=e.messagesCount,r=e.cursor,a=e.qpl,i=o("WAWebNewsletterQueryUtils").getNewsletterMessagesQueryParams(t);return m(i,n,r,a)}function m(e,t,n,r){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r,a,i){var l=u(a);r>o("WAWebNewsletterGatingUtils").getMaxMsgCountFromServer()&&o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[queryNewsletterMessages] "," messages requested"])),r).tags("newsletter").sendLogs("newsletter-server-msg-count-exceeded"),i==null||i.markFetchStart();var c=yield o("WASmaxNewslettersGetNewsletterMessagesRPC").sendGetNewsletterMessagesRPC({queryNewsletterParamsMixinArgs:{queryNewsletterParamsArgs:t},newsletterMessageRequestPayloadMixinArgs:{messagesCount:Math.min(r,o("WAWebNewsletterGatingUtils").getMaxMsgCountFromServer()),messageDirectionsArgs:l}});switch(i==null||i.markFetchEnd(),c.name){case"GetNewsletterMessagesResponseSuccess":{var d=c.value.messagesNewsletterMessageResponsePayloadMixin,m=d.message,p=d.t;return{messages:m,end:m.length<r,timestamp:p!=null?p:o("WATimeUtils").unixTime()}}case"GetNewsletterMessagesResponseClientError":{var _=c.value.getNewsletterMessagesClientErrors;switch(_.name){case"ItemNotFoundIQErrorResponse":{var f=_.value.errorIQErrorItemNotFoundMixin,g=f.text,h=f.code;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(h,g)}case"RateLimitedIQErrorResponse":{var y=_.value.errorIQErrorRateOverlimitMixin,C=y.text,b=y.code;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(b,C)}case"BadRequestIQErrorResponse":{var v=_.value.errorIQErrorBadRequestMixin,S=v.text,R=v.code;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(R,S)}case"SuspendedIQErrorResponse":{var L=_.value.errorIQErrorLockedMixin,E=L.text,k=L.code;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(k,E)}case"UnavailableForLegalReasonsResponse":{var I=_.value.errorIQErrorUnavailableForLegalReasonsGenericMixin,T=I.text,D=I.code;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(D,T)}case"NotAllowedIQErrorResponse":{var x=_.value.errorIQErrorNotAllowedMixin,$=x.text,P=x.code;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(P,$)}}break}case"GetNewsletterMessagesResponseServerError":{var N=c.value.errorIQErrorInternalServerErrorMixin,M=N.code,w=N.text;return(s||(s=n("Promise"))).reject(new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(M),w))}}}),p.apply(this,arguments)}l.queryNewsletterMessagesByJid=c,l.queryNewsletterMessagesByInviteCode=d}),98);
__d("WAWebNewsletterGetMessagesJob",["WAJobOrchestratorTypes","WATimeUtils","WAWebJidToWid","WAWebNewsletterBackendAddOnsUtils","WAWebNewsletterGetMessagesQueryJob","WAWebNewsletterValidationUtils","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t,r){return o("WAWebNewsletterValidationUtils").validateNewsletterJidOrThrow(e),o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getNewsletterMessages",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var n=yield o("WAWebNewsletterGetMessagesQueryJob").queryNewsletterMessagesByJid(e,t,r),a=o("WAWebJidToWid").jidWithTypeToWid({jidType:"newsletter",newsletterJid:e}),i=yield o("WAWebNewsletterBackendAddOnsUtils").getMsgsAndAddOnsFromUpdates(n.messages,a,n.timestamp);return babelHelpers.extends({},i,{timestamp:o("WATimeUtils").castToUnixTime(n.timestamp)})}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}l.getNewsletterMessages=e}),98);
__d("WAWebMexFetchAllNewslettersMetadataJobQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"fetch_wamo_sub"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},r=[t,{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"update_time",storageKey:null}],o=[t,n,{alias:null,args:null,kind:"ScalarField",name:"direct_path",storageKey:null}],a=[{alias:null,args:null,concreteType:"XWA2Newsletter",kind:"LinkedField",name:"xwa2_newsletter_subscribed",plural:!0,selections:[t,{alias:null,args:null,concreteType:"XWA2NewsletterState",kind:"LinkedField",name:"state",plural:!1,selections:[n],storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadMetadata",kind:"LinkedField",name:"thread_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterName",kind:"LinkedField",name:"name",plural:!1,selections:r,storageKey:null},{alias:null,args:[{kind:"Literal",name:"type",value:"IMAGE"}],concreteType:"XWA2Picture",kind:"LinkedField",name:"picture",plural:!1,selections:o,storageKey:'picture(type:"IMAGE")'},{alias:"preview",args:[{kind:"Literal",name:"type",value:"PREVIEW"}],concreteType:"XWA2Picture",kind:"LinkedField",name:"picture",plural:!1,selections:o,storageKey:'picture(type:"PREVIEW")'},{alias:null,args:null,concreteType:"XWA2NewsletterDescription",kind:"LinkedField",name:"description",plural:!1,selections:r,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"invite",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"handle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"verification",storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadSettings",kind:"LinkedField",name:"settings",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterReactionCodesSetting",kind:"LinkedField",name:"reaction_codes",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null},{condition:"fetch_wamo_sub",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterWamoSubMetadata",kind:"LinkedField",name:"wamo_sub",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"plan_id",storageKey:null}],storageKey:null}]}],storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterViewerMetadata",kind:"LinkedField",name:"viewer_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"mute",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{condition:"fetch_wamo_sub",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"wamo_sub_status",storageKey:null}]}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebMexFetchAllNewslettersMetadataJobQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebMexFetchAllNewslettersMetadataJobQuery",selections:a},params:{id:"10041060382573821",metadata:{},name:"WAWebMexFetchAllNewslettersMetadataJobQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebMexFetchAllNewslettersMetadataJob",["WALogger","WAWebBackendErrors","WAWebMexClient","WAWebMexFetchAllNewslettersMetadataJobQuery.graphql","WAWebMexNewsletterParseUtils","WAWebNewsletterGatingUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=e!==void 0?e:e=n("WAWebMexFetchAllNewslettersMetadataJobQuery.graphql"),a=yield o("WAWebMexClient").fetchQuery(r,{fetch_wamo_sub:(t==null?void 0:t.fetchWamoSub)===!0});return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] fetched all newsletters job"]))).tags("GQL","MEX").devConsole({response:a}),a}),c.apply(this,arguments)}function d(){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield u({fetchWamoSub:o("WAWebNewsletterGatingUtils").isWamoSubExperienceEnabled()}),t=e==null?void 0:e.xwa2_newsletter_subscribed;if(e==null||t==null)throw new(o("WAWebBackendErrors")).ServerStatusCodeError(500,"Mex unexpected null response for fetching all metadata");if(t.length===0)return{newsletters:[]};var n=[],r=[];return t.filter(function(e){return e!=null}).map(function(e){var t=o("WAWebMexNewsletterParseUtils").parseMexNewsletterResponse(e);if(t!=null){var a;(e==null||(a=e.state)==null?void 0:a.type)==="DELETED"?t!=null&&r.push({jid:t.idJid}):n.push(t)}}),n.length>0||r.length>0?{newsletters:n,deletedNewsletters:r.length>0?{id:r}:null}:{newsletters:[]}}),m.apply(this,arguments)}l.mexFetchAllNewsletters=u,l.handleMexGetAllNewsletters=d}),98);
__d("WAWebMexUpdateNewsletterJobMutation.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"newsletter_id"},{defaultValue:null,kind:"LocalArgument",name:"updates"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},r=[t,{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"update_time",storageKey:null}],o=[t,n,{alias:null,args:null,kind:"ScalarField",name:"direct_path",storageKey:null}],a=[{alias:null,args:[{kind:"Variable",name:"newsletter_id",variableName:"newsletter_id"},{kind:"Variable",name:"updates",variableName:"updates"}],concreteType:"XWA2Newsletter",kind:"LinkedField",name:"xwa2_newsletter_update",plural:!1,selections:[t,{alias:null,args:null,concreteType:"XWA2NewsletterState",kind:"LinkedField",name:"state",plural:!1,selections:[n],storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadMetadata",kind:"LinkedField",name:"thread_metadata",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterName",kind:"LinkedField",name:"name",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterDescription",kind:"LinkedField",name:"description",plural:!1,selections:r,storageKey:null},{alias:null,args:[{kind:"Literal",name:"type",value:"IMAGE"}],concreteType:"XWA2Picture",kind:"LinkedField",name:"picture",plural:!1,selections:o,storageKey:'picture(type:"IMAGE")'},{alias:"preview",args:[{kind:"Literal",name:"type",value:"PREVIEW"}],concreteType:"XWA2Picture",kind:"LinkedField",name:"picture",plural:!1,selections:o,storageKey:'picture(type:"PREVIEW")'},{alias:null,args:null,kind:"ScalarField",name:"invite",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"handle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"verification",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadSettings",kind:"LinkedField",name:"settings",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterReactionCodesSetting",kind:"LinkedField",name:"reaction_codes",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebMexUpdateNewsletterJobMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebMexUpdateNewsletterJobMutation",selections:a},params:{id:"24250201037901610",metadata:{},name:"WAWebMexUpdateNewsletterJobMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("WAWebMexUpdateNewsletterJob",["WALogger","WAWebMexClient","WAWebMexNewsletterUtils","WAWebMexUpdateNewsletterJobMutation.graphql","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t,n,r,o){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r,a,i,l){var u=e!==void 0?e:e=n("WAWebMexUpdateNewsletterJobMutation.graphql"),c={newsletter_id:t,updates:{name:r,description:a,picture:i,settings:l!=null?{reaction_codes:{value:o("WAWebMexNewsletterUtils").mapReactionCodesSettingToMexInput(l)}}:null}},d=yield o("WAWebMexClient").fetchQuery(u,c);return o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] newsletter updated via mex"]))).tags("GQL","MEX").devConsole({response:d}),d}),c.apply(this,arguments)}l.mexUpdateNewsletter=u}),98);
__d("WAWebNewsletterMetadataQueryJob",["WABase64","WAWebMexFetchAllNewslettersMetadataJob","WAWebMexNewsletterParseUtils","WAWebMexNewsletterUtils","WAWebMexUpdateNewsletterJob","WAWebNewsletterQueryUtils","WAWebNewsletterRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(){var e=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebMexFetchAllNewslettersMetadataJob").handleMexGetAllNewsletters()});return function(){return e.apply(this,arguments)}})();return o("WAWebNewsletterRpcUtils").runWithBackoff(e)}function s(e,t){var n=o("WAWebNewsletterQueryUtils").getNewsletterMetadataQueryParamArgs(e,t,{creationTime:!0,name:!0,picture:!0,description:!0,inviteLink:!0,handle:!0,subscribers:!0,privacy:!0,verification:!0,linkedAccounts:!0,state:!0});return o("WAWebNewsletterRpcUtils").runWithBackoff(function(){return c(n)})}function u(e,t,n){var r=o("WAWebNewsletterQueryUtils").getNewsletterMetadataQueryParamArgs(e,t,n);return o("WAWebNewsletterRpcUtils").runWithBackoff(function(){return c(r)})}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebMexNewsletterUtils").handleMexGetNewsletter(e)}),d.apply(this,arguments)}function m(e,t,n){return _(e,t,n)}function p(e){return{idJid:e,newsletterMutedMetadataMixin:null,newsletterCreationTimeMetadataMixin:null,newsletterNameMetadataMixin:null,newsletterPictureMetadataMixin:null,newsletterDescriptionMetadataMixin:null,newsletterInviteLinkMetadataMixin:null,newsletterSubscribersMetadataMixin:null,newsletterPrivacyMetadataMixin:null,newsletterVerificationMetadataMixin:null,hasNewsletterLinkedAccountsMetadataMixin:!1,newsletterMembershipMetadataMixin:null,newsletterStateMetadataMixin:null}}function _(e,t,n){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=t.editName,a=t.editDescription,i=t.editPicture,l=t.editReactionCodesSetting,s=n.name,u=n.description,c=n.picture,d=n.reactionCodesSetting,m;c!=null&&(m=o("WABase64").encodeB64(c));var p=g(i,m),_=g(r,s),f=g(a,u),h=l===!0?d:null,y=yield o("WAWebNewsletterRpcUtils").runWithBackoff(function(){return o("WAWebMexUpdateNewsletterJob").mexUpdateNewsletter(e,_,f,p,h)});return o("WAWebMexNewsletterParseUtils").parseMexNewsletterResponse(y.xwa2_newsletter_update)}),f.apply(this,arguments)}function g(e,t){if(e===!0)return t!=null?t:""}l.queryAllNewslettersMetadata=e,l.queryNewsletterMetadataByInviteCode=s,l.queryNewsletterMetadataByJid=u,l.editNewsletterMetadataQuery=m,l.emptyNewsletterMetadataType=p}),98);
__d("WAWebNewsletterMetadataJob",["Promise","WAJobOrchestratorTypes","WAWebNewsletterCreateJob","WAWebNewsletterMetadataQueryJob","WAWebOrchestratorNonPersistedJob","WAWebSchemaNewsletterMetadata","WAWebSchemaProfilePicThumb","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=["id"],s;function u(){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getAllNewslettersMetadata",function(){return o("WAWebNewsletterMetadataQueryJob").queryAllNewslettersMetadata()},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function c(e,t,n){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getNewsletterMetadata",function(){return o("WAWebNewsletterMetadataQueryJob").queryNewsletterMetadataByJid(e,t,n)},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function d(e){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateNewsletterMetadata",function(){return Array.isArray(e)?o("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().bulkCreateOrMerge(e):o("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().createOrMerge(e.id,e)},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function m(e){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("deleteNewsletterMetadata",function(){return o("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().remove(e)},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function p(e){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("deleteNewsletterPicture",function(){return o("WAWebSchemaProfilePicThumb").getProfilePicThumbTable().remove(e)},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function _(e,t,n){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("editNewsletterMetadata",function(){var r=n.picture,a=o("WAWebNewsletterCreateJob").encodePicture(r);return o("WAWebNewsletterMetadataQueryJob").editNewsletterMetadataQuery(e,t,babelHelpers.extends({},n,{picture:a}))},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function f(t,r,a,i){return i===void 0&&(i=o("WAJobOrchestratorTypes").JOB_PRIORITY.LOW),o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateNewsletterMessageDeliveryUpdates",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var i=yield o("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().get(t);if(i==null)return(s||(s=n("Promise"))).resolve();var l=i.messageDeliveryUpdates,u=l===void 0?new Map:l;return a.forEach(function(e){u==null||u.delete(e)}),r.forEach(function(t){var n=t.id,r=babelHelpers.objectWithoutPropertiesLoose(t,e);u==null||u.set(n,r)}),i.messageDeliveryUpdates=u,o("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().merge(t,i)}),{priority:i}).waitUntilCompleted()}function g(e){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("suspendNewsletter",function(){return o("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().merge(e,{id:e,suspended:!0})},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function h(e){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("geosuspendNewsletter",function(){return o("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().merge(e,{id:e,suspended:!0,geosuspended:!0})},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}l.getAllNewslettersMetadata=u,l.getNewsletterMetadata=c,l.updateNewsletterMetadata=d,l.deleteNewsletterMetadata=m,l.deleteNewsletterPicture=p,l.editNewsletterMetadata=_,l.updateNewsletterMessageDeliveryUpdates=f,l.suspendNewsletter=g,l.geosuspendNewsletter=h}),98);
__d("WAWebNewsletterSendMessageQueryJob",["WASmaxMessagePublishNewsletterRPC","WAStanzaUtils","WAWebNewsletterValidationUtils","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){o("WAWebNewsletterValidationUtils").validateNewsletterJidOrThrow(e.newsletterJid);var t={messageTo:e.newsletterJid,clientNewsletterAndServerOrNewsletterIDMixinGroupArgs:u(e)},n=yield o("WASmaxMessagePublishNewsletterRPC").sendNewsletterRPC(t);switch(n.name){case"NewsletterResponseSuccess":return{success:!0,ack:{t:n.value.newsletterQuestionResponseOrNewsletterMessageAckMixinGroup.value.t},serverId:n.value.newsletterQuestionResponseOrNewsletterMessageAckMixinGroup.value.serverId};case"NewsletterResponseNegative":return{success:!1,ack:{t:n.value.t,error:n.value.error}}}}),s.apply(this,arguments)}function u(e){switch(e.type){case"reaction":return c(e);case"pollVote":return d(e);case"newsletterQuestionResponse":return m(e);default:return{newsletterClientID:p(e)}}}function c(e){var t=e.reactionCode,n=t!=null&&t!==""?{newsletterReaction:{reactionCode:t}}:{isNewsletterReactionRevoke:!0};return{newsletterClientAndServerID:{messageId:o("WAStanzaUtils").toStanzaId(e.messageId),messageServerId:e.parentMsgServerId,newsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroupArgs:n}}}function d(e){var t={voteArgs:e.votes.map(function(e){return{voteElementValue:e}})};return{newsletterClientAndServerID:{messageId:o("WAStanzaUtils").toStanzaId(e.messageId),messageServerId:e.parentMsgServerId,newsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroupArgs:{newsletterPollVote:t}}}}function m(e){return{newsletterClientAndServerID:{messageId:o("WAStanzaUtils").toStanzaId(e.messageId),messageServerId:e.parentMsgServerId,newsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroupArgs:{newsletterQuestionResponsePublish:{payloadMixinArgs:{plaintextElementValue:e.payload}}}}}}function p(e){switch(e.type){case"editText":return{messageId:o("WAStanzaUtils").toStanzaId(e.messageId),newsletterClientIdContentArgs:{newsletterEdit:{hasWAMOSub:e.isWamoSub,newsletterQuestionReplyOrTextOrMediaMixinGroupArgs:{newsletterText:{payloadMixinArgs:{plaintextElementValue:e.payload}}}}}};case"editMedia":{var t=e.contentId==null?null:{senderContentTypeMediaRCATMixinArgs:{plaintextContentId:e.contentId}};return babelHelpers.extends({messageId:o("WAStanzaUtils").toStanzaId(e.messageId)},t,{newsletterClientIdContentArgs:{newsletterEdit:{hasWAMOSub:e.isWamoSub,newsletterQuestionReplyOrTextOrMediaMixinGroupArgs:{newsletterMedia:{payloadMixinArgs:{plaintextElementValue:e.payload},plaintextMediatype:e.mediaType}}}}})}case"revoke":return{messageId:o("WAStanzaUtils").toStanzaId(e.messageId),newsletterClientIdContentArgs:{newsletterRevoke:{hasWAMOSub:e.isWamoSub}}};case"pollCreation":return{messageId:o("WAStanzaUtils").toStanzaId(e.messageId),newsletterClientIdContentArgs:{newsletterPollCreation:{payloadMixinArgs:{plaintextElementValue:e.payload},hasWAMOSub:e.isWamoSub,metaContenttype:e.contentType}}};case"pollResultSnapshot":return{messageId:o("WAStanzaUtils").toStanzaId(e.messageId),newsletterClientIdContentArgs:{newsletterPollResultSnapshot:{payloadMixinArgs:{plaintextElementValue:e.payload},hasWAMOSub:e.isWamoSub}}};case"text":return{messageId:o("WAStanzaUtils").toStanzaId(e.messageId),newsletterClientIdContentArgs:babelHelpers.extends({},_({newsletterText:{payloadMixinArgs:{plaintextElementValue:e.payload},hasWAMOSub:e.isWamoSub}},e.isQuestion,e.questionReplyQuotedMessage))};case"url":return{messageId:o("WAStanzaUtils").toStanzaId(e.messageId),senderContentTypeMediaRCATMixinArgs:{plaintextContentId:e.contentId},newsletterClientIdContentArgs:babelHelpers.extends({},_({newsletterMediaPublish:{plaintextMediatype:e.type,payloadMixinArgs:{plaintextElementValue:e.payload},messageMediaId:e.mediaHandle,hasWAMOSub:e.isWamoSub,messageAssociationTypeMixinArgs:e.messageAssociationTypeMixinArgs}},e.isQuestion,e.questionReplyQuotedMessage))};case"audio":case"avatar_sticker":case"document":case"gif":case"image":case"ptt":case"sticker":case"sticker_pack":case"vcard":case"video":return{messageId:o("WAStanzaUtils").toStanzaId(e.messageId),newsletterClientIdContentArgs:babelHelpers.extends({},_({newsletterMediaPublish:{plaintextMediatype:e.type,payloadMixinArgs:{plaintextElementValue:e.payload},messageMediaId:e.mediaHandle,hasWAMOSub:e.isWamoSub,messageAssociationTypeMixinArgs:e.messageAssociationTypeMixinArgs}},e.isQuestion,e.questionReplyQuotedMessage))};default:throw e.type,r("err")("Wrong code path for "+e.type)}}function _(e,t,n){if(t)return{newsletterQuestionPublish:{newsletterTextOrMediaPublishMixinGroupArgs:e}};if(n){var o,a;if(((o=n.quotedResponse.questionResponseInfo)==null?void 0:o.responseServerId)==null)throw r("err")("Missing response server id for question reply");return{newsletterQuestionReplyPublish:{metaParentServerId:n.questionServerId,metaResponseServerId:(a=n.quotedResponse.questionResponseInfo)==null?void 0:a.responseServerId,newsletterTextOrMediaPublishMixinGroupArgs:e}}}return e}l.querySendNewsletterMessage=e}),98);
__d("WAWebNewsletterSendMessageJob",["Promise","WAJobOrchestratorTypes","WALogger","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebMediaGatingUtils","WAWebMediaMetadata","WAWebMessageAssociation.flow","WAWebMsgType","WAWebNewsletterSendMessageQueryJob","WAWebNewsletterValidationUtils","WAWebOrchestratorNonPersistedJob","WAWebOutgoingMessage","WAWebPollCreationUtils","WAWebProtobufsE2E.pb","WAWebSendMsgTypes","encodeProtobuf","err","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=/[?&]id=([0-9]+)(?=&|#|$)/i;function m(e){if(r("isStringNullOrEmpty")(e))return null;var t=e.match(d);return t?t[1]:null}var p="&";function _(e,t){try{if(e.type!==o("WAWebMsgType").MSG_TYPE.VIDEO||!o("WAWebMediaGatingUtils").isChannelVideoServerTranscodeUploadEnabled())return t;var n=o("WAWebMediaMetadata").mediaMetadata(e),a=n==null?void 0:n.metadataUrl;if(a==null)return t;var i=m(a);if(r("isStringNullOrEmpty")(i))return t;var l=t||"";return l&&(l+=p),l+=i,l}catch(e){return t}}function f(e){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendNewsletterMessage",function(){return h(e)},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function g(e,t){var n=e.type,r=e.msg,a={messageId:r.id.id,newsletterJid:e.newsletterJid,payload:o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsE2E.pb").MessageSpec,t).readByteArrayView(),isWamoSub:r.isWamoSub===!0||void 0};if(n==="pollCreation")return babelHelpers.extends({},a,{type:"pollCreation",contentType:(r==null?void 0:r.pollContentType)===o("WAWebPollCreationUtils").PollContentType.IMAGE?"image":"text"});var i=babelHelpers.extends({},a,{isQuestion:r.isQuestion,questionReplyQuotedMessage:r.questionReplyQuotedMessage});if(n==="media"){var l=_(r,e.mediaHandle);return babelHelpers.extends({},i,{mediaHandle:l,type:C(t),messageAssociationTypeMixinArgs:y(r),contentId:e.contentId})}return babelHelpers.extends({},i,{type:n})}function h(e){switch(o("WAWebNewsletterValidationUtils").validateNewsletterJidOrThrow(e.newsletterJid),e.type){case"edit":{var t=o("WAWebOutgoingMessage").createOutgoingMsgModelProtobuf(o("WAWebOutgoingMessage").OutgoingMessageOriginType.Newsletter,e.msg),a=o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsE2E.pb").MessageSpec,t),i=e.msg.isWamoSub===!0||void 0,l={messageId:e.msg.id.id,newsletterJid:e.newsletterJid,payload:a.readByteArrayView(),isWamoSub:i},s=e.editType==="media"?babelHelpers.extends({},l,{type:"editMedia",mediaType:C(t),contentId:e.contentId}):babelHelpers.extends({},l,{type:"editText"});return o("WAWebNewsletterSendMessageQueryJob").querySendNewsletterMessage(s)}case"pollCreation":case"pollResultSnapshot":case"text":case"media":{var u=o("WAWebOutgoingMessage").createOutgoingMsgModelProtobuf(o("WAWebOutgoingMessage").OutgoingMessageOriginType.Newsletter,e.msg),d=g(e,u);return o("WAWebNewsletterSendMessageQueryJob").querySendNewsletterMessage(d)}case"revoke":return o("WAWebNewsletterSendMessageQueryJob").querySendNewsletterMessage({messageId:e.messageId,newsletterJid:e.newsletterJid,type:"revoke",isContentMedia:e.isContentMedia,isWamoSub:e.isWamoSub===!0||void 0});case"reaction":return o("WAWebNewsletterSendMessageQueryJob").querySendNewsletterMessage({type:"reaction",newsletterJid:e.newsletterJid,reactionCode:e.reactionCode,messageId:e.msg.id.id,parentMsgServerId:e.parentMsgServerId});case"pollVote":return o("WAWebNewsletterSendMessageQueryJob").querySendNewsletterMessage({type:"pollVote",newsletterJid:e.newsletterJid,votes:e.votes,messageId:e.msg.id.id,parentMsgServerId:e.parentMsgServerId});case"newsletterQuestionResponse":{var m=o("WAWebOutgoingMessage").createOutgoingMessageProtobuf(o("WAWebOutgoingMessage").OutgoingMessageOriginType.Newsletter,{type:o("WAWebSendMsgTypes").SendMessageRecordType.Addon,data:e.msg});return o("WAWebNewsletterSendMessageQueryJob").querySendNewsletterMessage({messageId:e.msg.id.id,newsletterJid:e.newsletterJid,payload:o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsE2E.pb").MessageSpec,m).readByteArrayView(),type:"newsletterQuestionResponse",parentMsgServerId:e.parentMsgServerId})}default:return e.type,(c||(c=n("Promise"))).reject(r("err")("Unexpected message type: "+e.type))}}function y(t){var n=t.associationType;if(n==null)return null;switch(n){case o("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_POLL:return{metaMessageAssociationType:"media_poll"};case o("WAWebMessageAssociation.flow").MessageAssociationType.BOT_PLUGIN:case o("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_ALBUM:case o("WAWebMessageAssociation.flow").MessageAssociationType.HD_IMAGE_DUAL_UPLOAD:case o("WAWebMessageAssociation.flow").MessageAssociationType.HD_VIDEO_DUAL_UPLOAD:case o("WAWebMessageAssociation.flow").MessageAssociationType.HEVC_VIDEO_DUAL_UPLOAD:case o("WAWebMessageAssociation.flow").MessageAssociationType.UNKNOWN:return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Unexpected newsletter message association type: ",""])),n).tags("newsletter").devConsole(t).sendLogs("newsletter-message-association-type-"+n),null}}function C(e){var t=o("WAWebBackendJobsCommon").mediaTypeFromProtobuf(e);if(t==null)throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Failed to get media type from protobuf"]))).tags("newsletter").devConsole(e).sendLogs("newsletter-failed-media-type-from-protobuf"),r("err")("Failed to get media type from protobuf");switch(t){case o("WAWebBackendJobs.flow").EncMediaType.Audio:return"audio";case o("WAWebBackendJobs.flow").EncMediaType.Document:return"document";case o("WAWebBackendJobs.flow").EncMediaType.Gif:return"gif";case o("WAWebBackendJobs.flow").EncMediaType.Image:return"image";case o("WAWebBackendJobs.flow").EncMediaType.Ptt:return"ptt";case o("WAWebBackendJobs.flow").EncMediaType.Sticker:return"sticker";case o("WAWebBackendJobs.flow").EncMediaType.Url:return"url";case o("WAWebBackendJobs.flow").EncMediaType.VCard:return"vcard";case o("WAWebBackendJobs.flow").EncMediaType.Video:return"video";case o("WAWebBackendJobs.flow").EncMediaType.StickerPack:return"sticker_pack";default:throw o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Unsupported media type"]))).tags("newsletter").devConsole(e).sendLogs("newsletter-unsupported-media-type-"+t),r("err")("Unsupported media type "+t)}}l.extractVideoIdFromMetadataUrl=m,l.maybeAddVideoIdToMediaHandle=_,l.sendNewsletterMessageJob=f,l.sendNewsletterMessage=h}),98);
__d("WAWebMexUpdateNewsletterUserSettingJobMutation.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"XWA2NewsletterMutationResponse",kind:"LinkedField",name:"xwa2_newsletter_update_user_setting",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterState",kind:"LinkedField",name:"state",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebMexUpdateNewsletterUserSettingJobMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebMexUpdateNewsletterUserSettingJobMutation",selections:t},params:{id:"31938993655691868",metadata:{},name:"WAWebMexUpdateNewsletterUserSettingJobMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("WAWebMexUpdateNewsletterUserSetting",["WALogger","WAWebMexClient","WAWebMexNewsletterUtils","WAWebMexUpdateNewsletterUserSettingJobMutation.graphql","WAWebNewsletterRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u=e!==void 0?e:e=n("WAWebMexUpdateNewsletterUserSettingJobMutation.graphql");function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e[0];return _({newsletter_id:t,type:"MUTE_ADMIN_ACTIVITY",value:"ON"})}),d.apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e[0];return _({newsletter_id:t,type:"MUTE_ADMIN_ACTIVITY",value:"OFF"})}),p.apply(this,arguments)}function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebNewsletterRpcUtils").runWithBackoff(function(){return g(e)}),n=o("WAWebMexNewsletterUtils").convertMutationResponse(t.xwa2_newsletter_update_user_setting);return[n]}),f.apply(this,arguments)}function g(e){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t={input:e},n=yield o("WAWebMexClient").fetchQuery(u,t);return o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] update newsletter notification settings via mex"]))).tags("GQL","MEX").devConsole({response:n}),n}),h.apply(this,arguments)}l.mexMuteNewsletterAdminNotifications=c,l.mexUnmuteNewsletterAdminNotifications=m}),98);
__d("WAWebNewsletterToggleMuteStateJob",["WAJobOrchestratorTypes","WALogger","WAWebMexUpdateNewsletterUserSetting","WAWebMiscErrors","WAWebNewsletterModelUtils","WAWebOrchestratorNonPersistedJob","WAWebSchemaChat","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("muteNewsletter",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d({newsletterJids:e,muteStateMexFunction:o("WAWebMexUpdateNewsletterUserSetting").mexMuteNewsletterAdminNotifications,muteExpirationValue:o("WAWebNewsletterModelUtils").MUTED_STATE})}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function c(e){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("unmuteNewsletter",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d({newsletterJids:e,muteStateMexFunction:o("WAWebMexUpdateNewsletterUserSetting").mexUnmuteNewsletterAdminNotifications,muteExpirationValue:o("WAWebNewsletterModelUtils").UNMUTED_STATE})}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.newsletterJids,r=t.muteStateMexFunction,a=t.muteExpirationValue;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["newsletter setMuteState"])));var i=a===o("WAWebNewsletterModelUtils").MUTED_STATE?"mute":"unmute",l=yield r(n),u=l.filter(function(e){return e.subscriberNotFoundMixin==null}).map(function(e){return e.jid});try{return yield o("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(u.map(function(e){return{id:e,muteExpiration:a}}))}catch(e){throw e instanceof o("WAWebMiscErrors").DbOnLogoutAbort||o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][","Newsletter] Failed to persist the mutation on db"])),i).tags("newsletter").devConsole(e).sendLogs("newsletter-"+i+"-db-fail"),e}}),m.apply(this,arguments)}l.muteNewsletter=u,l.unmuteNewsletter=c}),98);
__d("WAWebNewsletterUpdateMsgsRecordsJob",["Promise","WAJobOrchestratorTypes","WALogger","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebFrontendMsgGetters","WAWebMessageProcessorCache","WAWebMsgDataFromModel","WAWebMsgGetters","WAWebOrchestratorNonPersistedJob","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e){return d(e).waitUntilCompleted()}function d(e){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("addNewsletterMsgsRecords",function(){return e.length===0?(u||(u=n("Promise"))).resolve():o("WAWebMessageProcessorCache").messageProcessorCache.addMessages(e.map(function(e){return{msg:e}}),!0)},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION})}function m(t){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateNewsletterMsgRecord",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!o("WAWebMsgGetters").getIsNewsletterMsg(t)){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[updateNewsletterMsgRecord] Called on a non-newsletter msg"]))).devConsole(t.id);return}if((yield o("WAWebSchemaMessage").getMessageTable().get(t.id.toString()))==null){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[updateNewsletterMsgRecord] Msg not found, skipping"]))).devConsole(t.id);return}var n=t.serverId,r=o("WAWebFrontendMsgGetters").getChat(t),a=p(o("WAWebMsgDataFromModel").msgDataFromMsgModel(t)),i=o("WAWebDBMessageSerialization").dbRowFromMessage(a);n!=null&&(i.internalId=o("WAWebDBMessageUtils").craftInternalId(r.id.toJid(),n)),yield o("WAWebSchemaMessage").getMessageTable().merge(t.id.toString(),i)}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function p(e){return delete e.serverId,delete e.rowId,delete e.messageRangeIndex,e}l.addNewsletterMsgsRecords=c,l.addNewsletterMsgsRecordsJob=d,l.updateNewsletterMsgRecord=m}),98);
__d("WAWebNewsletterMetadataInitFromStorage",["WAJids","WALinkify","WALogger","WAWebBackendApi","WAWebCommonNewsletterEnums","WAWebNewsletterMessageDeliveryUpdateToModelUtils","WAWebNewsletterMetadataCollection","WAWebSchemaNewsletterMetadata","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e){switch(e){case 0:return o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber;case 1:return o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin;case 3:return o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner;case 2:default:return o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest}}function d(e){switch(e){case 0:return o("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.All;case 3:return o("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.None;case 2:return o("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.Blocklist;case 1:default:return o("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.Basic}}function m(t){switch(t){case 0:return o("WAWebCommonNewsletterEnums").NewsletterCapability.Insights;case 1:return o("WAWebCommonNewsletterEnums").NewsletterCapability.PhotoPolls;default:return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Encountered unexpected newsletter capability in DB: ",""])),t).tags("newsletter-capabilities").sendLogs("Unexpected newsletter capability in DB"),null}}function p(e){switch(e){case 1:return o("WAWebCommonNewsletterEnums").NewsletterPrivacy.Private;case 0:default:return o("WAWebCommonNewsletterEnums").NewsletterPrivacy.Public}}function _(e){switch(e){case 0:return o("WAWebCommonNewsletterEnums").WamoSubStatus.ACTIVE;case 1:default:return o("WAWebCommonNewsletterEnums").WamoSubStatus.INACTIVE}}function f(){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: restoreNewsletterMetadata: start restoring newsletter metadata"])));try{var e=yield o("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().all();e.forEach((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebWidFactory").createWid(e.id),n={id:t,creationTime:e.creationTime,name:e.name,nameUpdateTime:e.nameUpdateTime,description:e.description,descriptionUpdateTime:e.descriptionUpdateTime,handle:e.handle,inviteCode:e.inviteCode,size:e.size,verified:e.verified,membershipType:c(e.membershipType),reactionCodesSetting:d(e.reactionCodesSetting),privacy:p(e.privacy),website:e.website!=null?o("WALinkify").findLink(e.website):null,adminCount:e.adminCount,capabilities:e.capabilities!=null?new Set(Array.from(e.capabilities).map(m).filter(Boolean)):new Set,suspended:e.suspended,geosuspended:e.geosuspended,terminated:e.terminated,wamoSubPlanId:e.wamoSubPlanId,wamoSubStatus:_(e.wamoSubStatus)};if(r("WAWebNewsletterMetadataCollection")==null||r("WAWebNewsletterMetadataCollection").add(n,{merge:!0}),e.messageDeliveryUpdates!=null){var a=[];e.messageDeliveryUpdates.forEach(function(e,t){return a.push({id:t,code:e.code})});var i=yield o("WAWebNewsletterMessageDeliveryUpdateToModelUtils").getMessageDeliveryUpdatesModelToUpdate(o("WAJids").toNewsletterJid(e.id),a,[]),l=i.modelUpdatesToAdd;yield o("WAWebBackendApi").frontendFireAndForget("updateNewsletterMessageDeliveryUpdate",{id:t,modelUpdatesToAdd:l,modelUpdatesToRemove:[]})}});return function(t){return e.apply(this,arguments)}})())}finally{o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: restoreNewsletterMetadata: complete restoring newsletter metadata"])))}}),g.apply(this,arguments)}l.restoreNewsletterMetadata=f}),98);
__d("WAWebCRUDOperationsNewsletterPollsVotes",["WAWebModelStorageUtils","WAWebSchemaNewsletterPollsVotes","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebModelStorageUtils").getStorage().lock(["newsletter-polls-votes"],(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t[0],r=new Map(e.map(function(e){return[e.parentMsgKey,e]})),o=(yield n.bulkGet(e.map(function(e){return e.parentMsgKey}))).filter(Boolean);o.forEach(function(e){var t=r.get(e.parentMsgKey);t!=null&&t.serverTimestamp<e.serverTimestamp&&r.delete(e.parentMsgKey)}),yield n.bulkCreateOrReplace(Array.from(r.values()))});return function(e){return t.apply(this,arguments)}})())}function s(e){return o("WAWebSchemaNewsletterPollsVotes").getTable().bulkRemove(e)}function u(e){return o("WAWebSchemaNewsletterPollsVotes").getTable().get(e)}l.bulkCreateOrUpdateVotes=e,l.bulkDeleteVotes=s,l.getVote=u}),98);
__d("WAWebNewsletterMapMsgAndAddOns",["Promise","WAWebBackendApi","WAWebNewsletterBackendMsgUtils","WAWebNewsletterDBUtils","WAWebPollOptionHashUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){var a=yield o("WAWebBackendApi").frontendSendAndReceive("findMsgKeyFromServerId",{from:t,serverId:r});if(a!=null)return(e||(e=n("Promise"))).resolve(a);var i=yield o("WAWebNewsletterDBUtils").getMessageByServerId(r,t.toJid());return i==null?void 0:i.id}),u.apply(this,arguments)}function c(e,t,n){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r,a,i,l,u,c,d,_=(r=e.newsletterReactionsMixin)==null?void 0:r.reactionsReaction,f=(a=e.newsletterPollVotesMixin)==null?void 0:a.votesVote,g=o("WAWebNewsletterBackendMsgUtils").mapNewsletterMsgToMsgData(e,t,((i=_==null?void 0:_.length)!=null?i:0)>0,n),h=(l=g==null?void 0:g.id)!=null?l:yield s(t,e.serverId),y=(u=e.newsletterViewsCountViewsOrDeprecatedMixinGroup)==null||(u=u.value)==null?void 0:u.viewsCountCount,C=(c=(d=e.newsletterResponsesCountMixin)==null?void 0:d.responsesCountCount)!=null?c:0;return{msgData:g,reactionData:m(_,h,n),pollVoteData:p(f,h,n),id:h,viewCount:y,questionResponsesCount:C}}),d.apply(this,arguments)}function m(e,t,n){return t!=null&&e!=null&&e.length>0?{parentMsgKey:t,serverTimestamp:n,emojiCountMap:e.reduce(function(e,t){return e.set(t.code,t.count)},new Map)}:null}function p(e,t,n){return t==null||e==null||e.length===0?null:{parentMsgKey:t,serverTimestamp:n,voteCountMap:e.reduce(function(e,t){return e.set(o("WAWebPollOptionHashUtils").bufferToHex(t.elementValue),t.count)},new Map)}}l.mapMsgAndAddOns=c}),98);
__d("WAWebNewsletterPollsUtils",["WATimeUtils","WAWebNewsletterGatingUtils"],(function(t,n,r,o,a,i,l){function e(e,t,n){var r,a,i=new Map,l=Array.from((r=e==null||(a=e.pollVotesCountMap)==null?void 0:a.values())!=null?r:[]),s=l.reduce(function(e,t){return e+t},0),c=Math.max.apply(Math,l),d=e==null?void 0:e.pollVotersMap;for(var m of t){var p,_,f,g,h,y,C=!!(!(e==null||(p=e.myVote)==null)&&p.has(m.localId)),b=Math.max((_=e==null||(f=e.pollVotesCountMap)==null?void 0:f.get(m.localId))!=null?_:0,C?1:0),v=d==null?void 0:d.get(m.localId),S=C?u(n,e==null?void 0:e.myVoteTs):null,R=(S!=null?[S]:[]).concat((g=v==null?void 0:v.contacts)!=null?g:[]);i.set(m,{isVotedForByMe:C,isCurrentLeader:c>0&&b===c,percentageOfAll:s===0?0:b/s,percentageOfMostVotedForOption:c===0?0:b/c,votes:o("WAWebNewsletterGatingUtils").isNewsletterPollsVotersEnabled()?R.concat((h=v==null?void 0:v.others)!=null?h:[]):[],count:b,mode:"newsletter",contactVoters:R,otherVoters:(y=v==null?void 0:v.others)!=null?y:[]})}return i}function s(e){return{parentMsgKey:e.parentMsgKey.toString(),serverTimestamp:e.serverTimestamp,votesMap:e.voteCountMap}}function u(e,t){var n;return e==null?null:{contact:e,id:e.id,time:(n=o("WATimeUtils").castMillisTimeToUnixTime(t))!=null?n:o("WATimeUtils").unixTime()}}l.aggregateNewsletterVotes=e,l.mapNewsletterVoteToDbRecord=s}),98);
__d("WAWebNewsletterBackendAddOnsUtils",["Promise","WAWebCRUDOperationsNewsletterPollsVotes","WAWebDBProcessEditProtocolMsgs","WAWebModelStorageUtils","WAWebMsgType","WAWebNewsletterMapMsgAndAddOns","WAWebNewsletterMsgEditUtils","WAWebNewsletterPollsUtils","WAWebNewsletterReactionUtils","WAWebSchemaMessage","WAWebStoreMsgs","WAWebdbCRUDOperationsNewsletterReaction","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.msgs,r=e.reactions,a=e.reactionIdsToRemove,i=e.timestamp,l=e.ids,s=e.viewCounts,u=e.pollVotes,c=e.questionResponsesCounts;if(r.length>0&&(yield o("WAWebdbCRUDOperationsNewsletterReaction").createOrUpdateNewsletterReactions(r.map(o("WAWebNewsletterReactionUtils").mapReactionDataToDbRecord).filter(Boolean))),a.length>0&&(yield o("WAWebdbCRUDOperationsNewsletterReaction").bulkRemoveNewsletterReactionsForParentMsg(a)),u.length>0&&(yield o("WAWebCRUDOperationsNewsletterPollsVotes").bulkCreateOrUpdateVotes(u.map(o("WAWebNewsletterPollsUtils").mapNewsletterVoteToDbRecord))),t.length>0){var d=new Map(t.map(function(e){return[e.id.toString(),e]})),m=[],p=[],_=[],f=yield o("WAWebSchemaMessage").getMessageTable().bulkGet(t.map(function(e){return e.id.toString()}));f.forEach(function(e){if(e!=null){var t=d.get(e.id);t!=null&&(t==null?void 0:t.kind)===o("WAWebMsgType").MsgKind.RevokedMessage&&e.type!==o("WAWebMsgType").MSG_TYPE.REVOKED?(p.push(t),_.push(e)):(t==null?void 0:t.t)!=null&&t.t>e.t&&m.push(t)}}),yield o("WAWebDBProcessEditProtocolMsgs").processEditProtocolMsgs(m.map(o("WAWebNewsletterMsgEditUtils").mapMsgToEditProtocolMsgLegacy)),yield o("WAWebSchemaMessage").getMessageTable().bulkRemove(_.map(function(e){var t=e.id;return t.toString()})),yield o("WAWebStoreMsgs").storeMsgs(p)}l.length>0&&(yield o("WAWebModelStorageUtils").getStorage().lock(["message"],(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e[0],n=yield t.bulkGet(l.map(function(e){return e.toString()})).then(function(e){return e.filter(Boolean)}),r=n.map(function(e){var t,n,r=e.id,o=e.viewCount,a=e.questionResponsesCount;return{id:r,lastUpdateFromServerTs:i,viewCount:(t=s==null?void 0:s.get(r))!=null?t:o,questionResponsesCount:(n=c==null?void 0:c.get(r))!=null?n:a}});return t.bulkCreateOrMerge(r)});return function(t){return e.apply(this,arguments)}})()))}),u.apply(this,arguments)}function c(t,r,a){return t.reduce((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield e,i=yield o("WAWebNewsletterMapMsgAndAddOns").mapMsgAndAddOns(t,r,a);if(i==null)return n;var l=i.msgData,s=i.reactionData,u=i.id,c=i.viewCount,d=i.pollVoteData,m=i.questionResponsesCount;return u!=null&&(l==null?void 0:l.kind)!==o("WAWebMsgType").MsgKind.RevokedMessage&&n.ids.push(u),l!=null&&n.msgs.push(l),c!=null&&u!=null&&n.viewCounts.set(u.toString(),c),m!=null&&u!=null&&n.questionResponsesCounts.set(u.toString(),m),s==null?u!=null&&n.reactionIdsToRemove.push(u.toString()):n.reactions.push(s),d!=null&&n.pollVotes.push(d),n});return function(t,n){return e.apply(this,arguments)}})(),(e||(e=n("Promise"))).resolve({ids:[],reactions:[],reactionIdsToRemove:[],msgs:[],viewCounts:new Map,pollVotes:[],questionResponsesCounts:new Map}))}l.updateAddOnDbRecords=s,l.getMsgsAndAddOnsFromUpdates=c}),98);
__d("WAWebNewsletterMessageDeliveryUpdateToModelUtils",["Promise","WALogger","WAWebNewsletterDBUtils","WAWebNewsletterGetMessagesJob","WAWebNewsletterUpdateMsgsRecordsJob","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e,t,n){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r,a){var i=yield o("WAWebNewsletterDBUtils").bulkGetMessagesByServerIds(r.map(function(e){return e.id}),t),l=[],c=r.map((function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){var r=n.id,a=i.get(n.id);if(a==null){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][getMessageDeliveryUpdatesModelToUpdate] Local DB doesn't contain message, we fetch from server."])));var u=yield o("WAWebNewsletterGetMessagesJob").getNewsletterMessages(t,1,{after:r-1}),c=u.msgs[0];if(c==null)return o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][getMessageDeliveryUpdatesModelToUpdate] couldn't retrieve message"]))),null;a=c,l.push(a)}return babelHelpers.extends({},n,{msgData:a,serverId:n.id,id:a.id})});return function(e){return r.apply(this,arguments)}})());l.length>0&&(yield o("WAWebNewsletterUpdateMsgsRecordsJob").addNewsletterMsgsRecords(l));var d=yield o("WAWebNewsletterDBUtils").bulkGetMessagesByServerIds(a,t),m=a.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=d.get(e);return t==null?null:t.id});return function(t){return e.apply(this,arguments)}})());return{modelUpdatesToAdd:(yield(u||(u=n("Promise"))).all(c)).filter(Boolean),modelUpdatesToRemove:(yield u.all(m)).filter(Boolean)}}),d.apply(this,arguments)}l.getMessageDeliveryUpdatesModelToUpdate=c}),98);
__d("WAWebNewsletterMsgHistoryUtils",["Promise","WALogger","WAWebBackendApi","WAWebNewsletterBackendAddOnsUtils","WAWebNewsletterDBUtils","WAWebNewsletterGatingUtils","WAWebNewsletterGetMessagesJob","WAWebNewsletterSystemMessages","WAWebNewsletterUpdateMsgsRecordsJob","WAWebNewsletterValidationUtils","asyncToGeneratorRuntime","lodash"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p;function _(e,t){t===void 0&&(t=new Set);for(var n=[],r=function(){var r=e[i-1].serverId,a=e[i].serverId;if(a==null||r==null)return 0;var l=a-r;if(l<=1)return 0;var s=Array.from({length:l-1},function(e,t){return t+r+1}).filter(function(e){return e>=o("WAWebNewsletterSystemMessages").EARLIEST_AVAILABLE_MESSAGE_ID&&!t.has(e)});if(s.length<=0)return 0;for(;s.length>0;)n.push(s.splice(0,o("WAWebNewsletterGatingUtils").getMaxMsgCountFromServer()))},a,i=1;i<e.length;i++)a=r();return n}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=t.jid,i=t.msgs,l=t.range,f=t.serverIdsToSkip,g=f===void 0?new Set:f;if(i.length<2&&l==null)return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[fillMsgHistoryGaps] Only 1 message for ",""])),a),i;var h=i[0].serverId,y=i[i.length-1].serverId;if(h==null||y==null)return[];if(h>=o("WAWebNewsletterDBUtils").TEMPORARY_SERVER_ID_LOWER_BOUND||y>=o("WAWebNewsletterDBUtils").TEMPORARY_SERVER_ID_LOWER_BOUND)return i;if(y-h+1===i.length&&l==null)return o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[fillMsgHistoryGaps] No gaps to fill for ",", "," - ",""])),a,y,h),i;o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[fillMsgHistoryGaps] Looking for gaps for ",", "," - ",""])),a,y,h);var C;if(l!=null){var b=l.start,v=l.end,S={serverId:Math.min(b,v)-1},R={serverId:Math.max(b,v)+1};C=_([S].concat(i).concat(R),g)}else C=_(i,g);if(C.length===0)return o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[fillMsgHistoryGaps] No gaps identified for ",", "," - ",""])),a,y,h),i;o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[fillMsgHistoryGaps] "," identified for ",""])),C.length,a).devConsole(C);var L=C.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebNewsletterGetMessagesJob").getNewsletterMessages(o("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(String(a)),e.length,{after:e[0]-1}).catch(function(){return null});if(t!=null)return o("WAWebBackendApi").frontendFireAndForget("updateNewsletterMessages",t),yield o("WAWebNewsletterBackendAddOnsUtils").updateAddOnDbRecords(t),t.msgs});return function(t){return e.apply(this,arguments)}})()),E=r("lodash").flatten(yield(p||(p=n("Promise"))).all(L)).filter(Boolean);return o("WAWebNewsletterUpdateMsgsRecordsJob").addNewsletterMsgsRecordsJob(E).fireAndForget(),o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[fillMsgHistoryGaps] Gaps filled for ",", "," messages retrieved from server"])),a,E.length),r("lodash").sortBy(i.concat(E),"serverId")}),g.apply(this,arguments)}l.identifyMsgGaps=_,l.fillMsgHistoryGaps=f}),98);
__d("WAWebSuspendInformDataModelUtils",["WALogger","WAWebNewsletterDBUtils","WAWebNewsletterGetMessagesJob","WAWebNewsletterUpdateMsgsRecordsJob","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r,a=yield o("WAWebNewsletterDBUtils").bulkGetMessagesByServerIds(t,n),i=[],l=[],s=new Map;t.forEach(function(e){var t=a.get(e);t!=null?s.set(e,t):l.push(e)});var u=l[0],c,d=l[l.length-1];return d-u+1===l.length&&(c=yield o("WAWebNewsletterGetMessagesJob").getNewsletterMessages(n,l.length,{after:u-1})),(r=c)==null||r.msgs.forEach(function(t){if(t==null){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][populateMsgModels] couldn't retrieve message"])));return}i.push(t),t.serverId!=null&&s.set(t.serverId,t)}),i.length>0&&(yield o("WAWebNewsletterUpdateMsgsRecordsJob").addNewsletterMsgsRecords(i)),s}),u.apply(this,arguments)}l.populateMsgModels=s}),98);
__d("WAWebGetNewsletterContextForForwardedMsg",["WAWebMsgGetters","WAWebMsgType","WAWebNewsletterMetadataCollection","WAWebWidFactory"],(function(t,n,r,o,a,i,l){function e(e){var t;if(e.forwardedNewsletterMessageInfo!=null)return e.forwardedNewsletterMessageInfo;if(o("WAWebMsgGetters").getIsNewsletterMsg(e)){var n=e.id.remote,a=r("WAWebNewsletterMetadataCollection").get(n);return{newsletterId:o("WAWebWidFactory").asNewsletterWidOrThrow(n),newsletterName:a==null?void 0:a.name,serverMessageId:(t=e.serverId)!=null?t:void 0}}}function s(e){var t=e.forwardable,n=e.source,r=e.destination,a=e.isOriginalMsgForwarded,i=e.isQuestionOrQuestionReply;return r.isNewsletter()&&r.equals(n)&&!a&&t.type!==o("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT&&!i?babelHelpers.extends({},t,{isForwarded:!1,forwardedNewsletterMessageInfo:void 0,forwardingScore:void 0}):t}l.getNewsletterContextForForwardedMsg=e,l.maybeStripNewsletterForwardMetadata=s}),98);
__d("WAWebNewsletterModelUtils",["WALogger","WATimeUtils","WAWebCommonNewsletterEnums","WAWebNewsletterGatingUtils","WAWebNewsletterMetadataCollection","WAWebWid","WAWebWidFactory","err","lodash"],(function(t,n,r,o,a,i,l){var e,s,u=1,c=-1,d=0;function m(e){return e==="verified"}function p(e){var t=C(e);return _(t),f(t)}function _(t){var n,r=(n=t.newsletterMembershipMetadataMixin)==null?void 0:n.membershipType,a=r==null||r==="guest";if(!a){var i="Trying to map an already subscribed newsletter";o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][throwIfNewsletterNotPreview] ",""])),i).tags("newsletter").devConsole(t).sendLogs("newsletter-converting-already-subscribed-newsletter")}}function f(e){var t=h(e);return t.muteExpiration=c,t.isReadOnly=!0,t}function g(e){return e==="admin"||e==="owner"}function h(e){var t,n,a,i,l=(t=e.newsletterNameMetadataMixin)==null?void 0:t.nameElementValue,s=(n=e.newsletterMembershipMetadataMixin)==null?void 0:n.membershipType,u=(a=e.newsletterMutedMetadataMixin)==null?void 0:a.mutedState,m=u==="on"?c:d,p=(i=e.newsletterCreationTimeMetadataMixin)==null?void 0:i.creationTimeValue,_={id:o("WAWebWidFactory").createWid(e.idJid),name:l!=null?l:void 0,isReadOnly:s!=null?!g(s):void 0,muteExpiration:u!=null&&u!=="undefined"?m:void 0,t:p!=null?o("WATimeUtils").castToUnixTime(p):void 0};return r("lodash").pickBy(_,function(e){return e!=null})}function y(e){var t=v(e);return t.membershipType=o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest,t}function C(e){return{idJid:e.idJid,newsletterCreationTimeMetadataMixin:e.newsletterCreationTimeMetadataMixin,newsletterNameMetadataMixin:e.newsletterNameMetadataMixin,newsletterPictureMetadataMixin:e.newsletterPictureMetadataMixin,newsletterDescriptionMetadataMixin:e.newsletterDescriptionMetadataMixin,newsletterInviteLinkMetadataMixin:e.newsletterInviteLinkMetadataMixin,newsletterSubscribersMetadataMixin:e.newsletterSubscribersMetadataMixin,newsletterPrivacyMetadataMixin:e.newsletterPrivacyMetadataMixin,newsletterVerificationMetadataMixin:e.newsletterVerificationMetadataMixin,hasNewsletterLinkedAccountsMetadataMixin:!1,newsletterMembershipMetadataMixin:null,newsletterMutedMetadataMixin:{mutedState:"undefined"},newsletterStateMetadataMixin:null}}function b(e){var t=C(e);return _(t),y(t)}function v(e){var t,n,a,i,l,s,u,c,d,p,_,f,g=(t=e.newsletterVerificationMetadataMixin)==null?void 0:t.verificationState,h=(n=e.newsletterStateMetadataMixin)==null?void 0:n.stateType,y=(a=e.newsletterMembershipMetadataMixin)==null?void 0:a.membershipType,C=(i=e.newsletterPrivacyMetadataMixin)==null?void 0:i.privacyType,b=babelHelpers.extends({id:o("WAWebWidFactory").createWid(e.idJid),creationTime:(l=e.newsletterCreationTimeMetadataMixin)==null?void 0:l.creationTimeValue,name:(s=e.newsletterNameMetadataMixin)==null?void 0:s.nameElementValue,nameUpdateTime:(u=e.newsletterNameMetadataMixin)==null?void 0:u.nameUpdateTime,description:(c=e.newsletterDescriptionMetadataMixin)==null||(c=c.descriptionQueryDescriptionResponseMixin)==null?void 0:c.elementValue,descriptionUpdateTime:(d=e.newsletterDescriptionMetadataMixin)==null||(d=d.descriptionQueryDescriptionResponseMixin)==null?void 0:d.updateTime,inviteCode:(p=e.newsletterInviteLinkMetadataMixin)==null?void 0:p.inviteCode,size:(_=e.newsletterSubscribersMetadataMixin)==null?void 0:_.subscribersCount,verified:g!=null?m(g):void 0,membershipType:y!=null?o("WAWebCommonNewsletterEnums").NewsletterMembershipType.cast(y):void 0,reactionCodesSetting:Object.prototype.hasOwnProperty.call(e,"newsletterReactionCodesSettingMetadataMixin")?(f=e==null?void 0:e.newsletterReactionCodesSettingMetadataMixin)!=null?f:o("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.All:void 0,privacy:C!=null?o("WAWebCommonNewsletterEnums").NewsletterPrivacy.cast(C):void 0,website:void 0,suspended:h!=null?o("WAWebCommonNewsletterEnums").NewsletterState.cast(h)===o("WAWebCommonNewsletterEnums").NewsletterState.Suspended||o("WAWebCommonNewsletterEnums").NewsletterState.cast(h)===o("WAWebCommonNewsletterEnums").NewsletterState.GeoSuspended:void 0,geosuspended:h!=null?o("WAWebCommonNewsletterEnums").NewsletterState.cast(h)===o("WAWebCommonNewsletterEnums").NewsletterState.GeoSuspended:void 0},o("WAWebNewsletterGatingUtils").isWamoSubExperienceEnabled()&&{wamoSubPlanId:e.newsletterWamoSubPlanIdMetadataMixin,wamoSubStatus:e.newsletterWamoSubStatusMetadataMixin});return r("lodash").pickBy(b,function(e){return e!=null})}var S="https://pps.whatsapp.net";function R(e){if(e==null||e==="")return null;var t=new URL(e,S);return t.href}function L(e,t){var n,a,i,l,s,u,c,d=o("WAWebWidFactory").createWid(e);if(t.length===0)return{id:d};var m,p;for(var _ of t){var f=_.queryPictureDirectPathOrEmptyResponseMixinGroup;if(f.name==="QueryPictureDirectPathResponse")f.value.type==="preview"?p=f.value:f.value.type==="image"&&(m=f.value);else if(f.name==="QueryPictureEmptyResponse")return{id:d,timestamp:Date.now(),eurl:null,previewEurl:null,eurlStale:!1,stale:!1}}var g={id:d,timestamp:Date.now(),tag:(n=(a=m)==null?void 0:a.id)!=null?n:(i=p)==null?void 0:i.id,eurl:R((l=(s=m)==null?void 0:s.directPath)!=null?l:(u=p)==null?void 0:u.directPath),previewEurl:R((c=p)==null?void 0:c.directPath),eurlStale:!1,stale:!1};return r("lodash").pickBy(g,function(e){return e!=null})}function E(e){var t,n;return{chat:h(e),metadata:v(e),pic:L(e.idJid,(t=(n=e.newsletterPictureMetadataMixin)==null?void 0:n.picture)!=null?t:[])}}function k(e){var t;if(r("WAWebWid").isNewsletter(e)){var n;return(n=r("WAWebNewsletterMetadataCollection").get(e))==null?void 0:n.membershipType}return(t=r("WAWebNewsletterMetadataCollection").filter(function(t){return t.inviteCode===e})[0])==null?void 0:t.membershipType}function I(e){return e===c}function T(e){switch(e){case"INSIGHTS":return o("WAWebCommonNewsletterEnums").NewsletterCapability.Insights;case"PHOTO_POLLS":return o("WAWebCommonNewsletterEnums").NewsletterCapability.PhotoPolls;case"QUESTIONS":return o("WAWebCommonNewsletterEnums").NewsletterCapability.QUESTIONS;case"INVITE_ADMINS_BUTTON":return o("WAWebCommonNewsletterEnums").NewsletterCapability.INVITE_ADMINS_BUTTON;case"INVITE_FOLLOWERS":return o("WAWebCommonNewsletterEnums").NewsletterCapability.INVITE_FOLLOWERS;case"ADMIN_NOTIFICATIONS":return o("WAWebCommonNewsletterEnums").NewsletterCapability.ADMIN_NOTIFICATIONS;case"QUIZ":return o("WAWebCommonNewsletterEnums").NewsletterCapability.QUIZ;case"ADMIN_CONTEXT_CARD_1":return o("WAWebCommonNewsletterEnums").NewsletterCapability.ADMIN_CONTEXT_CARD_1;case"ADMIN_CONTEXT_CARD_2":return o("WAWebCommonNewsletterEnums").NewsletterCapability.ADMIN_CONTEXT_CARD_2;case"ADMIN_CONTEXT_CARD_3":return o("WAWebCommonNewsletterEnums").NewsletterCapability.ADMIN_CONTEXT_CARD_3;case"SHARE_STICKER_PACKS":return o("WAWebCommonNewsletterEnums").NewsletterCapability.SHARE_STICKER_PACKS;default:return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Encountered unexpected newsletter capability: ",""])),e).tags("newsletter-capabilities").sendLogs("Unexpected newsletter capability"),o("WAWebCommonNewsletterEnums").NewsletterCapability.Insights}}l.DEFAULT_NEWSLETTER_ADMIN_COUNT=u,l.MUTED_STATE=c,l.UNMUTED_STATE=d,l.mapDirectoryNewsletterToChat=p,l.mapPreviewNewsletterToChat=f,l.isMembershipAdminOrOwner=g,l.mapNewsletterToChat=h,l.mapPreviewNewsletterToMetadata=y,l.convertDirectoryNewsletterMetadataToNewsletterMetadata=C,l.mapDirectoryNewsletterToMetadata=b,l.mapNewsletterToMetadata=v,l.formatProfilePictureURL=R,l.mapPicturesToProfilePicThumb=L,l.mapNewsletterToModels=E,l.getRoleByIdentifier=k,l.isMuted=I,l.getNewsletterCapabilityFromValue=T}),98);
__d("WAWebNewsletterReactionUtils",["WATimeUtils","WAWebContactCollection","WAWebEmoji","WAWebFrontendContactGetters","WAWebProfilePicThumbCollection","WAWebReactionsModels","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){function e(e){var t,n;return{serverTimestamp:(t=e.reactionCountMapTs)!=null?t:o("WATimeUtils").unixTime(),emojiCountMap:(n=e.reactionCountMap)!=null?n:new Map,parentMsgKey:e.id.toString()}}function s(e){if(e.length===0)return{reactions:[],count:0};var t=e.map(c);return u(t)}function u(e){var t=0,n=new Map;for(var r of e){var o=r.reactions,a=r.count;t+=a;for(var i of o.entries()){var l=i[0],s=i[1],u=s[0],c=s[1],d=n.get(l);d!=null?(d.count+=c,d.reaction=babelHelpers.extends({},d.reaction,{reactionSenders:d.reaction.reactionSenders.concat(u.reactionSenders)}),n.set(l,d)):n.set(l,{reaction:u,count:c})}}var m=Array.from(n.values()).sort(function(e,t){var n=e.count,r=e.reaction,o=t.reaction,a=t.count;return r.reactionByMe!=null?-1:o.reactionByMe!=null?1:a-n}).map(function(e){var t=e.reaction,n=e.count;return[t,n]});return{count:t,reactions:m}}function c(e){var t=new Map,n=e.myReaction,r=e.myReactionMsgKey,a=new Map(e.reactionCountMap);n!=null&&n!==""&&!a.has(n)&&a.set(n,1);var i=0,l=d(a);for(var s of l.entries()){var u,c=s[0],m=s[1];i+=m.count,t.set(c,[{reactionAggregate:c,reactionSenders:f(c,e),reactionByMe:n!=null&&r!=null&&c===o("WAWebEmoji").EmojiUtil.getEmojiAggregate(n)?{msgKey:r.toString(),orphan:0,parentMsgKey:e.id.toString(),reactionText:o("WAWebEmoji").EmojiUtil.getNormalizedOrTofu(n),senderUserJid:o("WAWebUserPrefsMeUser").getMePnUserOrThrow().toJid(),timestamp:(u=e.myReactionTs)!=null?u:0}:null},m.count])}return{reactions:t,count:i}}function d(e){var t=new Map;for(var n of e.entries()){var r,a=n[0],i=n[1],l=o("WAWebEmoji").EmojiUtil.getEmojiAggregate(a),s=o("WAWebEmoji").EmojiUtil.getNormalizedOrTofu(a),u=(r=t.get(l))!=null?r:{count:0,reactions:new Map};u.reactions.set(s,i),u.count+=i,t.set(l,u)}return t}function m(e){var t=new Map;return e.reactions.map(function(e){var n,r=e.reactionCode,a=e.senderList,i=o("WAWebEmoji").EmojiUtil.getEmojiAggregate(r),l=(n=t.get(i))!=null?n:[];t.set(i,l.concat(a))}),t}function p(e){var t=m(e),n=new Map;for(var r of t.entries()){var a=r[0],i=r[1],l=i.sort(function(e,t){var n=(e==null?void 0:e.id)!=null?o("WAWebContactCollection").ContactCollection.get(e.id):null,r=(t==null?void 0:t.id)!=null?o("WAWebContactCollection").ContactCollection.get(t.id):null,a=(n==null?void 0:n.type)==="in",i=(r==null?void 0:r.type)==="in";if(a&&n&&r&&i){var l=o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.get(n.id)!=null,s=o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.get(r.id)!=null;return l===s?0:l?-1:1}else if(!a&&!i)return 0;return a?-1:1}).slice(0,5),s=l.map(function(e){return(e==null?void 0:e.id)!=null?e.id:e==null?void 0:e.profileUrl}).filter(Boolean);n.set(a,s)}return n}function _(e){var t=[];return e.reactions.map(function(e){var n=e.reactionCode,r=e.senderList;r.map(function(e){if((e==null?void 0:e.id)!=null){var r=o("WAWebContactCollection").ContactCollection.get(e.id);(r==null?void 0:r.type)==="in"&&t.push({reaction:n,contact:r})}})}),t.sort(function(e,t){var n=o("WAWebFrontendContactGetters").getFormattedUser(e.contact),r=o("WAWebFrontendContactGetters").getFormattedUser(t.contact);return n.localeCompare(r)})}function f(e,t){var n=t.myReaction,r=n!=null&&e===o("WAWebEmoji").EmojiUtil.getEmojiAggregate(n);return[new(o("WAWebReactionsModels")).ReactionsSenders({id:t.id,reactionText:r?n:e,senderUserJid:r?o("WAWebUserPrefsMeUser").getMePnUserOrThrow().toJid():t.id.remote.toJid(),timestamp:t.reactionCountMapTs})]}function g(e){var t=e.serverTimestamp,n=e.emojiCountMap,r=e.parentMsgKey;if(!(t==null||n==null))return{serverTimestamp:t,emojiCountMap:n,parentMsgKey:r.toString()}}l.mapFrontendReactionToBackend=e,l.aggregateAndSortReactions=s,l.getReactionSendersForFacePile=p,l.getContactReactionSenders=_,l.mapReactionDataToDbRecord=g}),98);
__d("WAWebNewsletterSystemMessages",["Promise","WATimeUtils","WAWebCommonNewsletterEnums","WAWebContactSystemMsg","WAWebMsgKey","WAWebMsgModelFromData","WAWebMsgType","WAWebNewsletterGatingUtils","WAWebNewsletterUpdateMsgsRecordsJob","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=new Map([["newsletter_privacy",10],["newsletter_created",20],["newsletter_admin_context_card",30],["newsletter_deleted",Number.MAX_SAFE_INTEGER]]),u=100,c=2147476647;function d(e){var t=e.serverId;return t==null?!1:t<u}function m(e){var t=e.serverId;if(t==null)return!1;var n=Array.from(s.values()),r=Math.min.apply(Math,n);return t===r}function p(e,t){var n,a=s.get(t.subtype),i=babelHelpers.extends({},o("WAWebContactSystemMsg").genNotificationMsg(e,babelHelpers.extends({},t,{type:o("WAWebMsgType").MSG_TYPE.NEWSLETTER_NOTIFICATION,kind:o("WAWebMsgType").MsgKind.NewsletterNotification,serverId:a,templateParams:(n=t.templateParams)!=null?n:[]})),{id:new(r("WAWebMsgKey"))({fromMe:o("WAWebUserPrefsMeUser").isMeAccount(e),remote:e,id:a!=null?a.toString(10):r("WAWebMsgKey").newId_DEPRECATED()})});return i}function _(e){var t=e.id,n=e.name,r=e.t,a=e.role,i=a!=null?a:o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber,l=r!=null?o("WATimeUtils").castToUnixTime(r):o("WATimeUtils").unixTime(),s=p(o("WAWebWidFactory").createWid(t.toString()),{subtype:"newsletter_privacy",templateParams:[i],t:l}),u=p(o("WAWebWidFactory").createWid(t.toString()),{subtype:"newsletter_created",templateParams:n!=null?[n,i]:[],t:l});if(o("WAWebNewsletterGatingUtils").isNewsletterAdminContextCardEnabled(i)){var c=p(o("WAWebWidFactory").createWid(t.toString()),{subtype:"newsletter_admin_context_card",templateParams:[t.toString()],t:l});return[s,u,c]}return[s,u]}function f(t){return t.addQueue.enqueue((e||(e=n("Promise"))).resolve().then(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e,n,r=_({id:t.id,name:t.name,t:(e=t.newsletterMetadata)==null?void 0:e.creationTime,role:(n=t.newsletterMetadata)==null?void 0:n.membershipType}),a=r.map(o("WAWebMsgModelFromData").msgModelFromMsgData);return yield o("WAWebNewsletterUpdateMsgsRecordsJob").addNewsletterMsgsRecords(r),t.msgs.add(a,{at:0}),a})))}function g(e){var t=e.id,n=e.name,r=p(o("WAWebWidFactory").createWid(t.toString()),{subtype:"newsletter_deleted",templateParams:[n],t:o("WATimeUtils").unixTime()});return[r]}l.EARLIEST_AVAILABLE_MESSAGE_ID=u,l.LATEST_AVAILABLE_MESSAGE_ID=c,l.isNewsletterSystemMsg=d,l.isEarliestNewsletterSystemMsg=m,l.genNewsletterCreationSystemMessages=_,l.addSystemMessagesToChat=f,l.genNewsletterDeletionSystemMessages=g}),98);
__d("WAWebGetNewsletterCursor",["WAWebNewsletterSystemMessages"],(function(t,n,r,o,a,i,l){function e(e,t,n){var r,o,a,i=n.length>0?n:e.toArray(),l=t==="before"?(r=i[0])==null?void 0:r.serverId:(o=i[i.length-1])==null?void 0:o.serverId;return l==null?null:(a={},a[t]=s(l),a)}function s(e){return Math.min(Math.max(e,o("WAWebNewsletterSystemMessages").EARLIEST_AVAILABLE_MESSAGE_ID-1),o("WAWebNewsletterSystemMessages").LATEST_AVAILABLE_MESSAGE_ID)}l.getNewsletterCursor=e}),98);
__d("WAWebNewsletterEnforcementAppealModel",["WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.chatId=o("WAWebBaseModel").prop(),t.enforcementViolationCategory=o("WAWebBaseModel").prop(),t.enforcementType=o("WAWebBaseModel").prop(),t.enforcementId=o("WAWebBaseModel").prop(),t.enforcementSource=o("WAWebBaseModel").prop(),t.countryCode=o("WAWebBaseModel").prop(),t.enforcementExtraData=o("WAWebBaseModel").prop(),t.appealState=o("WAWebBaseModel").prop(),t.appealCreationTime=o("WAWebBaseModel").prop(),t.appealReason=o("WAWebBaseModel").prop(),t.lastUpdated=o("WAWebBaseModel").prop(),t.serverMsgId=o("WAWebBaseModel").prop(),t.msgData=o("WAWebBaseModel").prop(),t.additionalAppealReason=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.setAppealState=function(t){this.appealState=t},n.setAppealCreationTime=function(t){this.appealCreationTime=t},n.setAppealReason=function(t){this.appealReason=t},n.setAdditionalAppealReason=function(t){this.additionalAppealReason=t},t})(o("WAWebBaseModel").BaseModel);e.Proxy="newsletter_enforcement_appeal";var s=o("WAWebBaseModel").defineModel(e);l.NewsletterEnforcementAppeal=s}),98);
__d("WAWebNewsletterEnforcementAlertModel",["WAWebBaseModel","WAWebNewsletterEnforcementAppealModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.chatId=o("WAWebBaseModel").prop(),t.enforcementCreationTime=o("WAWebBaseModel").prop(),t.enforcementViolationCategory=o("WAWebBaseModel").prop(),t.enforcementType=o("WAWebBaseModel").prop(),t.enforcementId=o("WAWebBaseModel").prop(),t.enforcementExtraData=o("WAWebBaseModel").prop(),t.enforcementSource=o("WAWebBaseModel").prop(),t.countryCodes=o("WAWebBaseModel").prop(),t.targetMsgMapForEvidence=o("WAWebBaseModel").prop(),t.lastUpdated=o("WAWebBaseModel").prop(),t.appeal=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.set=function(n,r,a){if(typeof n=="string"&&n==="appeal"&&r!=null){if(!(r instanceof o("WAWebNewsletterEnforcementAppealModel").NewsletterEnforcementAppeal)){var t=new(o("WAWebNewsletterEnforcementAppealModel")).NewsletterEnforcementAppeal(r);return e.prototype.set.call(this,n,t,a)}return e.prototype.set.call(this,n,r,a)}if(typeof n=="string"&&n==="targetMsgMapForEvidence"&&r!=null){if(r instanceof Map){var i=new Map;for(var l of r.entries()){var s=l[0],u=l[1];u!=null&&!(u instanceof o("WAWebNewsletterEnforcementAppealModel").NewsletterEnforcementAppeal)?i.set(s,new(o("WAWebNewsletterEnforcementAppealModel")).NewsletterEnforcementAppeal(u)):i.set(s,u)}return e.prototype.set.call(this,n,i,a)}return e.prototype.set.call(this,n,r,a)}if(typeof n=="object"&&n!=null){var c=babelHelpers.extends({},n),d=!1;c.appeal!=null&&!(c.appeal instanceof o("WAWebNewsletterEnforcementAppealModel").NewsletterEnforcementAppeal)&&(c.appeal=new(o("WAWebNewsletterEnforcementAppealModel")).NewsletterEnforcementAppeal(c.appeal),d=!0);var m=c.targetMsgMapForEvidence;if(m!=null&&m instanceof Map){var p=new Map;for(var _ of m.entries()){var f=_[0],g=_[1];g!=null&&!(g instanceof o("WAWebNewsletterEnforcementAppealModel").NewsletterEnforcementAppeal)?(p.set(f,new(o("WAWebNewsletterEnforcementAppealModel")).NewsletterEnforcementAppeal(g)),d=!0):p.set(f,g)}c.targetMsgMapForEvidence=p}if(d)return e.prototype.set.call(this,c,r,a)}return e.prototype.set.call(this,n,r,a)},n.isValidAlertToRender=function(){var e,t,n;return((e=this.appeal)==null?void 0:e.appealState)!=="SUCCESS"&&((t=this.appeal)==null?void 0:t.appealState)!=="CONTENT_UNAVAILABLE"||((n=this.targetMsgMapForEvidence)==null||(n=n.values())==null?void 0:n.some(function(e){return e.appealState!=="SUCCESS"&&e.appealState!=="CONTENT_UNAVAILABLE"}))||!1},t})(o("WAWebBaseModel").BaseModel);e.Proxy="newsletter_enforcement_alert";var s=o("WAWebBaseModel").defineModel(e);l.NewsletterEnforcementAlert=s}),98);
__d("WAWebNewsletterEnforcementAlertCollection",["WAWebBaseCollection","WAWebNewsletterEnforcementAlertModel","WAWebNewsletterEnforcementAppealModel"],(function(t,n,r,o,a,i,l){var e=function(t,n){return n.enforcementCreationTime-t.enforcementCreationTime},s=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.hasAlerts=function(){return this.some(function(e){return e.isValidAlertToRender()})},n.setMsgModelMap=function(n){t.msgModelMap=n},n.getAppeals=function(){var e=[];return this.map(function(t){var n;if(((n=t.targetMsgMapForEvidence)==null?void 0:n.values().toArray().length)!==0&&t.targetMsgMapForEvidence!=null)for(var r of t.targetMsgMapForEvidence.values())r!=null&&r.appealState!=="NOT_APPEALED"&&r.appealState!=="NON_APPEALABLE"&&e.push(new(o("WAWebNewsletterEnforcementAppealModel")).NewsletterEnforcementAppeal(r));else t.appeal!=null&&t.appeal.appealState!=="NOT_APPEALED"&&t.appeal.appealState!=="NON_APPEALABLE"&&e.push(new(o("WAWebNewsletterEnforcementAppealModel")).NewsletterEnforcementAppeal(t.appeal))}),e.sort(function(e,t){var n,r;return((n=t.appealCreationTime)!=null?n:0)-((r=e.appealCreationTime)!=null?r:0)})},t})(o("WAWebBaseCollection").BaseCollection);s.model=o("WAWebNewsletterEnforcementAlertModel").NewsletterEnforcementAlert,s.comparator=e;var u=new s;l.NewsletterEnforcementAlertCollection=u}),98);
__d("WAWebFetchNewsletterProfilePicAction",["WAJids","WAWebNewsletterMetadataJob","WAWebNewsletterModelUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n,r,a,i,l={id:e},s=o("WAJids").toNewsletterJid(e.toString()),u=o("WAWebNewsletterModelUtils").getRoleByIdentifier(e),c=yield o("WAWebNewsletterMetadataJob").getNewsletterMetadata(s,u,{picture:!0}),d=c==null||(t=c.newsletterPictureMetadataMixin)==null?void 0:t.picture;if(d==null)return l;var m=o("WAWebNewsletterModelUtils").mapPicturesToProfilePicThumb(s,d);return babelHelpers.extends({},l,{tag:(n=m.tag)!=null?n:void 0,eurl:(r=m.eurl)!=null?r:void 0,previewEurl:(a=m.previewEurl)!=null?a:void 0,stale:m.stale,eurlStale:!1,timestamp:(i=m.timestamp)!=null?i:Date.now()})}),s.apply(this,arguments)}l.fetchNewsletterProfilePic=e}),98);
__d("WAWebNewsletterGetMessageUpdatesAction",["Promise","WAJids","WALogger","WATimeUtils","WAWebNewsletterBridgeApi","WAWebNewsletterGatingUtils","WAWebNewsletterGetMessageUpdatesJob","WAWebNewsletterMetadataJob","WAWebNewsletterSystemMessages","WAWebNewsletterValidationUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h;function y(e,t){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){var a="[maybeUpdateMsgsAddOns]["+r.id.toJid()+"]";if(t.length===0){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose([""," no messages, exit"])),a);return}var i=t.filter(function(e){return e.serverId==null?!1:e.serverId>=o("WAWebNewsletterSystemMessages").EARLIEST_AVAILABLE_MESSAGE_ID&&e.serverId<=o("WAWebNewsletterSystemMessages").LATEST_AVAILABLE_MESSAGE_ID}),l=Math.min.apply(Math,i.map(function(e){var t;return(t=e.lastUpdateFromServerTs)!=null?t:0}));if(o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose([""," init, earliestMsgUpdateTs=",""])),a,l),!b(l)){o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[maybeUpdateMsgsAddOns] should not update, exiting"])));return}var d=Math.min.apply(Math,i.map(function(e){return e.serverId}).filter(Boolean));if(o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose([""," updating, earliest server id in batch ",""])),a,d),!!Number.isSafeInteger(d))try{for(var y=d-1,C=0,v=[];C<i.length;){var S=Math.min(i.length-C,o("WAWebNewsletterGatingUtils").getMaxMsgCountFromServer());v.push(o("WAWebNewsletterGetMessageUpdatesJob").getNewsletterMessageUpdates(o("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(r.id.toJid()),{cursor:{after:y},count:S,since:l>0?l:void 0,ids:i.map(function(e){return e.id})})),y+=S,C+=S}var R=yield(h||(h=n("Promise"))).all(v);R.forEach(function(e){o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose([""," updated db records"])),a).devConsole(e),o("WAWebNewsletterBridgeApi").NewsletterBridgeApi.updateNewsletterMessages(e),o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose([""," updated UI, exiting"])),a)})}catch(e){if((e==null?void 0:e.status)===423)try{yield o("WAWebNewsletterMetadataJob").suspendNewsletter(o("WAJids").toNewsletterJid(r.id.toJid())),o("WAWebNewsletterBridgeApi").NewsletterBridgeApi.suspendNewsletter({id:r.id})}catch(e){o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][maybeUpdateMsgsAddOns] Failed to suspend channel "," on receiving 423 error - ",""])),r.id.toString(),e.name).devConsole(e).tags("newsletter").sendLogs("newsletter-maybe-update-msg-addons-suspend-error");return}else if((e==null?void 0:e.status)===451)try{yield o("WAWebNewsletterMetadataJob").geosuspendNewsletter(o("WAJids").toNewsletterJid(r.id.toJid())),o("WAWebNewsletterBridgeApi").NewsletterBridgeApi.geosuspendNewsletter({id:r.id})}catch(e){o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][maybeUpdateMsgsAddOns] Failed to geosuspend channel "," on receiving 451 error - ",""])),r.id.toString(),e.name).devConsole(e).tags("newsletter").sendLogs("newsletter-maybe-update-msg-addons-geosuspend-error");return}o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[maybeUpdateMsgsAddOns] Failed to update messages"]))).devConsole(e).tags("newsletter")}}),C.apply(this,arguments)}function b(e){return Number.isSafeInteger(e)?o("WATimeUtils").unixTime()-e>o("WAWebNewsletterGatingUtils").getPullMessageUpdatesThresholdSeconds():!1}l.maybeUpdateMsgsAddOns=y}),98);
__d("WAWebNewsletterGetNewsletterEnforcementAlertAction",["WAJobOrchestratorTypes","WALogger","WAWebGetNewsletterEnforcementAlertsJob","WAWebNewsletterBridgeApi","WAWebNewsletterEnforcementAlertCollection","WAWebNewsletterValidationUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){n===void 0&&(n=o("WAJobOrchestratorTypes").JOB_PRIORITY.HIGH),o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][getNewsletterEnforcementAlertAction] Start"])));try{var r=o("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(t.toJid()),a=yield o("WAWebGetNewsletterEnforcementAlertsJob").getNewsletterEnforcementAlerts(r,n);if(a==null)return;var i=a.enforcementData,l=a.msgModelMap;o("WAWebNewsletterEnforcementAlertCollection").NewsletterEnforcementAlertCollection.setMsgModelMap(l),o("WAWebNewsletterBridgeApi").NewsletterBridgeApi.updateNewsletterEnforcementAlerts({enforcementAlerts:i})}catch(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][getNewsletterEnforcementAlertAction] Failed to get NewsletterEnforcements updates"]))).tags("newsletter").devConsole(e).sendLogs("newsletter-failed-to-get-NewsletterEnforcement-alerts")}}),c.apply(this,arguments)}l.getNewsletterEnforcementAlertAction=u}),98);
__d("WAWebNewsletterMessageDeliveryUpdateAction",["WAJids","WAWebNewsletterMetadataJob","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n;yield o("WAWebNewsletterMetadataJob").updateNewsletterMessageDeliveryUpdates(o("WAJids").toNewsletterJid(e.id.toString()),[],t.map(function(e){return e.serverId}).filter(Boolean)),(n=e.newsletterMetadata)==null||n.messageDeliveryUpdates.remove(t.map(function(e){return e.id}))}),s.apply(this,arguments)}l.removeMessageDeliveryUpdates=e}),98);
__d("WAWebNewsletterPullMessagesFromServerAction",["Promise","WAAbortError","WALogger","WARaceSignal","WAWebApiChat","WAWebChatGetters","WAWebChatSeenBridge","WAWebMsgModelFromData","WAWebNewsletterBackendAddOnsUtils","WAWebNewsletterBridgeApi","WAWebNewsletterErrors","WAWebNewsletterGetMessagesJob","WAWebNewsletterUpdateMsgsRecordsJob","WAWebNewsletterValidationUtils","WAWebStateUtils","WAWebUpdateUnreadChatAction","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g;function h(t,a){var i=o("WAWebStateUtils").unproxy(t);return o("WAWebChatGetters").getIsNewsletter(i)?a.messageCount<0?(g||(g=n("Promise"))).resolve([]):r("WARaceSignal")([a.signal,i.getDeleteSignal()].filter(Boolean),function(e){return S(i,babelHelpers.extends({},a,{signal:e}))}):(o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[pullNewsletterMessagesFromServer] not a newsletter"]))),(g||(g=n("Promise"))).reject(new(o("WAWebNewsletterErrors")).UnexpectedNonNewsletterChatError))}function y(e,t,n){switch(t){case"before":{e.msgs.msgLoadState.isLoadingEarlierMsgs=n;break}case"after":{e.msgs.msgLoadState.isLoadingRecentMsgs=n;break}}}function C(e,t,r){return t.length===0?(g||(g=n("Promise"))).resolve():e.addQueue.enqueue((g||(g=n("Promise"))).resolve().then(function(){if(e.msgs.add(t,r==="before"?{at:0}:void 0),r==="after"){var n,o=Math.max.apply(null,t.map(function(e){return e.t}));e.t=Math.max((n=e.t)!=null?n:0,o)}}))}function b(e,t){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WAWebApiChat").getChatMeta(e.id),r=n.unreadCount,a=Math.max(r-t,0);yield o("WAWebChatSeenBridge").markConversationSeen(e.id,a),yield o("WAWebUpdateUnreadChatAction").updateUnreadCountMD(e,0,!1)}),v.apply(this,arguments)}function S(e,t){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(t.signal.aborted)throw new(o("WAAbortError")).AbortError;var r=t.messageCount,a=t.cursor,i=t.shouldUpdateMsg,l=a==null||a.after!=null?"after":"before",f="[pullNewsletterMessagesFromServer]["+e.id.toJid()+"]["+l+"]";o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose([""," start pulling messages"])),f);var h=e.msgs.msgLoadState,v=h.isLoadingEarlierMsgs,S=h.isLoadingRecentMsgs;if(l==="before"&&v)return o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose([""," early returning loadEarlierPromise"])),f),e.msgs.loadEarlierPromise;if(l==="after"&&S)return o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose([""," early returning loadRecentPromise"])),f),e.msgs.loadRecentPromise;y(e,l,!0);try{if(t.signal.aborted)throw new(o("WAAbortError")).AbortError;var R=o("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(e.id.toJid()),E=(g||(g=n("Promise"))).resolve().then(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var s=yield o("WAWebNewsletterGetMessagesJob").getNewsletterMessages(R,r,a),u=i!=null?s.msgs.filter(i):s.msgs,c=u.map(o("WAWebMsgModelFromData").msgModelFromMsgData);if(o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose([""," loaded "," messages from server"])),f,c.length),t.signal.aborted)throw new(o("WAAbortError")).AbortError;return c.length>0?(yield(g||(g=n("Promise"))).all([o("WAWebNewsletterUpdateMsgsRecordsJob").addNewsletterMsgsRecords(u),L(s),C(e,c,l)]),t.resetUnreadCount===!0&&(yield b(e,c.length)),o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose([""," local collections and db updated"])),f)):o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose([""," no messages retrieved from server, skip models update"])),f),y(e,l,!1),s.msgs.map(o("WAWebMsgModelFromData").msgModelFromMsgData)}));return l==="before"?e.msgs.loadEarlierPromise=E:l==="after"&&(e.msgs.loadRecentPromise=E),yield E}catch(e){throw o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[pullNewsletterMessagesFromServer] failed to pull newsletter messages from server"]))).tags("newsletter").devConsole(e),e}}),R.apply(this,arguments)}function L(e){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.reactions,n=e.pollVotes,r=e.timestamp;o("WALogger").DEV(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[updateNewsletterAddons], updating"]))).devConsole(t),yield o("WAWebNewsletterBackendAddOnsUtils").updateAddOnDbRecords(e);var a=t.map(function(e){return e.parentMsgKey});return o("WAWebNewsletterBridgeApi").NewsletterBridgeApi.updateNewsletterMessages({reactions:t,ids:a,timestamp:r,pollVotes:n})}),E.apply(this,arguments)}l.pullNewsletterMessagesFromServer=h}),98);
__d("WAWebNewsletterReparseMsgAction",["WAWebBackendApi","WAWebHandleMsgTypes.flow","WAWebNewsletterFutureProofUtils","WAWebNewsletterUpdateMsgsRecordsJob","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.futureproofBuffer,n=e.futureproofType,r=e.futureproofSubtype;if(t!=null||n==null)return e;var a=o("WAWebNewsletterFutureProofUtils").isMsgSupported(e),i=a.supported;if(!i)return e;var l=babelHelpers.extends({},e,{type:n,kind:n,subtype:r,futureproofType:void 0,futureproofSubtype:void 0});return yield o("WAWebNewsletterUpdateMsgsRecordsJob").addNewsletterMsgsRecords([l]),yield o("WAWebBackendApi").frontendSendAndReceive("updateMessageUI",{msg:l,chatId:e.id.remote,messageOverwriteOption:o("WAWebHandleMsgTypes.flow").MessageOverwriteOption.RETRY}),l}),s.apply(this,arguments)}l.reparseNewsletterMsg=e}),98);
__d("WAWebWamEnumChannelEventType",[],(function(t,n,r,o,a,i){var e=Object.freeze({FOLLOW:1,UNFOLLOW:2,MUTE:3,UNMUTE:4,PREMIUM_SUBSCRIBE:5,PREMIUM_UNSUBSCRIBE:6,CHANNEL_PREMIUM_SETUP:7,CHANNEL_PREMIUM_CANCEL:8,HIDE:9,UNHIDE:10,CREATE:11,DELETE:12});i.CHANNEL_EVENT_TYPE=e}),66);
__d("WAWebNewsletterToggleMuteStateAction",["WAJids","WALogger","WAWebNewsletterAttributionLogging","WAWebNewsletterBridgeApi","WAWebNewsletterCollection","WAWebNewsletterToggleMuteStateJob","WAWebWamEnumChannelEventType","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var a=n.eventSurface;if(!t.isNewsletter()){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][muteNewsletterAction] called with a non-newsletter chat"]))).tags("newsletter").devConsole(t).sendLogs("mute-not-a-newsletter");return}try{o("WAWebNewsletterAttributionLogging").NewsletterCoreEventLogger.log({eventSurface:a,cid:t,channelCoreEventType:o("WAWebWamEnumChannelEventType").CHANNEL_EVENT_TYPE.MUTE});var i=r("WAWebNewsletterCollection").get(t);if(i==null)throw r("err")("Failed to retrieve newsletter");i.mute.promises.mute=o("WAWebNewsletterToggleMuteStateJob").muteNewsletter([o("WAJids").toNewsletterJid(t.toJid())]).then(function(){return{status:200}}).catch(function(){return{status:400}}),yield i.mute.promises.mute,yield o("WAWebNewsletterBridgeApi").NewsletterBridgeApi.muteNewsletter({id:t})}catch(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][muteNewsletterAction] failed to mute the newsletter"]))).tags("newsletter").devConsole(e).sendLogs("newsletter-mute-action-failed")}}),m.apply(this,arguments)}function p(e,t){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=t.eventSurface;if(!e.isNewsletter()){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][unmuteNewsletterAction] called with a non-newsletter chat"]))).tags("newsletter").devConsole(e).sendLogs("mute-not-a-newsletter");return}try{o("WAWebNewsletterAttributionLogging").NewsletterCoreEventLogger.log({eventSurface:n,cid:e,channelCoreEventType:o("WAWebWamEnumChannelEventType").CHANNEL_EVENT_TYPE.UNMUTE});var a=r("WAWebNewsletterCollection").get(e);if(a==null)throw r("err")("Failed to retrieve newsletter");a.mute.promises.unmute=o("WAWebNewsletterToggleMuteStateJob").unmuteNewsletter([o("WAJids").toNewsletterJid(e.toJid())]).then(function(){return{status:200}}).catch(function(){return{status:400}}),yield a.mute.promises.unmute,yield o("WAWebNewsletterBridgeApi").NewsletterBridgeApi.unmuteNewsletter({id:e})}catch(e){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][unmuteNewsletterAction] failed to unmute the newsletter"]))).tags("newsletter").devConsole(e).sendLogs("newsletter-unmute-action-failed")}}),_.apply(this,arguments)}l.muteNewsletterAction=d,l.unmuteNewsletterAction=p}),98);
__d("WAWebQueryAndUpdateNewslettersMetadataAction",["$InternalEnum","Promise","WAJids","WAJobOrchestratorTypes","WALogger","WAWebBackendErrors","WAWebCommonNewsletterEnums","WAWebContactCollection","WAWebContactProfilePicThumbBridge","WAWebCreateChat","WAWebDBBulkPersistProfilePic","WAWebNewsletterBridgeApi","WAWebNewsletterCollection","WAWebNewsletterDeleteChatJob","WAWebNewsletterGetAdminCapabilitiesJob","WAWebNewsletterGetAdminCountJob","WAWebNewsletterGetNewsletterEnforcementAlertAction","WAWebNewsletterMembershipUtil","WAWebNewsletterMetadataCollection","WAWebNewsletterMetadataJob","WAWebNewsletterModelUtils","WAWebNewsletterPullMessagesFromServerAction","WAWebNewsletterStorageUtils","WAWebNewsletterSystemMessages","WAWebNewsletterUpdateNewslettersRecordsJob","WAWebNoop","WAWebProfilePicThumbCollection","WAWebSchemaChat","WAWebViewMode.flow","WAWebViewModeUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S;function R(e){return e!=null&&Number.isInteger(e)&&e>0}var L=n("$InternalEnum").Mirrored(["Bootstrap","DirtyBit","Debug"]);function E(e,t){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){r===void 0&&(r={}),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][queryAndUpdateAllNewsletterMetadataAction] Start"])));var a=r!=null?r:{},i=a.messageCount,l=a.addSystemMsgs,m=a.qplEvent;try{var p;m==null||m.annotate({string:{entryPoint:t}}),m==null||m.addPoint("getAllNewslettersMetadata_start");var _=yield o("WAWebNewsletterMetadataJob").getAllNewslettersMetadata(),f=_.newsletters,g=_.deletedNewsletters,h=f.reduce(function(e,t){var n;e.chats.push(o("WAWebNewsletterModelUtils").mapNewsletterToChat(t)),e.metadata.push(o("WAWebNewsletterModelUtils").mapNewsletterToMetadata(t));var r=(n=t.newsletterPictureMetadataMixin)==null?void 0:n.picture;return r!=null&&e.pics.push(o("WAWebNewsletterModelUtils").mapPicturesToProfilePicThumb(t.idJid,r)),e},{chats:[],metadata:[],pics:[]}),y=h.chats,C=h.metadata,b=h.pics;m==null||m.addPoint("getAllNewslettersMetadata_end"),m==null||m.addPoint("processDeletedNewsletters_start"),yield $(g),m==null||m.addPoint("processDeletedNewsletters_end");var v=(p=f.map(function(e){return e.idJid})).concat.apply(p,((g==null?void 0:g.id)||[]).map(function(e){return e.jid}));return t===L.DirtyBit&&(m==null||m.addPoint("processUnsubscribedNewsletters_start"),yield N(v),m==null||m.addPoint("processUnsubscribedNewsletters_end")),m==null||m.addPoint("fetchAdminCountsForOwnerNewsletter_start"),yield(S||(S=n("Promise"))).all(C.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(o("WAWebNewsletterMembershipUtil").iAmOwner(e)){var t=yield o("WAWebNewsletterGetAdminCountJob").getNewsletterAdminCount(o("WAJids").toNewsletterJid(e.id.toString()));e.adminCount=t}});return function(t){return e.apply(this,arguments)}})())),m==null||m.addPoint("fetchAdminCountsForOwnerNewsletter_start"),o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][queryAndUpdateAllNewsletterMetadataAction] Update local model"]))),yield D({chats:y,metadata:C,pics:b,messageCount:i,addSystemMsgs:l,qplEvent:m}),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][getNewsletterEnforcementsUpdatesAction] Update local model"]))),m==null||m.addPoint("processChannelEnforcementsUpdates_start"),yield S.all(C.map(function(e){o("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(e)&&o("WAWebNewsletterGetNewsletterEnforcementAlertAction").getNewsletterEnforcementAlertAction(o("WAWebWidFactory").createWid(e.id.toString()),o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION)})),m==null||m.addPoint("processChannelEnforcementsUpdates_end"),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][queryAndUpdateAllNewsletterMetadataAction] End"]))),{chats:y,success:!0}}catch(e){return o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][queryAndUpdateAllNewsletterMetadataAction] Failed to retrieve the list of newsletters"]))).tags("newsletter").devConsole(e).sendLogs("newsletter-failed-to-retrieve-newsletters"),{success:!1}}}),k.apply(this,arguments)}function I(e,t){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][queryAndUpdateNewsletterMetadataAction] Start"])));try{var n,a,i,l=o("WAWebNewsletterModelUtils").getRoleByIdentifier(e),s=yield o("WAWebNewsletterMetadataJob").getNewsletterMetadata(e,l,t==null?void 0:t.fields);if(s==null)return;var u=o("WAWebNewsletterModelUtils").mapNewsletterToChat(s),c=o("WAWebNewsletterModelUtils").mapNewsletterToMetadata(s),d=(n=s.newsletterPictureMetadataMixin)==null?void 0:n.picture,f=d?[o("WAWebNewsletterModelUtils").mapPicturesToProfilePicThumb(e,d)]:[],g=void 0,h=(a=t==null?void 0:t.adminFields)!=null?a:{},y=h.adminCount;y===!0&&(g=yield o("WAWebNewsletterGetAdminCountJob").getNewsletterAdminCount(e));var C=void 0,b=(i=t==null?void 0:t.adminFields)!=null?i:{},v=b.capabilities;return v===!0&&(C=yield o("WAWebNewsletterGetAdminCapabilitiesJob").getNewsletterAdminCapabilities(e)),yield D({chats:[u],metadata:[babelHelpers.extends({},c,{adminCount:g,capabilities:C})],pics:f,messageCount:t==null?void 0:t.messageCount}),o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][queryAndUpdateNewsletterMetadataAction] End"]))),r("WAWebNewsletterCollection").get(s.idJid)}catch(e){if(e instanceof o("WAWebBackendErrors").ServerStatusCodeError&&e.statusCode===405)return;o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][queryAndUpdateNewsletterMetadataAction] Failed to retrieve newsletter metadata"]))).tags("newsletter").devConsole(e).sendLogs("newsletter-failed-to-retrieve-newsletter")}}),T.apply(this,arguments)}function D(e){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.chats,a=e.metadata,i=e.pics,l=e.messageCount,s=e.addSystemMsgs,u=e.qplEvent;o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][updateCollections] Start"])));var c=w(t,a,i),d=c.filteredChats,m=c.filteredMetadata,p=c.filteredPics;u==null||u.addPoint("updateNewsletterChatRecords_start"),yield o("WAWebNewsletterUpdateNewslettersRecordsJob").updateNewsletterChatRecords(d.map(o("WAWebCreateChat").createNewsletterObjectForStorage)),u==null||u.addPoint("updateNewsletterChatRecords_end"),o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][updateCollections][chat] Persist changes to DB"]))),u==null||u.addPoint("updateNewsletterMetadata_start"),yield o("WAWebNewsletterMetadataJob").updateNewsletterMetadata(m.map(o("WAWebNewsletterStorageUtils").createNewsletterMetadataObjectForStorage)),u==null||u.addPoint("updateNewsletterMetadata_end"),o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][updateCollections][metadata] Persist changes to DB"]))),u==null||u.addPoint("bulkPersistProfilePicChanges_start"),yield o("WAWebDBBulkPersistProfilePic").bulkPersistProfilePicChanges(p.map(function(e){var t,n,r,a;if(Object.prototype.hasOwnProperty.call(e,"eurl")){var i=o("WAWebWidFactory").createWid(e.id.toString());return o("WAWebContactProfilePicThumbBridge").mapProfilePictureToProfilePicThumbRowType(i,{id:i,tag:(t=e.tag)!=null?t:void 0,eurl:(n=e.eurl)!=null?n:void 0,previewEurl:(r=e.previewEurl)!=null?r:void 0,stale:e.stale,eurlStale:!1,timestamp:(a=e.timestamp)!=null?a:Date.now()})}}).filter(Boolean)),u==null||u.addPoint("bulkPersistProfilePicChanges_end"),o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][updateCollections][picture] Persist changes to DB"]))),o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][queryAndUpdateAllNewsletterMetadataAction] Update local model"]))),r("WAWebNewsletterMetadataCollection").add(a,{merge:!0}),o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.add(i,{merge:!0}),r("WAWebNewsletterCollection").add(t,{merge:!0}),u==null||u.addPoint("pullNewsletterMessagesFromServer_start"),o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][queryAndUpdateAllNewsletterMetadataAction][messages] Start"]))),R(l)&&(yield(S||(S=n("Promise"))).all(r("WAWebNewsletterCollection").filter(function(e){var t;return!((t=e.newsletterMetadata)!=null&&t.isSuspendedOrTerminated)}).map(function(e){return o("WAWebNewsletterPullMessagesFromServerAction").pullNewsletterMessagesFromServer(e,{messageCount:l,resetUnreadCount:!0}).then(function(t){if(t.filter(function(e){return e.isWamoSub!==!0||o("WAWebViewModeUtils").isViewModeVisibleInSurface(o("WAWebViewMode.flow").ViewModeSurface.CHAT,e.viewMode)}).length===0&&s===!0)return o("WAWebNewsletterSystemMessages").addSystemMessagesToChat(e)}).catch(r("WAWebNoop"))}))),u==null||u.addPoint("pullNewsletterMessagesFromServer_end"),o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][queryAndUpdateAllNewsletterMetadataAction][messages] End"]))),u==null||u.addPoint("contactUpdates_start");var _=a.filter(function(e){return e.name}).map(function(e){return{id:e.id,name:e.name}});o("WAWebContactCollection").ContactCollection.add(_,{merge:!0}),u==null||u.addPoint("contactUpdates_end")}),x.apply(this,arguments)}function $(e){return P.apply(this,arguments)}function P(){return P=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e!=null){var t=e.id.map(function(e){return{id:e.jid.toString(),terminated:!0}}),n=e.id.map(function(e){return{id:o("WAWebWidFactory").createWid(e.jid),terminated:!0}});yield o("WAWebNewsletterMetadataJob").updateNewsletterMetadata(t),r("WAWebNewsletterMetadataCollection").add(n,{merge:!0})}}),P.apply(this,arguments)}function N(e){return M.apply(this,arguments)}function M(){return M=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebSchemaChat").getChatTable().all(),r=t.map(function(e){return o("WAWebWidFactory").createWid(e.id)}).filter(function(t){var n=o("WAJids").validateNewsletterJid(t.toJid());return n!=null&&!e.includes(n)}),a=[];r.map(function(e){a.push(o("WAWebNewsletterBridgeApi").NewsletterBridgeApi.deleteNewsletter({id:e,keep:!1})),a.push(o("WAWebNewsletterMetadataJob").deleteNewsletterMetadata(e.toString())),a.push(o("WAWebNewsletterDeleteChatJob").deleteNewsletterChat(e)),a.push(o("WAWebNewsletterMetadataJob").deleteNewsletterPicture(e.toString()))}),yield(S||(S=n("Promise"))).all(a)}),M.apply(this,arguments)}function w(e,t,n){var a=t.filter(function(e){if(e.membershipType!=null)return e.membershipType===o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest;var t=r("WAWebNewsletterMetadataCollection").get(e.id);return t==null?!1:t.membershipType===o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest}).map(function(e){return e.id}),i=e.filter(function(e){return!a.includes(e.id)}),l=t.filter(function(e){return!a.includes(e.id)}),s=n.filter(function(e){return!a.includes(e.id)});return{filteredChats:i,filteredMetadata:l,filteredPics:s}}l.NewsletterMetadataUpdateEntryPoint=L,l.queryAndUpdateAllNewsletterMetadataAction=E,l.queryAndUpdateNewsletterMetadataAction=I,l.updateCollections=D}),98);
__d("WAWebUpdateNewsletterMsgUIAction",["Promise","WAAckLevel","WAJids","WATimeUtils","WAWebFrontendMsgGetters","WAWebMsgCollection","WAWebMsgDataFromModel","WAWebMsgGetters","WAWebMsgType","WAWebNewsletterCollection","WAWebNewsletterDBUtils","WAWebNewsletterDeleteChatJob","WAWebNewsletterMessageDeliveryUpdateAction","WAWebNewsletterPollVotesModelCollection","WAWebNewsletterReactionCollection","WAWebQueryAndUpdateNewslettersMetadataAction","WAWebReactionsMsgAction","WAWebRevokeMsgAction","WAWebUpdateLastAddOnPreviewChatAction","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WAJids").toNewsletterJid(t.toJid()),a=r("WAWebNewsletterCollection").get(t);if(a==null&&(a=yield o("WAWebQueryAndUpdateNewslettersMetadataAction").queryAndUpdateNewsletterMetadataAction(n),a!=null&&r("WAWebNewsletterCollection").add(a)),a==null){yield o("WAWebNewsletterDeleteChatJob").deleteNewsletterChat(t);return}if(e.type==="reaction")return c(e);if(e.type==="poll_update")return e.subtype==="poll_vote"?m(e):void 0;if(e.subtype==="admin_revoke")return p(e,t);e.type!==o("WAWebMsgType").MSG_TYPE.PROTOCOL&&(yield o("WAWebMsgCollection").MsgCollection.processMultipleMessages(a.id,[babelHelpers.extends({},o("WAWebMsgDataFromModel").msgDataFromMsgModel(e),{recvFresh:!0,isNewMsg:!0})],{},"updateNewsletterMessageUI",a.msgs,!0))}),u.apply(this,arguments)}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebMsgCollection").MsgCollection.get(e.reactionParentKey),n=e.reactionText;if(t!=null){var r=t.serverId;if(r!=null){o("WAWebNewsletterReactionCollection").updateOrCreateMessageReaction({parentMsg:t,reactionMsg:e,reactionCode:n});var a={msgKey:e.id.toString(),parentMsgKey:o("WAWebNewsletterDBUtils").craftNewsletterMsgKeyFromServerId(r,e.from).toString(),senderUserJid:o("WAWebUserPrefsMeUser").getMePnUserOrThrow().toString(),reactionText:n,timestamp:e.t*1e3,orphan:0,read:!0,ack:o("WAAckLevel").ACK.SENT};yield o("WAWebReactionsMsgAction").addOrUpdateReactionsModelCollection(a,{allowNotify:!1})}}}),d.apply(this,arguments)}function m(e){if(e.pollUpdateParentKey!=null){var t=o("WAWebMsgCollection").MsgCollection.get(e.pollUpdateParentKey);if(!(t==null||e.type!==o("WAWebMsgType").MSG_TYPE.POLL_UPDATE)){var n=e.senderTimestampMs;o("WAWebNewsletterPollVotesModelCollection").updateOrCreatePollVote({msgKey:e.id,parentMsgKey:t.id,selectedOptionLocalIds:new Set(e.selectedOptionLocalIds),timestamp:n!=null?o("WATimeUtils").castToMillisTime(n):o("WATimeUtils").castUnixTimeToMillisTime(o("WATimeUtils").castToUnixTime(e.t))})}}}function p(e,t){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a){var i,l=(i=r("WAWebNewsletterCollection").get(a))==null?void 0:i.msgs.get(t.protocolMessageKey);return l==null?(e||(e=n("Promise"))).resolve():(o("WAWebUpdateLastAddOnPreviewChatAction").deleteModelsForLastAddOnPreview([l.id.toString()]),yield o("WAWebNewsletterMessageDeliveryUpdateAction").removeMessageDeliveryUpdates(o("WAWebFrontendMsgGetters").getChat(l),[l]),(e||(e=n("Promise"))).resolve(o("WAWebRevokeMsgAction").revoke(l,{subtype:t.subtype,msgKey:t.id,sender:o("WAWebMsgGetters").getIsSentByMe(t)?o("WAWebUserPrefsMeUser").getMePnUserOrThrow():t.from,revokeTimestamp:t.t,viewMode:t.viewMode})))}),_.apply(this,arguments)}l.updateNewsletterMessageUI=s}),98);
__d("WAWebNewsletterInsightUtils",["$InternalEnum","WALogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s=n("$InternalEnum").Mirrored(["Available","Missing"]);function u(t){switch(t){case"OK":return s.Available;case"MISSING":return s.Missing;default:return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Encountered unexpected status"]))).tags("newsletter-admin-insights").devConsole(t),s.Missing}}l.NewsletterInsightDataStatus=s,l.getNewsletterInsightsDataStatus=u}),98);
__d("WAWebNewsletterAdminInsightsModel",["fbt","WAWebBaseModel","WAWebClock","WAWebModelUtils","WAWebNewsletterInsightUtils","WAWebWid"],(function(t,n,r,o,a,i,l,s){"use strict";var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.rangeStart=o("WAWebModelUtils").prop(),t.rangeEnd=o("WAWebModelUtils").prop(),t.dataStatus=o("WAWebModelUtils").prop(function(){return o("WAWebNewsletterInsightUtils").NewsletterInsightDataStatus.Available}),t.accountsReached=o("WAWebModelUtils").prop(),t.reachDelta=o("WAWebModelUtils").prop(),t.followersReached=o("WAWebModelUtils").prop(),t.nonFollowersReached=o("WAWebModelUtils").prop(),t.reachByCountry=o("WAWebModelUtils").prop(function(){return[]}),t.followers=o("WAWebModelUtils").prop(),t.followersDelta=o("WAWebModelUtils").prop(),t.followersByCountry=o("WAWebModelUtils").prop(function(){return[]}),t.netFollows=o("WAWebModelUtils").prop(),t.growthChartData=o("WAWebModelUtils").prop(function(){return[]}),t.growthChart=o("WAWebModelUtils").derived(function(){var e=this.growthChartData;return e.length===0?[]:[{data:e,dataLabels:[{label:s._(/*BTDS*/"Cantidad neta de seguidores nuevos"),key:"net-follows"},{label:s._(/*BTDS*/"Cuentas que comenzaron a seguirte"),key:"follows"},{label:s._(/*BTDS*/"Cuentas que dejaron de seguirte"),key:"unfollows"}],dataSetLabel:{label:s._(/*BTDS*/"Crecimiento"),key:"growth"}}]},["growthChartData"]),t.rangeInDays=o("WAWebModelUtils").derived(function(){var e=this.rangeStart,t=this.rangeEnd;return e==null||t==null?0:o("WAWebClock").Clock.daysDeltaAbs(e,t)+1},["rangeStart","rangeEnd"]),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="newsletterInsights",e.idClass=r("WAWebWid");var u=o("WAWebBaseModel").defineModel(e);l.NewsletterAdminInsights=u}),226);
__d("WAWebNewsletterSubscriberModel",["WAWebBaseModel","WAWebModelUtils","WAWebWid"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebModelUtils").prop(),t.membership=o("WAWebModelUtils").prop(),t.isPendingAdmin=o("WAWebModelUtils").prop(),t.contact=o("WAWebModelUtils").session(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="newsletterSubscriber",e.idClass=r("WAWebWid");var s=o("WAWebBaseModel").defineModel(e);l.NewsletterSubscriber=s}),98);
__d("WAWebNewsletterBridgeApi",["WALogger","WAWebCommonNewsletterEnums","WAWebContactCollection","WAWebDBUpdateLastAddOnPreviewChat","WAWebLastAddOnDBSerialization","WAWebMexNewsletterRoleChangeNotificationHandler","WAWebMexNewsletterUtils","WAWebMsgCollection","WAWebMsgModelFromData","WAWebMsgType","WAWebNewsletterAdminInsightsModel","WAWebNewsletterBridgeMsgAddOnsUtils","WAWebNewsletterCollection","WAWebNewsletterEnforcementAlertCollection","WAWebNewsletterGatingUtils","WAWebNewsletterMetadataCollection","WAWebNewsletterModelUtils","WAWebNewsletterPullMessagesFromServerAction","WAWebNewsletterQuestionResponseCollection","WAWebNewsletterReportCollection","WAWebNewsletterSubscriberModel","WAWebNewsletterValidationUtils","WAWebProfilePicThumbCollection","WAWebQueryAndUpdateNewslettersMetadataAction","WAWebShouldUpdateLastAddOnPreview","WAWebShowNewsletterMetadataUpdateNotification","WAWebShowNewsletterRoleChangeNotification","WAWebUpdateLastAddOnPreviewChatAction","WAWebUpdateNewsletterMsgUIAction","WAWebUpdateUnreadChatAction","WAWebUserPrefsNewsletter","WAWebWidFactory","asyncToGeneratorRuntime","lodash"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=["id"],m=["id"],p=["id"],_=["id"],f=["id"],g=["id"];function h(e,t){var n=r("WAWebNewsletterCollection").get(e);n==null||n.mute.setMute(t,!1,!0)}var y={updateNewsletterMessageUI:function(t){var e=t.msg,n=t.chatID,r=t.isOrphan;if(!r){var a=o("WAWebMsgModelFromData").msgModelFromMsgData(e);return o("WAWebUpdateNewsletterMsgUIAction").updateNewsletterMessageUI(a,n)}},deleteNewsletter:function(t){var e,n=t.id,a=t.keep,i=r("WAWebNewsletterCollection")==null?void 0:r("WAWebNewsletterCollection").get(n),l=i==null?void 0:i.newsletterMetadata;if(a){l!=null&&(l.membershipType=o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest);return}var s=i==null?void 0:i.msgs;s!=null&&o("WAWebMsgCollection").MsgCollection.remove(s),i==null||i.delete(),i==null||(e=i.newsletterMetadata)==null||e.delete(),o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.remove(n)},joinNewsletter:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.newsletter,n=e.metadata,a=e.pic,i=e.msgs,l=e.noEarlierMsgs,s=r("WAWebNewsletterCollection").gadd(t,{merge:!0});i!=null&&(yield o("WAWebMsgCollection").MsgCollection.processMultipleMessages(s.id,i,{isHistory:!0,add:"search"},"joinNewsletter",s.msgs)),l===!0&&(s.msgs.msgLoadState.noEarlierMsgs=!0),o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.add(a,{merge:!0}),r("WAWebNewsletterMetadataCollection").add(n,{merge:!0})});function t(t){return e.apply(this,arguments)}return t})(),updateNewsletterMetadata:function(t){var e=t.metadata,n=t.newsletter,a=t.pic,i=e.id,l=babelHelpers.objectWithoutPropertiesLoose(e,d),s=n.id,u=babelHelpers.objectWithoutPropertiesLoose(n,m),c=a.id,_=babelHelpers.objectWithoutPropertiesLoose(a,p);r("WAWebNewsletterCollection").gadd(i).set(r("lodash").pickBy(u,function(e){return e!=null}),{merge:!0}),r("WAWebNewsletterMetadataCollection").gadd(i).set(r("lodash").pickBy(l,function(e){return e!=null}),{merge:!0}),o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.gadd(i).set(_,{merge:!0}),l.name!=null&&o("WAWebContactCollection").ContactCollection.gadd(i).set({name:l.name},{merge:!0})},muteNewsletter:function(t){var e=t.id;h(e,o("WAWebNewsletterModelUtils").MUTED_STATE)},unmuteNewsletter:function(t){var e=t.id;h(e,o("WAWebNewsletterModelUtils").UNMUTED_STATE)},updateNewsletterSubscriberCount:function(t){var e,n,o=t.id,a=t.update,i=r("WAWebNewsletterCollection")==null||(e=r("WAWebNewsletterCollection").get(o))==null?void 0:e.newsletterMetadata;if(i!=null){var l=i.size,s=(n=a.newSubscriberCount)!=null?n:Number(a.increment)+l;i.set("size",s)}},updateNewsletterUnreadMsgCount:function(t){var e=t.id,n=r("WAWebNewsletterCollection").get(e);n!=null&&o("WAWebUpdateUnreadChatAction").updateUnreadCountMD(n,0,!1)},subscribeToNewsletter:function(n){var t=n.newsletter,a=t.newsletterMetadata;if(a==null){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[subscribeToNewsletter] called with newsletterMetadata = null"])));return}a.membershipType=o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber,r("WAWebNewsletterCollection").add(t,{merge:!0})},loadNewsletterPreviewChat:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.metadata,n=e.pic,a=e.newsletter,i=e.messages,l=t.id,s=babelHelpers.objectWithoutPropertiesLoose(t,_);if(r("WAWebNewsletterMetadataCollection").gadd(l).set(s,{merge:!0}),n!=null){var u=n.id,c=babelHelpers.objectWithoutPropertiesLoose(n,f);o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.gadd(l).set(c,{merge:!0})}o("WAWebContactCollection").ContactCollection.add({id:l,name:t.name},{merge:!0}),r("WAWebNewsletterCollection").add(a,{merge:!0});var d=r("WAWebNewsletterCollection").get(l);return d!=null&&i!=null&&(yield o("WAWebMsgCollection").MsgCollection.processMultipleMessages(d.id,i,{isHistory:!0,add:"search"},"loadPreviewNewsletter",d.msgs)),d});function t(t){return e.apply(this,arguments)}return t})(),terminateNewsletter:function(t){var e=t.id,n=t.msgs;if(r("WAWebNewsletterMetadataCollection")==null||r("WAWebNewsletterMetadataCollection").gadd(e).set({terminated:!0},{merge:!0}),n!=null){var o;(o=r("WAWebNewsletterCollection").get(e))==null||o.msgs.add(n)}},updateNewsletterPicture:function(t){var e=t.pic,n=e.id,r=babelHelpers.objectWithoutPropertiesLoose(e,g);o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.gadd(n).set(r,{merge:!0})},updateNewsletterMessages:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=e.reactions,r=e.reactionIdsToRemove,a=e.timestamp,i=e.ids,l=e.viewCounts,s=e.pollVotes,u=e.questionResponsesCounts,c=e.msgs;yield(t=o("WAWebNewsletterBridgeMsgAddOnsUtils")).updateReactions({ids:i,reactions:n,reactionIdsToRemove:r}),yield t.updatePollVotes({ids:i,pollVotes:s}),t.updateViewCounts(l),t.updateQuestionResponsesCounts(u),t.updateLastUpdateTs(i,a);var d=c==null?void 0:c.filter(function(e){return e.kind===o("WAWebMsgType").MsgKind.RevokedMessage});d!=null&&d.length>0&&(yield o("WAWebMsgCollection").MsgCollection.processMultipleMessages(d[0].id.remote,d,{},"updateNewsletterMessages"))});function t(t){return e.apply(this,arguments)}return t})(),updateNewsletterMessageDeliveryUpdate:function(t){var e,n,a=t.id,i=t.modelUpdatesToAdd,l=t.modelUpdatesToRemove,s=r("WAWebNewsletterCollection").get(a);s!=null&&((e=s.newsletterMetadata)==null||e.messageDeliveryUpdates.remove(l),(n=s.newsletterMetadata)==null||n.messageDeliveryUpdates.add(i.map(function(e){var t=o("WAWebMsgModelFromData").msgModelFromMsgData(e.msgData);return o("WAWebMsgCollection").MsgCollection.add(t,{merge:!0}),babelHelpers.extends({},e,{msgModel:t})}),{merge:!0}))},findMsgKeyFromServerId:function(t){var e,n=t.from,o=t.serverId,a=r("WAWebNewsletterCollection").get(n);return a==null||(e=a.msgs)==null||(e=e.findFirst(function(e){return e.serverId===o}))==null?void 0:e.id},updateMsgsViewed:function(t){var e=t.ids;e.forEach(function(e){var t;(t=o("WAWebMsgCollection").MsgCollection.get(e))==null||t.set("viewed",!0)})},updateGeosuspendedCountry:function(t){var e=t.id,n=t.countryCodes,o=t.toAdd,a=r("WAWebNewsletterCollection").get(e);if(a!=null)if(o){var i;(i=a.newsletterMetadata)==null||i.geosuspendedCountries.add(n.map(function(e){return{id:e,geosuspended:!0}}))}else{var l;(l=a.newsletterMetadata)==null||l.geosuspendedCountries.remove(n.map(function(e){return e}))}},suspendNewsletter:function(t){var e=t.id;r("WAWebNewsletterMetadataCollection").gadd(e).set({suspended:!0},{merge:!0})},geosuspendNewsletter:function(t){var e=t.id;r("WAWebNewsletterMetadataCollection").gadd(e).set({suspended:!0,geosuspended:!0},{merge:!0})},updateProfilePictureDeletionAlertState:function(t){var e=t.newsletterWid;r("WAWebNewsletterMetadataCollection").gadd(e).set({hasProfilePictureDeletionAlerts:!0},{merge:!0})},getActiveNewsletter:function(){var e;return(e=r("WAWebNewsletterCollection").getActive())==null?void 0:e.id},getNewsletterMetadata:function(t){var e,n=t.id;return(e=r("WAWebNewsletterCollection").get(n))==null?void 0:e.newsletterMetadata},handleMyRoleChangeNotification:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=e.jid,a=o("WAWebWidFactory").createWid(n),i=r("WAWebNewsletterCollection").get(a);i==null||(t=i.newsletterMetadata)==null||(t=t.subscribers)==null||t.reset();var l=i!=null;yield o("WAWebQueryAndUpdateNewslettersMetadataAction").queryAndUpdateNewsletterMetadataAction(n,{messageCount:l?void 0:1,fields:{membership:!0,state:!0,creationTime:l?void 0:!0,description:l?void 0:!0,handle:l?void 0:!0,inviteLink:l?void 0:!0,linkedAccounts:l?void 0:!0,muted:l?void 0:!0,name:l?void 0:!0,picture:l?void 0:!0,privacy:l?void 0:!0,subscribers:l?void 0:!0,verification:l?void 0:!0}})});function t(t){return e.apply(this,arguments)}return t})(),displayRoleChangeDesktopNotification:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=e.notification,a=n.xwa2_notify_newsletter_admin_promote!=null?"promote":"demote",i=(t=n.xwa2_notify_newsletter_admin_promote)!=null?t:n.xwa2_notify_newsletter_admin_demote;if(i!=null){var l=i!=null?r("WAWebNewsletterCollection").get(i==null?void 0:i.id):null,s=o("WAWebMexNewsletterRoleChangeNotificationHandler").getUserIdFromPayload(babelHelpers.extends({},i.user)),u=o("WAWebMexNewsletterUtils").mapRoleToMembership(i.user_new_role);if(!(s==null||l==null||u==null)){var c=i.admin&&o("WAWebMexNewsletterRoleChangeNotificationHandler").getUserIdFromPayload(babelHelpers.extends({},i.admin)),d=l;yield o("WAWebShowNewsletterRoleChangeNotification").showNewsletterRoleChangeNotification({mode:a,user:s,admin:c,chat:d,newRole:u})}}});function t(t){return e.apply(this,arguments)}return t})(),handleOtherUserRoleChangeNotification:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n,a=e.jid,i=e.userId,l=e.newRole,s=o("WAWebWidFactory").createWid(a),u=r("WAWebNewsletterCollection").get(s),c=u==null||(t=u.newsletterMetadata)==null||(t=t.subscribers)==null?void 0:t.get(i);if(c!=null)c.membership=l;else{var d=o("WAWebContactCollection").ContactCollection.get(i);if(!d&&o("WAWebNewsletterGatingUtils").isNewsletterMultiAdminLidMigrationEnabled()&&(d=o("WAWebContactCollection").ContactCollection.gadd({id:i,type:"out"})),l===o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin&&d){var m;u==null||(m=u.newsletterMetadata)==null||(m=m.subscribers)==null||m.add(new(o("WAWebNewsletterSubscriberModel")).NewsletterSubscriber({id:i,membership:l,isPendingAdmin:!1,contact:d}))}}if(u==null||(n=u.newsletterMetadata)==null||(n=n.subscribers)==null||n.sort(),l===o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin){var p;u==null||(p=u.newsletterMetadata)==null||(p=p.pendingAdmins)==null||p.remove(i)}});function t(t){return e.apply(this,arguments)}return t})(),updateChatPreviewFromReaction:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.reactionMsgObj,n=e.parentMsgKey,r=yield o("WAWebShouldUpdateLastAddOnPreview").filterChatsWithAddOnPreviewUpdates([o("WAWebLastAddOnDBSerialization").lastAddOnPreviewCandidateFromReactionRowType(babelHelpers.extends({},t,{parentMsgKey:n.toString()}))]);r.size>0&&(yield o("WAWebDBUpdateLastAddOnPreviewChat").updateDatabaseForLastAddOnPreview(r),o("WAWebUpdateLastAddOnPreviewChatAction").updateModelsForLastAddOnPreview(r))});function t(t){return e.apply(this,arguments)}return t})(),updateChatPreviewFromVote:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.voteMsgObj,n=e.parentMsgKey,r=yield o("WAWebShouldUpdateLastAddOnPreview").filterChatsWithAddOnPreviewUpdates([o("WAWebLastAddOnDBSerialization").lastAddOnPreviewCandidateFromVoteData(babelHelpers.extends({},t,{parentMsgKey:n}),!1)]);r.size>0&&(yield o("WAWebDBUpdateLastAddOnPreviewChat").updateDatabaseForLastAddOnPreview(r),o("WAWebUpdateLastAddOnPreviewChatAction").updateModelsForLastAddOnPreview(r))});function t(t){return e.apply(this,arguments)}return t})(),updateNewsletterReports:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.reports;o("WAWebNewsletterReportCollection").NewsletterReportCollection.reset(),o("WAWebNewsletterReportCollection").NewsletterReportCollection.add(t)});function t(t){return e.apply(this,arguments)}return t})(),updateNewsletterReport:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.report;o("WAWebNewsletterReportCollection").NewsletterReportCollection.add(t,{merge:!0})});function t(t){return e.apply(this,arguments)}return t})(),updateNewsletterEnforcementAlerts:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.enforcementAlerts;o("WAWebNewsletterEnforcementAlertCollection").NewsletterEnforcementAlertCollection.reset(),o("WAWebNewsletterEnforcementAlertCollection").NewsletterEnforcementAlertCollection.add(t)});function t(t){return e.apply(this,arguments)}return t})(),updateNewsletterQuestionResponses:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.responses,n=e.append;n||o("WAWebNewsletterQuestionResponseCollection").QuestionResponseCollection.reset(),o("WAWebNewsletterQuestionResponseCollection").QuestionResponseCollection.add(t)});function t(t){return e.apply(this,arguments)}return t})(),hideNewsletterQuestionResponse:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=e.responseServerId,r=e.questionServerId,a=yield(t=o("WAWebNewsletterQuestionResponseCollection").QuestionResponseCollection.filter(function(e){return e.responseServerId===n&&e.questionServerId===r}))==null?void 0:t[0];a!=null&&o("WAWebNewsletterQuestionResponseCollection").QuestionResponseCollection.remove(a)});function t(t){return e.apply(this,arguments)}return t})(),updateMyNewsletterMembershipRole:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.newsletter,n=e.newRole,a=t.newsletterMetadata;if(a==null){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[updateNewsletterMembershipRole] called with newsletterMetadata = null"])));return}a.membershipType=n,r("WAWebNewsletterCollection").add(t,{merge:!0})});function t(t){return e.apply(this,arguments)}return t})(),updateNewsletterMemberRole:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=e.newsletter,r=e.member,a=e.newRole,i=n.newsletterMetadata;if(i==null){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[updateNewsletterMembershipRole] called with newsletterMetadata = null"])));return}var l=(t=i.subscribers)==null?void 0:t.get(r.id);if(l!=null){var s;l.membership=a,(s=n.newsletterMetadata)==null||(s=s.subscribers)==null||s.sort();var c=o("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(n.id.toJid());yield o("WAWebUserPrefsNewsletter").flushCachedNewsletterSubscribers(c)}});function t(t){return e.apply(this,arguments)}return t})(),displayNewsletterMetadataUpdateNotification:function(t){var e=t.notification,n=e.newsletterId,a=e.actorId,i=e.updates,l=r("WAWebNewsletterCollection").get(n);l!=null&&o("WAWebShowNewsletterMetadataUpdateNotification").showNewsletterMetadataUpdateNotification({chat:l,user:a,updates:i})},expireNewsletterAdminInvites:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.expiredMsgData;t.forEach(function(e){var t,n=e.id,r=e.newsletterAdminInviteInfo;(t=o("WAWebMsgCollection").MsgCollection.get(n))==null||t.set({newsletterAdminInviteInfo:r})})});function t(t){return e.apply(this,arguments)}return t})(),updateNewsletterInsights:function(t){var e=t.newsletter,n=t.insights,r=e.newsletterMetadata;if(r==null){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[updateNewsletterInsights] called with newsletterMetadata = null"])));return}var a=r.adminInsights;a==null?r.adminInsights=new(o("WAWebNewsletterAdminInsightsModel")).NewsletterAdminInsights(n):a.set(babelHelpers.extends({},n))},handleNewsletterWamoSubStatusChangeNotification:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.jid,n=e.wamoSubStatus,a=o("WAWebWidFactory").createWid(t),i=r("WAWebNewsletterCollection").get(a);if(i!=null){var l=i.newsletterMetadata;l!=null&&(l.wamoSubStatus=n),yield o("WAWebQueryAndUpdateNewslettersMetadataAction").queryAndUpdateNewsletterMetadataAction(t),n===o("WAWebCommonNewsletterEnums").WamoSubStatus.ACTIVE&&(yield o("WAWebNewsletterPullMessagesFromServerAction").pullNewsletterMessagesFromServer(i,{messageCount:o("WAWebNewsletterGatingUtils").getMaxMsgCountFromServer()}))}});function t(t){return e.apply(this,arguments)}return t})()};l.NewsletterBridgeApi=y}),98);
__d("WAWebNewsletterBridgeMsgAddOnsUtils",["Promise","WAWebMsgCollection","WAWebNewsletterPollVotesModelCollection","WAWebNewsletterReactionCollection","WAWebNoop","WAWebPollsCreateOptionLocalIdMap","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){if(e!=null&&e.size>0)for(var t of e.entries()){var n=t[0],r=t[1],a=o("WAWebMsgCollection").MsgCollection.get(n);a==null||a.set("viewCount",r)}}function u(e){if(e!=null&&e.size>0)for(var t of e.entries()){var n=t[0],r=t[1],a=o("WAWebMsgCollection").MsgCollection.get(n);a==null||a.set("questionResponsesCount",r)}}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a,i=t.reactions,l=t.ids,s=t.reactionIdsToRemove;s!=null&&o("WAWebNewsletterReactionCollection").NewsletterMessageReactionsCollection.remove(s),yield(e||(e=n("Promise"))).all((a=l.map(function(e){return o("WAWebNewsletterReactionCollection").NewsletterMessageReactionsCollection.find(e.toString()).catch(r("WAWebNoop"))}))!=null?a:[]),o("WAWebNewsletterReactionCollection").NewsletterMessageReactionsCollection.add(i.map(function(e){return{id:e.parentMsgKey,reactionCountMap:e.emojiCountMap,reactionCountMapTs:e.serverTimestamp}}),{merge:!0})}),d.apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a,i=t.pollVotes,l=t.ids;yield(e||(e=n("Promise"))).all((a=l.map(function(e){return o("WAWebNewsletterPollVotesModelCollection").NewsletterPollVotesModelCollection.find(e).catch(r("WAWebNoop"))}))!=null?a:[]);var s=yield e.all(i.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebMsgCollection").MsgCollection.get(e.parentMsgKey),n=t==null?void 0:t.pollOptions;if(n!=null){var r=yield o("WAWebPollsCreateOptionLocalIdMap").createOptionLocalIdMap(n);return{id:e.parentMsgKey,pollVotesCountMap:_(e.voteCountMap,r),pollVotesCountMapTs:e.serverTimestamp}}});return function(t){return e.apply(this,arguments)}})()));o("WAWebNewsletterPollVotesModelCollection").NewsletterPollVotesModelCollection.add(s.filter(Boolean),{merge:!0})}),p.apply(this,arguments)}function _(e,t){var n=new Map;for(var r of e.entries()){var o=r[0],a=r[1];n.set(t.getLocalIdForHexHash(o),a)}return n}function f(e,t){t!=null&&e.forEach(function(e){var n=o("WAWebMsgCollection").MsgCollection.get(e);n==null||n.set("lastUpdateFromServerTs",t)})}l.updateViewCounts=s,l.updateQuestionResponsesCounts=u,l.updateReactions=c,l.updatePollVotes=m,l.updateLastUpdateTs=f}),98);
__d("WAWebGetEphemeralFieldsMsgActionsUtils",["WAWebABProps","WAWebChatEphemerality","WAWebChatGetters"],(function(t,n,r,o,a,i,l){function e(e){var t={};o("WAWebChatEphemerality").isEphemeralSettingOn(e)&&(t.ephemeralDuration=o("WAWebChatEphemerality").getEphemeralSetting(e));var n=o("WAWebChatEphemerality").getEphemeralSettingTimestamp(e);n!=null&&(t.ephemeralSettingTimestamp=n);var r=o("WAWebChatEphemerality").getDisappearingModeInitiator(e);if(r!=null&&(t.disappearingModeInitiator=r),o("WAWebABProps").getABPropConfigValue("dm_initiator_trigger")){var a=o("WAWebChatEphemerality").getDisappearingModeTrigger(e);a!=null&&(t.disappearingModeTrigger=a);var i=o("WAWebChatEphemerality").getDisappearingModeInitiatedByMe(e);i!=null&&(t.disappearingModeInitiatedByMe=i)}if(o("WAWebChatGetters").getIsGroup(e)&&o("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_groups")){var l=o("WAWebChatEphemerality").getDisappearingModeTriggerGroups(e);l!=null&&(t.disappearingModeTrigger=l);var s=o("WAWebChatEphemerality").getDisappearingModeInitiatedByMeGroups(e);s!=null&&(t.disappearingModeInitiatedByMe=s)}return babelHelpers.extends({},t)}l.getEphemeralFields=e}),98);
__d("WAWebMexCreateNewsletterAdminInviteJobMutation.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"newsletter_id"},{defaultValue:null,kind:"LocalArgument",name:"user_id"}],t=[{kind:"Variable",name:"newsletter_id",variableName:"newsletter_id"},{kind:"Variable",name:"user_id",variableName:"user_id"}],n={alias:null,args:null,kind:"ScalarField",name:"invite_expiration_time",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebMexCreateNewsletterAdminInviteJobMutation",selections:[{alias:null,args:t,concreteType:"XWA2NewsletterAdminInviteCreateResponse",kind:"LinkedField",name:"xwa2_newsletter_admin_invite_create",plural:!1,selections:[n],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebMexCreateNewsletterAdminInviteJobMutation",selections:[{alias:null,args:t,concreteType:"XWA2NewsletterAdminInviteCreateResponse",kind:"LinkedField",name:"xwa2_newsletter_admin_invite_create",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:"9387141988078609",metadata:{},name:"WAWebMexCreateNewsletterAdminInviteJobMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("WAWebMexCreateNewsletterAdminInviteJob",["WANullthrows","WATimeUtils","WAWebLidMigrationUtils","WAWebMexClient","WAWebMexCreateNewsletterAdminInviteJobMutation.graphql","WAWebNewsletterRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=e!==void 0?e:e=n("WAWebMexCreateNewsletterAdminInviteJobMutation.graphql");function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){return o("WAWebNewsletterRpcUtils").runWithBackoff(function(){return d(e,t)})}),c.apply(this,arguments)}function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WAWebLidMigrationUtils").toUserLidOrThrow(t),a=yield o("WAWebMexClient").fetchQuery(s,{newsletter_id:e,user_id:n.toString()}),i=a.xwa2_newsletter_admin_invite_create,l=r("WANullthrows")(i==null?void 0:i.invite_expiration_time);return{inviteExpiration:o("WATimeUtils").castToUnixTime(Number.parseInt(l,10))}}),m.apply(this,arguments)}l.createNewsletterAdminInvite=u}),98);
__d("WAWebNewsletterSendMsgAction",["Promise","WAAckLevel","WALogger","WANullthrows","WATimeUtils","WAWebChatGetters","WAWebDBProcessEditProtocolMsgs","WAWebFrontendMsgGetters","WAWebGetEphemeralFieldsMsgActionsUtils","WAWebMessageSendPerfReporter","WAWebMessageSendReporter","WAWebMexCreateNewsletterAdminInviteJob","WAWebMsgDataFromModel","WAWebMsgGetters","WAWebMsgKey","WAWebMsgModel","WAWebMsgModelFromData","WAWebMsgRcatUtils","WAWebMsgType","WAWebNewsletterCollection","WAWebNewsletterErrors","WAWebNewsletterGatingUtils","WAWebNewsletterSendMessageJob","WAWebNewsletterSendMsgActionUtils","WAWebNewsletterUpdateMsgsRecordsJob","WAWebNewsletterValidationUtils","WAWebPollsGatingUtils","WAWebSendMsgChatAction","WAWebSendMsgResultAction","WAWebSendTextMsgChatAction","WAWebStateUtils","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWamEnumMessageSendResultType","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C;function b(e,t,n){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a=o("WAWebStateUtils").unproxy(e);if(!o("WAWebChatGetters").getIsNewsletter(a))throw new(o("WAWebNewsletterErrors")).UnexpectedNonNewsletterChatError;var i=yield o("WAWebSendTextMsgChatAction").createTextMsgData(a,t,n);if(i==null)throw r("err")("Failed to generate MsgData");o("WAWebNewsletterSendMsgActionUtils").validateMsgDataForMsgSend(i,a);var l=new(o("WAWebMsgModel")).Msg(i),s=n.linkPreview?"media":"text";return N({chat:a,msg:l,type:s})}),v.apply(this,arguments)}function S(e){var t=o("WAWebFrontendMsgGetters").getChat(e);return o("WAWebFrontendMsgGetters").getAsMms(e)?(C||(C=n("Promise"))).resolve():N({chat:t,msg:e,type:"text"})}function R(e,t,r){if(!o("WAWebChatGetters").getIsNewsletter(e))return(C||(C=n("Promise"))).reject(new(o("WAWebNewsletterErrors")).UnexpectedNonNewsletterChatError);var a=t instanceof o("WAWebMsgModel").Msg?t:new(o("WAWebMsgModel")).Msg(t);return a.local=!0,N({chat:e,msg:a,type:"media",uploadMediaMsg:r})}function L(e){e.wamMessageSendReporter=new(o("WAWebMessageSendReporter")).MessageSendReporter(e),e.wamMessageSendPerfReporter=new(o("WAWebMessageSendPerfReporter")).MessageSendPerfReporter({chatWid:e.to,mediaType:e.getWamMediaType(),messageType:e.getWamMessageType()})}function E(e,t){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){try{var r=o("WAWebDBProcessEditProtocolMsgs").generateMessageEdit(o("WAWebMsgDataFromModel").msgDataFromMsgModel(t),o("WAWebMsgDataFromModel").msgDataFromMsgModel(n)),a=r.editedMsgData;t.set(a);var i=o("WAWebMsgGetters").getIsMedia(t),l=o("WAWebMsgGetters").getLinkPreview(t),s=o("WAWebMsgRcatUtils").getContentIdString(t,!0),u=s!=null&&o("WAWebNewsletterGatingUtils").isRCATFieldGenerationEnabled()?s:null,c=yield o("WAWebNewsletterSendMessageJob").sendNewsletterMessageJob({type:"edit",editType:i||l?"media":"text",msg:t,newsletterJid:o("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(t.id.remote.toJid()),contentId:u});return n.updateAck(o("WAAckLevel").ACK.SENT),{t:c.ack.t,messageSendResult:c.success===!0?o("WAWebSendMsgResultAction").SendMsgResult.OK:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_NETWORK}}catch(t){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Failed to edit message"]))).devConsole(t).tags("newsletter").sendLogs("newsletter-edit-fail"),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}}),k.apply(this,arguments)}function I(e){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.msgData,n=e.chat;if(!o("WAWebNewsletterGatingUtils").isNewsletterPollsCreationEnabled())throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Poll creation is not enabled"]))).tags("newsletter").sendLogs("poll-creation-not-enabled"),r("err")("Poll creation is not enabled");var a=new(o("WAWebMsgModel")).Msg(t),i=yield N({chat:n,msg:a,type:"pollCreation"});return[a,i]}),T.apply(this,arguments)}function D(e){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.msgData,n=e.chat;if(!o("WAWebNewsletterGatingUtils").isNewsletterPollForwardingEnabled())throw o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Poll forwarding is not enabled"]))).tags("newsletter").sendLogs("poll-forwarding-not-enabled"),r("err")("Poll forwarding is not enabled");var a=new(o("WAWebMsgModel")).Msg(t),i=yield N({chat:n,msg:a,type:"pollResultSnapshot"});return[a,i]}),x.apply(this,arguments)}function $(e,t){return P.apply(this,arguments)}function P(){return P=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(o("WAWebFrontendMsgGetters").getIsMms(t))return o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Forwarding MMS messages is not supported"]))).devConsole("Forwarding MMS messages must be done via MediaPrep"),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN};var n=yield o("WAWebNewsletterSendMsgActionUtils").prepMsgDataForForward(t);return N({chat:e,msg:o("WAWebMsgModelFromData").msgModelFromMsgData(n),type:t.type===o("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT&&o("WAWebPollsGatingUtils").isPollResultSnapshotPollTypeEnvelopeEnabled()?"pollResultSnapshot":"text"})}),P.apply(this,arguments)}function N(e){return M.apply(this,arguments)}function M(){return M=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,r,a,i=e.chat,l=e.type,s=e.uploadMediaMsg,u=e.msg;L(u),o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Sending message "," -> ",""])),(t=u)==null?void 0:t.id,i.id.toJid()),(r=u.wamMessageSendPerfReporter)==null||r.startRenderedStage(),yield i.addQueue.enqueue((C||(C=n("Promise"))).resolve(u)).then((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield o("WAWebNewsletterUpdateMsgsRecordsJob").addNewsletterMsgsRecords([o("WAWebMsgDataFromModel").msgDataFromMsgModel(u)]),i.msgs.add(e),i.t=u.t});return function(t){return e.apply(this,arguments)}})()),(a=u.wamMessageSendPerfReporter)==null||a.postRenderedStage();try{var c,h,y,b;try{s!=null&&(u=yield s(u))}catch(e){throw new(o("WAWebNewsletterErrors")).NewsletterMediaUploadError}(c=u.wamMessageSendPerfReporter)==null||c.startReadyToSendStage();var v=o("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(i.id.toJid()),S=o("WAWebMsgRcatUtils").getContentIdString(u,!0),R=l==="media"?{msg:u,type:l,newsletterJid:v,mediaHandle:u.mediaHandle,contentId:S!=null&&o("WAWebNewsletterGatingUtils").isRCATFieldGenerationEnabled()?o("WAWebMsgRcatUtils").getContentIdString(u,!0):null}:{msg:u,type:l,newsletterJid:v};(h=u.wamMessageSendPerfReporter)==null||h.postReadyToSendStage(),(y=u.wamMessageSendPerfReporter)==null||y.startWrittenWireStage();var E=yield i.sendQueue.enqueue(o("WAWebNewsletterSendMessageJob").sendNewsletterMessageJob(R));switch((b=u.wamMessageSendPerfReporter)==null||b.postWrittenWireStage(),E.success){case!0:{var k,I;o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Sent message "," -> ",""])),(k=u)==null?void 0:k.id,i.id.toJid());var T=E.serverId;if(T==null)throw new(o("WAWebNewsletterErrors")).MissingNewsletterServerIdError;u.serverId=E.serverId,u.t=E.ack.t,u.updateAck(o("WAAckLevel").ACK.SENT,!0);try{var D,x;(D=u.wamMessageSendPerfReporter)==null||D.startSavedStage(),yield o("WAWebNewsletterUpdateMsgsRecordsJob").updateNewsletterMsgRecord(u),(x=u.wamMessageSendPerfReporter)==null||x.postSavedStage()}catch(e){o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Failed to persist sent message on db"]))).tags("newsletter").devConsole(e).sendLogs("newsletter-send-message-db-fail")}return(I=u.wamMessageSendReporter)==null||I.postSuccess(),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.OK}}case!1:{var $;return o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Failed to send message, "," from server"])),E.ack.error).tags("newsletter").devConsole(E.ack.error).sendLogs("newsletter-send-message-fail-server"),u.updateAck(o("WAAckLevel").ACK.FAILED,!0),($=u.wamMessageSendReporter)==null||$.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_NETWORK,isTerminal:!1}),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_NETWORK}}}}catch(e){var P;return e instanceof o("WAWebNewsletterErrors").MissingNewsletterServerIdError?o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Empty serverId returned from server"]))).tags("newsletter").sendLogs("newsletter-empty-server-id"):o("WALogger").WARN(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Failed to send message"]))).tags("newsletter").devConsole(e),u.updateAck(o("WAAckLevel").ACK.FAILED,!0),(P=u.wamMessageSendReporter)==null||P.postFailure({result:e instanceof o("WAWebNewsletterErrors").NewsletterMediaUploadError?o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UPLOAD:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UNKNOWN,isTerminal:!1}),e instanceof o("WAWebNewsletterErrors").NewsletterMediaUploadError?{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UPLOAD}:{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}finally{u.wamMessageSendReporter=null,u.wamMessageSendPerfReporter=null}}),M.apply(this,arguments)}function w(e,t){return A.apply(this,arguments)}function A(){return A=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=t.newsletterWid,a=t.invitee,i=t.inviteMessage,l=t.base64Thumb;try{var s=o("WAWebStateUtils").unproxy(e),u=yield o("WAWebMexCreateNewsletterAdminInviteJob").createNewsletterAdminInvite(o("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(n.toJid()),a),c=u.inviteExpiration,d=r("WANullthrows")(r("WAWebNewsletterCollection").get(n)),m=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),p=babelHelpers.extends({ack:o("WAAckLevel").ACK.CLOCK,from:m,id:new(r("WAWebMsgKey"))({from:m,to:s.id,id:yield r("WAWebMsgKey").newId(),participant:void 0,selfDir:"out"}),local:!0,t:o("WATimeUtils").unixTime(),to:s.id,type:"newsletter_admin_invite",kind:"newsletterAdminInvite",viewMode:o("WAWebViewMode.flow").ViewModeType.VISIBLE,isNewMsg:!0,newsletterAdminInviteInfo:{newsletterId:o("WAWebWidFactory").asNewsletterWidOrThrow(n),newsletterName:d==null?void 0:d.name,inviteExpiration:r("WANullthrows")(c),inviteMessage:i,pictureThumbnail:l}},o("WAWebGetEphemeralFieldsMsgActionsUtils").getEphemeralFields(s));return o("WAWebSendMsgChatAction").addAndSendMsgToChat(s,p)[1]}catch(e){return o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[sendNewsletterAdminInviteMessage] Failed to send message ",""])),e).tags("newsletter").devConsole(e).sendLogs("newsletter-failed-to-send-admin-invite"),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}}),A.apply(this,arguments)}function F(e,t){return O.apply(this,arguments)}function O(){return O=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=t.newsletterWid,a=t.inviteMessage,i=t.base64Thumb;try{var l=o("WAWebStateUtils").unproxy(e),s=r("WANullthrows")(r("WAWebNewsletterCollection").get(n)),u=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),c=babelHelpers.extends({ack:o("WAAckLevel").ACK.CLOCK,from:u,id:new(r("WAWebMsgKey"))({from:u,to:l.id,id:yield r("WAWebMsgKey").newId(),participant:void 0,selfDir:"out"}),local:!0,t:o("WATimeUtils").unixTime(),to:l.id,type:"newsletter_follower_invite",kind:"newsletterFollowerInvite",viewMode:o("WAWebViewMode.flow").ViewModeType.VISIBLE,broadcast:!0,isNewMsg:!0,newsletterFollowerInviteInfo:{newsletterId:o("WAWebWidFactory").asNewsletterWidOrThrow(n),newsletterName:s==null?void 0:s.name,inviteMessage:a,pictureThumbnail:i}},o("WAWebGetEphemeralFieldsMsgActionsUtils").getEphemeralFields(l));return o("WAWebSendMsgChatAction").addAndSendMsgToChat(l,c)[1]}catch(e){return o("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[sendNewsletterFollowerInviteMessage] Failed to send message ",""])),e).tags("newsletter").devConsole(e).sendLogs("newsletter-failed-to-send-follower-invite"),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}}),O.apply(this,arguments)}l.sendNewsletterTextMsg=b,l.resendNewsletterMsg=S,l.sendNewsletterMediaMsg=R,l.sendNewsletterEditMsg=E,l.sendNewsletterPollCreationMsg=I,l.sendNewsletterPollResultSnapshotMsg=D,l.forwardNewsletterMessage=$,l.sendNewsletterAdminInviteMessage=w,l.sendNewsletterFollowerInviteMessage=F}),98);
__d("WAWebNewsletterSendMsgActionUtils",["WAWebFrontendMsgGetters","WAWebMediaConstants","WAWebMediaGetUploadOriginForChat","WAWebMediaOpaqueData","WAWebMediaUploadMmsThumbnail","WAWebMmsMediaTypes","WAWebMsgModelFromData","WAWebMsgModelUtils","WAWebNewsletterErrors","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebMsgModelUtils").notRefiningTypeIsUrl(e)?u(e):e}),s.apply(this,arguments)}function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebFrontendMsgGetters").getAsUrl(o("WAWebMsgModelFromData").msgModelFromMsgData(e));if(t==null)return e;var n=t.thumbnailHQ;if(n==null)return e;var a=yield r("WAWebMediaUploadMmsThumbnail")({thumbnail:yield r("WAWebMediaOpaqueData").createFromBase64Jpeg(n),mediaType:o("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_THUMBNAIL_LINK,uploadOrigin:r("WAWebMediaGetUploadOriginForChat")(o("WAWebFrontendMsgGetters").getChat(t.unsafe())),forwardedFromWeb:!0,timeout:o("WAWebMediaConstants").MMS_THUMBNAIL_UPLOAD_TIMEOUT,isViewOnce:!1}),i=a.filehash,l=a.mediaEntry;return babelHelpers.extends({},e,{thumbnailDirectPath:l==null?void 0:l.directPath,thumbnailSha256:i,thumbnailEncSha256:void 0,mediaKey:void 0,mediaKeyTimestamp:void 0})}),c.apply(this,arguments)}function d(e,t){if(e.quotedParticipant!=null&&e.quotedParticipant!==t.id)throw new(o("WAWebNewsletterErrors")).UnexpectedNewsletterQuotedParticipantMismatchError}l.prepMsgDataForForward=e,l.validateMsgDataForMsgSend=d}),98);
__d("WAWebNewsletterViewModeUIUtils",["WAWebMessageAssociationUIUtils","WAWebViewMode.flow"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){t===void 0&&(t=o("WAWebViewMode.flow").ViewModeSurface.CHAT);var n=o("WAWebMessageAssociationUIUtils").getHiddenViewModeMessagesForChat(e,t),r=n.map(function(e){return e.serverId}).filter(Boolean);return new Set(r)}l.getHiddenMessageServerIdsForChat=e}),98);
__d("WAWebChatFlowTypes",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum")({Group:"group",Broadcast:"broadcast",Chat:"chat",Community:"community",Newsletter:"newsletter"});i.ChatKindType=e}),66);
__d("WAWebInfoFlowStep",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["GroupInfo","BroadcastInfo","ContactInfo","NewsletterInfo","DeleteNewsletter","NewsletterAdminCenter","NewsletterInsights","NewsletterLink","NewsletterSettings","NewsletterTransferOwnershipSelection","NewsletterTransferOwnership","ProductDetail","ProductCollection","ProductLink","ProductInfo","CatalogLink","Cart","Catalog","ProductList","Starred","Wallpaper","Kept","GroupSettings","MediaGallery","GroupInviteLink","PendingParticipants","Verification","DefaultEphemerality","Ephemeral","SentForAdminReview","SaveContactFlow","EventInfo","AllEvents","LimitSharing","Notifications"]);i.InfoFlowStep=e}),66);
__d("WAWebHostedGroupUtils",["fbt","WAWebABProps","WAWebFrontendContactGetters"],(function(t,n,r,o,a,i,l,s){var e=function(){return o("WAWebABProps").getABPropConfigValue("is_capi_groups_alpha_enabled")},u=function(t,n){return n===void 0&&(n=!1),n?s._(/*BTDS*/"{ownerName} usa un servicio seguro de Meta para administrar este chat.",[s._param("ownerName",o("WAWebFrontendContactGetters").getFormattedName(t))]):s._(/*BTDS*/"{ownerName} usa un servicio seguro de Meta para administrar este chat. Toca para obtener m\u00e1s informaci\u00f3n.",[s._param("ownerName",o("WAWebFrontendContactGetters").getFormattedName(t))])};l.isWAHostedGroupEnabled=e,l.getSecureServicesBannerText=u}),226);
__d("WAWebParticipantListUtils",["fbt","WAWebABProps","WAWebAlphaRegex","WAWebContactGetters","WAWebFbtIntlList","WAWebFrontendContactGetters","WAWebHostedGroupUtils","WAWebMiscGatingUtils","fbs","partitionArray"],(function(t,n,r,o,a,i,l,s){function e(e){if(e.participants.length===0)return s._(/*BTDS*/"Grupo").toString();if(e.participants.length===1){var t,n=(t=e.participants.head())==null?void 0:t.contact;if(n!=null&&o("WAWebContactGetters").getIsMe(n))return s._(/*BTDS*/"T\u00fa").toString()}var a=c(e,!0);if(a.length===1)return a[0];if(a.length<=3)return r("WAWebFbtIntlList")(a,r("WAWebFbtIntlList").CONJUNCTIONS.AND,r("WAWebFbtIntlList").DELIMITERS.COMMA).toString();if(a.length>=4){var i=a[0],l=s._(/*BTDS*/"_j{\"*\":\"{other_participants} m\\u00e1s\",\"_1\":\"1 m\\u00e1s\"}",[s._plural(a.length-1,"other_participants")]).toString();return r("WAWebFbtIntlList")([i,l],r("WAWebFbtIntlList").CONJUNCTIONS.AND).toString()}return a.join()}function u(e,t,n){if(t===void 0&&(t=!1),n===void 0&&(n=!1),e.participants.length===0)return n?r("fbs")._(/*BTDS*/"Esperando a que otras personas se unan\u2026").toString():r("fbs")._(/*BTDS*/"Grupo").toString();if(e.participants.length===1){var a,i=(a=e.participants.head())==null?void 0:a.contact;if(i!=null&&o("WAWebContactGetters").getIsMe(i))return s._(/*BTDS*/"T\u00fa").toString()}var l=c(e,t);if(l.length===1)return l.pop();var u=r("WAWebFbtIntlList")(l,r("WAWebFbtIntlList").CONJUNCTIONS.AND,r("WAWebFbtIntlList").DELIMITERS.COMMA);return u.toString()}function c(e,t){t===void 0&&(t=!1);var n,a=e.participants.length;t?n=e.participants.filter(function(e){return!o("WAWebContactGetters").getIsMe(e.contact)}):n=e.participants;var i=n.filter(function(e){return o("WAWebFrontendContactGetters").getIsMyContact(e.contact)}),l=n.filter(function(e){return!o("WAWebFrontendContactGetters").getIsMyContact(e.contact)}),s=[];o("WAWebABProps").getABPropConfigValue("elevated_push_names_v2_m2_enabled")&&a>=3&&(s=l.filter(function(e){return o("WAWebContactGetters").getNotifyName(e.contact)!=null}));var u=l.filter(function(e){return!s.includes(e)}),c=u,d=[];o("WAWebMiscGatingUtils").isDropLastNameEnabled()?d=i.map(function(t){var n=t.contact;return e.hasUniqueShortNameMention(n)?o("WAWebFrontendContactGetters").getFormattedShortNameWithNonBreakingSpaces(n):o("WAWebFrontendContactGetters").getFormattedName(n).replace(/\s/g," ")}):d=i.map(function(e){var t=o("WAWebFrontendContactGetters").getFormattedShortNameWithNonBreakingSpaces(e.contact);return t});var m=[];o("WAWebMiscGatingUtils").isDropLastNameEnabled()?m=s.map(function(e){var t=e.contact,n=o("WAWebContactGetters").getNotifyName(t),r=n!=null?n:o("WAWebFrontendContactGetters").getFormattedName(t);return"~"+r.replace(/\s/g," ")}):m=s.map(function(e){var t=o("WAWebContactGetters").getNotifyName(e.contact),n=t!=null?t:o("WAWebFrontendContactGetters").getFormattedShortNameWithNonBreakingSpaces(e.contact),a=n.split(/\s/),i=a[0];return"~"+(r("WAWebAlphaRegex").exec(i)?i:n)});var p=c.map(function(e){return o("WAWebFrontendContactGetters").getFormattedName(e.contact)});return d.sort().concat(m.sort().concat(p.sort()))}function d(e){var t=o("WAWebFrontendContactGetters").getFormattedShortNameWithNonBreakingSpaces(e),n=t.split(/\s/),a=n[0];return r("WAWebAlphaRegex").exec(a)?a:t}function m(e,t){var n=e,a=r("partitionArray")(n,function(e){return o("WAWebContactGetters").getIsMe(e.contact)}),i=a[0],l=a[1];if(n=l.concat(i),o("WAWebMiscGatingUtils").isDropLastNameEnabled())return n.map(function(e){var n=e.contact;return t.hasUniqueShortNameMention(n)?o("WAWebFrontendContactGetters").getFormattedShortNameWithNonBreakingSpaces(n):o("WAWebFrontendContactGetters").getFormattedName(n).replace(/\s/g," ")}).filter(Boolean);if(o("WAWebHostedGroupUtils").isWAHostedGroupEnabled()&&t.hasCapi===!0){var s=r("partitionArray")(n,function(e){return e.id.equals(t.owner)}),u=s[0],c=s[1];n=u.concat(c)}return n.map(function(e){return d(e.contact)}).filter(Boolean)}function p(e){return m(e.participants.toArray(),e)}function _(e){return m(e.participants.getAdmins(),e)}function f(e){var t=e.participants.length;if(t===0)return s._(/*BTDS*/"Llamada grupal").toString();var n=c(e,!1);if(t===1)return n[0];if(t===2)return r("WAWebFbtIntlList")(n.slice(0,2),r("WAWebFbtIntlList").CONJUNCTIONS.AND).toString();var o=n[0],a=t-1,i=s._(/*BTDS*/"_j{\"*\":\"{other_participants} m\\u00e1s\",\"_1\":\"1 m\\u00e1s\"}",[s._plural(a,"other_participants")]).toString();return r("WAWebFbtIntlList")([o,i],r("WAWebFbtIntlList").CONJUNCTIONS.AND).toString()}l.calculateUnnamedGroupParticipantsList=e,l.calculateUnnamedGroupFullParticipantsList=u,l.getFirstNameForContact=d,l.calculateParticipantsList=p,l.calculateAdminsList=_,l.formatParticipantNames=f}),226);
__d("WAWebNotificationsNewsletterMetadataUpdateNotification",["fbt","WATimeUtils","WAWebBaseNotification","WAWebChatFlowTypes","WAWebCmd","WAWebContactCollection","WAWebFbtIntlList","WAWebInfoFlowStep","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebParticipantListUtils","WAWebWidFormat","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l,s){var e=(function(e){function t(t){var n;return n=e.call(this)||this,n.updates=t.updates,n.user=t.user,n.chat=t.chat,n}babelHelpers.inheritsLoose(t,e);var r=t.prototype;return r.buildKey=function(){return"newslowner:"+this.chat.id.toString()+":"+this.user.toString()+":"+o("WATimeUtils").unixTime().toString()},r.shouldPlaySound=function(){return e.prototype.shouldPlaySound.call(this)?o("WAWebNotificationHelpers").shouldPlaySoundGranular(this.chat):!1},r.shouldShowBanner=function(){return e.prototype.shouldShowBanner.call(this)?o("WAWebNotificationHelpers").shouldEnableNotificationGranular(this.chat):!1},r.getBannerOptions=function(){var e=this,t=this.updates.some(function(e){var t=e.item;return t==="reaction_setting"})?o("WAWebInfoFlowStep").InfoFlowStep.NewsletterSettings:o("WAWebInfoFlowStep").InfoFlowStep.NewsletterInfo;return{wid:this.chat.id,title:this.chat.name,body:this.getNotificationBody(),onClick:function(){o("WAWebCmd").Cmd.openNewsletterProfile(e.chat,t)}}},r.getNotificationBody=function(){var e=this.getActor();return c(e,this.updates).toString()},r.getActor=function(){var e=o("WAWebContactCollection").ContactCollection.get(this.user);return e!=null?o("WAWebParticipantListUtils").getFirstNameForContact(e):o("WAWebWidFormat").widToFormattedUser(this.user)},r.getIcon=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebNotificationIconUtils").getChatNotificationIcon(this.chat,this.abortController.signal)});function t(){return e.apply(this,arguments)}return t})(),r.matchesChat=function(t){return t.equals(this.chat)},r.getChatKind=function(){return o("WAWebChatFlowTypes").ChatKindType.Newsletter},t})(o("WAWebBaseNotification").WABaseNotification);function u(e){switch(e){case"name":return s._(/*BTDS*/"nombre");case"description":return s._(/*BTDS*/"descripci\u00f3n");case"profile_picture":return s._(/*BTDS*/"foto del perfil");case"reaction_setting":return s._(/*BTDS*/"ajustes de reacciones")}}function c(e,t){if(t.length===1&&t[0].item==="name"){var n=t[0].value;return s._(/*BTDS*/"{actor} cambi\u00f3 el nombre del canal a \"{updateValue}\".",[s._param("actor",e),s._param("updateValue",n)])}var o=t.map(function(e){var t=e.item;return u(t)}),a=r("WAWebFbtIntlList")(o,r("WAWebFbtIntlList").CONJUNCTIONS.AND,r("WAWebFbtIntlList").DELIMITERS.COMMA);return s._(/*BTDS*/"{actor} cambi\u00f3 {update} del canal.",[s._param("actor",e),s._param("update",a.toString())])}l.WANewsletterMetadataUpdateNotification=e}),226);
__d("WAWebNotificationsNewsletterRoleChangeNotification",["fbt","WAWebBaseNotification","WAWebChatFlowTypes","WAWebContactCollection","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebParticipantListUtils","WAWebUserPrefsMeUser","WAWebWidFormat","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l,s){var e=(function(e){function t(t){var n;return n=e.call(this)||this,n.mode=t.mode,n.admin=t.admin,n.user=t.user,n.chat=t.chat,n}babelHelpers.inheritsLoose(t,e);var r=t.prototype;return r.shouldPlaySound=function(){return e.prototype.shouldPlaySound.call(this)?o("WAWebNotificationHelpers").shouldPlaySoundGranular(this.chat):!1},r.shouldShowBanner=function(){return e.prototype.shouldShowBanner.call(this)?o("WAWebNotificationHelpers").shouldEnableNotificationGranular(this.chat):!1},r.buildKey=function(){return"newsladmin:"+this.chat.id.toString()+":"+this.mode+":"+this.user.toString()},r.getBannerOptions=function(){var e=this.getNotificationUser(),t=o("WAWebUserPrefsMeUser").isMeAccount(this.user);return{wid:this.chat.id,title:this.chat.name,body:u[this.mode](e,t).toString()}},r.getNotificationUser=function(){var e=this.mode==="ownership"?this.admin:this.user;if(e==null)return null;var t=o("WAWebContactCollection").ContactCollection.get(e);return t!=null?o("WAWebParticipantListUtils").getFirstNameForContact(t):o("WAWebWidFormat").widToFormattedUser(this.user)},r.getIcon=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebNotificationIconUtils").getChatNotificationIcon(this.chat,this.abortController.signal)});function t(){return e.apply(this,arguments)}return t})(),r.matchesChat=function(t){return this.chat.equals(t)},r.getChatKind=function(){return o("WAWebChatFlowTypes").ChatKindType.Newsletter},t})(o("WAWebBaseNotification").WABaseNotification),u={promote:function(t,n){return n?s._(/*BTDS*/"Ahora eres admin."):s._(/*BTDS*/"{who} ahora es admin.",[s._param("who",t)])},demote:function(t,n){return n?s._(/*BTDS*/"Ya no eres admin."):s._(/*BTDS*/"{who} ya no es admin.",[s._param("who",t)])},ownership:function(t){return t==null?s._(/*BTDS*/"Ahora eres el propietario del canal."):s._(/*BTDS*/"{who} te design\u00f3 como propietario del canal.",[s._param("who",t)])}};l.WANewsletterRoleChangeNotification=e}),226);
__d("WAWebShowNewsletterMetadataUpdateNotification",["WAWebNewsletterMembershipUtil","WAWebNotificationController","WAWebNotificationsNewsletterMetadataUpdateNotification","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.chat,n=e.user,r=e.updates,a=t.newsletterMetadata;if(a!=null&&o("WAWebNewsletterMembershipUtil").iAmOwner(a)&&!o("WAWebUserPrefsMeUser").isMeAccount(n)&&r.length!==0)return o("WAWebNotificationController").WANotificationController.triggerNotification(new(o("WAWebNotificationsNewsletterMetadataUpdateNotification")).WANewsletterMetadataUpdateNotification({chat:t,user:n,updates:r}))}),s.apply(this,arguments)}l.showNewsletterMetadataUpdateNotification=e}),98);
__d("WAWebShowNewsletterRoleChangeNotification",["Promise","WAWebCommonNewsletterEnums","WAWebNewsletterMembershipUtil","WAWebNotificationController","WAWebNotificationsNewsletterRoleChangeNotification","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){var e;function s(t){var r=t.newRole,a=t.mode,i=t.chat,l=t.admin,s=t.user,u=i.newsletterMetadata;if(u==null)return(e||(e=n("Promise"))).resolve();var c=a==="promote"&&o("WAWebUserPrefsMeUser").isMeAccount(s)&&r===o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner;if(c)return o("WAWebNotificationController").WANotificationController.triggerNotification(new(o("WAWebNotificationsNewsletterRoleChangeNotification")).WANewsletterRoleChangeNotification({mode:"ownership",chat:i,admin:l,user:s}));var d=o("WAWebNewsletterMembershipUtil").iAmOwner(u)&&a==="promote"&&r===o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin&&!o("WAWebUserPrefsMeUser").isMeAccount(s),m=a==="demote"&&r===o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber&&!o("WAWebUserPrefsMeUser").isMeAccount(s)&&s.toJid()===(l==null?void 0:l.toJid()),p=a==="demote"&&o("WAWebUserPrefsMeUser").isMeAccount(s)&&s.toJid()!==(l==null?void 0:l.toJid());return d||m||p?o("WAWebNotificationController").WANotificationController.triggerNotification(new(o("WAWebNotificationsNewsletterRoleChangeNotification")).WANewsletterRoleChangeNotification({mode:a,chat:i,admin:l,user:s})):(e||(e=n("Promise"))).resolve()}l.showNewsletterRoleChangeNotification=s}),98);
__d("WAWebWamEnumChannelEntryPoint",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNKNOWN:0,UPDATES_TAB:1,DIRECTORY:2,LINK:3,DEEPLINK:4,FORWARDED_MESSAGE:5,DIRECTORY_SEARCH:6,RECOMMENDED_LIST:7,NOTIFICATION:8,UPDATES_TAB_SEARCH:9,STATUS:10,ADMIN_INVITE_MESSAGE:11,MEDIA_BROWSER:12,SIMILAR_CHANNEL:13,DIRECTORY_CATEGORIES:14,DIRECTORY_CATEGORIES_SEARCH:15,NEWSLETTER_MEDIA_GALLERY_MEDIA:16,NEWSLETTER_MEDIA_GALLERY_LINKS:17,THREAD_CHAIN_PILL:18,THREAD_CHAIN_SWIPE_UP:19,RECENT_SEARCHES:20,NEWSLETTER_CREATION_UPDATES_TAB:21,NEWSLETTER_CREATION_DIRECTORY:22,NEWSLETTER_CREATION_DIRECTORY_CATEGORIES:23,INVITE_CONTACTS_TO_FOLLOW_MESSAGE:24,MUSIC_ATTRIBUTION_BOTTOM_SHEET_FROM_CHAT:25});i.CHANNEL_ENTRY_POINT=e}),66);
__d("WAWebWamEnumChannelEntryPointApp",[],(function(t,n,r,o,a,i){var e=Object.freeze({EXTERNAL_UNKNOWN:1,WHATSAPP:2});i.CHANNEL_ENTRY_POINT_APP=e}),66);
__d("WAWebWamEnumChannelEntryPointMetadata",[],(function(t,n,r,o,a,i){var e=Object.freeze({STATUS_HEADER:1,LINK_TOOLTIP:2,LINK_BUTTON:3,POST_TOOLTIP:4});i.CHANNEL_ENTRY_POINT_METADATA=e}),66);
__d("WAWebWamEnumChannelEventSurface",[],(function(t,n,r,o,a,i){var e=Object.freeze({CHANNEL_UPDATES_HOME:1,CHANNEL_THREAD:2,CHANNEL_DIRECTORY:3,CHANNEL_DIRECTORY_SEARCH:4,CHANNEL_PROFILE:5,CHANNEL_UPDATES_HOME_SEARCH:6,CHANNEL_DIRECTORY_CATEGORIES:7,CHANNEL_DIRECTORY_CATEGORIES_SEARCH:8});i.CHANNEL_EVENT_SURFACE=e}),66);
__d("WAWebWamEnumChannelEventUnit",[],(function(t,n,r,o,a,i){var e=Object.freeze({RECOMMENDED_CHANNELS:1,SIMILAR_CHANNELS:2,RECENT_SEARCHES:3});i.CHANNEL_EVENT_UNIT=e}),66);
__d("WAWebChannelCoreEventWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumChannelEntryPoint","WAWebWamEnumChannelEntryPointApp","WAWebWamEnumChannelEntryPointMetadata","WAWebWamEnumChannelEventSurface","WAWebWamEnumChannelEventType","WAWebWamEnumChannelEventUnit","WAWebWamEnumTsSurface"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({ChannelCoreEvent:[4692,{channelCoreEventSequenceNumber:[8,e.TYPES.INTEGER],channelCoreEventType:[1,o("WAWebWamEnumChannelEventType").CHANNEL_EVENT_TYPE],channelDirectorySessionId:[7,e.TYPES.INTEGER],channelDiscoveryQueryId:[15,e.TYPES.STRING],channelDiscoverySearchId:[16,e.TYPES.STRING],channelEntryPoint:[2,o("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT],channelEntryPointApp:[3,o("WAWebWamEnumChannelEntryPointApp").CHANNEL_ENTRY_POINT_APP],channelEntryPointMetadata:[10,o("WAWebWamEnumChannelEntryPointMetadata").CHANNEL_ENTRY_POINT_METADATA],channelEventUnit:[12,o("WAWebWamEnumChannelEventUnit").CHANNEL_EVENT_UNIT],cid:[4,e.TYPES.STRING],directoryChannelIndex:[9,e.TYPES.INTEGER],discoverySurface:[14,o("WAWebWamEnumTsSurface").TS_SURFACE],entryPointMetadata:[5,e.TYPES.STRING],eventSurface:[6,o("WAWebWamEnumChannelEventSurface").CHANNEL_EVENT_SURFACE],similarChannelsSessionId:[13,e.TYPES.INTEGER],unifiedSessionId:[17,e.TYPES.STRING],updatesTabSessionId:[18,e.TYPES.INTEGER]},[1,1,1],"regular"]},{ChannelCoreEvent:[]});l.ChannelCoreEventWamEvent=s}),98);
__d("WAWebSimilarNewsletterSessionId",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useMemo;function u(){return 1+Math.floor(Number.MAX_SAFE_INTEGER*Math.random())}function c(){var e=s(function(){return u()},[]);return e}function d(e){return e}l.generateSessionId=u,l.useSimilarNewslettersSessionId=c,l.newsletterSessionIdToInt=d}),98);
__d("WAWebNewsletterAttributionLogging",["WALogger","WAWebChannelCoreEventWamEvent","WAWebCommonNewsletterEnums","WAWebNewsletterCollection","WAWebNewsletterDirectoryFilterUtils","WAWebNewsletterGatingUtils","WAWebSimilarNewsletterSessionId","WAWebWamEnumChannelEntryPoint","WAWebWamEnumChannelEntryPointApp","WAWebWamEnumTsSurface"],(function(t,n,r,o,a,i,l){var e=["cid","eventSurface","channelCoreEventType","similarChannelSessionId","eventUnit","entryPoint"],s;function u(e){switch(e){case o("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.LINK:return o("WAWebWamEnumTsSurface").TS_SURFACE.CHAT_THREAD;case o("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.RECOMMENDED_LIST:case o("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.UPDATES_TAB:return o("WAWebWamEnumTsSurface").TS_SURFACE.CHANNEL_UPDATES_HOME;case o("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.DIRECTORY_CATEGORIES:return o("WAWebWamEnumTsSurface").TS_SURFACE.CHANNEL_DIRECTORY_CATEGORIES;case o("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.FORWARDED_MESSAGE:return o("WAWebWamEnumTsSurface").TS_SURFACE.CHAT_THREAD;case o("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.DIRECTORY_CATEGORIES_SEARCH:case o("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.DIRECTORY_SEARCH:return o("WAWebWamEnumTsSurface").TS_SURFACE.CHANNEL_DIRECTORY_CATEGORIES_SEARCH;case o("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.STATUS:return o("WAWebWamEnumTsSurface").TS_SURFACE.STATUS_VIEWER_SHEET;case o("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.ADMIN_INVITE_MESSAGE:return o("WAWebWamEnumTsSurface").TS_SURFACE.CHAT_THREAD;case o("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.SIMILAR_CHANNEL:return o("WAWebWamEnumTsSurface").TS_SURFACE.CHANNEL_PROFILE;default:return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Encountered unexpected entry point: ",""])),e).tags("newsletter-logging").sendLogs("Unexpected entry point in newsletter open logging"),o("WAWebWamEnumTsSurface").TS_SURFACE.UNKNOWN}}function c(){return r("WAWebNewsletterCollection").some(function(e){var t;return((t=e.newsletterMetadata)==null?void 0:t.membershipType)===o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber})?1:0}var d=(function(){function t(){this.$6={}}var n=t.prototype;return n.setChannelEntryPoint=function(t){this.$1=t},n.setChannelEntryPointMetadata=function(t){this.$4=t},n.setSimilarChannelsSessionId=function(t){this.$5=t},n.setNewsletterDirectoryLoggingData=function(t){this.$6=t},n.getSimilarChannelsSessionId=function(){return this.$5},n.getIsSimilarUnitMountedForChat=function(t){return t.equals(this.$7)},n.setIsSimilarUnitMountedForChat=function(t){this.$7=t},n.getSimilarChannelsSessionIdForLogging=function(){var e=this.$5;if(e!=null)return o("WAWebSimilarNewsletterSessionId").newsletterSessionIdToInt(e)},n.setDirectorySessionId=function(t){this.$2=t},n.getDirectorySessionIdForLogging=function(){return this.$2},n.getNewsletterDirectoryLoggingData=function(){return this.$6},n.setDirectoryFilter=function(t){if(t==null){this.$3=null;return}switch(t){case o("WAWebNewsletterDirectoryFilterUtils").NewsletterDirectoryFilterType.Recommended:return this.$3="all";case o("WAWebNewsletterDirectoryFilterUtils").NewsletterDirectoryFilterType.New:return this.$3="new";case o("WAWebNewsletterDirectoryFilterUtils").NewsletterDirectoryFilterType.Popular:return this.$3="popular";case o("WAWebNewsletterDirectoryFilterUtils").NewsletterDirectoryFilterType.Featured:return this.$3="featured";case o("WAWebNewsletterDirectoryFilterUtils").NewsletterDirectoryFilterType.Trending:return this.$3="most_active";default:return this.$3=null}},n.log=function(n){var t,r,a,i=n.cid,l=n.eventSurface,s=n.channelCoreEventType,d=n.similarChannelSessionId,m=n.eventUnit,p=n.entryPoint,_=babelHelpers.objectWithoutPropertiesLoose(n,e),f=JSON.stringify(babelHelpers.extends({has_followed_channels:c(),pill_type:(t=this.$3)!=null?t:void 0},o("WAWebNewsletterGatingUtils").isDirectoryCategoriesLoggingEnabled()?_:{}));new(o("WAWebChannelCoreEventWamEvent")).ChannelCoreEventWamEvent({cid:i.user,eventSurface:l,channelCoreEventType:s,channelEntryPointApp:o("WAWebWamEnumChannelEntryPointApp").CHANNEL_ENTRY_POINT_APP.WHATSAPP,channelEntryPoint:(r=p!=null?p:this.$1)!=null?r:void 0,channelDirectorySessionId:(a=this.$2)!=null?a:void 0,entryPointMetadata:f,similarChannelsSessionId:d!=null?o("WAWebSimilarNewsletterSessionId").newsletterSessionIdToInt(d):void 0,channelEntryPointMetadata:this.$4,channelEventUnit:m!=null?m:void 0,discoverySurface:p!=null?u(p):void 0}).commit()},t})(),m=new d;l.getDiscoverySurfaceFromChannelEntryPoint=u,l.NewsletterCoreEventLogger=m}),98);
__d("WAWebNewsletterCollection",["WAWebChatCollection"],(function(t,n,r,o,a,i,l){var e=new(o("WAWebChatCollection")).ChatCollectionImpl;l.default=e}),98);
__d("WAWebNewsletterGeosuspendedCountryModel",["WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.geosuspended=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){e.prototype.initialize.call(this)},t})(o("WAWebBaseModel").BaseModel);e.Proxy="newsletter_geosuspended_country";var s=o("WAWebBaseModel").defineModel(e);l.GeosuspendedCountry=s}),98);
__d("WAWebNewsletterGeosuspendedCountryCollection",["WAWebBaseCollection","WAWebNewsletterGeosuspendedCountryModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebNewsletterGeosuspendedCountryModel").GeosuspendedCountry,l.default=e}),98);
__d("WAWebNewsletterMessageDeliveryUpdateModel",["WAWebBaseModel","WAWebMsgKey"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.serverId=o("WAWebBaseModel").prop(),t.msgModel=o("WAWebBaseModel").prop(),t.code=o("WAWebBaseModel").prop(),t.t=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){e.prototype.initialize.call(this)},t})(o("WAWebBaseModel").BaseModel);e.Proxy="newsletter_message_update",e.idClass=r("WAWebMsgKey");var s=o("WAWebBaseModel").defineModel(e);l.NewsletterMessageDeliveryUpdate=s}),98);
__d("WAWebNewsletterMessageDeliveryUpdateCollection",["WAWebBaseCollection","WAWebNewsletterMessageDeliveryUpdateModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebNewsletterMessageDeliveryUpdateModel").NewsletterMessageDeliveryUpdate,l.default=e}),98);
__d("WAWebNewsletterMetadataCollection",["Promise","WALogger","WAWebBaseCollection","WAWebCollectionUtils","WAWebNewsletterMetadataModel","WAWebWid","err"],(function(t,n,r,o,a,i,l){var e,s,u=(function(t){function a(){for(var a,i=arguments.length,l=new Array(i),u=0;u<i;u++)l[u]=arguments[u];return a=t.call.apply(t,[this].concat(l))||this,a.byInviteCode=o("WAWebCollectionUtils").aggregated(function(e){return e.inviteCode}),a.findImpl=function(t){return r("WAWebWid").isNewsletter(t)?(s||(s=n("Promise"))).resolve({id:t}):(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["newsletterMetadata:find trying to fetch non-newsletter wid ",""])),t.toString()),(s||(s=n("Promise"))).reject(r("err")("newsletterMetadata:find trying to fetch non-newsletter  wid "+t.toString())))},babelHelpers.assertThisInitialized(a)||babelHelpers.assertThisInitialized(a)}return babelHelpers.inheritsLoose(a,t),a})(o("WAWebBaseCollection").BaseCollection);u.model=o("WAWebNewsletterMetadataModel").NewsletterMetadata,u.staleCollection=!0;var c=new u;l.default=c}),98);
__d("WAWebNewsletterMetricUtils",["$InternalEnum","WATimeUtils"],(function(t,n,r,o,a,i,l){"use strict";var e=86400,s=30,u="infinite";function c(t){var n=o("WATimeUtils").pastUnixTime(e*(s-1),t);return n}var d=n("$InternalEnum")({UniqueVisitorsOverPeriod:1,NewUniqueVisitorsOverPeriod:2,NetFollowsOverPeriod:3,UniqueVisitorOverPeriodByRole:4,UniqueVisitorOverPeriodByCountry:5,FollowersOverPeriod:6,FollowersOverPeriodByCountry:7,FollowsPerDay:8,UnfollowsPerDay:9});function m(e){var t=e.flatMap(function(e){return e.getMetrics()}),n=t.reduce(function(e,t){var n=e.enumSet,r=e.metricRequests,o=d.cast(t.id);return o==null||n.has(o)||(n.add(o),r.push(t)),e},{enumSet:new Set,metricRequests:[]}),r=n.metricRequests;return r}function p(e){return e!==u&&Math.abs(e)<Number.EPSILON}function _(e){return new Date(e).setHours(0,0,0,0)}l.INSIGHT_DAYS_COVERED=s,l.DELTA_INFINITE=u,l.getInsightPeriodStart=c,l.NewsletterInsightMetricQuery=d,l.getUniqueMetricRequests=m,l.isDeltaValueZero=p,l.roundToNearestDay=_}),98);
__d("WAWebNewsletterMetadataModel",["WAWebBaseModel","WAWebClock","WAWebCommonNewsletterEnums","WAWebModelUtils","WAWebNewsletterGeosuspendedCountryCollection","WAWebNewsletterMembershipUtil","WAWebNewsletterMessageDeliveryUpdateCollection","WAWebNewsletterMetadataCollection","WAWebNewsletterMetricUtils","WAWebNewsletterPendingAdminsCollection","WAWebNewsletterSubscribersCollection","WAWebWid"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a))||this,t.id=o("WAWebModelUtils").prop(),t.creationTime=o("WAWebModelUtils").prop(),t.name=o("WAWebModelUtils").prop(),t.nameUpdateTime=o("WAWebModelUtils").prop(),t.description=o("WAWebModelUtils").prop(),t.descriptionUpdateTime=o("WAWebModelUtils").prop(),t.handle=o("WAWebModelUtils").prop(),t.inviteCode=o("WAWebModelUtils").prop(),t.size=o("WAWebModelUtils").prop(),t.verified=o("WAWebModelUtils").prop(),t.membershipType=o("WAWebModelUtils").prop(),t.privacy=o("WAWebModelUtils").prop(),t.website=o("WAWebModelUtils").prop(),t.messageDeliveryUpdates=o("WAWebModelUtils").collection(r("WAWebNewsletterMessageDeliveryUpdateCollection")),t.reactionCodesSetting=o("WAWebModelUtils").prop(),t.wamoSubPlanId=o("WAWebModelUtils").prop(),t.wamoSubStatus=o("WAWebModelUtils").prop(),t.suspended=o("WAWebModelUtils").prop(!1),t.geosuspended=o("WAWebModelUtils").prop(!1),t.hasProfilePictureDeletionAlerts=o("WAWebModelUtils").prop(!1),t.geosuspendedCountries=o("WAWebModelUtils").collection(r("WAWebNewsletterGeosuspendedCountryCollection")),t.capabilities=o("WAWebModelUtils").prop(function(){return new Set}),t.adminInsights=o("WAWebModelUtils").session(),t.adminCount=o("WAWebModelUtils").prop(1),t.pendingAdmins=o("WAWebModelUtils").collection(r("WAWebNewsletterPendingAdminsCollection")),t.subscribers=o("WAWebModelUtils").collection(r("WAWebNewsletterSubscribersCollection")),t.terminated=o("WAWebModelUtils").prop(!1),t.similarNewsletters=o("WAWebModelUtils").session(function(){return[]}),t.recentlyFollowedFrom=o("WAWebModelUtils").session(),t.isSuspendedOrTerminated=o("WAWebModelUtils").derived(function(){return this.suspended||this.terminated},["suspended","terminated"]),t.canBeMuted=o("WAWebModelUtils").derived(function(){return o("WAWebNewsletterMembershipUtil").iAmOwner(this)&&this.adminCount>1||o("WAWebNewsletterMembershipUtil").iAmAdmin(this)||o("WAWebNewsletterMembershipUtil").iAmSubscriber(this)},["adminCount","membershipType"]),t.isSubscribedOrOwned=o("WAWebModelUtils").derived(function(){return o("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(this)||o("WAWebNewsletterMembershipUtil").iAmSubscriber(this)},["membershipType"]),t.isPreview=o("WAWebModelUtils").derived(function(){return this.membershipType===o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest},["membershipType"]),t.showInsightDelta=o("WAWebModelUtils").derived(function(){return o("WAWebClock").Clock.daysDeltaAbs(this.creationTime)>=o("WAWebNewsletterMetricUtils").INSIGHT_DAYS_COVERED},["creationTime"]),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){var t=this;e.prototype.initialize.call(this),this.listenTo(this.subscribers,"change add reset set remove",function(){t.updateAdminCount()})},n.getCollection=function(){return r("WAWebNewsletterMetadataCollection")},n.resetRecentlyFollowedFrom=function(){this.recentlyFollowedFrom=null},n.updateAdminCount=function(){var e,t,n=(e=(t=this.subscribers)==null?void 0:t.filter(function(e){var t=e.membership;return t===o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin||t===o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner}).length)!=null?e:0;this.adminCount=this.membershipType===o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner?n+1:n},t})(o("WAWebBaseModel").BaseModel);e.Proxy="newsletterMetadata",e.idClass=r("WAWebWid");var s=o("WAWebBaseModel").defineModel(e);l.NewsletterMetadata=s}),98);
__d("WAWebNewsletterPendingAdminsCollection",["WAWebBaseCollection","WAWebNewsletterSubscriberModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebNewsletterSubscriberModel").NewsletterSubscriber,l.default=e}),98);
__d("WAWebNewsletterPollVotesGetters",["WAWebGetters","WAWebGettersCaches"],(function(t,n,r,o,a,i,l){var e=o("WAWebGetters").createGetterFactories({createCache:o("WAWebGettersCaches").createNewsletterPollVotesCache}),s=e.field,u=e.unsafeIdentityGetter,c=e.clearCacheFor,d=c,m=u,p=s("ack");l.clearNewsletterPollVotesGetterCacheFor=d,l.getNewsletterPollVotesUnsafe=m,l.getAck=p}),98);
__d("WAWebFrontendNewsletterPollVotesGetters",["WAWebAck","WAWebGetters","WAWebGettersCaches","WAWebNewsletterPollVotesGetters"],(function(t,n,r,o,a,i,l){var e=o("WAWebGetters").createGetterFactories({root:o("WAWebNewsletterPollVotesGetters").getNewsletterPollVotesUnsafe,createCache:o("WAWebGettersCaches").createFrontendNewsletterPollVotesCache}),s=e.field,u=e.computed,c=e.clearCacheFor,d=c,m=s("isSendFailure",{default:!1}),p=u(function(e){var t=e[0],n=e[1],r=t!=null&&t<o("WAWebAck").ACK.CLOCK;return r||!!n},[o("WAWebNewsletterPollVotesGetters").getAck,m]);l.clearFrontendNewsletterPollVotesGetterCacheFor=d,l.getIsFailed=p}),98);
__d("WAWebNewsletterPollVotesModel",["WATimeUtils","WAWebAddOnModel","WAWebBaseModel","WAWebFrontendNewsletterPollVotesGetters","WAWebModelUtils","WAWebMsgKey","WAWebNewsletterPollVotesGetters"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebModelUtils").prop(),t.pollVotesCountMap=o("WAWebModelUtils").prop(function(){return new Map}),t.pollVotesCountMapTs=o("WAWebModelUtils").prop(),t.myVote=o("WAWebModelUtils").prop(function(){return new Set}),t.myVoteTs=o("WAWebModelUtils").prop(),t.isUnvote=o("WAWebModelUtils").prop(!1),t.msgKey=o("WAWebModelUtils").prop(),t.pollVotersMap=o("WAWebModelUtils").prop(function(){return new Map}),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.delete=function(){e.prototype.delete.call(this),o("WAWebNewsletterPollVotesGetters").clearNewsletterPollVotesGetterCacheFor(this),o("WAWebFrontendNewsletterPollVotesGetters").clearFrontendNewsletterPollVotesGetterCacheFor(this)},n.updateMyVote=function(t,n,r){var e,a,i;if(!(n<((e=this.myVoteTs)!=null?e:0))){var l=(a=this.myVote)!=null?a:new Set,s=(i=this.pollVotesCountMap)!=null?i:new Map;Array.from(l).forEach(function(e){var t,n=(t=s.get(e))!=null?t:0;s.set(e,Math.max(n-1,0))}),Array.from(t).forEach(function(e){var t,n=(t=s.get(e))!=null?t:0;s.set(e,n+1)}),this.msgKey=r,this.pollVotesCountMap=s,this.myVote=t,this.myVoteTs=o("WATimeUtils").castToMillisTime(n)}},n.updatePollVotersMap=function(t,n){if(n==null){this.pollVotersMap=t;return}var e=t.get(n);if(e!=null){var r=new Map(this.pollVotersMap);r.set(n,e),this.pollVotersMap=r}},t})(o("WAWebAddOnModel").AddOnBaseModel);e.Proxy="newsletterPollVote",e.idClass=r("WAWebMsgKey");var s=o("WAWebBaseModel").defineModel(e);l.NewsletterPollVotes=s}),98);
__d("WAWebNewsletterPollVotesModelCollection",["WATimeUtils","WAWebBaseCollection","WAWebCRUDOperationsNewsletterMyVotes","WAWebCRUDOperationsNewsletterPollsVotes","WAWebMiscErrors","WAWebMsgCollection","WAWebMsgKey","WAWebNewsletterPollVotesModel","WAWebPollsCreateOptionLocalIdMap","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return t=e.call.apply(e,[this].concat(i))||this,t.findImpl=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.toString(),n=yield o("WAWebCRUDOperationsNewsletterPollsVotes").getVote(t),a=yield o("WAWebMsgCollection").MsgCollection.hydrateOrGetMessages([t]),i=a[0];if(i==null)throw new(o("WAWebMiscErrors")).NotFoundError("No votes found");var l=i.id.remote.toJid(),s=i.serverId,u=i.pollOptions,c=s!=null?yield o("WAWebCRUDOperationsNewsletterMyVotes").getMyVote(l,s):null;if(u==null)throw new(o("WAWebMiscErrors")).NotFoundError("No pollOptions found");if(n==null&&c==null)throw new(o("WAWebMiscErrors")).NotFoundError("No polls to display");var d={id:r("WAWebMsgKey").fromString(t),pollVotesCountMap:new Map},m=yield o("WAWebPollsCreateOptionLocalIdMap").createOptionLocalIdMap(u);if(n!=null&&(d.pollVotesCountMap=new Map(Array.from(n.votesMap.entries()).map(function(e){var t=e[0],n=e[1];return[m.getLocalIdForHexHash(t),n]})),d.pollVotesCountMapTs=o("WATimeUtils").castToUnixTime(n.serverTimestamp)),c!=null){d.myVote=new Set(c.votes.map(function(e){return m.getLocalIdForHexHash(e)}));var p=d.pollVotesCountMap;d.myVote.forEach(function(e){p!=null&&!p.has(e)&&p.set(e,1)}),d.myVoteTs=o("WATimeUtils").castToMillisTime(c.serverTimestampMs),d.ack=c.ack}return d});return function(t){return e.apply(this,arguments)}})(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebNewsletterPollVotesModel").NewsletterPollVotes;function s(e){var t=e.msgKey,n=e.parentMsgKey,r=e.selectedOptionLocalIds,o=e.timestamp,a=u.gadd({id:n});return a.updateMyVote(r,o,t),a}var u=new e;l.updateOrCreatePollVote=s,l.NewsletterPollVotesModelCollection=u}),98);
__d("WAWebNewsletterReactionModel",["WATimeUtils","WAWebBaseModel","WAWebModelUtils","WAWebMsgKey","WAWebReactionsBEUtils"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebModelUtils").prop(),t.parentMsgServerId=o("WAWebModelUtils").prop(),t.myReactionMsgKey=o("WAWebModelUtils").prop(),t.reactionCountMap=o("WAWebModelUtils").prop(),t.reactionCountMapTs=o("WAWebModelUtils").prop(),t.myReaction=o("WAWebModelUtils").prop(),t.myReactionTs=o("WAWebModelUtils").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){var t;e.prototype.initialize.call(this),this.reactionCountMap=(t=this.reactionCountMap)!=null?t:new Map},n.updateMyReaction=function(t){return t===o("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT?this.$NewsletterMessageReactionsImpl$p_1():this.$NewsletterMessageReactionsImpl$p_2(t)},n.$NewsletterMessageReactionsImpl$p_2=function(t){var e,n=this.myReaction;this.reactionCountMap=(e=this.reactionCountMap)!=null?e:new Map;var r=this.reactionCountMap,o=r.get(t);r.set(t,(o!=null?o:0)+1);var a=n!=null?r.get(n):null;if(a!=null&&n!=null){var i=a-1;i>0?r.set(n,i):r.delete(n)}this.$NewsletterMessageReactionsImpl$p_3(t)},n.$NewsletterMessageReactionsImpl$p_1=function(){var e,t=this.myReaction;if(t!=null){this.reactionCountMap=(e=this.reactionCountMap)!=null?e:new Map;var n=this.reactionCountMap,r=n.get(t);r!=null&&(r>1?n.set(t,r-1):n.delete(t),this.$NewsletterMessageReactionsImpl$p_3(null))}},n.$NewsletterMessageReactionsImpl$p_3=function(t){this.myReactionTs=o("WATimeUtils").unixTime(),this.myReaction=t},t})(o("WAWebBaseModel").BaseModel);e.Proxy="newsletterReaction",e.idClass=r("WAWebMsgKey");var s=o("WAWebBaseModel").defineModel(e);l.NewsletterMessageReactions=s}),98);
__d("WAWebNewsletterReactionCollection",["WATimeUtils","WAWebBaseCollection","WAWebDBGetReactions","WAWebMiscErrors","WAWebMsgCollection","WAWebMsgKey","WAWebNewsletterDBUtils","WAWebNewsletterReactionModel","WAWebReactionsBEUtils","WAWebUserPrefsMeUser","WAWebdbCRUDOperationsNewsletterReaction","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return t=e.call.apply(e,[this].concat(i))||this,t.findImpl=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebdbCRUDOperationsNewsletterReaction").getNewsletterReaction(e),n=yield o("WAWebMsgCollection").MsgCollection.hydrateOrGetMessages([e]),a=n[0];if(a==null)throw new(o("WAWebMiscErrors")).NotFoundError("No reactions found");var i=a.id.remote.toJid(),l=a.serverId,s=l!=null?yield o("WAWebNewsletterDBUtils").craftNewsletterMsgKeyFromServerId(l,i):null,u=s!=null?yield o("WAWebDBGetReactions").existsReactionAddressingModeInsensitive({parentMsgKey:s.toString(),senderUserJid:o("WAWebUserPrefsMeUser").getMePnUserOrThrow().toString()}):null;if(t==null&&u==null)throw new(o("WAWebMiscErrors")).NotFoundError("No reactions to display");var c={id:r("WAWebMsgKey").fromString(e)};return l!=null&&(c.parentMsgServerId=l),t!=null&&(c.reactionCountMap=t.emojiCountMap,c.reactionCountMapTs=o("WATimeUtils").castToUnixTime(t.serverTimestamp)),u!=null&&u.reactionText!==o("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT&&(c.myReactionMsgKey=r("WAWebMsgKey").from(u.msgKey),c.myReaction=u.reactionText,c.myReactionTs=o("WATimeUtils").castToUnixTime(u.timestamp)),c});return function(t){return e.apply(this,arguments)}})(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebNewsletterReactionModel").NewsletterMessageReactions;var s=new e;function u(e){var t=e.parentMsg,n=e.reactionCode,r=e.reactionMsg,o=s.gadd({id:t.id,myReactionMsgKey:r.id});return o.updateMyReaction(n),o}l.NewsletterMessageReactionsCollection=s,l.updateOrCreateMessageReaction=u}),98);
__d("WAWebNewsletterReportModel",["WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.reportStatus=o("WAWebBaseModel").prop(),t.creationTime=o("WAWebBaseModel").prop(),t.newsletterName=o("WAWebBaseModel").prop(),t.newsletterId=o("WAWebBaseModel").prop(),t.serverMsgId=o("WAWebBaseModel").prop(),t.responseServerMsgId=o("WAWebBaseModel").prop(),t.notifyName=o("WAWebBaseModel").prop(),t.appeal=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="newsletter_report";var s=o("WAWebBaseModel").defineModel(e);l.NewsletterReport=s}),98);
__d("WAWebNewsletterReportCollection",["WAWebBaseCollection","WAWebNewsletterReportModel"],(function(t,n,r,o,a,i,l){var e=function(t,n){var e,r,o=((e=n.appeal.creationTime)!=null?e:0)-((r=t.appeal.creationTime)!=null?r:0);return o!==0?o:n.creationTime-t.creationTime},s=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);s.model=o("WAWebNewsletterReportModel").NewsletterReport,s.comparator=e;var u=new s;l.NewsletterReportCollection=u}),98);
__d("WAWebNewsletterSubscribersCollection",["WAWebBaseCollection","WAWebCommonNewsletterEnums","WAWebFrontendContactGetters","WAWebNewsletterSubscriberModel"],(function(t,n,r,o,a,i,l){var e=function(t,n){if(t.membership===n.membership){if(!o("WAWebFrontendContactGetters").getIsMyContact(t.contact))return 1;if(!o("WAWebFrontendContactGetters").getIsMyContact(n.contact))return-1;var e=o("WAWebFrontendContactGetters").getFormattedUser(t.contact),r=o("WAWebFrontendContactGetters").getFormattedUser(n.contact);return e.localeCompare(r)}return t.membership===o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner?-1:n.membership===o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner?1:t.membership===o("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin?-1:1},s=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);s.model=o("WAWebNewsletterSubscriberModel").NewsletterSubscriber,s.comparator=e,l.default=s}),98);
__d("WAWebPsaVerifiedBlueIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="psa-verified-blue";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=20,R=20;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 20 20",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.595 8.23978L17.7696 9.43025L17.7615 9.42221C18.0795 9.74022 18.0795 10.2538 17.7614 10.5718L16.5868 11.7623L17.011 13.3849C17.117 13.817 16.8641 14.2655 16.4318 14.3797L14.8167 14.82L14.3762 16.4345C14.2539 16.8666 13.8134 17.1275 13.3811 17.0134L11.7578 16.5894L10.5669 17.7635C10.4119 17.9185 10.1998 18 9.99592 18C9.792 18 9.57991 17.9185 9.42493 17.7635L8.234 16.5894L6.61076 17.0134C6.17844 17.1275 5.7298 16.8666 5.6156 16.4345L5.17512 14.82L3.56003 14.3797C3.13587 14.2574 2.87484 13.817 2.98904 13.3849L3.4132 11.7623L2.23859 10.5718C1.92047 10.2538 1.92047 9.74009 2.23859 9.42209L3.4132 8.23162L2.98904 6.60899C2.87484 6.17684 3.12771 5.72837 3.56003 5.61422L5.17512 5.17391L5.6156 3.55943C5.73796 3.13543 6.17844 2.87451 6.61076 2.98866L8.234 3.41266L9.42493 2.2385C9.74305 1.9205 10.2569 1.9205 10.5751 2.2385L11.766 3.41266L13.3892 2.98866C13.8216 2.88266 14.2702 3.13543 14.3844 3.56759L14.8249 5.18206L16.44 5.62237C16.8723 5.74468 17.1333 6.18499 17.0191 6.61715L16.595 8.23978ZM9.37506 12.7678C9.21482 12.9279 9.01452 13 8.80621 13C8.5979 13 8.3976 12.9199 8.23736 12.7678L6.23435 10.7658C5.92188 10.4535 5.92188 9.94895 6.23435 9.63664C6.54682 9.32432 7.05158 9.32432 7.36405 9.63664L8.7982 11.0701L12.636 7.23423C12.9484 6.92192 13.4532 6.92192 13.7656 7.23423C14.0781 7.54655 14.0781 8.05105 13.7656 8.36336L11.5784 10.5656L9.37506 12.7678Z",fill:"#007BFC",style:{fill:"#007BFC",fillOpacity:1}})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.PsaVerifiedBlueIcon=m}),98);
__d("WAWebPsaVerifiedIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="psa-verified";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=18,R=18;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 18 18",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),version:"1.1",x:"0px",y:"0px",enableBackground:"new 0 0 18 18",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("polygon",{id:"Star-2",fill:"#00DA60",points:"9,16 7.1,16.9 5.8,15.2 3.7,15.1 3.4,13 1.5,12 2.2,9.9 1.1,8.2 2.6,6.7 2.4,4.6 4.5,4 5.3,2 7.4,2.4 9,1.1 10.7,2.4 12.7,2 13.6,4 15.6,4.6 15.5,6.7 17,8.2 15.9,9.9 16.5,12 14.7,13 14.3,15.1 12.2,15.2 10.9,16.9 "}),c.jsx("polygon",{id:"Check-Icon",fill:"#FFFFFF",points:"13.1,7.3 12.2,6.5 8.1,10.6 5.9,8.5 5,9.4 8,12.4 "})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.PsaVerifiedIcon=m}),98);
__d("WAWebNewsletterName.react",["fbt","WALogger","WAWebEmojiText.react","WAWebFbtCommon","WAWebFormatConfiguration","WAWebMiscGatingUtils","WAWebPsaVerifiedBlueIcon.react","WAWebPsaVerifiedIcon.react","react","useWAWebModelValues"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=o("react")),d={verified:{flexGrow:"x1c4vz4f",display:"x3nfvp2",overflowX:"xuce83p",overflowY:"x1bft6iq",textOverflow:"x1i7k8ik",whiteSpace:"xq9mrsl",alignItems:"x6s0dn4",$$css:!0},newsletterIcon:{display:"x78zum5",alignItems:"x6s0dn4",justifyContent:"xl56j7k",marginInlineStart:"xwklpps",$$css:!0}};function m(e){var t=e.chat,n=e.element,r=e.highlightText,a=e.titlify,i=e.ellipsify,l=e.breakWord,s=e.onClick,u=e.className,d=e.xstyle,m=e.testid,f=e.checkmarkLarge,g=f===void 0?!1:f,h=e.skipCheckMark,y=h===void 0?!1:h,C=e.selectable,b=o("useWAWebModelValues").useModelValues(t,["id","newsletterMetadata"]),v=o("useWAWebModelValues").useOptionalModelValues(b.newsletterMetadata,["verified"]),S=_(t),R=r!=null&&r!==""?o("WAWebFormatConfiguration").SearchName({terms:[r]}):void 0,L=c.jsx(o("WAWebEmojiText.react").EmojiText,{text:S,element:n,className:u,xstyle:d,formatters:R,titlify:a,ellipsify:i,breakWord:l,direction:"auto",inlineblock:!0,onClick:s,testid:void 0,selectable:C}),E=(v==null?void 0:v.verified)===!0;return c.jsx(p,{verified:E,checkmarkLarge:g,skipCheckMark:y,children:L})}m.displayName=m.name+" [from "+i.id+"]";function p(e){var t=e.checkmarkLarge,n=e.children,r=e.skipCheckMark,a=e.verified,i;if(a&&!r){var l=s._(/*BTDS*/"Canal verificado"),u=t?24:16;i=c.jsx("div",{className:"x78zum5 x6s0dn4 xl56j7k xwklpps",children:o("WAWebMiscGatingUtils").isBlueEnabled()?c.jsx(o("WAWebPsaVerifiedBlueIcon.react").PsaVerifiedBlueIcon,{"aria-label":l,width:u,height:u}):c.jsx(o("WAWebPsaVerifiedIcon.react").PsaVerifiedIcon,{"aria-label":l})})}return c.jsxs("span",{className:"x1c4vz4f x3nfvp2 xuce83p x1bft6iq x1i7k8ik xq9mrsl x6s0dn4",children:[n,i]})}p.displayName=p.name+" [from "+i.id+"]";function _(t){var n=o("useWAWebModelValues").useModelValues(t,["id","newsletterMetadata","formattedTitle"]),a=o("useWAWebModelValues").useOptionalModelValues(n.newsletterMetadata,["name","verified"]);return(a==null?void 0:a.name)!=null?a.name:n.formattedTitle!=null?n.formattedTitle:(o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][NewsletterName] undefined name"]))).tags("newsletter").devConsole("Undefined newsletter metadata name or chat.formattedTitle for "+n.id.toString()+" ").sendLogs("newsletter-undefined-name"),r("WAWebFbtCommon")("Untitled Channel"))}l.styles=d,l.NewsletterName=m}),226);
__d("WAWebGenerateRequestPaymentMessageProto",["WAWebPaymentsProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n=o("WAWebPaymentsProtoUtils").generatePaymentsNoteMessage(t);return{requestPaymentMessage:{amount1000:t.amount1000,expiryTimestamp:t._paymentExpiryTimestamp,requestFrom:t._paymentRequestFrom,currencyCodeIso4217:t._currencyCodeIso4217,noteMessage:n}}}l.default=e}),98);
__d("WAWebGenerateSendPaymentMessageProto",["WAWebE2EProtoUtils","WAWebPaymentsProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.json,n=t.paymentRequestMessageKey?{fromMe:t.paymentRequestMessageKey.fromMe,remoteJid:o("WAWebE2EProtoUtils").encodeJid(t.paymentRequestMessageKey.remote),id:t.paymentRequestMessageKey.id,participant:o("WAWebE2EProtoUtils").encodeJid(t.paymentRequestMessageKey.participant)}:void 0;return{sendPaymentMessage:{requestMessageKey:n,noteMessage:o("WAWebPaymentsProtoUtils").generatePaymentsNoteMessage(t)}}}l.default=e}),98);
__d("WAWebPaymentsProtoUtils",["WAWebE2EProtoGenerator","WAWebE2EProtoUtils"],(function(t,n,r,o,a,i,l){function e(e){if(e.paymentNoteMsg!=null){var t={stanzaId:e.quotedStanzaID,mentionedJid:e.mentionedJidList&&e.mentionedJidList.map(o("WAWebE2EProtoUtils").encodeJid),isForwarded:e.isForwarded,forwardingScore:e.forwardingScore,groupMentions:[],statusAttributions:[]},n=o("WAWebE2EProtoUtils").encodeJid(e.quotedParticipant);if(n!=null&&(t.participant=n),e.quotedMsg){var r=o("WAWebE2EProtoGenerator").getProtobufMessage(e.quotedMsg,void 0,void 0,void 0,"quoted");t.quotedMessage=o("WAWebE2EProtoUtils").getMutableMessageProtobuf(r)}return o("WAWebE2EProtoGenerator").getProtobufMessage(Object.assign(e.paymentNoteMsg,{_isPaymentNoteMsg:!0}),void 0,t)}}l.generatePaymentsNoteMessage=e}),98);
__d("WAWebPaymentRequestMsgAction",["WAWebDBProcessPaymentMessages","WAWebMsgCollection","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=new(o("WAWebMsgCollection")).MsgCollection.constructor.model(e),n=yield o("WAWebDBProcessPaymentMessages").processPaymentMessages([t]);n&&n.forEach(function(t){var n=o("WAWebMsgCollection").MsgCollection.get(t.id);n?n.set(t,{merge:!0}):t.id===e.id.toString()&&(e.type=t.type,e.templateParams=t.templateParams)})}),s.apply(this,arguments)}function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=new(o("WAWebMsgCollection")).MsgCollection.constructor.model(e),n=yield o("WAWebDBProcessPaymentMessages").processPaymentMessages([t]);n&&n.forEach(function(e){var t=o("WAWebMsgCollection").MsgCollection.get(e.id);t&&t.set(e,{merge:!0})})}),c.apply(this,arguments)}l.cancelOrDeclinePaymentRequest=e,l.fulfillPaymentRequest=u}),98);
__d("WAWebFormatPaymentMsg",["fbt","WAWebWidToFormattedNameOrNumber"],(function(t,n,r,o,a,i,l,s){function e(e){var t=r("WAWebWidToFormattedNameOrNumber")(e.remote);return e.fromMe?s._(/*BTDS*/"Invitaste a {otherUser} a usar la funci\u00f3n de pagos",[s._param("otherUser",t)]):s._(/*BTDS*/"{otherUser} te invit\u00f3 a usar la funci\u00f3n de pagos",[s._param("otherUser",t)])}l.formatPaymentInviteMessageText=e}),226);
__d("WAWebPinInChatGetters",["WAWebGetters","WAWebGettersCaches"],(function(t,n,r,o,a,i,l){var e=o("WAWebGetters").createGetterFactories({createCache:o("WAWebGettersCaches").createPinInChatsCache}),s=e.field,u=e.unsafeIdentityGetter,c=e.clearCacheFor,d=c,m=u,p=s("sender"),_=s("ack");l.clearPinInChatGetterCacheFor=d,l.getPinInChatUnsafe=m,l.getSender=p,l.getAck=_}),98);
__d("WAWebFrontendPinInChatGetters",["WAWebAck","WAWebGetters","WAWebGettersCaches","WAWebPinInChatGetters","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){var e=o("WAWebGetters").createGetterFactories({root:o("WAWebPinInChatGetters").getPinInChatUnsafe,createCache:o("WAWebGettersCaches").createFrontendPinInChatsCache}),s=e.field,u=e.computed,c=e.clearCacheFor,d=c,m=s("isSendFailure",{default:!1}),p=u(function(e){var t=e[0],n=e[1],r=e[2],a=o("WAWebUserPrefsMeUser").isMeAccount(t)&&n!=null&&n<o("WAWebAck").ACK.CLOCK;return a||!!r},[o("WAWebPinInChatGetters").getSender,o("WAWebPinInChatGetters").getAck,m]);l.clearFrontendPinInChatGetterCacheFor=d,l.getIsFailed=p}),98);
__d("WAWebPinInChatModel",["WATimeUtils","WAWebAddOnModel","WAWebBaseModel","WAWebFrontendPinInChatGetters","WAWebPinInChatGetters"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.msgKey=o("WAWebBaseModel").prop(),t.parentMsgKey=o("WAWebBaseModel").prop(),t.senderTimestampMs=o("WAWebBaseModel").prop(),t.t=o("WAWebBaseModel").prop(),t.sender=o("WAWebBaseModel").prop(),t.chatId=o("WAWebBaseModel").prop(),t.pinType=o("WAWebBaseModel").prop(),t.pinExpiryDuration=o("WAWebBaseModel").prop(),t.id=o("WAWebBaseModel").prop(),t.read=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.delete=function(){e.prototype.delete.call(this),o("WAWebPinInChatGetters").clearPinInChatGetterCacheFor(this),o("WAWebFrontendPinInChatGetters").clearFrontendPinInChatGetterCacheFor(this)},n.leftExpirationTime=function(){var e,t,n=((e=this.t)!=null?e:Math.floor(this.senderTimestampMs/1e3))+((t=this.pinExpiryDuration)!=null?t:0);return n-o("WATimeUtils").unixTime()},t})(o("WAWebAddOnModel").AddOnBaseModel),s=o("WAWebBaseModel").defineModel(e);l.PinInChat=s}),98);
__d("WAWebPinInChatCollection",["WATimeUtils","WAWebBaseCollection","WAWebCollectionUtils","WAWebFrontendPinInChatGetters","WAWebPinInChatModel","WAWebPinMsgConstants","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.byChatId=o("WAWebCollectionUtils").aggregated(function(e){return e.chatId}),t.byIsFailedByMe=o("WAWebCollectionUtils").aggregated(function(e){return o("WAWebFrontendPinInChatGetters").getIsFailed(e)&&o("WAWebUserPrefsMeUser").isMeAccount(e.sender)}),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.deleteByParentMessageKey=function(t){this.remove(s(t))},n.getByMsgKey=function(t){return this.findFirst(function(e){return e.msgKey.equals(t)})},n.getByParentMsgKey=function(t){return this.get(s(t))},t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebPinInChatModel").PinInChat,e.comparator=function(e,t){return Number(t.t)-Number(e.t)};function s(e){return"!!"+e.toString()}function u(e){var t,n;if(e.senderTimestampMs==null)return!1;var r=e.pinExpiryDuration!=null,a=((t=e.t)!=null?t:Math.floor(e.senderTimestampMs/1e3))+((n=e.pinExpiryDuration)!=null?n:0);return r&&a<o("WATimeUtils").unixTime()}function c(e){return e.pinType===o("WAWebPinMsgConstants").PIN_STATE.PIN&&e.parentMsgKey!=null&&!u(e)}var d=new e;l.getPinInChatId=s,l.isPinExpired=u,l.isPinValid=c,l.PinInChatCollection=d}),98);
__d("WAWebDBPollsInvalidateChatPolls",["WAWebDBMessageUtils","WAWebModelStorageUtils","WAWebMsgType","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebModelStorageUtils").getStorage().lock(["message"],(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t[0],r=yield n.between(["internalId"],o("WAWebDBMessageUtils").beginningOfChat(e),o("WAWebDBMessageUtils").endOfChat(e));yield n.bulkCreateOrMerge(r.filter(function(e){return e.type===o("WAWebMsgType").MSG_TYPE.POLL_CREATION&&!e.pollInvalidated}).map(function(e){return{id:e.id,pollInvalidated:!0}}))});return function(e){return t.apply(this,arguments)}})())}l.invalidateChatPolls=e}),98);
__d("WAWebPollsInvalidateChatPollMsgsAction",["WALogger","WAWebDBPollsInvalidateChatPolls","WAWebFrontendMsgGetters","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){try{yield o("WAWebDBPollsInvalidateChatPolls").invalidateChatPolls(t.id),t.msgs.filter(function(e){return o("WAWebFrontendMsgGetters").getAsPollCreation(e)&&!e.pollInvalidated}).forEach(function(e){e.pollInvalidated=!0})}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[POLLS] Failed to invalidate polls with error: ",""])),t).devConsole(t)}}),u.apply(this,arguments)}l.invalidateChatPollMsgs=s}),98);
__d("WAWebPollsPollVoteCollection",["WANullthrows","WAWebApiContact","WAWebBaseCollection","WAWebLidMigrationUtils","WAWebMaybe","WAWebPollsPollVoteModel","WAWebUserPrefsMeUser","WAWebWidFactory"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getVoteFromSenderAddressingModeInsensitive=function(t){var e=o("WAWebApiContact").getAlternateUserWid(o("WAWebWidFactory").asUserWidOrThrow(t));return this.findFirst(function(n){return n.sender.equals(t)||n.sender.equals(e)})},n.getUnreadCount=function(){return this.filter(function(e){return e.selectedOptionLocalIds.length>0&&!e.read&&!o("WAWebUserPrefsMeUser").isMeAccount(e.sender)}).length},n.getVoteCount=function(){return this.filter(function(e){return e.selectedOptionLocalIds.length>0}).length},t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebPollsPollVoteModel").PollVote;var s=(function(t){function n(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,e.$PollVoteCollectionImpl$p_1=new Map,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(n,t);var r=n.prototype;return r.add=function(n,r){var e=t.prototype.add.call(this,n,r),o=m(e.filter(Boolean));for(var a of o){var i=a[0],l=a[1],s=this.getForParentAddressingModeInsensitive([i]),u=s[0];u.add(l)}return e},r.remove=function(n,r){var e=t.prototype.remove.call(this,n,r),o=m(e.filter(Boolean));for(var a of o){var i=a[0],l=a[1];this.getForParentAddressingModeInsensitive([i])[0].remove(l)}return e},r.reset=function(){t.prototype.reset.call(this);for(var e of this.$PollVoteCollectionImpl$p_1.values())e.reset();this.$PollVoteCollectionImpl$p_1.clear()},r.getForParentAddressingModeInsensitive=function(t){var e=this;return t.map(function(t){return e.$PollVoteCollectionImpl$p_2(t)})},r.$PollVoteCollectionImpl$p_2=function(n){var t,r=this,a=(t=this.$PollVoteCollectionImpl$p_1.get(n.toString()))!=null?t:o("WAWebMaybe").ifSome(o("WAWebLidMigrationUtils").getAlternateMsgKey(n),function(e){return r.$PollVoteCollectionImpl$p_1.get(e.toString())});return a==null&&(a=new e,a.add(this.filter(function(e){return e.parentMsgKey.equals(n)})),this.$PollVoteCollectionImpl$p_1.set(n.toString(),a)),a},r.getByMsgKey=function(t){return this.get(u(t))},n})(o("WAWebBaseCollection").BaseCollection);s.model=o("WAWebPollsPollVoteModel").PollVote;function u(e){return"!!"+e.toString()}function c(e){return new(o("WAWebPollsPollVoteModel")).PollVote(babelHelpers.extends({id:u(e.msgKey)},e))}var d=new s;function m(e){var t=new Map;return e&&e.forEach(function(e){var n=e.parentMsgKey;t.has(n)||t.set(n,[]),r("WANullthrows")(t.get(n)).push(e)}),t}l.GroupedPollVoteCollection=e,l.createPollVoteModel=c,l.PollVoteCollection=d}),98);
__d("WAWebPollVoteGetters",["WAWebGetters","WAWebGettersCaches"],(function(t,n,r,o,a,i,l){var e=o("WAWebGetters").createGetterFactories({createCache:o("WAWebGettersCaches").createPollVotesCache}),s=e.field,u=e.computed,c=e.unsafeIdentityGetter,d=e.clearCacheFor,m=d,p=c,_=s("parentMsgKey"),f=s("sender"),g=s("ack"),h=s("t"),y=s("senderTimestampMs"),C=s("selectedOptionLocalIds"),b=u(function(e){var t=e[0];return t.length===0},[C]),v=u(function(e){var t=e[0],n=e[1];return t==null||t===0?n:t*1e3},[h,y]);l.clearPollVoteGetterCacheFor=m,l.getPollVoteUnsafe=p,l.getParentMsgKey=_,l.getSender=f,l.getAck=g,l.getIsUnvote=b,l.getTimestamp=v}),98);
__d("WAWebPollsPollVoteModel",["WAWebAddOnModel","WAWebBaseModel","WAWebFrontendPollVoteGetters","WAWebPollVoteGetters"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.msgKey=o("WAWebBaseModel").prop(),t.parentMsgKey=o("WAWebBaseModel").prop(),t.selectedOptionLocalIds=o("WAWebBaseModel").prop(),t.senderTimestampMs=o("WAWebBaseModel").prop(),t.t=o("WAWebBaseModel").prop(),t.sender=o("WAWebBaseModel").prop(),t.read=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.delete=function(){e.prototype.delete.call(this),o("WAWebPollVoteGetters").clearPollVoteGetterCacheFor(this),o("WAWebFrontendPollVoteGetters").clearFrontendPollVoteGetterCacheFor(this)},n.getData=function(){return{msgKey:this.msgKey,parentMsgKey:this.parentMsgKey,selectedOptionLocalIds:this.selectedOptionLocalIds,senderTimestampMs:this.senderTimestampMs,t:this.t,sender:this.sender,ack:this.ack,read:this.read}},t})(o("WAWebAddOnModel").AddOnBaseModel);e.Proxy="poll_vote";var s=o("WAWebBaseModel").defineModel(e);l.PollVote=s}),98);
__d("WAWebPollsVoteNotification",["fbt","WAWebBaseNotification","WAWebFrontendChatGetters","WAWebFrontendMsgGetters","WAWebGetNotificationStrings","WAWebNotificationController","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebNotificationMuteReason","WAWebPollsPollVoteCollection","asyncToGeneratorRuntime","gkx"],(function(t,n,r,o,a,i,l,s){var e=(function(e){function t(t){var n,r=t.creationMsg;return n=e.call(this)||this,n.$PollVoteNotification$p_3=function(){n.$PollVoteNotification$p_2.getUnreadCount()===0&&n.closeBanner()},n.$PollVoteNotification$p_1=r,n.$PollVoteNotification$p_2=o("WAWebPollsPollVoteCollection").PollVoteCollection.getForParentAddressingModeInsensitive([r.id])[0],n.bodyText=u({unreadCount:n.$PollVoteNotification$p_2.getUnreadCount(),pollName:n.$PollVoteNotification$p_1.pollName}),n}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a.shouldPlaySound=function(){if(!e.prototype.shouldPlaySound.call(this))return!1;var t=o("WAWebFrontendMsgGetters").getChat(this.$PollVoteNotification$p_1.unsafe());return o("WAWebNotificationHelpers").shouldPlaySoundGranular(t)&&!o("WAWebNotificationHelpers").shouldSquelch(t,!1)},a.shouldShowBanner=function(){if(!e.prototype.shouldShowBanner.call(this))return!1;var t=o("WAWebFrontendMsgGetters").getChat(this.$PollVoteNotification$p_1.unsafe());return o("WAWebNotificationHelpers").shouldEnableNotificationGranular(t)},a.shouldMute=function(t){return o("WAWebNotificationHelpers").shouldMuteDueToAppState(t)?r("WAWebNotificationMuteReason").AppState:o("WAWebNotificationHelpers").isMutedAndNotMentioned(this.$PollVoteNotification$p_1.unsafe())?r("WAWebNotificationMuteReason").MutedChat:o("WAWebNotificationHelpers").isArchivedAndNotMentioned(this.$PollVoteNotification$p_1.unsafe())?r("WAWebNotificationMuteReason").ArchivedChat:!r("gkx")("26258")&&o("WAWebNotificationHelpers").shouldIgnoreGroupMsg(this.$PollVoteNotification$p_1.unsafe())?r("WAWebNotificationMuteReason").IgnoreGroupMsg:o("WAWebNotificationHelpers").isOfflineResumeInProgress()?r("WAWebNotificationMuteReason").OfflineResumeInProgress:null},a.shouldSquelch=function(){if(o("WAWebNotificationController").WANotificationController.notificationExists(this.buildKey()))return null;var e=o("WAWebFrontendMsgGetters").getChat(this.$PollVoteNotification$p_1.unsafe());return o("WAWebNotificationHelpers").shouldSquelch(e,!1)?r("WAWebNotificationMuteReason").GroupFlood:null},a.afterBannerShown=function(t){var e=this;this.$PollVoteNotification$p_2.on("change add remove reset",this.$PollVoteNotification$p_3),t.waitForClose().then(function(){e.$PollVoteNotification$p_2.off("change add remove reset",e.$PollVoteNotification$p_3)})},a.buildKey=function(){return"vote:"+this.$PollVoteNotification$p_1.id.toString()},a.matchesChat=function(t){return o("WAWebFrontendMsgGetters").getChat(this.$PollVoteNotification$p_1.unsafe()).equals(t)},a.getChatKind=function(){return o("WAWebFrontendChatGetters").getKind(o("WAWebFrontendMsgGetters").getChat(this.$PollVoteNotification$p_1.unsafe()))},a.getIcon=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("WAWebFrontendMsgGetters").getChat(this.$PollVoteNotification$p_1.unsafe());return o("WAWebNotificationIconUtils").getChatNotificationIcon(e,this.abortController.signal)});function t(){return e.apply(this,arguments)}return t})(),a.getBannerOptions=function(){var e=this.$PollVoteNotification$p_1,t=o("WAWebFrontendMsgGetters").getChat(e.unsafe());return{wid:t.id,msgId:e.id.toString(),tag:this.buildKey(),title:o("WAWebNotificationHelpers").getNotificationTitle(t),body:o("WAWebGetNotificationStrings").getNotificationBody(babelHelpers.extends({},this.$PollVoteNotification$p_4(),{msgDir:o("WAWebFrontendMsgGetters").getDir(e)}))}},a.$PollVoteNotification$p_4=function(){return{body:this.bodyText}},t})(o("WAWebBaseNotification").WABaseNotification);function u(e){var t=e.unreadCount,n=e.pollName;return s._(/*BTDS*/"_j{\"*\":\"Nuevos votos por {number_of_votes}: \\ud83d\\udcca {pollName}\",\"4\":\"Nuevo voto por {number_of_votes}: \\ud83d\\udcca {pollName}\",\"_1\":\"Nuevo voto por 1: \\ud83d\\udcca {pollName}\"}",[s._plural(t,"number_of_votes"),s._param("pollName",n)]).toString()}l.PollVoteNotification=e}),226);
__d("WAWebBootstrapPremiumMessages",["Promise","WAWebDebounce","WAWebMiscGatingUtils","WAWebMsgCollection","WAWebPremiumMessageCollection","WAWebPremiumMessageSchema","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=250;function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!o("WAWebMiscGatingUtils").isRambutanEnabled())return(e||(e=n("Promise"))).resolve();var t=yield o("WAWebPremiumMessageSchema").getPremiumMessageTable().all();o("WAWebPremiumMessageCollection").PremiumMessageCollection.initializeFromCache(t)}),c.apply(this,arguments)}function d(){o("WAWebMiscGatingUtils").isRambutanEnabled()&&(o("WAWebMsgCollection").MsgCollection.listenTo(o("WAWebMsgCollection").MsgCollection,"add",r("WAWebDebounce")(m,s,{leading:!0})),o("WAWebPremiumMessageCollection").PremiumMessageCollection.listenTo(o("WAWebPremiumMessageCollection").PremiumMessageCollection,"add",function(e){return e.hydrateMessages()}))}function m(){o("WAWebPremiumMessageCollection").PremiumMessageCollection.getModelsArray().forEach(function(e){e.hydrateMessages()})}l.restorePremiumMessages=u,l.bindPremiumMessageListeners=d}),98);
__d("WAWebPremiumMessageHydrateMessageAction",["WAWebContactCollection","WAWebContactGetters","WAWebMsgType","WAWebProtobufSyncAction.pb"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WAWebContactCollection").ContactCollection.get(e.id.remote);if(n!=null)switch(t.type){case o("WAWebProtobufSyncAction.pb").SyncActionValue$MarketingMessageAction$MarketingMessagePrototypeType.PERSONALIZED:{var r=s(t,n);e.mediaData==null?e.set("body",r):e.set("caption",r);break}default:e.type=o("WAWebMsgType").MSG_TYPE.UNKNOWN;break}}function s(e,t){var n=u(e,t);return n}function u(e,t){var n=o("WAWebContactGetters").getPremiumMessageName(t);return n===""?e.message.replaceAll(/ ?<<customer_name>>/g,""):e.message.replace(/<<customer_name>>/g,n)}l.hydratePremiumMessage=e}),98);
__d("WAWebPremiumMessageCollection",["WAWebBaseCollection","WAWebPremiumMessageModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebPremiumMessageModel").PremiumMessage;var s=new e;l.PremiumMessageCollection=s}),98);
__d("WAWebPremiumMessageModel",["WAWebBaseModel","WAWebMsgCollection","WAWebPremiumMessageHydrateMessageAction"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.name=o("WAWebBaseModel").prop(),t.type=o("WAWebBaseModel").prop(),t.message=o("WAWebBaseModel").prop(),t.isDeleted=o("WAWebBaseModel").prop(),t.sentMessageIds=o("WAWebBaseModel").prop(),t.mediaId=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){e.prototype.initialize.call(this),this.listenTo(this,"change:message change:sentMessageIds change:type",this.hydrateMessages)},n.hydrateMessages=function(){var e=this;o("WAWebMsgCollection").MsgCollection.getModelsArray().filter(function(t){return t.smbClientCampaignId===e.id}).forEach(function(t){o("WAWebPremiumMessageHydrateMessageAction").hydratePremiumMessage(t,e)})},t})(o("WAWebBaseModel").BaseModel);e.Proxy="premium_message";var s=o("WAWebBaseModel").defineModel(e);l.PremiumMessage=s}),98);
__d("WaWebPDFNCommonUtils",["fbt","$InternalEnum","WAWebTos","WAWebUserDisclosureCollection","isStringNullOrEmpty","stylex"],(function(t,n,r,o,a,i,l,s){var e,u="ACCEPTED",c=n("$InternalEnum").Mirrored(["Meta","WhatsApp"]),d=n("$InternalEnum").Mirrored(["Blocking","NonBlocking"]);function m(e){var t=o("WAWebUserDisclosureCollection").UserDisclosureCollection.get(e);return t!=null&&t.accepted?!0:o("WAWebTos").TosManager.getState(e)===u}function p(e,t){var n,o,a,i,l,s=e==null||(n=e.privacyDisclosureModal)==null?void 0:n.bullets;s!=null&&s.forEach(function(e){e.text=_(e.text,t),r("isStringNullOrEmpty")(e.secondaryText)||(e.secondaryText=_(e.secondaryText,t))});var u=e==null||(o=e.privacyDisclosureModal)==null?void 0:o.footer,c=u!=null?_(u,t):u,d={icon:e==null||(a=e.privacyDisclosureModal)==null?void 0:a.icon,iconSvg:e==null||(i=e.privacyDisclosureModal)==null?void 0:i.iconSvg,iconDescription:e==null||(l=e.privacyDisclosureModal)==null?void 0:l.iconDescription},m=f(e);return{bulletContent:s,footerContent:c,okText:m,headerContent:d}}function _(t,n){var o=new DOMParser,a=o.parseFromString(t,"text/html"),i=n!=null?n:{},l=i.linkXstyle;return a.querySelectorAll("a").forEach(function(t){t.setAttribute("target","_blank"),l&&t.setAttribute("class",(e||(e=r("stylex")))(l))}),a.body.innerHTML}function f(e){var t,n;return(t=e==null||(n=e.privacyDisclosureModal)==null||(n=n.primaryButton)==null?void 0:n.label)!=null?t:s._(/*BTDS*/"Continuar")}l.PdfnTheme=c,l.PdfnNoticeType=d,l.hasAcceptedTos=m,l.getFormattedPdfnContent=p}),226);
__d("WAWebFrontendConstants",[],(function(t,n,r,o,a,i){var e=100,l=1024,s=264;i.SCROLL_FUDGE=e,i.LAYOUT_2COLUMNS_MAX_WIDTH=l,i.QR_EDGE=s}),66);
__d("WAWebBizCatalogUtils",["Promise","WATypeUtils","WAWebCatalogCollection","WAWebFrontendConstants","WAWebNonEmptyString","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){var e,s=3;function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=e.getData().length||0,r=!e.getCanLoadMore()||!f(n,e.listItemHeight),a=o("WAWebUserPrefsMeUser").getMePnUserOrThrow();if(t&&o("WAWebQplQuickPerformanceLoggerModule").QPL.markerAnnotate(t,{bool:{IsCached:r,IsConsumer:!a.equals(e.catalog.id)}}),r)return!0;yield e.loadMore(!0);var i=e.getData().length||0;return f(i,e.listItemHeight)?e.loadInitialItems():!0}),c.apply(this,arguments)}var d=(function(){function t(e,t,n,o){if(this.loading=null,this.catalog=e,this.collectionId=t,this.forCatalogManager=n,this.listItemHeight=o,r("isStringNullOrEmpty")(t))this.canLoadMoreAllItems=e.productCollection.length>0?!!this.catalog.afterCursor:!0;else{var a;this.canLoadMoreCollectionItems=e.collections.length>0?((a=this.catalog.collections.get(t))==null?void 0:a.afterCursor)!=="":!0}}var a=t.prototype;return a.loadMore=function(a){var t=this;if(this.loading)return this.loading;if(!this.getCanLoadMore())return(e||(e=n("Promise"))).resolve();var i=this.collectionId;if(r("isStringNullOrEmpty")(i))this.loading=o("WAWebCatalogCollection").CatalogCollection.update(this.catalog.id).then(function(){t.canLoadMoreAllItems=!!t.catalog.afterCursor,t.loading=null});else{var l=a===!0?o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_COLLECTION_VIEW_ALL:void 0;this.loading=this.catalog.collections.findCollectionProducts(this.catalog.id,i,!1,l).then(function(){var e;t.canLoadMoreCollectionItems=!!((e=t.catalog.collections.get(i))!=null&&e.afterCursor),t.loading=null})}return this.loading},a.loadInitialItems=function(){var e=o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_COLLECTION_VIEW_ALL;return u(this,e)},a.getCanLoadMore=function(){return this.canLoadMoreCollectionItems||this.canLoadMoreAllItems},a.getData=function(){var e=this.collectionId,t;if(r("isStringNullOrEmpty")(e))t=this.catalog.productCollection.getProductModels(this.forCatalogManager)||[];else{var n;t=((n=this.catalog.collections.get(e))==null?void 0:n.productCollection.getProductModels(this.forCatalogManager))||[]}return t.map(function(e){return{product:e,collection:void 0}})},t})(),m=(function(){function t(e,t,n,r){this.loading=null,this.catalog=e,this.forCatalogManager=t,this.listItemHeight=n,this.canLoadMoreCollections=e.collections.length>0?!!this.catalog.collections.afterCursor:!0,this.canLoadMoreCatalog=e.productCollection.length>0?!!this.catalog.afterCursor:!0,this.canLogQpl=r}var r=t.prototype;return r.loadMore=function(r){var t=this;if(this.loading)return this.loading;if(!this.getCanLoadMore())return(e||(e=n("Promise"))).resolve();if(this.canLoadMoreCollections){var a=this.canLogQpl&&r===!0?o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_CATALOG_COLLECTIONS_VIEW:void 0;this.loading=this.catalog.collections.findCollectionsList(this.catalog.id,s,this.forCatalogManager,a).then(function(){t.canLoadMoreCollections=!!t.catalog.collections.afterCursor,t.loading=null})}else this.loading=o("WAWebCatalogCollection").CatalogCollection.update(this.catalog.id).then(function(){t.canLoadMoreCatalog=!!t.catalog.afterCursor,t.loading=null});return this.loading},r.loadInitialItems=function(){var e=this.canLogQpl?o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_CATALOG_COLLECTIONS_VIEW:void 0;return u(this,e)},r.getCanLoadMore=function(){return this.canLoadMoreCollections||this.canLoadMoreCatalog},r.getData=function(){var e=this,t=this.catalog.collections.getCollectionModels(this.forCatalogManager),n=t.reduce(function(t,n){t===void 0&&(t=[]);var r=n.productCollection.getProductModels(e.forCatalogManager)||[];if(r.length!==0){var o;t.push({collection:n,product:void 0}),r.length>s&&(r.length=s),(o=t).push.apply(o,r.map(function(e){return{product:e,collection:n}}))}return t},[]),r=n.length>0;if(this.canLoadMoreCollections)return n;r&&n.push({allItems:{totalItemsCount:n.length}});var o=this.catalog.productCollection.getProductModels(this.forCatalogManager).map(function(e){return{product:e,collection:void 0}});return n.push.apply(n,o),n},t})(),p=(function(){function t(e,t,n,r){this.loading=null,this.canLoadMoreCollections=!0,this.catalog=e,this.forCatalogManager=t,this.listItemHeight=n,this.canLogQpl=r}var r=t.prototype;return r.loadMore=function(r){var t=this;if(this.loading)return this.loading;if(!this.getCanLoadMore())return(e||(e=n("Promise"))).resolve();if(this.canLoadMoreCollections){var a=this.canLogQpl&&r===!0?o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_COLLECTIONS_MANAGEMENT_VIEW:void 0;this.loading=this.catalog.collections.findCollectionsList(this.catalog.id,s,this.forCatalogManager,a).then(function(){t.canLoadMoreCollections=!!t.catalog.collections.afterCursor,t.loading=null})}return this.loading||(e||(e=n("Promise"))).resolve()},r.loadInitialItems=function(){var e=this.canLogQpl?o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_COLLECTIONS_MANAGEMENT_VIEW:void 0;return u(this,e)},r.getCanLoadMore=function(){return this.canLoadMoreCollections},r.resetData=function(){var e;(e=this.catalog)!=null&&e.collections&&(this.catalog.collections.reset(),this.catalog.collections.afterCursor=""),this.canLoadMoreCollections=!0},r.getData=function(){return this.catalog.collections.getCollectionModels(this.forCatalogManager).map(function(e){return{collection:e,product:void 0}})},t})(),_=(function(){function t(e,t,n){this.loading=null,this.canLoadMore=!0,this.catalog=e,this.catalog.stale=!0,this.catalog.markProductCollectionOld(),this.catalog.productCollection.reset(),this.listItemHeight=t,this.collectionId=o("WAWebNonEmptyString").asMaybeNonEmptyString(n)}var a=t.prototype;return a.loadMore=function(){var t=this;return this.loading?this.loading:this.getCanLoadMore()?(this.canLoadMore&&(r("isStringNullOrEmpty")(this.collectionId)?this.loading=o("WAWebCatalogCollection").CatalogCollection.update(this.catalog.id).then(function(){t.canLoadMore=!!t.catalog.afterCursor,t.loading=null}):this.loading=o("WAWebCatalogCollection").CatalogCollection.findCollectionMembership(this.catalog.id,this.collectionId).then(function(){t.canLoadMore=!!t.catalog.afterCursor,t.loading=null})),this.loading||(e||(e=n("Promise"))).resolve()):(e||(e=n("Promise"))).resolve()},a.loadInitialItems=function(){return u(this)},a.getCanLoadMore=function(){return this.canLoadMore},a.getData=function(){return this.catalog.productCollection.getProductModels(!0).map(function(e){return{product:e,collection:void 0}})},t})();function f(e,t){return e*t<window.innerHeight}var g=(function(){function e(e){this.dataSource=e}var t=e.prototype;return t.isScrollAtBottom=function(t){return t.scrollTop+o("WAWebFrontendConstants").SCROLL_FUDGE>=t.scrollHeight-t.clientHeight},t.willLoadMore=function(t){return!!(this.dataSource.loading||this.isScrollAtBottom(t))},t.onScroll=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){return this.dataSource.loading?(yield this.dataSource.loading,!0):this.isScrollAtBottom(t)?(yield this.dataSource.loadMore(),!0):!1});function t(t,n){return e.apply(this,arguments)}return t})(),e})();function h(e,t,n){var a=o("WAWebCatalogCollection").CatalogCollection.get(e),i,l;if(a){if(!r("isStringNullOrEmpty")(t)&&n){var s=a.productCollection.get(n.id);return i=s&&a.productCollection.indexOf(s),{productId:n.id.toString(),productIndex:o("WATypeUtils").isNumber(i)&&i>-1?i.toString():void 0}}if(!r("isStringNullOrEmpty")(t)){var u=a.collections.get(t);l=u&&a.collections.indexOf(u);var c=n&&(u==null?void 0:u.productCollection.get(n.id));i=c&&(u==null?void 0:u.productCollection.indexOf(c))}return{collectionId:t||"",productId:n==null?void 0:n.id.toString(),collectionIndex:o("WATypeUtils").isNumber(l)&&l>-1?l.toString():void 0,productIndex:o("WATypeUtils").isNumber(i)&&i>-1?i.toString():void 0}}}l.SingleCollectionDataSource=d,l.CatalogWithCollectionsDataSource=m,l.CollectionsDataSource=p,l.CollectionsContentDataSource=_,l.CatalogListItemScrollHelper=g,l.getProductStatsInFetched=h}),98);
__d("WAWebChangeProfilePicThumb",["Promise","WAWebApiContact","WAWebBackendApi","WAWebContactProfilePicThumbBridge","WAWebProfilePicConstants","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){var a=[c(t,r)];if(t.isUser()){var i=o("WAWebApiContact").getAlternateUserWid(t);i&&a.push(c(i,r))}yield(e||(e=n("Promise"))).all(a)}),u.apply(this,arguments)}function c(e,t){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(t===o("WAWebProfilePicConstants").ProfilePicCommand.Remove)yield o("WAWebContactProfilePicThumbBridge").persistProfilePicToDB(e),o("WAWebBackendApi").frontendFireAndForget("removeProfilePicThumb",{wid:e});else return o("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("setProfilePicThumb",{wid:e})}),d.apply(this,arguments)}l.changeProfilePicThumb=s}),98);
__d("WAWebProfilePicThumbCollection",["Promise","WAFilteredCatch","WALogger","WATimeUtils","WAWebBackendErrors","WAWebBaseCachePolicy","WAWebBaseCollection","WAWebChatCollection","WAWebChatGetters","WAWebContactCollection","WAWebContactProfilePicThumbBridge","WAWebGroupType","WAWebNewsletterCollection","WAWebProfilePicPrivacyTokenGating","WAWebProfilePicThumbModel","WAWebSocketConstants","WAWebSocketModel","WAWebUnjoinedSubgroupMetadataCollection","WAWebUserPrefsKeys","WAWebVcardParsingUtils","WAWebWid","asyncToGeneratorRuntime","cr:17219"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_=(function(t){function a(){var e,a;a=t.call(this)||this,a.findImpl=function(e){var t,a,i,l,s=e.isNewsletter()?r("WAWebNewsletterCollection"):o("WAWebChatCollection").ChatCollection,u=s.get(e),c=(u==null||(t=u.groupMetadata)==null?void 0:t.groupType)===o("WAWebGroupType").GroupType.COMMUNITY,d=r("WAWebUnjoinedSubgroupMetadataCollection").get(e.toString());if(u!=null&&u.isReadOnly&&!c&&!(u!=null&&o("WAWebChatGetters").getIsNewsletter(u))&&d==null||u!=null&&(a=u.groupMetadata)!=null&&a.terminated||u!=null&&(i=u.newsletterMetadata)!=null&&i.terminated||u!=null&&(l=u.newsletterMetadata)!=null&&l.isPreview)return(p||(p=n("Promise"))).resolve({id:e,stale:!0});if((r("WAWebWid").isUser(e)||r("WAWebWid").isGroup(e)||r("WAWebWid").isNewsletter(e))&&!r("WAWebWid").isPSA(e)){var m,_=c?e:u==null||(m=u.groupMetadata)==null?void 0:m.parentGroup;if(d!=null&&(_=d.parentGroupId),o("WAWebSocketModel").Socket.stream!==o("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED){if(o("WAWebProfilePicPrivacyTokenGating").isProfilePicIQPrivacyTokenEnabled()&&r("WAWebWid").isUser(e)){var f,g=o("WAWebContactCollection").ContactCollection.get(e),h=o("WAWebChatCollection").ChatCollection.get(e);return o("WAWebContactProfilePicThumbBridge").requestProfilePicFromServer(e,_,h==null?void 0:h.tcToken,(h==null?void 0:h.tcToken)==null?g==null||(f=g.maybeCommonGroupChatModel)==null?void 0:f.id:null)}return o("WAWebContactProfilePicThumbBridge").requestProfilePicFromServer(e,_)}return(p||(p=n("Promise"))).resolve({id:e,stale:!0})}return(p||(p=n("Promise"))).resolve({id:e,tag:null})},a._getUpdatedProfilePicModel=function(e){return{tag:e.tag,raw:void 0,stale:!1,eurl:e.eurl,eurlStale:!1,previewEurl:e.previewEurl,previewDirectPath:e.previewDirectPath,fullDirectPath:e.fullDirectPath,filehash:e.filehash,timestamp:Date.now()}};var i=(e=n("cr:17219"))==null?void 0:e.getWindowsBridge();return i&&a.listenTo(a,"add remove change:timestamp",function(e,t,n){var r;(r=i.pictures)==null||r.notifyUpdate(e)}),a}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.get=function(n){var e=t.prototype.get.call(this,n);return this.isProfilePicRefreshNeeded(e==null?void 0:e.timestamp,e==null?void 0:e.eurlStale)&&(e==null||e.markStale({eurl:!0})),this.modelClass.prototype.isIdType(n),e},i.resyncPicturesByWid=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=this;try{var r=yield o("WAWebContactProfilePicThumbBridge").profilePicResync(t.map(function(e){return{id:e}}));o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["ProfilePicThumbStore:resyncPictures success"]))),r.forEach(function(e){var t=n._getUpdatedProfilePicModel(e),r=n.get(e.id);r?r.set(t):n.add(babelHelpers.extends({id:e.id},t))})}catch(e){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["ProfilePicThumbStore:resyncMyProfilePicture failed: ",""])),e)}});function r(e){return t.apply(this,arguments)}return r})(),i.resyncPictures=function(t){var e=this;return t.length===0?(p||(p=n("Promise"))).resolve():o("WAWebContactProfilePicThumbBridge").profilePicResync(t.map(function(e){return{id:e.id,tag:e.tag}})).then(function(n){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["ProfilePicThumbStore:resyncPictures success"]))),n.forEach(function(t){var n=e.get(t.id);n&&n.set(e._getUpdatedProfilePicModel(t))}),t.forEach(function(t){t.eurlStale&&e.update(t.id),t.stale=!1})}).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").ServerStatusCodeError,function(e){e.status===423||e.status===429?o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["ProfilePicThumbStore:resyncPictures blocked ",""])),e.status):e.status>=400&&o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["ProfilePicThumbStore:resyncPictures dropped: ",""])),String(e))})).catch(function(e){o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["ProfilePicThumbStore:resyncPictures dropped: ",""])),String(e))})},i.findThumbnailWid=function(t){var e=this;return t.find(function(t){var n;return(n=e.get(t))==null?void 0:n.img})},i.getThumbnailWidFromVcard=function(t){if(!t)return null;var e=o("WAWebVcardParsingUtils").vcardPhoneNumberWids(t).map(function(e){return e});if(e.length>0){var n;return(n=this.findThumbnailWid(e))!=null?n:e[0]}var r=o("WAWebVcardParsingUtils").vcardLidWid(t);return r!=null?r:null},i.isProfilePicRefreshNeeded=function(t,n){if(n===void 0&&(n=!1),t==null||n)return!0;var e=Date.now()-t;return e>o("WATimeUtils").WEEK_MILLISECONDS},a})(o("WAWebBaseCollection").BaseCollection);_.model=o("WAWebProfilePicThumbModel").ProfilePicThumb,_.staleCollection=!0,_.cachePolicy={id:o("WAWebUserPrefsKeys").COLLECTIONS_KEYS.PROFILE_PIC_THUMB_COLLECTION,trigger:"change:tag",policy:o("WAWebBaseCachePolicy").CACHE_POLICY.NONE,delay:5e3};var f=new _;l.ProfilePicThumbCollection=f}),98);
__d("WAWebProfilePicThumbModel",["WALogger","WAWebBaseModel","WAWebChatCollection","WAWebMediaHosts","WAWebMediaHostsRouteSelection","WAWebMmsClientSelectHost","WAWebMmsMediaTypes","WAWebProfilePicConstants","WAWebProfilePicThumbCollection","WAWebUserPrefsMeUser","WAWebWid","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){var e,s,u,c={SINGLE:"SINGLE",GROUP:"GROUP"},d=(function(t){function n(){for(var e,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a))||this,e.id=o("WAWebBaseModel").prop(),e.tag=o("WAWebBaseModel").prop(),e.raw=o("WAWebBaseModel").prop(),e.eurl=o("WAWebBaseModel").prop(),e.previewEurl=o("WAWebBaseModel").prop(),e.fullDirectPath=o("WAWebBaseModel").prop(),e.previewDirectPath=o("WAWebBaseModel").prop(),e.filehash=o("WAWebBaseModel").prop(),e.stale=o("WAWebBaseModel").session(!0),e.eurlStale=o("WAWebBaseModel").session(!1),e.pendingPic=o("WAWebBaseModel").session(),e.timestamp=o("WAWebBaseModel").session(),e.hostRetryCount=o("WAWebBaseModel").session(0),e.lastHostUsed=o("WAWebBaseModel").session(),e.img=o("WAWebBaseModel").derived(function(){if(this.raw)return"data:image/jpeg;base64,"+this.raw;if(!this.tag&&this.stale)return null;if(this.tag)return this.previewDirectPath!=null?this.$ProfilePicThumbImpl$p_1(this.previewDirectPath,this.filehash):this.previewEurl},["tag","raw","stale","eurl","eurlStale","previewEurl","previewDirectPath","hostRetryCount"]),e.imgFull=o("WAWebBaseModel").derived(function(){if((this.raw||!this.tag)&&this.stale)return null;if(!this.raw&&this.tag)return this.fullDirectPath!=null?this.$ProfilePicThumbImpl$p_1(this.fullDirectPath,this.filehash):this.eurl},["tag","raw","stale","eurl","eurlStale","fullDirectPath","hostRetryCount"]),e.fallbackType=o("WAWebBaseModel").derived(function(){return r("WAWebWid").isUser(this.id)?c.SINGLE:(r("WAWebWid").isGroup(this.id),c.GROUP)},["id"]),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.markStale=function(t){this.stale=!0,(t==null?void 0:t.eurl)===!0&&(this.eurlStale=!0)},a.markMms4HostSuccess=function(){this.hostRetryCount=0},a.markMms4HostFailure=function(){this.hostRetryCount++,o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["increased mms4 retry count: ",""])),this.hostRetryCount).tags("mms4")},a.validate=function(){if(!(!this.stale&&!this.eurlStale))return this.getCollection().update(this.id)},a.canSet=function(){if(r("WAWebWid").isGroup(this.id)){var e,t=o("WAWebChatCollection").ChatCollection.get(this.id),n=t==null||(e=t.groupMetadata)==null?void 0:e.participants.iAmRestrictedMember();return!n}return!!o("WAWebUserPrefsMeUser").isMeAccount(this.id)},a.canDelete=function(){var e=!r("isStringNullOrEmpty")(this.tag);if(r("WAWebWid").isGroup(this.id)&&e){var t,n=o("WAWebChatCollection").ChatCollection.get(this.id),a=n==null||(t=n.groupMetadata)==null?void 0:t.participants.iAmRestrictedMember();return!a}return!!(o("WAWebUserPrefsMeUser").isMeAccount(this.id)&&e)},a.getCollection=function(){return o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection},a.$ProfilePicThumbImpl$p_1=function(t,n){var e=o("WAWebProfilePicConstants").DEFAULT_HOSTNAME;try{e=this.$ProfilePicThumbImpl$p_2(t,n).hostname}catch(e){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Failed to resolve mms4 hostname for profile-pic, falling back to static host. Error : ","."])),e).tags("mms4")}return o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Using mms4 download url for profile-pic with host name ","."])),e).tags("mms4"),"https://"+e+t},a.$ProfilePicThumbImpl$p_2=function(t,n){var e=o("WAWebMediaHosts").mediaHosts.getCachedHostsInfo({directPath:t,encFilehash:n,operation:o("WAWebMediaHostsRouteSelection").OPERATIONS.DOWNLOAD,type:o("WAWebMmsMediaTypes").MEDIA_TYPES.PPIC}),a=e.selectedHost,i=e.fallbackHost,l=r("WAWebMmsClientSelectHost")({selectedHost:a,fallbackHost:i,attemptCount:this.hostRetryCount,lastHostUsed:this.lastHostUsed,lastFetchMadeProgress:this.hostRetryCount===0});return this.lastHostUsed=l,l},n})(o("WAWebBaseModel").BaseModel);d.Proxy="profilePicThumb",d.idClass=r("WAWebWid");var m=o("WAWebBaseModel").defineModel(d);l.ProfilePicThumbImpl=d,l.ProfilePicThumb=m}),98);
__d("WAWebNewsletterQuestionResponseModel",["WAWebAck","WAWebAddOnModel","WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.parentMsgKey=o("WAWebBaseModel").prop(),t.t=o("WAWebBaseModel").prop(),t.body=o("WAWebBaseModel").prop(),t.id=o("WAWebBaseModel").prop(),t.responseServerId=o("WAWebBaseModel").prop(),t.questionServerId=o("WAWebBaseModel").prop(),t.senderNotifyName=o("WAWebBaseModel").prop(),t.replied=o("WAWebBaseModel").prop(!1),t.senderPictureDirectPath=o("WAWebBaseModel").prop(),t.isSentByMe=o("WAWebBaseModel").prop(!1),t.senderId=o("WAWebBaseModel").prop(),t.isSendFailure=o("WAWebBaseModel").prop(),t.isFailed=o("WAWebBaseModel").derived(function(){var e=this.isSentByMe&&this.ack!=null&&this.ack<o("WAWebAck").ACK.CLOCK;return e||!!this.isSendFailure},["ack","isSendFailure"]),t.links=o("WAWebBaseModel").session(function(){return[]}),t.linksIndexParsed=o("WAWebBaseModel").session(0),t.phoneNumbers=o("WAWebBaseModel").session(function(){return[]}),t.phoneNumbersIndexParsed=o("WAWebBaseModel").session(0),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebAddOnModel").AddOnBaseModel);e.Proxy="newsletterQuestionResponse";var s=o("WAWebBaseModel").defineModel(e);l.NewsletterQuestionResponse=s}),98);
__d("WAWebNewsletterQuestionResponseCollection",["WAWebBaseCollection","WAWebCollectionUtils","WAWebNewsletterQuestionResponseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.byParent=o("WAWebCollectionUtils").aggregated(function(e){return e.parentMsgKey}),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebNewsletterQuestionResponseModel").NewsletterQuestionResponse;var s=new e;l.QuestionResponseCollection=s}),98);
__d("WAWebQuickReplyEnum",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum")({TEXT:"text",ADDRESS_SMART_DEFAULT:"address_smart_default",HOURS_SMART_DEFAULT:"hours_smart_default",PROFILE_SMART_DEFAULT:"profile_smart_default",PIX_KEY_SMART_DEFAULT:"pix_key_smart_default"});i.QuickReplyTypes=e}),66);
__d("WAWebQuickReplyGetters",["WAWebGetters","WAWebGettersCaches","WAWebQuickReplyEnum"],(function(t,n,r,o,a,i,l){var e=o("WAWebGetters").createGetterFactories({createCache:o("WAWebGettersCaches").createQuickReplyCache}),s=e.field,u=e.computed,c=e.unsafeIdentityGetter,d=e.clearCacheFor,m=d,p=c,_=s("id"),f=s("count"),g=u(function(e){var t,n=e[0],r=(t=o("WAWebQuickReplyEnum").QuickReplyTypes.cast(n))!=null?t:o("WAWebQuickReplyEnum").QuickReplyTypes.TEXT;switch(r){case o("WAWebQuickReplyEnum").QuickReplyTypes.ADDRESS_SMART_DEFAULT:return o("WAWebQuickReplyEnum").QuickReplyTypes.ADDRESS_SMART_DEFAULT;case o("WAWebQuickReplyEnum").QuickReplyTypes.HOURS_SMART_DEFAULT:return o("WAWebQuickReplyEnum").QuickReplyTypes.HOURS_SMART_DEFAULT;case o("WAWebQuickReplyEnum").QuickReplyTypes.PROFILE_SMART_DEFAULT:return o("WAWebQuickReplyEnum").QuickReplyTypes.PROFILE_SMART_DEFAULT;case o("WAWebQuickReplyEnum").QuickReplyTypes.PIX_KEY_SMART_DEFAULT:return o("WAWebQuickReplyEnum").QuickReplyTypes.PIX_KEY_SMART_DEFAULT;default:return o("WAWebQuickReplyEnum").QuickReplyTypes.TEXT}},[_]);l.clearQuickReplyGetterCacheFor=m,l.getQuickReplyUnsafe=p,l.getCount=f,l.getType=g}),98);
__d("WAWebFrontendQuickReplyGetters",["WAWebGetters","WAWebGettersCaches","WAWebQuickReplyGetters"],(function(t,n,r,o,a,i,l){var e=o("WAWebGetters").createGetterFactories({root:o("WAWebQuickReplyGetters").getQuickReplyUnsafe,createCache:o("WAWebGettersCaches").createFrontendQuickReplyCache}),s=e.field,u=e.computed,c=e.clearCacheFor,d=c,m=s("pendingCount"),p=u(function(e){var t=e[0],n=e[1];return t+n},[o("WAWebQuickReplyGetters").getCount,m]);l.clearFrontendQuickReplyGetterCacheFor=d,l.getTotalCount=p}),98);
__d("WAWebBizQuickReplyBridge",["Promise","WAWebSchemaQuickReply"],(function(t,n,r,o,a,i,l){var e;function s(t){var r=(e||(e=n("Promise"))).resolve(),a=t.id,i=t.shortcut,l=t.count,s=t.message,u=t.keywords,c={id:a,shortcut:i,count:l,message:s,keywords:u};return r=o("WAWebSchemaQuickReply").getQuickReplyTable().createOrReplace(c),r}l.updateQuickReply=s}),98);
__d("WAWebPaymentsChat",["WAWebL10NCountryCodes","WAWebLidMigrationUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){var n=o("WAWebLidMigrationUtils").toPn(e),r=o("WAWebL10NCountryCodes").getCountryShortcodeByPhone(n==null?void 0:n.user);return r===t}l.doesUserHaveCountryPhoneNumber=e}),98);
__d("WAWebPaymentsConstants",[],(function(t,n,r,o,a,i){var e="BR";i.BRAZIL_COUNTRY_CODE=e}),66);
__d("WAWebUserPrefsCustomPaymentMethods",["WALogger","WAWebUserPrefsKeys","WAWebUserPrefsLocalStorage","WAWebUserPrefsTypes"],(function(t,n,r,o,a,i,l){var e,s,u,c,d;function m(e){return e!=null&&h(e.display_name)&&h(e.credentialId)&&h(e.key)&&h(e.key_type)&&o("WAWebUserPrefsTypes").PixKeyType.cast(e.key_type)!=null&&h(e.country)}function p(){var e,t=(e=_())==null?void 0:e.pix;return m(t)&&t?t:null}function _(){var e=r("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(o("WAWebUserPrefsKeys").KEYS.CUSTOM_PAYMENT_METHODS);return e}function f(t){var n={},a=p();t.forEach(function(t){var r=o("WAWebUserPrefsTypes").WACustomPaymentMethodType.cast(t.type);if(r==null){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["invalid custom payment method type: ",""])),t.type).sendLogs("monitor-errors");return}switch(r){case o("WAWebUserPrefsTypes").WACustomPaymentMethodType.PIX_KEY:{var i,l,m,p,_,f=(i=t.metadata.filter(function(e){return e.key==="pix_key"}))==null||(i=i.at(0))==null?void 0:i.value;if(f==null){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["pix_key is null"]))).sendLogs("monitor-errors");return}var g=(l=t.metadata.filter(function(e){return e.key==="pix_key_type"}))==null||(l=l.at(0))==null?void 0:l.value;if(g==null){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["pix_key_type is null"]))).sendLogs("monitor-errors");return}var h=o("WAWebUserPrefsTypes").PixKeyType.cast(g.toUpperCase());if(h==null){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["pix_key_type is invalid"]))).sendLogs("monitor-errors");return}var y=(m=t.metadata.filter(function(e){return e.key==="pix_display_name"}))==null||(m=m.at(0))==null?void 0:m.value;if(y==null){o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["pix_display_name is null"]))).sendLogs("monitor-errors");return}var C=(p=a==null?void 0:a.time_added)!=null?p:Date.now(),b=(_=a==null?void 0:a.time_last_used)!=null?_:null,v={credentialId:t.credentialId,key:f,key_type:h,display_name:y,country:t.country,time_added:C,time_last_used:b};n.pix=v;break}}}),r("WAWebUserPrefsLocalStorage").setItemToLocalStorage(o("WAWebUserPrefsKeys").KEYS.CUSTOM_PAYMENT_METHODS,n)}function g(){var e,t=(e=_())==null?void 0:e.pix;return m(t)}function h(e,t){return t===void 0&&(t=!1),t&&e==null?!0:typeof e=="string"&&e.trim().length>0}l.getPIX=p,l.isPIXValid=g,l.isStringFieldValid=h,l.setCustomPaymentMethods=f}),98);
__d("WAWebPixQuickReplyFeature",["WAWebABProps","WAWebGetMessageChatTypeFromWid","WAWebPaymentsChat","WAWebPaymentsConstants","WAWebUserPrefsCustomPaymentMethods","WAWebWamEnumMessageChatType"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebABProps").getABPropConfigValue("payments_br_pix_quick_reply_enabled")}function s(){return o("WAWebABProps").getABPropConfigValue("br_payments_pix_groups_enabled")}function u(e){return o("WAWebUserPrefsCustomPaymentMethods").isPIXValid()&&d(e.groupMetadata)&&s()}function c(t){return e()&&u(t)}function d(e){if(e==null)return!1;var t=e.participants;return t.every(function(e){return o("WAWebPaymentsChat").doesUserHaveCountryPhoneNumber(e.id,o("WAWebPaymentsConstants").BRAZIL_COUNTRY_CODE)})}function m(t){if(!e()||t==null)return!1;var n=o("WAWebGetMessageChatTypeFromWid").getMessageChatTypeFromWid(t.id);switch(n){case o("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE.INDIVIDUAL:return o("WAWebPaymentsChat").doesUserHaveCountryPhoneNumber(t.id,o("WAWebPaymentsConstants").BRAZIL_COUNTRY_CODE);case o("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE.GROUP:return u(t);default:return!1}}l.showPixQuickReplyInAttachmentTrayForGroups=c,l.shouldShowPixQuickReplyForChat=m}),98);
__d("WAWebQuickReplyModel",["WAWebBaseModel","WAWebBizQuickReplyBridge","WAWebFrontendQuickReplyGetters","WAWebPixQuickReplyFeature","WAWebQuickReplyEnum","WAWebQuickReplyGetters"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.shortcut=o("WAWebBaseModel").prop(),t.message=o("WAWebBaseModel").prop(),t.count=o("WAWebBaseModel").prop(),t.keywords=o("WAWebBaseModel").prop(),t.pendingCount=o("WAWebBaseModel").session(0),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.useOnce=function(){this.isSmartDefault()?(this.count+=1,o("WAWebBizQuickReplyBridge").updateQuickReply(this)):this.pendingCount+=1},n.isSmartDefault=function(){switch(o("WAWebQuickReplyGetters").getType(this)){case o("WAWebQuickReplyEnum").QuickReplyTypes.PROFILE_SMART_DEFAULT:case o("WAWebQuickReplyEnum").QuickReplyTypes.HOURS_SMART_DEFAULT:case o("WAWebQuickReplyEnum").QuickReplyTypes.ADDRESS_SMART_DEFAULT:case o("WAWebQuickReplyEnum").QuickReplyTypes.PIX_KEY_SMART_DEFAULT:return!0;default:return!1}},n.hideForChat=function(t){switch(o("WAWebQuickReplyGetters").getType(this)){case o("WAWebQuickReplyEnum").QuickReplyTypes.PIX_KEY_SMART_DEFAULT:return!o("WAWebPixQuickReplyFeature").shouldShowPixQuickReplyForChat(t);default:return!1}},n.delete=function(){e.prototype.delete.call(this),o("WAWebQuickReplyGetters").clearQuickReplyGetterCacheFor(this),o("WAWebFrontendQuickReplyGetters").clearFrontendQuickReplyGetterCacheFor(this)},t})(o("WAWebBaseModel").BaseModel);e.Proxy="quickReply";var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebQuickReplyCollection",["WAWebBaseCollection","WAWebFrontendQuickReplyGetters","WAWebQuickReplyModel","WAWebQuickReplySmartDefaults"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.smartDefaultsAdded=!1,t.sortQuickReply=function(e,t){var n=o("WAWebFrontendQuickReplyGetters").getTotalCount(e),r=o("WAWebFrontendQuickReplyGetters").getTotalCount(t);return n===r?e.id<t.id?-1:1:n>r?-1:1},babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.addSmartDefaultsIfNeeded=function(){this.smartDefaultsAdded===!1&&(o("WAWebQuickReplySmartDefaults").addSmartDefaults(),this.smartDefaultsAdded=!0)},n.filterShortcuts=function(t){var e=this.filter(function(e){var n=e.shortcut;return n.toLowerCase().startsWith(t.toLowerCase())});return e.sort(this.sortQuickReply)},t})(o("WAWebBaseCollection").BaseCollection);e.model=r("WAWebQuickReplyModel");var s=new e;l.QuickReplyCollection=s}),98);
__d("WAWebBizFrontendGatingUtils",["WAWebABProps","WAWebMobilePlatforms","WAWebPrimaryFeaturesModel"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebMobilePlatforms").isSMB()&&o("WAWebPrimaryFeaturesModel").PrimaryFeatures.paymentInfoSyncSupport&&o("WAWebABProps").getABPropConfigValue("order_details_payment_instructions_sync_enabled")}function s(){return o("WAWebMobilePlatforms").isSMB()&&o("WAWebPrimaryFeaturesModel").PrimaryFeatures.customPaymentMethodsSyncSupport&&o("WAWebABProps").getABPropConfigValue("payments_br_pix_phase_1_seller_sync_enabled")}function u(){return o("WAWebMobilePlatforms").isSMB()&&o("WAWebPrimaryFeaturesModel").PrimaryFeatures.customPaymentMethodsSyncSupport&&o("WAWebABProps").getABPropConfigValue("payments_br_pix_quick_reply_enabled")}function c(){return o("WAWebMobilePlatforms").isSMB()&&o("WAWebABProps").getABPropConfigValue("payments_br_force_copy_pix_cta_enabled")}function d(){return o("WAWebABProps").getABPropConfigValue("payments_br_copy_pix_code_api_merchant_enabled")}function m(){return o("WAWebMobilePlatforms").isSMB()&&o("WAWebPrimaryFeaturesModel").PrimaryFeatures.customPaymentMethodsSyncSupport&&o("WAWebABProps").getABPropConfigValue("payments_br_pix_on_web")}l.isOrderDetailsPaymentInstructionsSyncEnabled=e,l.isCustomPaymentMethodsSyncEnabled=s,l.isPixInQuickReplyEnabled=u,l.isForceCopyPixCTAEnabled=c,l.isAPICopyPixCTAEnabled=d,l.isPixOnWebEnabled=m}),98);
__d("WAWebBrazilPixKeyFormattingUtils",["fbt","WAWebUserPrefsTypes"],(function(t,n,r,o,a,i,l,s){"use strict";var e=/^(\d{3})(\d{3})(\d{3})(\d{2})$/g,u="$1.$2.$3-$4",c=/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/g,d="$1.$2.$3/$4-$5",m=/^(\+\d{2})(\d{2})(\d{4,5})(\d{4})$/g,p="$2 $3-$4";function _(e,t){if(t==null)return e;switch(t){case o("WAWebUserPrefsTypes").PixKeyType.CPF:return h(e);case o("WAWebUserPrefsTypes").PixKeyType.CNPJ:return y(e);case o("WAWebUserPrefsTypes").PixKeyType.PHONE:return C(e);case o("WAWebUserPrefsTypes").PixKeyType.EMAIL:case o("WAWebUserPrefsTypes").PixKeyType.EVP:return e}}function f(e,t){if(t==null)return e;switch(t){case o("WAWebUserPrefsTypes").PixKeyType.PHONE:return e.substr(3);default:return e}}function g(e){var t,n=(t=o("WAWebUserPrefsTypes").PixKeyType.cast(e))!=null?t:o("WAWebUserPrefsTypes").PixKeyType.PHONE;switch(n){case o("WAWebUserPrefsTypes").PixKeyType.CPF:return s._(/*BTDS*/"CPF");case o("WAWebUserPrefsTypes").PixKeyType.CNPJ:return s._(/*BTDS*/"CNPJ");case o("WAWebUserPrefsTypes").PixKeyType.PHONE:return s._(/*BTDS*/"Tel\u00e9fono");case o("WAWebUserPrefsTypes").PixKeyType.EMAIL:return s._(/*BTDS*/"Correo electr\u00f3nico");case o("WAWebUserPrefsTypes").PixKeyType.EVP:return s._(/*BTDS*/"EVP")}}function h(t){return t.replace(e,u)}function y(e){return e.replace(c,d)}function C(e){return e.replace(m,p)}l.getFormattedPixKey=_,l.getCopiedPixKey=f,l.getPixKeyTypeLabel=g}),226);
__d("WAWebQuickReplySmartDefaults",["fbt","WAWebBizFrontendGatingUtils","WAWebBrazilPixKeyFormattingUtils","WAWebBusinessProfileCollection","WAWebBusinessProfileUtils","WAWebContactCollection","WAWebFrontendContactGetters","WAWebQuickReplyCollection","WAWebQuickReplyEnum","WAWebQuickReplyModel","WAWebUserPrefsCustomPaymentMethods","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l,s){function e(){f(),u(),c(),d()}function u(){var e=o("WAWebQuickReplyEnum").QuickReplyTypes.PROFILE_SMART_DEFAULT,t=p();o("WAWebQuickReplyCollection").QuickReplyCollection.get(e)?t&&o("WAWebQuickReplyCollection").QuickReplyCollection.add({id:e,message:t.message},{merge:!0}):t&&o("WAWebQuickReplyCollection").QuickReplyCollection.add(t,{merge:!0})}function c(){var e=o("WAWebQuickReplyEnum").QuickReplyTypes.ADDRESS_SMART_DEFAULT,t=_();o("WAWebQuickReplyCollection").QuickReplyCollection.get(e)?t&&o("WAWebQuickReplyCollection").QuickReplyCollection.add({id:e,message:t.message},{merge:!0}):t&&o("WAWebQuickReplyCollection").QuickReplyCollection.add(t,{merge:!0})}function d(){var e=o("WAWebQuickReplyEnum").QuickReplyTypes.HOURS_SMART_DEFAULT,t=m();o("WAWebQuickReplyCollection").QuickReplyCollection.get(e)?t&&o("WAWebQuickReplyCollection").QuickReplyCollection.add({id:e,message:t.message},{merge:!0}):t&&o("WAWebQuickReplyCollection").QuickReplyCollection.add(t,{merge:!0})}function m(){var e,t=o("WAWebUserPrefsMeUser").getMaybeMePnUser();if(t!=null){var n=o("WAWebBusinessProfileCollection").BusinessProfileCollection.get(t);if(n!=null&&(e=n.businessHours)!=null&&e.config){var a=o("WAWebQuickReplyEnum").QuickReplyTypes.HOURS_SMART_DEFAULT,i=o("WAWebBusinessProfileUtils").quickReplyHoursStr(n.businessHours);return new(r("WAWebQuickReplyModel"))({id:a,shortcut:s._(/*BTDS*/"horario").toString(),message:i,count:-1,keywords:[]})}}}function p(){var e=o("WAWebContactCollection").ContactCollection.getMeContact();if(e){var t=o("WAWebQuickReplyEnum").QuickReplyTypes.PROFILE_SMART_DEFAULT;return new(r("WAWebQuickReplyModel"))({id:t,shortcut:s._(/*BTDS*/"perfil").toString(),message:o("WAWebFrontendContactGetters").getDisplayName(e),count:-1,keywords:[]})}}function _(){var e=o("WAWebUserPrefsMeUser").getMaybeMePnUser();if(e!=null){var t=o("WAWebBusinessProfileCollection").BusinessProfileCollection.get(e);if((t==null?void 0:t.latitude)!=null||(t==null?void 0:t.longitude)!=null||(t==null?void 0:t.address)!=null){var n=o("WAWebQuickReplyEnum").QuickReplyTypes.ADDRESS_SMART_DEFAULT,a=t.address||s._(/*BTDS*/"Ubicaci\u00f3n en el mapa"),i="\uD83D\uDCCD";return new(r("WAWebQuickReplyModel"))({id:n,shortcut:s._(/*BTDS*/"direcci\u00f3n").toString(),message:s._(/*BTDS*/"{pinEmoji} {address}",[s._param("pinEmoji",i),s._param("address",a)]).toString(),count:-1,keywords:[]})}}}function f(){var e=o("WAWebQuickReplyEnum").QuickReplyTypes.PIX_KEY_SMART_DEFAULT,t=g();o("WAWebQuickReplyCollection").QuickReplyCollection.get(e)?t?o("WAWebQuickReplyCollection").QuickReplyCollection.add({id:e,message:t.message},{merge:!0}):o("WAWebQuickReplyCollection").QuickReplyCollection.remove(e):t&&o("WAWebQuickReplyCollection").QuickReplyCollection.add(t,{merge:!0})}function g(){if(o("WAWebBizFrontendGatingUtils").isPixInQuickReplyEnabled()){var e=o("WAWebUserPrefsCustomPaymentMethods").getPIX();if(e){var t=o("WAWebQuickReplyEnum").QuickReplyTypes.PIX_KEY_SMART_DEFAULT;return new(r("WAWebQuickReplyModel"))({id:t,shortcut:s._(/*BTDS*/"Pix").toString(),message:o("WAWebBrazilPixKeyFormattingUtils").getFormattedPixKey(e.key,e.key_type),count:-1,keywords:[]})}}}l.addSmartDefaults=e,l.getOrUpdatePixKeySmartDefault=f}),226);
__d("WAWebReactionsMsgAction",["WAAbortError","WAJobOrchestratorTypes","WALogger","WAWebAck","WAWebAddOnsUpdateSendStatesAction","WAWebAddonGatingUtils","WAWebDBCreateOrUpdateReactions","WAWebLidMigrationUtils","WAWebMaybe","WAWebMessageAddOnType","WAWebMsgCollection","WAWebMsgModel","WAWebMsgReactionsBridge","WAWebNotificationBackend","WAWebOrchestratorNonPersistedJob","WAWebReactionDataUtils","WAWebReactionGatingUtils","WAWebReactionNotificationUtils","WAWebReactionsBEUtils","WAWebReactionsCollection","WAWebReactionsMsgActionUtils","WAWebSendAddonMsgChatAction","WAWebSendMsgRecordAction","WAWebSendMsgResultAction","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e=["senderUserJid"],s,u,c,d,m,p;function _(e,t){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=t.allowNotify,r=e.parentMsgKey,a=o("WAWebReactionDataUtils").reactionRowToReactionMsgData(e),i=!!n&&!o("WAWebReactionNotificationUtils").nonHydratedShouldMuteReactionNotification(a),l;if(i?l=yield o("WAWebReactionsCollection").ReactionsCollection.find(r):l=o("WAWebReactionsCollection").ReactionsCollection.getAddressingModeInsensitive(r),l){o("WAWebReactionsCollection").ReactionsCollection.addOrUpdateReaction(e);var s=l.reactions.length>0;yield o("WAWebMsgReactionsBridge").updateHasReactionInParent(r,s)}else e.reactionText!==o("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT&&(yield o("WAWebMsgReactionsBridge").updateHasReactionInParent(r,!0)),o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["actions:addOrUpdateReactions Reaction Model does not exist for this parentMsg"])));i&&!o("WAWebReactionGatingUtils").isReactionNotificationAddOnApiEnabled()&&(o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["actions:addOrUpdateReactions Notify for this reaction"]))),o("WAWebNotificationBackend").showReactionNotification(a))}),f.apply(this,arguments)}function g(e,t){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WAWebDBCreateOrUpdateReactions").createOrUpdateReactions([e]),r=n[0];if(!r){o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["actions:addOrUpdateReactions reaction was not added or updated in the DB"])));return}return _(r,{allowNotify:t}),r}),h.apply(this,arguments)}function y(e){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n,r=t.senderUserJid,a=babelHelpers.objectWithoutPropertiesLoose(t,e),i=(n=o("WAWebReactionsCollection").ReactionsCollection.getExistingSenderModelFromReactionDetails(a))!=null?n:o("WAWebMaybe").ifSome(o("WAWebLidMigrationUtils").getAlternateMsgKey(a.msgKey),function(e){return o("WAWebReactionsCollection").ReactionsCollection.getExistingSenderModelFromReactionDetails(babelHelpers.extends({},a,{msgKey:e}))});if(i==null){o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["WAWebReactionsUtils:resendUpdateFailedPropsForSentReactionsDBAndModel Reactions model not found for this message id"])));return}yield b(t,i.timestamp)}),C.apply(this,arguments)}function b(e,t){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var a=o("WAWebMsgCollection").MsgCollection.get(e.parentMsgKey),i=e.parentMsgKey,l=e.msgKey;if(a){var s=i.remote,u=o("WAWebReactionsMsgActionUtils").getFromForReactionMessage(a),c=yield o("WAWebReactionsMsgActionUtils").getReactionMsgData(a,e.reactionText,u,l,Math.floor(t/1e3),s,t);if(o("WAWebAddonGatingUtils").isUnifiedInfraEnabled(c)){var d=yield o("WAWebSendAddonMsgChatAction").addAndSendAddonToChat(c);if(d.messageSendResult!==o("WAWebSendMsgResultAction").SendMsgResult.OK)throw r("err")("Reaction send error");return}var m=new(o("WAWebMsgModel")).Msg(c);return yield o("WAWebAddOnsUpdateSendStatesAction").updateAddOnSendStatesAction(new Map([[o("WAWebMessageAddOnType").MessageAddOnType.Reaction,[{msgKey:e.msgKey.toString(),ack:o("WAWebAck").ACK.CLOCK,isSendFailure:!1}]]])),o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendMessage",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebSendMsgRecordAction").sendMsgRecord(m)}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}}),v.apply(this,arguments)}function S(e){for(var t of e){var n=!o("WAWebReactionNotificationUtils").nonHydratedShouldMuteReactionNotification(t);n&&(o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["actions:handleReactionNotification Notify for this reaction"]))).devConsole(t),o("WAWebNotificationBackend").showReactionNotification(t).catch(o("WAAbortError").catchAbort(function(e){o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["actions:handleReactionNotification - notification aborted ",""])),e)})))}}l.addOrUpdateReactionsModelCollection=_,l.addOrUpdateReactions=g,l.resendUpdateFailedPropsForSentReactionsDBAndModel=y,l.handleReactionNotification=S}),98);
__d("WAWebReactionsMsgActionUtils",["WALogger","WANullthrows","WAWebAck","WAWebAddonEncryption","WAWebFrontendMsgGetters","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebReferentialMsgKey","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e){var t,n=!!((t=o("WAWebFrontendMsgGetters").getChat(e).groupMetadata)!=null&&t.isCag),r=o("WAWebUserPrefsMeUser").getMeLidUserOrThrow();return n?r:o("WAWebUserPrefsMeUser").getMePnUserOrThrow()}function c(e,t,n,r,o,a,i){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a,i,l,u,c){var d,m=o("WAWebMsgKeyUtils").msgKeyToTargetInfo(i,o("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon);if(a.equals(m.from)||o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["create reaction: "," and "," do not match"])),a.toLogString(),m.from.toLogString()).tags("messaging").sendLogs("reactionMsgData: from is not matching",{sampling:.01}),u.equals(m.to)||o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["create reaction: "," and "," do not match"])),u.toLogString(),m.to.toLogString()).tags("messaging").sendLogs("reactionMsgData: to is not matching",{sampling:.01}),(d=o("WAWebFrontendMsgGetters").getChat(t).groupMetadata)!=null&&d.isCag){var p=self.crypto.getRandomValues(new Uint8Array(12)),_={type:o("WAWebMsgType").MsgKind.ReactionDecrypted,encode:{text:n,senderTimestampMs:c}},f=yield o("WAWebAddonEncryption").encryptAddOn(_,{messageSecret:r("WANullthrows")(t.messageSecret,"Parent message missing message secret"),iv:p,stanzaId:t.id.id,originalMessageSender:o("WAWebMsgGetters").getOriginalSender(t.unsafe()),addOnSender:o("WAWebWidFactory").asUserWidOrThrow(a)}),g=f.encPayload;return{id:i,type:o("WAWebMsgType").MSG_TYPE.REACTION_ENC,kind:o("WAWebMsgType").MsgKind.ReactionEncrypted,viewMode:o("WAWebViewMode.flow").ViewModeType.VISIBLE,t:l,from:a,to:u,author:m.author,ack:o("WAWebAck").ACK.CLOCK,targetMessageKey:o("WAWebReferentialMsgKey").getReferentialMsgKey(t),encPayload:g,encIv:p.buffer}}return{id:i,reactionParentKey:o("WAWebReferentialMsgKey").getReferentialMsgKey(t),type:o("WAWebMsgType").MSG_TYPE.REACTION,viewMode:o("WAWebViewMode.flow").ViewModeType.VISIBLE,kind:o("WAWebMsgType").MsgKind.ReactionDecrypted,t:l,from:a,to:u,author:m.author,ack:o("WAWebAck").ACK.CLOCK,reactionText:n,reactionTimestamp:c,read:!0}}),d.apply(this,arguments)}l.getFromForReactionMessage=u,l.getReactionMsgData=c}),98);
__d("WAWebNotificationsBaseReactionNotification",["WALogger","WANullthrows","WAWebBaseNotification","WAWebConstantsDeprecated","WAWebEnvironment","WAWebFrontendMsgGetters","WAWebMsgCollection","WAWebNotificationController","WAWebNotificationHelpers","WAWebNotificationMuteReason","WAWebReactionNotificationUtils","WAWebReactionsCollection","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=(function(t){function a(n){var a,i=n.reactionMsg;a=t.call(this)||this,a.$WABaseReactionNotification$p_1=function(){o("WAWebFrontendMsgGetters").getChat(a.parentMsg)!=null&&a.parentMsg!=null&&o("WAWebFrontendMsgGetters").getChat(a.parentMsg).reactionSquelch===r("WAWebConstantsDeprecated").SQUELCH_RESET_VALUE&&(a.parentMsg.squelch=r("WAWebConstantsDeprecated").SQUELCH_RESET_VALUE)},o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["WAReactionNotification: constructor"]))).devConsole({reactionMsg:i}),a.reactionMsg=i;var l=o("WAWebMsgCollection").MsgCollection.get(r("WANullthrows")(a.reactionMsg.reactionParentKey).toString());return l==null?(o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["WAReactionNotification: parentMsg is not present in the MsgCollection. It may need to be hydrated."]))).devConsole(a),babelHelpers.assertThisInitialized(a)):(a.parentMsg=l,a)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.beforeBannerShown=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(this.parentMsg!=null){var e=yield o("WAWebReactionsCollection").ReactionsCollection.findAddressingModeInsensitive(this.parentMsg.id.toString());if(e){var t=o("WAWebReactionsCollection").ReactionsCollection.getAggregateEmojiAndSender(e,o("WAWebReactionNotificationUtils").getReactionSenderJid(this.reactionMsg).toString()),n=t.reactionSenderModel;this.reactionSender=n}else o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["WAReactionNotification: Reaction model not found"])))}});function t(){return e.apply(this,arguments)}return t})(),i.afterBannerShown=function(t){var e=this;if(this.reactionSender!=null){var n=this.reactionSender,r=o("WAWebFrontendMsgGetters").getMaybeChat(this.parentMsg);n.on("revoked change:read",this.closeBanner),r==null||r.on("change:reactionSquelch",this.$WABaseReactionNotification$p_1),t.waitForClose().then(function(){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["WAReactionNotification: cleaning up reaction notification"]))),n.off("revoked change:read",e.closeBanner),r==null||r.off("change:reactionSquelch",e.$WABaseReactionNotification$p_1)})}},i.shouldMute=function(t){if(r("WAWebEnvironment").isWindows&&this.reactionMsg.viewed===!0)return r("WAWebNotificationMuteReason").IgnoreViewedMsgs;if(o("WAWebReactionNotificationUtils").nonHydratedShouldMuteReactionNotification(this.reactionMsg))return r("WAWebNotificationMuteReason").NonHydratedReaction;if(this.parentMsg==null)return r("WAWebNotificationMuteReason").ParentMsgMissing;if(this.shouldMuteDueToAppState(t))return r("WAWebNotificationMuteReason").AppState},i.shouldPlaySound=function(){if(!t.prototype.shouldPlaySound.call(this))return!1;var e=o("WAWebFrontendMsgGetters").getChat(this.reactionMsg);return o("WAWebNotificationHelpers").shouldPlaySoundGranular(e)},i.shouldShowBanner=function(){return t.prototype.shouldShowBanner.call(this)?o("WAWebReactionNotificationUtils").shouldEnableReactionsNotificationGranular(this.reactionMsg):!1},i.shouldSquelch=function(){var e=o("WAWebNotificationController").WANotificationController.notificationExists(this.buildKey());if(e)return null},i.buildKey=function(){return"reaction:"+this.parentMsg.id.toString()+"-"+o("WAWebReactionNotificationUtils").getReactionSenderJid(this.reactionMsg).toString()},i.shouldMuteDueToAppState=function(t){return o("WAWebNotificationHelpers").shouldMuteDueToAppState(t)},a})(o("WAWebBaseNotification").WABaseNotification);l.WABaseReactionNotification=d}),98);
__d("WAWebNotificationsReactionNotification",["WAWebFrontendChatGetters","WAWebFrontendMsgGetters","WAWebGetNotificationStrings","WAWebMuteGetters","WAWebNoop","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebNotificationMuteReason","WAWebNotificationsBaseReactionNotification","WAWebReactionNotificationUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a.shouldMute=function(n){var t=e.prototype.shouldMute.call(this,n);if(t!=null)return t;var a=o("WAWebFrontendMsgGetters").getChat(this.parentMsg);return o("WAWebMuteGetters").getIsMuted(a.mute)?r("WAWebNotificationMuteReason").MutedChat:o("WAWebReactionNotificationUtils").isArchivedChat(a)?r("WAWebNotificationMuteReason").ArchivedChat:null},a.shouldSquelch=function(){if(e.prototype.shouldSquelch.call(this)==null)return null;var t=o("WAWebFrontendMsgGetters").getChat(this.parentMsg);return o("WAWebNotificationHelpers").shouldSquelch(t,!1)?r("WAWebNotificationMuteReason").GroupFlood:o("WAWebReactionNotificationUtils").shouldSquelchReactionMessage(t,this.parentMsg)?r("WAWebNotificationMuteReason").ReactionFlood:null},a.matchesChat=function(t){return o("WAWebFrontendMsgGetters").getChat(this.parentMsg).equals(t)},a.getChatKind=function(){return o("WAWebFrontendChatGetters").getKind(o("WAWebFrontendMsgGetters").getChat(this.parentMsg))},a.getIcon=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("WAWebFrontendMsgGetters").getChat(this.parentMsg);return o("WAWebNotificationIconUtils").getChatNotificationIcon(e,this.abortController.signal)});function t(){return e.apply(this,arguments)}return t})(),a.getBannerOptions=function(){var e=this.parentMsg,t=o("WAWebFrontendMsgGetters").getChat(e),n=o("WAWebReactionNotificationUtils").getNotificationPartsForChatReaction(e,this.reactionMsg),a=n.action,i=n.author,l=n.body,s=o("WAWebGetNotificationStrings").getNotificationBody({action:a,author:i,body:l,msgDir:o("WAWebFrontendMsgGetters").getDir(e)});return{wid:t.id,msgId:e.id.toString(),onClick:r("WAWebNoop"),tag:e.id.toString(),doNotOpenChat:!1,title:o("WAWebNotificationHelpers").getNotificationTitle(t),body:s}},t})(o("WAWebNotificationsBaseReactionNotification").WABaseReactionNotification);l.WAReactionNotification=e}),98);
__d("WAWebNotificationsStatusReactionNotification",["WANullthrows","WAWebABProps","WAWebEnvironment","WAWebFrontendMsgGetters","WAWebGetNotificationStrings","WAWebMuteCollection","WAWebNotificationIconUtils","WAWebNotificationMuteReason","WAWebNotificationsBaseReactionNotification","WAWebReactionNotificationUtils","WAWebStatusNotificationUtils","asyncToGeneratorRuntime","cr:7293"],(function(t,n,r,o,a,i,l){var e,s=(e=n("cr:7293"))!=null?e:{},u=s.getStatusReactionsSetting,c=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a.shouldMute=function(n){var t=e.prototype.shouldMute.call(this,n);return t!=null?t:(u==null?void 0:u())===!1?r("WAWebNotificationMuteReason").MutedStatusReaction:null},a.shouldPlaySound=function(){if(!e.prototype.shouldPlaySound.call(this))return!1;var t=o("WAWebABProps").getABPropConfigValue("wa_web_enable_granular_notifications");return t?o("WAWebMuteCollection").MuteCollection.getGlobalStatusSoundsEnabled():e.prototype.shouldPlaySound.call(this)},a.shouldShowBanner=function(){if(!e.prototype.shouldShowBanner.call(this))return!1;var t=o("WAWebABProps").getABPropConfigValue("wa_web_enable_granular_notifications");return t?o("WAWebMuteCollection").MuteCollection.getGlobalStatusNotificationReactionsEnabled():e.prototype.shouldShowBanner.call(this)},a.matchesChat=function(t){return t.id.isStatus()},a.getChatKind=function(){return null},a.getIcon=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebNotificationIconUtils").getNotificationIconByWid(o("WAWebReactionNotificationUtils").getReactionSenderJid(this.reactionMsg),this.abortController.signal,o("WAWebNotificationIconUtils").USER_DEFAULT_ICON)});function t(){return e.apply(this,arguments)}return t})(),a.getBannerOptions=function(){var e=this.parentMsg,t=o("WAWebReactionNotificationUtils").getNotificationPartsForStatusReaction(e,this.reactionMsg),n=t.action,a=t.author,i=t.body,l=o("WAWebGetNotificationStrings").getNotificationBody({action:n,body:i,msgDir:o("WAWebFrontendMsgGetters").getDir(e)}),s=function(){o("WAWebStatusNotificationUtils").openStatusViewer(e)};return{wid:e.id.remote,msgId:e.id.toString(),onClick:s,tag:e.id.toString(),doNotOpenChat:!0,title:r("WANullthrows")(a),body:l}},a.shouldMuteDueToAppState=function(n){return r("WAWebEnvironment").isWindows?!1:e.prototype.shouldMuteDueToAppState.call(this,n)},t})(o("WAWebNotificationsBaseReactionNotification").WABaseReactionNotification);l.WAStatusReactionNotification=c}),98);
__d("WAWebChatContactUtils",["fbt"],(function(t,n,r,o,a,i,l,s){function e(e,t){return t===void 0&&(t=!0),e==null||e===""?"":"~"+(t?"\u202F":"")+e}function u(e){return e==null||e===""?"":s._(/*BTDS*/"Quiz\u00e1 {notifyName}",[s._param("notifyName",e)])}l.getFormattedNotifyName=e,l.getAccessibleNotifyName=u}),226);
__d("WAWebReactionNotificationUtils",["fbt","WANullthrows","WAWebABProps","WAWebChatContactUtils","WAWebChatGetters","WAWebConstantsDeprecated","WAWebContactCollection","WAWebContactGetters","WAWebElevatedPushNamesFlag","WAWebEmoji","WAWebFrontendMsgGetters","WAWebGetNotificationStrings","WAWebGroupMetadataCollection","WAWebMsgGetters","WAWebMsgType","WAWebMuteCollection","WAWebMuteGetters","WAWebNotificationHelpers","WAWebReactionsBEUtils","WAWebSettingsGetters","WAWebSettingsModel","WAWebUserPrefsMeUser","WAWebWidFactory","WAWebWidFormat"],(function(t,n,r,o,a,i,l,s){function e(e){return o("WAWebWidFactory").asUserWidOrThrow(r("WANullthrows")(o("WAWebMsgGetters").getSender(e)))}function u(t){var n=t.read,r=t.reactionText,a=e(t).toString();return!!(n===!0||o("WAWebUserPrefsMeUser").isSerializedWidMe(a)||!t.reactionParentKey.fromMe||r===o("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT||o("WAWebNotificationHelpers").isOfflineResumeInProgress())}function c(e){var t=o("WAWebABProps").getABPropConfigValue("wa_web_enable_granular_notifications");if(t){var n=o("WAWebFrontendMsgGetters").getChat(e),r=o("WAWebChatGetters").getIsGroup(n);return r?o("WAWebMuteCollection").MuteCollection.getGlobalGroupNotificationReactionsEnabled():o("WAWebMuteCollection").MuteCollection.getGlobalNotificationReactionsEnabled()}return!o("WAWebMuteGetters").getIsMuted(o("WAWebMuteCollection").MuteCollection.globalReactionsMute())}function d(e,t){if(!o("WAWebChatGetters").getIsGroup(e))return!1;var n=Date.now(),a=t.squelch||0;return n>a?(r("WAWebGroupMetadataCollection").find(e.id).then(function(n){if(n!=null){var a=o("WAWebNotificationHelpers")._calculateTimeoutFromGroupMetadata(e.id,n),i=Date.now()+a;t.squelch=i,e.reactionSquelch===r("WAWebConstantsDeprecated").SQUELCH_RESET_VALUE&&(e.reactionSquelch=i)}}),!1):!0}function m(t,n){var r,a=e(n),i=o("WAWebContactCollection").ContactCollection.gadd(a),l=o("WAWebFrontendMsgGetters").getChat(t),s=o("WAWebElevatedPushNamesFlag").elevatedPushNamesM2Enabled(l);if(a.isLid()&&i.phoneNumber){var u,c=o("WAWebContactCollection").ContactCollection.get(i.phoneNumber),d=o("WAWebElevatedPushNamesFlag").pushNameCanBeUsed(c)&&s,m=c!=null?o("WAWebContactGetters").getNotifyName(c):null;r=(u=c==null?void 0:c.name)!=null?u:d&&m!=null?o("WAWebChatContactUtils").getFormattedNotifyName(m).toString():o("WAWebWidFormat").widToFormattedUser(i.phoneNumber)}else{var p,_=o("WAWebElevatedPushNamesFlag").pushNameCanBeUsed(i)&&s;r=(p=i.name)!=null?p:_&&o("WAWebContactGetters").getNotifyName(i)!=null?o("WAWebChatContactUtils").getFormattedNotifyName(o("WAWebContactGetters").getNotifyName(i)).toString():o("WAWebWidFormat").widToFormattedUser(i.id)}return r}function p(e,t){var n,r,a;o("WAWebMsgGetters").getIsGroupMsg(e)&&(a=m(e,t));var i=(n=o("WAWebEmoji").EmojiUtil.normalizeEmojiFromString(t.reactionText))!=null?n:o("WAWebEmoji").OPEN_BOX_CHAR,l=s._(/*BTDS*/"Reaccion\u00f3 con {emoji} a",[s._param("emoji",i)]);return e.type===o("WAWebMsgType").MSG_TYPE.CHAT&&!e.shouldShowNotificationPreview()?r=s._(/*BTDS*/"un mensaje"):(r=o("WAWebGetNotificationStrings").getNotificationMessageBody(e),r=s._(/*BTDS*/"\"{originalMessageBody}\"",[s._param("originalMessageBody",r)])),{body:r.toString(),author:a,action:l.toString()}}function _(e,t){return{body:s._(/*BTDS*/"Le gust\u00f3 tu estado").toString(),author:m(e,t)}}function f(e){return!(!o("WAWebSettingsGetters").getShowArchiveV2(r("WAWebSettingsModel"))||!e.archive)}l.getReactionSenderJid=e,l.nonHydratedShouldMuteReactionNotification=u,l.shouldEnableReactionsNotificationGranular=c,l.shouldSquelchReactionMessage=d,l.getNotificationPartsForChatReaction=p,l.getNotificationPartsForStatusReaction=_,l.isArchivedChat=f}),226);
__d("WAWebReactionsCollection",["WALogger","WATypeUtils","WAWebAck","WAWebApiContact","WAWebBaseCollection","WAWebEmoji","WAWebLidMigrationUtils","WAWebMsgCollection","WAWebMsgKey","WAWebMsgReactionsBridge","WAWebReactionsBEUtils","WAWebReactionsModels","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f=(function(t){function a(){for(var e,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a))||this,e.findImpl=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebMsgCollection").MsgCollection.hydrateOrGetMessages([e]),n=t[0];return o("WAWebMsgReactionsBridge").sendQueryReactions(n)});return function(t){return e.apply(this,arguments)}})(),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.findAddressingModeInsensitive=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this.find(e,t);if(n!=null)return n;var a=o("WAWebLidMigrationUtils").getAlternateMsgKey(r("WAWebMsgKey").fromString(String(e)));if(a!=null)return this.find(a,t)});function t(t,n){return e.apply(this,arguments)}return t})(),i.getAddressingModeInsensitive=function(t){var e;return(e=this.get(t))!=null?e:this._getByAltId(t)},i._getByAltId=function(n){var e=n instanceof r("WAWebMsgKey")?n:r("WAWebMsgKey").from(String(n)),a=o("WAWebLidMigrationUtils").getAlternateMsgKey(e);if(a!=null)return t.prototype.get.call(this,a)},i.addOrUpdateReaction=function(n){if(n.reactionText===o("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT)return this.removeReaction(n);var t=this.getAddressingModeInsensitive(n.parentMsgKey);if(t){var r=this.getAggregateEmojiAndSender(t,n.senderUserJid),a=r.reactionSenderModel,i=r.reactionAggregateWithSender;if(i&&a){if(a.id.toString()===n.msgKey&&a.ack!==n.ack){a.ack=n.ack,a.isSendFailure===!0&&n.ack!=null&&n.ack>=o("WAWebAck").ACK.SENT&&(a.isSendFailure=!1,a.trigger("change:isSendFailure")),a.trigger("change:ack");return}else if(n.timestamp>a.timestamp){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["reactions_collection:addOrUpdateReaction Removing previous reaction"]))),o("WAWebUserPrefsMeUser").isSerializedWidMe(n.senderUserJid)&&(a.trigger("revoked"),i.set({hasReactionByMe:!1})),this._addNewReactionToAggregate(n,t),i.aggregateEmoji===o("WAWebEmoji").EmojiUtil.getEmojiAggregate(n.reactionText)?(i.senders.remove(a.id),t.reactions.trigger("change:senders")):this._removeAggregateEmojiAndSender(t,a,i);return}o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["reactions_collection:addOrUpdateReaction Did not update because timestamp was smaller than previous reaction"])));return}this._addNewReactionToAggregate(n,t)}else o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["reactions_collection:addOrUpdateReaction Reactions model not found for this message id"])))},i.removeReaction=function(t){if(o("WAWebUserPrefsMeUser").isSerializedWidMe(t.senderUserJid))return this._removeSelfReaction(t);var e=this.get(t.parentMsgKey);if(e){var n=this.getAggregateEmojiAndSender(e,t.senderUserJid),r=n.reactionAggregateWithSender,a=n.reactionSenderModel;r&&a&&(this._removeAggregateEmojiAndSender(e,a,r),a.trigger("revoked"),o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["reactions_collection:removeReaction"]))))}else o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["reactions_collection:removeReaction no reactions model found"])))},i._addNewReactionToAggregate=function(t,n){var e=o("WAWebEmoji").EmojiUtil.getEmojiAggregate(t.reactionText),a=n.reactions.get(e),i=r("WAWebMsgKey").fromString(t.msgKey),l=new(o("WAWebReactionsModels")).ReactionsSenders(babelHelpers.extends({},t,{id:i})),s=o("WAWebUserPrefsMeUser").isSerializedWidMe(t.senderUserJid);a?(s&&(a.set({hasReactionByMe:!0}),n.set({reactionByMe:t})),a.senders.add(l),n.reactions.sort(),a.trigger("change:senders")):(s&&n.set({reactionByMe:t}),n.reactions.add({aggregateEmoji:e,hasReactionByMe:s,id:e,senders:[l]}))},i._removeAggregateEmojiAndSender=function(t,n,r){r.senders.remove(n.id),r.senders.length===0?t.reactions.remove(r.id):t.reactions.sort(),r.trigger("change:senders")},i.getAggregateEmojiAndSender=function(t,n){for(var e=null,r=null,a=o("WAWebApiContact").getAlternateUserWid(o("WAWebWidFactory").createUserWidOrThrow(n)),i=0;i<t.reactions.length;i++){var l=t.reactions.at(i),s=l==null?void 0:l.senders.findFirst(function(e){return e.senderUserJid===n||a!=null&&e.senderUserJid===a.toString()});if(s){e=s,r=l;break}}return{reactionSenderModel:e,reactionAggregateWithSender:r}},i._removeSelfReaction=function(t){var e=this.get(t.parentMsgKey);if(e==null||e.set({reactionByMe:null}),e){var n=this.getAggregateEmojiAndSender(e,t.senderUserJid),r=n.reactionAggregateWithSender,o=n.reactionSenderModel;r==null||r.set({hasReactionByMe:!1}),r&&o&&(this._removeAggregateEmojiAndSender(e,o,r),o.trigger("revoked"))}},i.markReactionsAsRead=function(t){for(var e of this._getSendersByMsgKeys(t))e.read=!0},i._getSendersByMsgKeys=function(t){if(t.length===0)return[];var e=new Set(t),n=[];for(var r of this.toArray())for(var a of r.reactions.toArray())for(var i of e){var l=a.senders.get(i);if(l!=null&&(n.push(l),e.delete(i),e.size===0))return n}return o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["reactions_collection:markReactionsAsRead Reaction sender model not found"]))),n},i.getSenderByMsgKey=function(t){for(var e of this.toArray())for(var n of e.reactions.toArray()){var r=n.senders.get(t);if(r!=null)return r}},i.getExistingSenderModelFromReactionDetails=function(t){var e=t.parentMsgKey,n=t.msgKey,r=t.reactionText,a=o("WAWebEmoji").EmojiUtil.getEmojiAggregate(r),i=this.get(e);if(i){var l=i.reactions.get(a),s=l==null?void 0:l.senders.get(n);return s}o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["reactions_collection:getExistingSenderModelFromReactionDetails Reactions sender model not found for this message id"])))},i.shouldUpdateAck=function(t,n){var e=this.getExistingSenderModelFromReactionDetails(t);if(e){var r=e.ack;return!!(o("WATypeUtils").isNumber(n)&&(r===void 0||r==null||n>r||n===o("WAWebAck").ACK.FAILED))}return o("WALogger").WARN(_||(_=babelHelpers.taggedTemplateLiteralLoose(["reactions_collection:shouldUpdateAck Reaction sender model not found"]))),!1},i.deleteReactionsByParentMessageKey=function(t){this.remove(t)},a})(o("WAWebBaseCollection").BaseCollection);f.model=o("WAWebReactionsModels").Reactions;var g=new f;l.ReactionsCollection=g}),98);
__d("WAWebReactionsModels",["WAWebAck","WAWebAddOnModel","WAWebBaseModel","WAWebCollection","WAWebContactCollection","WAWebMsgCollection","WAWebMsgKey","WAWebReactionsCollection","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory","lodash"],(function(t,n,r,o,a,i,l){var e,s=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.msgKey=o("WAWebBaseModel").prop(),t.parentMsgKey=o("WAWebBaseModel").prop(),t.reactionText=o("WAWebBaseModel").prop(),t.timestamp=o("WAWebBaseModel").prop(),t.senderUserJid=o("WAWebBaseModel").prop(),t.read=o("WAWebBaseModel").prop(),t.orphan=o("WAWebBaseModel").prop(),t.isFailed=o("WAWebBaseModel").derived(function(){if(this.id.remote.isNewsletter())return!1;var e=o("WAWebUserPrefsMeUser").isSerializedWidMe(this.senderUserJid)&&this.ack!=null&&this.ack<o("WAWebAck").ACK.CLOCK;return e||!!this.isSendFailure},["ack","isSendFailure"]),t.senderObj=o("WAWebBaseModel").session(),t.parentMsg=o("WAWebBaseModel").derived(function(){return this.$ReactionsSendersSkeleton$p_1().assertGet(this.parentMsgKey)}),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){if(e.prototype.initialize.call(this),!r("WAWebWid").isNewsletter(this.senderUserJid)){var t=o("WAWebContactCollection").ContactCollection.gadd(o("WAWebWidFactory").createUserWidOrThrow(this.senderUserJid));this.addChild("senderObj",t)}},n.$ReactionsSendersSkeleton$p_1=function(){return o("WAWebMsgCollection").MsgCollection},n.isEqual=function(t){return this.id.equals(t.id)},t})(o("WAWebAddOnModel").AddOnBaseModel);s.Proxy="reactionsSenders",s.idClass=r("WAWebMsgKey");var u=(e=o("WAWebBaseModel")).defineModel(s),c=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(r("WAWebCollection"));c.model=u,c.comparator=function(e,t){return o("WAWebUserPrefsMeUser").isSerializedWidMe(e.senderUserJid)?-1:o("WAWebUserPrefsMeUser").isSerializedWidMe(t.senderUserJid)?1:t.timestamp-e.timestamp};var d=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.aggregateEmoji=o("WAWebBaseModel").prop(),t.hasReactionByMe=o("WAWebBaseModel").prop(),t.senders=o("WAWebBaseModel").collection(c),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(e.BaseModel);d.Proxy="aggReactions";var m=e.defineModel(d),p=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(r("WAWebCollection"));p.model=m,p.comparator=function(e,t){var n=t.senders.length-e.senders.length;if(e.hasReactionByMe)return-1;if(t.hasReactionByMe)return 1;if(n===0){var r=t.senders.at(0),o=e.senders.at(0);if(r&&o)return r.timestamp-o.timestamp}return n};var _=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.reactionByMe=o("WAWebBaseModel").prop(),t.reactions=o("WAWebBaseModel").collection(p),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.unreadSenders=function(){return r("lodash").flatMap(this.reactions.toArray(),function(e){return e.senders.toArray()}).filter(function(e){return!e.read&&!o("WAWebUserPrefsMeUser").isSerializedWidMe(e.senderUserJid)})},n.getReactionSenderModel=function(t,n){var e=this.reactions.get(t),r=e==null?void 0:e.senders.findFirst(function(e){return e.senderUserJid===n});return r},n.getCollection=function(){return o("WAWebReactionsCollection").ReactionsCollection},t})(e.BaseModel);_.Proxy="reactions",_.idClass=r("WAWebMsgKey");var f=e.defineModel(_);l.ReactionsSenders=u,l.ReactionsSendersCollection=c,l.AggReactions=m,l.AggReactionsCollection=p,l.Reactions=f}),98);
__d("WAWebRecentReactionModel",["WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.reactionText=o("WAWebBaseModel").prop(),t.timestamp=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="recentReaction";var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebRecentReactionsCollection",["Promise","WAWebBaseCachePolicy","WAWebBaseCollection","WAWebDebounce","WAWebRecentReactionModel","WAWebUserPrefsKeys"],(function(t,n,r,o,a,i,l){var e,s=16,u=100,c=(function(t){function o(){var o;return o=t.call(this)||this,o.findImpl=function(t){return(e||(e=n("Promise"))).resolve({id:t})},o.listenTo(o,"add",r("WAWebDebounce")(function(){return o._sortTrim()},u)),o}babelHelpers.inheritsLoose(o,t);var a=o.prototype;return a._sortTrim=function(){var e=this.length;e&&(this.sort(),e>s&&this.remove(this.slice(s)))},o})(o("WAWebBaseCollection").BaseCollection);c.model=r("WAWebRecentReactionModel"),c.cachePolicy={id:o("WAWebUserPrefsKeys").COLLECTIONS_KEYS.RECENT_REACTIONS_COLLECTION,policy:o("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:2e3},c.comparator=function(e,t){return t.timestamp-e.timestamp};var d=new c;l.RECENT_REACTIONS_LIMIT=s,l.LISTENER_DEBOUNCE_WAIT=u,l.RecentReactionsCollection=d}),98);
__d("WAWebApiStatus",["Promise","WAJids","WALogger","WATimeUtils","WAWebAck","WAWebDBMessageSerialization","WAWebDBMessageStoreUtils","WAWebDBMessageUtils","WAWebDbEncryptionKey","WAWebLidStatusMigrationGating","WAWebLidStatusMigrationUtils","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebSchemaMessage","WAWebViewMode.flow","WAWebWidFactory","asyncToGeneratorRuntime","justknobx","lodash"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p;function _(){return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getAllStatuses: Lid migration stage: ",""])),o("WAWebLidStatusMigrationGating").getLidStatusMigrationStage()),o("WAWebDbEncryptionKey").DbEncKeyStore.waitForFinalDbMsgEncKey().then(function(){var e=[f(),g()];return(p||(p=n("Promise"))).all(e).then((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.flat(1),n=[],a=[],i=r("justknobx")._("4912");t.forEach(function(e){e.author?e.viewMode===o("WAWebViewMode.flow").ViewModeType.HIDDEN&&i?(o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["ViewMode is hidden for status message"]))),o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["ViewMode is hidden for status with assoc type: ",""])),e.associationType)):o("WATimeUtils").happenedWithin(o("WATimeUtils").castToUnixTime(e.t),o("WATimeUtils").DAY_SECONDS)&&e.type!==o("WAWebMsgType").MSG_TYPE.REVOKED?e.type!==o("WAWebMsgType").MSG_TYPE.PROTOCOL&&a.push(o("WAWebDBMessageSerialization").messageFromDbRow(e)):n.push(e.id):(o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Author is null for status message"]))),o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Author is null for status with message id: ",""])),e.id))}),yield o("WAWebSchemaMessage").getMessageTable().bulkRemove(n);var l=a.map(function(e){return babelHelpers.extends({},e,{id:new(r("WAWebMsgKey"))({id:e.id.id,remote:e.id.remote,fromMe:e.id.fromMe,participant:e.id.participant==null?void 0:o("WAWebLidStatusMigrationUtils").matWidConvert(e.id.participant)}),from:o("WAWebLidStatusMigrationUtils").matWidConvert(e.from),author:e.author==null?void 0:o("WAWebLidStatusMigrationUtils").matWidConvert(e.author)})}),m=r("lodash").groupBy(l,function(e){var t;return e.from.isStatus()&&e.author!=null?e.author.toString():(t=o("WAWebMsgGetters").getSender(e))!=null?t:e.from.toString()}),p=[];for(var _ in m){var f=m[_],g=f.filter(function(e){return e.ack<o("WAWebAck").ACK.READ}).length,h=f[f.length-1].t;p.push({id:o("WAWebWidFactory").createWid(_),unreadCount:g,totalCount:f.length,t:h,_msgs:f})}return p});return function(t){return e.apply(this,arguments)}})())})}function f(){var e=o("WAWebWidFactory").createWid(o("WAJids").STATUS_JID);return o("WAWebDBMessageStoreUtils").queryChatMessageHelper(o("WAWebDBMessageUtils").beginningOfChat(e),o("WAWebDBMessageUtils").endOfChat(e),{lowerInclusive:!1,upperInclusive:!1})}function g(){try{if(r("justknobx")._("550"))return o("WAWebDBMessageStoreUtils").queryGroupStatusMsgsHelper()}catch(e){o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["getAllGroupStatusesPromise: ",""])),e).sendLogs("query-group-status")}return(p||(p=n("Promise"))).resolve([])}l.getAllStatuses=_}),98);
__d("WAWebDeleteStatusAction",["WALogger","WAWebContactGetters","WAWebDBMessageDelete","WAWebFrontendContactGetters","WAWebGroupMetadataCollection","WAWebStatusCollection","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){var e;function s(){var t=o("WAWebStatusCollection").StatusCollection.filter(function(e){var t;return!o("WAWebUserPrefsMeUser").isMeAccount(e.contact.id)&&!o("WAWebFrontendContactGetters").getIsMyContact(e.contact)&&(!o("WAWebContactGetters").getIsGroup(e.contact)||(r("WAWebGroupMetadataCollection")==null||(t=r("WAWebGroupMetadataCollection").get(e.contact.id))==null||(t=t.participants)==null?void 0:t.iAmMember())!==!0)&&!o("WAWebContactGetters").getIsPSA(e.contact)}),n=t.reduce(function(e,t){var n=e.concat(t.msgs.map(function(e){return String(e.id)}));return t.delete(),n},[]);return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["clearStatusForNonAddressBook: remove "," status "])),n.length),o("WAWebDBMessageDelete").removeStatusMessage(n)}l.clearStatusForRemovedContact=s}),98);
__d("WAWebPostSendStatusFailure",["WAErrors","WALogger","WAWebBackendErrors","WAWebHandleMsgError","WAWebSendMsgResultAction","WAWebWamEnumMessageSendResultType"],(function(t,n,r,o,a,i,l){var e,s,u,c,d;function m(t,n){var r;if(t instanceof o("WAWebBackendErrors").ServerStatusCodeError){var a;return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[status] failed to send status message"]))).sendLogs("status-send-server-error"),(a=n.sendReporter)==null||a.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_NETWORK,isTerminal:!0}),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_NETWORK}}else if(t instanceof o("WAWebHandleMsgError").MessageValidationError){var i;return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[status] failed to send status message"]))).sendLogs("status-send-validation-error"),(i=n.sendReporter)==null||i.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_INVALID_PROTOBUF,isTerminal:!0}),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}else if(t instanceof o("WAWebHandleMsgError").MessageSentAckError){var l;return o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[status] failed to send status message, get error ack"]))).sendLogs("status-send-ack-error"),(l=n.sendReporter)==null||l.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UNKNOWN,isTerminal:!0}),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}else if(t instanceof o("WAErrors").BufferTooLargeError){var m;return o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[status] failed to send status message, get error ack"]))).sendLogs("status-send-too-large-error"),(m=n.sendReporter)==null||m.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_PAYLOAD_TOO_BIG,isTerminal:!0}),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}return o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[status] failed to send status message"]))).sendLogs("status-send-fail"),(r=n.sendReporter)==null||r.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UNKNOWN,isTerminal:!0}),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}l.postStatusSendFailure=m}),98);
__d("WAWebSendMsgMetricReporter",["WAWebMessageSendPerfReporter","WAWebMessageSendReporter","WAWebMsgType","WAWebWamMsgUtils"],(function(t,n,r,o,a,i,l){var e=function(t){var e={createSendReporter:function(n){return new(o("WAWebMessageSendReporter")).MessageSendReporter(t,n)},sendReporter:null,sendPerfReporter:null};return Object.defineProperty(e,"sendReporter",{get:function(){return t.wamMessageSendReporter},set:function(n){t.wamMessageSendReporter=n},enumerable:!0}),Object.defineProperty(e,"sendPerfReporter",{get:function(){var e;return(e=t.wamMessageSendPerfReporter)!=null?e:null},set:function(n){t.wamMessageSendPerfReporter=n},enumerable:!0}),e},s=function(t){var e=new(o("WAWebMessageSendReporter")).MessageSendReporter(t),n=new(o("WAWebMessageSendPerfReporter")).MessageSendPerfReporter({chatWid:t.to,mediaType:o("WAWebWamMsgUtils").getWamMediaType(t),messageType:o("WAWebWamMsgUtils").getWamMessageType(t)});if(t.kind===o("WAWebMsgType").MsgKind.ProtocolAddonRevoke){var r;(r=n)==null||r.setIsRevokeMessage(!0)}var a={createSendReporter:function(n){return new(o("WAWebMessageSendReporter")).MessageSendReporter(t,n)},sendReporter:null,sendPerfReporter:null};return Object.defineProperty(a,"sendReporter",{get:function(){return e},set:function(n){e=n},enumerable:!0}),Object.defineProperty(a,"sendPerfReporter",{get:function(){return n},set:function(t){n=t},enumerable:!0}),a};l.createMsgModelMetricReporter=e,l.createAddonMetricReporter=s}),98);
__d("WAWebSendStatusMsgAction",["invariant","WAJids","WALogger","WATimeUtils","WAWebAck","WAWebDBProcessMessage","WAWebEncryptAndSendStatusMsg","WAWebLidStatusMigrationUtils","WAWebMessageSendPerfReporter","WAWebMessagingGatingUtils","WAWebMsgKey","WAWebMsgModel","WAWebMsgType","WAWebOutgoingMessage","WAWebPostSendStatusFailure","WAWebSendMsgMetricReporter","WAWebSendMsgResultAction","WAWebSendMsgTypes","WAWebStatusCollection","WAWebStatusGatingUtils","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWamEnumMessageSendResultType","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l,s){var e,u,c,d,m,p,_,f,g,h,y=4286237861;function C(e){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n,r,a,i,l;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["sendStatusTextMsgAction: start to send text messege"])));var c=yield E(t);c!=null||s(0,73062);var d=new(o("WAWebMsgModel")).Msg(c);d.wamMessageSendPerfReporter=new(o("WAWebMessageSendPerfReporter")).MessageSendPerfReporter({chatWid:d.to,mediaType:d.getWamMediaType(),messageType:d.getWamMessageType()});var m=o("WAWebSendMsgMetricReporter").createMsgModelMetricReporter(d);return m.sendReporter=(n=m.sendReporter)!=null?n:m.createSendReporter(),(r=m.sendPerfReporter)==null||r.startRenderedStage(),yield o("WAWebStatusCollection").StatusCollection.addStatusMessages(d.author,[d]),o("WAWebStatusCollection").StatusCollection.handleUpdate(c,!1),(a=m.sendPerfReporter)==null||a.postRenderedStage(),(i=m.sendPerfReporter)==null||i.startSavedStage(),yield o("WAWebDBProcessMessage").storeMessages([c],d.to),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["sendStatusTextMsgAction: store text messege"]))),(l=m.sendPerfReporter)==null||l.postSavedStage(),R(d,c,m)}),b.apply(this,arguments)}function v(e,t){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n,a,i,l,s,u,_;o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["sendStatusMediaMsgAction: start to send status messege"])));var f=babelHelpers.extends({},e,{id:new(r("WAWebMsgKey"))({fromMe:e.id.fromMe,remote:e.id.remote,id:e.id.id,participant:e.id.participant?o("WAWebLidStatusMigrationUtils").matWidConvert(e.id.participant):void 0}),from:o("WAWebLidStatusMigrationUtils").matWidConvert(e.from),author:o("WAWebLidStatusMigrationUtils").matWidConvert(o("WAWebUserPrefsMeUser").getMePnUserOrThrow()),cannotBeRanked:o("WAWebStatusGatingUtils").canCheckStatusRankingPosterGating()}),g=new(o("WAWebMsgModel")).Msg(f);g.wamMessageSendPerfReporter=new(o("WAWebMessageSendPerfReporter")).MessageSendPerfReporter({chatWid:g.to,mediaType:g.getWamMediaType(),messageType:g.getWamMessageType()});var h=o("WAWebSendMsgMetricReporter").createMsgModelMetricReporter(g);h.sendReporter=(n=h.sendReporter)!=null?n:h.createSendReporter(),(a=h.sendPerfReporter)==null||a.startRenderedStage(),yield o("WAWebStatusCollection").StatusCollection.addStatusMessages(g.author,[g]),o("WAWebStatusCollection").StatusCollection.handleUpdate(f,!1),(i=h.sendPerfReporter)==null||i.postRenderedStage(),(l=h.sendPerfReporter)==null||l.startSavedStage(),yield o("WAWebDBProcessMessage").storeMessages([f],g.to),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["sendStatusMediaMsgAction: store media messege"]))),(s=h.sendPerfReporter)==null||s.postSavedStage(),(u=h.sendPerfReporter)==null||u.startReadyToSendStage(),yield g.waitForPrep();try{yield t(g)}catch(e){var y;return o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[status] failed to send status message with ",""])),e).sendLogs("status-send-media-error"),(y=h.sendReporter)==null||y.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UPLOAD,isTerminal:!0}),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UPLOAD}}return(_=h.sendPerfReporter)==null||_.postReadyToSendStage(),o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["sendStatusMediaMsgAction: media prep done for status messege"]))).devConsole(f),R(g,f,h)}),S.apply(this,arguments)}function R(e,t,n){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["_sendStatusMessage: send status messege ",""])),e.id).devConsole(t);var r={type:o("WAWebSendMsgTypes").SendMessageRecordType.Message,data:e},a=o("WAWebOutgoingMessage").createOutgoingMessageProtobuf(o("WAWebOutgoingMessage").OutgoingMessageOriginType.Status,r);o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["_sendStatusMessage: generate protobuf"]))).devConsole(a);try{var i;return yield o("WAWebEncryptAndSendStatusMsg").encryptAndSendStatusMsg(r,a,n),(i=n.sendReporter)==null||i.postSuccess(),e.updateAck(o("WAWebAck").ACK.SENT),o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["_sendStatusMessage: done"]))),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.OK}}catch(t){return e.updateAck(o("WAWebAck").ACK.FAILED),o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["_sendStatusMessage: failed with ",""])),t),o("WAWebPostSendStatusFailure").postStatusSendFailure(t,n)}}),L.apply(this,arguments)}function E(e){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n,a=(e.text||"").trim();if(a==="")return null;var i=o("WAWebWidFactory").createWid(o("WAJids").STATUS_JID),l=o("WAWebLidStatusMigrationUtils").matWidConvert(o("WAWebUserPrefsMeUser").getMePnUserOrThrow()),s=o("WAWebLidStatusMigrationUtils").matWidConvert(l),u=new(r("WAWebMsgKey"))({from:l,to:i,id:yield r("WAWebMsgKey").newId(),participant:s,selfDir:"out"}),c={id:u,body:a,author:l,backgroundColor:(t=e.color)!=null?t:y,type:"chat",kind:o("WAWebMsgType").MsgKind.Chat,viewMode:o("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:void 0,t:o("WATimeUtils").unixTime(),from:l,to:i,isNewMsg:!0,local:!0,ack:o("WAWebAck").ACK.CLOCK,font:(n=e.font)!=null?n:void 0,messageSecret:o("WAWebMessagingGatingUtils").isReportingTokenSendingEnabled()?self.crypto.getRandomValues(new Uint8Array(32)):null,cannotBeRanked:o("WAWebStatusGatingUtils").canCheckStatusRankingPosterGating()};return c}),k.apply(this,arguments)}l.sendStatusTextMsgAction=C,l.sendStatusMediaMsgAction=v,l.createTextStatusMsgData=E}),98);
__d("WAWebStatusGetters",["WALogger","WAWebGetters","WAWebGettersCaches"],(function(t,n,r,o,a,i,l){var e,s=o("WAWebGetters").createGetterFactories({createCache:o("WAWebGettersCaches").createStatusCache}),u=s.field,c=s.computed,d=s.unsafeIdentityGetter,m=s.clearCacheFor,p=m,_=d,f=u("id"),g=u("t"),h=u("unreadCount"),y=u("totalCount"),C=c(function(e){var t=e[0];return t>0},[h]),b=c(function(t){var n=t[0],r=t[1],a=r-n;return Number.isFinite(a)?a:(o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Bad status read count, ",", ",""])),r,n),0)},[h,y]);l.clearStatusGetterCacheFor=p,l.getStatusUnsafe=_,l.getId=f,l.getT=g,l.getUnreadCount=h,l.getTotalCount=y,l.getHasUnread=C,l.getReadCount=b}),98);
__d("WAWebWebcStatusSessionWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WebcStatusSession:[1880,{webcStatusMutedItemCount:[4,e.TYPES.INTEGER],webcStatusMutedRowCount:[7,e.TYPES.INTEGER],webcStatusRecentItemCount:[2,e.TYPES.INTEGER],webcStatusRecentRowCount:[5,e.TYPES.INTEGER],webcStatusSessionId:[1,e.TYPES.INTEGER],webcStatusViewedItemCount:[3,e.TYPES.INTEGER],webcStatusViewedRowCount:[6,e.TYPES.INTEGER]},[1,1,1],"regular"]},{WebcStatusSession:[]});l.WebcStatusSessionWamEvent=s}),98);
__d("WAWebWebcStatusSyncWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WebcStatusSync:[1878,{webcStatusMutedItemCount:[4,e.TYPES.INTEGER],webcStatusMutedRowCount:[7,e.TYPES.INTEGER],webcStatusRecentItemCount:[2,e.TYPES.INTEGER],webcStatusRecentRowCount:[5,e.TYPES.INTEGER],webcStatusSyncT:[1,e.TYPES.TIMER],webcStatusViewedItemCount:[3,e.TYPES.INTEGER],webcStatusViewedRowCount:[6,e.TYPES.INTEGER]},[1,1,1],"regular"]},{WebcStatusSync:[]});l.WebcStatusSyncWamEvent=s}),98);
__d("WAWebStatusCollection",["Promise","WAJids","WALogger","WATimeUtils","WAWebApiContact","WAWebBaseCollection","WAWebContactGetters","WAWebContactStatusBridge","WAWebFrontendContactGetters","WAWebGroupMetadataCollection","WAWebLidMigrationUtils","WAWebLidStatusMigrationUtils","WAWebMediaOpaqueData","WAWebMsgCollection","WAWebMsgGetters","WAWebStatusGetters","WAWebStatusModel","WAWebUserPrefsMeUser","WAWebWebcStatusSessionWamEvent","WAWebWebcStatusSyncWamEvent","WAWebWidFactory","asyncToGeneratorRuntime","isStringNullOrEmpty","sumOfArray"],(function(t,n,r,o,a,i,l){var e,s,u,c=86400,d=(function(t){function a(){for(var e,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a))||this,e.findImpl=function(e){return(u||(u=n("Promise"))).resolve({id:e})},e.findQueryImpl=function(){return o("WAWebContactStatusBridge").queryStatusAll()},babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.findQuery=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,r){var o=this,a=yield t.prototype.findQuery.call(this,e,r),i=a||[];return yield(u||(u=n("Promise"))).all(i.map(function(e){if(e){var t=0;return e.msgs.forEach(function(n){t<e._msgs.length&&e._msgs[t].id.toString()===n.id.toString()?++t:n.delete()}),e._msgs.length>0?o.addStatusMessages(e.id,e._msgs):(u||(u=n("Promise"))).resolve()}})),i});function r(t,n){return e.apply(this,arguments)}return r})(),i.sync=function(){var t=this,n=window.performance.now();return this.findQuery({},{set:this.hasSynced()}).finally(function(){t.trigger("sync")}).then(function(r){var a=window.performance.now(),i=Math.round(a-n);return t.logMetrics({type:"sync",syncTime:i}),t.forEach(function(t){t.msgs.length>t.totalCount&&o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Total count: ",", msgs length: ",""])),t.totalCount,t.msgs.length)}),r})},i.logMetrics=function(t){var e;t.type==="sync"?e=new(o("WAWebWebcStatusSyncWamEvent")).WebcStatusSyncWamEvent({webcStatusSyncT:t.syncTime}):e=new(o("WAWebWebcStatusSessionWamEvent")).WebcStatusSessionWamEvent({webcStatusSessionId:t.sessionId});var n=this.filter(function(e){return!o("WAWebContactGetters").getIsMe(e.contact)}),a=n.filter(function(e){return!o("WAWebContactGetters").getCalculatedStatusMute(e.contact)}),i=a.filter(function(e){return o("WAWebStatusGetters").getHasUnread(e)}),l=a.filter(function(e){return!o("WAWebStatusGetters").getHasUnread(e)}),s=n.filter(function(e){return o("WAWebContactGetters").getCalculatedStatusMute(e.contact)}),u=r("sumOfArray")(a.map(function(e){return e.unreadCount})),c=r("sumOfArray")(a.map(function(e){return o("WAWebStatusGetters").getReadCount(e)})),d=r("sumOfArray")(s.map(function(e){return e.totalCount}));e.webcStatusRecentItemCount=u,e.webcStatusRecentRowCount=i.length,e.webcStatusViewedItemCount=c,e.webcStatusViewedRowCount=l.length,e.webcStatusMutedItemCount=d,e.webcStatusMutedRowCount=s.length,e.commit()},i.hasSynced=function(){return!0},i.getStatusModel=function(t,n){var e=this.get(t);if(e==null&&n){var r=t!=null?o("WAWebApiContact").getAlternateUserWid(o("WAWebWidFactory").asUserWidOrThrow(t)):null;e=r!=null?this.get(r):null}return e},i.handleUpdate=function(t,n){var e,a=(e=o("WAWebMsgGetters").getSender(t))!=null?e:t.from;if(t.id.remote.isStatus()&&(a=t.id.fromMe?o("WAWebLidStatusMigrationUtils").matWidConvert(o("WAWebUserPrefsMeUser").getMePnUserOrThrow()):t.author),this.hasSynced()){if(n)return!0;var i=t.subtype==="sender_revoke",l=a?this.getStatusModel(a,i):null;if(l){var u=l.totalCount===l.msgs.length;if(i){var c=t.protocolMessageKey,d=c!=null?o("WAWebLidMigrationUtils").getAlternateMsgKey(c):null,m=!1;if(c!=null&&(m=l.containsMessage(c)||l.containsMessage(d)),m!==!0)return!0;var p=c==null?void 0:c.toString(),_=d==null?void 0:d.toString(),f={totalCount:l.totalCount-1};l!=null&&l.isUnreadMessage(p)&&(_==null||l!=null&&l.isUnreadMessage(_))&&(f.unreadCount=l.unreadCount-1),l.set(f)}else{var g={totalCount:l.totalCount+1,t:t.t};t.invis!==!0&&(g.unreadCount=l.unreadCount+1),l.set(g)}return!u&&!r("isStringNullOrEmpty")(t.body)&&r("WAWebMediaOpaqueData").createFromBase64Jpeg(t.body).then(function(e){l.pic=e}).catch(function(){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[StatusCollection] failed to create from base64 jpeg"]))).sendLogs("failed-to-create-from-base64-jpeg")}),u}if(i)return!0;if(a){var h={id:a,t:t.t,unreadCount:t.invis===!0?0:1,totalCount:1};this.add(h)}return!0}return!1},i.addStatusMessages=function(t,r){return(u||(u=n("Promise"))).all([this.$StatusCollectionImpl$p_1(o("WAWebWidFactory").createWid(o("WAJids").STATUS_JID),r.filter(function(e){return e.id.remote.isStatus()})),this.$StatusCollectionImpl$p_1(t,r.filter(function(e){return!e.id.remote.isStatus()&&o("WAWebMsgGetters").getIsStatus(e)}))]).then(function(e){var t=e[0],n=e[1];return t.concat(n)})},i.$StatusCollectionImpl$p_1=function(t,r){return r.length===0?(u||(u=n("Promise"))).resolve([]):o("WAWebMsgCollection").MsgCollection.processMultipleMessages(t,r,{add:"after",isHistory:!0},"addStatusMessages")},i.getUnexpired=function(t){var e=this.filter(function(e){var t;return e.totalCount<=0||e.isExpired()||o("WAWebContactGetters").getIsMe(e.contact)?!1:o("WAWebFrontendContactGetters").getIsMyContact(e.contact)?!0:o("WAWebContactGetters").getIsPSA(e.contact)?!1:!!(o("WAWebContactGetters").getIsGroup(e.contact)&&(r("WAWebGroupMetadataCollection")==null||(t=r("WAWebGroupMetadataCollection").get(e.contact.id))==null||(t=t.participants)==null?void 0:t.iAmMember())===!0)});if(t){var n=e.filter(function(e){return e.unreadCount>0});return n}var a=e.filter(function(e){return e.unreadCount===0});return a},i.getMyStatus=function(){var e=this.filter(function(e){return o("WAWebContactGetters").getIsMe(e.contact)});if(e.length!==0&&!(o("WATimeUtils").unixTime()-e[0].t>c))return e[0]},i.getPSAStatus=function(){var e=this.filter(function(e){return o("WAWebContactGetters").getIsPSA(e.contact)});if(e.length!==0)return e[0]},a})(o("WAWebBaseCollection").BaseCollection);d.model=r("WAWebStatusModel"),d.comparator=function(e,t){return t.t-e.t};var m=new d;l.StatusCollection=m}),98);
__d("WAWebFrontendStatusGetters",["WAWebGetters","WAWebGettersCaches","WAWebStatusGetters"],(function(t,n,r,o,a,i,l){var e=o("WAWebGetters").createGetterFactories({root:o("WAWebStatusGetters").getStatusUnsafe,createCache:o("WAWebGettersCaches").createFrontendStatusCache}),s=e.field,u=e.computed,c=e.clearCacheFor,d=c,m=s("msgs"),p=s("msgsChanged"),_=s("contact"),f=u(function(e){var t=e[0],n=e[1];return n.last()},[p,m]);l.clearFrontendStatusGetterCacheFor=d,l.getContact=_,l.getLastStatus=f}),98);
__d("WAWebStatusPSAUtils",["WATimeUtils"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.length===0)return-1;for(var n=0,r=t[0].campaignId,o=1;o<t.length;o++){var a=t[o],i=a.id,l=a.campaignId;if(r!==l?(r=l,n=0):n++,i.toString()===e.toString())return n}return-1}function s(e){var t=u(e),n=[];return Object.keys(t).forEach(function(e){var r=t[e],o=r.numberOfStatus,a=r.numberOfReadStatus,i=o-a;n.push(e+":"+i)}),n.join(",")}function u(e){var t={};return e.forEach(function(e){var n=e.t,r=e.campaignId,o=e.campaignDuration,a=e.statusPSAReadTimestamp;if(r){t[r]||(t[r]={id:r,t:n,duration:o,firstReadTimestamp:null,numberOfStatus:0,numberOfReadStatus:0});var i=t[r];i.numberOfStatus++,a!=null&&(i.numberOfReadStatus++,(i.firstReadTimestamp==null||a<i.firstReadTimestamp)&&(i.firstReadTimestamp=a))}}),t}function c(e,t){var n=e.firstReadTimestamp;if(n!=null)return o("WATimeUtils").unixTime()-n>t;var r=e.duration;return r!=null?o("WATimeUtils").unixTime()-e.t>r:!1}function d(e,t){var n=u(e);return Object.keys(n).every(function(e){return c(n[e],t)})}l.getPsaCampaignIndex=e,l.getPsaCampaignsString=s,l.getPSACampaigns=u,l.isCampaignExpired=c,l.isExpiredStatusPSA=d}),98);
__d("WAWebStatusModel",["Promise","WALogger","WATimeUtils","WAWebAck","WAWebAlarm","WAWebAppTracker","WAWebBaseModel","WAWebCollectionConstants","WAWebCommonMsgUtils","WAWebContactCollection","WAWebContactStatusBridge","WAWebFrontendMsgGetters","WAWebFrontendStatusGetters","WAWebMsgGetters","WAWebMsgModelUtils","WAWebNoop","WAWebNotificationBackend","WAWebStatusCollection","WAWebStatusGatingUtils","WAWebStatusGetters","WAWebStatusPSAUtils","WAWebSuperChatMsgs","WAWebWid","asyncToGeneratorRuntime","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g=86400,h=1e3,y=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.id=o("WAWebBaseModel").prop(),e.t=o("WAWebBaseModel").prop(),e.unreadCount=o("WAWebBaseModel").prop(0),e.totalCount=o("WAWebBaseModel").prop(0),e.pic=o("WAWebBaseModel").prop(),e._msgs=o("WAWebBaseModel").prop(function(){return[]}),e.readKeys=o("WAWebBaseModel").session(function(){return{}}),e.contact=o("WAWebBaseModel").session(),e.expireTimer=o("WAWebBaseModel").session(),e.expireTs=o("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.initialize=function(){var e=this;t.prototype.initialize.call(this),this.addChild("contact",o("WAWebContactCollection").ContactCollection.gadd(this.id)),this.listenTo(this.msgs,"add bulk_add",function(){self.setTimeout(function(){e.setupStatusExpiration()})}),this.listenTo(this,"change:msgsChanged",function(){var t=o("WAWebFrontendStatusGetters").getLastStatus(e);t&&(e.t=t.t)}),this.listenTo(this.msgs,"remove",function(t){t.isGroupStatus===!0&&(e.totalCount=Math.max(0,e.totalCount-1),t.ack&&t.ack<o("WAWebAck").ACK.READ&&(e.unreadCount=Math.max(0,e.unreadCount-1)),e.totalCount===0&&e.onEmptyMRM())}),this.listenTo(this.msgs,"add",function(e){o("WAWebStatusGatingUtils").isStatusPrivateMentionsReceiveEnabled()&&!o("WAWebMsgGetters").getIsSentByMe(e)&&o("WAWebMsgGetters").getStatusMentioned(e)&&[o("WAWebCommonMsgUtils").EventType.DEFAULT,o("WAWebCommonMsgUtils").EventType.AMBIENT].includes(o("WAWebFrontendMsgGetters").getEventType(e))&&o("WAWebNotificationBackend").showStatusNotification(e)})},i.isExpired=function(){return this.id.isPSA()?o("WAWebStatusPSAUtils").isExpiredStatusPSA(this.msgs.toArray(),g):o("WATimeUtils").unixTime()-this.t>g},i.setupStatusExpiration=function(){var e=this,t=this.msgs.at(0);if(t&&!(typeof this.expireTs=="number"&&this.expireTs<=t.t)){var n=1,a=t.t+g+n;a<o("WATimeUtils").unixTime()?self.setTimeout(function(){e.expireMsg()}):(this.expireTimer=r("WAWebAlarm").setGlobalTimeout(this.expireMsg.bind(this),a*h,this.expireTimer),this.expireTs=t.t)}},i._removeSingleMsg=function(t){var e=this.msgs;this.unreadCount>this.totalCount-1&&this.unreadCount--,this.totalCount--,e.remove(t),t.delete()},i.expireMsg=function(){if(this.id.isPSA()){this.expirePSAMsg();return}o("WAWebAppTracker").AppTracker.start(o("WAWebAppTracker").AppTrackerType.PurgeStatuses);for(var t=this.msgs;t.length>0;){var n=t.at(0);if(!n)break;var a=n.t+g>o("WATimeUtils").unixTime();if(a)break;r("gkx")("26258")||(o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Expiring message with ID:"]))).devConsole(n.id,"msg timestamp:",n.t,"global unix time:",o("WATimeUtils").unixTime()),o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Unread count:"]))).devConsole(this.unreadCount,"total count:",this.totalCount),o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["msgs.length:"]))).devConsole(t.length)),this._removeSingleMsg(n)}o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.PurgeStatuses),this.expireTs=void 0,this.expireTimer=void 0,this.totalCount!==0&&this.setupStatusExpiration()},i.expirePSAMsg=function(){var e=this,t,n=o("WAWebStatusPSAUtils").getPSACampaigns(this.msgs.toArray());(t=o("WAWebAppTracker")).AppTracker.start(t.AppTrackerType.PurgeStatuses),this.msgs.forEach(function(t){var a=t.campaignId;if(a!=null){var i=o("WAWebStatusPSAUtils").isCampaignExpired(n[a],g);i&&(r("gkx")("26258")||(o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Expiring campaignID:"]))).devConsole(t.campaignId,"campaignDuration:",t.campaignDuration,"- msg with ID:",t.id,"msg timestamp:",t.t,"global unix time:",o("WATimeUtils").unixTime()),o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Unread count:"]))).devConsole(e.unreadCount,"total count:",e.totalCount),o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["msgs.length:"]))).devConsole(e.msgs.length)),e._removeSingleMsg(t))}}),t.AppTracker.stop(t.AppTrackerType.PurgeStatuses),this.expireTs=void 0,this.expireTimer=void 0,this.totalCount!==0&&this.setupStatusExpiration()},i.isUnreadMessage=function(t){if(t==null)return!1;var e=o("WAWebMsgModelUtils").getReadMsgKeys(this.msgs.toArray()),n=e.find(function(e){return e===t})==null;return n&&this.readKeys[t]!==!0},i.revokeMsgs=function(t){var e=this,n=new Set(t),r=this.msgs.filter(function(e){return n.has(e.id.toString())});r.forEach(function(t){return e._removeSingleMsg(t)}),this.totalCount===0&&(this.expireTs=void 0,this.expireTimer=void 0)},i.delete=function(){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Status deleted with total count: ",""])),this.totalCount),t.prototype.delete.call(this),this.expireTimer&&r("WAWebAlarm").clearTimeout(this.expireTimer),this.expireTs!=null&&(this.expireTs=void 0),this.getCollection().remove(this.id),o("WAWebStatusGetters").clearStatusGetterCacheFor(this),o("WAWebFrontendStatusGetters").clearFrontendStatusGetterCacheFor(this)},i.onEmptyMRM=function(){var e=this;if(o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Status onEmptyMRM with total count: ",", noEarlierMsgs: ",""])),this.totalCount,this.msgs.msgLoadState.noEarlierMsgs?"true":"false"),this.msgs.msgLoadState.noEarlierMsgs&&this.totalCount===0){this.delete();return}this.totalCount>0&&this.loadMore().catch(r("WAWebNoop")).finally(function(){e.msgs.length||e.delete()})},i.loadMore=function(t){return t===void 0&&(t=o("WAWebCollectionConstants").PAGE_SIZE),this.msgs.msgLoadState.noEarlierMsgs?(f||(f=n("Promise"))).resolve():this.msgs.msgLoadState.isLoadingEarlierMsgs?this.msgs.loadEarlierPromise:(this.msgs.msgLoadState.noEarlierMsgs=!0,(f||(f=n("Promise"))).resolve())},i.handleReadStatus=function(t){var e=t.toString();this.readKeys[e]||(this.readKeys[e]=!0,this.unreadCount>0&&this.unreadCount--)},i.sendReadStatus=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield o("WAWebContactStatusBridge").sendReadStatus(e,t,n);r&&this.handleReadStatus(e.id)});function t(t,n,r){return e.apply(this,arguments)}return t})(),i.getCollection=function(){return o("WAWebStatusCollection").StatusCollection},i.containsMessage=function(t){return t==null?!1:this.msgs.toArray().some(function(e){return e.id.toString()===t.toString()})},a})(r("WAWebSuperChatMsgs"));y.Proxy="status",y.idClass=r("WAWebWid");var C=o("WAWebBaseModel").defineModel(y);l.default=C}),98);
__d("WAWebStatusNotification",["fbt","WANullthrows","WAWebABProps","WAWebBaseNotification","WAWebContactCollection","WAWebContactGetters","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebGetNotificationStrings","WAWebMsgGetters","WAWebMuteCollection","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebNotificationMuteReason","WAWebStatusCollection","WAWebStatusNotificationUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l,s){var e=(function(e){function t(t){var n,a=t.msg;return n=e.call(this)||this,n.msg=a,n.status=o("WAWebStatusCollection").StatusCollection.getStatusModel(r("WANullthrows")(o("WAWebMsgGetters").getSender(n.msg),"[WAStatusNotification]: status poster cannot be null"),!1),n}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a.shouldMute=function(t){var e,n;return o("WAWebNotificationHelpers").appIsActive()?r("WAWebNotificationMuteReason").AppState:(e=this.status)!=null&&e.contact&&o("WAWebContactGetters").getCalculatedStatusMute((n=this.status)==null?void 0:n.contact)?r("WAWebNotificationMuteReason").MutedStatus:o("WAWebNotificationHelpers").isOfflineResumeInProgress()?r("WAWebNotificationMuteReason").OfflineResumeInProgress:null},a.shouldPlaySound=function(){if(!e.prototype.shouldPlaySound.call(this))return!1;var t=o("WAWebABProps").getABPropConfigValue("wa_web_enable_granular_notifications");return t?o("WAWebMuteCollection").MuteCollection.getGlobalStatusSoundsEnabled():e.prototype.shouldPlaySound.call(this)},a.shouldShowBanner=function(){if(!e.prototype.shouldShowBanner.call(this))return!1;var t=o("WAWebABProps").getABPropConfigValue("wa_web_enable_granular_notifications");return t?o("WAWebMuteCollection").MuteCollection.getGlobalStatusNotificationsEnabled():e.prototype.shouldShowBanner.call(this)},a.getBannerOptions=function(){var e=this,t=s._(/*BTDS*/"Te mencion\u00f3 en privado en un estado").toString(),n=this.status?o("WAWebFrontendContactGetters").getFormattedName(this.status.contact):o("WAWebFrontendContactGetters").getFormattedName(r("WANullthrows")(o("WAWebContactCollection").ContactCollection.get(this.msg.author))),a=o("WAWebGetNotificationStrings").getNotificationBody({body:t,msgDir:o("WAWebFrontendMsgGetters").getDir(this.msg)}),i=function(){o("WAWebStatusNotificationUtils").openStatusViewer(e.msg)};return{wid:this.msg.author,title:r("WANullthrows")(n),body:a,onClick:i}},a.buildKey=function(){return"status-msg:"+this.msg.id.toString()},a.getIcon=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebNotificationIconUtils").getNotificationIconByWid(r("WANullthrows")(o("WAWebMsgGetters").getSender(this.msg)),this.abortController.signal,o("WAWebNotificationIconUtils").USER_DEFAULT_ICON)});function t(){return e.apply(this,arguments)}return t})(),t})(o("WAWebBaseNotification").WABaseNotification);l.WAStatusNotification=e}),226);
__d("WAWebBackIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="back";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=24,R=24;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 24 24",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),version:"1.1",x:"0px",y:"0px",enableBackground:"new 0 0 24 24",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{fill:"currentColor",d:"M12,4l1.4,1.4L7.8,11H20v2H7.8l5.6,5.6L12,20l-8-8L12,4z"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.BackIcon=m}),98);
__d("WAWebXViewerIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="x-viewer";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=24,R=24;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 24 24",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),version:"1.1",x:"0px",y:"0px",enableBackground:"new 0 0 24 24",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{fill:"currentColor",d:"M19.8,5.8l-1.6-1.6L12,10.4L5.8,4.2L4.2,5.8l6.2,6.2l-6.2,6.2l1.6,1.6l6.2-6.2l6.2,6.2l1.6-1.6L13.6,12 L19.8,5.8z"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.XViewerIcon=m}),98);
__d("WAWebStatusLoadingQuoted.react",["WAWebBackIcon.react","WAWebLazyLoadLoading.react","WAWebModalManager","WAWebXViewerIcon.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){var t=e.error,n=e.text,a=e.retry,i=function(){return o("WAWebModalManager").ModalManager.closeMedia()};return s.jsxs("div",{className:"x10l6tqk x13vifvy x1o0tod x1bpt9pm xh8yej3 x5yr21d x1280gxy","data-animate-status-viewer":!0,children:[s.jsx("button",{className:"x10l6tqk xoyzfg9 x1i4sgur xhtitgo x17t9dm2",onClick:i,children:s.jsx(o("WAWebXViewerIcon.react").XViewerIcon,{})}),s.jsx("button",{className:"x10l6tqk xoyzfg9 x18hw5r0 xhtitgo x78zum5 x17t9dm2",onClick:i,children:s.jsx(o("WAWebBackIcon.react").BackIcon,{directional:!0})}),s.jsx(r("WAWebLazyLoadLoading.react"),{error:t,text:n,retry:a})]})}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("WAWebStatusQuotedFlowLoadable",["JSResourceForInteraction","WAWebLazyLoadedRetriable","WAWebLoadable","WAWebStatusLoadingQuoted.react","asyncToGeneratorRuntime","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=r("WAWebLazyLoadedRetriable")(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield r("JSResourceForInteraction")("WAWebStatusQuotedFlow.react").__setRef("WAWebStatusQuotedFlowLoadable").load();return e}),"StatusQuotedFlow"),c=r("WAWebLoadable")({loader:u,loading:function(t){return s.jsx(r("WAWebStatusLoadingQuoted.react"),{error:!!t.error})}});l.requireBundle=u,l.StatusQuotedFlowLoadable=c}),98);
__d("WAWebStatusNotificationUtils",["fbt","WAWebModalManager","WAWebMsgGetters","WAWebStatusCollection","WAWebStatusQuotedFlowLoadable","WAWebToast.react","WAWebToastManager","react"],(function(t,n,r,o,a,i,l,s){var e,u=e||(e=r("react"));function c(e){var t=o("WAWebMsgGetters").getSender(e);if(t==null){o("WAWebToastManager").ToastManager.open(u.jsx(o("WAWebToast.react").Toast,{msg:s._(/*BTDS*/"No se encontr\u00f3 al remitente")}));return}o("WAWebStatusCollection").StatusCollection.find(t).then(function(t){var n=function(){o("WAWebToastManager").ToastManager.open(u.jsx(o("WAWebToast.react").Toast,{msg:s._(/*BTDS*/"No se encontr\u00f3 la actualizaci\u00f3n de estado")}))};o("WAWebModalManager").ModalManager.openMedia(u.jsx(o("WAWebStatusQuotedFlowLoadable").StatusQuotedFlowLoadable,{status:t,msgKey:e.id,onMsgNotFound:n,onClose:function(){return o("WAWebModalManager").ModalManager.closeMedia()}}),{transition:"quoted-status-modal"})})}l.openStatusViewer=c}),226);
__d("WAWebHistorySyncStickers",["WABase64","WALogger","WALongInt","WATimeUtils","WAWebHistorySyncNotificationUtils","WAWebMediaTypes","WAWebRecentStickerCollectionMd","WAWebUserPrefsAppStateSync","WAWebUserPrefsTypes"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p;function _(t,n){var r;if(t.recentStickers==null){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: received empty recentStickers protobuf"])));return}o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: processing recent stickers from history. total of "," stickers received."])),t.recentStickers.length);var a=t.recentStickers.map(function(e){var t,n=e.fileSha256;if(n==null)return o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: Got an empty filehash from initial sticker history"]))),null;var r=e.fileEncSha256,a=e.mediaKey;return(r==null||a==null)&&(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: Got an empty fileEncSha256 or mediaKey from initial sticker history"]))),o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: Got an empty fileEncSha256 or mediaKey from initial sticker history with filehash ",""])),o("WABase64").encodeB64(n))),[{id:o("WABase64").encodeB64(n),directPath:e.directPath,filehash:o("WABase64").encodeB64(n),encFilehash:r!=null?o("WABase64").encodeB64(r):null,mediaKey:a!=null?o("WABase64").encodeB64(a):"",mediaKeyTimestamp:o("WATimeUtils").unixTime(),width:e.width,height:e.height,mimetype:e.mimetype,type:o("WAWebMediaTypes").OUTWARD_TYPES.STICKER,index:0,weight:e.weight},(t=o("WALongInt").maybeNumberOrThrowIfTooLarge(e.lastStickerSentTs))!=null?t:0,null]}).filter(Boolean);o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: "," stickers need to be added after sticker construction."])),a.length),o("WAWebRecentStickerCollectionMd").RecentStickerCollectionMd.replaceAndEnqueue(a,!0),o("WAWebUserPrefsAppStateSync").setNonCriticalDataSyncStatus((r={},r[o("WAWebUserPrefsTypes").NonCriticalDataSyncStatusType.RECENT_STICKER_INITIALIZED]=o("WAWebUserPrefsTypes").RecentStickerInitializedStatusType.SUCCESS,r)),o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Recent Stickers completed, ",""])),o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(n))}l.processRecentStickers=_}),98);
__d("WAWebStickerUtils",["$InternalEnum","Promise","WABase64UrlSafe","WACryptoSha256","WALogger","WAPromiseProps","WAWebABProps","WAWebFeatureDetectionDetectWebpSupport","WAWebInMemoryLottieStickerCache","WAWebMediaDataUtils","WAWebMediaMmsV4Download","WAWebStickerMetadataParsing","WAWebStickerMimeUtils","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g="metadata",h="customProps",y=512,C=512,b="196",v="MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEM5mGNNmQ2U6CxBER9IwHd9qtcshk9JKsRv9Ljq6/yPW9v35AKwmAiocRH2YWMjnacj4luB3xp6h+4XxoML/KXQ==";function S(e){var t=(4-e.length%4)%4;return e+"=".repeat(t)}function R(e){return S(o("WABase64UrlSafe").urlSafeBase64(e))}function L(e,t){var n=R(e),r=R(t);return n===r}function E(e,t){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WABase64UrlSafe").urlSafeBase64ToStandard(e),r=S(n),a=o("WABase64UrlSafe").getBytesFromBase64(r),i=new TextEncoder().encode(t).buffer,l=o("WABase64UrlSafe").getBytesFromBase64(v),s=yield crypto.subtle.importKey("spki",l,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),u=yield crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},s,a,i);return u}),k.apply(this,arguments)}var I=n("$InternalEnum").Mirrored(["WEBP","LOTTIE"]);function T(e){return o("WAWebStickerMimeUtils").WhatsAppLottieStickerMimeType===e?I.LOTTIE:I.WEBP}function D(t){if(t==null)return o("WAWebStickerMetadataParsing").DEFAULT_STICKER_METADATA;try{var n,r,a=(n=(r=t[g])==null?void 0:r[h])!=null?n:{};return o("WAWebStickerMetadataParsing").toStickerMetadata(a)}catch(t){return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["extractMetaDataFromLottieSticker: Failed to parse metadata out of lottie sticker, returning default metadata."]))).devConsole(t),o("WAWebStickerMetadataParsing").DEFAULT_STICKER_METADATA}}function x(e,t){return $.apply(this,arguments)}function $(){return $=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(T(e.type)===I.LOTTIE){var r=t.filehash;if(r!=null){var a=o("WAWebInMemoryLottieStickerCache").InMemoryLottieStickerCache.get(r);a==null&&(a=yield o("WAWebInMemoryLottieStickerCache").extractAndSetLottieJSONInMemoryCache(r,e));var i=D(a);return(f||(f=n("Promise"))).resolve(babelHelpers.extends({},i,{size:e.size,fullWidth:y,fullHeight:C}))}}return o("WAWebFeatureDetectionDetectWebpSupport").detectWebpSupport().then(function(t){return t?o("WAPromiseProps").promiseProps({widthHeight:o("WAWebMediaDataUtils").getImageWidthHeightNoOpaque(e),webpData:o("WAWebMediaDataUtils").parseWebpNoOpaque(e)}).then(function(t){return{fullWidth:t.widthHeight.width,fullHeight:t.widthHeight.height,animationDuration:t.webpData.animationDuration,firstFrameLength:t.webpData.firstFrameLength,singleLoopDuration:t.webpData.singleLoopDuration,emojis:t.webpData.emojis,isAnimated:t.webpData.animationDuration>0,size:e.size,isFirstParty:t.webpData.isFirstParty,isFromStickerMaker:t.webpData.isFromStickerMaker,stickerPackId:t.webpData.stickerPackId,stickerPackName:t.webpData.stickerPackName,stickerPackPublisher:t.webpData.stickerPackPublisher,isAvatar:t.webpData.isAvatar,isAiSticker:t.webpData.isAiSticker,stickerMakerSourceType:t.webpData.stickerMakerSourceType,accessibilityLabel:t.webpData.accessibilityLabel}}):o("WAWebMediaDataUtils").parseWebpNoOpaque(e).then((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.animationDuration,r=t.firstFrameLength,a=t.singleLoopDuration,i=t.emojis,l=t.isFirstParty,s=t.isFromStickerMaker,u=t.stickerPackId,c=t.stickerPackName,d=t.stickerPackPublisher,m=t.isAvatar,p=t.isAiSticker,_=t.stickerMakerSourceType,f=t.accessibilityLabel;if(n>0)return{animationDuration:n,firstFrameLength:r,singleLoopDuration:a,emojis:i,isAnimated:!0,size:e.size,isFirstParty:l,isFromStickerMaker:s,stickerPackId:u,stickerPackName:c,stickerPackPublisher:d,isAvatar:m,isAiSticker:p,stickerMakerSourceType:_,accessibilityLabel:f};var g=yield o("WAWebMediaDataUtils").decodeWebpToRGBANoOpaque(e);return{animationDuration:n,rgbaBuffer:g.rgbaBuffer,rgbaWidth:g.width,rgbaHeight:g.height,emojis:i,isAnimated:!1,size:e.size,isFirstParty:l,isFromStickerMaker:s,stickerPackId:u,stickerPackName:c,stickerPackPublisher:d,isAvatar:m,isAiSticker:p,stickerMakerSourceType:_,accessibilityLabel:f}});return function(e){return t.apply(this,arguments)}})())})}),$.apply(this,arguments)}function P(e){return e.replaceAll(/\s+/g,"")}function N(e,t){return M.apply(this,arguments)}function M(){return M=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=new Blob([e],{type:o("WAWebStickerMimeUtils").WhatsAppLottieStickerMimeType}),a=yield o("WAWebMediaMmsV4Download").extractLottieJSON(n,t);if(a==null)throw r("err")("Failed to extract lottie json from zipped sticker");var i=yield w(a);return i}),M.apply(this,arguments)}function w(e){return A.apply(this,arguments)}function A(){return A=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=W(e,g),n=yield F(t);return n}),A.apply(this,arguments)}function F(e){return O.apply(this,arguments)}function O(){return O=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=new TextEncoder,n=t.encode(e).buffer,r=yield o("WACryptoSha256").sha256Base64(n);return r}),O.apply(this,arguments)}var B=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=/animation\/animation.json.trust_token$/,r=Object.keys(e).find(function(e){return n.test(e)});if(r==null)return!1;var a=e[r];try{var i=new TextDecoder("utf-8"),l=i.decode(a),f=l.split(".");if(f.length!==3)return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Failed to verify Lottie trust token JWT: invalid number of parts"]))),!1;var g=f[1],h=o("WABase64UrlSafe").urlSafeBase64ToStandard(g),y=JSON.parse(atob(h)),C=(y==null?void 0:y.sticker_file_type)==="lottie_json"&&(y==null?void 0:y.sticker_file_trusted_origin)==="whatsapp";if(!C)return o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Failed to verify Lottie trust token JWT: payload is invalid"]))),!1;var v=y==null?void 0:y.sticker_file_sha256;if(!v)return o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Failed to verify Lottie trust token JWT: sticker_file_sha256 is missing"]))),!1;var S=yield F(t);if(!L(S,v))return o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Failed to verify Lottie trust token JWT: file hash does not match"]))),!1;var R=f[0],k=o("WABase64UrlSafe").urlSafeBase64ToStandard(R),I=JSON.parse(atob(k));if((I==null?void 0:I.kid)!==b)return o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Failed to verify Lottie trust token JWT: invalid kid in header"]))),!1;var T=f[2],D=R+"."+g,x=yield E(T,D);return x?!0:(o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Failed to verify Lottie trust token JWT: invalid signature"]))),!1)}catch(e){return o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Failed to verify Lottie trust token JWT ",""])),e),!1}});return function(n,r){return e.apply(this,arguments)}})();function W(e,t){var n=P(e);try{var o=JSON.parse(n);return delete o[t],JSON.stringify(o)}catch(e){throw r("err")("removeKeyFromString: Failed to parse lottie json "+e)}}function q(){var e={},t=o("WAWebABProps").getABPropConfigValue("gimmick_phase_two_data_suffix"),n=new URLSearchParams(t);return n.forEach(function(t,n){e[n]=t}),e}l.METADATA_OBJECT=g,l.LOTTIE_STICKER_FULL_WIDTH=y,l.LOTTIE_STICKER_FULL_HEIGHT=C,l.StickerFileType=I,l.getStickerFileType=T,l.extractMetaDataFromLottieSticker=D,l.parseStickerMetadata=x,l.removeSpacesAndEmptyLines=P,l.getLottieStickerFilehashFromZippedStickerBuffer=N,l.calculateLottieStickerFilehashWithoutMetadata=w,l.calculateLottieStickerFilehash=F,l.isLottieStickerFirstParty=B,l.removeKeyFromString=W,l.getStickerFetchParamsFromABConfig=q}),98);
__d("WAWebWamEnumQueryType",[],(function(t,n,r,o,a,i){var e=Object.freeze({STICKER_STORE_DATA:0,PREVIEW_IMAGE_DOWNLOAD:1,STICKER_PACK_DATA:2,STICKER_SEARCH:3,DISCOVERY_PACK:4});i.QUERY_TYPE=e}),66);
__d("WAWebStickerCommonQueryToStaticServerWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumQueryType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({StickerCommonQueryToStaticServer:[2740,{httpResponseCode:[2,e.TYPES.INTEGER],params:[3,e.TYPES.STRING],queryLatencyMs:[4,e.TYPES.TIMER],queryType:[1,o("WAWebWamEnumQueryType").QUERY_TYPE]},[1,1,1],"regular"]},{StickerCommonQueryToStaticServer:[]});l.StickerCommonQueryToStaticServerWamEvent=s}),98);
__d("WAWebFetchFirstPartyStickerPacksAction",["WAWebL10N","WAWebL10NCountryCodes","WAWebMiscErrors","WAWebPonyfillsFetch","WAWebPonyfillsUrlSearchParams","WAWebStickerCommonQueryToStaticServerWamEvent","WAWebStickerUtils","WAWebURLUtils","WAWebUserPrefsMeUser","WAWebWamEnumQueryType","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e="https://static.whatsapp.net/sticker";function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var a=o("WAWebStickerUtils").getStickerFetchParamsFromABConfig(),i=babelHelpers.extends({},a,t),l=r("WAWebURLUtils").build(e,i),s=new(o("WAWebStickerCommonQueryToStaticServerWamEvent")).StickerCommonQueryToStaticServerWamEvent;s.startQueryLatencyMs();var u=yield r("WAWebPonyfillsFetch")(l,{signal:n.signal});if(s.markQueryLatencyMs(),s.set({httpResponseCode:u.status,params:new(r("WAWebPonyfillsUrlSearchParams"))(i).toString(),queryType:o("WAWebWamEnumQueryType").QUERY_TYPE.STICKER_PACK_DATA}),s.commit(),!u.ok)throw new(o("WAWebMiscErrors")).InvalidServerResponseError(l,u.status.toString(),"Invalid response from WhatsApp stickers endpoint");var c=yield u.json();if(c==null||c.length===0)throw new(o("WAWebMiscErrors")).InvalidServerResponseError(l,u.status.toString(),"Invalid response from WhatsApp stickers endpoint: "+JSON.stringify(c));return c}),u.apply(this,arguments)}function c(e,t){var n={id:e["sticker-pack-id"],name:e.name,publisher:e.publisher,description:e.description,fileSize:Number(e["file-size"]),imageDataHash:e["image-data-hash"],animated:e.animated===1,previewImageIds:e["preview-image-ids"],trayImageId:e["tray-image-id"],trayImagePreview:e["tray-image-preview"],index:t!=null?t:0};return n}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=r("WAWebL10N").getNormalizedLocale(),a=o("WAWebL10NCountryCodes").getCountryShortcodeByPhone((t=o("WAWebUserPrefsMeUser").getMaybeMePnUser())==null?void 0:t.user)||"default",i={cat:"sticker_store_data",id:"all",lg:n,country:a},l=yield s(i,{signal:e.signal});return l.map(function(e,t){return c(e,t)})}),m.apply(this,arguments)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=r("WAWebL10N").getNormalizedLocale(),n={cat:"sticker_pack_data",id:e.id,lg:t},o=yield s(n,{signal:e.signal}),a=o[0];return c(a)}),_.apply(this,arguments)}l.fetchFirstPartyStickerPacks=d,l.fetchFirstPartyStickerPack=p}),98);
__d("WAWebFetchFirstPartyStickersAction",["WAWebL10N","WAWebMiscErrors","WAWebPonyfillsFetch","WAWebPonyfillsUrlSearchParams","WAWebStickerCommonQueryToStaticServerWamEvent","WAWebStickerUtils","WAWebURLUtils","WAWebWamEnumQueryType","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e="https://static.whatsapp.net/sticker";function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var a=o("WAWebStickerUtils").getStickerFetchParamsFromABConfig(),i=babelHelpers.extends({},a,{cat:"sticker_pack_data",id:t,lg:r("WAWebL10N").getNormalizedLocale()}),l=r("WAWebURLUtils").build(e,i),s=new(o("WAWebStickerCommonQueryToStaticServerWamEvent")).StickerCommonQueryToStaticServerWamEvent;s.startQueryLatencyMs();var u=yield r("WAWebPonyfillsFetch")(l,{signal:n==null?void 0:n.signal});if(s.markQueryLatencyMs(),s.set({httpResponseCode:u.status,params:new(r("WAWebPonyfillsUrlSearchParams"))(i).toString(),queryType:o("WAWebWamEnumQueryType").QUERY_TYPE.STICKER_PACK_DATA}),s.commit(),!u.ok)throw new(o("WAWebMiscErrors")).InvalidServerResponseError(l,u.status.toString(),"Invalid response from WhatsApp stickers endpoint");var c=yield u.json();if(c==null||c.length===0)throw new(o("WAWebMiscErrors")).InvalidServerResponseError(l,u.status.toString(),"Invalid response from WhatsApp stickers endpoint: "+JSON.stringify(c));return c[0].stickers.map(function(e,t){return{mimetype:e.mimetype,width:e.width,height:e.height,index:t,filehash:e["file-hash"],directPath:e["direct-path"],mediaKey:e["media-key"],id:e["file-hash"],deprecatedMms3Url:e.url,encFilehash:e["enc-file-hash"],mediaKeyTimestamp:0}})}),u.apply(this,arguments)}l.fetchFirstPartyStickers=s}),98);
__d("WAWebLinkDevicePhoneNumberEntryInputFormatUtils",["WACcToIso","WAIsoToCc","WALogger","WAPhoneFindCC","WAPhoneUtils"],(function(t,n,r,o,a,i,l){var e;function s(e){var t=e.countryCodeIso,n=e.phoneNumberWithoutCountryCode;if(t==null)return u(n);var a=r("WAIsoToCc")[t],i=o("WAPhoneUtils").compileCountryRegexes(String(a));if(i==null)return null;var l=_(""+r("WAIsoToCc")[t]+n),s=l.phoneNumberWithoutCountryCode,p=c(i),f=Math.max.apply(Math,p);if(s.length>f)return u(s);var g=p.filter(function(e){return e>=s.length}).map(function(e){return d(s,e)});for(var h of i.formats){var y=h.testAndFormat(s);if(y!=null)return{formattedInputValue:y,placeholder:""};for(var C of g){var b=h.testAndFormat(C);if(b!=null)return m({phoneNumberWithoutCountryCode:s,formattedPaddedNumber:b})}}return u(s)}function u(e){return{formattedInputValue:e,placeholder:""}}function c(e){var t=e.lengths;return typeof t=="number"?[t]:t.sort(function(e,t){return e-t})}function d(e,t){return e+"_".repeat(t-e.length)}function m(e){var t=e.phoneNumberWithoutCountryCode,n=e.formattedPaddedNumber;if(t==="")return{formattedInputValue:"",placeholder:n};var r=Array.from(n.matchAll(/\d/g)),o=r.pop().index,a=o+1;return{formattedInputValue:n.substr(0,a),placeholder:n.substr(a)}}function p(e,t){var n=o("WAPhoneUtils").compileCountryRegexes(String(e));return n==null?!1:n.formats.some(function(e){return e.testAndFormat(t)!=null})}function _(e){var t=e.replaceAll(/[^\d]/g,""),n=f(t),o=t;if(n!=null){var a=r("WAIsoToCc")[n];o=o.replace(new RegExp("^"+a),"")}return{countryCodeIso:n,phoneNumberWithoutCountryCode:o,fullRawPhoneNumber:t}}function f(e){var t=o("WAPhoneFindCC").findCC(e);return r("WACcToIso")[parseInt(t,10)]}function g(t,n,r){var a=f(t);a!==n&&o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[compareCountryCodeOutput] Country code mismatch in ",""])),r).sendLogs("country-code-mismatch",{sampling:.01})}function h(e,t,n){if(t==null){var r=e?"+":"";return""+r+n}return"+"+t+" "+n}l.formatPhoneNumberInput=s,l.isPhoneNumberValid=p,l.cleanPhoneNumberInputValue=_,l.getCountryCodeIso=f,l.compareCountryCodeOutput=g,l.getFullFormattedInputValue=h}),98);
__d("WAWebMediaHostsUtil",["WAWebMediaHosts","asyncToGeneratorRuntime","lodash"],(function(t,n,r,o,a,i,l){var e="https://static.whatsapp.net",s=r("lodash").memoize(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield o("WAWebMediaHosts").mediaHosts.getHostsInfoByBucket({preferredBuckets:[1]}),n=t.selectedHost;return n!=null?"https://"+n.hostname:e}));l.getStaticMediaHostName=s}),98);
__d("WAWebSearchFirstPartyStickersAction",["WAWebCurrentUser","WAWebL10NCountryCodes","WAWebLinkDevicePhoneNumberEntryInputFormatUtils","WAWebMediaHostsUtil","WAWebMiscErrors","WAWebPonyfillsFetch","WAWebPonyfillsUrlSearchParams","WAWebStickerCommonQueryToStaticServerWamEvent","WAWebStickerModel","WAWebStickerUtils","WAWebURLUtils","WAWebUserPrefsMeUser","WAWebWamEnumQueryType","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=250,s="https://static.whatsapp.net",u="/sticker",c="/wa/static/sticker";function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var a,i=(a=o("WAWebUserPrefsMeUser").getMaybeMePnUser())==null?void 0:a.user,l=o("WAWebL10NCountryCodes").getCountryShortcodeByPhone(i);o("WAWebCurrentUser").isEmployee()&&i!=null&&o("WAWebLinkDevicePhoneNumberEntryInputFormatUtils").compareCountryCodeOutput(i,l,"searchFirstPartyStickers");for(var d=l||"default",m=0,p=0;m<=e;)m+=3+encodeURIComponent(t[p++]).length;var _=t.slice(0,p-1).join(","),f={country:d},g=yield o("WAWebMediaHostsUtil").getStaticMediaHostName(),h=g===s?""+g+u:""+g+c,y=o("WAWebStickerUtils").getStickerFetchParamsFromABConfig(),C=r("WAWebURLUtils").build(h,babelHelpers.extends({},y,{cat:"sticker_search",terms:_,_nc_cat:1},f)),b=new(o("WAWebStickerCommonQueryToStaticServerWamEvent")).StickerCommonQueryToStaticServerWamEvent;b.startQueryLatencyMs();var v=yield r("WAWebPonyfillsFetch")(C,{signal:n==null?void 0:n.signal});if(b.markQueryLatencyMs(),b.set({httpResponseCode:v.status,params:new(r("WAWebPonyfillsUrlSearchParams"))(f).toString(),queryType:o("WAWebWamEnumQueryType").QUERY_TYPE.STICKER_SEARCH}),b.commit(),!v.ok)throw new(o("WAWebMiscErrors")).InvalidServerResponseError(C,v.status.toString(),"Invalid response from WhatsApp stickers endpoint");var S=yield v.json();if(S==null)throw new(o("WAWebMiscErrors")).InvalidServerResponseError(C,v.status.toString(),"Invalid response from WhatsApp stickers endpoint: "+JSON.stringify(S));return S.map(function(e,t){return new(o("WAWebStickerModel")).StickerModel({mimetype:e.mimetype,width:e.width,height:e.height,filehash:e["file-hash"],directPath:e["direct-path"],mediaKey:e["media-key"],id:e["file-hash"],encFilehash:e["enc-file-hash"],mediaKeyTimestamp:0,index:t})})}),m.apply(this,arguments)}l.searchFirstPartyStickers=d}),98);
__d("WAWebFavoriteStickerModel",["WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.sticker=o("WAWebBaseModel").prop(),t.timestamp=o("WAWebBaseModel").prop(),t.stickerHashWithoutMeta=o("WAWebBaseModel").prop(),t.isFavorite=o("WAWebBaseModel").prop(),t.deviceId=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="favoriteSticker";var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebWebpCalculateWebpFilehashWithoutMetadata",["WACryptoSha256","WAWebWebp"],(function(t,n,r,o,a,i,l){function e(e){var t,n=new Uint8Array(e),r=(t=o("WAWebWebp").findWebpChunk(n,o("WAWebWebp").Chunk.EXIF))!=null?t:o("WAWebWebp").findWebpChunk(n,o("WAWebWebp").Chunk.XMP);if(r==null)return o("WACryptoSha256").sha256Base64(e);var a=n.slice(0,r.position),i=a.byteLength-o("WAWebWebp").CHUNK_HEADER_SIZE;return a.set(o("WAWebWebp").numberToLittleEndian(i),o("WAWebWebp").FOUR),o("WACryptoSha256").sha256Base64(a)}l.default=e}),98);
__d("WAWebFavoriteStickerCollection",["Promise","WABaseGlobals","WAJids","WALogger","WAWebABProps","WAWebBaseCollection","WAWebFavoriteStickerModel","WAWebIdleTaskRunner","WAWebMediaAutoDownloadQueue","WAWebMediaStore","WAWebSchemaFavoriteStickers","WAWebStickerModel","WAWebStickerUtils","WAWebWebpCalculateWebpFilehashWithoutMetadata","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f;function g(e,t){return e.timestamp<t.timestamp?1:-1}var h=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t._comparator=function(e,t){return g(e,t)},babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);h.model=r("WAWebFavoriteStickerModel");var y=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,e._comparator=function(e,t){return g(e,t)},e._emojiToCollection=new Map,e._hasInitializedFromCache=!1,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.add=function(n,r){var e=t.prototype.add.call(this,n,r),a=o("WAWebABProps").getABPropConfigValue("web_autodownload_stickers");if(a)for(var i of e){if(!i)break;this._enqueueStickerAutoDownload(i)}return e},i._enqueueStickerAutoDownload=function(t){o("WAWebMediaAutoDownloadQueue").AutoDownloadQueue.enqueue(t.sticker,o("WAWebMediaAutoDownloadQueue").AutoDownloadTypes.MEDIA)},i.remove=function(n,r){return t.prototype.remove.call(this,n,r)},i.reset=function(){t.prototype.reset.call(this)},i._addSaveTask=function(){var e=this;(!this._idleTaskId||!o("WAWebIdleTaskRunner").IdleCallbackTasks.isInQueue(this._idleTaskId))&&(this._idleTaskId=o("WAWebIdleTaskRunner").IdleCallbackTasks.enqueue(function(){e._saveToDb()}))},i._saveToDb=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=this.toArray().map(function(e){var t=e.sticker.toDbData();return{id:e.id,timestamp:e.timestamp,sticker:{index:t.index,width:t.width,height:t.height,size:t.size,mimetype:t.mimetype,filehash:t.filehash,directPath:t.directPath,mediaKey:t.mediaKey,mediaKeyTimestamp:t.mediaKeyTimestamp,encFilehash:t.encFilehash,deprecatedMms3Url:t.deprecatedMms3Url,type:"sticker"},stickerHashWithoutMeta:e.stickerHashWithoutMeta,isFavorite:e.isFavorite,deviceId:e.deviceId}});o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Favorite Stickers: need to save stickers in DB with length: ",""])),t.length);try{var n=o("WAWebSchemaFavoriteStickers").getFavoriteStickersTable(),r=yield n.count();o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Favorite Stickers: before save, stickers in DB with length: ",""])),r),yield n.clear(),yield n.bulkCreateOrReplace(t),r=yield n.count(),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Favorite Stickers: after save, stickers in DB with length: ",""])),r)}catch(e){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["FavoriteStickerCollection attempt to save to database failed"]))).devConsole(e).sendLogs(e)}});function r(){return t.apply(this,arguments)}return r})(),i._dbDataToModel=function(t){return new(r("WAWebFavoriteStickerModel"))({id:t.id,timestamp:t.timestamp,stickerHashWithoutMeta:t.stickerHashWithoutMeta,sticker:new(o("WAWebStickerModel")).StickerModel(t.sticker)})},i._getStickerHashWithoutMeta=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WAWebMediaStore").LruMediaStore.get(e);if(n==null)return e;var a=o("WAWebStickerUtils").getStickerFileType(t);return a===o("WAWebStickerUtils").StickerFileType.LOTTIE?o("WAWebStickerUtils").getLottieStickerFilehashFromZippedStickerBuffer(n,e):r("WAWebWebpCalculateWebpFilehashWithoutMetadata")(n)});function t(t,n){return e.apply(this,arguments)}return t})(),i.addOrUpdateStickers=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a){var i=this;a===void 0&&(a=o("WAJids").interpretAsNumber(o("WAJids").extractDeviceId(o("WABaseGlobals").getMyDeviceJid())));var l=e.filter(function(e){return!i.get(e.id)});if(o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Favorite Stickers: length of stickers will be enqueued: ",""])),e.length),l.length!==0){var s=yield(f||(f=n("Promise"))).all(l.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return new(r("WAWebFavoriteStickerModel"))({id:e.filehash,sticker:e,stickerHashWithoutMeta:yield i._getStickerHashWithoutMeta(e.filehash,e.mimetype),timestamp:t,isFavorite:!0,deviceId:a})});return function(t){return e.apply(this,arguments)}})()));this.addAndSort(s),this._hasInitializedFromCache&&(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Favorite Stickers: need to save collection to DB."]))),this._addSaveTask())}});function t(t,n,r){return e.apply(this,arguments)}return t})(),i.addAndSort=function(t){this.add(t),this.sort()},i.removeAndSave=function(t,n){n===void 0&&(n={});var e=this.remove(t,n);return e.length&&(o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Favorite Stickers: length of stickers will be removed: ",""])),e.length),this._addSaveTask()),e},i.initializeFromCache=function(t){var e=this;o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Favorite Stickers: need to initialize stickers from DB with length: ",""])),t.length);var n=t.map(function(t){return e._dbDataToModel(t)});this.addAndSort(n);var r=this.toArray();if(r.length>0){var a=new Set(n.map(function(e){return e.id}));r.some(function(e){return!a.has(e.id)})&&this._addSaveTask()}this._hasInitializedFromCache=!0},i.updateFavoriteStickerWithNewSticker=function(t,n){var e=this.get(t);e!=null&&(e.sticker=new(o("WAWebStickerModel")).StickerModel(n.toDbData()),this.set([e],{remove:!1,add:!1,silent:!0,sort:!1}),this._addSaveTask())},i.getSuggestionsFromEmoji=function(t){var e;return(e=this._emojiToCollection.get(t))==null?void 0:e.map(function(e){return e.sticker})},a})(o("WAWebBaseCollection").BaseCollection);y.model=r("WAWebFavoriteStickerModel");var C=new y;l.FavoriteStickerCollection=C}),98);
__d("WAWebRecentStickerCollection",["WALogger","WANullthrows","WAWebBaseCollection","WAWebConnModel","WAWebMobilePlatforms","WAWebStickerModel","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=32,u=(function(t){function a(){for(var e,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a))||this,e._comparator=function(t,n){return o("WAWebConnModel").Conn.platform===o("WAWebMobilePlatforms").PLATFORMS.ANDROID?e._getWeight(n)-e._getWeight(t):t.index>n.index?1:-1},e._syncStatus="NONE",e._weightMap=new Map,e._sortTrimScale=function(){var t=e.length;if(t){if(e.sort(),t>s){for(var n=s;n<t;n++)e._weightMap.delete(r("WANullthrows")(e.at(n)).id);e.remove(e.slice(s))}var o=e.head(),a=e.last();o&&a&&e._getWeight(o)<10&&e._getWeight(a)>.01||e.forEach(function(n,r){e._weightMap.set(n.id,1+3*((t-r)/t))})}},babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i._getWeight=function(t){return r("WANullthrows")(this._weightMap.get(t.id))},i.enqueue=function(t){t.length!==0&&(o("WAWebConnModel").Conn.platform===o("WAWebMobilePlatforms").PLATFORMS.ANDROID?this._enqueueAndroid(t):this._enqueueiOS(t))},i.addStickerWithMediaData=function(t){var e=new(o("WAWebStickerModel")).StickerModel(t);e.id||(e.id=e.filehash),this.enqueue([e])},i._enqueueAndroid=function(t){var e=this;t.forEach(function(t){e.get(t.id)||(e._weightMap.set(t.id,0),e.add(t)),e.forEach(function(n){var r=e._getWeight(n);n.id===t.id?r+=1:r*=.9,e._weightMap.set(n.id,Math.round(1e3*r)/1e3)})}),this._sortTrimScale()},i._enqueueiOS=function(t){var e=this;this.forEach(function(e,t){e.index=s+t});var n=new Set(t.map(function(e){return e.id})),r=t.reduce(function(e,t){return n.has(t.id)?(n.delete(t.id),[t].concat(e)):e},[]).slice(0,s);r.forEach(function(t,n){var r=e.get(t.id);r?r.index=n:e.add({id:t.id,deprecatedMms3Url:t.deprecatedMms3Url,directPath:t.directPath,filehash:t.filehash,encFilehash:t.encFilehash,mediaKey:t.mediaKey,mediaKeyTimestamp:t.mediaKeyTimestamp,width:t.width,height:t.height,size:t.size,mimetype:t.mimetype,type:t.type,index:n})}),this.sort(),this.remove(this.slice(s))},i.sync=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield this._sync()});function t(){return e.apply(this,arguments)}return t})(),i._sync=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(this._syncStatus!=="INPROGRESS"){this._syncStatus="INPROGRESS";try{yield this.findQuery({},{set:!0}),this.sort(),this._syncStatus="SUCCESS"}catch(t){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["collection:recent_sticker:_sync error "]))).devConsole(t),this._syncStatus="FAILURE"}}});function r(){return t.apply(this,arguments)}return r})(),i.isSynced=function(){return this._syncStatus==="SUCCESS"||this._syncStatus==="FAILURE"},i.reset=function(){return this._syncStatus="NONE",this._weightMap.clear(),t.prototype.reset.call(this)},a})(o("WAWebBaseCollection").BaseCollection);u.model=o("WAWebStickerModel").StickerModel;var c=new u;l.RecentStickerCollection=c}),98);
__d("WAWebRecentStickerModel",["WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.sticker=o("WAWebBaseModel").prop(),t.timestamp=o("WAWebBaseModel").prop(),t.msgId=o("WAWebBaseModel").prop(),t.weight=o("WAWebBaseModel").prop(),t.isNewSticker=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="recentSticker";var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebRecentStickerCollectionMd",["WALogger","WATimeUtils","WAWebABProps","WAWebBaseCollection","WAWebIdleTaskRunner","WAWebMediaAutoDownloadQueue","WAWebMediaStorage","WAWebMsgCollection","WAWebRecentStickerModel","WAWebSchemaRecentStickers","WAWebStickerModel","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C=32,b=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,e._hasInitializedFromCache=!1,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.remove=function(n,r){return t.prototype.remove.call(this,n,r)},i.add=function(n,r){var e=t.prototype.add.call(this,n,r),a=o("WAWebABProps").getABPropConfigValue("web_autodownload_stickers");if(a)for(var i of e){if(!i)break;this._enqueueStickerAutoDownload(i)}return e},i._enqueueStickerAutoDownload=function(t){o("WAWebMediaAutoDownloadQueue").AutoDownloadQueue.enqueue(t.sticker,o("WAWebMediaAutoDownloadQueue").AutoDownloadTypes.MEDIA)},i.reset=function(){t.prototype.reset.call(this)},i._comparator=function(t,n){return t.weight!==n.weight?t.weight<n.weight?1:-1:t.timestamp<n.timestamp?1:-1},i._dbDataToModel=function(t){var e;return new(r("WAWebRecentStickerModel"))({id:t.id,timestamp:t.timestamp,msgId:t.msgId,sticker:new(o("WAWebStickerModel")).StickerModel(t.sticker),weight:(e=t.weight)!=null?e:1,isNewSticker:t.isNewSticker})},i._addSaveTask=function(){var e=this;(!this._idleTaskId||!o("WAWebIdleTaskRunner").IdleCallbackTasks.isInQueue(this._idleTaskId))&&(this._idleTaskId=o("WAWebIdleTaskRunner").IdleCallbackTasks.enqueue(function(){e._saveToDb()}))},i._saveToDb=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=this.toArray().map(function(e){var t=e.sticker.toDbData();return{id:e.id,timestamp:e.timestamp,msgId:e.msgId,weight:e.weight,sticker:{id:t.id,index:t.index,width:t.width,height:t.height,size:t.size,mimetype:t.mimetype,filehash:t.filehash,directPath:t.directPath,mediaKey:t.mediaKey,mediaKeyTimestamp:t.mediaKeyTimestamp,encFilehash:t.encFilehash,deprecatedMms3Url:t.deprecatedMms3Url,isAvatar:t.isAvatar,type:"sticker"}}});o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: need to save stickers in DB with length: ",""])),t.length);try{var n=o("WAWebSchemaRecentStickers").getRecentStickersTable(),r=yield n.count();o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: before save, stickers in DB with length: ",""])),r),yield n.clear(),yield n.bulkCreateOrReplace(t),r=yield n.count(),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: after save, stickers in DB with length: ",""])),r)}catch(e){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["RecentStickerCollection attempt to save to database failed"]))).sendLogs(e)}});function r(){return t.apply(this,arguments)}return r})(),i.addStickerWithMediaData=function(t){var e=t.mediaKey,n=t.mediaData,r=t.encFilehash,a=t.id,i=t.stickerSentTs;this.addNewSticker(new(o("WAWebStickerModel")).StickerModel(babelHelpers.extends({},n,{mediaKey:e,encFilehash:r})),a.toString(),i)},i.addNewSticker=function(t,n,r){t.id||(t.id=t.filehash);var e=this.get(t.id)==null;this.addStickersAndPersistToDB([[t.toDbData(),r!=null?r:o("WATimeUtils").unixTimeMs(),n]],e)},i.addStickersAndPersistToDB=function(t,n){var e=this;if(n===void 0&&(n=!1),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: length of stickers will be enqueued: ",""])),t.length),t.length!==0){var r=new Set(t.map(function(e){return e[0].id})),a=t.reduce(function(e,t){var n=t[0],o=t[1],a=t[2];if(r.has(n.id)){r.delete(n.id);var i=[[n,o,a]];return i.concat(e)}return e},[]),i=[],l=[];a.forEach(function(t){var r=t[0],o=t[1],a=t[2],s=e.get(r.id);if(s)s.timestamp<=o&&(s.timestamp=o),l.push(s);else{var u=e._dbDataToModel({id:r.id,timestamp:o,sticker:{id:r.id,index:r.index,width:r.width,height:r.height,size:r.size,mimetype:r.mimetype,filehash:r.filehash,directPath:r.directPath,mediaKey:r.mediaKey,mediaKeyTimestamp:r.mediaKeyTimestamp,encFilehash:r.encFilehash,deprecatedMms3Url:r.deprecatedMms3Url,isAvatar:r.isAvatar,type:"sticker"},msgId:a,weight:r.weight!=null?Number(r.weight.toFixed(2)):1,isNewSticker:n});i.push(u),l.push(u)}}),l.length>0&&(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: adjust weight and resort stickers."]))),this.adjustWeight(l),this.addAndSort(i),this._hasInitializedFromCache&&(o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: need to save collection to DB."]))),this._addSaveTask()))}},i.replaceAndEnqueue=function(t,n){if(n===void 0&&(n=!1),this.length>0){var e=this.map(function(e){return e.id});this.remove(e)}if(t.length===0){this._addSaveTask();return}this.addStickersAndPersistToDB(t,n)},i.updateDirectPath=function(t,n){var e=this.get(t);e!=null&&e.sticker?(e.sticker.directPath=n,this.set([e],{remove:!1,add:!1,silent:!0,sort:!1}),this._addSaveTask()):o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["updateDirectPaths called with a stickerId that doesn't match any in the collection"])))},i.updateStickerMediaData=function(t,n){var e=this.get(t);n==null||e==null||(n.directPath!=null&&(e.sticker.directPath=n.directPath),n.encFilehash!=null&&(e.sticker.encFilehash=n.encFilehash),n.mediaKey&&(e.sticker.mediaKey=n.mediaKey),n.mediaKeyTimestamp&&(e.sticker.mediaKeyTimestamp=n.mediaKeyTimestamp),this.set([e],{remove:!1,add:!1,silent:!0,sort:!1}),this._addSaveTask())},i.updateRecentStickerWithNewSticker=function(t,n){var e=this.get(t);e!=null&&(e.sticker=new(o("WAWebStickerModel")).StickerModel(n.toDbData()),this.set([e],{remove:!1,add:!1,silent:!0,sort:!1}),this._addSaveTask())},i.associateStickerWithMsg=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n,r=yield o("WAWebMsgCollection").MsgCollection.getMessagesById([t]),a=r.messages,i=((n=e.mediaObject)==null?void 0:n.associatedMsgs())||[];e.mediaObject&&(i.length===0||!a.some(function(e){return i.includes(e)}))&&o("WAWebMediaStorage").associateMediaWithMsg(e.mediaObject,a[a.length-1])});function t(t,n){return e.apply(this,arguments)}return t})(),i.initializeFromCache=function(t){var e=this;this._hasInitializedFromCache=!0;var n=t.map(function(t){var n=e._dbDataToModel(t);return n.msgId!=null&&e.associateStickerWithMsg(n.sticker,n.msgId),n}),r=this.toArray();if(r.length>0&&n.forEach(function(e){return e.weight=Number((e.weight*Math.pow(.9,r.length)).toFixed(2))}),this.addAndSort(n),r.length){var o=new Set(n.map(function(e){return e.id}));r.some(function(e){return!o.has(e)})&&this._addSaveTask()}},i.addAndSort=function(t){this.add(t),this.sort(),this.length>C&&this._hasInitializedFromCache&&(o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: stickers length "," is over the limit."])),this.length),this.set(this.toArray().slice(0,C)))},i.removeAndSave=function(t,n){n===void 0&&(n={});var e=this.remove(t,n);return e.length&&this._addSaveTask(),o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: stickers length "," after remove."])),this.length),e},i.removeAllRecentAvatarStickers=function(){var e=this.filter(function(e){return e.sticker.isAvatar===!0});return e.length===0?(o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: no avatar stickers found, skip removing."]))),[]):(o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: removing all "," avatar stickers."])),e.length),this.removeAndSave(e))},i.adjustWeight=function(t){var e=new Set(t.map(function(e){return e.id}));this.filter(function(t){return!e.has(t.id)}).forEach(function(e){return e.weight=Number((e.weight*.9).toFixed(2))}),t.forEach(function(e){e.isNewSticker===!0?e.isNewSticker=void 0:e.weight=Number((e.weight+1).toFixed(2))})},a})(o("WAWebBaseCollection").BaseCollection);b.model=r("WAWebRecentStickerModel");var v=new b;l.RecentStickerCollectionMd=v}),98);
__d("WAWebStickerCollection",["WAWebBaseCollection","WAWebStickerModel","err"],(function(t,n,r,o,a,i,l){var e={PENDING:"PENDING",SUCCESS:"SUCCESS",ERROR:"ERROR"},s=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.fetch=function(t){throw r("err")(this.constructor.name+".fetch is not implemented")},t})(o("WAWebBaseCollection").BaseCollection);s.model=o("WAWebStickerModel").StickerModel;var u=new s;l.FETCH_STATE=e,l.StickerCollectionImpl=s,l.StickerCollection=u}),98);
__d("WAWebStickerDownloadCollection",["WALogger","WATimeUtils","WAWebIdleTaskRunner","WAWebSchemaStickerDownload","WAWebStickerPackCollectionMd","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p=(function(t){function r(){return t.apply(this,arguments)||this}babelHelpers.inheritsLoose(r,t);var a=r.prototype;return a.addAndPersist=function(n){if(this.get(n.id)!=null){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Sticker Download: sticker pack already exists in collection"])));return}this.add(n),this.$StickerDownloadCollectionImpl$p_2()},a.removeAndPersist=function(t){var e=this.remove(t);return e.length&&(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Sticker Download: length of stickers will be removed: ",""])),e.length),this.$StickerDownloadCollectionImpl$p_2()),e},a.$StickerDownloadCollectionImpl$p_2=function(){var e=this;(!this.$StickerDownloadCollectionImpl$p_1||!o("WAWebIdleTaskRunner").IdleCallbackTasks.isInQueue(this.$StickerDownloadCollectionImpl$p_1))&&(this.$StickerDownloadCollectionImpl$p_1=o("WAWebIdleTaskRunner").IdleCallbackTasks.enqueue(function(){e.$StickerDownloadCollectionImpl$p_3()}))},a.$StickerDownloadCollectionImpl$p_3=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=this.toArray().map(function(e){return{id:e.id,timestamp:o("WATimeUtils").unixTime()}});o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Sticker Downloads: need to save sticker downloads in DB with length: ",""])),e.length);try{var t=o("WAWebSchemaStickerDownload").getStickerDownloadTable(),n=yield t.count();o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Sticker Downloads: before save, sticker downloads in DB with length: ",""])),n),yield t.clear(),yield t.bulkCreateOrReplace(e),n=yield t.count(),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Sticker Downloads: after save, sticker downloads in DB with length: ",""])),n)}catch(e){o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["StickerDownloadCollection attempt to save to database failed"]))).sendLogs(e)}});function t(){return e.apply(this,arguments)}return t})(),r})(o("WAWebStickerPackCollectionMd").StickerPackCollection),_=new p;l.StickerDownloadCollection=_}),98);
__d("WAWebStickerModel",["WALogger","WATimeUtils","WAWebABProps","WAWebBaseModel","WAWebMedia","WAWebMediaData","WAWebMediaTypes","once"],(function(t,n,r,o,a,i,l){var e,s=r("once")(function(){return new d({id:"placeholder",isPlaceholder:!0})}),u=r("once")(function(){return new d({id:"createButton",isCreateButton:!0})}),c=(function(t){function n(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.id=o("WAWebBaseModel").prop(),e.mediaData=o("WAWebBaseModel").session(),e.mediaObject=o("WAWebBaseModel").prop(),e.deprecatedMms3Url=o("WAWebBaseModel").prop(),e.directPath=o("WAWebBaseModel").prop(),e.filehash=o("WAWebBaseModel").prop(),e.height=o("WAWebBaseModel").prop(),e.index=o("WAWebBaseModel").prop(),e.mediaKey=o("WAWebBaseModel").prop(),e.mediaKeyTimestamp=o("WAWebBaseModel").prop(),e.mimetype=o("WAWebBaseModel").prop(),e.size=o("WAWebBaseModel").prop(),e.type=o("WAWebBaseModel").prop(o("WAWebMediaTypes").OUTWARD_TYPES.STICKER),e.encFilehash=o("WAWebBaseModel").prop(),e.width=o("WAWebBaseModel").prop(),e.weight=o("WAWebBaseModel").prop(),e.stickerPackId=o("WAWebBaseModel").prop(),e.stickerPackName=o("WAWebBaseModel").prop(),e.stickerPackPublisher=o("WAWebBaseModel").prop(),e.isPlaceholder=o("WAWebBaseModel").prop(),e.isCreateButton=o("WAWebBaseModel").prop(),e.isAvatar=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.initialize=function(){var e=this;t.prototype.initialize.call(this);var n=new(r("WAWebMediaData"));this.addChild("mediaData",n),o("WAWebABProps").getABPropConfigValue("web_sticker_suggestions_enable")&&this.listenTo(n,"change:emojis",function(t){t.emojis!=null&&(t.emojis.length&&e.trigger("sticker_mediaData_emojis_updated"),e.stopListening(n,"change:emojis"))}),!this.isPlaceholder&&!this.isCreateButton&&o("WAWebMedia").registerSticker(this)},a.downloadMedia=function(n){var t=this;return o("WAWebMedia").downloadStickerOrStickerPackIcon(this,"STICKER",n).catch(function(n){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["id: ",", error: ",""])),t.id,String(n.stack||n)).tags("non-sad").sendLogs("sticker-panel:sticker download failed")})},a.toDbData=function(){return{id:this.id||this.filehash,index:this.index||0,width:this.width,height:this.height,size:this.size,mimetype:this.mimetype,filehash:this.filehash,directPath:this.directPath,mediaKey:this.mediaKey,mediaKeyTimestamp:this.mediaKeyTimestamp!=null?this.mediaKeyTimestamp:o("WATimeUtils").unixTime(),encFilehash:this.encFilehash,deprecatedMms3Url:this.deprecatedMms3Url,isAvatar:this.isAvatar,type:o("WAWebMediaTypes").OUTWARD_TYPES.STICKER,weight:this.weight}},a.delete=function(){t.prototype.delete.call(this),o("WAWebMedia").deregisterSticker(this)},n})(o("WAWebBaseModel").BaseModel);c.Proxy="sticker",c.getPlaceholder=s,c.getCreateButton=u;var d=o("WAWebBaseModel").defineModel(c);d.getPlaceholder=s,l.Sticker=c,l.StickerModel=d}),98);
__d("WAWebStickerPackCollectionMd",["$InternalEnum","WAAbortError","WALogger","WATimeUtils","WAWebBaseCollection","WAWebFetchFirstPartyStickerPacksAction","WAWebL10N","WAWebStickerConstants","WAWebStickerPackModelMd","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=n("$InternalEnum").Mirrored(["INITIAL","PENDING","SUCCESS","ERROR"]),m=(function(t){function a(){var e;return e=t.call(this)||this,e.fetchState=d.INITIAL,e.packFetchState=new Map,e.$StickerPackCollection$p_1=null,e.$StickerPackCollection$p_2=new Map,e.$StickerPackCollection$p_3=null,e.$StickerPackCollection$p_4=new Map,e.listenTo(r("WAWebL10N"),"locale_change",function(){return e.$StickerPackCollection$p_5()}),e}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.$StickerPackCollection$p_5=function(){this.$StickerPackCollection$p_6(),this.reset()},i.$StickerPackCollection$p_6=function(){var e;(e=this.$StickerPackCollection$p_3)==null||e.abort(),this.$StickerPackCollection$p_3=null,this.$StickerPackCollection$p_4.forEach(function(e){return e.abort()}),this.$StickerPackCollection$p_4.clear(),this.$StickerPackCollection$p_7(),this.$StickerPackCollection$p_8(),this.$StickerPackCollection$p_1=null,this.$StickerPackCollection$p_2.clear()},i.$StickerPackCollection$p_9=function(t){t!==this.fetchState&&(this.fetchState=t,this.trigger("change:fetchState",t))},i.$StickerPackCollection$p_7=function(){this.$StickerPackCollection$p_9(d.INITIAL)},i.$StickerPackCollection$p_10=function(t,n){n!==this.packFetchState.get(t)&&(this.packFetchState.set(t,n),this.trigger("change:packFetchState",t,n))},i.$StickerPackCollection$p_8=function(){this.packFetchState.clear(),this.trigger("change:packFetchState")},i.$StickerPackCollection$p_11=function(t,n,r){var e=this;this.$StickerPackCollection$p_12(t,n,function(n,o){var a=r[o-t];if(!n)a&&e.add(a);else if(a)n.id===a.id&&(n.imageDataHash!==a.imageDataHash||n.index!==a.index)?(e.remove(n,{silent:!0}),e.add(a)):(e.remove(n),e.add(a));else for(var i=n;i;)e.remove(i),i=e.at(o)}),this.$StickerPackCollection$p_8(),this.$StickerPackCollection$p_2.clear()},i.$StickerPackCollection$p_12=function(t,n,r){for(var e=t;e<n;e++){var o=this.at(e);r(o,e)}},i.fetch=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t;if(!(this.fetchState===d.PENDING||this.fetchState===d.SUCCESS&&o("WATimeUtils").unixTime()-((t=this.$StickerPackCollection$p_1)!=null?t:0)<o("WAWebStickerConstants").STICKER_PACK_FETCH_TIMEOUT)){this.$StickerPackCollection$p_9(d.PENDING),this.$StickerPackCollection$p_1=o("WATimeUtils").unixTime(),this.$StickerPackCollection$p_3=new AbortController;try{var n=yield o("WAWebFetchFirstPartyStickerPacksAction").fetchFirstPartyStickerPacks({signal:this.$StickerPackCollection$p_3.signal}),r=Math.max(this.length,n.length);this.$StickerPackCollection$p_11(0,r,n),this.$StickerPackCollection$p_9(d.SUCCESS)}catch(t){if(this.$StickerPackCollection$p_9(d.ERROR),t.name===o("WAAbortError").ABORT_ERROR){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["First party sticker packs request cancelled"])));return}o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["First party sticker packs request failed: error: ",""])),t).sendLogs("sticker-packs-fetch-request-failed")}}});function r(){return t.apply(this,arguments)}return r})(),i.fetchStickerPack=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t;if(e&&!this.get(e)){var n=this.packFetchState.get(e),r=(t=this.$StickerPackCollection$p_2.get(e))!=null?t:0;if(!(n===d.PENDING||n===d.SUCCESS&&o("WATimeUtils").unixTime()-r<o("WAWebStickerConstants").STICKER_PACK_FETCH_TIMEOUT)){this.$StickerPackCollection$p_10(e,d.PENDING),this.$StickerPackCollection$p_2.set(e,o("WATimeUtils").unixTime());var a=new AbortController;this.$StickerPackCollection$p_4.set(e,a);try{var i=yield o("WAWebFetchFirstPartyStickerPacksAction").fetchFirstPartyStickerPack({id:e,signal:a.signal});this.$StickerPackCollection$p_10(e,d.SUCCESS),this.add(i)}catch(t){if(this.$StickerPackCollection$p_10(e,d.ERROR),t.name===o("WAAbortError").ABORT_ERROR){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["First party sticker pack request cancelled"])));return}o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["First party sticker pack request failed: error: ",""])),t).sendLogs("sticker-packs-fetch-request-failed")}}}});function t(t){return e.apply(this,arguments)}return t})(),i.delete=function(){t.prototype.delete.call(this),this.stopListening(),this.$StickerPackCollection$p_6()},a})(o("WAWebBaseCollection").BaseCollection);m.model=o("WAWebStickerPackModelMd").StickerPackModel,m.comparator=function(e,t){return e.index<t.index?-1:e.index>t.index?1:0};var p=new m;l.FetchState=d,l.StickerPackCollection=m,l.StickerPackCollectionMd=p}),98);
__d("WAWebStickerPackModel",["Promise","WALogger","WAWebBaseModel","WAWebMedia","WAWebMediaData","WAWebMediaTypes","WAWebStickerPackStickerCollection","err"],(function(t,n,r,o,a,i,l){var e,s,u,c="placeholder:",d="image/png",m=function(t){var e=t.index,n=t.page;return new _({id:""+c+e,index:e,page:n})},p=(function(t){function a(){for(var e,n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return e=t.call.apply(t,[this].concat(i))||this,e.id=o("WAWebBaseModel").prop(),e.index=o("WAWebBaseModel").prop(),e.name=o("WAWebBaseModel").prop(),e.page=o("WAWebBaseModel").prop(),e.url=o("WAWebBaseModel").prop(),e.mimetype=o("WAWebBaseModel").prop(d),e.mediaData=o("WAWebBaseModel").session(),e.mediaObject=o("WAWebBaseModel").prop(),e.directPath=o("WAWebBaseModel").prop(),e.filehash=o("WAWebBaseModel").prop(),e.mediaKey=o("WAWebBaseModel").prop(),e.mediaKeyTimestamp=o("WAWebBaseModel").prop(),e.size=o("WAWebBaseModel").prop(),e.type=o("WAWebBaseModel").prop(o("WAWebMediaTypes").OUTWARD_TYPES.IMAGE),e.encFilehash=o("WAWebBaseModel").prop(),e.deprecatedMms3Url=o("WAWebBaseModel").derived(function(){return this.isFirstParty?"":this.url},["url","isFirstParty"]),e.stickers=o("WAWebBaseModel").derived(function(){return this.$StickerPack$p_1=this.$StickerPack$p_1||new(r("WAWebStickerPackStickerCollection"))(this.id.split("#")[0],this.isFirstParty),this.$StickerPack$p_1},["id"]),e.isPlaceholder=o("WAWebBaseModel").derived(function(){return a.isPlaceholderId(this.id)},["id"]),e.isFirstParty=o("WAWebBaseModel").derived(function(){return!!this.url&&!this.mediaKey},["url","mediaKey"]),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.initialize=function(){t.prototype.initialize.call(this),!this.isPlaceholder&&!this.isFirstParty&&(this.addChild("mediaData",new(r("WAWebMediaData"))({renderableUrl:""})),o("WAWebMedia").registerStickerPackIcon(this));var n=r("err")("StickerPackModel is not initialized");o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["StickerPackModel ",""])),n).sendLogs("used-legacy-sticker-pack")},i.downloadMedia=function(){var e=this;return this.isPlaceholder||this.isFirstParty?(u||(u=n("Promise"))).resolve():o("WAWebMedia").downloadStickerOrStickerPackIcon(this,"STICKER_PACK").catch(function(t){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["id: ",", error: ",""])),e.id,String(t.stack||t)).sendLogs("sticker-panel:sticker-pack download failed")})},i.delete=function(){t.prototype.delete.call(this),o("WAWebMedia").deregisterStickerPackIcon(this)},a})(o("WAWebBaseModel").BaseModel);p.Proxy="stickerPack",p.createPlaceholder=m,p.isPlaceholderId=function(e){return new RegExp("^"+c).test(e)};var _=o("WAWebBaseModel").defineModel(p);_.createPlaceholder=m,_.isPlaceholderId=p.isPlaceholderId,l.PRE_PLACEHOLDER_ID=c,l.StickerPackModel=_}),98);
__d("WAWebStickerPackModelMd",["WAWebBaseModel","WAWebStickerPackStickerCollection"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.index=o("WAWebBaseModel").prop(),t.id=o("WAWebBaseModel").prop(),t.name=o("WAWebBaseModel").prop(),t.publisher=o("WAWebBaseModel").prop(),t.description=o("WAWebBaseModel").prop(),t.fileSize=o("WAWebBaseModel").prop(),t.imageDataHash=o("WAWebBaseModel").prop(),t.animated=o("WAWebBaseModel").prop(),t.previewImageIds=o("WAWebBaseModel").prop(),t.trayImageId=o("WAWebBaseModel").prop(),t.trayImagePreview=o("WAWebBaseModel").prop(),t.stickers=o("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){e.prototype.initialize.call(this);var t=!0;this.stickers=new(r("WAWebStickerPackStickerCollection"))(this.id,t)},n.toDBData=function(){return{id:this.id}},t})(o("WAWebBaseModel").BaseModel);e.Proxy="stickerPackMd";var s=o("WAWebBaseModel").defineModel(e);l.StickerPack=e,l.StickerPackModel=s}),98);
__d("WAWebStickerPackStickerCollection",["Promise","WATimeUtils","WAWebFetchFirstPartyStickersAction","WAWebNoop","WAWebStickerCollection","WAWebStickerConstants","WAWebStickerPackModel"],(function(t,n,r,o,a,i,l){var e,s=(function(t){function a(e,n){var r;r=t.call(this)||this,r.stickerPackId=e,r.isFirstParty=n,r._firstPartyFetchTimestamp=null;var o=a._cache[r.stickerPackId];if(o)return o||babelHelpers.assertThisInitialized(r);var i,l=r;return Object.defineProperty(r,"fetchState",{get:function(){return i},set:function(t){i!==t&&(i=t,l.trigger("change:fetchState",t))}}),r}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.fetch=function(a){var t,i=this,l=this.isFirstParty&&o("WATimeUtils").unixTime()-((t=this._firstPartyFetchTimestamp)!=null?t:0)>=o("WAWebStickerConstants").STICKER_PACK_FETCH_TIMEOUT;if((a||l)&&this.fetchState!==o("WAWebStickerCollection").FETCH_STATE.PENDING&&delete this._fetchPromise,this._fetchPromise)return this._fetchPromise;if(this.fetchState=o("WAWebStickerCollection").FETCH_STATE.PENDING,o("WAWebStickerPackModel").StickerPackModel.isPlaceholderId(this.stickerPackId))return this._fetchPromise=new(e||(e=n("Promise")))(r("WAWebNoop")),this._fetchPromise;var s;if(this.isFirstParty)this._firstPartyFetchTimestamp=o("WATimeUtils").unixTime(),s=o("WAWebFetchFirstPartyStickersAction").fetchFirstPartyStickers(this.stickerPackId);else return(e||(e=n("Promise"))).resolve();return this._fetchPromise=s.then(function(e){var t=Math.max(i.length||e.length);i._resetRange(0,t,e),i.fetchState=o("WAWebStickerCollection").FETCH_STATE.SUCCESS}).catch(function(){i.fetchState=o("WAWebStickerCollection").FETCH_STATE.ERROR}),this._fetchPromise},i._resetRange=function(t,n,r){var e=this;this._forEachInRange(t,n,function(n,o){var a=r[o-t];n?a?n.id===a.id?n.set(a):(e.remove(n),e.add(a)):e.remove(n):a&&e.add(a)})},i._forEachInRange=function(t,n,r){for(var e=t;e<n;e++){var o=this.at(e);r(o,e)}},a})(o("WAWebStickerCollection").StickerCollectionImpl);s._cache={},s.comparator=function(e,t){return e.index<t.index?-1:e.index>t.index?1:0},l.default=s}),98);
__d("WAWebStickerSearchCollection",["WALogger","WAWebBaseCollection","WAWebEmoji","WAWebEmojiKeywordToUnicode","WAWebSearchFirstPartyStickersAction","WAWebStickerModel","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u={HAPPY:["\uD83D\uDE02","\uD83E\uDD23","\uD83D\uDE00","\uD83D\uDE01","\uD83D\uDE06","\uD83D\uDE42","\uD83D\uDE07","\u263A\uFE0F","\uD83D\uDE04","\uD83D\uDE03"],LOVE:["\uD83D\uDE0D","\uD83D\uDE18","\u2764\uFE0F","\uD83D\uDC95","\uD83E\uDD70","\uD83D\uDE17","\uD83D\uDE19","\uD83D\uDE3B","\uD83D\uDC69\u200D\u2764\uFE0F\u200D\uD83D\uDC69","\uD83D\uDC90","\uD83D\uDC8C","\uD83D\uDC9B","\uD83D\uDC9A","\uD83D\uDC99","\uD83D\uDC9C","\uD83D\uDC93","\uD83D\uDC98","\uD83D\uDC8F","\uD83D\uDC91","\uD83C\uDF39","\uD83E\uDD1F","\uD83C\uDFE9"],GREETINGS:["\uD83D\uDC4B","\uD83D\uDE02","\uD83E\uDD23","\uD83D\uDE4F","\u270B","\uD83E\uDDD5","\uD83D\uDEB6\u200D\u2640\uFE0F","\uD83D\uDEB6","\uD83D\uDC60","\uD83E\uDD7E","\uD83D\uDE48","\uD83E\uDD9B","\uD83C\uDF3A","\u26A1","\uD83C\uDFAF","\uD83D\uDE84","\uD83D\uDE85","\uD83D\uDC92","\uD83D\uDED5","\uD83D\uDEE3\uFE0F","\uD83D\uDD49\uFE0F","\uD83D\uDD0A"],SAD:["\uD83D\uDE2D","\uD83D\uDE14","\uD83D\uDE22","\uD83D\uDE1E","\uD83D\uDE1F","\uD83D\uDE15","\uD83D\uDE41","\u2639\uFE0F","\uD83D\uDE16","\uD83D\uDE2B","\uD83D\uDE29","\uD83E\uDD7A","\uD83D\uDE25","\uD83D\uDE13","\uD83D\uDE2A","\uD83D\uDE3F","\uD83D\uDCA7","\uD83D\uDC94"],ANGRY:["\uD83D\uDE20","\uD83D\uDE21","\uD83D\uDE24","\uD83D\uDC7A","\uD83D\uDCA2","\uD83D\uDDEF\uFE0F","\uD83D\uDC7F"],CELEBRATE:["\uD83E\uDD73","\uD83E\uDD42","\uD83C\uDF88","\uD83C\uDF8A","\uD83C\uDF89"]},c=(function(t){function r(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,e.$StickerSearchCollectionImpl$p_1=new Map,e.$StickerSearchCollectionImpl$p_2=!1,e.$StickerSearchCollectionImpl$p_4=!0,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(r,t);var a=r.prototype;return a.isFetchingData=function(){return this.$StickerSearchCollectionImpl$p_4},a.hasFetchedData=function(){return this.$StickerSearchCollectionImpl$p_2},a.setStartFetching=function(){this.$StickerSearchCollectionImpl$p_4=!0,this.trigger("start_fetching")},a.setStopFetching=function(){this.$StickerSearchCollectionImpl$p_4=!1,this.trigger("stop_fetching")},a.search=(function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){this.$StickerSearchCollectionImpl$p_3!==n&&this.$StickerSearchCollectionImpl$p_2&&t.prototype.delete.call(this);var r=n.trim().toUpperCase();if(this.$StickerSearchCollectionImpl$p_1.has(n)){var a=this.$StickerSearchCollectionImpl$p_1.get(n);if(a!=null){this.add(a),this.$StickerSearchCollectionImpl$p_3=n;return}o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["StickerMoodCollection cache was invalid, re-searching."])))}var i=[];if(Object.prototype.hasOwnProperty.call(u,r))i.push.apply(i,u[r]);else{var l=o("WAWebEmoji").EmojiUtil.containsOnlyEmoji(r)?o("WAWebEmoji").EmojiUtil.splitEmojis(r):o("WAWebEmojiKeywordToUnicode").emojiKeywordToUnicodeSearch(r);if(l==null||l.length===0){this.$StickerSearchCollectionImpl$p_3=n,this.setStopFetching(),t.prototype.delete.call(this);return}i.push.apply(i,l)}this.setStartFetching();var c=[];try{c=yield o("WAWebSearchFirstPartyStickersAction").searchFirstPartyStickers(i)}catch(e){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Sticker search request failed: error: ",""])),e).sendLogs("sticker-search-request-failed"),this.setStopFetching();return}this.$StickerSearchCollectionImpl$p_1.set(n,c),this.$StickerSearchCollectionImpl$p_2=!0,this.$StickerSearchCollectionImpl$p_3=n,this.add(c),this.setStopFetching()});function a(e){return r.apply(this,arguments)}return a})(),a.searchMood=function(t){return this.search(t)},a.delete=function(){t.prototype.delete.call(this),this.$StickerSearchCollectionImpl$p_1=new Map,this.$StickerSearchCollectionImpl$p_2=!1,this.$StickerSearchCollectionImpl$p_4=!1},r})(o("WAWebBaseCollection").BaseCollection);c.model=o("WAWebStickerModel").StickerModel;var d=new c;l.StickerSearchCollection=d}),98);
__d("WAWebTextStatusCollection",["fbt","WAWebBaseCollection","WAWebStatusContactAction","WAWebTextStatusModel","WAWebWid","WAWebWidFactory"],(function(t,n,r,o,a,i,l,s){var e=(function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a))||this,t.findImpl=function(e){var t=e instanceof r("WAWebWid")?o("WAWebWidFactory").asUserWidOrThrow(e):o("WAWebWidFactory").createUserWidOrThrow(e);return o("WAWebStatusContactAction").getStatus(t)},babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=r("WAWebTextStatusModel"),e.idClass=r("WAWebWid"),e.staleCollection=!0;function u(){return s._(/*BTDS*/"\u00a1Hola! Estoy usando WhatsApp.").toString()}var c=new e;l.getDefaultTextStatus=u,l.TextStatusCollection=c}),226);
__d("WAWebTextStatusModel",["WAWebBaseModel","WAWebTextStatusCollection","WAWebWid"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.status=o("WAWebBaseModel").prop(),t.stale=o("WAWebBaseModel").session(!0),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getCollection=function(){return o("WAWebTextStatusCollection").TextStatusCollection},t})(o("WAWebBaseModel").BaseModel);e.Proxy="textStatus",e.idClass=r("WAWebWid");var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebAiThreadCreationUtils",["WAWebAiThreadTypeUtils","WAWebBotUtils","WAWebMsgKey","WAWebPonyfillsCryptoRandomUUID","WAWebThreadId","WAWebThreadUtils"],(function(t,n,r,o,a,i,l){"use strict";var e="38e75a8e-6bc8-cf82-ab85-73799b39acd9",s={aiThreadType:o("WAWebAiThreadTypeUtils").AiThreadType.Default,title:void 0};function u(){return new(r("WAWebThreadId"))({key:new(r("WAWebMsgKey"))({fromMe:!0,id:e,remote:o("WAWebBotUtils").META_BOT_PN_WID}),type:o("WAWebThreadUtils").ThreadType.AiThread})}function c(e){var t=r("WAWebPonyfillsCryptoRandomUUID")(),n=new(r("WAWebMsgKey"))({fromMe:!0,remote:e,id:t});return new(r("WAWebThreadId"))({key:n,type:o("WAWebThreadUtils").ThreadType.AiThread})}function d(e,t){var n=new(r("WAWebMsgKey"))({fromMe:!0,remote:e,id:t});return new(r("WAWebThreadId"))({key:n,type:o("WAWebThreadUtils").ThreadType.AiThread})}l.HISTORICAL_META_AI_THREAD_INFO=s,l.getHistoricalMetaAiThreadId=u,l.createAiThreadId=c,l.createAiThreadFromMutationIndex=d}),98);
__d("WAWebBotDeviceCapabilities",["WASyncdConst","WAWebProtobufSyncAction.pb","WAWebProtobufsDeviceCapabilities.pb","WAWebSyncdDb","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","decodeProtobuf"],(function(t,n,r,o,a,i,l){"use strict";function e(){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield u();return e===o("WAWebProtobufsDeviceCapabilities.pb").DeviceCapabilities$AiThread$SupportLevel.INFRA||e===o("WAWebProtobufsDeviceCapabilities.pb").DeviceCapabilities$AiThread$SupportLevel.FULL}),s.apply(this,arguments)}function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e,t,n='["'+o("WASyncdConst").Actions.DeviceCapabilities+'","'+o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().user+':0@s.whatsapp.net"]',r=yield o("WAWebSyncdDb").getSyncAction(n);if((r==null?void 0:r.binarySyncData)==null)return o("WAWebProtobufsDeviceCapabilities.pb").DeviceCapabilities$AiThread$SupportLevel.NONE;var a=(e=(t=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufSyncAction.pb").SyncActionDataSpec,r.binarySyncData).value)==null||(t=t.deviceCapabilities)==null||(t=t.aiThread)==null?void 0:t.supportLevel)!=null?e:o("WAWebProtobufsDeviceCapabilities.pb").DeviceCapabilities$AiThread$SupportLevel.NONE;return a}),c.apply(this,arguments)}l.primaryHasAiThreadSupport=e}),98);
__d("WAWebMaybeGetAppendedAiThreadAttributes",["WAWebAiThreadCreationUtils","WAWebAiThreadTypeUtils","WAWebBotDeviceCapabilities","WAWebBotGating","WAWebBotUtils","WAWebFrontendMsgGetters","WAWebMsgCollection","WAWebMsgKey","WAWebThreadUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=e.to;if(!o("WAWebBotUtils").isMetaAiBot(n)||!o("WAWebBotGating").isAiChatThreadsInfraEnabled())return m(e);var r=yield o("WAWebBotDeviceCapabilities").primaryHasAiThreadSupport();if(!r)return m(e);if(u(e))return d(e);var a=e.quotedMsg;if(u(a))return d(a);var i=o("WAWebFrontendMsgGetters").getChat(e),l=i.msgs.last();if(u(l))return d(l);var s=c(l);if(u(s))return d(s);var p=o("WAWebAiThreadCreationUtils").createAiThreadId(i.id),_=o("WAWebAiThreadTypeUtils").getAiThreadInfoFromType(void 0,o("WAWebAiThreadTypeUtils").AiThreadType.Default),f=(t=l==null?void 0:l.threadIds)!=null?t:[];return[[].concat(f,[p]),_]}),s.apply(this,arguments)}function u(e){return(e==null?void 0:e.threadIds)==null?!1:e.threadIds.some(function(e){return e.type===o("WAWebThreadUtils").ThreadType.AiThread})}function c(e){if(e==null)return null;var t=e.botResponseTargetId;if(t==null)return null;var n=new(r("WAWebMsgKey"))({fromMe:!0,remote:e.id.remote,id:t}),a=o("WAWebMsgCollection").MsgCollection.get(n);return a}function d(e){var t,n;return[(t=e==null?void 0:e.threadIds)!=null?t:[],(n=e==null?void 0:e.aiThreadInfo)!=null?n:void 0]}function m(e){var t;return[(t=e.threadIds)==null?void 0:t.filter(function(e){return e.type!==o("WAWebThreadUtils").ThreadType.AiThread}),void 0]}l.maybeGetAppendedAiThreadAttributes=e}),98);
__d("WAWebAiThreadComparator",[],(function(t,n,r,o,a,i){var e=function(t,n){var e=t.lastMessageTimestamp||0,r=n.lastMessageTimestamp||0;return e!==r?e>r?-1:1:t.title<n.title?-1:1},l=e;i.default=l}),66);
__d("WAWebThreadModel",["WAWebBaseModel","WAWebThreadId"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.creationTimestamp=o("WAWebBaseModel").prop(),t.lastMessageTimestamp=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="thread",e.idClass=r("WAWebThreadId"),l.default=e}),98);
__d("WAWebAiThreadModel",["WAWebBaseModel","WAWebThreadId","WAWebThreadModel"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.title=o("WAWebBaseModel").prop(),t.aiThreadType=o("WAWebBaseModel").prop(),t.unreadCount=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(r("WAWebThreadModel"));e.Proxy="aiThread",e.idClass=r("WAWebThreadId");var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebAiThreadCollection",["WAWebAiThreadComparator","WAWebAiThreadModel","WAWebCollection","WAWebThreadMetadataJob","WAWebWidToJid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a.initializeAiThreads=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!t.isInitialized){var n=yield o("WAWebThreadMetadataJob").getAllAiThreadsFromChatId(o("WAWebWidToJid").widToChatJid(e));if(n!=null)for(var a of n){var i=new(r("WAWebAiThreadModel"))({id:a.threadId,title:a.aiThreadInfo.title,aiThreadType:a.aiThreadInfo.aiThreadType,lastMessageTimestamp:a.lastMessageTimestamp});this.add(i)}t.isInitialized=!0}});function a(t){return e.apply(this,arguments)}return a})(),a.removeThreads=function(t){for(var e of t){var n=this.get(e);n&&(this.remove(n),n.delete())}},a.clear=function(){var e=this.map(function(e){return e.id});this.removeThreads(e)},t})(r("WAWebCollection"));e.model=r("WAWebAiThreadModel"),e.isInitialized=!1,e.comparator=r("WAWebAiThreadComparator"),l.AiThreadCollection=e}),98);
__d("WAWebUsernameKeyVerificationModalLoadable",["JSResourceForInteraction","WAWebLazyLoadedRetriable","WAWebLoadingModal.react","asyncToGeneratorRuntime","react","react-loadable"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=r("WAWebLazyLoadedRetriable")(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield r("JSResourceForInteraction")("WAWebUsernameKeyVerificationModal.react").__setRef("WAWebUsernameKeyVerificationModalLoadable").load();return e}),"UsernameKeyVerificationModal"),c=r("react-loadable")({loader:u,loading:function(t){return s.jsx(r("WAWebLoadingModal.react"),{error:!!t.error})}});l.UsernameKeyVerificationModalLoadable=c}),98);
__d("WAWebUsernameKeyVerificationFlow",["Promise","WAWebModalManager","WAWebUsernameKeyVerificationModalLoadable","WAWebUsernameUtils","asyncToGeneratorRuntime","react"],(function(t,n,r,o,a,i,l){var e,s,u=s||(s=r("react"));function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=t.username,a=t.initWithError,i=o("WAWebUsernameUtils").getLIDByUsername(r);return i||new(e||(e=n("Promise")))(function(e){var t=u.jsx(o("WAWebUsernameKeyVerificationModalLoadable").UsernameKeyVerificationModalLoadable,{username:r,onKeyVerificationSuccess:function(n){return e(n)},onKeyVerificationCancel:function(){return e(null)},initWithError:a===!0});o("WAWebModalManager").ModalManager.open(t)})}),d.apply(this,arguments)}l.usernameKeyVerificationFlow=c}),98);
__d("WAWebUsernameUtils",["WAWebContactCollection","WAWebLidMigrationUtils","WAWebUsernameTypes"],(function(t,n,r,o,a,i,l){function e(){var e=new Uint8Array(4);self.crypto.getRandomValues(e);var t=Array.from(e,function(e){return(e%10).toString()}),n=t.join("");return o("WAWebUsernameTypes").asUsernameKey(n)}function s(e){var t=o("WAWebContactCollection").ContactCollection.findFirst(function(t){return t.username===e});if(!t||!t.id.isUser())return null;var n=o("WAWebLidMigrationUtils").toUserLid(t.id);return n}function u(e){return e==="exists"||e==="key-required"||e==="already-contact"}l.generateUsernameKeySuggestion=e,l.getLIDByUsername=s,l.usernameInputStateIsValid=u}),98);
__d("WAWebVoipWaCallEnums",["$InternalEnum","WAWebProtobufSyncAction.pb"],(function(t,n,r,o,a,i,l){var e,s=(e=n("$InternalEnum"))({None:0,Calling:1,PreacceptReceived:2,ReceivedCall:3,AcceptSent:4,AcceptReceived:5,CallActive:6,CallActiveElseWhere:7,ReceivedCallWithoutOffer:8,Rejoining:9,Link:10,ConnectedLonely:11,PreCalling:12,CallStateEnding:13,CallBCallStarting:14}),u=e({Undefined:0,Connected:1,Missed:2,Declined:3,Canceled:4,Unavailable:5,AcceptedElsewhere:6,MissedNotificationsMuted:7}),c=e({Invalid:0,Canceled:1,Missed:2,Unavailable:3,Rejected:4,Connected:5,AcceptedElsewhere:6,Failed:7,ConnectedLonely:8});function d(e){switch(e){case u.Connected:return o("WAWebProtobufSyncAction.pb").CallLogRecord$CallResult.CONNECTED;case u.Missed:case u.MissedNotificationsMuted:return o("WAWebProtobufSyncAction.pb").CallLogRecord$CallResult.MISSED;case u.Declined:return o("WAWebProtobufSyncAction.pb").CallLogRecord$CallResult.REJECTED;case u.Canceled:return o("WAWebProtobufSyncAction.pb").CallLogRecord$CallResult.CANCELLED;case u.AcceptedElsewhere:return o("WAWebProtobufSyncAction.pb").CallLogRecord$CallResult.ACCEPTEDELSEWHERE;case u.Unavailable:return o("WAWebProtobufSyncAction.pb").CallLogRecord$CallResult.UNAVAILABLE;case u.Undefined:return o("WAWebProtobufSyncAction.pb").CallLogRecord$CallResult.INVALID}}var m=e({Invalid:0,Connected:1,Incoming:2,Receipt:3,Rejected:4,Terminated:5,TimedOut:6,CreatingCall:7,Invisible:8,Visible:9,CancelOffer:10,Invited:11}),p=e({Invalid:0,Connected:1,Invited:2});function _(e){switch(e){case m.Connected:return o("WAWebProtobufSyncAction.pb").CallLogRecord$CallResult.CONNECTED;case m.Incoming:case m.Receipt:case m.Terminated:case m.TimedOut:case m.CancelOffer:return o("WAWebProtobufSyncAction.pb").CallLogRecord$CallResult.MISSED;case m.Rejected:return o("WAWebProtobufSyncAction.pb").CallLogRecord$CallResult.REJECTED;case m.Invited:case m.CreatingCall:case m.Invisible:case m.Visible:case m.Invalid:return o("WAWebProtobufSyncAction.pb").CallLogRecord$CallResult.INVALID}}var f=e({None:0,CallOfferSent:1,CallOfferReceived:2,CallOfferAcked:3,CallOfferNacked:4,CallOfferReceiptReceived:5,CallAcceptFailed:6,CallAcceptSent:7,CallAcceptReceived:8,CallPreacceptReceived:9,CallTerminateReceived:10,CallRejectReceived:11,CallOfferResend:12,AudioStreamStarted:13,P2PNegotiationSuccess:14,RelayCreateSuccess:15,CallStateChanged:16,P2PNegotiationFailed:17,MediaStreamError:18,AudioInitError:19,NoSamplingRatesForAudioRecord:20,SendOfferFailed:21,HandleOfferFailed:22,SendAcceptFailed:23,HandlePreAcceptFailed:24,HandleAcceptFailed:25,WillCreateSoundPort:26,SoundPortCreateFailed:27,TransportCandSendFailed:28,P2PTransportCreateFailed:29,P2PTransportMediaCreateFailed:30,P2PTransportStartFailed:31,P2PTransportRestartSuccess:32,MissingRelayInfo:33,ErrorGatheringHostCandidates:34,MediaStreamStartError:35,RelayLatencySendFailed:36,RelayElectionSendFailed:37,CallEnding:38,CallCaptureBufferFilled:39,CallCaptureEnded:40,RxTimeout:41,TxTimeout:42,RxTrafficStarted:43,RxTrafficStopped:44,RTCPPacketReceived:45,RTCPByeReceived:46,RelayBindsFailed:47,SoundPortCreated:48,AudioDriverRestart:49,Echo:50,SelfVideoStateChanged:51,PeerVideoStateChanged:52,VideoPortCreated:53,VideoPortCreateFailed:54,VideoDecodeStarted:55,VideoRenderStarted:56,VideoCaptureStarted:57,VideoPreviewFailed:58,VideoPreviewReady:59,VideoPreviewShouldMinimize:60,VideoStreamCreateError:61,VideoRenderFormatChanged:62,VideoCodecMismatch:63,VideoDecodePaused:64,VideoDecodeResumed:65,VideoEncodeFatalError:66,VideoDecodeFatalError:67,BatteryLevelLow:68,PeerBatteryLevelLow:69,GroupInfoChanged:70,FieldstatsReady:71,CallWaitingStateChanged:72,MuteStateChanged:73,InterruptionStateChanged:74,RxTrafficStateForPeerChanged:75,HandleAcceptReceiptFailed:76,GroupParticipantLeft:77,AudioRouteChangeRequest:78,HandleAcceptAckFailed:79,CallMissed:80,WeakWiFiSwitchedToCellular:81,CallAutoConnect:82,RejectedDecryptionFailure:83,PeerDeviceOrientationChanged:84,HandleOfferAckFailed:85,PendingCallAutoRejected:86,FDLeakDetected:87,RestartCamera:88,AudioTestReplayFinished:89,SyncDevices:90,VideoCodecStateChanged:91,CallFatal:92,UpdateJoinableCallLog:93,LobbyNacked:94,PlayCallTone:95,SendJoinableClientPollCriticalEvent:96,SendLinkedGroupCallDowngradedCriticalEvent:97,UpdateVoipSettings:98,VoipErrDetectorEvent:99,SpeakerStatusChanged:100,LonelyStateTimeout:101,MutedByOthers:102,LinkCreateAcked:103,LinkCreateNacked:104,HeartbeatNacked:105,CallLinkStateChanged:106,LobbyTimeout:107,MuteRequestFailed:108,LinkQueryNacked:109,LinkJoinNacked:110,CallGridRankingChanged:111,GroupCallBufferHandleMessages:112,RemoveUserNacked:113,VideoRenderingStateChanged:114,UserRemoved:115,ScreenShare:116,NetHealthStatusChanged:117,ReminderSetAcked:118,HighDataUsageDetected:119,LidCallerDisplayInfo:120,EagerCallDismiss:121,OfferPeekTimeout:122,NetHealthStatusChangedV2:123,AutoVideoPauseStateChanged:124,BCallCreated:125,BCallCreateFailed:126,BCallAudienceUpdated:127,CallSummaryReceived:128,BCallJoinFailed:129,BCallEndFailed:130,BCallJoined:131,BCallLeaveFailed:132,ScreenContentType:133,BCallEnded:134,BCallStartNotify:135,LinkEditAcked:136,LinkEditNacked:137,Update1to1CallLog:138,CallLinkSelfStateChanged:139,DataChannelReady:140,AudioTxStarted:141,HandleGroupCallReminder:142,VoiceChatWaveReceived:143,DataChannelConnectionTimeout:144,ReactionStateChanged:145,VideoStateChanged:146,PeerVideoPermissionChanged:147,RaiseHandStateChanged:148,RelayListUpdate:156,Max:157}),g=e({Unknown:0,AudioCapture:1,AudioPlayback:2,VideoCapture:4,DesktopCapture:8}),h=e({Disabled:0,Enabled:1,Paused:2,UpgradeRequest:3,UpgradeAccept:4,UpgradeReject:5,Stopped:6,UpgradeRejectByTimeout:7,UpgradeCancel:8,UpgradeCancelByTimeout:9,UnknownPeer:10,UpgradeRequestV2:11,Error:20}),y=e({Unknown:0,ParticipantAllocationFailure:1,SetupError:2,TxTimeout:3,RxTimeout:4,VideoStreamCreateError:5,VideoPortCreateFailed:6,NoSamplingRatesForAudioRecord:7,AudioInitError:8}),C=e({LosingPlaybackCallback:0,LosingRecordCallback:1,SlowPlaybackCallback:2,SlowRecordCallback:3,RecordSilence:4,RecordMax:5,BuiltinAec:6,FastPlaybackCallback:7,FastRecordCallback:8}),b=e({Display:1,Clear:2,Max:3});l.CallState=s,l.CallResult=u,l.CallLogResult=c,l.getSyncCallResultFromCallResultNative=d,l.CallParticipantState=m,l.CallSummaryUserState=p,l.getSyncParticipantCallResultFromParticipantState=_,l.CallEvent=f,l.DeviceTypeEnum=g,l.VideoState=h,l.CallFatalReasonCode=y,l.CallAudioRestartReason=C,l.ReactionState=b}),98);
__d("WAWebVoipActionWriteCallLogSync",["WALogger","WALongInt","WANullthrows","WAPromiseEach","WAResolvable","WATimeUtils","WAWebCallLogUtils","WAWebCmd","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsHistorySync","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebVoipActionWriteCallLogImpl","WAWebVoipWaCallEnums","WAWebWidFactory","asyncToGeneratorRuntime","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f=[],g=null;function h(){if(g!=null)return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["generateCallLogFromCallSyncRecord: listener already registered"]))),g.promise;o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["generateCallLogFromCallSyncRecord: setting up listener"]))),g=new(o("WAResolvable")).Resolvable;var t=g;return o("WAWebCmd").Cmd.on("on_initial_chat_synced",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["generateCallLogFromCallSyncRecord: listener called, "," pending call log records"])),f.length),yield o("WAPromiseEach").promiseEach(f,function(e,n){return b(e).then(function(){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["generateCallLogFromCallSyncRecord: generated call log message, after initial history sync complete, from history sync: ",""])),e.fromHistorySync),t.resolve(),f=[],g=null})})})),t.promise}function y(e){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(o("WAWebUserPrefsHistorySync").getInitialHistorySyncComplete())o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["generateCallLogFromCallSyncRecord: generating call log message, after initial history sync complete, from history sync: ",""])),e.fromHistorySync),yield b(e);else return o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["generateCallLogFromCallSyncRecord: generating call log message, before initial history sync complete, from history sync: ",""])),e.fromHistorySync),f.push(e),h()}),C.apply(this,arguments)}function b(e){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.callLogRecord,n=e.fromHistorySync,a=n===void 0?!1:n,i=e.shouldHideInConversation,l=i===void 0?!1:i,s={message:"generateCallLogFromCallSyncdRecord: failed to find chat target details for call log syncd record",log:"generate-call-log-message-syncd-failed"};a&&(s={message:"generateCallLogFromCallHistorySyncRecord: failed to find chat target details for call log history sync record",log:"generate-call-log-message-history-sync-failed"});var u=t.callCreatorJid,c=t.callResult,d=t.callId,m=t.groupJid,f=t.startTime,g=t.silenceReason,h=t.isVideo,y=t.isCallLink,C=y===void 0?!1:y,b=t.callLinkToken,v,S=u!=null&&u!==""?o("WAWebWidFactory").createWid(u):o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow();try{v=yield o("WAWebCallLogUtils").getCallLogTargetDetails({callCreatorWid:S,callId:d,groupJid:r("isStringNullOrEmpty")(m)?null:o("WAWebWidFactory").createWid(m),participants:t.participants.map(function(e){return e.userJid!=null&&e.userJid!==""?o("WAWebWidFactory").createWid(e.userJid):null}).filter(Boolean)})}catch(e){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["",": ",""])),s.message,e).devConsole(e);return}var R=v,L=R.msgKeyId,E=R.fromMe,k=R.callCreatorUserWid,I=R.chatId,T=R.participant,D=R.viewMode;try{var x,$,P={id:new(r("WAWebMsgKey"))({remote:I,participant:T,fromMe:E,id:L}),type:o("WAWebMsgType").MSG_TYPE.CALL_LOG,kind:o("WAWebMsgType").MsgKind.CallLog,viewMode:l||a||C?o("WAWebViewMode.flow").ViewModeType.HISTORY_SYNCED_CALL_LOG:D,callOutcome:o("WAWebCallLogUtils").getCallOutcomeFromCallResultSyncProto(r("WANullthrows")(c,"generateCallLogFromCallSyncRecord: callResult is null from call log record sync")),callSilenceReason:g!=null?o("WAWebCallLogUtils").getCallSilenceReason(g):void 0,isVideoCall:h!=null?h:!1,callCreator:S,callDuration:t.duration==null?void 0:(x=o("WALongInt").maybeNumber(t.duration))!=null?x:void 0,callParticipants:t.participants.filter(function(e){return e.userJid!=null}).map(function(e){return{participant:o("WAWebWidFactory").createWid(r("WANullthrows")(e.userJid)),outcome:e.callResult!=null?o("WAWebCallLogUtils").getCallParticipantStateFromCallResultSyncProto(e.callResult):o("WAWebVoipWaCallEnums").CallParticipantState.Invalid}}),from:k,t:($=o("WALongInt").maybeNumber(f))!=null?$:o("WATimeUtils").unixTime(),to:I,isCallLink:C!=null?C:!1,callLinkToken:b!=null?b:void 0};yield o("WAWebVoipActionWriteCallLogImpl").writeVoipCallLogMessageImpl(I,P,!1)}catch(e){a?s.message="generateCallLogFromCallHistorySyncRecord: failed to generate call log message from history sync":s.message="generateCallLogFromCallSyncRecord: failed to generate call log message from syncd",o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["",": ",""])),s.message,e).tags("nexus-voip").devConsole(e).sendLogs(s.log)}}),v.apply(this,arguments)}l.generateCallLogFromCallSyncRecord=y}),98);
__d("WAWebVoipCallsTabPanelManager",["WAWebTypedEventEmitter"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(r("WAWebTypedEventEmitter")),s=new e;l.default=s}),98);
__d("WAWebVoipActionWriteCallLogImpl",["Promise","WAResolvable","WAWebChatGetExistingBridge","WAWebCmd","WAWebFindChatAction","WAWebGetMessageCache","WAWebHandleMsgTypes.flow","WAWebHandleSingleMsg","WAWebMessageQueue","WAWebMsgCollection","WAWebSendMsgChatAction","WAWebUpdateMessageUIAction","WAWebVoipCallsTabPanelManager","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e,t,n){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i){var l,s=yield o("WAWebChatGetExistingBridge").getExisting(t);s&&s.ephemeralDuration!=null?l=babelHelpers.extends({},a,{ephemeralDuration:s.ephemeralDuration}):l=a;var u=new(o("WAResolvable")).Resolvable;return o("WAWebMessageQueue").onMessageQueue({chatWid:t,isOffline:i,msgCategory:null,action:(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=c(l).then(function(e){u.resolve(e)});return i?(e||(e=n("Promise"))).resolve():t});function r(){return t.apply(this,arguments)}return r})()}),u.promise;function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var l=null;if(i)o("WAWebCmd").Cmd.isMainStreamReadyMd&&o("WAWebUpdateMessageUIAction").updateUI(t,a),yield o("WAWebGetMessageCache").getMessageCache().addMessages([{msg:a}],!1);else{var s=o("WAWebMsgCollection").MsgCollection.get(a.id);if(s)yield(e||(e=n("Promise"))).all([s.applyUpdate(a),yield o("WAWebHandleSingleMsg").handleSingleMsg({chatId:t,newMsg:a,handleSingleMsgOrigin:"voipNotification",messageOverwriteOption:o("WAWebHandleMsgTypes.flow").MessageOverwriteOption.VOIP_CALL_LOG})]),l=s;else{var u=yield o("WAWebFindChatAction").findOrCreateLatestChat(t,"voipCallLog"),c=u.chat,d=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return yield o("WAWebHandleSingleMsg").handleSingleMsg({chatId:t,newMsg:a,handleSingleMsgOrigin:"voipNotification"}),e});return function(n){return e.apply(this,arguments)}})();l=yield o("WAWebSendMsgChatAction").addMsgToChat(c,a,d)}}return r("WAWebVoipCallsTabPanelManager").trigger("onWriteCallLogMessage"),l}),d.apply(this,arguments)}}),u.apply(this,arguments)}l.writeVoipCallLogMessageImpl=s}),98);
__d("WAWebPttAudioChannels",["WAWebEventEmitter"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.registerMedia=function(t){var e=this,n=null,r=function(){n=e.claim(t,function(){t.pause()})},o=function(){n==null||n()};return t.addEventListener("play",r),t.addEventListener("pause",o),function(){n==null||n(),t.removeEventListener("play",r),t.removeEventListener("pause",o)}},n.claim=function(t,n){var e=this,r=this.$AudioChannel$p_1;return r!=null&&t!==r.key&&(r.pause(),this.trigger("paused_DEPRECATED_DO_NOT_USE",r.key)),this.$AudioChannel$p_1={key:t,pause:n},function(){var n;t===((n=e.$AudioChannel$p_1)==null?void 0:n.key)&&(e.$AudioChannel$p_1=null)}},t})(r("WAWebEventEmitter")),s=new e;l.MainAudioChannel=s}),98);
__d("WAWebCallCollection",["WALogger","WAWebBaseCollection","WAWebCallModel","WAWebNoop","WAWebPttAudioChannels","lodash"],(function(t,n,r,o,a,i,l){var e,s=(function(t){function n(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,e.pendingOffers={},e.pendingVoipCapChecks={},e.isInConnectedCall=!1,e.lastActiveCall=null,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.processIncomingCall=function(n,a,i){var t;if(this.get(n)!=null)return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["voip:processIncomingCall: Attempting to add existing call with call ID"]))).devConsole(n),this.get(n);var l=i,s={id:n,isGroup:(t=l==null?void 0:l.isGroupCall)!=null?t:!!(l!=null&&l.groupWid),groupJid:l==null?void 0:l.groupWid};return a!=null&&(s.peerJid=a),l&&(Object.keys(l).forEach(function(e){l[e]==null&&delete l[e]}),r("lodash").merge(s,l)),this.add(s,{merge:!0}),this.get(n)},a.cleanupPendingOffer=function(t){delete this.pendingOffers[t]},a.setActiveCall=function(t){var e;this.activeCall=t,this.trigger("change:activeCall",t),(e=this.$CallCollectionImpl$p_1)==null||e.call(this),t!=null&&(this.$CallCollectionImpl$p_1=o("WAWebPttAudioChannels").MainAudioChannel.claim(this,r("WAWebNoop")))},a.setIsInConnectedCall=function(t){this.isInConnectedCall!==t&&(this.isInConnectedCall=t,this.trigger("change:isInConnectedCall",t))},n})(o("WAWebBaseCollection").BaseCollection);s.model=r("WAWebCallModel");var u=new s,c=u;l.default=c}),98);
__d("WAWebCallModel",["WALogger","WAWebBaseModel","WAWebCallCollection","WAWebCmd","WAWebConnModel","WAWebEnvironment","WAWebNoop","WAWebPttAudioChannels","WAWebVoipWaCallEnums"],(function(t,n,r,o,a,i,l){var e,s=(function(t){function n(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.id=o("WAWebBaseModel").prop(),e.msg=o("WAWebBaseModel").prop(),e.peerJid=o("WAWebBaseModel").prop(),e.offerTime=o("WAWebBaseModel").prop(),e.isVideo=o("WAWebBaseModel").prop(!1),e.isGroup=o("WAWebBaseModel").prop(!1),e.groupJid=o("WAWebBaseModel").prop(),e.groupCallParticipants=o("WAWebBaseModel").prop(),e.groupCallParticipantsConnected=o("WAWebBaseModel").prop(),e.outgoing=o("WAWebBaseModel").prop(!1),e.isSilenced=o("WAWebBaseModel").prop(!1),e.offerReceivedWhileOffline=o("WAWebBaseModel").prop(!1),e.isVoiceChat=o("WAWebBaseModel").prop(!1),e.silenceReason=o("WAWebBaseModel").prop(),e.selfVideoState=o("WAWebBaseModel").prop(),e.peerVideoState=o("WAWebBaseModel").prop(),e.peerVideoJid=o("WAWebBaseModel").prop(),e.selfMicMuted=o("WAWebBaseModel").prop(!1),e.peerMicMuted=o("WAWebBaseModel").prop(!1),e.peerAudioLevel=o("WAWebBaseModel").prop(0),e.selfPreviewCorner=o("WAWebBaseModel").prop(),e.shouldShowPostCallSurvey=o("WAWebBaseModel").prop(!1),e.postCallSurveyInteracted=o("WAWebBaseModel").prop(!1),e.$Call$p_1=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.getState=function(){return this.$Call$p_1},a.setState=function(t){this.$Call$p_1=t,this.trigger("change:state"),this.$Call$p_2()},a.shouldShowVideoUI=function(){return this.selfVideoState==null&&this.peerVideoState==null?(o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["voip: shouldShowVideoUI: both video states are null, falling back to isVideo"]))),this.isVideo):this.selfVideoState!=null&&this.peerVideoState==null?this.shouldShowSelfPreview():this.selfVideoState==null&&this.peerVideoState!=null?this.shouldShowPeerVideo()||this.peerVideoState===o("WAWebVoipWaCallEnums").VideoState.UnknownPeer:this.shouldShowSelfPreview()||this.shouldShowPeerVideo()||this.peerVideoState===o("WAWebVoipWaCallEnums").VideoState.UnknownPeer},a.shouldShowSelfPreview=function(){return this.isVideo?!0:this.selfVideoState===o("WAWebVoipWaCallEnums").VideoState.Enabled},a.shouldShowPeerVideo=function(){return this.peerVideoState==null?!1:this.peerVideoState===o("WAWebVoipWaCallEnums").VideoState.Enabled||this.peerVideoState===o("WAWebVoipWaCallEnums").VideoState.UpgradeAccept||this.peerVideoState===o("WAWebVoipWaCallEnums").VideoState.Paused},a.$Call$p_2=function(){if(!r("WAWebEnvironment").isWindows){var e=this.getState();if(!(!o("WAWebConnModel").Conn.tosShowCallNotification||!this.peerJid))if(!this.offerReceivedWhileOffline&&e===o("WAWebVoipWaCallEnums").CallState.ReceivedCall){o("WAWebCmd").Cmd.alertCall(this.peerJid,this.id,this.isVideo,this.isGroup,this.isSilenced);var t=o("WAWebPttAudioChannels").MainAudioChannel.claim(this,r("WAWebNoop"));t()}else o("WAWebCmd").Cmd.cancelCall(this.peerJid)}},a.getCollection=function(){return r("WAWebCallCollection")},n})(o("WAWebBaseModel").BaseModel);s.Proxy="call";var u=o("WAWebBaseModel").defineModel(s);l.default=u}),98);
__d("WAWebVoipJsonParserNative",[],(function(t,n,r,o,a,i){"use strict";function e(e){try{return JSON.parse(e)}catch(e){return null}}i.parseJsonFromNativeBridge=e}),66);
__d("WAWebVoipJsonParserPayloads",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["Call","JoinableCall"]),l=n("$InternalEnum")({Create:1,Update:2,Delete:3});i.FieldstatsPayloadType=e,i.UpdateJoinableCallLogType=l}),66);
__d("WAWebVoipJsonParsersWeb",["WACamelCase","WALogger","WATimeUtils","WAWebUserPrefsMeUser","WAWebVoipJsonParserNative","WAWebVoipJsonParserPayloads","WAWebWamCodegenUtils","WAWebWidFactory","err","isStringNullOrEmpty","nullthrows"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c={parseCallStateChangedData:function(t){var e=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(e==null)throw r("err")("Invalid call ending data");var n=c.parseCallInfo(JSON.stringify(e.call_info));return{CallState:n.callState,call_info:n}},parseUpdateJoinableCallLogData:function(t){var e=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(e==null)throw r("err")("Invalid update joinable call log data");var n=e.call_summary;return{CallId:e.call_id,CallCreatorDeviceJid:p(e.call_creator_device_jid),Type:e.type,InitialPeerJid:p(e.initial_peer_jid),GroupJid:p(e.group_jid),IsCaller:e.is_caller,VideoEnabled:e.video_enabled,IsFromOffer:e.is_from_offer,CallLinkToken:e.link_token,ScheduledId:e.scheduled_id,IsLightweight:e.is_lightweight,NumParticipants:e.num_participants,CallParticipantInfos:e.participant_infos.map(function(e){return{jid:m(e.jid),result:e.state}}),CallSummary:n!=null?{CallCreatorJid:p(n.call_creator_jid),CallId:n.call_id,IsVideo:n.is_video_call,CallDuration:n.call_duration,UsersCount:n.users_count,Users:n.users.map(function(e){return{Jid:p(e.jid),PhoneJid:p(e.phone_jid),State:e.state}})}:null,Result:e.call_log_result,LinkCreatorJid:p(e.link_creator_jid)}},parseRejectedDecryptionFailureData:function(t){var e=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(e==null)throw r("err")("Invalid call ending data");return babelHelpers.extends({},e,{PeerDeviceJid:m(e.PeerDeviceJid)})},parseSyncDeviceData:function(t){var e=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(e==null||e.sync_devices==null)throw r("err")("Invalid sync device data");if(!Array.isArray(e.sync_devices))throw r("err")("Invalid sync device data: expected array");return e.sync_devices.map(function(e){return{PHash:e.phash,UserRawJid:o("WAWebWidFactory").createWid(e.user_raw_jid)}})},parseCallEndingData:function(t){var e=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(e==null)throw r("err")("Invalid call ending data");return{peerJid:m(e.peer_jid),fromMe:e.from_me,groupJid:p(e.group_jid),callId:e.call_id,callLinkToken:e.call_link_token,isCallLink:e.is_call_link,scheduledId:e.scheduled_id,startTime:o("WATimeUtils").castToUnixTime(e.start_time),connectTime:e.connect_time!=null?Math.floor(e.connect_time/1e3):null,endTime:o("WATimeUtils").castToUnixTime(e.end_time),result:e.result,videoCall:e.video_call,participantEntries:e.participant_entries.map(function(e){return{jid:m(e.jid),result:e.result}}),callCreatorJid:p(e.call_creator_jid),initialPeerJid:p(e.initial_peer_jid),timeSeriesPath:e.time_series_path}},parseCallMissedData:function(t){var e,n,a,i,l,s=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(s==null)throw r("err")("Invalid call missed data");var u=(e=s.group_info)!=null&&e.participants?s.group_info.participants.map(function(e){return{jid:m(e.user_jid),result:e.state}}):(n=(a=s.call_participant_infos)==null?void 0:a.map(function(e){return{jid:m(e.jid),result:e.state}}))!=null?n:[];return{CallId:s.call_id,PeerUserJid:p(s.peer_user_jid),GroupJid:p(s.group_jid),IsVideoCall:s.is_video_call,GroupInfo:s.group_info?{Participants:(i=s.group_info.participants)==null?void 0:i.map(function(e){return{UserJid:m(e.user_jid),State:e.state}})}:null,CallParticipantInfos:u,TimeElapsedSinceCallOffer:o("WATimeUtils").castToUnixTime((l=s.time_elapsed_since_call_offer)!=null?l:0)}},parseUpdate1to1CallLogData:function(t){var e=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(e==null)throw r("err")("Invalid update 1to1 call log data");return{CallId:e.call_id,Result:e.result,PeerJid:m(e.peer_jid)}},parseGroupInfoChangedData:function(t){var e=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(e==null)throw r("err")("Invalid group info changed data");var n=null;return e.participants!=null&&(n=e.participants.map(function(e){return{participant:m(e.jid),outcome:e.state,videoState:e.video_state,isMuted:e.is_muted}})),{CallId:e.call_id,CallParticipants:n}},parseSpeakerStatusChangedData:function(t){var e,n,a=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(a==null)throw r("err")("Invalid speaker status changed data");return{CallId:a.call_id,Participants:(e=(n=a.participants)==null?void 0:n.map(function(e){return{Jid:m(e.jid),AudioLevel:e.audio_level}}))!=null?e:[]}},parseRelayListUpdateData:function(t){var e=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(e==null)throw r("err")("Invalid relay list update data");return{event_type:e.event_type,num_relays:e.num_relays,relays:e.relays,relay_key:e.relay_key,relay_tokens:e.relay_tokens}},parseFieldstatsData:function(n){var t=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(n);if(t==null)throw r("err")("Invalid field stats data");if(t.call_ended_stats!=null){var a=Object.fromEntries(Object.entries(t.call_ended_stats).map(function(t){var n=t[0],a=t[1],i=n==="abtest_bucket"?"callTestBucket":n==="peer_raw_jid"?null:r("WACamelCase")(n,{treatNumbersAsWordBoundaries:!1});if(i==null)return null;try{var l=o("WAWebWamCodegenUtils").metrics.getEvent("Call",i);return l.type==="boolean"?[i,!!a]:[i,a]}catch(t){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["voip: fieldstats ready: metric undefined for ",""])),i).devConsole(t),null}}).filter(Boolean));return{eventType:o("WAWebVoipJsonParserPayloads").FieldstatsPayloadType.Call,stats:a,uploadInRealtime:t.upload_in_realtime}}if(t.joinable_call_stats!=null){var i=Object.fromEntries(Object.entries(t.joinable_call_stats).map(function(e){var t=e[0],n=e[1],a=r("WACamelCase")(t,{treatNumbersAsWordBoundaries:!1});try{var i=o("WAWebWamCodegenUtils").metrics.getEvent("JoinableCall",a);return i.type==="boolean"?[a,!!n]:[a,n]}catch(e){return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["voip: fieldstats ready: metric undefined for ",""])),a),null}}).filter(Boolean));return{eventType:o("WAWebVoipJsonParserPayloads").FieldstatsPayloadType.JoinableCall,stats:i,uploadInRealtime:t.upload_in_realtime}}throw r("err")("Invalid field stats data: no stats object found")},parseVideoStateChangedData:function(t){var e=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(e==null)throw r("err")("Invalid video state changed data");var n=e.is_self;if(n==null&&e.jid!=null){var a=p(e.jid);n=a?o("WAWebUserPrefsMeUser").isMeAccount(a):void 0}return{videoState:e.video_state,isSelf:n,userJid:e.jid?p(e.jid):null,callMediaStateChanged:e.call_media_state_changed}},parsePeerVideoPermissionChangedData:function(t){var e=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(e==null)throw r("err")("Invalid peer video permission changed data");return{isBannerVisible:e.is_banner_visible,jid:r("nullthrows")(p(e.jid)),videoState:e.video_state}},parseCallRejectReceivedData:function(t){var e=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(e==null)throw r("err")("Invalid call reject received data");return{callId:e.call_id,peerUserJid:m(e.peer_user_jid),reason:e.reason}},parseCallFatalData:function(t){var e=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(e==null)throw r("err")("Invalid call fatal data");return{reasonCode:e.reason_code}},parseRelayBindsFailedData:function(t){var e=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(e==null)throw r("err")("Invalid relay binds failed data");return{selfBadAsn:e.self_bad_asn}},parseAudioDriverRestartData:function(t){var e=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(e==null)throw r("err")("Invalid audio driver restart data");return{reason:e.reason,audioRestartCount:e.audio_restart_count,audioRestartBeforeFallbackCount:e.audio_restart_before_fallback_count,isDueToSilenceDetected:e.is_due_to_silence_detected}},parseCallInfo:function(t){var e,n,a,i=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(i==null)throw r("err")("Invalid call info data");return{callState:i.call_state,callId:i.call_id,globalCallId:i.global_call_id,relayCallUuid:i.relay_call_uuid,selfParticipantUuid:i.self_participant_uuid,peerJid:p(i.peer_jid),initialPeerJid:p(i.initial_peer_jid),creatorJid:p(i.creator_jid),creatorDeviceJid:p(i.creator_device_jid),isCaller:i.is_caller,callDuration:i.call_duration,callActiveDuration:i.call_active_duration,audioDuration:i.audio_duration,videoDuration:i.video_duration,callEnding:i.call_ending,callEndedByMe:i.call_ended_by_me,callResult:i.call_result,callSetupErrorType:i.call_setup_error_type,bytesSent:i.bytes_sent,bytesReceived:i.bytes_received,videoEnabledAtCallStart:i.video_enabled_at_call_start,videoEnabled:i.video_enabled,videoCaptureStarted:i.video_capture_started,videoPreviewStarted:i.video_preview_started,avAutoAcceptEnabled:i.av_auto_accept_enabled,avDowngradeEnabled:i.av_downgrade_enabled,groupAvUpgradable:i.group_av_upgradable,selfCameraFrontFacing:i.self_camera_front_facing,aecMode:i.aec_mode,isGroupCall:i.is_group_call,isUpgradedGroupCallBeforeConnected:i.is_upgraded_group_call_before_connected,enableGroupCall:i.enable_group_call,isGroupCallCreatedOnServer:i.is_group_call_created_on_server,isJoinableGroupCall:i.is_joinable_group_call,initialGroupTransactionId:i.initial_group_transaction_id,connectedLimit:i.connected_limit,participantCount:i.participant_count,participants:i.participants.map(function(e){return{jid:m(e.jid),state:e.state,videoState:e.video_state,isMuted:e.is_muted,audioLevel:e.audio_level,isDominantSpeaker:e.is_dominant_speaker}}),canInviteNewParticipant:i.can_invite_new_participant,canSwitchAudioVideo:i.can_switch_audio_video,rotateVideo:i.rotate_video,callWaitingInfo:{hasWaitingCall:i.call_waiting_info.has_waiting_call,waitingCallId:i.call_waiting_info.waiting_call_id,waitingPeerJid:p(i.call_waiting_info.waiting_peer_jid),waitingGroupJid:p(i.call_waiting_info.waiting_group_jid),waitingIsVideo:i.call_waiting_info.waiting_is_video},groupJid:p(i.group_jid),linkToken:(e=i.link_token)!=null?e:"",scheduledId:i.scheduled_id,isLightweight:i.is_lightweight,isPhashBased:i.is_phash_based,phash:i.phash,canRingAll:i.can_ring_all,offerEpochTimeMs:i.offer_epoch_time_ms,isBcall:i.is_bcall,isBcallBroadcaster:i.is_bcall_broadcaster,isBotCall:i.is_bot_call,vcExtendable:i.vc_extendable,isWaitingRoomEnabled:i.is_waiting_room_enabled,isWaitingRoomAdmin:i.is_waiting_room_admin,isInWaitingRoom:i.is_in_waiting_room,isCallRatingEnabled:(n=i.is_call_rating_enabled)!=null?n:!1,callRatingInterval:(a=i.call_rating_interval)!=null?a:-1}},parseReactionStateChangedData:function(t){var e=o("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(t);if(e==null)throw r("err")("Invalid reaction state changed data");return{jid:m(e.jid),callReaction:e.call_reaction,reactionState:e.reaction_state}}},d=c;function m(e){return r("nullthrows")(p(e),"createVoipJid: received unexpected null")}function p(e){if(!e||r("isStringNullOrEmpty")(e.raw_jid))return null;try{return o("WAWebWidFactory").createWid(e.raw_jid)}catch(t){return o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["createVoipJid: failed to create wid from raw jid"]))).devConsole(t,e.raw_jid).sendLogs("create-voip-jid-failed"),null}}l.default=d}),98);
__d("WAWebCallTimer.react",["WALogger","WAWebClock","WAWebVoipJsonParsersWeb","WAWebVoipStackInterface","WAWebVoipWaCallEnums","asyncToGeneratorRuntime","react","stylex"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=c||(c=o("react")),m=s||(s=r("react")),p=d.useEffect,_=d.useState,f=null;function g(){return f||(f={startTime:null,intervalId:null,subscribers:new Set}),f}function h(e){f!=null&&(f.startTime=e,f.subscribers.forEach(function(e){return e()}))}function y(){var e;((e=f)==null?void 0:e.intervalId)!=null&&window.clearInterval(f.intervalId),f=null}var C={timerContainer:{minWidth:"x2c5eco",fontSize:"x1f6kntn",fontWeight:"xo1l8bm",textAlign:"x2b8uid",$$css:!0}};function b(t){var a=t.callState,i=t.xstyle,l=_(function(){if(a!==o("WAWebVoipWaCallEnums").CallState.CallActive)return null;var e=f;if((e==null?void 0:e.startTime)!=null){var t=e.startTime;return Math.floor((Date.now()-t)/1e3)}return null}),s=l[0],c=l[1];return p(function(){if(a!==o("WAWebVoipWaCallEnums").CallState.CallActive){y();return}var t=!0,i=g();i.startTime==null&&n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var n=yield o("WAWebVoipStackInterface").getVoipStackInterface();if(!t)return;if((n==null?void 0:n.type)==="web"){var a=yield n.getCallInfo();if(!t)return;if(a){var l=r("WAWebVoipJsonParsersWeb").parseCallInfo(a),s=Math.floor(l.callActiveDuration/1e3),u=Date.now()-s*1e3;h(u),t&&c(s)}}}catch(t){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["WAWebCallTimer: Failed to get initial call duration"]))).devConsole(t),i.startTime==null&&h(Date.now())}})();var l=function(){var e=i.startTime;if(e!=null){var t=Math.floor((Date.now()-e)/1e3);c(t)}};return i.subscribers.add(l),i.intervalId==null&&(i.intervalId=window.setInterval(function(){i.subscribers.forEach(function(e){return e()})},1e3)),function(){t=!1,i.subscribers.delete(l),i.subscribers.size===0&&y()}},[a]),a!==o("WAWebVoipWaCallEnums").CallState.CallActive||s==null?null:m.jsx("div",babelHelpers.extends({},(u||(u=r("stylex"))).props(C.timerContainer,i),{"data-testid":void 0,role:"timer",children:o("WAWebClock").Clock.durationStr(s)}))}b.displayName=b.name+" [from "+i.id+"]",l.default=b}),98);
__d("WAWebCallLogUtils",["fbt","WALogger","WANullthrows","WATimeUtils","WAWebCallLogMsgData.flow","WAWebCallTimer.react","WAWebFindChatAction","WAWebFrontendMsgGetters","WAWebLid1X1MigrationGating","WAWebMsgGetters","WAWebMsgKey","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebVoipWaCallEnums","WAWebWidFactory","asyncToGeneratorRuntime","react"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=o("react"));function d(e,t){return e===o("WAWebVoipWaCallEnums").CallState.Calling?s._(/*BTDS*/"Llamando\u2026"):e===o("WAWebVoipWaCallEnums").CallState.PreacceptReceived?s._(/*BTDS*/"Llamando\u2026"):e===o("WAWebVoipWaCallEnums").CallState.ReceivedCall||e===o("WAWebVoipWaCallEnums").CallState.ReceivedCallWithoutOffer?t!=null&&t.isVideoCall?s._(/*BTDS*/"Videollamada"):s._(/*BTDS*/"Llamada"):e===o("WAWebVoipWaCallEnums").CallState.AcceptSent||e===o("WAWebVoipWaCallEnums").CallState.AcceptReceived?s._(/*BTDS*/"Conectando\u2026"):e===o("WAWebVoipWaCallEnums").CallState.CallActive?c.jsx(r("WAWebCallTimer.react"),{callState:e}):e==null?s._(/*BTDS*/"Llamada finalizada"):e!=null?o("WAWebVoipWaCallEnums").CallState.getName(e):"unknown"}d.displayName=d.name+" [from "+i.id+"]";function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.callCreatorWid,a=t.callId,i=t.groupJid,l=t.peerWid,s=t.participants,u=s===void 0?[]:s,c,d,m=o("WAWebViewMode.flow").ViewModeType.VISIBLE,p=yield _({callDestinationWid:n}),f=o("WAWebUserPrefsMeUser").isMeAccount(p),g=u.filter(function(e){return e!=null&&!o("WAWebUserPrefsMeUser").isMeAccount(e)});if(i!=null)c=i,d=p;else if(!f)c=p;else if(g.length===1){var h=g[0];c=yield _({callDestinationWid:h})}else l!=null?c=yield _({callDestinationWid:l}):(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["voip: getCallLogTargetDetails: call log message will be added to self chat"]))),c=p,m=g.length>0?o("WAWebViewMode.flow").ViewModeType.CALL_LOG_AD_HOC_GROUP_CALL:o("WAWebViewMode.flow").ViewModeType.HIDDEN);return{msgKeyId:a!=null?a:yield r("WAWebMsgKey").newId(),fromMe:f,callCreatorUserWid:p,chatId:c,participant:d,viewMode:m}}),p.apply(this,arguments)}function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.callDestinationWid,n=e.groupJid,r=o("WAWebWidFactory").asUserWidOrThrow(t),a=!r.isLid()&&o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated(),i=!n&&(r.isLid()||a);if(i){var l=yield o("WAWebFindChatAction").findOrCreateLatestChat(t,"voipCallLog"),s=l.chat;r=o("WAWebWidFactory").asUserWidOrThrow(s.id)}return r}),f.apply(this,arguments)}function g(e){switch(e){case 0:return o("WAWebCallLogMsgData.flow").CallOutcome.Completed;case 1:return o("WAWebCallLogMsgData.flow").CallOutcome.Rejected;case 2:return o("WAWebCallLogMsgData.flow").CallOutcome.Canceled;case 3:return o("WAWebCallLogMsgData.flow").CallOutcome.AcceptedElsewhere;case 4:case 6:case 9:return o("WAWebCallLogMsgData.flow").CallOutcome.Missed;case 5:case 7:case 8:return o("WAWebCallLogMsgData.flow").CallOutcome.Failed;case 10:return o("WAWebCallLogMsgData.flow").CallOutcome.Ongoing;default:return o("WAWebCallLogMsgData.flow").CallOutcome.Unknown}}function h(e){switch(e){case 0:return o("WAWebVoipWaCallEnums").CallParticipantState.Connected;case 1:return o("WAWebVoipWaCallEnums").CallParticipantState.Rejected;case 2:return o("WAWebVoipWaCallEnums").CallParticipantState.Terminated;case 4:case 6:case 9:return o("WAWebVoipWaCallEnums").CallParticipantState.Terminated;case 10:return o("WAWebVoipWaCallEnums").CallParticipantState.Connected;case 3:case 5:case 7:case 8:return o("WAWebVoipWaCallEnums").CallParticipantState.Invalid;default:return o("WAWebVoipWaCallEnums").CallParticipantState.Invalid}}function y(e){switch(e){case o("WAWebVoipWaCallEnums").CallResult.Connected:return o("WAWebCallLogMsgData.flow").CallOutcome.Completed;case o("WAWebVoipWaCallEnums").CallResult.Missed:case o("WAWebVoipWaCallEnums").CallResult.MissedNotificationsMuted:return o("WAWebCallLogMsgData.flow").CallOutcome.Missed;case o("WAWebVoipWaCallEnums").CallResult.Declined:return o("WAWebCallLogMsgData.flow").CallOutcome.Rejected;case o("WAWebVoipWaCallEnums").CallResult.Canceled:return o("WAWebCallLogMsgData.flow").CallOutcome.Canceled;case o("WAWebVoipWaCallEnums").CallResult.AcceptedElsewhere:return o("WAWebCallLogMsgData.flow").CallOutcome.AcceptedElsewhere;case o("WAWebVoipWaCallEnums").CallResult.Unavailable:case o("WAWebVoipWaCallEnums").CallResult.Undefined:return o("WAWebCallLogMsgData.flow").CallOutcome.Unknown}}function C(e){switch(e){case o("WAWebVoipWaCallEnums").CallState.None:return o("WAWebCallLogMsgData.flow").CallOutcome.Completed;case o("WAWebVoipWaCallEnums").CallState.CallActiveElseWhere:return o("WAWebCallLogMsgData.flow").CallOutcome.AcceptedElsewhere;case o("WAWebVoipWaCallEnums").CallState.Calling:case o("WAWebVoipWaCallEnums").CallState.PreacceptReceived:case o("WAWebVoipWaCallEnums").CallState.ReceivedCall:case o("WAWebVoipWaCallEnums").CallState.AcceptSent:case o("WAWebVoipWaCallEnums").CallState.AcceptReceived:case o("WAWebVoipWaCallEnums").CallState.CallActive:case o("WAWebVoipWaCallEnums").CallState.ReceivedCallWithoutOffer:case o("WAWebVoipWaCallEnums").CallState.Rejoining:case o("WAWebVoipWaCallEnums").CallState.Link:case o("WAWebVoipWaCallEnums").CallState.ConnectedLonely:case o("WAWebVoipWaCallEnums").CallState.PreCalling:case o("WAWebVoipWaCallEnums").CallState.CallStateEnding:case o("WAWebVoipWaCallEnums").CallState.CallBCallStarting:return o("WAWebCallLogMsgData.flow").CallOutcome.Ongoing}}function b(e){switch(e){case 1:return"scheduled";case 2:return"privacy";case 3:return"lightweight";default:return}}function v(e,t){return e!=null&&t!=null&&e.isSameAccountAndAddressingMode(t)}function S(e,t){return e.length!==t.length?!1:e.every(function(e){return t.some(function(t){return v(e,t)})})}function R(e,t){var n,r,a,i,l=(n=o("WAWebMsgGetters").getIsCallLink(e))!=null?n:!1,s=(r=o("WAWebMsgGetters").getIsCallLink(t))!=null?r:!1;if(l||s)return!1;var u=o("WAWebMsgGetters").getSender(e),c=o("WAWebMsgGetters").getSender(t);if(!v(u,c))return!1;var d=o("WAWebMsgGetters").getTo(e),m=o("WAWebMsgGetters").getTo(t);if(!v(d,m))return!1;var p=o("WAWebMsgGetters").getIsVideoCall(e)===o("WAWebMsgGetters").getIsVideoCall(t)&&o("WAWebMsgGetters").getIsSentByMe(e)===o("WAWebMsgGetters").getIsSentByMe(t)&&o("WAWebMsgGetters").getIsGroupCall(e)===o("WAWebMsgGetters").getIsGroupCall(t);if(!p)return!1;var _=o("WAWebMsgGetters").getIsMissedCall(e)===o("WAWebMsgGetters").getIsMissedCall(t);if(!_)return!1;var f=(o("WAWebMsgGetters").getIsCallSilenced(e)&&!o("WAWebMsgGetters").getIsSentByMe(e))===(o("WAWebMsgGetters").getIsCallSilenced(t)&&!o("WAWebMsgGetters").getIsSentByMe(t));if(!f||!o("WATimeUtils").sameDay(o("WATimeUtils").castToUnixTime(o("WAWebMsgGetters").getT(e)),o("WATimeUtils").castToUnixTime(o("WAWebMsgGetters").getT(t))))return!1;var g=(a=e.callParticipants)==null?void 0:a.map(function(e){return e.participant}),h=(i=t.callParticipants)==null?void 0:i.map(function(e){return e.participant}),y=g!=null&&h!=null&&S(g,h);return y}function L(e){if(e.length===0)return[];for(var t=[],n=r("WANullthrows")(o("WAWebFrontendMsgGetters").getAsCallLog(e[0]),"[mergeCallRecords] record is not a call log record"),a=[n.unsafe()],i=1;i<e.length;i++){var l=r("WANullthrows")(o("WAWebFrontendMsgGetters").getAsCallLog(e[i]),"[mergeCallRecords] record is not a call log record");R(n,l)?a.push(l.unsafe()):(t.push({mergedMsgs:a}),n=l,a=[l.unsafe()])}return t.push({mergedMsgs:a}),t}l.getCallStateText=d,l.getCallLogTargetDetails=m,l.get1x1CallLidOrPnDestination=_,l.getCallOutcomeFromCallResultSyncProto=g,l.getCallParticipantStateFromCallResultSyncProto=h,l.getCallOutcomeFromCallResultNative=y,l.getCallOutcomeFromCallState=C,l.getCallSilenceReason=b,l.shouldMergeCallLogRecords=R,l.mergeCallRecords=L}),226);
__d("WAWebWamEnumMultideviceActionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({LOGIN:0,LOGOUT:1,CUSTOM_AGENT_NAME:2,MESSAGE_INFO:3,ACTIVE:4,DELETE:5});i.MULTIDEVICE_ACTION_TYPE=e}),66);
__d("WAWebMdExpansionAgentBrowserMdIdWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMultideviceActionType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MdExpansionAgentBrowserMdId:[3390,{agentId:[1,e.TYPES.STRING],browserId:[2,e.TYPES.STRING],companionMdId:[5,e.TYPES.INTEGER],isCustomAgentName:[6,e.TYPES.BOOLEAN],isNewAgent:[9,e.TYPES.BOOLEAN],loginTimestamp:[3,e.TYPES.INTEGER],logoutTimestamp:[4,e.TYPES.INTEGER],mdLinkedCount:[8,e.TYPES.INTEGER],multideviceAction:[7,o("WAWebWamEnumMultideviceActionType").MULTIDEVICE_ACTION_TYPE]},[1,1,1],"regular"]},{MdExpansionAgentBrowserMdId:[]});l.MdExpansionAgentBrowserMdIdWamEvent=s}),98);
__d("WAWebBizAgentAction",["WALogger","WATimeUtils","WAWebAgentCollection","WAWebAgentModelUtils","WAWebBizGatingUtils","WAWebCmd","WAWebMdExpansionAgentBrowserMdIdWamEvent","WAWebMiscBrowserUtils","WAWebMsgCollection","WAWebSchemaMessage","WAWebUnattributedMessageCollection","WAWebUserPrefsMeUser","WAWebWamEnumMultideviceActionType","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){var t;return e.author.user!==((t=o("WAWebUserPrefsMeUser").getMaybeMePnUser())==null?void 0:t.user)}function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){if(!(s(t)||!o("WAWebAgentModelUtils").canUserSeeMessageAttribution())){var r=t.author.getDeviceId(),a=o("WAWebAgentCollection").AgentCollection.getByDeviceId(r);if(a==null){var i=n.map(function(e){return{id:e.id.toString(),deviceId:r}});o("WAWebUnattributedMessageCollection").UnattributedMessageCollection.add(i),i.forEach(function(t){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["agent: unknown agent with device id::",", delaying attribution of message id::",""])),r,t.id)});return}var l=n.map(function(e){return o("WAWebMsgCollection").MsgCollection.get(e.id)}).filter(Boolean).filter(function(e){return e.agentId==null}),u=String(a.id);l.forEach(function(e){e.agentId=u});var c=l.map(function(e){var t=e.id.toString();return{id:t,agentId:u}});yield o("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(c)}}),c.apply(this,arguments)}function d(e){if(e.agentId!=null||!o("WAWebAgentModelUtils").canUserSeeMessageAttribution())return e.agentId;var t=o("WAWebUserPrefsMeUser").getMaybeMeDevicePn();if(t!=null){var n=o("WAWebAgentCollection").AgentCollection.getByDeviceId(t.getDeviceId());if(n!=null)return n.id}}var m,p;function _(e){p=e}function f(e,t){t===void 0&&(t=!1),o("WAWebBizGatingUtils").isMultiDeviceAgentsLoggingEnabled()&&new(o("WAWebMdExpansionAgentBrowserMdIdWamEvent")).MdExpansionAgentBrowserMdIdWamEvent(babelHelpers.extends({agentId:m},e)).commitAndWaitForFlush(t)}function g(e){p!=null&&f(babelHelpers.extends({},e,p,{multideviceAction:o("WAWebWamEnumMultideviceActionType").MULTIDEVICE_ACTION_TYPE.LOGIN}))}function h(){if(o("WAWebBizGatingUtils").isMultiDeviceAgentsLoggingEnabled()){var e=o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().getDeviceId(),t=r("WAWebMiscBrowserUtils").persistentExpiringId();o("WAWebCmd").Cmd.on("logout",function(){f({browserId:t,companionMdId:e,logoutTimestamp:o("WATimeUtils").unixTimeWithoutClockSkewCorrection(),multideviceAction:o("WAWebWamEnumMultideviceActionType").MULTIDEVICE_ACTION_TYPE.LOGOUT},!0)}),document.addEventListener("visibilitychange",function(){document.hidden||f({browserId:t,companionMdId:e,multideviceAction:o("WAWebWamEnumMultideviceActionType").MULTIDEVICE_ACTION_TYPE.ACTIVE})});var n=o("WAWebAgentCollection").AgentCollection.getByDeviceId(e);n!=null?(m=n.id,g({browserId:t,companionMdId:e})):o("WAWebCmd").Cmd.on(o("WAWebCmd").APP_STATE_SYNC_COMPLETED,function(){var n=o("WAWebAgentCollection").AgentCollection.getByDeviceId(e);(n==null?void 0:n.id)!=null&&m==null&&(m=n.id,g({browserId:t,companionMdId:e}))})}}function y(e){var t=e!=null?o("WAWebAgentCollection").AgentCollection.get(e):void 0,n=r("WAWebMiscBrowserUtils").persistentExpiringId();f({browserId:n,agentId:t==null?void 0:t.id,companionMdId:t==null?void 0:t.deviceId,multideviceAction:o("WAWebWamEnumMultideviceActionType").MULTIDEVICE_ACTION_TYPE.MESSAGE_INFO})}l.updateUnattributedMessages=u,l.getAgentId=d,l.setShouldLogAgentLogin=_,l.initializeAgentLog=h,l.logMessageInfo=y}),98);
__d("WAWebBizBusinessChangeAction",["WAWebBusinessProfileCollection","WAWebConnModel","WAWebContactGetters","WAWebStateUtils"],(function(t,n,r,o,a,i,l){var e=function(t){var e=o("WAWebStateUtils").unproxy(t),n=e.businessProfile,r=e.id,a=e.isBusiness||o("WAWebContactGetters").getIsMe(e)&&o("WAWebConnModel").Conn.isSMB;a&&!n?e.addChild("businessProfile",o("WAWebBusinessProfileCollection").BusinessProfileCollection.gadd(r)):!a&&n&&(e.stopListening(n),e.businessProfile=void 0,n.delete())};l.handleBusinessChange=e}),98);
__d("WAWebQueryBusinessCategoriesJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=new(r("WADeprecatedWapParser"))("businessCategoriesResponse",function(e){e.assertTag("iq"),e.assertFromServer();var t=e.child("response"),n=[],r="";try{var o=t.maybeChild("not_a_biz");o==null||o.forEachChildWithTag("category",function(e){r=e.attrString("id")});var a=t.child("categories");a.forEachChildWithTag("category",function(e){var t=e.attrString("id"),o=e.contentString();n.push({id:t,localized_display_name:o,not_a_biz:r.length?t===r:!1})})}catch(e){}return{categories:n,notABizId:r}});function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n,r="profile_typeahead",a=(n=o("WAWap")).wap("iq",{to:n.S_WHATSAPP_NET,xmlns:"fb:thrift_iq",id:n.generateId(),type:"get"},n.wap("request",{op:n.CUSTOM_STRING(r),type:"catkit",v:"1"},n.wap("query",null,t))),i=yield o("WADeprecatedSendIq").deprecatedSendIq(a,e);if(i.success)return i.result;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(i.errorCode)}),u.apply(this,arguments)}l.queryBusinessCategories=s}),98);
__d("WAWebBusinessProfileCategoriesBridge",["WAWebBizLogQplEvents","WAWebQueryBusinessCategoriesJob"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebBizLogQplEvents").qplPointProfileCatsView("datasource_start"),o("WAWebQueryBusinessCategoriesJob").queryBusinessCategories(e).then(function(e){return o("WAWebBizLogQplEvents").qplPointProfileCatsView("datasource_end"),e})}l.queryBusinessCategories=e}),98);
__d("WAWebBizBusinessProfileAction",["WALogger","WAPromiseDelays","WAWebBusinessCategoriesResultModel","WAWebBusinessProfileCategoriesBridge","WAWebBusinessProfileCollection","WAWebBusinessProfileJob","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebQueryBusinessProfile","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","cr:3128","err","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(!r("gkx")("26258")){var a,i=(a=n("cr:3128")==null?void 0:n("cr:3128").debugSmbConfigs.delayBusinessProfileQuery)!=null?a:0;i&&(o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[queryBusinessProfile] delaying "," seconds before querying business profile"])),i),yield o("WAPromiseDelays").delayMs(i*1e3))}var l=yield o("WAWebQueryBusinessProfile").queryBusinessProfile(e,t);if(!r("gkx")("26258")){var c,d=n("cr:3128")==null?void 0:n("cr:3128").debugSmbConfigs.mockBusinessProfileId,m=n("cr:3128")==null||(c=n("cr:3128").debugSmbConfigs)==null?void 0:c.mockBusinessProfileQueryPayload;m&&l[0].wid.equals(d)&&(o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[queryBusinessProfile] merging mock payload to the busines profile"]))).devConsole({response:l,mockPayload:m}),l[0].profile=babelHelpers.extends({},l[0].profile,m))}return l}),m.apply(this,arguments)}function p(e){return e===o("WAWebBusinessCategoriesResultModel").BUSINESS_CATEGORY_EMPTY_STR_ID?o("WAWebBusinessProfileCategoriesBridge").queryBusinessCategories(""):o("WAWebBusinessProfileCategoriesBridge").queryBusinessCategories(e)}function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebBusinessProfileJob").updateCartEnabled(e),n=o("WAWebBusinessProfileCollection").BusinessProfileCollection.getValid(o("WAWebUserPrefsMeUser").getMePnUserOrThrow()),r=n==null?void 0:n.profileOptions;n&&r&&(r.cartEnabled=t,o("WAWebBusinessProfileCollection").BusinessProfileCollection.add(n,{merge:!0}))}),f.apply(this,arguments)}function g(t){return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] fetching business public key certificate from server"]))),o("WAWebPersistedJobManager").getJobManager().waitUntilCompleted(o("WAWebPersistedJobDefinitions").jobSerializers.getPublicKey(t))}function h(e){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] fetching signed user info from server"])));var t=yield o("WAWebPersistedJobManager").getJobManager().waitUntilCompleted(o("WAWebPersistedJobDefinitions").jobSerializers.getSignedUserInfo(e)),n=t.phoneNumber,a=t.phoneNumberSignature,i=t.phoneNumberSignatureExpiration,l=t.businessDomain;if(n==null||i==null||a==null||l==null)throw r("err")("Unexpected null or undefined");return{phoneNumber:n,phoneNumberSignature:a,phoneNumberSignatureExpiration:i,businessDomain:l}}),y.apply(this,arguments)}l.queryBusinessProfile=d,l.queryBusinessCategories=p,l.updateCartEnabled=_,l.queryBusinessPublicKey=g,l.querySignedUserInfo=h}),98);
__d("WAWebChatAssignmentLogEvents.flow",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["CONTACT_INFO_SCREEN","CONVERSATION_MENU","MULTI_SELECT","SYSTEM_MESSAGE"]);i.ChatAssignmentEntryPointType=e}),66);
__d("WAWebChatAssignmentSystemMsg",["WAWebMsgKey","WAWebMsgType","WAWebUserPrefsMeUser","WAWebViewMode.flow"],(function(t,n,r,o,a,i,l){function e(e,t,n){var a=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),i=r("WAWebMsgKey").newId_DEPRECATED(),l=new(r("WAWebMsgKey"))({fromMe:o("WAWebUserPrefsMeUser").isMeAccount(e),remote:e,id:i});return{id:l,t:n,type:"notification_template",kind:o("WAWebMsgType").MsgKind.NotificationTemplate,viewMode:o("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:t==null?"chat_assignment_unassign":"chat_assignment",from:e,to:a,templateParams:t==null?[]:[t.name]}}l.genChatAssignmentNotificationTemplateMsg=e}),98);
__d("WAWebBizChatAssignmentAction",["Promise","WATimeUtils","WAWebAgentCollection","WAWebBizChatAssignmentOpenedAction","WAWebBizGatingUtils","WAWebChatAssignmentCollection","WAWebChatAssignmentLogEvents","WAWebChatAssignmentLogEvents.flow","WAWebChatAssignmentModel","WAWebChatAssignmentSync","WAWebChatAssignmentSystemMsg","WAWebChatAssignmentUtils","WAWebChatCollection","WAWebCmd","WAWebHandleSingleMsg","WAWebMobilePlatforms","WAWebNotificationController","WAWebNotificationsChatAssignmentNotification","WAWebSchemaChatAssignment","WAWebSyncdCoreApi","WAWebSyncdOrphan","WAWebUserPrefsMeUser","WAWebUserPrefsStore","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(o("WAWebChatAssignmentUtils").canAssignChats()){var n=o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().getDeviceId(),a=e.map(function(e){var r=e.chat.id.toString({legacy:!0}),a=e.agentId,i=o("WAWebAgentCollection").AgentCollection.getByDeviceId(n),l=(i==null?void 0:i.deviceId)===n&&t!==o("WAWebChatAssignmentLogEvents.flow").ChatAssignmentEntryPointType.MULTI_SELECT&&t!==o("WAWebChatAssignmentLogEvents.flow").ChatAssignmentEntryPointType.CONTACT_INFO_SCREEN;return{id:r+"_"+(a||""),chatId:r,agentId:a!=null?a:"",chatOpenedByAgent:l}}),i=e.map(function(e){return e.chat.assignedAgent!=null});yield o("WAWebSyncdCoreApi").lockForSync(["chat-assignment"],yield r("WAWebChatAssignmentSync").createChatAssignmentMutations(a),function(){return d(a)}),e.forEach(function(n,r){var a;o("WAWebChatAssignmentLogEvents").logChatAssignment(n.chat,(a=n.agentId)!=null?a:"",i[r],t,e.length)}),p(e.map(function(e){var t=e.chat,n=e.agentId,r=o("WAWebAgentCollection").AgentCollection.get(n!=null?n:"");return{chatId:t.id,agent:r,timestamp:o("WATimeUtils").unixTime()}})),r("WAWebUserPrefsStore").setUser("chat_assignment_agent_has_assigned_chats",!0),a.filter(function(e){var t=e.chatOpenedByAgent;return t===!0}).forEach(function(e){var t=o("WAWebChatCollection").ChatCollection.get(e.chatId);t!=null&&o("WAWebBizChatAssignmentOpenedAction").markChatAsOpened(t,!0)})}}),u.apply(this,arguments)}function c(e){return o("WAWebChatAssignmentCollection").ChatAssignmentCollection.getModelsArray().filter(function(t){var n=t.chatId;return e.includes(n)}).map(function(e){return e.id})}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=c(t.map(function(e){var t=e.chatId;return t})),a=t.map(function(e){var t=e.id,n=e.chatId,r=e.agentId,a=e.chatOpenedByAgent;return new(o("WAWebChatAssignmentModel")).ChatAssignment({id:t,chatId:n,agentId:r,chatOpenedByAgent:a,agent:o("WAWebAgentCollection").AgentCollection.get(r)})});o("WAWebChatAssignmentCollection").ChatAssignmentCollection.remove(r),o("WAWebChatAssignmentCollection").ChatAssignmentCollection.add(a);var i=o("WAWebSchemaChatAssignment").getChatAssignmentTable();yield(e||(e=n("Promise"))).all([i.bulkRemove(r),i.bulkCreateOrMerge(t)])}),m.apply(this,arguments)}function p(e){o("WAWebBizGatingUtils").chatAssignmentSystemMessagesEnabled()&&e.forEach(function(e){var t=e.chatId,n=e.agent,r=e.timestamp,a=o("WAWebChatCollection").ChatCollection.get(t);o("WAWebHandleSingleMsg").handleSingleMsg({chatId:t,newMsg:o("WAWebChatAssignmentSystemMsg").genChatAssignmentNotificationTemplateMsg(t,n,r),handleSingleMsgOrigin:"chatAssignmentSystemMsg"}).then(function(){a!=null&&o("WAWebChatAssignmentLogEvents").logSystemMessageGeneratedFromCompanion(a)}).catch(function(){a!=null&&o("WAWebChatAssignmentLogEvents").logSystemMessageFailedToGenerate(a)})})}function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(o("WAWebMobilePlatforms").isSMB()){var t=c([e.toString({legacy:!0})]);yield o("WAWebSchemaChatAssignment").getChatAssignmentTable().bulkRemove(t),o("WAWebChatAssignmentCollection").ChatAssignmentCollection.remove(t)}}),f.apply(this,arguments)}function g(){o("WAWebCmd").Cmd.once(o("WAWebCmd").APP_STATE_SYNC_COMPLETED,function(){o("WAWebSyncdOrphan").checkOrphanAgents(o("WAWebAgentCollection").AgentCollection.getModelsArray().map(function(e){var t=e.id;return t})),o("WAWebSyncdOrphan").checkOrphanChatAssignments(o("WAWebChatAssignmentCollection").ChatAssignmentCollection.getModelsArray().map(function(e){var t=e.id;return t}))})}function h(e,t){if(!(!o("WAWebBizGatingUtils").chatAssignmentNotificationsEnabled()||!o("WAWebChatAssignmentUtils").canAssignChats())){var n=o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().getDeviceId(),r=e.filter(function(e){var t=o("WAWebAgentCollection").AgentCollection.get(e.agentId);return(t==null?void 0:t.deviceId)===n});r.length!==0&&o("WAWebNotificationController").WANotificationController.triggerNotification(new(o("WAWebNotificationsChatAssignmentNotification")).WAWebNotificationsChatAssignmentNotification({chats:r.map(function(e){return o("WAWebWidFactory").createWid(e.chatId)}),assignmentTimestamps:t}))}}l.changeChatAssignment=s,l.createChatAssignmentSystemMsgs=p,l.removeChatAssignmentsForChat=_,l.checkOrphanAssignments=g,l.triggerChatAssignmentNotification=h}),98);
__d("WAWebBizChatAssignmentOpenedAction",["WAWebAgentCollection","WAWebChatAssignmentCollection","WAWebChatAssignmentOpenedStatusSync","WAWebChatAssignmentUtils","WAWebSchemaChatAssignment","WAWebSyncdCoreApi","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){e.forEach(function(e){var t=e.id,n=e.chatOpenedByAgent,r=o("WAWebChatAssignmentCollection").ChatAssignmentCollection.get(t);r&&r.set("chatOpenedByAgent",n)});var t=o("WAWebSchemaChatAssignment").getChatAssignmentTable();yield t.bulkCreateOrMerge(e)}),s.apply(this,arguments)}function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var a;if(o("WAWebChatAssignmentUtils").canAssignChats()){var i=o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().getDeviceId(),l=t.id,s=(a=o("WAWebAgentCollection").AgentCollection.getByDeviceId(i))==null?void 0:a.id;if(s!=null){var u=[{chatId:l,agentId:s,chatOpened:n}],c=u.map(function(e){var t=e.chatId.toString({legacy:!0});return{id:t+"_"+s,chatId:t,agentId:s,chatOpenedByAgent:n}});yield o("WAWebSyncdCoreApi").lockForSync(["chat-assignment"],yield r("WAWebChatAssignmentOpenedStatusSync").createChatOpenedMutations(c),function(){return e(c)})}}}),c.apply(this,arguments)}l.updateLocalOpenedState=e,l.markChatAsOpened=u}),98);
__d("WAWebBizInteractiveMessageQuickReplyAction",["WANullthrows","WAWebCarouselMsgUtils","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(e.isCarouselCard)return u(e,t);var n=d(e,t),r=o("WAWebSchemaMessage").getMessageTable(),a=yield r.get(e.id.toString());yield o("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge([{id:a==null?void 0:a.id,interactivePayload:n}]),e.set("interactivePayload",n)}),s.apply(this,arguments)}function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=d(e.interactivePayload,t),a=r("WANullthrows")(o("WAWebCarouselMsgUtils").getParentMsgFromCarouselCard(e)),i=r("WANullthrows")(a.carouselCardsParsed).slice(),l=i.findIndex(function(t){return t.id.toString()===e.id.toString()});i[l]=babelHelpers.extends({},i[l],{interactivePayload:n});var s=o("WAWebSchemaMessage").getMessageTable(),u=yield s.get(a.id.toString());yield s.bulkCreateOrMerge([{id:u==null?void 0:u.id,carouselCardsParsed:i}]),a.set("carouselCardsParsed",i),e.set("interactivePayload",n)}),c.apply(this,arguments)}function d(e,t){var n;return babelHelpers.extends({},e,{buttons:e==null||(n=e.buttons)==null?void 0:n.map(function(e,n){if(e.buttonParamsJson===void 0)return e;var r=JSON.parse(e.buttonParamsJson);return t===n&&(r.disabled=!0),{name:e.name,buttonParamsJson:JSON.stringify(r)}})})}l.markInteractiveButtonClicked=e,l.rebuildInteractivePayloadWithDisabledButton=d}),98);
__d("WAWebBizProductCatalogAction",["WAWebBizCreateProductInquiry","WAWebBizProductCatalogBridge","WAWebBusinessProfileCollection","WAWebCatalogCollection","WAWebCatalogVariantHelper","WAWebCmd","WAWebComposeBoxActions","WAWebDrawerManager","WAWebFindChatAction","WAWebFrontendConstants","WAWebMsgCollection","WAWebStateUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t,n,r,o,a){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a,i){var l;n===void 0&&(n=100),r===void 0&&(r=100);var s,u,c,d=yield o("WAWebBusinessProfileCollection").BusinessProfileCollection.find(e),m=(l=o("WAWebCatalogCollection").CatalogCollection.get(e))==null?void 0:l.productCollection.get(t);return o("WAWebCatalogVariantHelper").shouldRequestVariantInfo(d,m)&&(s=o("WAWebCatalogVariantHelper").FULL_VARIANT_INFO_FIELDS,u=o("WAWebCatalogVariantHelper").VARIANT_THUMBNAIL_IMAGE_SIZE,c=o("WAWebCatalogVariantHelper").VARIANT_THUMBNAIL_IMAGE_SIZE),o("WAWebBizProductCatalogBridge").queryProduct(e,t,n,r,a,i,s,u,c)}),s.apply(this,arguments)}function u(e,t,n,r,a,i,l,s,u,c){return n===void 0&&(n=5),r===void 0&&(r=100),a===void 0&&(a=100),l===void 0&&(l=!1),o("WAWebBizProductCatalogBridge").queryCatalog(e,t,n,r,a,i,l,s,u,c)}function c(e,t,n,r,a){return n===void 0&&(n=100),r===void 0&&(r=100),o("WAWebBizProductCatalogBridge").queryProductList(e,t,n,r,a)}function d(e,t){return o("WAWebBizProductCatalogBridge").appealProduct(e,t)}function m(e,t,n){return o("WAWebBizProductCatalogBridge").reportProduct(e,t,n)}function p(e,t,n){return t===void 0&&(t=100),n===void 0&&(n=100),o("WAWebBizProductCatalogBridge").addProduct(e,t,n)}function _(e,t,n){return t===void 0&&(t=100),n===void 0&&(n=100),o("WAWebBizProductCatalogBridge").editProduct(e,t,n)}function f(e){return o("WAWebBizProductCatalogBridge").deleteProducts(e)}function g(e,t,n){var r=e.catalogWid;if(t){var a=t.productCollection.get(e.id),i=a?o("WAWebStateUtils").unproxy(a):o("WAWebStateUtils").unproxy(e);if(i){var l=i.getProductImageCollectionHead(),s=l==null?void 0:l.mediaData;s&&o("WAWebFindChatAction").findOrCreateLatestChat(r,"bizProductCatalogAction").then(function(e){var t=e.chat;o("WAWebCmd").Cmd.openChatFromUnread({chat:t}).then(function(e){if(e){var a=o("WAWebStateUtils").unproxy(o("WAWebBizCreateProductInquiry").createProductInquiry(i,t.id,r,s,n==null?void 0:n.session.toString()));o("WAWebMsgCollection").MsgCollection.add(a),t.composeQuotedMsg=a,o("WAWebComposeBoxActions").ComposeBoxActions.focus(t),window.innerWidth<=o("WAWebFrontendConstants").LAYOUT_2COLUMNS_MAX_WIDTH&&o("WAWebDrawerManager").DrawerManager.closeDrawerRight()}})})}}}l.queryProduct=e,l.queryCatalog=u,l.queryProductList=c,l.appealProduct=d,l.reportProduct=m,l.addProduct=p,l.editProduct=_,l.deleteProducts=f,l.sendProductToChat=g}),98);
__d("WAWebBizProductMessageListAction",["WAWebMsgCollection"],(function(t,n,r,o,a,i,l){function e(e,t){var n,r=o("WAWebMsgCollection").MsgCollection.get(t),a=r==null||(n=r.list)==null||(n=n.productListInfo)==null||(n=n.headerImage)==null?void 0:n.productId;e.id===a&&r!=null&&(r.productHeaderImageRejected=!0)}l.updateProductListHeaderImageRejected=e}),98);
__d("WAWebBizUpdateContactsWithVerifiedNamesAction",["WANullthrows","WAWebApiVerifiedBusinessName","WAWebBusinessProfileTypes","WAWebContactCollection","WAWebHandleMsgTypes.flow","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){var n={};for(var r of e){var a=r.id;n[a.user]=r}for(var i of t){var l=i.id;if(!l.isBot()){var s=n[l.user],u=!!s,c=s||{},d=c.level,m=c.name,p=c.isApi,_=c.isSmb,f=c.privacyMode,g=!!p,h={isBusiness:u,isEnterprise:g,isSmb:!!_,verifiedLevel:o("WAWebBusinessProfileTypes").convertLevel(d),verifiedName:m,privacyMode:f};i.set(h)}}}var s=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=(yield o("WAWebApiVerifiedBusinessName").getAllVerifiedNames()).filter(Boolean).map(function(e){var t=e.id,n=e.name,a=e.level,i=e.isApi,l=e.isSmb,s=e.privacyMode;return{id:o("WAWebWidFactory").createUserWidOrThrow(t),name:n,level:a,isApi:i,isSmb:l,privacyMode:s?{actualActors:r("WANullthrows")(o("WAWebHandleMsgTypes.flow").ActualActorsEnumType.cast(s.actualActors)),hostStorage:r("WANullthrows")(o("WAWebHandleMsgTypes.flow").HostStorageEnumType.cast(s.hostStorage)),privacyModeTs:s.privacyModeTs}:null}});e(t,o("WAWebContactCollection").ContactCollection.toArray())});return function(){return t.apply(this,arguments)}})();l.updateContactsWithVerifiedNames=e,l.applyContactBusinessProps=s}),98);
__d("WAWebBizVerifiedNameAction",["Promise","WAWebBizUpdateContactsWithVerifiedNamesAction","WAWebChatCollection","WAWebFrontendChatGetters","WAWebHandleBusinessNameChangeLidHelpers","WAWebHandlePrivacyModeUpdateMsgAction","WAWebSchemaVerifiedBusinessName","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(t.length!==0){yield(e||(e=n("Promise"))).all(t.map(function(e){var t=e.id,n=e.verifiedName,r=n==null?void 0:n.privacyMode;if(r!=null){var a=o("WAWebChatCollection").ChatCollection.getLatestChatForWid(t);if(!(a==null||o("WAWebFrontendChatGetters").getShouldAppearInList(a)===!0))return o("WAWebHandlePrivacyModeUpdateMsgAction").handlePrivacyModeTransition(a.id,r,{chat:a,bypassVerifiedNameUpdate:!0,shouldRunMATonWid:!1})}}));var r=o("WAWebHandleBusinessNameChangeLidHelpers").getVerifiedNamesToUpdateLidAware(t).map(function(e){var t=e.id,n=e.verifiedName;if(n==null)return null;var r=n.level,o=n.serial,a=n.name,i=n.isApi,l=n.isSmb,s=n.privacyMode;return{id:t.isLid()?t.toString():t.user,level:r,serial:o,name:a,isApi:i,isSmb:l,privacyMode:s?{actualActors:s.actualActors,hostStorage:s.hostStorage,privacyModeTs:s.privacyModeTs}:null}}).filter(Boolean);yield o("WAWebSchemaVerifiedBusinessName").getVerifiedBusinessNameTable().bulkCreateOrReplace(r),yield o("WAWebBizUpdateContactsWithVerifiedNamesAction").applyContactBusinessProps()}}),u.apply(this,arguments)}l.handleVerifiedNameSync=s}),98);
__d("WAWebBizOrderAction",["WAWebBizOrderBridge"],(function(t,n,r,o,a,i,l){function e(e,t,n,r,a){return o("WAWebBizOrderBridge").queryOrder(e,t,n,r,a)}function s(e,t){return o("WAWebBizOrderBridge").createOrder(e,t)}l.queryOrder=e,l.createOrder=s}),98);
__d("WAWebFindChatAction",["WAAbortError","WALogger","WAWebApiContact","WAWebChatGetExistingBridge","WAWebCheckChatExistsOrCreate","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebMessageProcessUtils","WAWebSyncContactJob","WAWebUsernameTypes","WAWebWid","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y;function C(e,t,n){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){if(!r("WAWebWid").isUser(e))return v(e,t).then(function(e){var t=e.chat;return t});var a=yield o("WAWebChatGetExistingBridge").getExisting(e);return a||v(e,t,n).then(function(e){var t=e.chat;return t})}),b.apply(this,arguments)}function v(e,t,n){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a){var i={chatId:t};if(t.isRegularUser()){if(o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: using migration rules (chat: ",", origin: ",")"])),i.chatId.toLogString(),n);var l=o("WAWebLidMigrationUtils").toUserLid(t);l==null&&(o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: could not convert targetId to lid for chatOrigin ",""])),n).sendLogs("findOrCreateLatestChat_lid_not_found",{sampling:.01}),yield o("WAWebSyncContactJob").syncContactListJob([t],!0,"query"),l=o("WAWebLidMigrationUtils").toUserLidOrThrow(t)),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: current lid: ",""])),l.toLogString()),i=yield o("WAWebMessageProcessUtils").selectChatForOneOnOneMessage({lid:l}),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: selected destination: ",""])),i.chatId.toLogString())}else if(t.isLid()&&n!=="username_contactless_search"){var C=yield o("WAWebChatGetExistingBridge").getExisting(i.chatId);if(C==null){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: applying pre-migration rules (chat: ",", origin: ",")"])),i.chatId.toLogString(),n);var b=o("WAWebApiContact").getPhoneNumber(t);if(b==null)throw o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: could not find phone number for lid while enforcing pre-migration rules. source: ",""])),n).sendLogs("findOrCreateLatestChat: could not find phone number for lid while enforcing pre-migration rules"),r("err")("findOrCreateLatestChat: could not find phone number for lid while enforcing pre-migration rules");i={chatId:b}}}}o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: after chat selection (chat: ",", origin: ",")"])),i.chatId.toLogString(),n);var v=a!=null?a:{},S=v.forceUsync,R=v.isGroupJoin,L=v.signal,E=v.nextPrivacyMode;if(L!=null&&L.aborted)throw new(o("WAAbortError")).AbortError;var k=yield o("WAWebChatGetExistingBridge").getExisting(i.chatId);if(k)return{chat:k,created:!1};var I={createdLocally:!0};R===!0&&(I.notSpam=!0);var T=i.chatId;if(T.isLid()){var D=o("WAWebApiContact").getPhoneNumber(T);n==="username_contactless_search"?D!=null?(i.chatId=D,o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: creating pn chat with ",""])),i.chatId.toLogString())):(I.lidOriginType=o("WAWebUsernameTypes").LidOriginType.GENERAL,o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: creating username chat with ",""])),i.chatId.toLogString())):(I.lidOriginType=o("WAWebUsernameTypes").LidOriginType.GENERAL,o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: creating lid chat with ",", origin ",""])),i.chatId.toLogString(),n)),o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()||o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat will create Lid chat for origin ",""])),n).sendLogs("findOrCreateLatestChat will create Lid chat")}o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: will create chat with ",", origin ",""])),i.chatId.toLogString(),n);var x=yield o("WAWebCheckChatExistsOrCreate").checkChatExistsOrCreate({destinationChat:i,msgMeta:null,chatOriginType:n,initialProps:I,options:{forceUsync:S,nextPrivacyMode:E}}),$=yield o("WAWebChatGetExistingBridge").getExisting(i.chatId);if($==null){var P;throw r("err")("findChat: new chat not found "+((P=i.chatId)==null?void 0:P.toLogString()))}return{chat:$,created:!x}}),S.apply(this,arguments)}l.findExistingChat=C,l.findOrCreateLatestChat=v}),98);
__d("WAWebSendNotSpamJob",["WALogger","WASmaxGroupsAcknowledgeGroupRPC","WAWebChatGetters","WAWebNoop","WAWebSchemaChat","WAWebWidToJid","err"],(function(t,n,r,o,a,i,l){var e,s;function u(t){return o("WAWebChatGetters").getIsGroup(t)&&(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[callp] acknowledging group ",""])),t.id.toLogString()),o("WASmaxGroupsAcknowledgeGroupRPC").sendAcknowledgeGroupRPC({iqTo:o("WAWebWidToJid").widToGroupJid(t.id)}).catch(r("WAWebNoop"))),o("WAWebSchemaChat").getChatTable().merge(t.id.toString(),{notSpam:!0}).catch(function(e){throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["get chat table merge failed"]))).verbose().devConsole(e).sendLogs("get chat table merge failed when sending spam report"),r("err")("get chat table merge failed")})}l.default=u}),98);
__d("WAWebSendNotSpamAction",["fbt","Promise","WAFilteredCatch","WALogger","WAWebActionToast.react","WAWebBackendErrors","WAWebChatGetters","WAWebSendNotSpamJob","WAWebStateUtils","WAWebToastManager","react"],(function(t,n,r,o,a,i,l,s){var e,u,c,d=c||(c=r("react"));function m(e,t){return p(o("WAWebStateUtils").unproxy(e),t)}function p(t,a,i){a===void 0&&(a=!1),i===void 0&&(i=o("WAWebActionToast.react").genId());var l=t.promises,c=t.notSpam;if(c)return(u||(u=n("Promise"))).resolve();if(l.sendNotSpam)return l.sendNotSpam;var m=l.sendNotSpam=r("WAWebSendNotSpamJob")(t);if(a){var _=new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Marcando como no spam\u2026")),f=m.then(function(){return new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Marcado como no spam"))}).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").ServerStatusCodeError,function(){return new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"No se pudo marcar como no spam."))})).catch(function(n){return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["models:chat:sendNotSpam dropped"]))).devConsole(n),new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"No se pudo marcar como no spam."),{actionText:s._(/*BTDS*/"Vuelve a intentarlo."),actionHandler:function(){return p(t,a,i)}})});o("WAWebToastManager").ToastManager.open(d.jsx(o("WAWebActionToast.react").ActionToast,{id:i,initialAction:_,pendingAction:f}))}return m.then(function(){if(t.set({notSpam:!0}),o("WAWebChatGetters").getIsGroup(t)){var e;(e=t.groupMetadata)==null||e.set({trusted:!0})}}).finally(function(){t.isTrusted(),l.sendNotSpam=null})}l.default=m}),226);
__d("WAWebSetArchiveChatActionUtils",["WALogger","WAWebSettingsGetters","WAWebSettingsModel"],(function(t,n,r,o,a,i,l){var e;function s(t){return o("WAWebSettingsGetters").getShowArchiveV2(r("WAWebSettingsModel"))?!1:(o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["archive:shouldUnarchiveChat unarchive chat"]))),!0)}l.shouldUnarchiveChat=s}),98);
__d("WAWebWamEnumWebcQueryTriggerType",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNKNOWN:0,USER_SCROLL:1,NEW_MESSAGE_PREFETCH:2,SEARCH_RESULT_CLICK:3});i.WEBC_QUERY_TRIGGER_TYPE=e}),66);
__d("WAWebHandleNewMsgAction",["Promise","WAFilteredCatch","WALogger","WATimeUtils","WAWebApiChat","WAWebBackendErrors","WAWebBotGenTypingIndicatorMsg","WAWebChangePresenceHandlerAction","WAWebChatGetters","WAWebChatLoadMessages","WAWebCmd","WAWebCollectionConstants","WAWebCommonCTWAConsumerTransparency","WAWebCommonCTWALogging","WAWebCommonMsgUtils","WAWebConversionTupleCollection","WAWebDBUpdateChatTable","WAWebEnvironment","WAWebFrontendMsgGetters","WAWebGroupUnreadMessageType","WAWebHandleMsgReceiptCommon","WAWebInvisiblePlaceholderViewModeProcessor","WAWebLidMigrationUtils","WAWebMmSignalSharingLoggingEvents","WAWebMsgGetters","WAWebMsgType","WAWebNewsletterGatingUtils","WAWebNoop","WAWebRichOrderStatusLogger","WAWebSchemaChat","WAWebSendNotSpamAction","WAWebSetArchiveChatActionUtils","WAWebUnreadMentionModel","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebViewModeUtils","WAWebWamEnumWebcQueryTriggerType","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h;function y(){return!o("WAWebCmd").Cmd.isOfflineDeliveryEnd}var C=!1;function b(t,a){if(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["handleNewMsgForChat chatId: "," type: ",", sub type: ",""])),t.id.toLogString(),a.type,a.subtype),o("WAWebChatGetters").getIsNewsletter(t)&&!o("WAWebNewsletterGatingUtils").isNewsletterEnabled()||!a)return(h||(h=n("Promise"))).resolve();var i=(h||(h=n("Promise"))).resolve();return o("WAWebMsgGetters").getIsSentByMe(a)&&!t.notSpam&&!o("WAWebChatGetters").getIsNewsletter(t)&&(i=r("WAWebSendNotSpamAction")(t,!1)),o("WAWebFrontendMsgGetters").getEventType(a)===o("WAWebCommonMsgUtils").EventType.IGNORE?(h||(h=n("Promise"))).resolve():i.then(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e={};t.promises.updateSortTime&&t.promises.updateSortTime.abortController.abort(),o("WAWebMsgGetters").getIsSentByMeFromWeb(a)&&t.archive&&o("WAWebSetArchiveChatActionUtils").shouldUnarchiveChat(o("WAWebMsgGetters").getIsSentByMe(a))&&(o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["chat model: unarchiving chat"]))),e.archive=!1),t.promises.setArchive&&t.promises.setArchive.abortController.abort(),!o("WAWebChatGetters").getIsNewsletter(t)&&a.subtype!==o("WAWebBotGenTypingIndicatorMsg").BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE&&(o("WAWebMsgGetters").getIsSentByMe(a)?t.markedUnread=!1:r("WAWebChangePresenceHandlerAction")({id:t.id,participant:a.author,type:"idle"},!1)),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["handleNewMsgForChat: before updating chat table ",""])),t.id.toLogString());try{yield o("WAWebDBUpdateChatTable").updateChatTable(t.id,e)}catch(e){var n=yield o("WAWebSchemaChat").getChatTable().get(t.id.toString());throw o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["handleNewMsgForChat: unable to update chat table for id:",". chat exists in db: "," error: ",""])),t.id.toLogString(),n!=null,e).sendLogs("handle-new-msg-cannot-update-chat"),e}var i=babelHelpers.extends({},e);try{var l;if(y()&&(o("WAWebViewModeUtils").isViewModeVisibleInSurface(o("WAWebViewMode.flow").ViewModeSurface.CHAT,a.viewMode)||(l=o("WAWebInvisiblePlaceholderViewModeProcessor").InvisiblePlaceholderViewModeProcessor.compatibleMessageTypes)!=null&&l.includes(a.type)))o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["handleNewMsgForChat: updating UI immediatelly ",""])),t.id.toLogString()),i.t=a.t,(o("WAWebFrontendMsgGetters").getEventType(a)===o("WAWebCommonMsgUtils").EventType.AMBIENT||o("WAWebFrontendMsgGetters").getEventType(a)===o("WAWebCommonMsgUtils").EventType.DEFAULT)&&!a.id.fromMe&&(i.unreadCount=t.unreadCount+1||1,t.activeUnreadCount>0&&(i.activeUnreadCount=t.activeUnreadCount+1));else{var f=yield o("WAWebApiChat").getChatMeta(t.id),g=f.unreadCount,h=f.timestamp;i.unreadCount=g,i.t=h,t.activeUnreadCount>0&&(i.activeUnreadCount=t.activeUnreadCount+Number(o("WAWebViewModeUtils").isViewModeVisibleInSurface(o("WAWebViewMode.flow").ViewModeSurface.CHAT,a.viewMode)))}i.unreadDividerOffset=0}catch(e){if(o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["onNewMsg: unable to find metadata from chat table for id:",". stack: ",""])),t.id.toLogString(),e.stack),!C){var b,v;C=!0;var S=yield o("WAWebSchemaChat").getChatTable().get(t.id.toString()),R=t.accountLid?yield o("WAWebSchemaChat").getChatTable().get((b=t.accountLid)==null?void 0:b.toString()):null;o("WAWebLidMigrationUtils").logLidMetadata(),o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["onNewMsg error chat_id: ",", account_lid: ",", chat by id: ",", chat by accountLid ",""])),t.id.toLogString(),(v=t.accountLid)==null?void 0:v.toLogString(),S!=null,R!=null).tags("missing-lid"),o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["onNewMsg: unable to find metadata from chat table for id:",". stack: ",""])),t.id.toLogString(),e.stack).sendLogs("onNewMsg: unable to find metadata from chat table")}}return i})).then(function(e){t.set(e),a.ctwaContext!=null&&(o("WAWebCommonCTWAConsumerTransparency").handleConsumerTransparencyForNewMsg(t,a.ctwaContext.conversionData,a.ctwaContext.conversionSource),o("WAWebCommonCTWALogging").maybeSetCtwaMessageReceivedInUserPreferenceStore(a));var n=r("WAWebConversionTupleCollection").get(t.id);if(n)n.timestamp=o("WATimeUtils").unixTime();else if(a.ctwaContext!=null){var i=a.ctwaContext,l=i.conversionSource,s=i.conversionData;r("WAWebConversionTupleCollection").add({conversionSource:l,conversionData:s,id:t.id,timestamp:o("WATimeUtils").unixTime()},{merge:!0})}var u=o("WAWebUserPrefsMeUser").getMePnUserOrThrow();if(a.type==="gp2"&&(a.subtype==="add"||a.subtype==="create")&&t.getGroupMetadataCollection().trigger("group_participant_change_"+u.toString(),t.id),o("WAWebMsgGetters").getIsSentByMe(a))t.activeUnreadCount>0&&(t.activeUnreadCount=0,t.markedUnread=!1);else{switch(o("WAWebFrontendMsgGetters").getEventType(a)){case o("WAWebCommonMsgUtils").EventType.DEFAULT:case o("WAWebCommonMsgUtils").EventType.AMBIENT:o("WAWebFrontendMsgGetters").getEventType(a)===o("WAWebCommonMsgUtils").EventType.DEFAULT&&o("WAWebCmd").Cmd.alertNewMsg(a),t.msgs.length<o("WAWebCollectionConstants").MSG_PRELOAD_THRESHOLD&&!o("WAWebChatGetters").getIsNewsletter(t)&&o("WAWebChatLoadMessages").loadEarlierMsgs(t,void 0,o("WAWebWamEnumWebcQueryTriggerType").WEBC_QUERY_TRIGGER_TYPE.NEW_MESSAGE_PREFETCH).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").E404,r("WAWebNoop"))).catch(function(e){o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["chat:onNewMsg failed\n",""],["chat:onNewMsg failed\\n",""])),e)});break;case o("WAWebCommonMsgUtils").EventType.NOTEWORTHY:(a.type===o("WAWebMsgType").MSG_TYPE.CALL_LOG&&!r("WAWebEnvironment").isWindows||a.subtype==="sender_invite")&&o("WAWebCmd").Cmd.alertNewMsg(a);break;case o("WAWebCommonMsgUtils").EventType.SIGNIFICANT:{if(a.type==="gp2"&&a.subtype==="add"&&o("WAWebUserPrefsMeUser").isMeAccount(a.recipients[0])&&!t.contact.name)return;o("WAWebCmd").Cmd.alertNewMsg(a);var c=t.getGroupMetadataCollection();c.trigger("group_participant_change_"+u.toString(),t.id);break}default:break}var d=a.mediaData;if(d&&(d.type==="image"||d.type==="video")&&o("WAWebCmd").Cmd.newMediaMsg(a),e.unreadCount!=null&&e.unreadCount>0&&!y()&&o("WAWebHandleMsgReceiptCommon").processOrphanPeerReceipt(a.id),o("WAWebMsgGetters").getIsImportantMessage(a)){var m,p=new(r("WAWebUnreadMentionModel"))({id:a.id.toString(),timestamp:a.t});if((m=t.groupMetadata)==null||m.unreadMentionMetadata.addUnreadMentions(p,o("WAWebGroupUnreadMessageType").UnreadMessageType.NEW_MESSAGE),t.archiveAtMentionViewedInDrawer){var _=new Map;_.set(t.id.toString(),!1),o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["handleNewMsgForChat: will mark chat for archive"]))),o("WAWebApiChat").updateChatArchiveDrawer(_),t.archiveAtMentionViewedInDrawer=!1}}}o("WAWebMmSignalSharingLoggingEvents").logMmSignalSharingNewMessageEvent({chat:t,newMsg:a}),o("WAWebRichOrderStatusLogger").logRichOrderStatusInconsistencies(a)})}l.handleNewMsgForChat=b}),98);
__d("WAWebSendAddonMsgChatAction",["WAJobOrchestratorTypes","WAWebOrchestratorNonPersistedJob","WAWebSendMsgRecordAction","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendMessage",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebSendMsgRecordAction").sendAddonRecord(e)}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}l.addAndSendAddonToChat=e}),98);
__d("WAWebBizShowOrderEphemeralSystemAction",["WAWebBizGatingUtils","WAWebDBChatEphemeralExemptionData","WAWebDBEphemeralDisplayedExemptions","WAWebOrderEphemeralExemptionUtil","WAWebOrderSystemMsg"],(function(t,n,r,o,a,i,l){function e(e,t){if(!o("WAWebBizGatingUtils").inOrderMessagesEphemeralExceptionEnabled())return null;var n=e.safe(),r=e.interactiveType,a=e.nativeFlowName;if(!o("WAWebOrderEphemeralExemptionUtil").isMessageTypeExemptedFromDisappearing(n.type,r,a))return null;var i={id:t.id.toString(),ephemeralDuration:t.ephemeralDuration,ephemeralDisplayedExemptions:t.ephemeralDisplayedExemptions};return o("WAWebOrderEphemeralExemptionUtil").shouldShowOrderExemptionSystemMessage(i)?(t.ephemeralDisplayedExemptions=o("WAWebDBEphemeralDisplayedExemptions").EphemeralExemptionType.ORDERS_AND_PAYMENTS,o("WAWebDBChatEphemeralExemptionData").persistsEphemeralDisplayedExemptions(t.id,t.ephemeralDuration,o("WAWebDBEphemeralDisplayedExemptions").EphemeralExemptionType.ORDERS_AND_PAYMENTS),o("WAWebOrderSystemMsg").getOrderEphemeralExemptionSystemMsg(t.id)):(o("WAWebOrderEphemeralExemptionUtil").shouldUnsetChatEphemeralDisplayedExemption(i)&&(t.ephemeralDisplayedExemptions=o("WAWebDBEphemeralDisplayedExemptions").EphemeralExemptionType.UNSET,o("WAWebDBChatEphemeralExemptionData").persistsEphemeralDisplayedExemptions(t.id,t.ephemeralDuration,o("WAWebDBEphemeralDisplayedExemptions").EphemeralExemptionType.UNSET)),null)}l.getMaybeSystemMsgForOrderEphemeralExemption=e}),98);
__d("WAWebEmptyChatSystemMsg",["WAWebInitialSystemMsg","WAWebMsgGetters","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(!o("WAWebMsgGetters").getIsGroupMsg(e)&&t.msgs.length===0){var n;return r("WAWebInitialSystemMsg")(t.id,t.contact.privacyMode,(n=t.contact.businessProfile)==null?void 0:n.automatedType)}return null}),s.apply(this,arguments)}l.default=e}),98);
__d("WAWebLidMigrationFrontendUtils",["WALogger","WAWebCurrentUser","WAWebLidMigrationUtils","WAWebSchemaChat","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d;function m(e,t,n){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){try{if(o("WAWebLidMigrationUtils").shouldHaveAccountLid(t.id)){var a,i,l,m,p,_,f=yield o("WAWebSchemaChat").getChatTable().get(t.id.toString()),g=o("WAWebLidMigrationUtils").toLid(t.id);o("WAWebLidMigrationUtils").logLidMetadata();var h="isEmployee? "+o("WAWebCurrentUser").isEmployee().toString()+", source: "+r+",\n      input chat.id: "+t.id.toLogString()+". input chat.account_lid: "+((a=(i=t.accountLid)==null?void 0:i.toLogString())!=null?a:"")+",\nchat exist in db: "+(f!=null).toString()+", db chat account lid: "+((f==null?void 0:f.accountLid)==null?"null":o("WAWebWidFactory").createWid(f==null?void 0:f.accountLid).toLogString())+"\nchat.id lid mapping: "+((l=g==null?void 0:g.toLogString())!=null?l:"")+",\nmsg kind: "+((m=n==null?void 0:n.kind)!=null?m:"")+" "+((p=n==null?void 0:n.type)!=null?p:"")+" "+((_=n==null?void 0:n.subtype)!=null?_:"");if(t.accountLid==null)o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["validateMissingAccountLid: model does not have account_lid. ",""])),h).sendLogs("no-account-lid-for-send").tags("missing-lid");else if(f==null)o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["validateMissingAccountLid: chat does not exist in DB. ",""])),h).sendLogs("chat-not-in-db-for-new-message").tags("missing-lid");else if(f.accountLid==null)o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["validateMissingAccountLid: DB does not have account_lid. ",""])),h).sendLogs("db-chat-has-empty-accountlid-for-new-message").tags("missing-lid");else{var y;o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["validateMissingAccountLid: chat is in DB and has account_lid. chat id: ",", account lid: "," ",""])),t.id.toLogString(),(y=t.accountLid)==null?void 0:y.toLogString(),r)}}}catch(e){o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["validateMissingAccountLid unexpected error while validating chat. ",""])),e)}}),p.apply(this,arguments)}l.validateMissingAccountLid=m}),98);
__d("WAWebSendMsgChatAction",["Promise","WAJobOrchestratorTypes","WALogger","WATimeUtils","WAWebApiGroupInviteV4Store","WAWebAppTracker","WAWebBizAgentAction","WAWebBizShowOrderEphemeralSystemAction","WAWebDBProcessMessage","WAWebDBRevokeInviteV4","WAWebDBThreadMetadataBulkHelper","WAWebEmptyChatSystemMsg","WAWebLid1X1MigrationGating","WAWebLidMigrationFrontendUtils","WAWebLidMigrationUtils","WAWebMaybeGetAppendedAiThreadAttributes","WAWebMessageSendPerfReporter","WAWebMessageSendReporter","WAWebMiscErrors","WAWebMsgCollection","WAWebMsgInfoUtils","WAWebMsgModel","WAWebMsgType","WAWebOrchestratorNonPersistedJob","WAWebPrivacyMode_WORKER_INCOMPATIBLE","WAWebSendMsgRecordAction","WAWebStateUtils","WAWebThreadMsgUtils","WAWebWamMsgUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_;function f(e,t,n){return C(o("WAWebStateUtils").unproxy(e),t,n)}function g(e,t){return v(o("WAWebStateUtils").unproxy(e),t)}function h(e,t,n){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){r===void 0&&(r=function(t){return(_||(_=n("Promise"))).resolve(t)});var a=yield t,i=o("WAWebMsgCollection").MsgCollection.add(babelHelpers.extends({},a))[0];if(i)return b(e,r(i))}),y.apply(this,arguments)}function C(t,a,i){i===void 0&&(i=void 0),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["_addAndSendMsgToChat start chatId: ",""])),t.id.toLogString());var l,f=(_||(_=n("Promise"))).resolve(a).then((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n;o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["_addAndSendMsgToChat consistent msg id? ",". ",", ",""])),t.id.equals(e.id.remote),t.id.toLogString(),(n=e.id.remote)==null?void 0:n.toLogString()),yield o("WAWebLidMigrationFrontendUtils").validateMissingAccountLid(t,e,"addAndSendMsgToChat");var a=o("WAWebPrivacyMode_WORKER_INCOMPATIBLE").getPrivacyModeFromModel(t.id),i=yield o("WAWebMaybeGetAppendedAiThreadAttributes").maybeGetAppendedAiThreadAttributes(e),_=i[0],f=i[1],g=babelHelpers.extends({},e,{agentId:o("WAWebBizAgentAction").getAgentId(e),threadIds:_,aiThreadInfo:f});a&&(g.privacyModeWhenSent=a);var h=new(o("WAWebMsgModel")).Msg(g),y=o("WAWebMsgCollection").MsgCollection.add(h)[0];if(y){var C,b,v=!!((C=t.groupMetadata)!=null&&C.isLidAddressingMode),S=o("WAWebMsgInfoUtils").getGroupMessageSendReporterOptions(t.id,o("WAWebWamMsgUtils").msgIsLid(y,t.id,v));if(y.wamMessageSendReporter=new(o("WAWebMessageSendReporter")).MessageSendReporter(y,S),y.wamMessageSendPerfReporter=new(o("WAWebMessageSendPerfReporter")).MessageSendPerfReporter({chatWid:y.to,mediaType:y.getWamMediaType(),messageType:y.getWamMessageType()}),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["_addAndSendMsgToChat before system messages ",""])),t.id.toLogString()),l=yield r("WAWebEmptyChatSystemMsg")(y,t),!l){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["_addAndSendMsgToChat before ephemeral system messages"])));var R=o("WAWebBizShowOrderEphemeralSystemAction").getMaybeSystemMsgForOrderEphemeralExemption(y,t);R&&(l=[R])}o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["_addAndSendMsgToChat after system messages"])));var L=l?[].concat(l,[g]):[g];return(b=y.wamMessageSendPerfReporter)==null||b.startSavedStage(),o("WAWebDBProcessMessage").storeMessages(L,t.id).then(function(e){var t;if((t=y.wamMessageSendPerfReporter)==null||t.postSavedStage(),o("WAWebThreadMsgUtils").isThreadMsg(g)&&o("WAWebDBThreadMetadataBulkHelper").persistNewMessagesThreadMetadataInBulk([g]),y.type===o("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE){var n=parseInt(y.inviteCodeExp,10),r=y.from.isLid()?o("WAWebLidMigrationUtils").toLid(y.to):y.to;if(!r){var a=o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated();o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[group-invites] isLidMigrated: ",""])),a);var i="[group-invites] failed to get lid mapping when revoking existing duplicate group invite";o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["",""])),i).sendLogs(i);return}return o("WAWebDBRevokeInviteV4").revokeGroupInviteV4(y.from.toString(),r.toString(),y.inviteGrp,n).then(function(){return o("WAWebApiGroupInviteV4Store").persistGroupInviteV4Msg(y.id.toString(),{id:y.id.toString(),from:y.from.toString(),to:r.toString(),groupId:y.inviteGrp,expiration:n,expired:o("WATimeUtils").unixTime()>=n})})}}).then(function(){return y.waitForPrep().then(function(){return y})})}throw new(o("WAWebMiscErrors")).ModelCreateError("Msg",g)});return function(t){return e.apply(this,arguments)}})()),g=b(t,f,l),h=i?g.then(i).then(function(){return g}):g,y=v(t,h);return[g,y]}function b(e,t,n){return e.addQueue.enqueue(t).then(function(t){var r;return o("WAWebAppTracker").AppTracker.start(o("WAWebAppTracker").AppTrackerType.SendMessage),(r=t.wamMessageSendPerfReporter)==null||r.startRenderedStage(),n&&e.msgs.add(n),e.msgs.add(t)[0]}).then(function(t){var n;return e.createdLocally=!1,(n=t.wamMessageSendPerfReporter)==null||n.postRenderedStage(),t})}function v(e,t){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendMessage",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var n=yield e.sendQueue.enqueue(t);return o("WAWebSendMsgRecordAction").sendMsgRecord(n)}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}l.addAndSendMsgToChat=f,l.resendMsgToChat=g,l.addMsgToChat=h}),98);
__d("WAWebSendTcTokenChatAction",["WALogger","WATimeUtils","WAWebABProps","WAWebChatCollection","WAWebLidMigrationUtils","WAWebSchemaChat","WAWebSetPrivacyTokensJob","WAWebTrustedContactsUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(!(!t.isUserNotPSA()||t.isBot())){var n=o("WAWebChatCollection").ChatCollection.get(t);if(n!=null&&o("WAWebTrustedContactsUtils").shouldSendNewToken(n.tcTokenSenderTimestamp))try{var r=o("WATimeUtils").unixTime(),a;if(o("WAWebABProps").getABPropConfigValue("lid_trusted_token_issue_to_lid")?a=o("WAWebLidMigrationUtils").toLid(t):a=o("WAWebLidMigrationUtils").toPn(t),a==null)return;yield o("WAWebSetPrivacyTokensJob").issuePrivacyToken(a,[o("WAWebSetPrivacyTokensJob").TokenType.TrustedContact],r);var i={tcTokenSenderTimestamp:r};n.set(i),yield o("WAWebSchemaChat").getChatTable().merge(t.toString(),i)}catch(t){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["sendTcToken failed - ",""])),t).verbose().devConsole(t).sendLogs("send-tc-token-failed")}}}),u.apply(this,arguments)}l.sendTcToken=s}),98);
__d("WAWebNonJidMentionType",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum")({MENTION_ALL:1}),l=e;i.default=l}),66);
__d("WAWebSendTextMsgChatAction",["WAJobOrchestratorTypes","WALogger","WAWebABProps","WAWebAppTracker","WAWebBizAgentAction","WAWebBizBotTosUtils","WAWebBotGating","WAWebBotMessageSecret","WAWebBotProfileCollection","WAWebBotSystemMsg","WAWebChatGetters","WAWebDBProcessMessage","WAWebDBThreadMetadataBulkHelper","WAWebEmptyChatSystemMsg","WAWebGetEphemeralFieldsMsgActionsUtils","WAWebLidMigrationFrontendUtils","WAWebLimitSharingPropMappingUtils","WAWebMaybeGetAppendedAiThreadAttributes","WAWebMessagePluginGenerateReportingTokenContent","WAWebMessageSendPerfReporter","WAWebMessageSendReporter","WAWebMessagingGatingUtils","WAWebMsgDataUtils","WAWebMsgInfoUtils","WAWebMsgModel","WAWebMsgType","WAWebNewsletterGatingUtils","WAWebNonJidMentionType","WAWebOrchestratorNonPersistedJob","WAWebPresenceChatAction","WAWebPrivacyMode_WORKER_INCOMPATIBLE","WAWebProductCatalogLogEvents","WAWebQuestionsGatingUtils","WAWebSendMsgRecordAction","WAWebStateUtils","WAWebThreadMsgUtils","WAWebUserPrefsMeUser","WAWebWamMsgUtils","WAWebWid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e,t,n){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){n===void 0&&(n={});var r=o("WAWebStateUtils").unproxy(e),a=yield m(r,t,n);if(a)return yield o("WAWebBizBotTosUtils").maybeShowBizBot1pTos(r),_(r,a)}),d.apply(this,arguments)}function m(e,t,n){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a){var i;a===void 0&&(a={});var l=(n||"").trim();if(l==="")return null;var u=a,c=u.linkPreview,d=u.quotedMsg,m=u.mentionedJidList,p=u.groupMentions,_=u.quotedMsgAdminGroupJid,f=u.quotedMsgAdminGroupSubject,g=u.quotedMsgAdminParentGroupJid,h=u.selectedId,y=u.selectedIndex,C=u.selectedCarouselCardIndex,b=u.ctwaContext,v=u.encryptedCommentFields,S=u.isWamoSub,R=u.paymentLinkMetadata,L=u.isQuestion,E=u.questionReplyQuotedMessage,k=u.threadIds,I=u.aiThreadInfo;o("WAWebPresenceChatAction").clearPresence(t);var T;if(d)T=d.msgContextInfo(t.id);else if(_!=null&&f!=null&&g!=null)T={quotedRemoteJid:_,quotedGroupSubject:f,quotedParentGroupJid:g};else if(_!=null)T={quotedRemoteJid:_};else if(L===!0)if(o("WAWebQuestionsGatingUtils").isQuestionSenderEnabledForMsgType(t,o("WAWebMsgType").MSG_TYPE.CHAT))T={isQuestion:!0};else return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[questions] Unsupported question message type: ",""])),o("WAWebMsgType").MSG_TYPE.CHAT).tags("questions").devConsole(t,l,a).sendLogs("questions-unsupported-message-type-"+o("WAWebMsgType").MSG_TYPE.CHAT),null;else if(E)if(o("WAWebQuestionsGatingUtils").isQuestionReplySenderEnabledForMsgType(t,o("WAWebMsgType").MSG_TYPE.CHAT))T={questionReplyQuotedMessage:E};else return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[questions] Unsupported question reply message type: ",""])),o("WAWebMsgType").MSG_TYPE.CHAT).tags("questions").devConsole(t,l,a).sendLogs("questions-unsupported-reply-message-type-"+o("WAWebMsgType").MSG_TYPE.CHAT),null;var D;t.limitSharing!=null&&(D=t.limitSharing,D.initiatedByMe=o("WAWebUserPrefsMeUser").isMeAccount(D.initiatedBy),r("WAWebWid").isGroup(t.id)&&typeof D.trigger=="string"&&(D.trigger=o("WAWebLimitSharingPropMappingUtils").getLimitSharingTriggerFromGroupSettingsChange(D.trigger)),delete D.initiatedBy);var x=babelHelpers.extends({},c),$=babelHelpers.extends({},x,T,{mentionedJidList:m,groupMentions:p,ctwaContext:b,body:l,subtype:Object.keys(x).length>0?"url":null,urlText:t.urlText,urlNumber:t.urlNumber,botMsgBodyType:a.botMsgBodyType},yield o("WAWebMsgDataUtils").genOutgoingMsgData(t,"chat"),{paymentLinkMetadata:R,limitSharing:D,threadIds:k,aiThreadInfo:I}),P=yield o("WAWebMaybeGetAppendedAiThreadAttributes").maybeGetAppendedAiThreadAttributes($),N=P[0],M=P[1];$.threadIds=N,$.aiThreadInfo=M,t.urlText&&(t.urlText=void 0),t.urlNumber&&(t.urlNumber=void 0),y!=null&&($.type="template_button_reply",$.selectedId=h,$.selectedIndex=y,$.selectedCarouselCardIndex=C),$.type!==o("WAWebMsgType").MSG_TYPE.PROTOCOL&&Object.assign($,o("WAWebGetEphemeralFieldsMsgActionsUtils").getEphemeralFields(t));var w=o("WAWebPrivacyMode_WORKER_INCOMPATIBLE").getPrivacyModeFromModel(t.id);if(w!=null&&($.privacyModeWhenSent=w),$.agentId=o("WAWebBizAgentAction").getAgentId($),o("WAWebBotGating").isBotEnabled()){var A=m==null?void 0:m.find(function(e){return e.isBot()});if(A!=null&&A.isBot()){$.invokedBotWid=A;var F=d==null?void 0:d.botTargetSenderJid;F!=null&&!o("WAWebUserPrefsMeUser").isMeAccount(F)&&($.botTargetSenderJid=d==null?void 0:d.botTargetSenderJid)}}var O=t.isCAGAdmin(),B=$.subtype==="url"&&o("WAWebABProps").getABPropConfigValue("web_youtube_rcat_chat_generation_enabled"),W=!!(o("WAWebBotGating").isBotEnabled()&&((i=$.invokedBotWid)!=null&&i.isBot())),q=!!(o("WAWebBotGating").isBotEnabled()&&$.to.isBot()),U=o("WAWebMessagingGatingUtils").isReportingTokenSendingEnabled()&&o("WAWebMessagePluginGenerateReportingTokenContent").isMsgTypeReportingTokenCompatible($.type,$.subtype);if((O||B||W||q||U)&&($.messageSecret=self.crypto.getRandomValues(new Uint8Array(32))),W&&($.botMessageSecret=yield o("WAWebBotMessageSecret").genBotMsgSecretFromMsgSecret($.messageSecret)),W||q){var V;if(W?V=$.invokedBotWid:q&&(V=$.to),V!=null){var H,G=(H=o("WAWebBotProfileCollection").BotProfileCollection.get(V))==null?void 0:H.personaId;G!=null&&($.botPersonaId=G)}}d&&d.type===o("WAWebMsgType").MSG_TYPE.PRODUCT&&o("WAWebProductCatalogLogEvents").logProductMessageBusinessSend(d,d.sessionId),v&&($.type=o("WAWebMsgType").MSG_TYPE.COMMENT,$.encIv=v==null?void 0:v.encIv,$.encPayload=v==null?void 0:v.encPayload,$.targetMessageKey=v==null?void 0:v.targetMessageKey),S===!0&&o("WAWebChatGetters").getIsNewsletter(t)&&o("WAWebNewsletterGatingUtils").isWamoSubCreatorExperienceSupported()&&($.isWamoSub=!0);var z=0;return a.maybeNonJidMentioned===!0&&/@all\b/g.test(l)&&(z|=r("WAWebNonJidMentionType").MENTION_ALL),z>0&&($.nonJidMentions=z),$}),p.apply(this,arguments)}function _(e,t){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var a,i,l,s;o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["addAndSendTextMsg chat: ",""])),e.id.toLogString()),yield o("WAWebLidMigrationFrontendUtils").validateMissingAccountLid(e,t,"addAndSendTextMsg");var c=new(o("WAWebMsgModel")).Msg(t),d=o("WAWebBotSystemMsg").getMaybeSysMsgForBotInvoke(c,e),m=[].concat((a=yield r("WAWebEmptyChatSystemMsg")(c,e))!=null?a:[],[d]).filter(Boolean),p=!!((i=e.groupMetadata)!=null&&i.isLidAddressingMode),_=o("WAWebMsgInfoUtils").getGroupMessageSendReporterOptions(e.id,o("WAWebWamMsgUtils").msgIsLid(t,e.id,p));c.wamMessageSendReporter=new(o("WAWebMessageSendReporter")).MessageSendReporter(c,_),c.wamMessageSendPerfReporter=new(o("WAWebMessageSendPerfReporter")).MessageSendPerfReporter({chatWid:c.to,mediaType:c.getWamMediaType(),messageType:c.getWamMessageType()}),o("WAWebAppTracker").AppTracker.start(o("WAWebAppTracker").AppTrackerType.SendMessage),(l=c.wamMessageSendPerfReporter)==null||l.startRenderedStage(),m.length>0&&e.msgs.add(m),e.msgs.add(c),(s=c.wamMessageSendPerfReporter)==null||s.postRenderedStage(),e.createdLocally=!1;var f=m.length>0?[].concat(m,[t]):[t];return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendMessage",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var n,r;(n=c.wamMessageSendPerfReporter)==null||n.startSavedStage(),yield o("WAWebDBProcessMessage").storeMessages(f,e.id),d&&(yield e.updateBotInvokeSystemMsgCreated()),(r=c.wamMessageSendPerfReporter)==null||r.postSavedStage(),o("WAWebThreadMsgUtils").isThreadMsg(t)&&(yield o("WAWebDBThreadMetadataBulkHelper").persistNewMessagesThreadMetadataInBulk([t]));var a=yield o("WAWebSendMsgRecordAction").sendMsgRecord(c);return a}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}),f.apply(this,arguments)}l.sendTextMsgToChat=c,l.createTextMsgData=m,l.addAndSendTextMsg=_}),98);
__d("WAWebSendUnstarAllChatAction",["fbt","WAFilteredCatch","WALogger","WAWebActionToast.react","WAWebBackendErrors","WAWebChatCollection","WAWebChatSendStarMsgsBridge","WAWebStarredMsgCollection","WAWebStateUtils","WAWebToastManager","react"],(function(t,n,r,o,a,i,l,s){var e,u,c=u||(u=r("react"));function d(e,t){return m(e,t&&o("WAWebStateUtils").unproxy(t))}function m(t,n){var r=n?n.promises:o("WAWebChatCollection").ChatCollection.promises,a=n?n.id:void 0;if(r.sendUnstarAll)return r.sendUnstarAll;var i=r.sendUnstarAll=o("WAWebChatSendStarMsgsBridge").sendUnstarAll(t,a),l=new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Dejando de destacar todos los mensajes\u2026")),u=i.then(function(){return new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Todos los mensajes no destacados"))}).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").ServerStatusCodeError,function(e){if(e.statusCode>=400)return new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"No se pudieron dejar de destacar todos los mensajes."))})).catch(function(r){return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["models:chat:sendUnstarAll dropped"]))).devConsole(r),new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"No se pudieron dejar de destacar todos los mensajes."),{actionText:s._(/*BTDS*/"Vuelve a intentarlo."),actionHandler:function(){return m(t,n)}})});return o("WAWebToastManager").ToastManager.open(c.jsx(o("WAWebActionToast.react").ActionToast,{initialAction:l,pendingAction:u})),i.then(function(){t.forEach(function(e){e.set("star",!1)}),n?o("WAWebStarredMsgCollection").removeStarredMsgs(t):(o("WAWebStarredMsgCollection").AllStarredMsgsCollection.reset(),o("WAWebChatCollection").ChatCollection.forEach(function(e){e.starredMsgs&&e.starredMsgs.reset()}))}).finally(function(){r.sendUnstarAll=null})}l.unstarAllMessages=d}),226);
__d("WAWebUpdateDraftMessageChatJob",["WAAbortError","WAJobOrchestratorTypes","WAWebDBChatSerialization","WAWebDBUpdateChatTable","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.chatId,n=e.draftMessage,r=e.abortSignal,a=o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateDraftMessageChat",function(e){if(e.abortSignal.aborted)throw new(o("WAAbortError")).AbortError;return o("WAWebDBUpdateChatTable").updateChatTable(e.chatId,o("WAWebDBChatSerialization").serializeChat({draftMessage:e.draftMessage}))},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted({chatId:t,draftMessage:n,abortSignal:r});yield a}),s.apply(this,arguments)}l.updateDraftMessageChat=e}),98);
__d("WAWebUpdateDraftMessageChatAction",["WAWebChatCollection","WAWebNewsletterCollection","WAWebUpdateDraftMessageChatJob","WAWebWid"],(function(t,n,r,o,a,i,l){function e(e,t){var n=r("WAWebWid").isNewsletter(e)?r("WAWebNewsletterCollection").get(e):o("WAWebChatCollection").ChatCollection.get(e),a=new AbortController,i=o("WAWebUpdateDraftMessageChatJob").updateDraftMessageChat({chatId:e,draftMessage:t,abortSignal:a.signal});if(i.finally(function(){if(n){var e;(n==null||(e=n.promises.updateDraftMessage)==null?void 0:e.promise)===i&&(n.promises.updateDraftMessage=null)}}),n){var l=n.promises;l.updateDraftMessage!=null&&l.updateDraftMessage.abortController.abort(),n.draftMessage=t,n.promises.updateDraftMessage={promise:i,abortController:a}}return i}l.updateDraftMessageChat=e}),98);
__d("WAWebUpdateLastAddOnPreviewChatAction",["WAWebChatCollection","WAWebMsgKey","WAWebNewsletterCollection","WAWebWid"],(function(t,n,r,o,a,i,l){function e(e){e.forEach(function(e,t){var n=r("WAWebWid").isNewsletter(t)?r("WAWebNewsletterCollection").get(t):o("WAWebChatCollection").ChatCollection.get(t);n!=null&&n.set({chatlistPreview:e,lastReactionPreview:void 0})})}function s(e){var t=new Set(e.map(function(e){return r("WAWebMsgKey").fromString(e).remote.toString()}));t.forEach(function(t){var n,a,i=(n=o("WAWebChatCollection").ChatCollection.get(t))!=null?n:r("WAWebNewsletterCollection").get(t);if(i!=null){var l=(a=i.chatlistPreview)==null?void 0:a.parentMsgKey;l!=null&&e.includes(l)&&i.unset(["chatlistPreview","lastReactionPreview"])}})}l.updateModelsForLastAddOnPreview=e,l.deleteModelsForLastAddOnPreview=s}),98);
__d("WAWebUpdateUnreadChatAction",["fbt","Promise","WAFilteredCatch","WALogger","WAShiftTimer","WAWebABProps","WAWebActionToast.react","WAWebApiChat","WAWebBackendErrors","WAWebChatGetters","WAWebChatSeenBridge","WAWebCmd","WAWebConstantsDeprecated","WAWebCurrentUser","WAWebDBUpdateChatTable","WAWebNoop","WAWebPromiseQueue","WAWebSendReadReceiptJob","WAWebStateUtils","WAWebStreamModel","WAWebToastManager","WAWebUim","asyncToGeneratorRuntime","err","gkx","react"],(function(t,n,r,o,a,i,l,s){var e,u,c,d,m,p,_,f,g=f||(f=r("react"));function h(e,t,n){return n===void 0&&(n=!0),E(o("WAWebStateUtils").unproxy(e),t,n)}function y(){var e=null,t=new(o("WAShiftTimer")).ShiftTimer(function(t){var n=t.chat_,r=t.afterAvailable;v(n,r),e=null});return(function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n,r){if(e!=null){var a=e,i=a[0],l=a[1],s=i.id.toString(),u=n.id.toString();s!==u&&(t.cancel(),v(i,l),e=null)}if(!t.isScheduled()){var c=o("WAWebABProps").getABPropConfigValue("web_resume_optimized_read_receipt_send_interval");t.onOrAfter(c,{chat_:n,afterAvailable:r})}e=[n,r]});return function(e,t){return r.apply(this,arguments)}})()}var C=y(),b=function(t,n){return n===void 0&&(n=!0),o("WAWebCmd").Cmd.isOfflineDeliveryEnd?v(t,n):C(t,n)};function v(e,t){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(t===void 0&&(t=!0),o("WAWebCurrentUser").isEmployee()&&o("WAWebUim").isCmdPressed()){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["sendSeen: skip since cmd is pressed"])));return}var r=o("WAWebStateUtils").unproxy(e);yield(_||(_=n("Promise"))).all([I(r,t),O(r,t)]).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").ServerStatusCodeError,function(e){o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["sendSeen: got status ",""])),e.status)}))}),S.apply(this,arguments)}function R(e,t,n){return x(o("WAWebStateUtils").unproxy(e),t,n)}function L(e){P(o("WAWebStateUtils").unproxy(e))}function E(t,a,i,l){l===void 0&&(l=o("WAWebActionToast.react").genId()),a?t.active&&(t.markedUnread=!0):t.markedUnread=!1;var u=t.promises;if(u.markUnread)return u.markUnread;var c=u.markUnread=a?T(t):(_||(_=n("Promise"))).all([I(t),O(t)]),d=a?new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Marcando como no le\u00eddo\u2026")):new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Marcando como le\u00eddo\u2026")),m=c.then(function(){var e=a?s._(/*BTDS*/"Marcado como no le\u00eddo"):s._(/*BTDS*/"Marcado como le\u00eddo");return i?new(o("WAWebActionToast.react")).ActionType(e,{actionText:s._(/*BTDS*/"Deshacer"),actionHandler:function(){return E(t,!a,i,l)}}):new(o("WAWebActionToast.react")).ActionType(e)}).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").ServerStatusCodeError,function(e){if(e.status>=400)return a?new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"No se pudo marcar el chat como no le\u00eddo.")):new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"No se pudo marcar el chat como le\u00eddo."));throw r("err")("invalid response status")})).catch(function(){var e=a?s._(/*BTDS*/"No se pudo marcar el chat como no le\u00eddo."):s._(/*BTDS*/"No se pudo marcar el chat como le\u00eddo.");return i?new(o("WAWebActionToast.react")).ActionType(e,{actionText:s._(/*BTDS*/"Vuelve a intentarlo."),actionHandler:function(){return E(t,a,i,l)}}):new(o("WAWebActionToast.react")).ActionType(e)});return o("WAWebToastManager").ToastManager.open(g.jsx(o("WAWebActionToast.react").ActionToast,{id:l,initialAction:d,pendingAction:m})),c.then(r("WAWebNoop")).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").ServerStatusCodeError,function(t){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["markUnread: got status ",""])),t.status)})).finally(function(){u.markUnread=null})}function k(e){r("gkx")("26258")||o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[update-unread]: ",""])),e)}function I(e,t){if(t===void 0&&(t=!0),k("sendSeen: start"),e.markedUnread||e.unreadCount===0)return k("markedUnread: "+String(e.markedUnread)),k("unreadCount: "+e.unreadCount),k("sendSeen: end-1"),(_||(_=n("Promise"))).resolve();if(!o("WAWebStreamModel").Stream.available&&t)return k("stream unavailable"),e.listenToOnce(o("WAWebStreamModel").Stream,"change:available",function(){return I(e)}),k("sendSeen: end-2"),(_||(_=n("Promise"))).resolve();k("stream available"),k("unreadCount: "+e.unreadCount),k("pendingSeenCount: "+e.pendingSeenCount);var a=e.unreadCount-e.pendingSeenCount;k("unreadCountDelta: "+a);var i=e.unreadCount===-1&&a===-1;if(a<=0&&!i)return k("sendSeen: end-3"),(_||(_=n("Promise"))).resolve();e.disableUnreadAnchor=!0,e.pendingSeenCount=e.unreadCount,k("pendingSeenCount set to: "+e.unreadCount);var l=function(){e.pendingSeenCount-=a,k("pendingSeenCount set to "+e.pendingSeenCount),e.pendingSeenCount<0&&(o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["models:chat:sendSeen unread "," pending: "," delta: ",""])),e.unreadCount,e.pendingSeenCount,a),e.pendingSeenCount=0)},s=r("gkx")("26258")?e.getLastMsgKeyForAction():e.lastReceivedKey;return o("WAWebChatSeenBridge").sendConversationSeen(e,s,a).then(function(){N(e,a)}).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").ServerStatusCodeError,function(e){return l(),(_||(_=n("Promise"))).reject(e)})).then(function(){k("sendSeen: end-4")})}function T(e){return D.apply(this,arguments)}function D(){return D=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.getLastMsgKeyForAction();try{yield o("WAWebChatSeenBridge").sendConversationUnseen(e.id,t),L(e)}catch(t){return o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").ServerStatusCodeError,function(t){return e.markedUnread=!1,(_||(_=n("Promise"))).reject(t)})(t)}}),D.apply(this,arguments)}function x(e,t,n){return $.apply(this,arguments)}function $(){return $=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){r===void 0&&(r=!1),k("markSeen: start - "+String(t));var a=null;t!=null?t>0&&t<=e.unreadCount?a=e.unreadCount-t:t===-1&&e.unreadCount<=0&&(a=0):a=0;var i=a==null?(_||(_=n("Promise"))).resolve():o("WAWebChatSeenBridge").markConversationSeen(e.id,a);if(yield i,t!=null&&r){var l=e.pendingSeenCount-t;e.pendingSeenCount=Math.max(0,l),k("pendingSeenCount set to "+e.pendingSeenCount)}a!=null&&(e.unreadCount=a,k("unreadCount set to "+a)),e.unreadMsgAnchor=void 0,e.markedUnread=!1,e.unreadDividerOffset=0,k("markSeen: end")}),$.apply(this,arguments)}function P(e){(e.unreadCount===0||e.unreadCount===r("WAWebConstantsDeprecated").MARKED_AS_UNREAD)&&(e.active&&(e.markedUnread=!0),o("WAWebChatSeenBridge").markConversationUnseen(e.id).then(function(){e.unreadCount=r("WAWebConstantsDeprecated").MARKED_AS_UNREAD}))}function N(e,t,n){return M.apply(this,arguments)}function M(){return M=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){n===void 0&&(n=!0);var r=yield o("WAWebApiChat").getChatMeta(e.id),a=r.unreadCount;if(k("updateUnreadCount: old "+e.unreadCount+", new "+a),e.unreadCount=a,e.unreadDividerOffset=0,e.unreadMsgAnchor=void 0,e.markedUnread=!1,n){var i=e.pendingSeenCount-t;e.pendingSeenCount=Math.max(0,i)}}),M.apply(this,arguments)}function w(e){if(o("WAWebChatGetters").getIsGroup(e)){var t;(t=e.groupMetadata)==null||t.unreadMentionMetadata.reset()}}function A(e){r("gkx")("26258")||o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[message-edit/send-seen] ",""])),e)}var F=new(o("WAWebPromiseQueue")).PromiseQueue;function O(e,t){return B.apply(this,arguments)}function B(){return B=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(t===void 0&&(t=!0),e.unreadEditTimestampMs!=null){if(A("sendSeen: start - "+String(e.unreadEditTimestampMs)),!o("WAWebStreamModel").Stream.available&&t){e.listenToOnce(o("WAWebStreamModel").Stream,"change:available",function(){return O(e)}),A("sendSeen: end - stream unavailable");return}var r=e.unreadEditTimestampMs;yield F.enqueue(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(e.unreadEditTimestampMs==null){A("sendSeen: end - no unread edits");return}if(yield o("WAWebSendReadReceiptJob").markEditedMsgsRead(e.id,{trusted:e.trusted}),A("sendSeen: marked edit as read"),r!==e.unreadEditTimestampMs){A("sendSeen: end - has new unread edits");return}e.unreadEditTimestampMs=null,o("WAWebDBUpdateChatTable").updateChatTable(e.id,{unreadEditTimestampMs:null}),A("sendSeen: end - all edits are marked as read")}))}}),B.apply(this,arguments)}l.markUnread=h,l.sendSeenDebounced=b,l.sendSeen=v,l.markSeen=R,l.markUnseen=L,l.updateUnreadCountMD=N,l.clearUnreadMentions=w}),226);
__d("WAWebUpdateSubgroupsCommunityAction",["WAWebApiUnjoinedSubgroupMetadataStore","WAWebChatCollection","WAWebGroupMetadataCollection","WAWebGroupQueryBridge","WAWebGroupUnjoinedSubgroupJob","WAWebUnjoinedSubgroupMetadataCollection","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){e.joinedSubgroups=r("WAWebGroupMetadataCollection").filter(function(t){var n;return((n=t.parentGroup)==null?void 0:n.equals(e.id))&&t.participants.iAmMember()}).map(function(e){return e.id})}function s(e){e.unjoinedSubgroups=r("WAWebUnjoinedSubgroupMetadataCollection").filter(function(t){return t.parentGroupId.equals(e.id)}).map(function(e){return e.id})}function u(t,n){o("WAWebApiUnjoinedSubgroupMetadataStore").removeUnjoinedSubgroupMetadataFromStorage(n),m(n),s(t),e(t)}function c(t,n){r("WAWebGroupMetadataCollection").add({id:n,parentGroup:null},{merge:!0}),e(t)}function d(t,n){var r=o("WAWebChatCollection").ChatCollection.get(n.toString()),a=r==null?void 0:r.groupMetadata;if(!(r==null||a==null)&&(e(t),!(a.participants.length===0||!t.participants.iAmAdmin()&&a.hiddenSubgroup===!0||!t.hasJoined()))){var i={id:n,subject:r.formattedTitle,defaultSubgroup:!!a.defaultSubgroup,generalSubgroup:!!a.generalSubgroup,parentGroupId:t.id,membershipApprovalMode:a.membershipApprovalMode,hiddenSubgroup:!!a.hiddenSubgroup};o("WAWebGroupUnjoinedSubgroupJob").updateUnjoinedSubgroupsJob([i],t.id),p([i],t.id)}}function m(e){r("WAWebUnjoinedSubgroupMetadataCollection").remove(e.toString())}function p(e,t,n){n===void 0&&(n=!0),e.forEach(function(e){if(!n){m(e.id);return}var o=e.subject,a=e.subjectTime,i=r("WAWebUnjoinedSubgroupMetadataCollection").get(e.id.toString());i&&(i.subjectTime||0)>(a||0)&&(o=i.subject,a=i.subjectTime),r("WAWebUnjoinedSubgroupMetadataCollection").add(babelHelpers.extends({},e,{parentGroupId:t,subject:o,subjectTime:a}),{merge:!0})});var o=r("WAWebGroupMetadataCollection").get(t.toString());o&&s(o)}function _(e,t){var n=r("WAWebUnjoinedSubgroupMetadataCollection").filter(function(e){return e.parentGroupId.equals(t)}).map(function(e){return e.id}),o=n.filter(function(t){return!e.includes(t)});r("WAWebUnjoinedSubgroupMetadataCollection").remove(o)}function f(t,n,a){a===void 0&&(a=!0),t.forEach(function(e){var t=e.id,i=e.subject,l=e.generalSubgroup,s=e.hiddenSubgroup;i!=null&&o("WAWebGroupQueryBridge").updateSubject(t,i),r("WAWebGroupMetadataCollection").add(babelHelpers.extends({},e,{parentGroup:a?n:null,generalSubgroup:a?l:null,hiddenSubgroup:a?s:null}),{merge:!0})}),e(r("WAWebGroupMetadataCollection").assertGet(n.toString()))}function g(e){var t,n=o("WAWebChatCollection").ChatCollection.get(e.toString());return n==null||!((t=n.groupMetadata)!=null&&t.participants.iAmMember())}function h(e){return e.filter(function(e){return g(e)})}function y(e){var t=h(e.map(function(e){var t=e.id;return t}));return e.filter(function(e){return t.includes(e.id)})}function C(e,t){var n=r("WAWebUnjoinedSubgroupMetadataCollection").get(e);n!=null&&(n.membershipApprovalRequest=t)}function b(e,t){o("WAWebApiUnjoinedSubgroupMetadataStore").updateMembershipApprovalRequestinDB(e,t),C(e,t)}function v(e){var t=e.map(function(e){return{id:e.id,size:e.participantCount}});r("WAWebUnjoinedSubgroupMetadataCollection").add(t,{merge:!0})}function S(e){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield o("WAWebApiUnjoinedSubgroupMetadataStore").updateSizeInDB(e),v(e)}),R.apply(this,arguments)}l.updateJoinedSubgroups=e,l.updateUnjoinedSubgroups=s,l.subgroupUnjoinedToJoined=u,l.unlinkParentGroup=c,l.subgroupJoinedToUnjoined=d,l.updateUnjoinedSubgroupsInCollection=p,l.cleanUnjoinedSubgroupsInCollection=_,l.updateJoinedSubgroupsInCollection=f,l.determineUnjoined=g,l.getUnjoinedSubgroups=y,l.updateMembershipApprovalRequest=b,l.updateUnjoinedSubgroupSize=S}),98);
__d("WAWebAddMeContactAction",["WAJids","WAWebContactCollection","WAWebLidAwareContactsDB","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAJids").toPhoneUserJid(e.user);yield r("WAWebLidAwareContactsDB").createOrMerge(t,{id:t}),o("WAWebContactCollection").ContactCollection.gadd(e)}),s.apply(this,arguments)}l.addMeToContacts=e}),98);
__d("WAWebBizVerifiedLevelToString",["WAWebBusinessProfileTypes"],(function(t,n,r,o,a,i,l){function e(e){switch(e){case o("WAWebBusinessProfileTypes").VERIFIED_LEVEL.HIGH:return"high";case o("WAWebBusinessProfileTypes").VERIFIED_LEVEL.LOW:return"low";case o("WAWebBusinessProfileTypes").VERIFIED_LEVEL.UNKNOWN:default:return"unknown"}}l.default=e}),98);
__d("WAWebGetOrQueryUsyncInfoContactAction",["Promise","WALogger","WAPromiseCache","WAWebBackendErrors","WAWebBizUpdateVerifiedInfoAction","WAWebBizVerifiedLevelToString","WAWebChatCollection","WAWebContactCollection","WAWebQueryExistsJob","WAWebUpdateDisappearingModeForContact","WAWebUsync","WAWebUsyncUser","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e,t){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var a=t===void 0?{forceUsync:!1}:t,i=a.forceUsync,l=o("WAWebContactCollection").ContactCollection.get(e);if(i!==!0&&l!=null&&(l.name!=null||o("WAWebChatCollection").ChatCollection.get(e)!=null)){var s,c;return{wid:e,biz:l.isBusiness,bizInfo:l.isBusiness?{verifiedName:{level:r("WAWebBizVerifiedLevelToString")(l.verifiedLevel),serial:null,name:l.verifiedName,isApi:!!l.isEnterprise,isSmb:!!l.isSmb,privacyMode:l.privacyMode}}:null,disappearingMode:{duration:(s=l.disappearingModeDuration)!=null?s:0,settingTimestamp:(c=l.disappearingModeSettingTimestamp)!=null?c:0}}}var d=yield o("WAWebQueryExistsJob").queryWidExists(e);if(d){var m=d.biz,p=d.bizInfo,_=d.disappearingMode;return m&&p!=null&&(yield o("WAWebBizUpdateVerifiedInfoAction").updateVerifiedInfo(e,p.verifiedName)),_&&l!=null&&(yield o("WAWebUpdateDisappearingModeForContact").updateDisappearingModeForContact(e,_.duration,_.settingTimestamp)),d}return(u||(u=n("Promise"))).reject(r("err")("Invalid number"))}),d.apply(this,arguments)}function m(){var e=new(r("WAPromiseCache"))(o("WAWebQueryExistsJob").queryPhoneExists,{maxCached:100,maxAge:36e4,shouldCache:function(t){return!!t}});return e}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[usync] querying for biz info"]))).devConsole({wid:t});var n=new(o("WAWebUsyncUser")).USyncUser,r=new(o("WAWebUsync")).USyncQuery;t.isLid()?n.withId(t):n.withPhone(t.toString()),r.withUser(n),r.withBusinessProtocol();var a=yield r.execute(),i=a.error.all;if(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[usync] biz info response"]))).devConsole({res:a,error:i}),i)throw new(o("WAWebBackendErrors")).ServerStatusCodeError(i.errorCode,i.errorText);var l=a.list;if(l.length!==1)return null;var u=l[0],c=u.id,d=u.business;d!=null&&(yield o("WAWebBizUpdateVerifiedInfoAction").updateVerifiedInfo(t,d.verifiedName));var m={wid:c,biz:d!=null,bizInfo:d};return m}),_.apply(this,arguments)}l.getOrQueryUsyncInfo=c,l.usyncContactCached=m,l.queryUsyncBusiness=p}),98);
__d("WAWebWamEnumPhoneNumHyperlinkActionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({PHONE_NUM_HYPERLINK_MSG_RECEIVED:1,LONG_PRESS_PHONE_NUM_HYPERLINK:2,CLICK_PHONE_NUM_HYPERLINK:3,CLICK_CALL:4,CLICK_ADD_TO_CONTACTS:5,CLICK_MESSAGE_ON_WHATSAPP:6,CLICK_COPY_PHONE_NUMBER:7,CLOSE_DIALOG_BOX:8,MESSAGE_SENT:9,CLICK_CALL_ON_WHATSAPP:10,CLICK_INVITE_TO_WHATSAPP:11});i.PHONE_NUM_HYPERLINK_ACTION_TYPE=e}),66);
__d("WAWebPsPhoneNumberHyperlinkWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPhoneNumHyperlinkActionType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({PsPhoneNumberHyperlink:[3266,{isPhoneNumHyperlinkOwner:[1,e.TYPES.BOOLEAN],phoneNumHyperlinkAction:[2,o("WAWebWamEnumPhoneNumHyperlinkActionType").PHONE_NUM_HYPERLINK_ACTION_TYPE],phoneNumberStatusOnWa:[3,e.TYPES.BOOLEAN],sequenceNumber:[4,e.TYPES.INTEGER]},[1,1,1],"private",113760892]},{PsPhoneNumberHyperlink:[]});l.PsPhoneNumberHyperlinkWamEvent=s}),98);
__d("WAWebPhoneNumberContactAction",["fbt","WAWebComposeBoxActions","WAWebCopyToClipboard","WAWebModalManager","WAWebOpenChatFlow.react","WAWebPsPhoneNumberHyperlinkWamEvent","WAWebToast.react","WAWebToastManager","WAWebUserPrefsMeUser","WAWebWamEnumPhoneNumHyperlinkActionType","react"],(function(t,n,r,o,a,i,l,s){var e,u=e||(e=r("react"));function c(e,t,n){o("WAWebModalManager").ModalManager.open(u.jsx(o("WAWebOpenChatFlow.react").OpenChatFlow,{targetId:{targetId:t},onSuccess:function(t){var e=t.chat;_(e,n)},msgText:null}),{transition:"modal-flow"}),new(o("WAWebPsPhoneNumberHyperlinkWamEvent")).PsPhoneNumberHyperlinkWamEvent({phoneNumHyperlinkAction:o("WAWebWamEnumPhoneNumHyperlinkActionType").PHONE_NUM_HYPERLINK_ACTION_TYPE.CLICK_MESSAGE_ON_WHATSAPP,isPhoneNumHyperlinkOwner:o("WAWebUserPrefsMeUser").isMeAccount(t),phoneNumberStatusOnWa:!0}).commit()}function d(e,t,n){o("WAWebCopyToClipboard").copyTextToClipboard(e),o("WAWebToastManager").ToastManager.open(u.jsx(o("WAWebToast.react").Toast,{msg:s._(/*BTDS*/"Se copi\u00f3 al portapapeles.")})),new(o("WAWebPsPhoneNumberHyperlinkWamEvent")).PsPhoneNumberHyperlinkWamEvent({phoneNumHyperlinkAction:o("WAWebWamEnumPhoneNumHyperlinkActionType").PHONE_NUM_HYPERLINK_ACTION_TYPE.CLICK_COPY_PHONE_NUMBER,isPhoneNumHyperlinkOwner:n,phoneNumberStatusOnWa:!!t}).commit()}function m(e,t){new(o("WAWebPsPhoneNumberHyperlinkWamEvent")).PsPhoneNumberHyperlinkWamEvent({phoneNumHyperlinkAction:o("WAWebWamEnumPhoneNumHyperlinkActionType").PHONE_NUM_HYPERLINK_ACTION_TYPE.CLICK_PHONE_NUM_HYPERLINK,isPhoneNumHyperlinkOwner:t,phoneNumberStatusOnWa:!!e}).commit()}function p(e,t){new(o("WAWebPsPhoneNumberHyperlinkWamEvent")).PsPhoneNumberHyperlinkWamEvent({phoneNumHyperlinkAction:o("WAWebWamEnumPhoneNumHyperlinkActionType").PHONE_NUM_HYPERLINK_ACTION_TYPE.CLOSE_DIALOG_BOX,isPhoneNumHyperlinkOwner:t,phoneNumberStatusOnWa:!!e}).commit()}function _(e,t){e&&o("WAWebComposeBoxActions").ComposeBoxActions.addMsgSendingLogAttributes(e,{handleOnce:function(){new(o("WAWebPsPhoneNumberHyperlinkWamEvent")).PsPhoneNumberHyperlinkWamEvent({phoneNumHyperlinkAction:o("WAWebWamEnumPhoneNumHyperlinkActionType").PHONE_NUM_HYPERLINK_ACTION_TYPE.MESSAGE_SENT,isPhoneNumHyperlinkOwner:t,phoneNumberStatusOnWa:!0}).commit()}})}l.handleOpenChat=c,l.handleCopyPhoneNumber=d,l.logClickOnPhoneNumber=m,l.logCloseDialog=p}),226);
__d("WAWebStatusContactAction",["fbt","Promise","WALogger","WAWebActionToast.react","WAWebChatCollection","WAWebContactStatusBridge","WAWebMiscErrors","WAWebTextStatusCollection","WAWebToastManager","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","react"],(function(t,n,r,o,a,i,l,s){var e,u,c,d=c||(c=r("react"));function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n,r=(t=o("WAWebChatCollection").ChatCollection.getLatestChatForWid(e))==null?void 0:t.tcToken,a={wid:e,tcToken:r},i=yield o("WAWebContactStatusBridge").getStatus(a);if(i.stale===!0){var l=o("WAWebTextStatusCollection").TextStatusCollection.get(e);if(l)return{id:e,status:l.status}}var s=(n=i.status)!=null?n:o("WAWebTextStatusCollection").getDefaultTextStatus();return{id:e,status:s}}),p.apply(this,arguments)}function _(e,t,n,r){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r,a,i){a===void 0&&(a=o("WAWebActionToast.react").genId()),i===void 0&&(i=!1);var l=t.trim();if(!l)return(u||(u=n("Promise"))).reject(new(o("WAWebMiscErrors")).ActionError);var c=o("WAWebContactStatusBridge").setMyStatus(l),m=new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Cambiando secci\u00f3n Info\u2026")),p=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),f=o("WAWebTextStatusCollection").TextStatusCollection.assertGet(p).status,g=c.then(function(e){if(e.status===200){var t=i?void 0:{actionText:s._(/*BTDS*/"Deshacer"),actionHandler:function(){return _(f,r,a,!0)}};return new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Secci\u00f3n Info. cambiada"),t)}else if(e.status>=400)return new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"No se pudo cambiar tu secci\u00f3n Info."))}).catch(function(n){throw o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["models:statusCollection:setMyStatus dropped"]))).devConsole(n),new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"No se pudo cambiar tu secci\u00f3n Info."),{actionText:s._(/*BTDS*/"Vuelve a intentarlo."),actionHandler:function(){return _(t,r,a)}})});o("WAWebToastManager").ToastManager.open(d.jsx(o("WAWebActionToast.react").ActionToast,{id:a,initialAction:m,pendingAction:g,onDismiss:r}));var h=yield c;h.status===200&&(o("WAWebTextStatusCollection").TextStatusCollection.assertGet(p).status=t)}),f.apply(this,arguments)}l.getStatus=m,l.setMyStatus=_}),226);
__d("WAWebFindGroupMetadataAction",["Promise","WALogger","WAWebDBParticipantTypes","WAWebGroupDatabaseJob","WAWebGroupMetadataCollection","WAWebGroupQueryBridge","WAWebWamNumberToSizeBucket","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=["hasIncompleteParticipantInformation"],s,u,c,d,m,p,_,f;function g(e){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["findGroupMetadata: start find group metadata for ",""])),t);var a=null,i=null,l=function(){},g=r("WAWebGroupMetadataCollection").get(t);if(g){if(g.participantQueryPromise)return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["findGroupMetadata: "," - pending participant query"])),t),g.participantQueryPromise.then(function(){return{id:t}});g.participantQueryPromise=new(f||(f=n("Promise")))(function(e){l=e})}else{if(a=yield o("WAWebGroupDatabaseJob").getGroupMetadataJob(t),!a)return o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["findGroupMetadata: "," - query missing group participant"])),t),o("WAWebGroupQueryBridge").sendQueryGroup(t);a.subject!=null&&o("WAWebGroupQueryBridge").updateSubject(t,a.subject)}try{var h,y,C,b,v;if((!g||g.stale)&&(i=yield o("WAWebGroupDatabaseJob").getGroupParticipantJob(t),!i))return o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["findGroupMetadata: "," - query missing group participant"])),t),o("WAWebGroupQueryBridge").sendQueryGroup(t);var S;if(a){var R=a,L=R.hasIncompleteParticipantInformation,E=babelHelpers.objectWithoutPropertiesLoose(R,e);S=E}var k=babelHelpers.extends({id:t},S,{participants:(h=i)==null?void 0:h.participants,pastParticipants:(y=i)==null?void 0:y.pastParticipants,deviceStale:i?i.staleType===o("WAWebDBParticipantTypes").STALE_TYPES.DEVICE:void 0,cachedDeviceCount:(C=i)==null?void 0:C.deviceCount,cachedDeviceSizeBucket:(b=i)!=null&&b.deviceCount?r("WAWebWamNumberToSizeBucket")(i.deviceCount):null});if(((v=i)==null?void 0:v.staleType)===o("WAWebDBParticipantTypes").STALE_TYPES.PARTICIPANT){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["findGroupMetadata: "," - query stale group participant"])),t);var I=yield o("WAWebGroupQueryBridge").sendQueryGroup(t);(I==null?void 0:I.participants)!=null&&(k.participants=I.participants)}return o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["findGroupMetadata: end find group metadata for ",""])),t),k}catch(e){throw o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["findGroupMetadata: "," - query group participant error: ",""])),t,e),e}finally{l(),g&&(g.participantQueryPromise=null)}}),h.apply(this,arguments)}l.findGroupMetadata=g}),98);
__d("WAWebSendForNeededAddRequest",["WALogger","WAWebCmd","WAWebContactCollection"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n,r,a){if(t.participants){var i=a!=null?a:t.gid;i||o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("Group add request was provided with undefined gid");var l=[];t.participants.forEach(function(e){if(e.code==="403"){var t=o("WAWebContactCollection").ContactCollection.gadd(e.userWid,{silent:!0});l.push(babelHelpers.extends({},e,{contact:t}))}}),l.length>0&&i&&o("WAWebCmd").Cmd.openGroupsV4InviteRequestFlow(l,i,n,r)}}l.sendForNeededAddRequest=s}),98);
__d("WAWebGroupInviteV4Job",["WALogger","WASmaxGroupsAcceptGroupAddRPC","WASmaxGroupsGetGroupInfoRPC","WASmaxGroupsRevokeRequestCodeRPC","WAWebGroupsQueryApi","WAWebJidToWid","WAWebSetUsernameJob","WAWebUsernameGatingUtils","WAWebWidToJid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m;function p(e,t,n,r,o){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r,a,i){var l=yield o("WASmaxGroupsGetGroupInfoRPC").sendGetGroupInfoRPC({addRequestArgs:{addRequestExpiration:parseInt(n,10),addRequestAdmin:o("WAWebWidToJid").widToUserJid(a),addRequestCode:t},iqTo:r,queryPhash:i});switch(l.name){case"GetGroupInfoResponseSuccess":{if(l.value.group==null)return{status:200,phashMatch:!0};var u=o("WAWebGroupsQueryApi").parseGroupSmax(l.value.group);return{status:200,groupMetadata:u}}case"GetGroupInfoResponseClientError":{var c=l.value.errorGetGroupInfoClientErrors.value,d=c.code,m=c.text;return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["queryGroupInviteV4: failed ",":",""])),Number(d),m),{status:Number(d)}}case"GetGroupInfoResponseServerError":{var p=l.value.errorServerErrors.value,_=p.code,f=p.text;return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["queryGroupInviteV4: failed ",":",""])),_,f),{status:Number(_)}}}}),_.apply(this,arguments)}function f(e,t,n,r){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=yield o("WASmaxGroupsAcceptGroupAddRPC").sendAcceptGroupAddRPC({iqTo:n,acceptCode:e,acceptExpiration:parseInt(t,10),acceptAdmin:o("WAWebWidToJid").widToUserJid(r)});switch(a.name){case"AcceptGroupAddResponseSuccess":return{status:200,gid:o("WAWebJidToWid").groupJidToWid(n)};case"AcceptGroupAddResponseGroupJoinRequestSuccess":return{status:200,gid:o("WAWebJidToWid").groupJidToWid(n)};case"AcceptGroupAddResponseClientError":{var i=a.value.errorAcceptGroupAddClientErrors.value,l=i.code,s=i.text;return o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["joinGroupViaInviteV4: failed ",":",""])),l,s),{status:Number(l)}}case"AcceptGroupAddResponseServerError":{var d=a.value.errorServerErrors.value,m=d.code,p=d.text;return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["joinGroupViaInviteV4: failed ",":",""])),m,p),{status:Number(m)}}}}),g.apply(this,arguments)}function h(e,t){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WASmaxGroupsRevokeRequestCodeRPC").sendRevokeRequestCodeRPC({participantArgs:e.map(function(e){return{participantJid:o("WAWebWidToJid").widToUserJid(e)}}),iqTo:t});switch(n.name){case"RevokeRequestCodeResponseSuccess":{var r=n.value.revokeParticipant;if(o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()){var a=r.reduce(function(e,t){var n,r=t.jid,a=(n=t.usernameAttMixin)==null?void 0:n.username;return a!=null&&e.push({userId:o("WAWebJidToWid").userJidToUserWid(r),username:a}),e},[]);a.length>0&&(yield o("WAWebSetUsernameJob").setUsernamesJob(a))}return{status:200}}case"RevokeRequestCodeResponseClientError":{var i=n.value.errorClientErrors.value,l=i.code,s=i.text;return o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["revokeGroupInviteV4: failed ",":",""])),l,s),{status:Number(l)}}case"RevokeRequestCodeResponseServerError":{var u=n.value.errorServerErrors.value,c=u.code,p=u.text;return o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["revokeGroupInviteV4: failed ",":",""])),c,p),{status:Number(c)}}}}),y.apply(this,arguments)}l.queryGroupInviteV4=p,l.joinGroupViaInviteV4=f,l.revokeGroupInviteV4=h}),98);
__d("WAWebInviteV4QueryGroupAction",["WAWebApiGroupInviteV4Store","WAWebChatCollection","WAWebContactCollection","WAWebGroupInviteV4Job","WAWebGroupMetadataCollection","WAWebLidMappingUsernameLearnUtils","WAWebPhashUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t,n,r){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a){var i=null,l=r("WAWebGroupMetadataCollection").get(n);return l&&(i=yield o("WAWebPhashUtils").phashV1(l.participants.map(function(e){return e.id}))),o("WAWebGroupInviteV4Job").queryGroupInviteV4(e,t,n,a,i).then(function(e){if(e.phashMatch===!0)return{status:200,phashMatch:!0};if(e.groupMetadata!=null){var t=babelHelpers.extends({},e.groupMetadata);return o("WAWebLidMappingUsernameLearnUtils").processParsedGroupInfosForLidMappingAndUsernames([t]).then(function(){return t})}return{status:e.status}}).then(function(e){if(e.status!=null&&e.status>0)return e;if(e.id!=null)return o("WAWebContactCollection").ContactCollection.gadd(e.id),e;var t=r("WAWebGroupMetadataCollection").assertGet(o("WAWebWidFactory").createWidFromWidLike(n)),a=o("WAWebChatCollection").ChatCollection.assertGet(t.id).contact.name;return{id:t.id,owner:t.owner,creation:t.creation,desc:t.desc,descId:t.descId,descOwner:t.descOwner,descTime:t.descTime,restrict:t.restrict,announce:t.announce,ephemeralDuration:t.ephemeralDuration,membershipApprovalMode:t.membershipApprovalMode,reportToAdminMode:t.reportToAdminMode,growthLockExpiration:t.growthLockExpiration,growthLockType:t.growthLockType,noFrequentlyForwarded:t.noFrequentlyForwarded,subject:a,participants:t.participants.map(function(e){return{id:e.id,isAdmin:e.isAdmin,isSuperAdmin:e.isSuperAdmin}})}})}),s.apply(this,arguments)}function u(e,t,n,r){return o("WAWebGroupInviteV4Job").joinGroupViaInviteV4(e,t,n,r)}function c(e,t){return o("WAWebGroupInviteV4Job").revokeGroupInviteV4(e,t)}function d(e,t){return o("WAWebApiGroupInviteV4Store").getPendingParticipants(e,t)}l.queryGroupInviteV4Info=e,l.joinGroupViaInviteV4=u,l.revokeGroupInviteV4=c,l.getPendingParticipants=d}),98);
__d("WAWebChangePresenceHandlerAction",["Promise","WAWebChatCollection","WAWebLidMigrationUtils","WAWebPresenceCollection","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=25e3;function u(e,t){var n=e.type;(n==="typing"||n==="recording_audio")&&(e.type=t.isOnline?"available":"unavailable")}function c(e,t){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){r===void 0&&(r=!0);var a=t.id;if(!o("WAWebUserPrefsMeUser").isMeAccount(a)){var i=o("WAWebPresenceCollection").PresenceCollection.get(a);i&&(m(i,t),r&&i.set({stale:!1}))}return(e||(e=n("Promise"))).resolve()}),d.apply(this,arguments)}function m(e,t){var n=!1;typeof t.type=="undefined"?t.type=e.chatstate.type||"unavailable":t.type==="idle"&&(n=!0,t.type=e.isOnline?"available":"unavailable"),e.isGroup&&t.type!=="available"&&!n&&(t.updateTime=Date.now());var r;if(e.isGroup){var a=t.participant;if(a==null)return;var i=t.id,l=o("WAWebChatCollection").ChatCollection.get(i);if(l==null||o("WAWebLidMigrationUtils").toPn(a)==null)return;t.id=a,t.participant=void 0,r=e.chatstates.gadd(t.id)}else r=e.chatstate;(!n||r.type==="typing"||r.type==="recording_audio")&&r.set(t),r.expireTimerId&&self.clearTimeout(r.expireTimerId),r.type==="typing"||r.type==="recording_audio"?r.expireTimerId=self.setTimeout(function(){return u(r,e)},s):r.expireTimerId=void 0;var c=e.forceDisplay||e.isOnline||e.isUser&&!e.chatstate.deny;e.set({hasData:!0,isSubscribed:!0,forceDisplay:c})}l.default=c}),98);
__d("WAWebAddOnsUpdateAddOnAcksApi",["Promise","WAAckLevel","WANullthrows","WATypeUtils","WAWebBackendApi","WAWebDBAddOnProviders","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=yield(e||(e=n("Promise"))).allSettled(Array.from(t.entries()).map(function(e){var t=e[0],n=e[1],a=r("WANullthrows")(o("WAWebDBAddOnProviders").getProviderForAddOnType(t));return a.updateAcks==null?void 0:a.updateAcks(n,function(){return!0})}));for(var i of a)if(i.status==="rejected")throw i.reason}),u.apply(this,arguments)}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=yield(e||(e=n("Promise"))).allSettled(Array.from(t).map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e[0],n=e[1],a=r("WANullthrows")(o("WAWebDBAddOnProviders").getProviderForAddOnType(t)),i=yield a.updateAcks==null?void 0:a.updateAcks(n,function(e,t){return m(e.ack,t.ack)});if(!(i==null||i.length===0))return[t,i]});return function(t){return e.apply(this,arguments)}})())),i=new Map(a.map(function(e){return e.value}).filter(Boolean));o("WAWebBackendApi").frontendFireAndForget("updateAddOnCollectionAcks",{updatesByType:i});for(var l of a)if(l.status==="rejected")throw l.reason}),d.apply(this,arguments)}function m(e,t){return o("WATypeUtils").isNumber(t)&&(e==null||t>e||t===o("WAAckLevel").ACK.FAILED)}l.updateAddOnAcks=s,l.maybeUpdateAddOnAcks=c}),98);
__d("WAWebAddOnsUpdateSendStatesAction",["Promise","WAWebAddOnsUpdateAddOnAcksApi","WAWebCommentCollection","WAWebMessageAddOnType","WAWebMsgKey","WAWebMsgType","WAWebPinInChatCollection","WAWebPollsPollVoteCollection","WAWebReactionsCollection","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t){var n=p(e);n!=null&&o("WAWebAddOnsUpdateAddOnAcksApi").maybeUpdateAddOnAcks(new Map([[n,[{msgKey:e.id.toString(),ack:t}]]]))}function u(t,r){var o=p(t);return o==null?(e||(e=n("Promise"))).resolve():c(new Map([[o,[babelHelpers.extends({msgKey:t.id.toString()},r)]]]))}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=new Map;for(var n of e){var r=n[0],a=n[1],i=a.map(function(e){return e.ack==null?null:{msgKey:e.msgKey,ack:e.ack}}).filter(Boolean);t.set(r,i)}yield o("WAWebAddOnsUpdateAddOnAcksApi").updateAddOnAcks(t),m(e)}),d.apply(this,arguments)}function m(e){for(var t of e){var n=t[0],o=t[1];for(var a of o){var i=_(n,r("WAWebMsgKey").from(a.msgKey));i!=null&&(a.ack!=null&&(i.ack=a.ack),a.isSendFailure!=null&&(i.isSendFailure=a.isSendFailure))}}}function p(e){switch(e.type){case o("WAWebMsgType").MSG_TYPE.REACTION:case o("WAWebMsgType").MSG_TYPE.REACTION_ENC:return o("WAWebMessageAddOnType").MessageAddOnType.Reaction;case o("WAWebMsgType").MSG_TYPE.POLL_UPDATE:if(e.subtype==="poll_vote")return o("WAWebMessageAddOnType").MessageAddOnType.PollVote;break;case o("WAWebMsgType").MSG_TYPE.PIN_MESSAGE:return o("WAWebMessageAddOnType").MessageAddOnType.PinMessage;case o("WAWebMsgType").MSG_TYPE.COMMENT:return o("WAWebMessageAddOnType").MessageAddOnType.Comment}return null}function _(e,t){switch(e){case o("WAWebMessageAddOnType").MessageAddOnType.Reaction:return o("WAWebReactionsCollection").ReactionsCollection.getSenderByMsgKey(t);case o("WAWebMessageAddOnType").MessageAddOnType.PollVote:return o("WAWebPollsPollVoteCollection").PollVoteCollection.getByMsgKey(t);case o("WAWebMessageAddOnType").MessageAddOnType.PinMessage:return o("WAWebPinInChatCollection").PinInChatCollection.getByMsgKey(t);case o("WAWebMessageAddOnType").MessageAddOnType.Comment:return o("WAWebCommentCollection").CommentCollection.getByMsgKey(t);case o("WAWebMessageAddOnType").MessageAddOnType.KeepInChat:case o("WAWebMessageAddOnType").MessageAddOnType.MessageEdit:case o("WAWebMessageAddOnType").MessageAddOnType.ReactionEnc:case o("WAWebMessageAddOnType").MessageAddOnType.Unknown:return null}}l.maybeUpdateAddOnAckForMsgAction=s,l.updateAddOnSendStatesForMsgAction=u,l.updateAddOnSendStatesAction=c,l.updateAddOnCollectionsSendStatesAction=m}),98);
__d("WAWebFutureproofReparseMsgsAction",["Promise","WALogger","WAWebAddonGatingUtils","WAWebDBAddOnProviders","WAWebDBMessageSerialization","WAWebHandleMsgProcess","WAWebLidMigrationUtils","WAWebMsgGetters","WAWebMsgType","WAWebNewsletterReparseMsgAction","WAWebProcessMsgInfoForLid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){try{var n=t.futureproofBuffer,r=t.futureproofParams;if(o("WAWebMsgGetters").getIsNewsletterMsg(t))return yield o("WAWebNewsletterReparseMsgAction").reparseNewsletterMsg(t);if(n!=null){if(r){var a=r.info,i=r.msgMeta;o("WAWebLidMigrationUtils").shouldHaveAccountLid(a.chat)&&a.accountLid==null&&(yield o("WAWebProcessMsgInfoForLid").maybeProcesMsgInfoForLid({msgInfo:a,msgMeta:i})),yield o("WAWebHandleMsgProcess").processDecryptedMessageProto(babelHelpers.extends({},r,{decrypted:n,reparsing:!0}))}return t}return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["reparseFutureproof: No futureproof buffer"]))),null}catch(e){return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["reparseFutureproof: reparse error: ",""])),e).sendLogs("reparse-futureproof-error"),null}}),m.apply(this,arguments)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){try{var t=[],r=[];e.forEach(function(e){var n=o("WAWebDBMessageSerialization").messageFromDbRow(e),a=o("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(e.type)||!!o("WAWebDBAddOnProviders").getAddOnProviderForFutureproofMsg(n);a?t.push(n):e.type===o("WAWebMsgType").MSG_TYPE.UNKNOWN&&r.push(n)}),yield(c||(c=n("Promise"))).all(r.map(function(e){return d(e)})),yield c.all(t.map(function(e){return d(e)}))}catch(e){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["reparseFutureproof: processFutureproof error"])))}}),_.apply(this,arguments)}l.reparseFutureproof=d,l.processFutureproof=p}),98);
__d("WAWebAvatarGatingUtils",["WAWebABProps"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebABProps").getABPropConfigValue("enable_avatars_on_web_companion")}l.avatarsOnWebEnabled=e}),98);
__d("WAWebMediaLinkPreviewUtils",["WATimeUtils","WAWebDisplayType"],(function(t,n,r,o,a,i,l){var e=2592e3;function s(t){var n=o("WATimeUtils").unixTime()-t>e;return n}var u=7/5;function c(e,t){var n,r;if(e){var o=d(e.unsafe(),t);if(o&&(e==null?void 0:e.thumbnailHeight)!=null&&(e==null?void 0:e.thumbnailWidth)!=null){var a=e.thumbnailHeight/e.thumbnailWidth;r=a>=1?"portrait":"landscape",n="high-quality"}}return{bubbleTheme:r,linkPreviewTheme:n}}function d(e,t){var n=!!(e.thumbnailDirectPath||e.thumbnailHQ)&&e.thumbnailHeight!=null&&e.thumbnailWidth!=null;if(!n)return!1;var r=s(e.t);if(r)return!1;var a=t===o("WAWebDisplayType").DISPLAY_TYPE.GALLERY;return a?!1:t===o("WAWebDisplayType").DISPLAY_TYPE.STATUS&&e.thumbnailHeight!=null&&e.thumbnailWidth!=null?e.thumbnailWidth/e.thumbnailHeight>=u:!0}l.HQ_PREVIEW_LIFESPAN=e,l.hqLinkPreviewExpired=s,l.getLinkPreviewThemes=c,l.displayHighQualityLinkPreview=d}),98);
__d("WAWebProcessMultipleMsgsAction",["Promise","WALogger","WATimeUtils","WAWebABProps","WAWebAddAndReorderMsgsActionsUtils","WAWebAvatarGatingUtils","WAWebBotGenTypingIndicatorMsg","WAWebBotTypes","WAWebChatCollection","WAWebFindChatAction","WAWebFrontendMsgGetters","WAWebGetMsgUpdatesActionsUtils","WAWebLidStatusMigrationGating","WAWebLidStatusMigrationUtils","WAWebMedia","WAWebMediaAutoDownloadQueue","WAWebMediaDownloadMmsThumbnail","WAWebMediaLinkPreviewUtils","WAWebMediaTypes","WAWebMiscGatingUtils","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgModelUtils","WAWebMsgType","WAWebNewsletterCollection","WAWebRecentStickerCollection","WAWebRecentStickerCollectionMd","WAWebStatusCollection","WAWebStickerModel","WAWebUserPrefsGeneral","WAWebUserPrefsMeUser","WAWebWid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d;function m(e,t,n,r,o){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i,l,u){var c,m,p=yield r("WAWebGetMsgUpdatesActionsUtils")(t,a,i,u),f=p.filteredRecs,g=p.reorderRecs,h=p.updates,y=yield(d||(d=n("Promise"))).all(h),C=y.filter(function(e){return(e==null?void 0:e.associationType)!=null});if(o("WAWebMsgCollection").MsgCollection.makeParentMessagesVisibleInChat(C),f.length===0&&g.length===0){if(t&&i.pendingMsgsDone===!0){var b,v=(b=o("WAWebChatCollection").ChatCollection.get(t))!=null?b:r("WAWebNewsletterCollection").get(t);v&&(v.pendingMsgs=!1)}return a.map(function(e){return o("WAWebMsgCollection").MsgCollection.get(e.id)}).filter(Boolean)}if(!t)return _(f).then(function(){return a.reduce(function(e,t){var n=o("WAWebMsgCollection").MsgCollection.get(t.id);return n!=null&&o("WAWebFrontendMsgGetters").getChat(n)!=null&&e.push(n),e},[])});var S,R=a[0];if(o("WAWebMsgGetters").getIsStatus(R)){var L,E=(L=o("WAWebMsgGetters").getSender(R))!=null?L:R.from;r("WAWebWid").isStatus(t)&&(E=R.id.fromMe?o("WAWebLidStatusMigrationUtils").matWidConvert(o("WAWebUserPrefsMeUser").getMePnUserOrThrow()):R.author),S=o("WAWebStatusCollection").StatusCollection.find(E)}else S=yield o("WAWebFindChatAction").findExistingChat(t,l);var k=yield S,I=yield _(f),T=i.add==="after"||i.add==="last",D=!i.isHistory,x,$,P=!1,N=k.id.isBot(),M=((c=k.contact.businessProfile)==null?void 0:c.isBizBot3p)===!0;if((N||M)&&i.isHistory===!1){var w=k.msgs.last();(w==null?void 0:w.subtype)===o("WAWebBotGenTypingIndicatorMsg").BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE&&(w==null||w.delete({skipUpdatingSortTime:!0}))}if(I.forEach(function(e){e.subtype==="biz_bot_1p_disclosure"?k.set({bizBotSystemMsgType:o("WAWebBotTypes").BizBotType.BIZ_1P}):e.subtype==="biz_bot_3p_disclosure"&&k.set({bizBotSystemMsgType:o("WAWebBotTypes").BizBotType.BIZ_3P})}),i.add==="unread"?(x=u,k.msgChunks.push(x),$=i.firstUnreadKey):i.add==="last"&&i.resume===!0?(x=u,P=!0):x=typeof u=="function"?u():u,r("WAWebAddAndReorderMsgsActionsUtils")(a,I,g,k,T,x||k.msgs,$,P,i.anchorMsgKey),i.pendingMsgsDone===!0&&(k.pendingMsgs=!1),D&&r("WAWebWid").isBroadcast(t)&&!r("WAWebWid").isStatus(t)&&I.forEach(function(e){e&&e.recvFresh&&!o("WAWebMsgGetters").getIsNotification(e)&&o("WAWebMsgModelUtils").broadcastFanout(e)}),!((m=i.isHistory)!=null&&m)){var A=I.map(function(e){var t,n,r,a=o("WAWebMsgGetters").getIsSentByMe(e)&&e.type===o("WAWebMsgType").MSG_TYPE.STICKER;if(a&&!(e.isAvatar===!0&&!o("WAWebAvatarGatingUtils").avatarsOnWebEnabled())){var i=e.mediaData,l=e.mediaObject,s=e.id.toString(),u=l==null?void 0:l.entries.entries[0];return{sticker:new(o("WAWebStickerModel")).StickerModel({id:i.filehash,directPath:i.directPath,filehash:i.filehash,encFilehash:(t=u==null?void 0:u.getEncfilehash())!=null?t:i.encFilehash,mediaKey:(n=u==null?void 0:u.getMediaKey())!=null?n:i.mediaKey,mediaKeyTimestamp:i.mediaKeyTimestamp!=null?i.mediaKeyTimestamp:o("WATimeUtils").unixTime(),width:i.fullWidth,height:i.fullHeight,size:i.size,mimetype:i.mimetype,isAvatar:e.isAvatar,type:o("WAWebMediaTypes").OUTWARD_TYPES.STICKER,index:0}),timestamp:(r=e.stickerSentTs)!=null?r:0,msgId:s}}}).filter(Boolean);o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["processed "," recent sticker messages"])),A.length),A.forEach(function(e){return o("WAWebRecentStickerCollectionMd").RecentStickerCollectionMd.addNewSticker(e.sticker,e.msgId,e.timestamp)})}var F=I.map(function(e){var t=e.isNewMsg&&o("WAWebMsgGetters").getIsSentByMe(e)&&e.type===o("WAWebMsgType").MSG_TYPE.STICKER,n=e.mediaData;if(t){var r=e.mediaKey;if(r==null){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[sticker] Unexpected null media key"]))).sendLogs("sticker-unexpected-null-media-key");return}return{id:n.filehash,directPath:n.directPath,filehash:n.filehash,encFilehash:n.encFilehash,mediaKey:r,mediaKeyTimestamp:n.mediaKeyTimestamp!=null?n.mediaKeyTimestamp:o("WATimeUtils").unixTime(),width:n.fullWidth,height:n.fullHeight,size:n.size,mimetype:n.mimetype,type:o("WAWebMediaTypes").OUTWARD_TYPES.STICKER,index:0}}}).filter(Boolean);if(o("WAWebRecentStickerCollection").RecentStickerCollection.enqueue(F),o("WAWebMiscGatingUtils").webMediaAutoDownloadEnabled()&&I.filter(function(e){return!o("WAWebMsgGetters").getIsStatus(e)}).map(function(e){return o("WAWebFrontendMsgGetters").getAsAutoDownloadableMedia(e)}).filter(Boolean).forEach(function(e){o("WAWebMediaAutoDownloadQueue").AutoDownloadQueue.enqueue(e,o("WAWebMediaAutoDownloadQueue").AutoDownloadTypes.MEDIA)}),o("WAWebABProps").getABPropConfigValue("download_document_thumb_mms_enabled")&&I.map(function(e){return o("WAWebFrontendMsgGetters").getAsDoc(e)}).filter(Boolean).forEach(function(e){o("WAWebMiscGatingUtils").webMediaAutoDownloadEnabled()?o("WAWebMediaAutoDownloadQueue").AutoDownloadQueue.enqueue(e,o("WAWebMediaAutoDownloadQueue").AutoDownloadTypes.MMS_THUMBNAIL):r("WAWebMediaDownloadMmsThumbnail")({chat:null,msg:e,isPreload:!0})}),I.map(function(e){return o("WAWebFrontendMsgGetters").getAsUrl(e)}).filter(Boolean).forEach(function(e){o("WAWebMediaLinkPreviewUtils").hqLinkPreviewExpired(e.t)||(o("WAWebMiscGatingUtils").webMediaAutoDownloadEnabled()?o("WAWebMediaAutoDownloadQueue").AutoDownloadQueue.enqueue(e,o("WAWebMediaAutoDownloadQueue").AutoDownloadTypes.MMS_THUMBNAIL,null):r("WAWebMediaDownloadMmsThumbnail")({msg:e,isPreload:!0,chat:null}))}),o("WAWebABProps").getABPropConfigValue("download_status_thumb_mms_enabled")){var O=o("WAWebUserPrefsGeneral").getLastStatusUsage(),B=1e3*60*60*24;(O==null||Date.now()-O<14*B)&&I.filter(function(e){return o("WAWebMsgGetters").getIsStatus(e)}).map(function(e){return o("WAWebFrontendMsgGetters").getAsImage(e)||o("WAWebFrontendMsgGetters").getAsVideo(e)}).filter(Boolean).forEach(function(e){o("WAWebMiscGatingUtils").webMediaAutoDownloadEnabled()?o("WAWebMediaAutoDownloadQueue").AutoDownloadQueue.enqueue(e,o("WAWebMediaAutoDownloadQueue").AutoDownloadTypes.MMS_THUMBNAIL):o("WAWebMedia").downloadStatusThumbnail({msg:e,isPreload:!0})})}return a.map(function(e){return o("WAWebMsgCollection").MsgCollection.get(e.id)}).filter(Boolean)}),p.apply(this,arguments)}function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebMsgCollection").MsgCollection.add(e,{merge:!0}),r=t.reduce(function(t,n,r){return n==null&&o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Get empty message with id ","."])),e[r].id).sendLogs("msgPrepWork-empty-message"),n!=null&&n.subtype!=="is_hosted_group"&&t.push(n),t},[]),a=null,i=null;return yield(d||(d=n("Promise"))).all(r.map(function(e){return e.waitForPrep().catch(function(t){a=t,i=e})})),a!=null&&i!=null&&o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed! ",". id: ",", type: ",", subtype: ",", has media data: ",", is status migrated: ",""])),String(a),i.id.toString(),i.type,i.subtype,i.mediaData!=null,o("WAWebLidStatusMigrationGating").getLidStatusSendEnabled()).devConsole(a).sendLogs("bad-msg-prep"),r}),f.apply(this,arguments)}l._processMultipleMessages=m}),98);
__d("WAWebRevokeMsgConstants",["WATimeUtils"],(function(t,n,r,o,a,i,l){var e=2.5*o("WATimeUtils").DAY_SECONDS,s=12*o("WATimeUtils").HOUR_SECONDS,u=30*o("WATimeUtils").DAY_SECONDS;l.REVOKE_WINDOW=e,l.REVOKE_WINDOW_RECEIVER_MARGIN=s,l.NEWSLETTER_REVOKE_WINDOW=u}),98);
__d("WAWebSendRevokeMessageWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMediaType","WAWebWamEnumMessageType"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({SendRevokeMessage:[1348,{messageMediaType:[2,o("WAWebWamEnumMediaType").MEDIA_TYPE],messageType:[1,o("WAWebWamEnumMessageType").MESSAGE_TYPE],revokeSendDelay:[3,o("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,1],"regular"]},{SendRevokeMessage:[]});l.SendRevokeMessageWamEvent=e}),98);
__d("WAWebRevokeMsgAction",["Promise","WAJobOrchestratorTypes","WALogger","WATimeUtils","WAWebAck","WAWebAddonProcessRevoke","WAWebApiChat","WAWebAssociationProcessor","WAWebAssociationProcessorConstants","WAWebBotGating","WAWebChatGetters","WAWebCmd","WAWebDBProcessMessage","WAWebDBStoreRevokeMsgs","WAWebErrorType","WAWebFrontendMsgGetters","WAWebFtsClient","WAWebLabelCollection","WAWebMedia","WAWebMessageAssociationGatingUtils","WAWebMessageSendPerfReporter","WAWebMsgActionCapability","WAWebMsgGetters","WAWebMsgKey","WAWebMsgModel","WAWebMsgModelUtils","WAWebMsgType","WAWebNoop","WAWebOrchestratorNonPersistedJob","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebRevoke","WAWebRevokeMsgConstants","WAWebSendMsgRecordAction","WAWebSendMsgResultAction","WAWebSendRevokeMessageWamEvent","WAWebSimpleSignalPNToFBIDMigration","WAWebStateUtils","WAWebUpdateLastAddOnPreviewChatAction","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWamMsgUtils","WAWebWid","asyncToGeneratorRuntime","err","lodash"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p;function _(e,t,n){return e.type==="message"?g({type:"message",data:o("WAWebStateUtils").unproxy(e.data)},t,n):g(e,t,n)}function f(e,t){return v(o("WAWebStateUtils").unproxy(e),t)}function g(e,t,n,r){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,i){var l;i===void 0&&(i=!1);var s=e.data;if(t===o("WAWebCmd").Revoke.Sender&&!s.id.fromMe&&!o("WAWebMsgActionCapability").canBotResponseBeRevokeByInvoker(s))return(p||(p=n("Promise"))).reject(r("err")("revoking received message"));var u=s.id.remote.isGroup()&&e.type==="addon"?o("WAWebUserPrefsMeUser").getMeLidUserOrThrow():o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),_=s.id.remote.isGroup()&&((l=o("WAWebFrontendMsgGetters").getChat(s).groupMetadata)==null?void 0:l.isLidAddressingMode),g=void 0;s.id.remote.isGroup()&&(g=_===!0?o("WAWebUserPrefsMeUser").getMeLidUserOrThrow():u);var h=new(r("WAWebMsgKey"))({id:yield r("WAWebMsgKey").newId(),remote:s.id.remote,fromMe:!0,participant:g}),y=b(t),C=o("WATimeUtils").unixTime(),v=C-o("WAWebMsgGetters").getT(s),S={id:h,from:_===!0?o("WAWebUserPrefsMeUser").getMeLidUserOrThrow():u,to:s.id.remote,author:g,t:C,type:o("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:o("WAWebMsgType").MsgKind.ProtocolRevoke,subtype:b(t),protocolMessageKey:s.id,clearMedia:!!a,local:!0,revokeDuration:v,revokeTimestamp:C,viewMode:o("WAWebViewMode.flow").ViewModeType.VISIBLE};if(e.type==="addon")return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendMessage",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=e.data;if(t.kind!==o("WAWebMsgType").MsgKind.CommentDecrypted)throw r("err")("_sendRevoke: only decrypted comment can be revoked from the UI");var n=babelHelpers.extends({},S,{kind:o("WAWebMsgType").MsgKind.ProtocolAddonRevoke,targetMessageKey:t.parentMsgKey,revokeAddonType:t.type}),a=yield o("WAWebSendMsgRecordAction").sendAddonRecord(n),i=a.messageSendResult;return i===o("WAWebSendMsgResultAction").SendMsgResult.OK?(new(o("WAWebSendRevokeMessageWamEvent")).SendRevokeMessageWamEvent({messageType:o("WAWebWamMsgUtils").getWamMessageType(s),messageMediaType:o("WAWebWamMsgUtils").getWamMediaType(s),revokeSendDelay:v}).commit(),yield o("WAWebAddonProcessRevoke").processSentRevokeMsg(babelHelpers.extends({},n,{t:o("WAWebMsgGetters").getT(s),ack:o("WAWebAck").ACK.SENT}),t)):o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["failed to send revoke addon"]))).tags("addons","messaging").sendLogs("failedSendRevokeMsg: "+t.type),a}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted();var R=babelHelpers.extends({},S);if(o("WAWebBotGating").isBotEnabled()){var L,E=null,k=(L=s.mentionedJidList)==null?void 0:L.find(function(e){return e.isBot()}),I=o("WAWebMsgGetters").getSender(s);if(I&&I.isBot()?E=I:k!=null&&s.isForwarded!==!0&&(E=k),E!=null){var T;E=(T=o("WAWebSimpleSignalPNToFBIDMigration").getDeprecatedPnChatForFbidInvoke(E))!=null?T:E}R.botRespOrInvocationRevokeBotWid=E,s.botTargetSenderJid instanceof r("WAWebWid")&&(R.botTargetSenderJid=s.botTargetSenderJid)}var D=new(o("WAWebMsgModel")).Msg(R);return D.wamMessageSendPerfReporter=new(o("WAWebMessageSendPerfReporter")).MessageSendPerfReporter({chatWid:D.to,mediaType:D.getWamMediaType(),messageType:D.getWamMessageType()}),D.wamMessageSendPerfReporter.setIsRevokeMessage(!0),o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendMessage",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var t,a;(t=D.wamMessageSendPerfReporter)==null||t.startSavedStage(),yield o("WAWebDBProcessMessage").storeMessages([R],o("WAWebFrontendMsgGetters").getChat(s).id),(a=D.wamMessageSendPerfReporter)==null||a.postSavedStage()}catch(e){throw o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["_sendRevoke: failed to storeMessages into storage"]))).verbose().devConsole(e).sendLogs("storeMessages failed"),e}var l=yield o("WAWebSendMsgRecordAction").sendMsgRecord(D),c=l.messageSendResult;if(i)throw o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["_sendRevoke path for associated with bot plugin msg"]))),r("err")("Expected exit for associated with bot plugin msg");return c===o("WAWebSendMsgResultAction").SendMsgResult.OK?(new(o("WAWebSendRevokeMessageWamEvent")).SendRevokeMessageWamEvent({messageType:o("WAWebWamMsgUtils").getWamMessageType(s),messageMediaType:o("WAWebWamMsgUtils").getWamMediaType(s),revokeSendDelay:v}).commit(),o("WAWebDBStoreRevokeMsgs").processRevokeMsgs([{revokeMsgKey:s.id,newMsgKey:h,timestamp:o("WAWebMsgGetters").getT(s),revokeTimestamp:C,subtype:y,sender:u,viewMode:D.viewMode}]).then(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebUpdateLastAddOnPreviewChatAction").deleteModelsForLastAddOnPreview([s.id.toString()]),yield o("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(o("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(o("WAWebFrontendMsgGetters").getChat(s).id.toString(),[s.id.toString()])),f(e.data,{msgKey:h,subtype:y,sender:u,revokeTimestamp:C,viewMode:D.viewMode}),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.OK}}))):(p||(p=n("Promise"))).resolve({messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN})}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}),h.apply(this,arguments)}function y(t,n){g({type:"message",data:o("WAWebStateUtils").unproxy(t)},n,!1,!0).catch(function(t){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[bot revoke] sendAssociatedBotPluginRevoke: ",""])),t.message)})}function C(e,t,n){return g({type:"message",data:o("WAWebStateUtils").unproxy(e)},t,n,!1)}function b(e){switch(e){case o("WAWebCmd").Revoke.Sender:return"sender_revoke";case o("WAWebCmd").Revoke.Admin:return"admin_revoke"}}function v(e,t){var n,a,i,l=o("WAWebFrontendMsgGetters").getMaybeChat(e),c=l!=null&&o("WAWebChatGetters").getIsNewsletter(l)?o("WAWebRevokeMsgConstants").NEWSLETTER_REVOKE_WINDOW:o("WAWebRevokeMsgConstants").REVOKE_WINDOW,d=c+o("WAWebRevokeMsgConstants").REVOKE_WINDOW_RECEIVER_MARGIN,m=o("WATimeUtils").unixTime()-e.t<=d;if(!m){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["revoke: outside of revoke window, "," has not been revoked"])),e.id.toString());return}o("WAWebLabelCollection").LabelCollection.removeAllLabelsMD(e),o("WAWebMsgModelUtils").typeIsMms(e)&&o("WAWebMedia").deregisterMsg(e),l==null||l.removeFromCollection(e),e.trigger("revoked"),o("WAWebMsgGetters").clearMsgGetterCacheFor(e),o("WAWebFrontendMsgGetters").clearFrontendMsgGetterCacheFor(e);var p=e.getCollection(),_=e.id,g=o("WAWebRevoke").getMsgKeyAfterRevoke({originalKey:_,revokeKey:t.msgKey});e.msgChunk&&e.msgChunk.replaceId(_,g),p.replaceId(_,g);var h=(n=l==null?void 0:l.isUnreadMsg(e))!=null?n:!1,y=(a=l==null?void 0:l.isActiveUnreadMsg(e))!=null?a:!1,C=e.associationType;if(C!=null&&o("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var b=o("WAWebAssociationProcessor").getAssociationProcessorByAssociationType(C);b&&b.processorType===o("WAWebAssociationProcessorConstants").AssociationProcessorType.WithDetachedMessages&&e.detachAssociatedMsg()}var v={isOverwrittenByRevoke:!0,id:g,type:o("WAWebMsgType").MSG_TYPE.REVOKED,subtype:t.subtype==="admin_revoke"?"admin":"sender",revokeSender:t.sender,revokeTimestamp:t.revokeTimestamp,protocolMessageKey:_,body:void 0,caption:void 0,clientUrl:void 0,deprecatedMms3Url:void 0,loc:void 0,lat:void 0,lng:void 0,isLive:void 0,accuracy:void 0,speed:void 0,degrees:void 0,comment:void 0,sequence:void 0,shareDuration:void 0,finalLat:void 0,finalLng:void 0,finalAccuracy:void 0,finalThumbnail:void 0,finalSpeed:void 0,finalDegrees:void 0,finalTimeOffset:void 0,title:void 0,description:void 0,matchedText:void 0,thumbnail:void 0,richPreviewType:void 0,doNotPlayInline:void 0,paymentLinkMetadata:void 0,quotedMsg:void 0,quotedStanzaID:void 0,quotedRemoteJid:void 0,quotedParticipant:void 0,mediaData:void 0,mentionedJidList:void 0,groupMentions:void 0,vcardList:void 0,star:!1,kicState:void 0,kicTimestampMs:void 0,kicKey:void 0,errorCode:o("WAWebErrorType").SendFailureErrorCode.NoError,isSendFailure:!1,viewMode:(i=t.viewMode)!=null?i:o("WAWebViewMode.flow").ViewModeType.VISIBLE,associationType:void 0,parentMsgKey:void 0};if(e.set(v),e.trigger("change:msgKey",{newKey:g,oldKey:_}),l&&(_.equals(l.lastReceivedKey)&&(l.lastReceivedKey=g),l.composeQuotedMsg===e&&(l.composeQuotedMsg=null),h&&(l.unreadCount=Math.max(l.unreadCount-1,0),l.unreadDividerOffset+=1,o("WAWebApiChat").reduceChatUnreadCount(l.id.toString())),y&&(l.activeUnreadCount=Math.max(l.activeUnreadCount-1,0))),r("WAWebWid").isBroadcast(_.remote)){var S=o("WAWebMsgModelUtils").getBroadcastFanoutKeys(_),R=o("WAWebMsgModelUtils").getBroadcastFanoutKeys(g);if(!S||!R||S.length!==R.length){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["cannot fanout revoke: "," ",""])),String(S),String(R)).devConsole(S,R);return}r("lodash").zip(S,R).forEach(function(e){var n=p.get(e[0]);n&&f(n,{msgKey:e[1],subtype:t.subtype,sender:t.sender})}),o("WAWebFtsClient").ftsClient.purge([String(e.rowId)]).catch(r("WAWebNoop"));var L=l?l.id.toString():e.id.remote.toString();o("WAWebUpdateLastAddOnPreviewChatAction").deleteModelsForLastAddOnPreview([_.toString()]),o("WAWebPersistedJobManager").getJobManager().fireAndForget(o("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(L.toString(),[_.toString()]))}}l.sendRevoke=_,l.revoke=f,l.sendAssociatedBotPluginRevoke=y,l.sendAssociatedChildMsgRevoke=C}),98);
__d("WAWebCodeMutatorComponent.react",["WAWebCopyPasteSelectable.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){var t=e.children,n=t===void 0?"":t,r=e.selectable;return s.jsx(o("WAWebCopyPasteSelectable.react").SelectableCode,{selectable:r,appTextTemplate:"```${appText}```",children:n})}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("WAWebExtractRangeFromMatch",[],(function(t,n,r,o,a,i){function e(e,t){t===void 0&&(t=0);var n=e.index,r=e[0],o=n+r.length-1,a=[n,n,o,o,e];if(t){var i,l=(i=e[t])!=null?i:"";a[1]=n+r.indexOf(l),a[2]=a[1]+l.length-1}return a}i.default=e}),66);
__d("WAWebExtractRangesUsingRegex",["WAWebExtractRangeFromMatch"],(function(t,n,r,o,a,i,l){function e(e,t,n,o){n===void 0&&(n=0);var a=[];t.lastIndex=0;for(var i;(i=t.exec(e))&&t.lastIndex>0;)o&&(i=o(i,t)),i&&a.push(r("WAWebExtractRangeFromMatch")(i,n));return a}l.default=e}),98);
__d("WAWebFormatMutator",["err"],(function(t,n,r,o,a,i,l){var e=(function(){function e(){}return e.match=function(t,n,o){throw r("err")("Subclasses of `Mutator` must override `match()`")},e.mutate=function(t,n,r){return t},e})();e.nestable=function(){return!0},e.format=!0,e.fragment=!1,e.compatibility=!1,e.mutates=!1,l.default=e}),98);
__d("WAWebCreateRegexMutator",["WAWebExtractRangesUsingRegex","WAWebFormatMutator"],(function(t,n,r,o,a,i,l){function e(e,t,n){return t===void 0&&(t=0),(function(o){function a(){return o.apply(this,arguments)||this}return babelHelpers.inheritsLoose(a,o),a.match=function(a){return r("WAWebExtractRangesUsingRegex")(a,e,t,n)},a})(r("WAWebFormatMutator"))}l.default=e}),98);
__d("WAWebCodeFormatMutator",["WAWebCodeMutatorComponent.react","WAWebCreateRegexMutator","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=/```([\s\S]*?\S[\s\S]*?)```/g,c=r("WAWebCreateRegexMutator")(u,1),d=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n,o){var e=o.selectable,a=e===void 0?!1:e;return s.jsx(r("WAWebCodeMutatorComponent.react"),{selectable:a,children:t})},t})(c);d.format=!1;var m=function(t){return t.replace(u," ")};l.Code=d,l.removeCodeBlocks=m}),98);
__d("WAWebProcessAddonsJob",["WAJobOrchestratorTypes","WAWebDBProcessEditProtocolMsgs","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("processEditProtocolMsgs",function(e){return o("WAWebDBProcessEditProtocolMsgs").processEditProtocolMsgs(e.msgs)},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted({msgs:e});yield t}),s.apply(this,arguments)}l.processEditProtocolMsgsJob=e}),98);
__d("WAWebSendMessageEditAction",["PaymentLink","Promise","WAJobOrchestratorTypes","WALogger","WANullthrows","WATimeUtils","WAWebChatGetters","WAWebCodeFormatMutator","WAWebDBMessageDelete","WAWebDBMsgUtils","WAWebDBProcessMessage","WAWebDBUpdateMessageTable","WAWebErrorType","WAWebFrontendMsgGetters","WAWebLidMigrationUtils","WAWebMessageEditGatingUtils","WAWebMessageEditUtils","WAWebMessageSendPerfReporter","WAWebMessageSendReporter","WAWebMessagingGatingUtils","WAWebMsgActionCapability","WAWebMsgDataFromModel","WAWebMsgGetters","WAWebMsgInfoUtils","WAWebMsgKey","WAWebMsgKeyUtils","WAWebMsgModel","WAWebMsgModelFromData","WAWebMsgType","WAWebNewsletterGatingUtils","WAWebNewsletterSendMsgAction","WAWebOrchestratorNonPersistedJob","WAWebProcessAddonsJob","WAWebSendMsgRecordAction","WAWebSendMsgResultAction","WAWebStateUtils","WAWebViewMode.flow","WAWebWamMsgUtils","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_;function f(e,t,n){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){o("WAWebMessageEditUtils").isParentWithinEditProcessingWindow({parentTsInSeconds:e.t,editTsInSeconds:n,msgKey:e.id})?yield t.updateErrorCode(o("WAWebErrorType").SendFailureErrorCode.NoError):(yield e.updateErrorCode(o("WAWebErrorType").SendFailureErrorCode.EditWindowExpired),yield t.updateErrorCode(o("WAWebErrorType").SendFailureErrorCode.EditWindowExpired))}),g.apply(this,arguments)}function h(e,t){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){t!=null&&(yield o("WAWebDBUpdateMessageTable").updateMessageTable(e.id,{count:t}))}),y.apply(this,arguments)}function C(t){var r=o("WAWebMsgGetters").getLatestEditMsgKey(t);return r==null||!o("WAWebMsgActionCapability").canEditText(t)?(_||(_=n("Promise"))).resolve():o("WAWebDBMsgUtils").getMsgByMsgKey(r).then(function(e){if(e)return L(o("WAWebStateUtils").unproxy(t),o("WAWebMsgModelFromData").msgModelFromMsgData(e))}).catch(function(t){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[message-edit][resendLatestEdit] re-sending edit protocol message failed, the last edited msg was not found"]))).devConsole({error:t})})}function b(e,t,a){if(o("WAWebMsgGetters").getIsNewsletterMsg(e)?!o("WAWebNewsletterGatingUtils").isNewsletterMessageEditingEnabled():!o("WAWebMessageEditGatingUtils").sendTextEditEnabled())return o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] send is disabled, "," will not be edited"])),e.id.toString()),(_||(_=n("Promise"))).resolve();if(o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] handle send message edit"]))).devConsole({msg:e,text:t,options:a}),!o("WAWebMsgActionCapability").canEditText(e)&&!o("WAWebMsgActionCapability").canEditCaption(e))return(_||(_=n("Promise"))).reject(r("err")("Cannot edit message"));var i=v(o("WAWebStateUtils").unproxy(e),t,a);return k(o("WAWebStateUtils").unproxy(e),i)}function v(e,t,n){var a,i,l,s,u,c,d=o("WAWebFrontendMsgGetters").getChat(e),m=o("WAWebLidMigrationUtils").getMeUserLidOrJidForChat(d,o("WAWebMsgKeyUtils").TranslateMsgKeyType.EditMessage),p=o("WAWebChatGetters").getIsGroup(d)?o("WAWebWidFactory").asUserWidOrThrow(m):void 0,_=new(r("WAWebMsgKey"))({id:r("WAWebMsgKey").newId_DEPRECATED(),remote:e.id.remote,fromMe:!0,participant:p}),f=n.linkPreview,g=n.mentionedJidList,h=n.groupMentions,y={id:_,from:m,to:e.id.remote,type:o("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:o("WAWebMsgType").MsgKind.Protocol,subtype:"message_edit",viewMode:o("WAWebViewMode.flow").ViewModeType.VISIBLE,protocolMessageKey:e.id,local:!0,t:o("WATimeUtils").unixTime(),mentionedJidList:g,groupMentions:h,latestEditMsgKey:_,latestEditSenderTimestampMs:o("WATimeUtils").unixTimeMs(),editMsgType:e.type,errorCode:o("WAWebErrorType").SendFailureErrorCode.NoError,messageSecret:o("WAWebMessagingGatingUtils").isReportingTokenSendingEnabled()?e.messageSecret:null};switch(r("WANullthrows")(o("WAWebMessageEditUtils").getMsgEditType(e.type))){case o("WAWebMessageEditUtils").MsgEditType.TextEdit:y=babelHelpers.extends({},y,{body:t.trim(),title:(a=f==null?void 0:f.title)!=null?a:void 0,matchedText:(i=f==null?void 0:f.matchedText)!=null?i:void 0,description:f==null?void 0:f.description,thumbnail:(l=f==null?void 0:f.thumbnail)!=null?l:void 0,richPreviewType:f==null?void 0:f.richPreviewType,doNotPlayInline:f==null?void 0:f.doNotPlayInline,inviteGrpType:f==null?void 0:f.inviteGrpType,thumbnailDirectPath:f==null?void 0:f.thumbnailDirectPath,thumbnailSha256:f==null?void 0:f.thumbnailSha256,thumbnailEncSha256:f==null?void 0:f.thumbnailEncSha256,thumbnailHeight:f==null?void 0:f.thumbnailHeight,thumbnailWidth:f==null?void 0:f.thumbnailWidth,mediaKey:(s=f==null?void 0:f.mediaKey)!=null?s:void 0,mediaKeyTimestamp:(u=f==null?void 0:f.mediaKeyTimestamp)!=null?u:void 0,paymentLinkMetadata:(c=o("PaymentLink").getPaymentLinkMessageMetadata(f,o("WAWebCodeFormatMutator").removeCodeBlocks(t)))!=null?c:void 0});break;case o("WAWebMessageEditUtils").MsgEditType.CaptionEdit:y=babelHelpers.extends({},y,{caption:t.trim()});break;case o("WAWebMessageEditUtils").MsgEditType.EventEdit:case o("WAWebMessageEditUtils").MsgEditType.RichResponseEdit:break}return y}function S(e,t,n,r){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){e.latestEditMsgKey&&(yield o("WAWebDBMessageDelete").removeMessagesFromHistory([e.latestEditMsgKey.toString()]));try{r.startSavedStage(),yield o("WAWebDBProcessMessage").storeMessages([t],n),r.postSavedStage()}catch(e){throw o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[message-edit][sendMessageEdit] failed to store protocol msg data in message table"]))).verbose().devConsole(e).sendLogs("storeSentMessageEdit failed"),e}r.startRenderedStage(),yield o("WAWebProcessAddonsJob").processEditProtocolMsgsJob([t]),r.postRenderedStage()}),R.apply(this,arguments)}function L(e,t){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WAWebMsgGetters").getIsNewsletterMsg(e)?yield o("WAWebNewsletterSendMsgAction").sendNewsletterEditMsg(e,t):yield o("WAWebSendMsgRecordAction").sendMsgRecord(t),r=n.messageSendResult,a=n.t,i=n.count;if(o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[message-edit][sendMsgEditRecord] edit protocol msg sent with result"]))).devConsole({messageSendResult:r,t:a}),r!==o("WAWebSendMsgResultAction").SendMsgResult.OK){o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[message-edit][sendMsgEditRecord] failed to send edit protocol message"]))).devConsole({editProtocolMsg:t});return}yield f(e,t,a),yield h(e,i),e.updateAck(t.ack),e.isSendFailure=t.isSendFailure===!0||t.errorCode===o("WAWebErrorType").SendFailureErrorCode.EditWindowExpired,o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[message-edit][sendMsgEditRecord] parent msg status to send edit protocol message"]))).devConsole({msg:e})}),E.apply(this,arguments)}function k(e,t){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var r,a=new(o("WAWebMsgModel")).Msg(t),i=o("WAWebFrontendMsgGetters").getChat(e),l=!!((r=i.groupMetadata)!=null&&r.isLidAddressingMode),s=o("WAWebWamMsgUtils").msgIsLid(e,i.id,l),u=o("WAWebMsgInfoUtils").getGroupMessageSendReporterOptions(i.id,s);u.originalMessage=e,a.wamMessageSendReporter=new(o("WAWebMessageSendReporter")).MessageSendReporter(a,u),a.wamMessageSendPerfReporter=new(o("WAWebMessageSendPerfReporter")).MessageSendPerfReporter({chatWid:a.to,mediaType:a.getWamMediaType(),messageType:a.getWamMessageType()});var c=a.wamMessageSendPerfReporter;yield o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendMessageEdit",(function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){var r=n.msgData,o=n.chatId;yield S(r,t,o,c),yield L(e,a)});return function(e){return r.apply(this,arguments)}})(),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted({msgData:o("WAWebMsgDataFromModel").msgDataFromMsgModel(e),chatId:o("WAWebFrontendMsgGetters").getChat(e).id})}),I.apply(this,arguments)}l.resendLatestEdit=C,l.sendMessageEdit=b,l.createEditMsgData=v,l.addAndSendMessageEdit=k}),98);
__d("WAWebContactBlockedErrorAction",["WACustomError"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(t,n){var r;return r=e.call(this,t)||this,r.contact=n,r}return babelHelpers.inheritsLoose(t,e),t})(o("WACustomError").customError("ContactBlocked"));l.default=e}),98);
__d("WAWebOutgoingMessageTone",["WAWebNoop","WAWebUserPrefsNotifications","bx"],(function(t,n,r,o,a,i,l){var e=new window.Audio(r("bx").getURL(r("bx")("9562")));function s(){o("WAWebUserPrefsNotifications").getOutgoingMessageSound()&&e.play().catch(r("WAWebNoop"))}l.playOutgoingMessageTone=s}),98);
__d("WAWebChatUtmCache",[],(function(t,n,r,o,a,i){var e=(function(){function e(){this.utmReadChatIds=new Set}var t=e.prototype;return t.deleteChatId=function(t){this.utmReadChatIds.delete(t)},t.hasRead=function(t){return this.utmReadChatIds.has(t)},t.read=function(t){this.utmReadChatIds.add(t)},t.clearAll=function(){this.utmReadChatIds.clear()},e})(),l=new e;i.default=l}),66);
__d("WAWebUpdateUtmAction",["WAWebBizGatingUtils","WAWebChatUtmCache","WAWebUtmBizPrefs"],(function(t,n,r,o,a,i,l){function e(e,t){if(o("WAWebBizGatingUtils").isUtmTrackingEnabled()){var n=e.toString();o("WAWebUtmBizPrefs").persistUtmtoLocalStorage(n,t),r("WAWebChatUtmCache").deleteChatId(n)}}function s(e){var t=e.toString();o("WAWebUtmBizPrefs").removeUtmFromLocalStorage(t),r("WAWebChatUtmCache").read(t)}function u(e){if(!o("WAWebBizGatingUtils").isUtmTrackingEnabled())return null;var t=e.toString();if(r("WAWebChatUtmCache").hasRead(t))return null;var n=o("WAWebUtmBizPrefs").getUtmFromLocalStorage(t);return n==null&&r("WAWebChatUtmCache").read(t),n}l.addUtmToChat=e,l.clearUtmAfterMessageSent=s,l.getUtmForChat=u}),98);
__d("WAWebSendMsgRecordAction",["Promise","WAErrors","WAFilteredCatch","WALogger","WANullthrows","WAWebABProps","WAWebAck","WAWebAddOnsUpdateSendStatesAction","WAWebAddonSendMsgData","WAWebBackendErrors","WAWebBlocklistCollection","WAWebBotGenTypingIndicatorMsg","WAWebCommonMsgSubtypeTypes","WAWebConstantsDeprecated","WAWebContactBlockedErrorAction","WAWebContactCollection","WAWebExternalCtxConfig","WAWebExternalEntryPointPrefs","WAWebFindChatAction","WAWebGroupMetadataCollection","WAWebHandleMsgError","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgType","WAWebMsgUtilsBridge","WAWebNoop","WAWebOutgoingMessageTone","WAWebReactionsBEUtils","WAWebSendMsgMetricReporter","WAWebSendMsgRecordBridge","WAWebSendMsgResultAction","WAWebSendNotSpamAction","WAWebSingleEmojiDailyUtils","WAWebUpdateUnreadChatAction","WAWebUpdateUtmAction","WAWebUserPrefsMeUser","WAWebUtmBizUtils","WAWebWamEnumMessageSendResultType","WAWebWamMsgUtils","WAWebWebcMessageSendWamEvent","WAWebWid","asyncToGeneratorRuntime","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_;function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["sendMsgRecord"])));var r=o("WAWebSendMsgMetricReporter").createMsgModelMetricReporter(t);r.sendReporter=(n=r.sendReporter)!=null?n:r.createSendReporter();var a=t.id.remote,i=yield o("WAWebFindChatAction").findExistingChat(a,"sendMsgRecord");if(i.contact.isEnterprise&&!o("WAWebMsgGetters").getIsGroupMsg(t)){var l=o("WAWebUpdateUtmAction").getUtmForChat(a);l!=null&&o("WAWebUtmBizUtils").isUtmValid(i,l)&&(t.utm=l)}return t.isNewMsg=!0,C({type:"message",data:t},i,r)}),g.apply(this,arguments)}function h(e){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebSendMsgMetricReporter").createAddonMetricReporter(e),n=yield o("WAWebFindChatAction").findExistingChat(e.id.remote,"sendMsgRecord");return C({type:"addon",data:e},n,t)}),y.apply(this,arguments)}function C(e,t,n){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a){var i=e.data,l=r("WANullthrows")(i.to),f=i.id,g=f.remote;r("WAWebWid").isGroup(l)&&(yield r("WAWebGroupMetadataCollection").find(l)),t.isTrusted()||r("WAWebSendNotSpamAction")(t).catch(r("WAWebNoop"));var h=i.type===o("WAWebMsgType").MSG_TYPE.PROTOCOL&&["sender_revoke","admin_revoke"].includes(i.subtype),y=i.type===o("WAWebMsgType").MSG_TYPE.PROTOCOL&&i.subtype===o("WAWebCommonMsgSubtypeTypes").MsgSubtype.EphemeralSyncResponse,C=o("WAWebMsgGetters").getIsReaction(i)&&i.reactionText===o("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT;if(!o("WAWebMsgGetters").getIsGroupMsg(i)&&!h&&!C&&o("WAWebBlocklistCollection").BlocklistCollection.get(l))return(_||(_=n("Promise"))).reject(new(r("WAWebContactBlockedErrorAction"))("Contact is blocked",o("WAWebContactCollection").ContactCollection.assertGet(l)));var b;return h||(b=new(o("WAWebWebcMessageSendWamEvent")).WebcMessageSendWamEvent({messageType:o("WAWebWamMsgUtils").getWamMessageType(i),messageMediaType:o("WAWebWamMsgUtils").getWamMediaType(i),messageIsForward:!!i.isForwarded})),y||o("WAWebUpdateUnreadChatAction").sendSeen(t),e.type!=="addon"&&i.type!==o("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT&&!y&&!h&&o("WAWebMsgCollection").MsgCollection.trigger(r("WAWebConstantsDeprecated").NEW_MSG_SENT),(_||(_=n("Promise"))).resolve().then(function(){return e.type==="message"?o("WAWebSendMsgRecordBridge").sendMsgRecord(e.data,a):o("WAWebAddonSendMsgData").sendAddonProcess(e.data,a)}).then((function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){var a=f.fromMe&&o("WAWebUserPrefsMeUser").isMePrimary(g)?o("WAWebAck").ACK.READ:o("WAWebAck").ACK.SENT;return e.type==="message"&&(e.data.updateAck(a),o("WAWebAddOnsUpdateSendStatesAction").maybeUpdateAddOnAckForMsgAction(e.data,a)),o("WAWebBotGenTypingIndicatorMsg").maybeGenBotTypingIndicatorMessage(t,i),b&&(b.markMessageSendT(),b.commit()),!h&&o("WAWebABProps").getABPropConfigValue("single_emoji_logging_enabled")&&o("WAWebSingleEmojiDailyUtils").maybeIncrementSingleEmojiDailyStatsCount(i),i.utm!=null&&o("WAWebUpdateUtmAction").clearUtmAfterMessageSent(g),yield o("WAWebMsgUtilsBridge").logMessageSendForChatThreadLogging(i),[o("WAWebMsgType").MSG_TYPE.PROTOCOL,o("WAWebMsgType").MSG_TYPE.REACTION,o("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT].includes(i.type)||(t.lastReceivedKey=f),!r("gkx")("26258")&&!h&&!y&&o("WAWebOutgoingMessageTone").playOutgoingMessageTone(),o("WAWebExternalCtxConfig").isCtxLoggingEnabled()&&o("WAWebExternalEntryPointPrefs").deleteExternalEntryPoint(g),{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.OK,t:n.t,count:n.count}});return function(e){return a.apply(this,arguments)}})()).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").ServerStatusCodeError,function(e){var t;return e.status!==408&&o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Phone responded ",""])),e.status).sendLogs("send-not-200"),(t=a.sendReporter)==null||t.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_NETWORK,isTerminal:!1}),a.sendReporter=null,{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_NETWORK}})).catch(o("WAFilteredCatch").filteredCatch(o("WAErrors").BufferTooLargeError,function(){var e;return(e=a.sendReporter)==null||e.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_PAYLOAD_TOO_BIG,isTerminal:!0}),a.sendReporter=null,{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}})).catch(o("WAFilteredCatch").filteredCatch(o("WAWebHandleMsgError").MessageValidationError,function(){var e;return(e=a.sendReporter)==null||e.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_INVALID_PROTOBUF,isTerminal:!0}),a.sendReporter=null,{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}})).catch(o("WAFilteredCatch").filteredCatch(o("WAWebHandleMsgError").MessageSentAckError,function(e){var t;return o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["model:msg:createRecord dropped msg: ",""])),i.id.toString()).devConsole(i.type),o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Got error ",""])),String(e)).devConsole(e).sendLogs("send-msg-server-nack-error"),(t=a.sendReporter)==null||t.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UNKNOWN,isTerminal:!0}),a.sendReporter=null,{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}})).catch(function(t){var n;return o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["model:msg:createRecord dropped msg: ",""])),i.id.toString()).devConsole(i.type),e.type==="message"?o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Got error ",""])),String(t)).devConsole(t).tags("messaging").sendLogs("send-msg-error"):o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Got error ",""])),String(t)).tags("messaging","addons").sendLogs("send-addon-error: "+i.type),(n=a.sendReporter)==null||n.postFailure({result:o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UNKNOWN,isTerminal:!0}),a.sendReporter=null,{messageSendResult:o("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}})}),b.apply(this,arguments)}l.sendMsgRecord=f,l.sendAddonRecord=h}),98);
__d("WAWebUpdateMessageUIAction",["WALogger","WAWebBackendErrors","WAWebCommonMsgUtils","WAWebDBProcessMessage","WAWebHandleForMessageRange","WAWebHandleForMessageRangeEnums","WAWebHandleMsgTypes.flow","WAWebMsgCollection","WAWebMsgGetters","WAWebStatusCollection","asyncToGeneratorRuntime","gkx"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e,t,n,r,o){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a,i,l){a===void 0&&(a=o("WAWebHandleMsgTypes.flow").MessageOverwriteOption.NO_OVERWRITE),i===void 0&&(i=!0),l===void 0&&(l=!1);var c={add:"after",update:a!==o("WAWebHandleMsgTypes.flow").MessageOverwriteOption.NO_OVERWRITE,isHistory:!1},d=!l,m=yield o("WAWebHandleForMessageRange").handleForActiveMessageRange(t,n,d);if(!m.has(o("WAWebHandleForMessageRangeEnums").ActiveRangeHandlerAction.DropMessage)){var p=m.has(o("WAWebHandleForMessageRangeEnums").ActiveRangeHandlerAction.SkipUI),_=o("WAWebMsgCollection").MsgCollection.get(n.id);_&&((o("WAWebCommonMsgUtils").isPlaceholderMsg(_.type)||o("WAWebCommonMsgUtils").isFutureproofMsg(_.type))&&!(o("WAWebCommonMsgUtils").isPlaceholderMsg(n.type)||o("WAWebCommonMsgUtils").isFutureproofMsg(n.type))||o("WAWebCommonMsgUtils").isRichResponseMsg(_.type)&&o("WAWebCommonMsgUtils").isSomewhatParsedRichResponseMsg(n)?c.update=!0:_.fromQuotedMsg?o("WAWebMsgCollection").MsgCollection.remove(_):p=!0);try{o("WAWebMsgGetters").getIsStatus(n)&&o("WAWebStatusCollection").StatusCollection.handleUpdate(n,!1),p||(yield o("WAWebMsgCollection").MsgCollection.processMultipleMessages(t,[babelHelpers.extends({},n,{recvFresh:!0,isNewMsg:!0})],c,"updateMessageUIAction",null,i))}catch(a){if(a instanceof o("WAWebBackendErrors").LogoutDrop)return;if(a instanceof o("WAWebDBProcessMessage").PreviousMsgNotUpdatableError){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Msg: "," chat: "," Error: PreviousMsgNotUpdatableError"])),String(n.id),String(t));return}r("gkx")("26258")?o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Msg: "," chat: "," Error: ",", message: ",", stack: ",""])),String(n.id),String(t),a.name,a.message,a.stack).tags("messaging").devConsole(a):o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Msg: "," chat: "," Error: ",", message: ",", stack: ",""])),String(n.id),String(t),a.name,a.message,a.stack).tags("messaging").devConsole(a).sendLogs("msg_handler for MD: error storing/processing single message")}}}),d.apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebMsgCollection").MsgCollection.get(e.id);t!=null&&t.delete()}),p.apply(this,arguments)}l.updateUI=c,l.removePlaceholder=m}),98);
__d("WAWebHandleAddChats",["Promise","WAAsyncSleep","WALogger","WALongInt","WAWebABProps","WAWebBackendApi","WAWebChatConstants","WAWebCollectionConstants","WAWebConnModel","WAWebLid1X1MigrationGating","WAWebLogoutReasonConstants","WAWebMobilePlatforms","WAWebSchemaChat","WAWebSchemaMessage","WAWebSocketLogoutJob","asyncToGeneratorRuntime","isEmptyIterable"],(function(t,n,r,o,a,i,l){var e=["pendingInitialLoading","disappearingModeInitiator","disappearingModeTrigger","accountLid"],s,u,c,d,m,p;function _(e){return{ephemeralSettingTimestamp:o("WALongInt").maybeNumberOrThrowIfTooLarge(e.ephemeralSettingTimestamp),tcTokenSenderTimestamp:o("WALongInt").maybeNumberOrThrowIfTooLarge(e.tcTokenSenderTimestamp),tcTokenTimestamp:o("WALongInt").maybeNumberOrThrowIfTooLarge(e.tcTokenTimestamp)}}function f(e){if(o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated())try{var t=e.filter(function(e){return e.id.isRegularUser()&&e.accountLid==null});t.length>0&&o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["handleAddChats: no account_lid for "," chats. first: ",""])),t.length,t[0].id.toLogString()).sendLogs("add-chats-no-account-lid").tags("missing-lid")}catch(e){}}function g(e){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){return o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["handleAddChats: "," chats"])),t.length),f(t),o("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(t.map(function(t){var n=t.pendingInitialLoading,r=t.disappearingModeInitiator,o=t.disappearingModeTrigger,a=t.accountLid,i=babelHelpers.objectWithoutPropertiesLoose(t,e),l=babelHelpers.extends({},i,{id:t.id.toString(),muteExpiration:0,isAutoMuted:!1},_(i),{endOfHistoryTransferType:t.endOfHistoryTransferType});return a!=null&&(l.accountLid=a.toString()),r!=null&&(l.disappearingModeInitiator=r),o!=null&&(l.disappearingModeTrigger=o),l})).catch((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return y(e,t)});return function(t){return e.apply(this,arguments)}})()).then(function(){return o("WAWebBackendApi").frontendSendAndReceive("chatCollectionAdd",{things:t.map(function(e){var t;return babelHelpers.extends({},e,{accountLid:(t=e.accountLid)!=null?t:void 0},_(e),{endOfHistoryTransferType:o("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.cast(e.endOfHistoryTransferType)})}),options:{merge:!0}})}).then(function(){(o("WAWebConnModel").Conn.platform===o("WAWebMobilePlatforms").PLATFORMS.IPHONE||o("WAWebConnModel").Conn.platform===o("WAWebMobilePlatforms").PLATFORMS.SMBI)&&(r("isEmptyIterable")(t)?o("WAWebBackendApi").frontendFireAndForget("msgCollectionTrigger",{name:o("WAWebCollectionConstants").COLLECTION_HAS_SYNCED}):self.setTimeout(function(){o("WAWebBackendApi").frontendFireAndForget("msgCollectionTrigger",{name:o("WAWebCollectionConstants").COLLECTION_HAS_SYNCED})},2500)),o("WAWebBackendApi").frontendFireAndForget("chatCollectionTrigger",{name:o("WAWebCollectionConstants").COLLECTION_HAS_SYNCED,args:{count:t.length}})})}),h.apply(this,arguments)}function y(e,t){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WAWebABProps").getABPropConfigValue("wa_web_logout_db_hist_sync_failed");if(n&&(yield b(t)),o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["handleAddChats: bulkCreateOrMerge failed: is lid migrated: "," logout: ",". error: ",""])),o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated(),n,e.stack).sendLogs("fail-to-add-chats-history-sync",n?{sendLogsType:o("WALogger").SendLogsType.USER_FORCEFULLY_LOGGED_OUT_SAD}:void 0),n)return yield o("WAAsyncSleep").asyncSleep(5e3),o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.WebFailAddChat)}),C.apply(this,arguments)}function b(e){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebSchemaChat").getChatTable().all(),r=t.map(function(e){return e.id}),a=new Set(t.map(function(e){return e.accountLid}));o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["fail-add-chat: existingChatIds: ",", existingChatAccountLids: ",""])),r,Array.from(a));var i=[],l=function*(){var e=u.accountLid;if(e==null)return 0;if(a.has(e.toString())){var n=t.find(function(t){return t.accountLid===e.toString()});if(!n)return 0;i.push(S(n.id))}},s;for(var u of e)s=yield*l();yield(p||(p=n("Promise"))).all(i)}),v.apply(this,arguments)}function S(e){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebSchemaMessage").getMessageTable().between(["internalId"],e+"_",e+"_z",{lowerInclusive:!0,upperInclusive:!1,shouldDecrypt:!1}),n=t.map(function(e){return{type:e.type,subtype:e.subtype}}).map(function(e){return JSON.stringify(e)}).join(",");o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["messages pre-existing before history for chat ",": [","]"])),e,n)}),R.apply(this,arguments)}l.default=g}),98);
__d("WAWebHistoryMsgHandlerAction",["Promise","WAAckLevel","WAFilteredCatch","WAJids","WALogger","WALongInt","WANullthrows","WATimeUtils","WAWebABProps","WAWebAddonProcessMsgs","WAWebAddonProcessMsgsUtils","WAWebAdvHostedAccountTypeSystemMsg","WAWebApiContact","WAWebApiFilterAndReplaceMessages","WAWebApiHistorySyncNotification","WAWebBackendApi","WAWebBackendErrors","WAWebBackendJobs.flow","WAWebBizAiAgentGating","WAWebBizCoexGatingUtils","WAWebBizCoexUtils","WAWebBizGatingUtils","WAWebBotTypes","WAWebChatConstants","WAWebCheckUpdateOrphanReactions","WAWebContactCollection","WAWebCountriesUtils","WAWebCryptoCurve25519","WAWebCurrentUser","WAWebDBCreateLidPnMappings","WAWebDBProcessInitialHistorySyncMessage","WAWebDBReportingTokenUtils","WAWebEphemeralityTypes","WAWebEphemeralityUtils","WAWebHandleAddChats","WAWebHandleMsgTypes.flow","WAWebHandleSingleMsg","WAWebHistorySyncNotificationUtils","WAWebHistorySyncStickers","WAWebLidAwareContactsDB","WAWebLidMigrationUtils","WAWebLidStatusMigrationUtils","WAWebLimitSharingProtoUtils","WAWebMemberLabelHistorySync","WAWebMessageAssociationGatingUtils","WAWebMessageReceiptBatcher","WAWebMessagingGatingUtils","WAWebMmSignalSharingExpirationWindowUtils","WAWebMobilePlatforms","WAWebMsgAGMProcessing","WAWebMsgKey","WAWebMsgProcessingApiUtils","WAWebMsgType","WAWebNoop","WAWebProcessMessageAssociationMessages","WAWebProtobufsAdv.pb","WAWebProtobufsE2E.pb","WAWebProtobufsHistorySync.pb","WAWebReportingTokenUtils","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebSyncBootstrap","WAWebSyncdOrphan","WAWebUserPrefsHistorySync","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsMeUser","WAWebUserPrefsModelStorage","WAWebUserPrefsMultiDevice","WAWebUsernameTypes","WAWebVoipActionWriteCallLogSync","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x,$,P,N,M,w;function A(e,t,n,r,o,a,i,l){return F.apply(this,arguments)}function F(){return F=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,i,l,s,u,c){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[history sync] starts hanlding initial sync msgs"])));var T=[],D={},x={},$=new Map,P={},N=[],M=0,A=[],F=o("WAWebHistorySyncNotificationUtils").getLidMappingAsStringSet(c);o("WAWebCurrentUser").isEmployee()&&o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["first lid mappings for initial sync. count: ",". ","..."])),F==null?void 0:F.size,o("WAWebHistorySyncNotificationUtils").getLidsForLogging(F)).verbose();var O=new Map,B=o("WAWebBizCoexGatingUtils").smbHostedLazySystemMsgInsertInHistorySyncEnabled()&&(yield o("WAWebUserPrefsMultiDevice").getIsHostedMeAccount())===!0,W=function*(n){var e,i,l,s;o("WAWebCurrentUser").isEmployee()&&o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[history sync] processing conversation "," with "," messages"])),n.id,n.messages.length);var u=o("WAWebWidFactory").createWid(n.id);if(u.isNewsletter())return 0;if(u.isUser()){if(u.isLid()){var c=n.pnJid;c!=null&&T.push({lid:u,pn:o("WAWebWidFactory").createUserWidOrThrow(c)});var d=n.displayName,m=n.shareOwnPn;if(d!=null||m!=null){var p={};d!=null&&(p.displayNameLID=d),m!=null&&(p.shareOwnPn=m),a.push({lid:u,data:p})}}else if(n.lidJid!=null){var _=o("WAWebWidFactory").createUserLidOrThrow(n.lidJid);T.push({lid:_,pn:u})}}var f=[];M+=n.messages.length;var g=[],h=new Set,y=[];n.messages.length===0&&(D[n.id]=-1),r("isStringNullOrEmpty")(n.pHash)||(P[n.id]=n.pHash);var w,W=[];n.messages.forEach(function(e,a){var i,l,s,c;if(a===n.messages.length-1){var d=o("WALongInt").maybeNumberOrThrowIfTooLarge(e.msgOrderId);d!=null&&(D[n.id]=d)}var m=(e==null||(i=e.message)==null||(i=i.message)==null||(i=i.protocolMessage)==null?void 0:i.type)===o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REQUEST_WELCOME_MESSAGE;if(m){o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Dropping request welcome message"])));return}var p=(e==null||(l=e.message)==null||(l=l.message)==null||(l=l.protocolMessage)==null?void 0:l.type)===o("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.BOT_MEMU_ONBOARDING_MESSAGE;if(p){o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Dropping memu onboarding message"])));return}if(o("WAWebMobilePlatforms").isSMB()&&o("WAWebBizCoexGatingUtils").smbHostedLazySystemMsgInsertInHistorySyncEnabled()&&a===0&&u.isUser()&&n.systemMessageToInsert!=null)switch(n.systemMessageToInsert){case o("WAWebProtobufsHistorySync.pb").PrivacySystemMessage.E2EE_MSG:{if(B)break;var _=o("WAWebAdvHostedAccountTypeSystemMsg").genAdvAccountTypeChangeNotificationMsg(u,o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),o("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE);g.push(_),o("WAWebBizCoexUtils").sendWamCoexPrivacySysMsgHistorySyncInsert(_);break}case o("WAWebProtobufsHistorySync.pb").PrivacySystemMessage.NE2EE_SELF:{if(!B)break;var C=o("WAWebAdvHostedAccountTypeSystemMsg").genAdvAccountTypeSelfTransitionToCoexNotificationMsg(u,o("WAWebUserPrefsMeUser").getMePnUserOrThrow());g.push(C),o("WAWebBizCoexUtils").sendWamCoexPrivacySysMsgHistorySyncInsert(C);break}case o("WAWebProtobufsHistorySync.pb").PrivacySystemMessage.NE2EE_OTHER:{var S=o("WAWebAdvHostedAccountTypeSystemMsg").genAdvAccountTypeChangeNotificationMsg(u,o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),o("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED);g.push(S),o("WAWebBizCoexUtils").sendWamCoexPrivacySysMsgHistorySyncInsert(S)}}var R=o("WAWebHistorySyncNotificationUtils").parseWebMsgInfoAndReturnNullOnFailure(u,e.message,t,F,O),L=((s=e.message)==null||(s=s.message)==null||(s=s.commentMessage)==null?void 0:s.targetMessageKey)==null,E=(R==null?void 0:R.associationType)!=null;if(L){var k;R!=null&&h.has(R.id.toString())&&o("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&h.delete(R==null?void 0:R.id.toString()),R!=null&&R.type===o("WAWebMsgType").MSG_TYPE.INTERACTIVE&&R.ctwaContext!=null||g.push(R);var I=(k=e.message)==null||(k=k.message)==null||(k=k.extendedTextMessage)==null||(k=k.contextInfo)==null?void 0:k.externalAdReply,T=R!=null?R:{},x=T.id,$=T.from,P=T.to;if(I!=null&&(x==null?void 0:x.fromMe)!=null&&$!=null&&P!=null&&o("WAWebBizGatingUtils").shouldGenerateAGMMsgs(I)){var N,M=new(r("WAWebMsgKey"))({fromMe:!x.fromMe,remote:u,id:r("WAWebMsgKey").newId_DEPRECATED()}),A=o("WAWebMsgAGMProcessing").genHistoryAutomatedGreetingMsg({msgKey:M,ctwaContext:I,to:$,from:P,msgTimestamp:(N=e.message)==null?void 0:N.messageTimestamp});g.push(A)}}if(R!=null&&E&&o("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var q=R.parentMsgKey.toString();h.add(q),y.push(R)}f=f.concat(o("WAWebAddonProcessMsgsUtils").parseHistorySyncMsg({webMsgInfo:e.message,parsedWebMsgInfo:R,isFromCag:(c=n.isDefaultSubgroup)!=null?c:!1})),(R==null?void 0:R.subtype)==="biz_bot_1p_disclosure"&&(w=o("WAWebBotTypes").BizBotType.BIZ_1P),(R==null?void 0:R.subtype)==="biz_bot_3p_disclosure"&&(w=o("WAWebBotTypes").BizBotType.BIZ_3P),W=o("WAWebMmSignalSharingExpirationWindowUtils").getUpdatedMmSignalSharingExpirationWindowFromHistorySync(e.message,W)});var q;if(h.size>0&&o("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var U=o("WAWebProcessMessageAssociationMessages").classifyAssociatedMsgsFromHistorySyncUsingMissingParentsCache(y,h);U!=null&&U.validAssociatedMsgs&&(q=o("WAWebApiFilterAndReplaceMessages").validateMsgFn(U==null?void 0:U.validAssociatedMsgs))}g=o("WAWebApiFilterAndReplaceMessages").filterAndReplaceMessagesInitialHistorySync(g,q),g=g.reverse();var V=n.contactPrimaryIdentityKey;if(V&&r("WAWebWid").isUser(u)){var H=o("WAWebSignalCommonUtils").bufferToStr(o("WAWebCryptoCurve25519").toSignalCurvePubKey(V));A.push({userId:o("WAWebWidFactory").asUserWidOrThrow(u),identityKey:H})}var G,z,K;if(((e=n.disappearingMode)==null?void 0:e.initiator)!=null)switch(n.disappearingMode.initiator){case o("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.CHANGED_IN_CHAT:G=o("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat,z=o("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings;break;case o("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_ME:G=o("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe,z=o("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings,K=!0;break;case o("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_OTHER:case o("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.BIZ_UPGRADE_FB_HOSTING:G=o("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByOther,z=o("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings,K=!1;break}if(o("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_daily_logs")){var Q,X;if(((Q=n.disappearingMode)==null?void 0:Q.trigger)!=null){var Y=o("WAWebEphemeralityUtils").getDisappearingModeTriggerFromProtobuf(n.disappearingMode.trigger);Y!=null&&(z=Y)}((X=n.disappearingMode)==null?void 0:X.initiatedByMe)!=null&&(K=n.disappearingMode.initiatedByMe)}var J=n.tcToken!=null&&n.tcTokenTimestamp!=null,Z=j(u,n);if(Z.result==="skip-chat")return 0;if(Z.result==="extracted"){var ee=Z.accountLid;if($.has(ee))return o("WALogger").DEV(S||(S=babelHelpers.taggedTemplateLiteralLoose(["duplicated accountLid: ",", existingChatId: ",", new chatId: ",""])),ee.toString(),r("WANullthrows")($.get(ee)).toString(),u.toString()),o("WALogger").ERROR(R||(R=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleInitialSyncMsgs: Found duplicated accountLid during initial sync"]))).sendLogs("duplicated-account-lid-in-history-sync"),0;$.set(ee,u)}if(o("WAWebCurrentUser").isEmployee()){var te;o("WALogger").LOG(L||(L=babelHelpers.taggedTemplateLiteralLoose(["handleInitialSyncMsgs: incoming chat info: ",", ",", ",""])),u,(te=Z.accountLid)!=null?te:"n/a",u.isRegularUser()?o("WAWebApiContact").getAlternateUserWid(o("WAWebWidFactory").asUserWidOrThrow(u)):"n/a")}var ne=Z.accountLid,re={t:o("WALongInt").maybeNumberOrThrowIfTooLarge((i=n.conversationTimestamp)!=null?i:n.lastMsgTimestamp),accountLid:ne,id:u,unreadCount:n.unreadCount,ephemeralDuration:n.ephemeralExpiration,ephemeralSettingTimestamp:n.ephemeralSettingTimestamp,disappearingModeInitiator:G,disappearingModeTrigger:z,disappearingModeInitiatedByMe:K,endOfHistoryTransferType:(l=n.endOfHistoryTransferType)!=null?l:o("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.INCOMPLETE,name:n.name,notSpam:n.notSpam,pendingInitialLoading:!1,unreadMentionCount:n.unreadMentionCount,tcToken:J?n.tcToken:null,tcTokenTimestamp:J?n.tcTokenTimestamp:null,tcTokenSenderTimestamp:n.tcTokenSenderTimestamp,bizBotSystemMsgType:w,isLocked:n.locked,limitSharing:o("WAWebLimitSharingProtoUtils").getLimitSharingFromProtocolHistorySyncConversation(n),capiThreadControl:o("WAWebBizAiAgentGating").isAiAgentThreadStatusHistorySyncEnabled()?n.maibaAiThreadEnabled===!0?o("WAWebProtobufsE2E.pb").Message$CloudAPIThreadControlNotification$CloudAPIThreadControl.CONTROL_TAKEN:n.maibaAiThreadEnabled===!1?o("WAWebProtobufsE2E.pb").Message$CloudAPIThreadControlNotification$CloudAPIThreadControl.CONTROL_PASSED:n.maibaAiThreadEnabled===void 0?o("WAWebProtobufsE2E.pb").Message$CloudAPIThreadControlNotification$CloudAPIThreadControl.UNKNOWN:(function(){throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+n.maibaAiThreadEnabled)})():o("WAWebProtobufsE2E.pb").Message$CloudAPIThreadControlNotification$CloudAPIThreadControl.UNKNOWN};if(u.isLid()){var oe=n.lidOriginType;if(oe!=null){var ae=o("WAWebUsernameTypes").LidOriginType.cast(oe);ae!==o("WAWebUsernameTypes").LidOriginType.PNH_CTWA&&ae!==o("WAWebUsernameTypes").LidOriginType.GENERAL&&o("WALogger").ERROR(E||(E=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleInitialSyncMsgs: invalid lidOriginType received."]))).sendLogs("handleInitialSyncMsgs: invalid lidOriginType received: "+oe),re.lidOriginType=ae}else re.lidOriginType=o("WAWebUsernameTypes").LidOriginType.GENERAL}n.archived!=null&&(re.archive=n.archived),(s=W)!=null&&s.length&&(re.mmSignalSharingExpirationWindow=W);try{o("WAWebHistorySyncNotificationUtils").saveGroupMetadataForLeftGroup(n,re.id)}catch(e){o("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[history sync] history_sync_notification_handler: saveGroupMetadataForLeftGroup failed"]))).tags("history-sync").devConsole(e)}Object.prototype.hasOwnProperty.call(x,n.id)?o("WALogger").LOG(I||(I=babelHelpers.taggedTemplateLiteralLoose(["[history sync] found duplicated conversation id during initial sync"]))):N.push(re),x[n.id]={chatInfo:re,msgs:g,unifiedAddons:f}},q;for(var U of e.conversations)q=yield*W(U);for(var V of e.accounts){var H=K(V);H&&u.push(H)}T.length>0&&(o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history sync] saving "," LIDxPN mappings obtained from conversations"])),T.length),yield o("WAWebDBCreateLidPnMappings").createLidPnMappings({mappings:T,flushImmediately:!0,identityChangeHandlingEnabled:!1,learningSource:"other"})),i.mdBootstrapMessagesCount=M,i.mdBootstrapChatsCount=e.conversations.length,o("WAWebHistorySyncNotificationUtils").commitHistoryDownloadedMetric(i,t.historySyncStepStartedTs,!0,s),r("WAWebSyncBootstrap").markInitialHistorySyncCountDebugStats(M,N.length);var G=0,Q=[];A.forEach(function(e){var t=e.userId,n=e.identityKey;!t.isLid()&&o("WAWebApiContact").getCurrentLid(t)==null&&t.isRegularUser()&&G++;try{var r=o("WAWebSignalCommonUtils").createSignalAddress(t).toString();t.equals(o("WAWebUserPrefsMeUser").getMePnUserOrThrow())?o("WAWebHistorySyncNotificationUtils").checkSelfHistorySyncIdentity(r,n).catch(function(){o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleInitialSyncMsgs: can't save the identity key."],["[history sync] handleInitialSyncMsgs: can\\'t save the identity key."]))).sendLogs("failed-self-identity-check-from-history-sync")}):Q.push({identifier:r,identityKey:n})}catch(e){o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleInitialSyncMsgs: can't save the identity key."],["[history sync] handleInitialSyncMsgs: can\\'t save the identity key."])))}}),yield o("WAWebSignalProtocolStore").getPersistSignalProtocolStore().bulkCreateIdentity(Q),G>0&&o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleInitialSyncMsgs: there are Identities with missing LIDs: ",""])),G).sendLogs("handleInitialSyncMsgs: there are Identities with missing LIDs",{sampling:.01}),yield r("WAWebHandleAddChats")(N),yield z(x),yield o("WAWebApiHistorySyncNotification").updateCurrentlyProcessed(t.msgKey,t.syncType,t.chunkOrder),o("WAWebHistorySyncNotificationUtils").commitHistoryDataAppliedMetric({historySyncDataAppliedMetric:l,startTs:t.historySyncStepStartedTs,isSuccess:!0,forceFlushWamBuffer:!0}),o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing initial sync messages complete, ",""])),o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(t,M,N.length)),o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[history sync] set history initial sync boundary with length ",""])),Object.keys(D).length),yield(w||(w=n("Promise"))).all([o("WAWebHistorySyncNotificationUtils").handleChatThreadLoggingMetadata(e),o("WAWebUserPrefsHistorySync").setHistoryInitialSyncBoundary(D),e.companionMetaNonce!=null?o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set("WAWebCompanionMetaNonce",e.companionMetaNonce):null]),o("WAWebUserPrefsModelStorage").setInitialGroupPhash(P),o("WAWebHistorySyncNotificationUtils").reportMissingMapping(O)}),F.apply(this,arguments)}function O(e,t,n,r,o){return B.apply(this,arguments)}function B(){return B=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,i,l){o("WALogger").LOG(T||(T=babelHelpers.taggedTemplateLiteralLoose(["[history sync] start processing status"]))),a.mdBootstrapMessagesCount=e.statusV3Messages.length,o("WAWebHistorySyncNotificationUtils").commitHistoryDownloadedMetric(a,t.historySyncStepStartedTs,!0,l),e.statusV3Messages.sort(function(e,t){var n=e.messageTimestamp,r=t.messageTimestamp;return o("WATimeUtils").castToUnixTime(parseInt(n,10))-o("WATimeUtils").castToUnixTime(parseInt(r,10))});var s=[];yield(w||(w=n("Promise"))).all(e.statusV3Messages.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,a=null,i=[];e.key.fromMe===!0?(a=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),i=e.userReceipt.filter(function(e){return e.readTimestamp!=null&&e.readTimestamp!==0})):a=o("WAWebWidFactory").createWid(r("WANullthrows")(e.participant));var l={type:o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.OTHER_STATUS,externalId:r("WANullthrows")(e.key.id),ts:o("WATimeUtils").castToUnixTime(parseInt(e.messageTimestamp,10)),edit:-1,isHsm:!1,count:null,chat:o("WAWebWidFactory").createWid(o("WAJids").STATUS_JID),author:r("WANullthrows")(a),pushname:null,isDirect:!1},u=o("WAWebBackendJobs.flow").CiphertextType.Skmsg,c=yield o("WAWebMsgProcessingApiUtils").parseMessage({info:l,ciphertextType:u,msgProtobuf:r("WANullthrows")(e.message),hsmInfo:null}),d=c.renderableMsgs&&c.renderableMsgs;if(!d||d.length!==1)return(w||(w=n("Promise"))).resolve();var m=d[0].id,p=d[0].author,_=babelHelpers.extends({},d[0],{author:p&&o("WAWebLidStatusMigrationUtils").matWidConvert(p),id:new(r("WAWebMsgKey"))({fromMe:m.fromMe,remote:m.remote,id:m.id,participant:m.participant==null?void 0:o("WAWebLidStatusMigrationUtils").matWidConvert(m.participant)})});if(e.participant==="0@s.whatsapp.net")return(w||(w=n("Promise"))).resolve();var f=e.ignore===!0;if(f&&(_=babelHelpers.extends({},_,{invis:!0,ack:o("WAAckLevel").ACK.READ})),yield o("WAWebHandleSingleMsg").handleSingleMsg({chatId:_.id.remote,newMsg:_,handleSingleMsgOrigin:"historyStatusMessages"}),i.forEach(function(e){var t,n=o("WALongInt").numberOrThrowIfTooLarge((t=e.readTimestamp)!=null?t:0),r=o("WAWebWidFactory").createWid(e.userJid);o("WAWebMessageReceiptBatcher").receiptBatcher.acceptOtherReceipt({ts:n,ack:o("WAAckLevel").ACK.READ,receiverId:r,msgKeys:[_.id.toString()]})}),o("WAWebMessagingGatingUtils").isReportingTagSyncingEnabled()&&((t=e.reportingTokenInfo)==null?void 0:t.reportingTag)!=null){var g;_=babelHelpers.extends({},_,{reportingTokenInfo:{reportingTag:new Uint8Array((g=e.reportingTokenInfo)==null?void 0:g.reportingTag),version:o("WAWebReportingTokenUtils").REPORTING_TOKEN_VERSION.HISTORY_SYNC}})}return s.push(_),!0});return function(t){return e.apply(this,arguments)}})())),yield o("WAWebApiHistorySyncNotification").updateCurrentlyProcessed(t.msgKey,t.syncType,t.chunkOrder),o("WAWebHistorySyncNotificationUtils").commitHistoryDataAppliedMetric({historySyncDataAppliedMetric:i,startTs:t.historySyncStepStartedTs,isSuccess:!0}),o("WALogger").LOG(D||(D=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing Status complete, ",""])),o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(t,e.statusV3Messages.length)),o("WAWebDBReportingTokenUtils").handleHistorySyncedReportingInfo(s)}),B.apply(this,arguments)}function W(e,t,n,r,o){return q.apply(this,arguments)}function q(){return q=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a){o("WALogger").LOG(x||(x=babelHelpers.taggedTemplateLiteralLoose(["[history sync] processing history non blocking data"]))),o("WAWebHistorySyncNotificationUtils").commitHistoryDownloadedMetric(n,t.historySyncStepStartedTs,!0,a),e.pastParticipants!=null&&e.pastParticipants.length>0&&(yield o("WAWebHistorySyncNotificationUtils").processPastParticipants(e,t)),e.callLogRecords!=null&&e.callLogRecords.length>0&&(yield U(e,t)),e.conversations!=null&&(yield o("WAWebMemberLabelHistorySync").processMemberLabels(e)),o("WAWebHistorySyncStickers").processRecentStickers(e,t),o("WAWebHistorySyncNotificationUtils").commitHistoryDataAppliedMetric({historySyncDataAppliedMetric:r,startTs:t.historySyncStepStartedTs,isSuccess:!0})}),q.apply(this,arguments)}function U(e,t){return V.apply(this,arguments)}function V(){return V=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){o("WALogger").LOG($||($=babelHelpers.taggedTemplateLiteralLoose(["[history sync] start processing call log records"]))),e.callLogRecords.sort(function(e,t){var n=e.startTime,r=t.startTime;return o("WATimeUtils").castToUnixTime(parseInt(n,10))-o("WATimeUtils").castToUnixTime(parseInt(r,10))}),yield(w||(w=n("Promise"))).all(e.callLogRecords.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield o("WAWebVoipActionWriteCallLogSync").generateCallLogFromCallSyncRecord({callLogRecord:e,fromHistorySync:!0})});return function(t){return e.apply(this,arguments)}})())),o("WALogger").LOG(P||(P=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing call log records complete, ",""])),o("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(t,e.callLogRecords.length))}),V.apply(this,arguments)}function H(e,t,n,r,o){return G.apply(this,arguments)}function G(){return G=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a,i){o("WALogger").LOG(N||(N=babelHelpers.taggedTemplateLiteralLoose(["[history sync] start processing initial pushname"]))),o("WAWebHistorySyncNotificationUtils").commitHistoryDownloadedMetric(n,t.historySyncStepStartedTs,!0,i);var l=e.pushnames.map(function(e){return{id:e.id||"",pushname:e.pushname||""}});yield r("WAWebLidAwareContactsDB").bulkCreateOrMerge(l,"HistoryMsgHandlerAction.handlePushName"),yield o("WAWebApiHistorySyncNotification").updateCurrentlyProcessed(t.msgKey,t.syncType,t.chunkOrder);var s=[];e.pushnames.forEach(function(e){var t=o("WAWebWidFactory").createWid(e.id||""),n=o("WAWebContactCollection").ContactCollection.get(t);if(s.push({id:t,pushname:e.pushname||"",type:(n==null?void 0:n.type)||"out",name:n==null?void 0:n.name}),!t.isLid()){var r=o("WAWebApiContact").getCurrentLid(o("WAWebWidFactory").asUserWidOrThrow(t));r!=null&&s.push({id:r,pushname:e.pushname||"",type:(n==null?void 0:n.type)||"out",name:n==null?void 0:n.name})}}),o("WAWebContactCollection").ContactCollection.add(s,{merge:!0}),o("WAWebHistorySyncNotificationUtils").commitHistoryDataAppliedMetric({historySyncDataAppliedMetric:a,startTs:t.historySyncStepStartedTs,isSuccess:!0}),o("WALogger").LOG(M||(M=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing initial pushname complete with "," records"])),e.pushnames.length)}),G.apply(this,arguments)}function z(t){var a={add:"last",isHistory:!0},i=Object.keys(t).map(function(e){return o("WAWebBackendApi").frontendSendAndReceive("processMultipleMessages",{chatId:o("WAWebWidFactory").createWid(e),msgObjs:t[e].msgs,meta:a,processMessagesOrigin:"historyMsgHandlerAction",chatMsgsCollection:null})});return(w||(w=n("Promise"))).all([].concat(i,[o("WAWebDBProcessInitialHistorySyncMessage").storeInitialSyncMessages(t)])).then(function(){var n,r=(n=Array.prototype).concat.apply(n,Object.keys(t).map(function(e){return t[e].msgs.map(function(e){return e.id.toString()})}));return o("WAWebCheckUpdateOrphanReactions").checkUpdateForOrphanReactions(r).catch(function(){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Failed update for orphan reactions"]))).sendLogs("failed-update-for-orphan-reactions")}),o("WAWebSyncdOrphan").checkOrphanMutations(r,Object.keys(t))}).then(function(){var e;return(w||(w=n("Promise"))).all((e=Array.prototype).concat.apply(e,Object.keys(t).map(function(e){return t[e].unifiedAddons}))).then(function(e){var t;return o("WAWebAddonProcessMsgs").processHistoryMsgs((t=[]).concat.apply(t,e))})}).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").LogoutDrop,r("WAWebNoop"))).catch(function(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Error: ",", message: ",", stack: ",""])),e.name,e.message,e.stack).devConsole(e).sendLogs("msg_handler for MD: error storing/processing multiple messages")})}function j(e,t){if(!o("WAWebLidMigrationUtils").shouldHaveAccountLid(e))return{result:"not-needed"};if(t.accountLid!=null){var n=o("WAWebWidFactory").createUserLidOrThrow(t.accountLid);return{result:"extracted",accountLid:n}}return e.isLid()?{result:"extracted",accountLid:e}:(o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleInitialSyncMsgs: Migrated account not sending accountLid for a PN chat in history sync"]))).devConsole(e.toString()).sendLogs("missing-account-lid-in-history-sync"),{result:"skip-chat"})}function K(e){var t=e.lid,n=e.username,r=e.countryCode;if(!(t==null||n==null&&r==null)){var a=o("WAWebWidFactory").createUserWidOrThrow(t),i;if(r!=null&&(i=o("WAWebCountriesUtils").asISOCountryCode(r),!i&&o("WAWebCurrentUser").isEmployee()&&o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[history sync] invalid country code retrieved"]))).sendLogs("invalid-country-code-for-username-history-sync",{sampling:.01})),n!=null){var l={userId:a,username:n};return i!=null&&(l.usernameCountryCode=i),l}else if(i!=null)return{userId:a,usernameCountryCode:i}}}l.handleInitialSyncMsgs=A,l.handleStatusMessages=O,l.handleNonBlockingData=W,l.handlePushName=H,l.getUsernameUpdate=K}),98);
__d("WAWebAddAndReorderMsgsActionsUtils",["WALogger","WAWebMsgModelUtils"],(function(t,n,r,o,a,i,l){var e;function s(e,t,n,r,a,i,l,s,c){var d=u(e,t,n,r,i);o("WAWebMsgModelUtils").addRecordsToChat(d.msgs,r,a,d.collection,l,s,c)}function u(t,n,r,a,i){var l={},s={},u,c,d,m=r.length,p=i;if(m===0)return{msgs:n,collection:p};for(u=0;u<m;u++)c=r[u],s[c.id]=c;for(m=n.length,u=0;u<m;u++)c=n[u],c&&(l[c.id]=c);var _=[];for(m=t.length,u=0;u<m;u++)if(c=t[u],!!c&&(d=l[c.id],d&&_.push(d),d=s[c.id],d))if(d.recvFresh)_.push(d),a.removeMsg(d),d.unset("recvFresh");else{var f=a.getAllCMCs(),g=f.find(function(e){return e.get(d.id)});i&&g===i||(g?(g.forEach(function(e){_.push(e),delete s[e.id]}),g===a.msgs?(a.replaceMsgsCollection(i),p=a.msgs):(a.notifyMsgCollectionMerge(i,g,i),a.removeMsgsCollection(g))):(o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["models:Msg:reorder trying to merge CMC of orphaned message ",""])),c.id).devConsole(c),_.push(s[c.id])))}return{msgs:_,collection:p}}l.default=s}),98);
__d("WAWebButtonModel",["WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.displayText=o("WAWebBaseModel").prop(),t.selected=o("WAWebBaseModel").session(!1),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="replyButton";var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebTemplateButtonModel",["WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.displayText=o("WAWebBaseModel").prop(),t.subtype=o("WAWebBaseModel").prop(),t.url=o("WAWebBaseModel").prop(),t.phoneNumber=o("WAWebBaseModel").prop(),t.selectionId=o("WAWebBaseModel").prop(),t.selected=o("WAWebBaseModel").session(!1),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="templateButton";var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebGetMsgUpdatesActionsUtils",["Promise","WALogger","WANullthrows","WATypeUtils","WAWebAck","WAWebButtonCollection","WAWebButtonModel","WAWebChatCollection","WAWebDBGroupParticipant","WAWebEphemeralSyncResponse","WAWebErrorType","WAWebFrontendMsgGetters","WAWebGroupSystemMsg","WAWebGroupType","WAWebHandleSingleMsg","WAWebInvalidateEventsAction","WAWebInvisiblePlaceholderViewModeProcessor","WAWebLidMigrationUtils","WAWebMessageAssociationUIUtils","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgKey","WAWebMsgModel","WAWebMsgModelUtils","WAWebMsgType","WAWebNewsletterCollection","WAWebPaymentRequestMsgAction","WAWebPollsInvalidateChatPollMsgsAction","WAWebRevokeMsgAction","WAWebTemplateButtonCollection","WAWebTemplateButtonModel","WAWebViewMode.flow","WAWebWid","asyncToGeneratorRuntime","gkx","lodash","vulture"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L;function E(e,t,n,r){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i,l){var R=[],E=[],k=[],x=0;return yield(L||(L=n("Promise"))).all(a.map((function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){var a;n.id instanceof r("WAWebMsgKey")||(n.self!=null&&r("vulture")("X8gT5EynTHw_I5RNAG6VZDmVN0Q="),x++,n.id=new(r("WAWebMsgKey"))({from:n.from,to:n.to,id:n.id,participant:n.participant,selfDir:n.self})),o("WATypeUtils").isString(t)&&r("WAWebWid").isBroadcast(t)&&delete n.broadcast,n.type==="ptt"&&!n.id.fromMe&&n.ack<o("WAWebAck").ACK.CLOCK&&(n.ack=o("WAWebAck").ACK.CLOCK),n.hydratedButtons!=null&&I(n),n.dynamicReplyButtons!=null&&T(n),(a=o("WAWebInvisiblePlaceholderViewModeProcessor").InvisiblePlaceholderViewModeProcessor.compatibleMessageTypes)!=null&&a.includes(n.type)&&o("WAWebMessageAssociationUIUtils").shouldHideParentMessage({parentMsg:n})&&(n.viewMode=o("WAWebViewMode.flow").ViewModeType.INVISIBLE_PLACEHOLDER);var v=o("WAWebMsgCollection").MsgCollection.get(n.id);if(n.type===o("WAWebMsgType").MSG_TYPE.PROTOCOL&&n.subtype!=="ephemeral_setting"&&n.subtype!=="share_phone_number"&&n.subtype!=="event_edit_decrypted")switch(n.subtype){case"admin_revoke":{var S,L=o("WAWebLidMigrationUtils").getAlternateMsgKey(n.protocolMessageKey);if(v=(S=o("WAWebMsgCollection").MsgCollection.get(n.protocolMessageKey))!=null?S:L!=null?o("WAWebMsgCollection").MsgCollection.get(L):null,v)if(!o("WAWebMsgGetters").getIsGroupMsg(v))o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: "," has not been revoked"])),v.id.toString()),o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: admin revoke was sent to a non-group chat"])));else if(!r("WAWebWid").equals(v.id.remote,n.id.remote))o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: "," has not been revoked"])),v.id.toString()),o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: admin revoke came for the different group than the original message was in"])));else{o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: admin revoked ",""])),v.id.toString());var $=new(o("WAWebMsgModel")).Msg(n),P=r("WANullthrows")(o("WAWebFrontendMsgGetters").getChat(v).groupMetadata),N=r("WANullthrows")(o("WAWebMsgGetters").getSender($)),M=P.isLidAddressingMode===!0?o("WAWebLidMigrationUtils").toLid(N):o("WAWebLidMigrationUtils").toPn(N),w=M!=null?P.participants.get(M):null;if((!w||!w.isAdmin)&&M!=null){if(P.participants.add({id:M,isAdmin:!0},{merge:!0}),!w){var A={actionType:o("WAWebGroupType").GROUP_ACTIONS.ADD,participants:[{id:M,isAdmin:!0,isSuperAdmin:!1}],reason:null};o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[system message] msg updates - ADD - ADMIN"])));var F=yield o("WAWebGroupSystemMsg").genGroupNotificationMsg({meta:{author:void 0,chatId:o("WAWebFrontendMsgGetters").getChat(v).id,ts:$.t},action:A,dbIsStale:!0});F&&o("WAWebHandleSingleMsg").handleSingleMsg({chatId:F.from,newMsg:F,handleSingleMsgOrigin:"handleGroupAction"})}o("WAWebDBGroupParticipant").markGroupParticipantStale({group:o("WAWebFrontendMsgGetters").getChat(v).id}).catch(function(){o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: failed to mark group participant as stale"]))).sendLogs("failed-to-mark-group-participant-as-stale")})}o("WAWebRevokeMsgAction").revoke(v,{msgKey:$.id,subtype:$.subtype,sender:N,revokeTimestamp:$.t})}break}case"sender_revoke":{var O,B=o("WAWebLidMigrationUtils").getAlternateMsgKey(n.protocolMessageKey);if(v=(O=o("WAWebMsgCollection").MsgCollection.get(n.protocolMessageKey))!=null?O:B!=null?o("WAWebMsgCollection").MsgCollection.get(B):null,v){var W,q,U=new(o("WAWebMsgModel")).Msg(n),V=(W=v)==null?void 0:W.botTargetSenderJid,H=o("WAWebMsgGetters").getSender(U);V!=null&&(q=v.id.participant)!=null&&q.isBot()&&r("WAWebWid").equals.apply(r("WAWebWid"),o("WAWebLidMigrationUtils").toCommonAddressingMode(V,H))&&H!=null?(o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: bot invoker revoked bot's response: ",""])),v.id.toString()),o("WAWebRevokeMsgAction").revoke(v,{msgKey:U.id,subtype:U.subtype,sender:H,revokeTimestamp:U.t})):r("WAWebWid").equals.apply(r("WAWebWid"),o("WAWebLidMigrationUtils").toCommonAddressingMode(o("WAWebMsgGetters").getIsGroupStatus(v)?v.id.participant:o("WAWebMsgGetters").getSender(v),H))&&H!=null?(o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: sender revoked ",""])),v.id.toString()),o("WAWebMsgGetters").getIsStatus(v)&&v.msgChunk&&v.msgChunk.remove(v),o("WAWebRevokeMsgAction").revoke(v,{msgKey:U.id,subtype:U.subtype,sender:H,revokeTimestamp:U.t})):o("WALogger").WARN(g||(g=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: sender revoke: sender mismatch: "," <> ",""])),U.id.toString(),v.id.toString())}break}case"bot_request_welcome":case"bot_memu_onboarding":case"member_label":break;default:o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["unknown protocolMessage ",""])),n.id.toString()).devConsole(n);break}else if(v&&!o("WAWebFrontendMsgGetters").getAsRevoked(v)){n.ack<v.ack&&delete n.ack;for(var G in n)Object.prototype.hasOwnProperty.call(n,G)&&typeof n[G]=="undefined"&&delete n[G];v.type!==n.type&&(n.subtype=n.subtype||void 0),i.isHistory===!0&&(n.isNewMsg=!1);var z=["t","id","from","to"],j=v.t?r("lodash").omit(n,z):n,K=v.applyUpdate(j).then(function(){return v});if(k.push(K),r("WAWebWid").isBroadcast(v.id.remote)){var Q=o("WAWebMsgModelUtils").getBroadcastFanoutKeys(v);Q&&Q.forEach(function(e){var t=o("WAWebMsgCollection").MsgCollection.get(e);t&&k.push(t.applyUpdate(j).then(function(){return v}))})}i.isHistory===!0&&(v.recvFresh||l)&&!v.search?(o("WALogger").WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:handle:processMM:","",""])),v.recvFresh?"dup:":"overlap:",String(v.id)),E.push(v)):i.isHistory===!0&&v.search?(v.search=!1,o("WALogger").WARN(C||(C=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:handle:processMM load search as history ",""])),String(v.id)),R.push({id:v.id})):i.add==="search"&&R.push({id:v.id})}else{var X;n.subtype==="payment_action_request_declined"||n.subtype==="payment_transaction_request_cancelled"?k.push(o("WAWebPaymentRequestMsgAction").cancelOrDeclinePaymentRequest(n)):n.type===o("WAWebMsgType").MSG_TYPE.PAYMENT&&n.subtype==="send"&&k.push(o("WAWebPaymentRequestMsgAction").fulfillPaymentRequest(n));var Y=(X=o("WAWebChatCollection").ChatCollection.get(n.id.remote))!=null?X:r("WAWebNewsletterCollection").get(n.id.remote);i.add==="search"&&(n.search=!0),o("WAWebMsgGetters").getIsUnreadType(n)&&n.id.fromMe&&n.ack===o("WAWebAck").ACK.CLOCK&&(n.isSendFailure=!0),n.errorCode===o("WAWebErrorType").SendFailureErrorCode.EditWindowExpired&&(n.isSendFailure=!0),i.update!==!0&&R.push(n),i.isHistory!==!0&&i.add!=="search"&&Y&&k.push(D(n,Y)),n.ephemeralOutOfSync&&o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["ephemeralOutOfSync msgId="," chatId=",""])),n.id.toString(),Y==null?void 0:Y.id.toString())}});return function(e){return a.apply(this,arguments)}})())),x>0&&(o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: el.id is not a MsgKey: "," of "," messages"])),x,a.length),r("gkx")("26258")||o("WALogger").ERROR(S||(S=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: el.id is not a MsgKey"]))).sendLogs("forgot-to-create-msgkey")),{filteredRecs:R,reorderRecs:E,updates:k}}),k.apply(this,arguments)}function I(e){var t=function(t,n){var e,o,a=t.index!=null?t.index:n,i=""+a;return t.quickReplyButton?new(r("WAWebTemplateButtonModel"))({id:i,displayText:t.quickReplyButton.displayText,selectionId:t.quickReplyButton.id,subtype:"quick_reply"}):t.callButton?new(r("WAWebTemplateButtonModel"))({id:i,displayText:t.callButton.displayText,phoneNumber:t.callButton.phoneNumber,subtype:"call"}):new(r("WAWebTemplateButtonModel"))({id:i,displayText:(e=t.urlButton)==null?void 0:e.displayText,url:(o=t.urlButton)==null?void 0:o.url,subtype:"url"})};e.buttons=new(o("WAWebTemplateButtonCollection")).TemplateButtonCollection,e.buttons.add(e.hydratedButtons.map(t))}function T(e){var t=function(t){var e=t.buttonId,n=t.buttonText;return new(r("WAWebButtonModel"))({id:e,displayText:n==null?void 0:n.displayText})};e.replyButtons=new(o("WAWebButtonCollection")).ButtonCollection,e.replyButtons.add(e.dynamicReplyButtons.map(t))}function D(e,t){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(!e.isNewMsg||!e.recvFresh)return o("WALogger").WARN(R||(R=babelHelpers.taggedTemplateLiteralLoose(["processLiveMessage should not be called with history message id: ",", type: ",", subType: ",", isNewMsg: ",", recvFresh: ",""])),e.id.toString(),e.type,e.subtype,e.isNewMsg,e.recvFresh).devConsole(e).sendLogs("bad-process-live-message-call",{sampling:.001}),(L||(L=n("Promise"))).resolve();e.type===o("WAWebMsgType").MSG_TYPE.GP2&&e.subtype==="delete"&&(t.isReadOnly=!0,o("WAWebPollsInvalidateChatPollMsgsAction").invalidateChatPollMsgs(t),o("WAWebInvalidateEventsAction").invalidateEventMsgsForChat(t)),yield o("WAWebEphemeralSyncResponse").syncEphemeralSetting(e,t)}),x.apply(this,arguments)}l.default=E}),98);
__d("WAWebAppScreen",["$InternalEnum","WAWebAppMutex","WAWebBuildConstants","WAWebStreamModel","err"],(function(t,n,r,o,a,i,l){var e=n("$InternalEnum").Mirrored(["CLIENT_EXPIRED_DIALOG","ANOTHER_SESSION","UNSUPPORTED_TAKEOVER","CALL_TAKEOVER_PREVENTION","QR","SYNCING","OFFLINE","PROXYBLOCK","CONFLICT","TOS_BLOCK","SMB_TOS_BLOCK","DEPRECATED_VERSION","MAIN","STARTUP","TEMP_BAN","LOGOUT","SCREEN_LOCK","SERVICE_UNAVAILABLE"]);function s(t){var n,a=t.anotherSession,i=t.isUnsupportedTakeover,l=t.updating,s=t.hardExpired,u=t.mainLoaded,c=t.mode,d=t.screenLocked;if((n=t.temporaryBan)!=null&&n.banned)return e.TEMP_BAN;if(t.serviceUnavailable===!0)return e.SERVICE_UNAVAILABLE;if(t.startLogout)return e.LOGOUT;if(l||s)return e.CLIENT_EXPIRED_DIALOG;if(i)return e.UNSUPPORTED_TAKEOVER;if(r("WAWebAppMutex").hasShownCallTakeoverModal())return e.CALL_TAKEOVER_PREVENTION;if(a)return e.ANOTHER_SESSION;if(d)return u?e.SCREEN_LOCK:e.STARTUP;switch(c){case o("WAWebStreamModel").StreamMode.QR:return e.QR;case o("WAWebStreamModel").StreamMode.SYNCING:return e.SYNCING;case o("WAWebStreamModel").StreamMode.OFFLINE:return u&&o("WAWebBuildConstants").WINDOWS_OFFLINE?e.MAIN:e.OFFLINE;case o("WAWebStreamModel").StreamMode.PROXYBLOCK:return e.PROXYBLOCK;case o("WAWebStreamModel").StreamMode.CONFLICT:return e.CONFLICT;case o("WAWebStreamModel").StreamMode.TOS_BLOCK:return e.TOS_BLOCK;case o("WAWebStreamModel").StreamMode.SMB_TOS_BLOCK:return e.SMB_TOS_BLOCK;case o("WAWebStreamModel").StreamMode.DEPRECATED_VERSION:return e.DEPRECATED_VERSION;case o("WAWebStreamModel").StreamMode.MAIN:return o("WAWebBuildConstants").WINDOWS_OFFLINE?e.MAIN:u?t.stayInSync?e.SYNCING:e.MAIN:e.STARTUP}throw r("err")("[app] render Error invalid StreamMode: "+c)}l.AppScreen=e,l.getScreen=s}),98);
__d("WAWebWamEnumErrorType",[],(function(t,n,r,o,a,i){var e=Object.freeze({ERROR_FETCHING_AGENT_NAME:0,ERROR_FETCHING_CHAT:1,ERROR_OTHER:2});i.ERROR_TYPE=e}),66);
__d("WAWebWamEnumMdChatAssignmentAssignmentType",[],(function(t,n,r,o,a,i){var e=Object.freeze({ASSIGNED:0,UNASSIGNED:1});i.MD_CHAT_ASSIGNMENT_ASSIGNMENT_TYPE=e}),66);
__d("WAWebWamEnumMdChatAssignmentChatType",[],(function(t,n,r,o,a,i){var e=Object.freeze({GROUP:0,BROADCAST_LIST:1,INDIVIDUAL:2,COMMUNITY:3,CHANNEL:4,INTEROP:5});i.MD_CHAT_ASSIGNMENT_CHAT_TYPE=e}),66);
__d("WAWebWamEnumMdChatAssignmentSecondaryActionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({ACTION_SYSTEM_MESSAGE_ADDED_TO_CHAT_HISTORY:0,ACTION_SYSTEM_MESSAGE_CREATION_ERROR:1,ACTION_SYSTEM_MESSAGE_RENDERED:2,ACTION_CHAT_STATUS_TICKER_SHOWN:3,ACTION_TOOLTIP_SHOWN:4});i.MD_CHAT_ASSIGNMENT_SECONDARY_ACTION_TYPE=e}),66);
__d("WAWebWamEnumMdChatAssignmentSourceType",[],(function(t,n,r,o,a,i){var e=Object.freeze({NONE:0,BOOTSTRAP:1});i.MD_CHAT_ASSIGNMENT_SOURCE_TYPE=e}),66);
__d("WAWebMdChatAssignmentSecondaryActionWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumErrorType","WAWebWamEnumMdChatAssignmentAssignmentType","WAWebWamEnumMdChatAssignmentChatType","WAWebWamEnumMdChatAssignmentSecondaryActionType","WAWebWamEnumMdChatAssignmentSourceType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MdChatAssignmentSecondaryAction:[3716,{mdChatAssignmentSecondaryActionAgentId:[1,e.TYPES.STRING],mdChatAssignmentSecondaryActionAssignmentType:[8,o("WAWebWamEnumMdChatAssignmentAssignmentType").MD_CHAT_ASSIGNMENT_ASSIGNMENT_TYPE],mdChatAssignmentSecondaryActionBrowserId:[2,e.TYPES.STRING],mdChatAssignmentSecondaryActionChatType:[3,o("WAWebWamEnumMdChatAssignmentChatType").MD_CHAT_ASSIGNMENT_CHAT_TYPE],mdChatAssignmentSecondaryActionError:[4,o("WAWebWamEnumErrorType").ERROR_TYPE],mdChatAssignmentSecondaryActionMdId:[5,e.TYPES.INTEGER],mdChatAssignmentSecondaryActionSource:[6,o("WAWebWamEnumMdChatAssignmentSourceType").MD_CHAT_ASSIGNMENT_SOURCE_TYPE],mdChatAssignmentSecondaryActionType:[7,o("WAWebWamEnumMdChatAssignmentSecondaryActionType").MD_CHAT_ASSIGNMENT_SECONDARY_ACTION_TYPE]},[1,1,1],"regular"]},{MdChatAssignmentSecondaryAction:[]});l.MdChatAssignmentSecondaryActionWamEvent=s}),98);
__d("WAWebWamEnumChatAssignmentActionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({ACTION_ASSIGNED:0,ACTION_UNASSIGNED:1,ACTION_REASSIGNED:2});i.CHAT_ASSIGNMENT_ACTION_TYPE=e}),66);
__d("WAWebWamEnumChatAssignmentChatType",[],(function(t,n,r,o,a,i){var e=Object.freeze({INDIVIDUAL:0,GROUP:1,COMMUNITY:2,CHANNEL:3});i.CHAT_ASSIGNMENT_CHAT_TYPE=e}),66);
__d("WAWebWamEnumChatAssignmentEntryPointType",[],(function(t,n,r,o,a,i){var e=Object.freeze({CONVERSATION_OVERFLOW_MENU:0,CONTACT_INFO_SCREEN:1,MULTI_SELECT:2,SYSTEM_MESSAGE:3,CHAT_LIST_SWIPE:4,AI_REPLIES:5});i.CHAT_ASSIGNMENT_ENTRY_POINT_TYPE=e}),66);
__d("WAWebMdChatAssignmentWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumChatAssignmentActionType","WAWebWamEnumChatAssignmentChatType","WAWebWamEnumChatAssignmentEntryPointType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MdChatAssignment:[3752,{assignerAgentId:[1,e.TYPES.STRING],assignerBrowserId:[2,e.TYPES.STRING],assignerMdId:[3,e.TYPES.INTEGER],chatAssignmentAction:[4,o("WAWebWamEnumChatAssignmentActionType").CHAT_ASSIGNMENT_ACTION_TYPE],chatAssignmentAgentId:[5,e.TYPES.STRING],chatAssignmentBrowserId:[6,e.TYPES.STRING],chatAssignmentChatType:[7,o("WAWebWamEnumChatAssignmentChatType").CHAT_ASSIGNMENT_CHAT_TYPE],chatAssignmentEntryPoint:[8,o("WAWebWamEnumChatAssignmentEntryPointType").CHAT_ASSIGNMENT_ENTRY_POINT_TYPE],chatAssignmentMdId:[9,e.TYPES.INTEGER],chatsCnt:[10,e.TYPES.INTEGER]},[1,1,1],"regular"]},{MdChatAssignment:[]});l.MdChatAssignmentWamEvent=s}),98);
__d("WAWebChatAssignmentLogEvents",["WAWebABProps","WAWebAgentCollection","WAWebBizGatingUtils","WAWebChatAssignmentLogEvents.flow","WAWebChatCollection","WAWebMdChatAssignmentSecondaryActionWamEvent","WAWebMdChatAssignmentWamEvent","WAWebMiscBrowserUtils","WAWebUserPrefsMeUser","WAWebWamEnumChatAssignmentActionType","WAWebWamEnumChatAssignmentEntryPointType","WAWebWamEnumMdChatAssignmentAssignmentType","WAWebWamEnumMdChatAssignmentSecondaryActionType","WAWebWamEnumMdChatAssignmentSourceType"],(function(t,n,r,o,a,i,l){function e(){var e=o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().getDeviceId();return o("WAWebAgentCollection").AgentCollection.getModelsArray().find(function(t){return t.deviceId===e})}function s(t,n){var a,i,l=e(),s=o("WAWebABProps").getABPropConfigValue("smb_md_agent_chat_assignment_system_messages_logging_v2_enabled");return s||delete n.mdChatAssignmentSecondaryActionAssignmentType,new(o("WAWebMdChatAssignmentSecondaryActionWamEvent")).MdChatAssignmentSecondaryActionWamEvent(babelHelpers.extends({mdChatAssignmentSecondaryActionAgentId:(a=l==null?void 0:l.id)!=null?a:"",mdChatAssignmentSecondaryActionBrowserId:r("WAWebMiscBrowserUtils").persistentExpiringId(),mdChatAssignmentSecondaryActionChatType:t==null?void 0:t.getMdChatAssignmentChatType(),mdChatAssignmentSecondaryActionMdId:(i=l==null?void 0:l.deviceId)!=null?i:-1},n))}function u(e){o("WAWebBizGatingUtils").chatAssignmentEnabled()&&s(e,{mdChatAssignmentSecondaryActionSource:o("WAWebWamEnumMdChatAssignmentSourceType").MD_CHAT_ASSIGNMENT_SOURCE_TYPE.NONE,mdChatAssignmentSecondaryActionType:o("WAWebWamEnumMdChatAssignmentSecondaryActionType").MD_CHAT_ASSIGNMENT_SECONDARY_ACTION_TYPE.ACTION_TOOLTIP_SHOWN}).commit()}function c(e){o("WAWebBizGatingUtils").chatAssignmentEnabled()&&s(e,{mdChatAssignmentSecondaryActionAssignmentType:e.assignedAgent==null?o("WAWebWamEnumMdChatAssignmentAssignmentType").MD_CHAT_ASSIGNMENT_ASSIGNMENT_TYPE.ASSIGNED:o("WAWebWamEnumMdChatAssignmentAssignmentType").MD_CHAT_ASSIGNMENT_ASSIGNMENT_TYPE.UNASSIGNED,mdChatAssignmentSecondaryActionSource:o("WAWebWamEnumMdChatAssignmentSourceType").MD_CHAT_ASSIGNMENT_SOURCE_TYPE.BOOTSTRAP,mdChatAssignmentSecondaryActionType:o("WAWebWamEnumMdChatAssignmentSecondaryActionType").MD_CHAT_ASSIGNMENT_SECONDARY_ACTION_TYPE.ACTION_SYSTEM_MESSAGE_ADDED_TO_CHAT_HISTORY}).commit()}function d(e){o("WAWebBizGatingUtils").chatAssignmentEnabled()&&s(e,{mdChatAssignmentSecondaryActionAssignmentType:e.assignedAgent==null?o("WAWebWamEnumMdChatAssignmentAssignmentType").MD_CHAT_ASSIGNMENT_ASSIGNMENT_TYPE.ASSIGNED:o("WAWebWamEnumMdChatAssignmentAssignmentType").MD_CHAT_ASSIGNMENT_ASSIGNMENT_TYPE.UNASSIGNED,mdChatAssignmentSecondaryActionSource:o("WAWebWamEnumMdChatAssignmentSourceType").MD_CHAT_ASSIGNMENT_SOURCE_TYPE.NONE,mdChatAssignmentSecondaryActionType:o("WAWebWamEnumMdChatAssignmentSecondaryActionType").MD_CHAT_ASSIGNMENT_SECONDARY_ACTION_TYPE.ACTION_SYSTEM_MESSAGE_CREATION_ERROR}).commit()}function m(e){if(o("WAWebBizGatingUtils").chatAssignmentEnabled()){var t=o("WAWebChatCollection").ChatCollection.get(e);t!=null&&s(t,{mdChatAssignmentSecondaryActionSource:o("WAWebWamEnumMdChatAssignmentSourceType").MD_CHAT_ASSIGNMENT_SOURCE_TYPE.NONE,mdChatAssignmentSecondaryActionType:o("WAWebWamEnumMdChatAssignmentSecondaryActionType").MD_CHAT_ASSIGNMENT_SECONDARY_ACTION_TYPE.ACTION_CHAT_STATUS_TICKER_SHOWN}).commit()}}function p(t,n,a){var i,l,s,u=e(),c=o("WAWebAgentCollection").AgentCollection.get(n),d=o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().getDeviceId(),m=n===(u==null?void 0:u.id);return new(o("WAWebMdChatAssignmentWamEvent")).MdChatAssignmentWamEvent(babelHelpers.extends({assignerAgentId:(i=u==null?void 0:u.id)!=null?i:"",assignerBrowserId:r("WAWebMiscBrowserUtils").persistentExpiringId(),assignerMdId:d,chatAssignmentAgentId:(l=c==null?void 0:c.id)!=null?l:"",chatAssignmentBrowserId:m?r("WAWebMiscBrowserUtils").persistentExpiringId():"",chatAssignmentChatType:t.getChatAssignmentChatType(),chatAssignmentMdId:(s=c==null?void 0:c.deviceId)!=null?s:-1},a))}function _(e){switch(e){case o("WAWebChatAssignmentLogEvents.flow").ChatAssignmentEntryPointType.MULTI_SELECT:return o("WAWebWamEnumChatAssignmentEntryPointType").CHAT_ASSIGNMENT_ENTRY_POINT_TYPE.MULTI_SELECT;case o("WAWebChatAssignmentLogEvents.flow").ChatAssignmentEntryPointType.SYSTEM_MESSAGE:return o("WAWebWamEnumChatAssignmentEntryPointType").CHAT_ASSIGNMENT_ENTRY_POINT_TYPE.SYSTEM_MESSAGE;case o("WAWebChatAssignmentLogEvents.flow").ChatAssignmentEntryPointType.CONVERSATION_MENU:return o("WAWebWamEnumChatAssignmentEntryPointType").CHAT_ASSIGNMENT_ENTRY_POINT_TYPE.CONVERSATION_OVERFLOW_MENU;case o("WAWebChatAssignmentLogEvents.flow").ChatAssignmentEntryPointType.CONTACT_INFO_SCREEN:return o("WAWebWamEnumChatAssignmentEntryPointType").CHAT_ASSIGNMENT_ENTRY_POINT_TYPE.CONTACT_INFO_SCREEN}}function f(e,t,n,r,a){if(o("WAWebBizGatingUtils").chatAssignmentEnabled()){var i;t===""?i=o("WAWebWamEnumChatAssignmentActionType").CHAT_ASSIGNMENT_ACTION_TYPE.ACTION_UNASSIGNED:n?i=o("WAWebWamEnumChatAssignmentActionType").CHAT_ASSIGNMENT_ACTION_TYPE.ACTION_REASSIGNED:i=o("WAWebWamEnumChatAssignmentActionType").CHAT_ASSIGNMENT_ACTION_TYPE.ACTION_ASSIGNED,p(e,t,{chatAssignmentAction:i,chatAssignmentEntryPoint:_(r),chatsCnt:a}).commit()}}l.logNuxShown=u,l.logSystemMessageGeneratedFromCompanion=c,l.logSystemMessageFailedToGenerate=d,l.logChatStatusTickerShown=m,l.logChatAssignment=f}),98);
__d("WAWebWamEnumChatsFolderType",[],(function(t,n,r,o,a,i){var e=Object.freeze({INBOX:1,ARCHIVED:2});i.CHATS_FOLDER_TYPE=e}),66);
__d("WAWebWamEnumContactType",[],(function(t,n,r,o,a,i){var e=Object.freeze({CONSUMER:1,SMB:2,ENTERPRISE:3});i.CONTACT_TYPE=e}),66);
__d("WAWebBusinessTemplateRichOrderStatusWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumChatsFolderType","WAWebWamEnumContactType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({BusinessTemplateRichOrderStatus:[7076,{actionTypeRichOrderStatus:[1,e.TYPES.STRING],businessJid:[2,e.TYPES.STRING],chatsFolderType:[3,o("WAWebWamEnumChatsFolderType").CHATS_FOLDER_TYPE],contactType:[4,o("WAWebWamEnumContactType").CONTACT_TYPE],isBizIntent:[5,e.TYPES.BOOLEAN],isInsubContact:[6,e.TYPES.BOOLEAN],isMuted:[7,e.TYPES.BOOLEAN],readReceiptsEnabled:[8,e.TYPES.BOOLEAN],templateId:[9,e.TYPES.STRING]},[1,1,1],"private",113760892]},{BusinessTemplateRichOrderStatus:[]});l.BusinessTemplateRichOrderStatusWamEvent=s}),98);
__d("WAWebPsRichOrderStatusMessageInconsistentPayloadReceivedWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({PsRichOrderStatusMessageInconsistentPayloadReceived:[6938,{businessJid:[1,e.TYPES.STRING],hasCurrencyChanged:[2,e.TYPES.BOOLEAN],hasHeaderImageChanged:[3,e.TYPES.BOOLEAN],hasItemImageChanged:[4,e.TYPES.BOOLEAN],hasItemNameChanged:[5,e.TYPES.BOOLEAN],hasItemNumberChanged:[6,e.TYPES.BOOLEAN],hasItemPriceChanged:[7,e.TYPES.BOOLEAN],hasItemQuantityChanged:[8,e.TYPES.BOOLEAN],hasItemVariantChanged:[9,e.TYPES.BOOLEAN]},[1,1,1],"private",113760892]},{PsRichOrderStatusMessageInconsistentPayloadReceived:[]});l.PsRichOrderStatusMessageInconsistentPayloadReceivedWamEvent=s}),98);
__d("WAWebWamEnumQbmFlag",[],(function(t,n,r,o,a,i){var e=Object.freeze({OTHER:0,TRANSACTIONAL:1,PROMOTIONAL:2,OTP:3,MARKETING_MESSAGE_SMB:4});i.QBM_FLAG=e}),66);
__d("WAWebQbmRichOrderStatusInteractionWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumChatsFolderType","WAWebWamEnumContactType","WAWebWamEnumEntryPoint","WAWebWamEnumQbmFlag"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({QbmRichOrderStatusInteraction:[6940,{actionTypeRichOrderStatus:[1,e.TYPES.STRING],chatsFolderType:[2,o("WAWebWamEnumChatsFolderType").CHATS_FOLDER_TYPE],contactType:[3,o("WAWebWamEnumContactType").CONTACT_TYPE],decisionId:[4,e.TYPES.STRING],deltaTime:[5,e.TYPES.INTEGER],deltaTimeReceived:[6,e.TYPES.INTEGER],entryPoint:[7,o("WAWebWamEnumEntryPoint").ENTRY_POINT],hsmTagStr:[8,e.TYPES.STRING],isBizIntent:[9,e.TYPES.BOOLEAN],isBroadcastMessage:[10,e.TYPES.BOOLEAN],isInsubContact:[11,e.TYPES.BOOLEAN],isMuted:[12,e.TYPES.BOOLEAN],messageIdHmac:[13,e.TYPES.STRING],qbmFlag:[14,o("WAWebWamEnumQbmFlag").QBM_FLAG],readReceiptsEnabled:[15,e.TYPES.BOOLEAN],threadIdHmac:[16,e.TYPES.STRING],unifiedSessionId:[17,e.TYPES.STRING]},[1,1,1],"regular"]},{QbmRichOrderStatusInteraction:[]});l.QbmRichOrderStatusInteractionWamEvent=s}),98);
__d("WAWebRichOrderStatusLogger",["$InternalEnum","Promise","WAWebABProps","WAWebBusinessTemplateRichOrderStatusWamEvent","WAWebChatGetters","WAWebChatThreadLogging","WAWebContactCollection","WAWebContactGetters","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebMsgGetters","WAWebOrderStatus","WAWebOrderStatusButton","WAWebPsRichOrderStatusMessageInconsistentPayloadReceivedWamEvent","WAWebQbmRichOrderStatusInteractionWamEvent","WAWebUnifiedSession","WAWebUserPrefsGeneral","WAWebUtilsPnhSmbLoggingHelper","WAWebWamEnumChatsFolderType","WAWebWamEnumContactType","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=n("$InternalEnum")({ORDER_TRACKING_URL_CLICK:"order_tracking_url_click",VIEW_ORDER_PRIMARY_CLICK:"view_order_primary_click",VIEW_ORDER_SECONDARY_CLICK:"view_order_secondary_click",VIEW_ORDER_ITEM_PLACEHOLDER_CLICK:"view_order_item_placeholder_click",ORDER_ITEM_ROW_CLICK:"order_item_row_click",ORDER_NUMBER_COPY:"order_number_copy",TRACKING_NUMBER_COPY:"tracking_number_copy",MESSAGE_HEADER_CLICK:"message_header_click",MESSAGE_CTA_CLICK:"message_cta_click"});function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){var a;if(o("WAWebABProps").getABPropConfigValue("utility_order_status_logging_enabled")){var i=o("WAWebFrontendMsgGetters").getChat(t),l=o("WAWebContactCollection").ContactCollection.get(i.id),s=l?o("WAWebContactGetters").getIsBusiness(l):!1,u=s?o("WAWebWamEnumContactType").CONTACT_TYPE.SMB:o("WAWebWamEnumContactType").CONTACT_TYPE.ENTERPRISE,c=i.archive?o("WAWebWamEnumChatsFolderType").CHATS_FOLDER_TYPE.ARCHIVED:o("WAWebWamEnumChatsFolderType").CHATS_FOLDER_TYPE.INBOX,d=o("WAWebUnifiedSession").UnifiedSessionManager.getSessionId(),m=o("WAWebChatGetters").getMuteExpiration(i),p=m>Date.now(),_=l?o("WAWebFrontendContactGetters").getIsMyContact(l):!1,f=Date.now(),g=o("WAWebMsgGetters").getT(t),h=Math.round((f-g*1e3)/1e3),y=o("WAWebChatGetters").getId(i).toString(),C=o("WAWebMsgGetters").getId(t),b=yield(e||(e=n("Promise"))).all([o("WAWebChatThreadLogging").getMessageIDHMAC(C.toString()),o("WAWebChatThreadLogging").getChatThreadIDHMAC(y)]),v=b[0],S=b[1],R=o("WAWebMsgGetters").getClientReceivedTsMillis(t),L=R!=null?Math.round((f-R)/1e3):void 0,E=o("WAWebUserPrefsGeneral").getUserPrivacySettings(),k=E.readReceipts!=="none";new(o("WAWebQbmRichOrderStatusInteractionWamEvent")).QbmRichOrderStatusInteractionWamEvent({actionTypeRichOrderStatus:r,chatsFolderType:c,contactType:u,deltaTime:h,deltaTimeReceived:L,isInsubContact:_,isMuted:p,messageIdHmac:v!=null?v:void 0,readReceiptsEnabled:k,threadIdHmac:S!=null?S:void 0,unifiedSessionId:d!=null?d:void 0}).commit(),new(o("WAWebBusinessTemplateRichOrderStatusWamEvent")).BusinessTemplateRichOrderStatusWamEvent({actionTypeRichOrderStatus:r,businessJid:o("WAWebUtilsPnhSmbLoggingHelper").jidToPnString(o("WAWebChatGetters").getId(i)),chatsFolderType:c,contactType:u,isBizIntent:s,isInsubContact:_,isMuted:p,readReceiptsEnabled:k,templateId:(a=t.templateId)!=null?a:void 0}).commit()}}),c.apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(o("WAWebABProps").getABPropConfigValue("utility_order_status_logging_enabled")){var t=o("WAWebOrderStatusButton").getOrderStatusButton(e);if(t){var n=o("WAWebFrontendMsgGetters").getChat(e),r=o("WAWebOrderStatus").getMergedOrderStatus(n,t),a=r.firstMessage;if(a){var i=o("WAWebOrderStatusButton").getOrderStatusButton(a);if(i){for(var l=e.mediaData.filehash!==a.mediaData.filehash,s=t.order.items||[],u=i.order.items||[],c=t.order.currency!==i.order.currency,d=s.length!==u.length,m=!1,p=!1,_=!1,f=!1,g=!1,h=0;h<Math.min(s.length,u.length);h++){var y,C,b,v,S=s[h],R=u[h];m||(m=S.name!==R.name),p||(p=S.quantity!==R.quantity),_||(_=S.variant!==R.variant),f||(f=S.image.file_sha256!==R.image.file_sha256),g||(g=((y=S.amount)==null?void 0:y.value)!==((C=R.amount)==null?void 0:C.value)||((b=S.amount)==null?void 0:b.offset)!==((v=R.amount)==null?void 0:v.offset))}new(o("WAWebPsRichOrderStatusMessageInconsistentPayloadReceivedWamEvent")).PsRichOrderStatusMessageInconsistentPayloadReceivedWamEvent({businessJid:o("WAWebUtilsPnhSmbLoggingHelper").jidToPnString(o("WAWebChatGetters").getId(n)),hasCurrencyChanged:c,hasHeaderImageChanged:l,hasItemImageChanged:f,hasItemNameChanged:m,hasItemNumberChanged:d,hasItemPriceChanged:g,hasItemQuantityChanged:p,hasItemVariantChanged:_}).commit()}}}}}),m.apply(this,arguments)}l.RichOrderStatusActionType=s,l.logRichOrderStatusInteraction=u,l.logRichOrderStatusInconsistencies=d}),98);
__d("WAWebWamEnumCtaFallbackReason",[],(function(t,n,r,o,a,i){var e=Object.freeze({NO_OTP_REQUEST_RECEIVED:0,OTP_REQUEST_EXPIRED:1,HASH_MISMATCH:2,NO_ACTIVITY_LISTENING_ON_THIRD_PARTY_APP:3,OTHER:4,NO_PACKAGE_NAME_ON_MESSAGE:5,NO_CTA_DISPLAY_NAME:6,INCOMPATIBLE_OS_VERSION:7,NO_RETRIEVER_BUTTON:8,FEATURE_DISABLED:9,AMBIGUOUS_DELIVERY_DESTINATION:10});i.CTA_FALLBACK_REASON=e}),66);
__d("WAWebWamEnumCtaType",[],(function(t,n,r,o,a,i){var e=Object.freeze({COPY_CODE:0,AUTOFILL:1});i.CTA_TYPE=e}),66);
__d("WAWebWamEnumOtpEventSource",[],(function(t,n,r,o,a,i){var e=Object.freeze({NOTIFICATION_CTA:0,NOTIFICATION_BODY:1,CHAT_CTA:2,OTHER:3,OTP_MESSAGE:4,OTP_MESSAGE_INFO:5,OTP_CONFIGURATION:6,OTP_REQUEST_SENDER:7,OTP_ZERO_TAP_SENDER:8,OTP_CONF_OPTION:9});i.OTP_EVENT_SOURCE=e}),66);
__d("WAWebWamEnumOtpEventType",[],(function(t,n,r,o,a,i){var e=Object.freeze({CLICK:0,IMPRESSION:1,OTP_CODE_REQUESTED:2,OTP_CODE_SENT:3,MESSAGE_RECEIVED:4,MESSAGE_READ:5,MESSAGE_DELETED:6,ZERO_TAP_ENABLED:7,ZERO_TAP_DISABLED:8,ZERO_TAP_NOTICE_VIEWED:9,CLEAR_CHAT:10,ZERO_TAP_SEND_CODE_STARTED:11,ZERO_TAP_SEND_CODE_COMPLETED:12,ZERO_TAP_SEND_CODE_FAILED:13,OTP_CONF_OPT_ZERO_TAP_FLAG_ENABLED:14,OTP_CONF_OPT_ZERO_TAP_FLAG_DISABLED:15,HANDSHAKE_CONFIRMATION_SENT:16,FEEDBACK_BUTTON_CLICK:17});i.OTP_EVENT_TYPE=e}),66);
__d("WAWebWamEnumOtpProductType",[],(function(t,n,r,o,a,i){var e=Object.freeze({ONE_TAP:0,ZERO_TAP:1,COPY_CODE:2});i.OTP_PRODUCT_TYPE=e}),66);
__d("WAWebOtpRetrieverWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumChatsFolderType","WAWebWamEnumCtaFallbackReason","WAWebWamEnumCtaType","WAWebWamEnumOtpEventSource","WAWebWamEnumOtpEventType","WAWebWamEnumOtpProductType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({OtpRetriever:[3468,{businessLid:[26,e.TYPES.INTEGER],businessLidOrJid:[28,e.TYPES.STRING],businessPhoneNumber:[1,e.TYPES.INTEGER],chatId:[19,e.TYPES.STRING],chatsFolderType:[12,o("WAWebWamEnumChatsFolderType").CHATS_FOLDER_TYPE],ctaFallbackReason:[2,o("WAWebWamEnumCtaFallbackReason").CTA_FALLBACK_REASON],ctaType:[3,o("WAWebWamEnumCtaType").CTA_TYPE],isKeepChatsArchivedEnabled:[13,e.TYPES.BOOLEAN],isMessageNotificationEnabled:[14,e.TYPES.BOOLEAN],isNotificationEnabled:[15,e.TYPES.BOOLEAN],messageReceivedElapsedTimeSeconds:[11,e.TYPES.INTEGER],otpCorrelationId:[20,e.TYPES.STRING],otpEventSource:[5,o("WAWebWamEnumOtpEventSource").OTP_EVENT_SOURCE],otpEventType:[6,o("WAWebWamEnumOtpEventType").OTP_EVENT_TYPE],otpFailureReason:[16,e.TYPES.STRING],otpHandshakeElapsedTimeMs:[21,e.TYPES.INTEGER],otpHandshakeId:[23,e.TYPES.STRING],otpIosAutofillDisabled:[29,e.TYPES.BOOLEAN],otpMaskLinkedDevices:[24,e.TYPES.BOOLEAN],otpProductType:[7,o("WAWebWamEnumOtpProductType").OTP_PRODUCT_TYPE],otpSdkVersion:[22,e.TYPES.STRING],otpSenderAttributes:[27,e.TYPES.STRING],otpSessionId:[8,e.TYPES.STRING],receiverCountryCode:[18,e.TYPES.STRING],templateId:[17,e.TYPES.STRING],thirdPartyPackageNameFromIntent:[9,e.TYPES.STRING],thirdPartyPackageSignatureHash:[10,e.TYPES.STRING],waDeviceId:[25,e.TYPES.INTEGER]},[1,1,1],"private",113760892]},{OtpRetriever:[]});l.OtpRetrieverWamEvent=s}),98);
__d("WAWebOTPLoggingHelper",["WACryptoSha256","WAWebABProps","WAWebDBMessageSerialization","WAWebFrontendMsgGetters","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebLinkDevicePhoneNumberEntryInputFormatUtils","WAWebMsgGetters","WAWebMuteGetters","WAWebOtpRetrieverWamEvent","WAWebSettingsGetters","WAWebSettingsModel","WAWebUserPrefsMeUser","WAWebUserPrefsNotifications","WAWebWamEnumChatsFolderType","WAWebWamEnumCtaType","WAWebWamEnumOtpEventSource","WAWebWamEnumOtpEventType","WAWebWamEnumOtpProductType","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(o("WAWebMsgGetters").getIsAuthenticationMessage(e)){var t=new(o("WAWebOtpRetrieverWamEvent")).OtpRetrieverWamEvent({ctaType:o("WAWebWamEnumCtaType").CTA_TYPE.COPY_CODE,otpEventSource:o("WAWebWamEnumOtpEventSource").OTP_EVENT_SOURCE.CHAT_CTA,otpEventType:o("WAWebWamEnumOtpEventType").OTP_EVENT_TYPE.CLICK});yield f(t,e),t.commit()}}),s.apply(this,arguments)}function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t;if(o("WAWebMsgGetters").getIsAuthenticationMessage(e)){var n=new(o("WAWebOtpRetrieverWamEvent")).OtpRetrieverWamEvent({ctaType:o("WAWebWamEnumCtaType").CTA_TYPE.COPY_CODE,otpEventSource:o("WAWebWamEnumOtpEventSource").OTP_EVENT_SOURCE.OTP_MESSAGE,otpEventType:o("WAWebWamEnumOtpEventType").OTP_EVENT_TYPE.MESSAGE_RECEIVED}),r=(t=o("WAWebUserPrefsMeUser").getMaybeMeDevicePn())==null?void 0:t.getDeviceId();r!=null&&(n.waDeviceId=r),yield f(n,e),n.commit()}}),c.apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebDBMessageSerialization").messageFromDbRow(e);if(o("WAWebMsgGetters").getIsAuthenticationMessage(t)){var n=new(o("WAWebOtpRetrieverWamEvent")).OtpRetrieverWamEvent({ctaType:o("WAWebWamEnumCtaType").CTA_TYPE.COPY_CODE,otpEventSource:o("WAWebWamEnumOtpEventSource").OTP_EVENT_SOURCE.OTP_MESSAGE,otpEventType:o("WAWebWamEnumOtpEventType").OTP_EVENT_TYPE.MESSAGE_READ});yield f(n,t),n.commit()}}),m.apply(this,arguments)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(o("WAWebMsgGetters").getIsAuthenticationMessage(e)){var t=new(o("WAWebOtpRetrieverWamEvent")).OtpRetrieverWamEvent({ctaType:o("WAWebWamEnumCtaType").CTA_TYPE.COPY_CODE,otpEventSource:o("WAWebWamEnumOtpEventSource").OTP_EVENT_SOURCE.OTP_MESSAGE,otpEventType:o("WAWebWamEnumOtpEventType").OTP_EVENT_TYPE.MESSAGE_DELETED});yield f(t,e),t.commit()}}),_.apply(this,arguments)}function f(e,t){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){e.otpSessionId=yield b(t),e.receiverCountryCode=String(o("WAWebLinkDevicePhoneNumberEntryInputFormatUtils").getCountryCodeIso(o("WAWebUserPrefsMeUser").getMePnUserOrThrow().user)),h(e,t);var n=t.templateId;n!=null&&(e.templateId=n);var r=v(t);r!=null&&(e.otpProductType=r),y(e),C(e,t)}),g.apply(this,arguments)}function h(e,t){var n=t.from.user,r=o("WAWebABProps").getABPropConfigValue("otp_lid_migration_enabled");if(r&&n!=null){var a=o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated(),i=a?o("WAWebLidMigrationUtils").toLid(t.from):t.from;e.businessLidOrJid=i?i.toString():n;return}n!=null&&(e.businessPhoneNumber=Number(n))}function y(e){e.isKeepChatsArchivedEnabled=o("WAWebSettingsGetters").getShowArchiveV2(r("WAWebSettingsModel")),e.isNotificationEnabled=o("WAWebUserPrefsNotifications").getGlobalNotifications()}function C(e,t){var n=o("WAWebFrontendMsgGetters").getMaybeChat(t);n!=null&&(e.chatsFolderType=n.archive?o("WAWebWamEnumChatsFolderType").CHATS_FOLDER_TYPE.ARCHIVED:o("WAWebWamEnumChatsFolderType").CHATS_FOLDER_TYPE.INBOX,e.isMessageNotificationEnabled=!o("WAWebMuteGetters").getIsMuted(n.mute))}function b(e){return o("WACryptoSha256").sha256Str(e.id.id)}function v(e){var t=e.hydratedButtons;if(t==null||t.length===0)return null;var n=o("WAWebABProps").getABPropConfigValue("unified_otp_copy_code_url"),r=o("WAWebABProps").getABPropConfigValue("unified_otp_retriever_url");for(var a of t){var i,l=(i=a.urlButton)==null?void 0:i.url;if(l!=null){if(l.startsWith(n))return o("WAWebWamEnumOtpProductType").OTP_PRODUCT_TYPE.COPY_CODE;if(l.startsWith(r)){var s,u=(s=new URL(l))==null?void 0:s.searchParams,c=u.get("otp_type");if(c!=null)switch(c){case"COPY_CODE":return o("WAWebWamEnumOtpProductType").OTP_PRODUCT_TYPE.COPY_CODE;case"ONE_TAP":return o("WAWebWamEnumOtpProductType").OTP_PRODUCT_TYPE.ONE_TAP;case"ZERO_TAP":return o("WAWebWamEnumOtpProductType").OTP_PRODUCT_TYPE.ZERO_TAP;default:continue}else return o("WAWebWamEnumOtpProductType").OTP_PRODUCT_TYPE.ONE_TAP}}}return null}l.logOTPButtonClick=e,l.logOTPMessageReceived=u,l.logOTPMessageRead=d,l.logOTPMessageDeleted=p}),98);
__d("WAWebUtilsPnhSmbLoggingHelper",["WAWebContactCollection"],(function(t,n,r,o,a,i,l){function e(e){if(e!=null){if(!e.isLid())return e.user;var t=o("WAWebContactCollection").ContactCollection.get(e);if(e.isLid()&&(t==null?void 0:t.phoneNumber)!=null)return t.phoneNumber.user}return"-1"}l.jidToPnString=e}),98);
__d("WAWebCatalogVariantHelper",["fbt","$InternalEnum","WAWebBizGatingUtils","WAWebLinkedCatalogHelper"],(function(t,n,r,o,a,i,l,s){"use strict";var e=100,u="listing_details,types,availability,variant_properties";function c(e,t){var n,r=t!=null&&t.variantInfo!=null&&((n=t.variantInfo.listing_details)==null?void 0:n.description)==null&&t.variantInfo.variant_properties==null;return!!(!r&&e&&o("WAWebLinkedCatalogHelper").isLinkedCatalog(e.id)&&o("WAWebBizGatingUtils").isCatalogVariantsViewingEnabled())}var d=n("$InternalEnum")({COLOR:"color",SIZE:"size",MATERIAL:"material",PATTERN:"pattern",GENDER:"gender",AGE_GROUP:"age group"});function m(e,t){var n=d.cast(e.toLocaleLowerCase("en-US"));if(n==null)return e;switch(n){case d.COLOR:return t==null?s._(/*BTDS*/"Color"):s._(/*BTDS*/"_j{\"*\":\"{number} colores\",\"_1\":\"Color\"}",[s._plural(t,"number")]);case d.SIZE:return s._(/*BTDS*/"Tama\u00f1o");case d.MATERIAL:return s._(/*BTDS*/"Material");case d.PATTERN:return s._(/*BTDS*/"Patr\u00f3n");case d.GENDER:return s._(/*BTDS*/"Sexo");case d.AGE_GROUP:return s._(/*BTDS*/"Grupo de edad")}}l.VARIANT_THUMBNAIL_IMAGE_SIZE=e,l.FULL_VARIANT_INFO_FIELDS=u,l.shouldRequestVariantInfo=c,l.VariantOptionName=d,l.getVariantTypeOptions=m}),226);
__d("WAWebAnnouncementSpeakerIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="announcement-speaker";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=212,R=212;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 212 212",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"currentColor",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M89.5827 83.703C89.5827 82.9635 89.9699 82.278 90.6032 81.8962L119.16 64.6781C122.059 62.8863 125.902 64.8549 125.902 68.1319V137.101C125.902 140.308 122.206 142.288 119.301 140.639L90.6507 124.368C89.9905 123.993 89.5827 123.293 89.5827 122.534V83.703ZM46 96.2616C46 88.6676 52.5042 82.5114 60.5276 82.5114H80.209C81.3743 82.5114 82.3189 83.4561 82.3189 84.6213V121.652C82.3189 122.817 81.3743 123.762 80.209 123.762H75.6957L82.4837 147.779C83.0001 149.606 81.9267 151.465 80.0861 151.931L72.2787 153.908C70.4381 154.374 68.5274 153.271 68.0111 151.443L60.2202 123.878C60.2089 123.838 60.1983 123.798 60.1886 123.758C52.3218 123.588 46 117.498 46 110.012V96.2616ZM161.187 71.6946C160.374 70.6624 158.814 70.5245 157.751 71.3468L154.102 74.1721C153.034 74.9983 152.876 76.4799 153.682 77.5251C159.328 84.8487 162.362 93.7105 162.303 102.817C162.244 111.919 159.096 120.741 153.361 127.996C152.536 129.039 152.66 130.516 153.704 131.345L157.352 134.241C158.396 135.07 159.964 134.936 160.799 133.901C167.981 125.002 171.926 114.114 171.999 102.874C172.072 91.624 168.263 80.6813 161.187 71.6946ZM145.914 81.0162C145.113 79.9754 143.55 79.8499 142.494 80.6798L138.867 83.5311C137.806 84.3649 137.664 85.8456 138.444 86.9079C141.82 91.5035 143.641 96.9856 143.626 102.62C143.612 108.251 141.767 113.72 138.373 118.298C137.582 119.364 137.702 120.84 138.746 121.669L142.394 124.564C143.438 125.393 145.009 125.261 145.823 124.211C150.664 117.973 153.303 110.423 153.323 102.642C153.342 94.8522 150.735 87.2808 145.914 81.0162Z"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.AnnouncementSpeakerIcon=m}),98);
__d("WAWebAvatarSpinner.react",["fbt","WAWebClassnames","WAWebSpinner.react","react","stylex"],(function(t,n,r,o,a,i,l,s){var e=["ref"],u,c,d=u||(u=r("react")),m={container:{position:"x10l6tqk",top:"x13vifvy",insetInlineStart:"x1o0tod",display:"x78zum5",alignItems:"x6s0dn4",justifyContent:"xl56j7k",width:"xh8yej3",height:"x5yr21d",backgroundColor:"x1honnu5",borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",$$css:!0}};function p(t){var n=t.ref,a=babelHelpers.objectWithoutPropertiesLoose(t,e),i=a.className,l=a.xstyle,u=a.size,p=u===void 0?50:u;return d.jsx("div",{"aria-label":s._(/*BTDS*/"Cargando foto\u2026"),ref:n,className:o("WAWebClassnames").classnamesConvertMeToStylexPlease((c||(c=r("stylex")))(m.container,l),i),children:d.jsx(o("WAWebSpinner.react").Spinner,{size:p,stroke:3,color:"solidwhite"})})}p.displayName=p.name+" [from "+i.id+"]",l.default=p}),226);
__d("WAWebChatProfilePictureGatingUtils",["WAWebABProps","WAWebWid"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebABProps").getABPropConfigValue("group_chat_profile_pictures_v2_enabled")}function s(t){return e()&&t!=null&&r("WAWebWid").isUser(t)&&!r("WAWebWid").isPSA(t)}l.shouldDisplayInitialsInProfilePicture=s}),98);
__d("WAWebCommunityGeneralChatImage.react",["bx","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=r("bx").getURL(r("bx")("10639")),c=""+window.location.origin+u;function d(){return s.jsx("div",{className:"x10l6tqk x13vifvy x1o0tod xh8yej3 x5yr21d x1xsqp64 x18d0r48 x1vjfegm",style:{backgroundImage:"url("+u+")"},"aria-hidden":!0})}d.displayName=d.name+" [from "+i.id+"]",l.GeneralChatPlaceholderFullUrl=c,l.CommunityGeneralChatImage=d}),98);
__d("WAWebDefaultBroadcastIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="default-broadcast";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=212,R=212;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 212 212",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),version:"1.1",x:"0px",y:"0px",enableBackground:"new 0 0 212 212",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{fill:"#DFE5E7",className:"background",d:"M106.251,0.5C164.653,0.5,212,47.846,212,106.25S164.653,212,106.25,212C47.846,212,0.5,164.654,0.5,106.25 S47.846,0.5,106.251,0.5z"}),c.jsx("path",{fill:"#FFFFFF",className:"primary",d:"M152.168,54.014l-11.66,4.364v95.453l11.744,4.161L152.168,54.014z M49.742,121.662l18.892,6.698 c0,0.14-0.021,0.274-0.021,0.414c0,14.507,11.782,26.269,26.318,26.269c8.39,0,15.849-3.935,20.669-10.039l18.328,6.495v-90.66 L49.742,92.355V121.662L49.742,121.662z M108.302,142.417c-3.455,3.371-8.169,5.458-13.371,5.458 c-9.818,0-17.921-7.419-19.005-16.934L108.302,142.417z"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.DefaultBroadcastIcon=m}),98);
__d("WAWebDefaultCommunityRefreshedIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox","innerStyles"],s,u,c=s||(s=r("react")),d="default-community-refreshed";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=t.innerStyles,p=babelHelpers.objectWithoutPropertiesLoose(t,e),_;if(s){var f=s.x,g=f===void 0?0:f,h=s.y,y=h===void 0?0:h,C=s.width,b=C===void 0?0:C,v=s.height,S=v===void 0?0:v;_=[g,y,b,S].join(" ")}var R=212,L=212;return(a!=null||i!=null)&&(R=a,L=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},p,{children:c.jsxs("svg",{viewBox:_!=null?_:"0 0 48 48",height:R,width:L,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{d:"M15.029 24.901a9.5 9.5 0 0 0-2.965.346c-.592.167-1.264.44-1.828.875-.576.444-1.1 1.108-1.203 2.022-.048.427-.033 1.342-.021 1.86.02.924.777 1.996 1.684 1.996h3.767c-.224-.475-.357-1.356-.374-1.918-.016-.551-.06-2.039.048-2.828.055-.412.153-.797.281-1.154a5.4 5.4 0 0 1 .61-1.199M33.937 32h3.767c.907 0 1.663-1.072 1.684-1.996.012-.518.027-1.433-.021-1.86-.104-.914-.627-1.578-1.203-2.022-.564-.435-1.236-.708-1.828-.875a9.5 9.5 0 0 0-2.965-.346c.24.35.45.748.61 1.199.129.357.227.742.282 1.154.107.79.064 2.277.048 2.828-.017.562-.15 1.443-.374 1.918",fill:"#606263",className:u(m==null?void 0:m.primary)}),c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.803 24.383a16 16 0 0 1 4.397-.616c1.818 0 3.335.308 4.397.616.548.159 1.202.383 1.788.743.594.366 1.183.913 1.477 1.734q.117.321.17.696c.076.56.047 1.82.028 2.46-.027.918-.781 1.984-1.684 1.984H18.024c-.903 0-1.657-1.066-1.684-1.984-.019-.64-.048-1.9.028-2.46q.053-.375.17-.696c.294-.821.883-1.368 1.477-1.734.585-.36 1.24-.585 1.787-.743m10.591-4.632a3.37 3.37 0 0 1 3.377-3.369 3.37 3.37 0 0 1 3.378 3.37 3.38 3.38 0 0 1-3.378 3.381 3.38 3.38 0 0 1-3.378-3.382M19.696 17.51A4.51 4.51 0 0 1 24.2 13a4.51 4.51 0 0 1 4.504 4.51 4.5 4.5 0 0 1-4.504 4.496 4.5 4.5 0 0 1-4.504-4.497m-8.444 2.242a3.37 3.37 0 0 1 3.378-3.369 3.37 3.37 0 0 1 3.377 3.37 3.38 3.38 0 0 1-3.377 3.381 3.38 3.38 0 0 1-3.378-3.382",fill:"#606263",className:u(m==null?void 0:m.primary)})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.DefaultCommunityRefreshedIcon=m}),98);
__d("WAWebDefaultContactRefreshedIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox","innerStyles"],s,u,c=s||(s=r("react")),d="default-contact-refreshed";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=t.innerStyles,p=babelHelpers.objectWithoutPropertiesLoose(t,e),_;if(s){var f=s.x,g=f===void 0?0:f,h=s.y,y=h===void 0?0:h,C=s.width,b=C===void 0?0:C,v=s.height,S=v===void 0?0:v;_=[g,y,b,S].join(" ")}var R=212,L=212;return(a!=null||i!=null)&&(R=a,L=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},p,{children:c.jsxs("svg",{viewBox:_!=null?_:"0 0 48 48",height:R,width:L,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{d:"M24 23q-1.857 0-3.178-1.322Q19.5 20.357 19.5 18.5t1.322-3.178T24 14t3.178 1.322Q28.5 16.643 28.5 18.5t-1.322 3.178T24 23m-6.75 10q-.928 0-1.59-.66-.66-.662-.66-1.59v-.9q0-.956.492-1.758A3.3 3.3 0 0 1 16.8 26.87a16.7 16.7 0 0 1 3.544-1.308q1.8-.435 3.656-.436 1.856 0 3.656.436T31.2 26.87q.816.422 1.308 1.223T33 29.85v.9q0 .928-.66 1.59-.662.66-1.59.66z",fill:"#606263",className:u(m==null?void 0:m.primary)})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.DefaultContactRefreshedIcon=m}),98);
__d("WAWebDefaultGroupRefreshedIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox","innerStyles"],s,u,c=s||(s=r("react")),d="default-group-refreshed";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=t.innerStyles,p=babelHelpers.objectWithoutPropertiesLoose(t,e),_;if(s){var f=s.x,g=f===void 0?0:f,h=s.y,y=h===void 0?0:h,C=s.width,b=C===void 0?0:C,v=s.height,S=v===void 0?0:v;_=[g,y,b,S].join(" ")}var R=212,L=212;return(a!=null||i!=null)&&(R=a,L=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},p,{children:c.jsxs("svg",{viewBox:_!=null?_:"0 0 48 48",height:R,width:L,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.822 21.678Q19.143 23 21 23t3.178-1.322T25.5 18.5t-1.322-3.178Q22.857 14 21 14t-3.178 1.322T16.5 18.5t1.322 3.178M12.66 32.34q.66.66 1.589.661h13.5q.928 0 1.59-.66.66-.662.66-1.59v-.9q0-.956-.492-1.758A3.3 3.3 0 0 0 28.2 26.87a16.7 16.7 0 0 0-3.544-1.308q-1.8-.435-3.656-.436-1.856 0-3.656.436T13.8 26.869a3.3 3.3 0 0 0-1.308 1.223A3.3 3.3 0 0 0 12 29.85v.9q0 .928.66 1.59m21.09.66h-2.392A4.16 4.16 0 0 0 32 30.75v-.9c0-1-.263-1.95-.788-2.804a5.3 5.3 0 0 0-1.675-1.713q.563.093 1.119.228 1.8.436 3.544 1.308.815.422 1.308 1.223.492.802.492 1.758v.9q0 .928-.661 1.59-.66.66-1.59.66M27 23a4.6 4.6 0 0 1-1.18-.147c1.105-1.211 1.68-2.692 1.68-4.353s-.575-3.142-1.68-4.353A4.6 4.6 0 0 1 27 14q1.856 0 3.178 1.322Q31.5 16.643 31.5 18.5t-1.322 3.178T27 23",fill:"#606263",className:u(m==null?void 0:m.primary)})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.DefaultGroupRefreshedIcon=m}),98);
__d("WAWebDefaultNewsletterIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox","innerStyles"],s,u,c=s||(s=r("react")),d="default-newsletter";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=t.innerStyles,p=babelHelpers.objectWithoutPropertiesLoose(t,e),_;if(s){var f=s.x,g=f===void 0?0:f,h=s.y,y=h===void 0?0:h,C=s.width,b=C===void 0?0:C,v=s.height,S=v===void 0?0:v;_=[g,y,b,S].join(" ")}var R=212,L=212;return(a!=null||i!=null)&&(R=a,L=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},p,{children:c.jsxs("svg",{viewBox:_!=null?_:"0 0 212 212",height:R,width:L,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("rect",{width:212,height:212,rx:106,fill:"currentColor",className:u(m==null?void 0:m.background)}),c.jsx("path",{d:"M157.123 99.0265C154.027 75.5432 134.626 56.8186 111.097 54.6979C80.5503 51.9047 55.3184 75.388 54.7508 105.906C54.5444 116.872 58.7239 126.286 60.8395 130.32L54.6992 150.648C53.5124 154.579 57.1759 158.252 61.0975 157.062L81.1179 151.062C88.7546 155.304 97.3201 157.528 106.092 157.528C136.742 157.528 161.2 130.527 157.072 99.0265H157.123ZM85.7103 119.82C87.1034 121.889 86.9486 124.682 85.1943 126.441C82.8723 128.82 79.0024 128.355 77.1448 125.562C73.3781 119.975 71.1593 113.199 71.1593 105.958C71.1593 98.7161 73.5329 91.4229 77.6092 85.6813C79.4152 83.1468 83.1819 82.9916 85.4007 85.2158C87.2066 87.0262 87.3614 89.8194 85.9167 91.8884C83.1303 95.8712 81.5307 100.733 81.5307 105.958C81.5307 111.182 83.1303 115.837 85.8135 119.768L85.7103 119.82ZM106.35 113.716C102.067 113.716 98.61 110.251 98.61 105.958C98.61 101.664 102.067 98.1989 106.35 98.1989C110.633 98.1989 114.09 101.664 114.09 105.958C114.09 110.251 110.633 113.716 106.35 113.716ZM134.471 126.337C132.665 128.872 128.899 129.027 126.732 126.803C124.926 124.993 124.771 122.199 126.216 120.13C129.002 116.148 130.653 111.234 130.653 106.009C130.653 100.785 128.95 95.7678 126.112 91.7849C124.616 89.6642 124.719 86.8193 126.525 84.9572C128.692 82.7847 132.407 82.8882 134.265 85.4227C138.496 91.216 140.973 98.3023 140.973 106.061C140.973 113.82 138.548 120.648 134.471 126.389V126.337Z",fill:"#FFFFFF",className:u(m==null?void 0:m.primary)})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.DefaultNewsletterIcon=m}),98);
__d("WAWebDefaultUserColorIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="default-user-color";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=212,R=212;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 212 212",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),version:"1.1",x:"0px",y:"0px",enableBackground:"new 0 0 212 212",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{fill:"currentColor",className:"background",d:"M106.251,0.5C164.653,0.5,212,47.846,212,106.25S164.653,212,106.25,212C47.846,212,0.5,164.654,0.5,106.25 S47.846,0.5,106.251,0.5z"}),c.jsxs("g",{children:[c.jsx("path",{fill:"#FFFFFF",className:"primary",d:"M173.561,171.615c-0.601-0.915-1.287-1.907-2.065-2.955c-0.777-1.049-1.645-2.155-2.608-3.299 c-0.964-1.144-2.024-2.326-3.184-3.527c-1.741-1.802-3.71-3.646-5.924-5.47c-2.952-2.431-6.339-4.824-10.204-7.026 c-1.877-1.07-3.873-2.092-5.98-3.055c-0.062-0.028-0.118-0.059-0.18-0.087c-9.792-4.44-22.106-7.529-37.416-7.529 s-27.624,3.089-37.416,7.529c-0.338,0.153-0.653,0.318-0.985,0.474c-1.431,0.674-2.806,1.376-4.128,2.101 c-0.716,0.393-1.417,0.792-2.101,1.197c-3.421,2.027-6.475,4.191-9.15,6.395c-2.213,1.823-4.182,3.668-5.924,5.47 c-1.161,1.201-2.22,2.384-3.184,3.527c-0.964,1.144-1.832,2.25-2.609,3.299c-0.778,1.049-1.464,2.04-2.065,2.955 c-0.557,0.848-1.033,1.622-1.447,2.324c-0.033,0.056-0.073,0.119-0.104,0.174c-0.435,0.744-0.79,1.392-1.07,1.926 c-0.559,1.068-0.818,1.678-0.818,1.678v0.398c18.285,17.927,43.322,28.985,70.945,28.985c27.678,0,52.761-11.103,71.055-29.095 v-0.289c0,0-0.619-1.45-1.992-3.778C174.594,173.238,174.117,172.463,173.561,171.615z"}),c.jsx("path",{fill:"#FFFFFF",className:"primary",d:"M106.002,125.5c2.645,0,5.212-0.253,7.68-0.737c1.234-0.242,2.443-0.542,3.624-0.896 c1.772-0.532,3.482-1.188,5.12-1.958c2.184-1.027,4.242-2.258,6.15-3.67c2.863-2.119,5.39-4.646,7.509-7.509 c0.706-0.954,1.367-1.945,1.98-2.971c0.919-1.539,1.729-3.155,2.422-4.84c0.462-1.123,0.872-2.277,1.226-3.458 c0.177-0.591,0.341-1.188,0.49-1.792c0.299-1.208,0.542-2.443,0.725-3.701c0.275-1.887,0.417-3.827,0.417-5.811 c0-1.984-0.142-3.925-0.417-5.811c-0.184-1.258-0.426-2.493-0.725-3.701c-0.15-0.604-0.313-1.202-0.49-1.793 c-0.354-1.181-0.764-2.335-1.226-3.458c-0.693-1.685-1.504-3.301-2.422-4.84c-0.613-1.026-1.274-2.017-1.98-2.971 c-2.119-2.863-4.646-5.39-7.509-7.509c-1.909-1.412-3.966-2.643-6.15-3.67c-1.638-0.77-3.348-1.426-5.12-1.958 c-1.181-0.355-2.39-0.655-3.624-0.896c-2.468-0.484-5.035-0.737-7.68-0.737c-21.162,0-37.345,16.183-37.345,37.345 C68.657,109.317,84.84,125.5,106.002,125.5z"})]})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.DefaultUserColorIcon=m}),98);
__d("WAWebDefaultUserSquareIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox","innerStyles"],s,u,c=s||(s=r("react")),d="default-user-square";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=t.innerStyles,p=babelHelpers.objectWithoutPropertiesLoose(t,e),_;if(s){var f=s.x,g=f===void 0?0:f,h=s.y,y=h===void 0?0:h,C=s.width,b=C===void 0?0:C,v=s.height,S=v===void 0?0:v;_=[g,y,b,S].join(" ")}var R=212,L=212;return(a!=null||i!=null)&&(R=a,L=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},p,{children:c.jsxs("svg",{viewBox:_!=null?_:"0 0 212 212",height:R,width:L,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),version:"1.1",x:"0px",y:"0px",enableBackground:"new 0 0 212 212",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{fill:"#DFE5E7",d:"M0,0h212v212H0V0z",className:u(m==null?void 0:m.background)}),c.jsx("path",{fill:"#FFFFFF",d:"M106,125.5c2.6,0,5.2-0.3,7.7-0.7c1.2-0.2,2.4-0.5,3.6-0.9c1.8-0.5,3.5-1.2,5.1-2c2.2-1,4.2-2.3,6.1-3.7 c2.9-2.1,5.4-4.6,7.5-7.5c0.7-1,1.4-1.9,2-3c0.9-1.5,1.7-3.2,2.4-4.8c0.5-1.1,0.9-2.3,1.2-3.5c0.2-0.6,0.3-1.2,0.5-1.8 c0.3-1.2,0.5-2.4,0.7-3.7c0.3-1.9,0.4-3.8,0.4-5.8s-0.1-3.9-0.4-5.8c-0.2-1.3-0.4-2.5-0.7-3.7c-0.1-0.6-0.3-1.2-0.5-1.8 c-0.4-1.2-0.8-2.3-1.2-3.5c-0.7-1.7-1.5-3.3-2.4-4.8c-0.6-1-1.3-2-2-3c-2.1-2.9-4.6-5.4-7.5-7.5c-1.9-1.4-4-2.6-6.1-3.7 c-1.6-0.8-3.3-1.4-5.1-2c-1.2-0.4-2.4-0.7-3.6-0.9c-2.5-0.5-5-0.7-7.7-0.7c-21.2,0-37.3,16.2-37.3,37.3 C68.7,109.3,84.8,125.5,106,125.5z M175,173.9c-0.4-0.7-0.9-1.5-1.4-2.3c-0.6-0.9-1.3-1.9-2.1-3c-0.8-1-1.6-2.2-2.6-3.3 s-2-2.3-3.2-3.5c-1.7-1.8-3.7-3.6-5.9-5.5c-3-2.4-6.3-4.8-10.2-7c-1.9-1.1-3.9-2.1-6-3.1c-0.1,0-0.1-0.1-0.2-0.1 c-9.8-4.4-22.1-7.5-37.4-7.5s-27.6,3.1-37.4,7.5c-0.3,0.2-0.7,0.3-1,0.5c-1.4,0.7-2.8,1.4-4.1,2.1c-0.7,0.4-1.4,0.8-2.1,1.2 c-3.4,2-6.5,4.2-9.1,6.4c-2.2,1.8-4.2,3.7-5.9,5.5c-1.2,1.2-2.2,2.4-3.2,3.5s-1.8,2.2-2.6,3.3c-0.8,1-1.5,2-2.1,3 c-0.6,0.8-1,1.6-1.4,2.3c0,0.1-0.1,0.1-0.1,0.2v0.1c-9.6,15-9.6,32.9-9.6,32.9s61.2,0,78.7,0h0.1c17.4,0,78.8,0,78.8,0 S184.7,189,175,173.9z",className:u(m==null?void 0:m.primary)})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.DefaultUserSquareIcon=m}),98);
__d("WAWebDisappearingMessagesRefreshedIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="disappearing-messages-refreshed";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=24,R=24;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 24 24",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{d:"M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C12.0547 22 12.1094 21.9996 12.1639 21.9987C12.7775 21.9888 13.2669 21.4834 13.257 20.8698C13.2471 20.2563 12.7417 19.7669 12.1281 19.7767C12.0855 19.7774 12.0428 19.7778 12 19.7778C7.70445 19.7778 4.22222 16.2955 4.22222 12C4.22222 7.70445 7.70445 4.22222 12 4.22222C12.0428 4.22222 12.0855 4.22257 12.1281 4.22325C12.7417 4.23314 13.2471 3.74375 13.257 3.13018C13.2669 2.51661 12.7775 2.0112 12.1639 2.00132C12.1094 2.00044 12.0547 2 12 2Z",fill:"currentColor"}),c.jsx("path",{d:"M16.8592 3.25814C16.3231 2.95957 15.6465 3.15213 15.3479 3.68825C15.0493 4.22437 15.2419 4.90102 15.778 5.19959C15.8522 5.24089 15.9256 5.28338 15.9983 5.32703C16.5243 5.643 17.2069 5.4727 17.5229 4.94665C17.8389 4.4206 17.6686 3.738 17.1425 3.42203C17.0491 3.36591 16.9546 3.31127 16.8592 3.25814Z",fill:"currentColor"}),c.jsx("path",{d:"M19.0534 6.47712C19.5794 6.16115 20.262 6.33145 20.578 6.8575C20.6341 6.95093 20.6887 7.04537 20.7419 7.14077C21.0404 7.67689 20.8479 8.35353 20.3118 8.65211C19.7756 8.95068 19.099 8.75811 18.8004 8.22199C18.7591 8.14782 18.7166 8.07439 18.673 8.00173C18.357 7.47568 18.5273 6.79309 19.0534 6.47712Z",fill:"currentColor"}),c.jsx("path",{d:"M21.9987 11.8361C21.9888 11.2225 21.4834 10.7331 20.8698 10.743C20.2563 10.7529 19.7669 11.2583 19.7767 11.8719C19.7774 11.9145 19.7778 11.9572 19.7778 12C19.7778 12.0428 19.7774 12.0855 19.7767 12.1281C19.7669 12.7417 20.2563 13.2471 20.8698 13.257C21.4834 13.2669 21.9888 12.7775 21.9987 12.1639C21.9996 12.1094 22 12.0547 22 12C22 11.9453 21.9996 11.8906 21.9987 11.8361Z",fill:"currentColor"}),c.jsx("path",{d:"M20.3118 15.3479C20.8479 15.6465 21.0404 16.3231 20.7419 16.8592C20.6887 16.9546 20.6341 17.0491 20.578 17.1425C20.262 17.6686 19.5794 17.8389 19.0534 17.5229C18.5273 17.2069 18.357 16.5243 18.673 15.9983C18.7166 15.9256 18.7591 15.8522 18.8004 15.778C19.099 15.2419 19.7756 15.0493 20.3118 15.3479Z",fill:"currentColor"}),c.jsx("path",{d:"M17.1425 20.578C17.6686 20.262 17.8389 19.5794 17.5229 19.0534C17.2069 18.5273 16.5243 18.357 15.9983 18.673C15.9256 18.7166 15.8522 18.7591 15.778 18.8004C15.2419 19.099 15.0493 19.7756 15.3479 20.3118C15.6465 20.8479 16.3231 21.0404 16.8592 20.7419C16.9546 20.6887 17.0491 20.6341 17.1425 20.578Z",fill:"currentColor"}),c.jsx("path",{d:"M16.7811 7.6229C16.5556 7.39749 16.1988 7.37213 15.9438 7.5634L11.3327 11.0217C10.6836 11.5085 10.6161 12.4574 11.1899 13.0312L11.3728 13.2141C11.9465 13.7878 12.8954 13.7204 13.3823 13.0713L16.8406 8.46018C17.0318 8.20516 17.0065 7.84831 16.7811 7.6229Z",fill:"currentColor"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.DisappearingMessagesRefreshedIcon=m}),98);
__d("WAWebDoubleChevronIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="double-chevron";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=66,R=66;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 66 66",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{d:"M52.1731 31.43L41.2382 16.1374C40.3179 14.8382 38.8292 14.0532 37.2323 14.0532C33.1994 14.0532 30.8716 18.6004 33.1994 21.8755L41.1299 32.9999L33.1994 44.1243C30.8446 47.3994 33.1994 51.9466 37.2323 51.9466C38.8292 51.9466 40.345 51.1616 41.2652 49.8624L52.2002 34.5698C52.8498 33.6224 52.8498 32.3774 52.1731 31.43Z",fill:"currentColor"}),c.jsx("path",{d:"M33.2264 31.43L22.3186 16.1374C21.3712 14.8382 19.8826 14.0532 18.2856 14.0532C14.2527 14.0532 11.8979 18.6004 14.2527 21.8755L22.1832 32.9999L14.2527 44.1243C11.8979 47.3994 14.2527 51.9466 18.2856 51.9466C19.8826 51.9466 21.3983 51.1616 22.3186 49.8624L33.2535 34.5698C33.9031 33.6224 33.9031 32.3774 33.2264 31.43Z",fill:"currentColor"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.DoubleChevronIcon=m}),98);
__d("WAWebHasAcceptedBizBotTos",["WAWebBotTos","WAWebTos","react","useWAWebListener"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useState;function u(){var e=s(o("WAWebBotTos").hasAcceptedBizBotTos),t=e[0],n=e[1];return o("useWAWebListener").useListener(o("WAWebTos").TosManager,"change",function(){n(o("WAWebBotTos").hasAcceptedBizBotTos())}),t}l.useHasAcceptedBizBotTos=u}),98);
__d("WAWebIdleComponent.react",["WAWebIdleTaskRunner","WAWebWid","react","useLazyRef","useWAWebPrevious"],(function(t,n,r,o,a,i,l){var e,s,u=s||(s=o("react")),c=e||(e=r("react")),d=u.useEffect,m=u.useState;function p(e){var t=e.children,n=e.onComplex,a=e.waitIdle,i=a===void 0?!1:a,l=e.id,s=m(function(){return o("WAWebIdleTaskRunner").UIBusyTasks.isBusy()}),u=s[0],p=s[1],_=function(){p(!1)},f=r("useLazyRef")(function(){return i?o("WAWebIdleTaskRunner").UIBusyTasks.enqueue(_):null}),g=r("useWAWebPrevious")(l);return d(function(){return function(){i&&f.current!=null&&o("WAWebIdleTaskRunner").UIBusyTasks.dequeue(f.current)}},[]),d(function(){if(!r("WAWebWid").equals(g,l)||!i){u&&f.current!=null&&o("WAWebIdleTaskRunner").UIBusyTasks.dequeue(f.current);var e=o("WAWebIdleTaskRunner").UIBusyTasks.isBusy();e&&i&&(f.current=o("WAWebIdleTaskRunner").UIBusyTasks.enqueue(_)),p(e)}},[l,f,u,g,i]),u&&i?c.jsx(c.Fragment,{children:t}):n()}p.displayName=p.name+" [from "+i.id+"]",l.default=p}),98);
__d("WAWebInitialsFromNameUtils",["$InternalEnum","WAWebL10N"],(function(t,n,r,o,a,i,l){var e=n("$InternalEnum").Mirrored(["ARABIC","LATIN","HEBREW","THAI","GUJARATI","DEVANAGARI","CYRILLIC","BENGALI","HAN"]),s=new RegExp(/[\u0600-\u0604\u0606-\u060B\u060D-\u061A\u061C-\u061E\u0620-\u063F\u0641-\u064A\u0656-\u066F\u0671-\u06DC\u06DE-\u06FF\u0750-\u077F\u0870-\u088E\u0890\u0891\u0898-\u08E1\u08E3-\u08FF\uFB50-\uFBC2\uFBD3-\uFD3D\uFD40-\uFD8F\uFD92-\uFDC7\uFDCF\uFDF0-\uFDFF\uFE70-\uFE74\uFE76-\uFEFC]/),u=new RegExp(/[A-Za-z\xAA\xBA\xC0-\xD6\xD8-\xF6\xF8-\u0249\u02E0-\u02E4\u1D00-\u1D25\u1D2C-\u1D5C\u1D62-\u1D65\u1D6B-\u1D77\u1D79-\u1DBE\u1E00-\u1EFF\u2071\u207F\u2090-\u209C\u212A\u212B\u2132\u214E\u2160-\u2188\u2C60-\u2C7F\uA722-\uA787\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA7FF\uAB30-\uAB5A\uAB5C-\uAB64\uAB66-\uAB69\uFB00-\uFB06\uFF21-\uFF3A\uFF41-\uFF5A]/),c=new RegExp(/[\u0591-\u05C7\u05D0-\u05EA\u05EF-\u05F4\uFB1D-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFB4F]/),d=new RegExp(/[\u0E01-\u0E3A\u0E40-\u0E5B]/),m=new RegExp(/[\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AF1\u0AF9-\u0AFF]/),p=new RegExp(/[\u0900-\u0950\u0955-\u0963\u0966-\u097F\uA8E0-\uA8FF]/),_=new RegExp(/[\u0400-\u0484\u0487-\u052F\u1C80-\u1C88\u1D2B\u1D78\u2DE0-\u2DFF\uA640-\uA69F\uFE2E\uFE2F]/),f=new RegExp(/[\u0980-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09FE]/),g=new RegExp(/[\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u3005\u3007\u3021-\u3029\u3038-\u303B\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFA6D\uFA70-\uFAD9]/),h=new Map([[e.ARABIC,s],[e.LATIN,u],[e.HEBREW,c],[e.THAI,d],[e.GUJARATI,m],[e.DEVANAGARI,p],[e.CYRILLIC,_],[e.BENGALI,f],[e.HAN,g]]),y=new RegExp(/[\u093A\u093B\u093E-\u094C\u094E\u094F\u0955-\u0957\u0962\u0963]/),C=new RegExp(/[\u09BE-\u09CC\u09E2\u09E3]/),b=new RegExp(/[\u0ABE-\u0ACC\u0AE2\u0AE3]/),v=new RegExp(/[\u0E30-\u0E59]/),S=D([s,d,m,p,f]),R=D([p,f,m]),L=D(Array.from(h.values()));function E(e){return Array.from(h.keys()).find(function(t){var n=h.get(t);return n==null?void 0:n.test(e)})}function k(e){return S.test(e)}function I(e){return g.test(e)}function T(e){return L.test(e)}function D(e){return new RegExp(e.map(function(e){return e.source}).join("|"))}function x(e){var t=!1;e.firstName!=null&&(t=k(e.firstName));var n=e.firstName!=null&&e.firstName!==""&&!I(e.firstName),r=t!==!0&&e.lastName!=null&&e.lastName!=="";e.firstName!=null&&e.firstName!==""&&g.test(e.firstName)&&!r&&(n=!0);var o=e.lastName===""&&e.firstName==="",a=n!==!0&&r!==!0&&!o;return{showFirstNameInitial:n,showLastNameInitial:r,showPushnameInitial:a}}function $(e,t,n){var o,a=e==null?void 0:e.trim(),i=null;a!=null&&t!=null&&(a==null?void 0:a.length)>0?i=t.trim().replace(a,"").trim():i=t==null?void 0:t.trim();var l=r("WAWebL10N").getFullLocale(),s=a==null?void 0:a.toLocaleUpperCase(l),u=(o=i)==null?void 0:o.toLocaleUpperCase(l),c=n==null?void 0:n.toLocaleUpperCase(l);return{firstName:s,lastName:u,pushname:c}}function P(e){var t=e.charAt(0),n=e.charAt(1),r=null,o=null;if(p.test(t)?(r=p,o=y):f.test(t)?(r=f,o=C):m.test(t)&&(r=m,o=b),!(r==null||o==null))return n!=null&&r.test(t)&&!o.test(t)&&o.test(n)?t+n:r.test(t)?t:null}function N(e,t){var n=e.charAt(0);if(R.test(e))return P(e);if(n!=null&&d.test(n)&&v.test(n)){var r=e==null?void 0:e.slice(1).trim(),o=r==null?void 0:r.charAt(0);return T(o)&&!v.test(o)?o:null}return I(e)&&!t?e.slice(0,2):T(n)?n:null}function M(e){var t=$(e.shortName,e.name,e.pushname),n=x(t),r=null,o=null,a=t.firstName,i=n.showFirstNameInitial===!0&&n.showLastNameInitial===!1;return n.showFirstNameInitial===!0&&a!=null&&(r=N(a,i)),n.showLastNameInitial===!0&&t.lastName!=null&&(o=N(t.lastName,i)),n.showPushnameInitial===!0&&t.pushname!=null&&(r=N(t.pushname,!0),o=null),r!=null&&o!=null&&E(r)!==E(o)&&(o=null),{firstInitial:r,secondInitial:o}}function w(e){return M({shortName:e==null?void 0:e.shortName,name:e==null?void 0:e.name,pushname:e==null?void 0:e.pushname})}l.InitialsAlphabets=e,l.supportedAlphabetsMap=h,l.getInitialsFromNames=M,l.getInitialsFromContact=w}),98);
__d("WAWebInitialsProfilePicture.react",["$InternalEnum","WABidi","WAWebInitialsFromNameUtils","react","stylex","useWAWebGroupColors"],(function(t,n,r,o,a,i,l){var e,s,u=e||(e=r("react")),c=n("$InternalEnum").Mirrored(["Default","GroupChatProfilePicture","NewsletterQuestionsResponses"]),d={initialsBackground:{borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",color:"x1awj2ng",display:"x78zum5",alignItems:"x6s0dn4",justifyContent:"xl56j7k",$$css:!0},initialsNewsletterResponses:{width:"x100vrsf",height:"x1vqgdyp",$$css:!0},initialsDefault:{width:"xh8yej3",height:"x5yr21d",$$css:!0}};function m(e){var t=e.backgroundColorId,n=e.initialsData,a=e.theme,i=a===void 0?c.Default:a,l=o("useWAWebGroupColors").useGroupsColorStyle(t,"background"),m=n.firstInitial!=null&&n.secondInitial!=null,p=o("WAWebInitialsFromNameUtils").supportedAlphabetsMap.get(o("WAWebInitialsFromNameUtils").InitialsAlphabets.HAN),_=!1;if(p&&n.secondInitial!=null&&p.test(n==null?void 0:n.secondInitial)){var f,g=((f=n.secondInitial)==null?void 0:f.length)||0;_=g>1}var h=n.firstInitial!=null&&o("WABidi").dir(n.firstInitial)==="rtl"?"rtl":"ltr",y=i===c.NewsletterQuestionsResponses?d.initialsNewsletterResponses:d.initialsDefault;return u.jsx("div",babelHelpers.extends({},(s||(s=r("stylex"))).props(d.initialsBackground,y,l),{children:u.jsxs("div",babelHelpers.extends({dir:h},{0:{},8:{className:"x1aueamr"},4:{className:"x1f6kntn"},12:{className:"x1f6kntn"},2:{className:"x1nxh6w3"},10:{className:"x1nxh6w3"},6:{className:"x1nxh6w3"},14:{className:"x1nxh6w3"},1:{className:"x1ncwhqj"},9:{className:"x1ncwhqj"},5:{className:"x1ncwhqj"},13:{className:"x1ncwhqj"},3:{className:"x1ncwhqj"},11:{className:"x1ncwhqj"},7:{className:"x1ncwhqj"},15:{className:"x1ncwhqj"}}[(i===c.Default)<<3|(i===c.GroupChatProfilePicture)<<2|!!(i===c.GroupChatProfilePicture&&m)<<1|!!_<<0],{children:[u.jsx("div",{"data-testid":void 0,className:"x1rg5ohu xk50ysn",children:n.firstInitial}),u.jsx("div",{"data-testid":void 0,className:"x1rg5ohu xk50ysn",children:n.secondInitial})]}))}))}m.displayName=m.name+" [from "+i.id+"]",l.ThemeType=c,l.InitialsProfilePicture=m}),98);
__d("WAWebWaChatPsaIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="wa-chat-psa";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=360,R=360;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 360 360",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),version:"1.1",id:"Layer_1",x:"0px",y:"0px",enableBackground:"new 0 0 360 360",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{fill:"#25D366",opacity:1,stroke:"none",d:" M173.000000,361.000000  C115.353172,361.000000 58.206341,361.000000 1.029757,361.000000  C1.029757,241.061493 1.029757,121.122963 1.029757,1.092220  C120.896820,1.092220 240.793732,1.092220 360.845337,1.092220  C360.845337,120.999847 360.845337,240.999893 360.845337,361.000000  C298.456329,361.000000 235.978165,361.000000 173.000000,361.000000  M197.063446,92.379547  C195.411438,92.174431 193.762665,91.937508 192.106949,91.768898  C156.937073,88.187309 128.342728,100.457565 108.074654,129.217316  C87.867386,157.890823 86.575523,188.910645 101.408730,220.531891  C102.965797,223.851242 103.232262,226.553955 102.266563,229.950317  C98.463707,243.324921 94.899605,256.767395 91.084465,270.781311  C93.123474,270.351715 94.548683,270.112305 95.941422,269.748505  C108.650543,266.428864 121.320129,262.946716 134.088593,259.875153  C136.551529,259.282684 139.727280,259.569855 142.010056,260.646881  C157.967712,268.175995 174.705978,270.917206 192.102615,268.776276  C234.755585,263.527069 268.624664,226.903122 270.011841,184.898880  C271.516479,139.337418 241.558502,101.014793 197.063446,92.379547  z"}),c.jsx("path",{fill:"#FCFEFD",opacity:1,stroke:"none",d:" M197.474182,92.506378  C241.558502,101.014793 271.516479,139.337418 270.011841,184.898880  C268.624664,226.903122 234.755585,263.527069 192.102615,268.776276  C174.705978,270.917206 157.967712,268.175995 142.010056,260.646881  C139.727280,259.569855 136.551529,259.282684 134.088593,259.875153  C121.320129,262.946716 108.650543,266.428864 95.941422,269.748505  C94.548683,270.112305 93.123474,270.351715 91.084465,270.781311  C94.899605,256.767395 98.463707,243.324921 102.266563,229.950317  C103.232262,226.553955 102.965797,223.851242 101.408730,220.531891  C86.575523,188.910645 87.867386,157.890823 108.074654,129.217316  C128.342728,100.457565 156.937073,88.187309 192.106949,91.768898  C193.762665,91.937508 195.411438,92.174431 197.474182,92.506378  M253.181854,196.536774  C255.711929,186.169617 256.004150,175.664429 253.541946,165.353546  C246.119568,134.271210 226.847565,114.125397 195.518936,107.758392  C164.775314,101.510277 138.969528,111.918282 120.761078,137.417480  C102.516304,162.967529 102.122711,190.360199 117.175308,217.804871  C119.110695,221.333557 119.630486,224.226303 118.452988,227.999252  C116.305588,234.880005 114.631348,241.908432 112.534187,249.714706  C121.244263,247.449783 128.886383,245.269287 136.634216,243.571182  C138.823502,243.091385 141.697876,243.342087 143.623520,244.406097  C187.851929,268.844574 240.426270,246.301453 253.181854,196.536774  z"}),c.jsx("path",{fill:"#26D367",opacity:1,stroke:"none",d:" M253.113434,196.950668  C240.426270,246.301453 187.851929,268.844574 143.623520,244.406097  C141.697876,243.342087 138.823502,243.091385 136.634216,243.571182  C128.886383,245.269287 121.244263,247.449783 112.534187,249.714706  C114.631348,241.908432 116.305588,234.880005 118.452988,227.999252  C119.630486,224.226303 119.110695,221.333557 117.175308,217.804871  C102.122711,190.360199 102.516304,162.967529 120.761078,137.417480  C138.969528,111.918282 164.775314,101.510277 195.518936,107.758392  C226.847565,114.125397 246.119568,134.271210 253.541946,165.353546  C256.004150,175.664429 255.711929,186.169617 253.113434,196.950668  M159.161896,144.300629  C157.596588,142.566147 156.289551,139.760483 154.415009,139.308472  C149.758347,138.185654 145.465286,139.125748 141.936844,143.335083  C135.938049,150.491486 133.889008,158.646042 136.794312,167.095337  C139.180939,174.036118 142.985977,180.714874 147.247849,186.742218  C159.314850,203.807953 175.066055,216.142273 195.540466,221.815857  C205.004898,224.438538 213.684128,223.322174 221.218109,216.594635  C225.301636,212.948212 226.861237,207.950836 225.754288,203.034790  C225.255310,200.818695 221.393539,199.207153 218.857986,197.645233  C216.319427,196.081421 213.584717,194.800613 210.844025,193.606903  C202.134613,189.813538 203.863739,189.749985 198.366028,196.614182  C197.431046,197.781570 196.301865,198.814072 195.495682,200.059845  C193.532318,203.093781 191.249756,202.866211 188.234161,201.544495  C177.255371,196.732590 168.560989,189.383530 161.641464,179.587280  C158.640030,175.338043 158.010895,172.193756 162.204178,168.482956  C166.102249,165.033386 166.959518,160.921555 164.134537,156.022842  C162.157837,152.595093 161.014969,148.686508 159.161896,144.300629  z"}),c.jsx("path",{fill:"#FCFEFD",opacity:1,stroke:"none",d:" M159.330811,144.646652  C161.014969,148.686508 162.157837,152.595093 164.134537,156.022842  C166.959518,160.921555 166.102249,165.033386 162.204178,168.482956  C158.010895,172.193756 158.640030,175.338043 161.641464,179.587280  C168.560989,189.383530 177.255371,196.732590 188.234161,201.544495  C191.249756,202.866211 193.532318,203.093781 195.495682,200.059845  C196.301865,198.814072 197.431046,197.781570 198.366028,196.614182  C203.863739,189.749985 202.134613,189.813538 210.844025,193.606903  C213.584717,194.800613 216.319427,196.081421 218.857986,197.645233  C221.393539,199.207153 225.255310,200.818695 225.754288,203.034790  C226.861237,207.950836 225.301636,212.948212 221.218109,216.594635  C213.684128,223.322174 205.004898,224.438538 195.540466,221.815857  C175.066055,216.142273 159.314850,203.807953 147.247849,186.742218  C142.985977,180.714874 139.180939,174.036118 136.794312,167.095337  C133.889008,158.646042 135.938049,150.491486 141.936844,143.335083  C145.465286,139.125748 149.758347,138.185654 154.415009,139.308472  C156.289551,139.760483 157.596588,142.566147 159.330811,144.646652  z"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.WaChatPsaIcon=m}),98);
__d("WAWebDetailImage.react",["fbt","$InternalEnum","WALogger","WAShiftTimer","WAWebAnnouncementSpeakerIcon.react","WAWebAvatarSpinner.react","WAWebBizGatingUtils","WAWebChatCollection","WAWebChatCommunityUtils","WAWebChatEphemerality","WAWebChatGetters","WAWebChatProfilePictureGatingUtils","WAWebClassnames","WAWebCommonCTWAConsumerTransparency","WAWebCommunityGatingUtils","WAWebCommunityGeneralChatImage.react","WAWebContactCollection","WAWebDefaultBroadcastIcon.react","WAWebDefaultCommunityRefreshedIcon.react","WAWebDefaultContactRefreshedIcon.react","WAWebDefaultGroupRefreshedIcon.react","WAWebDefaultNewsletterIcon.react","WAWebDefaultUserColorIcon.react","WAWebDefaultUserSquareIcon.react","WAWebDisappearingMessagesRefreshedIcon.react","WAWebDoubleChevronIcon.react","WAWebDoubleChevronInCircleIcon.react","WAWebEnvironment","WAWebGroupType","WAWebHasAcceptedBizBotTos","WAWebIcVisibilityOffIcon.react","WAWebIdleComponent.react","WAWebImg.react","WAWebInitialsFromNameUtils","WAWebInitialsProfilePicture.react","WAWebKeyboardIsKeyActivation","WAWebLidMigrationUtils","WAWebMiscErrors","WAWebMiscGatingUtils","WAWebMmsClientIsErrorRetryable","WAWebPREGatingUtils","WAWebProfilePicThumbCollection","WAWebPsaVerifiedBlueIcon.react","WAWebPsaVerifiedIcon.react","WAWebSingleChevronInCircleIcon.react","WAWebStateUtils","WAWebUISpacing","WAWebUnjoinedSubgroupMetadataCollection","WAWebUseIsKeyboardUser","WAWebUserPrefsMeUser","WAWebWaChatPsaIcon.react","WAWebWid","WDSFocusStateStyles","cr:5981","gkx","react","stylex","useLazyRef","useWAWebEventTargetValue","useWAWebForceUpdate","useWAWebGroupColors","useWAWebListener","useWAWebModelValues"],(function(t,n,r,o,a,i,l,s){var e,u,c,d,m=d||(d=o("react")),p=u||(u=r("react")),_=m.useEffect,f=m.useMemo,g=m.useRef,h=m.useState,y=m.useTransition,C=new Set,b=n("cr:5981")==null?void 0:n("cr:5981").InternalStatusWarningImageOverlay,v=n("$InternalEnum").Mirrored(["ExtraSmall","Small","Medium","Large","Refresh","None"]),S=n("$InternalEnum").Mirrored(["Low","High"]),R=n("$InternalEnum").Mirrored(["Circle","Square","Squircle"]),L=n("$InternalEnum").Mirrored(["GroupChatProfilePicture","Status","MediaHub","GroupStatus"]),E={announcementSpeaker:{color:"xo1mcw5",$$css:!0},communitySquircle:{color:"x17k9de1",$$css:!0},newsletter:{color:"x17k9de1",$$css:!0},avatarDefaultPSA:{borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",$$css:!0},dimmed:{opacity:"xavfwda",$$css:!0},avatar:{position:"x1n2onr6",borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",$$css:!0},status:{backgroundColor:"x1gle93d",$$css:!0},avatarSquare:{borderStartStartRadius:"x1bczwif",borderStartEndRadius:"x17un8ov",borderEndEndRadius:"x1e7945m",borderEndStartRadius:"x11o6v7j",$$css:!0},avatarImage:{position:"x1n2onr6",display:"x1lliihq",width:"xh8yej3",height:"x5yr21d",overflowX:"x6ikm8r",overflowY:"x10wlt62",borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",objectFit:"xl1xv1r",objectPosition:"x115dhu7",opacity:"xg01cxk",transition:"x17vty23",$$css:!0},isLoaded:{opacity:"x1hc1fzr",$$css:!0},avatarImageNoTransition:{transition:"xq2gx43",$$css:!0},avatarSquircle:{clipPath:"x1f2iure",borderStartStartRadius:"x1bczwif",borderStartEndRadius:"x17un8ov",borderEndEndRadius:"x1e7945m",borderEndStartRadius:"x11o6v7j",$$css:!0},groupProfilePicture:{position:"x10l6tqk",insetInlineStart:"x1nobqc8",left:null,right:null,width:"xgd8bvy",height:"x1fgtraw",$$css:!0},groupProfilePictureInBubble:{width:"x14qfxbe",height:"xc9qbxq",$$css:!0},svgSize:{width:"xh8yej3",height:"x5yr21d",$$css:!0},profilePictureOutlineRefreshed:{outline:"x4u6w88",outlineOffset:"x1g40iwv",$$css:!0},circleIconRefreshed:{borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",backgroundColor:"x1od0jb8",$$css:!0},squircleIconRefreshed:{clipPath:"x1f2iure",backgroundColor:"x1od0jb8",$$css:!0},avatarBorder:{borderTopWidth:"x1ktv7sr",borderInlineEndWidth:"x142x0oa",borderBottomWidth:"xv7zg05",borderInlineStartWidth:"x12dgle5",borderTopStyle:"x13fuv20",borderInlineEndStyle:"x18b5jzi",borderBottomStyle:"x1q0q8m5",borderInlineStartStyle:"x1t7ytsu",borderTopColor:"x16jw5py",borderInlineEndColor:"x13dr7gu",borderBottomColor:"xd9srri",borderInlineStartColor:"x1ia0k5z",$$css:!0},avatarProfileRingBorder:{borderTopWidth:"x1ktv7sr",borderInlineEndWidth:"x142x0oa",borderBottomWidth:"xv7zg05",borderInlineStartWidth:"x12dgle5",borderTopStyle:"x13fuv20",borderInlineEndStyle:"x18b5jzi",borderBottomStyle:"x1q0q8m5",borderInlineStartStyle:"x1t7ytsu",borderTopColor:"x1y9zq84",borderInlineEndColor:"xt9xd2u",borderBottomColor:"x3tsejo",borderInlineStartColor:"x1ahzpo1",boxSizing:"x9f619",$$css:!0},avatarDefaultAnnouncementGroup:{backgroundColor:"xfn3atn",$$css:!0},inviteModal:{borderTopWidth:"x1ktv7sr",borderInlineEndWidth:"x142x0oa",borderBottomWidth:"xv7zg05",borderInlineStartWidth:"x12dgle5",borderTopStyle:"x13fuv20",borderInlineEndStyle:"x18b5jzi",borderBottomStyle:"x1q0q8m5",borderInlineStartStyle:"x1t7ytsu",borderTopColor:"x19bsprb",borderInlineEndColor:"x2cy9dh",borderBottomColor:"x1eeqclz",borderInlineStartColor:"x1mx0rqa",backgroundColor:"x16w0wmm",$$css:!0},outline:{borderTopColor:"xx42vgk",borderInlineEndColor:"xbogo7e",borderBottomColor:"x120ee7l",borderInlineStartColor:"x1vb5itz",borderTopStyle:"x13fuv20",borderInlineEndStyle:"x18b5jzi",borderBottomStyle:"x1q0q8m5",borderInlineStartStyle:"x1t7ytsu",borderTopWidth:"x178xt8z",borderInlineEndWidth:"x1lun4ml",borderBottomWidth:"xso031l",borderInlineStartWidth:"xpilrb4",$$css:!0},badge:{position:"x10l6tqk",insetInlineEnd:"xhu3bip",bottom:"x48lskh",zIndex:"x16uhe5s",boxSizing:"x9f619",width:"xw4jnvo",height:"x1qx5ct2",pointerEvents:"x47corl",borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",$$css:!0},chatList:{backgroundColor:"x1280gxy",$$css:!0},conversationHeader:{backgroundColor:"x1h3rtpe",$$css:!0},subgroupJoinModal:{backgroundColor:"x1280gxy",width:"x1849jeq",height:"x1gnnpzl",insetInlineEnd:"xtijo5x",left:null,right:null,bottom:"x1ey2m1c",$$css:!0},adsDataSharingIconBackground:{backgroundColor:"x1c7u0tx",$$css:!0},badgeIconSVG:{width:"x1xp8n7a",height:"xmix8c7",$$css:!0},polls:{borderTopWidth:"x178xt8z",borderInlineEndWidth:"x1lun4ml",borderBottomWidth:"xso031l",borderInlineStartWidth:"xpilrb4",borderTopStyle:"x13fuv20",borderInlineEndStyle:"x18b5jzi",borderBottomStyle:"x1q0q8m5",borderInlineStartStyle:"x1t7ytsu",$$css:!0},pollsSender:{borderTopColor:"x3ewwah",borderInlineEndColor:"xzt7qbt",borderBottomColor:"x1xnb2cf",borderInlineStartColor:"xphqdy3",$$css:!0},pollsReceiver:{borderTopColor:"xm7onvi",borderInlineEndColor:"xxy6lca",borderBottomColor:"x4728lr",borderInlineStartColor:"x4bbfdb",$$css:!0},backgroundFill:{fill:"x1flh12g",$$css:!0},primaryFill:{fill:"xvt3oi1",$$css:!0},badgeIconPathSVG:{color:"xhslqc4",$$css:!0},dataSharingIcon:{color:"xhslqc4",$$css:!0},dataSharingUpdatedStyleIcon:{color:"xrl28ub",$$css:!0},dataSharingNewStyleIcon:{backgroundColor:"x1c7u0tx",borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",color:"xhslqc4",$$css:!0},subgroupJoinModalSvgStyle:{width:"xgd8bvy",height:"x1fgtraw",$$css:!0},groupProfilePictureSticky:{position:"x7wzq59",top:"x1eu8d0j",$$css:!0}},k=100;function I(e){var t,n=e.profilePicThumbImg,a=e.spinnerClassName,i=e.spinnerXstyle,l=e.spinnerSize,s=e.imgClassName,u=e.imgXstyle,d=e.alt,m=e.onLoad,f=e.profilePicThumb,b=e.loader,v=b===void 0?!1:b,S=e.theme,L=e.loadingAnimation,I=L===void 0?!0:L,T=e.id,D=h(!1),x=D[0],$=D[1],P=h(n),N=P[0],M=P[1],w=N!=null&&o("WAWebPREGatingUtils").isPREChatMovingEnabled()?C.has(N):!1,A=h(w?!1:(T instanceof r("WAWebWid")&&(T==null?void 0:T.isBot()))!==!0),F=A[0],O=A[1],B=h(w),W=B[0],q=B[1],U=g(!!n),V=g(!1),H=S!=="business",G=r("useLazyRef")(function(){return v&&H?new(o("WAShiftTimer")).ShiftTimer(function(){$(!0)}):null}),z=y(),j=z[0],K=z[1];n!==N&&(M(n),O(!0),q(!1),$(!1));var Q=function(t){K(function(){var e;(e=G.current)==null||e.cancel(),f.markMms4HostSuccess(),O(!1),q(!0),m==null||m();var n=t.target;N!=null&&n instanceof HTMLImageElement&&n.complete&&o("WAWebPREGatingUtils").isPREChatMovingEnabled()&&C.add(N)})},X=function(t){var e;if((e=G.current)==null||e.cancel(),t instanceof o("WAWebMiscErrors").ServerStatusError)switch(t.status){case 403:f.markStale({eurl:!0}),V.current||(V.current=!0,f.validate());break;case 410:f.markStale();break;default:o("WAWebMmsClientIsErrorRetryable").isRetriableStatusCode(t.status)&&f.markMms4HostFailure();break}O(!1),q(!1)};_(function(){var e,t=G;return(e=t.current)==null||e.onOrAfter(k),function(){var e;(e=t.current)==null||e.cancel()}},[f,G]);var Y=function(){return H?!!v&&x&&F&&!(!o("WAWebStateUtils").unproxy(f).stale&&!N):!1},J=o("WAWebClassnames").classnamesConvertMeToStylexPlease((t={},t[s]=typeof s=="string",t),(c||(c=r("stylex")))(I===!1&&U.current&&E.avatarImageNoTransition,E.avatarImage,e.shape===R.Square&&E.avatarSquare,e.shape===R.Squircle&&E.avatarSquircle,!F&&E.isLoaded,e.shape!==R.Squircle&&E.profilePictureOutlineRefreshed,u)),Z,ee;Y()&&(Z=p.jsx(r("WAWebAvatarSpinner.react"),{className:a,xstyle:i,size:l})),N&&(ee=p.jsx(r("WAWebImg.react"),{src:N,hasPrivacyChecks:!0,crossOrigin:!1,className:J,draggable:!1,onLoad:Q,onError:X,alt:d}));var te=W?null:e.defaultIcon;return I===!1&&(te=ee!=null?null:e.defaultIcon),p.jsxs(p.Fragment,{children:[Z,te,ee]})}I.displayName=I.name+" [from "+i.id+"]";function T(e){var t=o("useWAWebModelValues").useModelValues(e.profilePicThumb,["imgFull"]);return p.jsx(I,babelHelpers.extends({},e,{profilePicThumbImg:t.imgFull}))}T.displayName=T.name+" [from "+i.id+"]";function D(e){var t=o("useWAWebModelValues").useModelValues(e.profilePicThumb,["img"]);return p.jsx(I,babelHelpers.extends({},e,{profilePicThumbImg:t.img}))}D.displayName=D.name+" [from "+i.id+"]";function x(e){return e==="group_profile_picture"||e==="group_profile_picture_in_bubble"?L.GroupChatProfilePicture:e==="status"?L.Status:e==="media_hub"?L.MediaHub:e==="group_status"?L.GroupStatus:null}var $=28;function P(e){if(typeof e=="string")switch(e){case v.ExtraSmall:return 40;case v.Small:return 49;case v.Medium:return 100;case v.Large:return 200;case v.Refresh:return 128;case v.None:return}else return e}function N(t){"use no forget";var n,a,i,l,u,d=t.id,m=t.size,_=t.quality,h=_===void 0?S.Low:_,y=t.loader,C=t.onClick,L=t.onLoad,k=t.quoted,I=t.shape,N=t.border,A=t.waitIdle,F=t.ephemeralIcon,O=t.checkmarkIcon,B=t.hiddenSubgroupIcon,W=t.theme,q=t.alt,U=t.xstyle,V=t.authorColor,H=t.loadPicture,G=H===void 0?!0:H,z=t.loadAnimation,j=z===void 0?!0:z,K=t.tabIndex,Q=t.ariaLabel,X=t.testId,Y=t.tabOrder,J=t.showOutline,Z=J===void 0?!1:J,ee=t.enableAdsDataSharingIcon,te=t.enableBizAiDataSharingIcon,ne=te===void 0?!1:te,re=t.groupProfilePictureSticky,oe=re===void 0?!1:re,ae=t.customDimensionsStyle,ie=ae===void 0?!1:ae,le=o("useWAWebForceUpdate").useForceUpdateDONOTUSE(),se=g(null),ue=r("WAWebUseIsKeyboardUser")(),ce=ue.isKeyboardUser,de=o("WAWebHasAcceptedBizBotTos").useHasAcceptedBizBotTos(),me=f(function(){var e=d,t=o("WAWebChatCollection").ChatCollection.get(e);if(!t&&e.isRegularUser())try{var n=e.isLid()?o("WAWebLidMigrationUtils").toPn(e):o("WAWebLidMigrationUtils").toLid(e);n&&(t=o("WAWebChatCollection").ChatCollection.get(n),t&&(e=n))}catch(e){}return{id:e,chat:t}},[d]),pe=me.id,_e=me.chat,fe;typeof m=="number"?fe=m>0?m:v.Small:fe=m!=null?m:v.Small;var ge=ie?{}:{height:(n=P(fe))!=null?n:void 0,width:(a=P(fe))!=null?a:void 0};C&&(ge.cursor="pointer");var he,ye;if(_e!=null&&(i=_e.groupMetadata)!=null&&(i=i.participants)!=null&&i.iAmMember()){if(o("WAWebChatGetters").getIsGroup(_e)){var Ce;he=(Ce=_e.groupMetadata)==null?void 0:Ce.groupType,ye=_e.groupMetadata}}else{var be=r("WAWebUnjoinedSubgroupMetadataCollection").get(pe.toString());he=be==null?void 0:be.groupType,ye=be}o("useWAWebListener").useListener(_e!=null&&o("WAWebChatGetters").getIsGroup(_e)?ye:_e,"change:ephemeralDuration",le);var ve=r("useWAWebEventTargetValue")(ye,"change:hiddenSubgroup",function(){var e;return((e=ye)==null?void 0:e.hiddenSubgroup)===!0}),Se=(c||(c=r("stylex"))).props(E.avatar,W==="status"&&E.status,I===R.Square&&E.avatarSquare,I===R.Squircle&&E.avatarSquircle,W==="group_profile_picture"&&E.groupProfilePicture,W==="group_profile_picture_in_bubble"&&E.groupProfilePictureInBubble,W==="status_profile_photo_ring"&&E.avatarProfileRingBorder,W==="invite_modal"&&E.inviteModal,(W==="polls_sender"||W==="polls_receiver")&&E.polls,W==="polls_sender"&&E.pollsSender,W==="polls_receiver"&&E.pollsReceiver,o("WAWebChatCommunityUtils").isIntegrityDeactivatedCommunity(_e)&&E.dimmed,N===!0&&E.avatarBorder,he===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&E.avatarDefaultAnnouncementGroup,C!=null&&ce&&W==="group_profile_picture"&&o("WDSFocusStateStyles").WDSFocusStateStyles.genericFocus,C!=null&&ce&&W==="chatlist_header_profile_photo"&&o("WDSFocusStateStyles").WDSFocusStateStyles.genericFocus,Z&&E.outline,W==="group_profile_picture"&&oe&&E.groupProfilePictureSticky,U),Re=babelHelpers.extends({},Se.style,ge),Le=function(t){if(r("WAWebKeyboardIsKeyActivation")(t)){var e;(e=se.current)==null||e.click()}},Ee=C!=null?{tabIndex:K,role:"button","aria-label":Q,onKeyDown:Le}:{},ke=x(W),Ie=p.jsx(w,{id:pe,quoted:k,groupType:he,theme:ke,authorColor:V,shape:t.shape});if((W==="group_profile_picture"||W==="typing_indicator"||W==="reaction_details")&&o("WAWebChatProfilePictureGatingUtils").shouldDisplayInitialsInProfilePicture(pe)){var Te=o("WAWebContactCollection").ContactCollection.get(pe);if(Te){var De=o("WAWebInitialsFromNameUtils").getInitialsFromContact(Te);(De.firstInitial!=null||De.secondInitial!=null)&&(Ie=p.jsx(o("WAWebInitialsProfilePicture.react").InitialsProfilePicture,{initialsData:De,theme:o("WAWebInitialsProfilePicture.react").ThemeType.GroupChatProfilePicture,backgroundColorId:V!=null?V:1}))}else o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[GCPP] User contact not in collection"])))}var xe=function(){var e=null,t;return G?t=o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.gadd(pe):t=o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.get(pe),t?h===S.High?e=p.jsx(T,{profilePicThumb:t,defaultIcon:Ie,loader:y,onLoad:L,alt:q,shape:I,id:pe}):e=p.jsx(D,{profilePicThumb:t,defaultIcon:Ie,loader:y,onLoad:L,alt:q,loadingAnimation:j,shape:I,id:pe}):e=Ie,p.jsxs("div",babelHelpers.extends({"data-testid":void 0,ref:se,"data-tab":Y},Ee,Se,{style:Re,onClick:C,children:[e,!r("gkx")("26258")&&(typeof m!="number"||m>=$)&&b?p.jsx(b,{id:pe}):null]}))},$e=!r("WAWebEnvironment").isWindows||A===!0?p.jsx(r("WAWebIdleComponent.react"),{id:pe,onComplex:xe,waitIdle:A,children:p.jsx("div",babelHelpers.extends({ref:se},Ee,Se,{style:Re,onClick:C,children:Ie}))}):xe();if(t.emojiBadge!=null&&o("WAWebUserPrefsMeUser").isMeAccount(pe))return p.jsxs("div",{className:"x1n2onr6","aria-label":s._(/*BTDS*/"Profile picture, text status emoji set"),children:[p.jsx("div",{className:"x10l6tqk xhu3bip x48lskh x16uhe5s x9f619 xw4jnvo x1qx5ct2 x47corl x1c9tyrk xeusxvb x1pahc9y x1ertn4p x1h3rtpe",children:t.emojiBadge}),$e]});var Pe=(l=_e==null||(u=_e.contact.businessProfile)==null?void 0:u.isBizBot1p)!=null?l:!1,Ne=de&&o("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiRowEnabled(),Me=ne&&Pe&&Ne,we=!!(F!=null&&_e&&o("WAWebChatEphemerality").isEphemeralSettingOn(_e)),Ae=ee===!0&&_e!=null&&o("WAWebCommonCTWAConsumerTransparency").shouldShowConsumerTransparencyDisclosure(_e),Fe=B!=null&&O==null&&ve;if(Me||we===!0||O||Ae||Fe){var Oe,Be=(Oe=F!=null?F:O)!=null?Oe:B;return p.jsxs("div",{className:"x1n2onr6","aria-label":s._(/*BTDS*/"Foto del perfil con mensajes temporales activados"),children:[p.jsx("div",babelHelpers.extends({},(c||(c=r("stylex"))).props(E.badge,o("WAWebUISpacing").uiPadding.all1,Be==="chat-list"&&E.chatList,Be==="conversation-header"&&E.conversationHeader,Be==="subgroup-join-modal"&&E.subgroupJoinModal,Ae&&E.adsDataSharingIconBackground),{children:p.jsx(M,{iconScheme:Be,shouldShowEphemeralIcon:we,shouldShowHiddenSubgroupIcon:Fe,shouldShowAdsDataSharingIcon:Ae,shouldShowBizAiDataSharingIcon:Me})})),$e]})}return $e}N.displayName=N.name+" [from "+i.id+"]";function M(e){var t=e.iconScheme,n=e.shouldShowAdsDataSharingIcon,r=n===void 0?!1:n,a=e.shouldShowBizAiDataSharingIcon,i=a===void 0?!1:a,l=e.shouldShowEphemeralIcon,s=l===void 0?!1:l,u=e.shouldShowHiddenSubgroupIcon,c=u===void 0?!1:u;if(i)return p.jsx(o("WAWebDoubleChevronInCircleIcon.react").DoubleChevronInCircleIcon,{iconXstyle:[E.svgSize,E.badgeIconSVG,E.dataSharingUpdatedStyleIcon]});if(r)return o("WAWebBizGatingUtils").shouldUseNewContentForConsumerDisclosure()?p.jsx(o("WAWebSingleChevronInCircleIcon.react").SingleChevronInCircleIcon,{iconXstyle:[E.svgSize,E.badgeIconSVG,E.dataSharingNewStyleIcon]}):o("WAWebCommonCTWAConsumerTransparency").shouldShowROWConsumerDisclosure()?p.jsx(o("WAWebSingleChevronInCircleIcon.react").SingleChevronInCircleIcon,{iconXstyle:[E.svgSize,E.badgeIconSVG,E.dataSharingUpdatedStyleIcon]}):p.jsx(o("WAWebDoubleChevronIcon.react").DoubleChevronIcon,{iconXstyle:[E.svgSize,E.badgeIconSVG,E.dataSharingIcon]});var d=o("WAWebMiscGatingUtils").isBlueEnabled()?o("WAWebPsaVerifiedBlueIcon.react").PsaVerifiedBlueIcon:o("WAWebPsaVerifiedIcon.react").PsaVerifiedIcon,m;return s===!0?m=o("WAWebDisappearingMessagesRefreshedIcon.react").DisappearingMessagesRefreshedIcon:c?m=o("WAWebIcVisibilityOffIcon.react").IcVisibilityOffIcon:m=d,p.jsx(m,{xstyle:E.badgeIconPathSVG,iconXstyle:[E.svgSize,E.badgeIconSVG,t==="subgroup-join-modal"&&E.subgroupJoinModalSvgStyle]})}M.displayName=M.name+" [from "+i.id+"]";function w(e){var t=e.authorColor,n=e.groupType,a=e.id,i=e.quoted,l=e.shape,s=e.theme,u=e.xstyle,c=p.jsx(o("WAWebDefaultContactRefreshedIcon.react").DefaultContactRefreshedIcon,{iconXstyle:[E.svgSize,E.circleIconRefreshed,E.profilePictureOutlineRefreshed,u],"aria-hidden":!0,innerStyles:{primary:E.primaryFill}});r("WAWebWid").isUser(a)&&!r("WAWebWid").isPSA(a)&&i?c=p.jsx(o("WAWebDefaultUserSquareIcon.react").DefaultUserSquareIcon,{iconXstyle:[E.svgSize,u],"aria-hidden":!0,innerStyles:{primary:E.primaryFill,background:E.backgroundFill}}):r("WAWebWid").isGroup(a)?n===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP?c=p.jsx(o("WAWebAnnouncementSpeakerIcon.react").AnnouncementSpeakerIcon,{iconXstyle:[E.svgSize,E.announcementSpeaker,u],directional:!0,"aria-hidden":!0}):n===o("WAWebGroupType").GroupType.COMMUNITY||l===R.Squircle?c=p.jsx(o("WAWebDefaultCommunityRefreshedIcon.react").DefaultCommunityRefreshedIcon,{iconXstyle:[E.svgSize,E.communitySquircle,E.squircleIconRefreshed,u],"aria-hidden":!0,innerStyles:{primary:E.primaryFill}}):n===o("WAWebGroupType").GroupType.LINKED_GENERAL_GROUP&&o("WAWebCommunityGatingUtils").communityGeneralChatUIEnabled()?c=p.jsx(o("WAWebCommunityGeneralChatImage.react").CommunityGeneralChatImage,{}):c=p.jsx(o("WAWebDefaultGroupRefreshedIcon.react").DefaultGroupRefreshedIcon,{iconXstyle:[E.svgSize,E.circleIconRefreshed,E.profilePictureOutlineRefreshed,u],"aria-hidden":!0,innerStyles:{primary:E.primaryFill}}):r("WAWebWid").isBroadcast(a)?c=p.jsx(o("WAWebDefaultBroadcastIcon.react").DefaultBroadcastIcon,{iconXstyle:[E.svgSize,u],"aria-hidden":!0}):r("WAWebWid").isPSA(a)?c=p.jsx(o("WAWebWaChatPsaIcon.react").WaChatPsaIcon,{iconXstyle:[E.svgSize,E.avatarDefaultPSA,u],"aria-hidden":!0}):r("WAWebWid").isNewsletter(a)&&(c=p.jsx(o("WAWebDefaultNewsletterIcon.react").DefaultNewsletterIcon,{iconXstyle:[E.svgSize,E.newsletter,u],"aria-hidden":!0,innerStyles:{primary:E.primaryFill,background:E.backgroundFill}}));var d=p.createElement("div",babelHelpers.extends({},{0:{className:"x10l6tqk x13vifvy x1o0tod x78zum5 x6s0dn4 xl56j7k xh8yej3 x5yr21d"},4:{className:"x10l6tqk x13vifvy x1o0tod x78zum5 x6s0dn4 xl56j7k xh8yej3 x5yr21d xfimr68 x1jpgh95"},2:{className:"x10l6tqk x13vifvy x1o0tod x78zum5 x6s0dn4 xl56j7k xgd8bvy x1fgtraw"},6:{className:"x10l6tqk x13vifvy x1o0tod x78zum5 x6s0dn4 xl56j7k xfimr68 x1jpgh95 xgd8bvy x1fgtraw"},1:{className:"x13vifvy x1o0tod x6s0dn4 xl56j7k xh8yej3 x5yr21d x1n2onr6 x1lliihq"},5:{className:"x13vifvy x1o0tod x6s0dn4 xl56j7k xh8yej3 x5yr21d xfimr68 x1jpgh95 x1n2onr6 x1lliihq"},3:{className:"x13vifvy x1o0tod x6s0dn4 xl56j7k xgd8bvy x1fgtraw x1n2onr6 x1lliihq"},7:{className:"x13vifvy x1o0tod x6s0dn4 xl56j7k xfimr68 x1jpgh95 xgd8bvy x1fgtraw x1n2onr6 x1lliihq"}}[(s===L.Status)<<2|(s===L.MediaHub)<<1|(s===L.GroupStatus)<<0],{key:"default"}),c),m=o("useWAWebGroupColors").useGroupsColorStyle(t!=null?t:1,"color");return s===L.GroupChatProfilePicture&&(d=p.jsx("div",{className:"x10l6tqk x13vifvy x1o0tod x78zum5 x6s0dn4 xl56j7k xh8yej3 x5yr21d",children:p.jsx(o("WAWebDefaultUserColorIcon.react").DefaultUserColorIcon,{iconXstyle:[E.svgSize,u],xstyle:m})},"default")),d}w.displayName=w.name+" [from "+i.id+"]",l.DetailImageSize=v,l.DetailImageQuality=S,l.DetailImageShape=R,l.DefaultIconThemeType=L,l.DetailImageCommon=I,l.getSize=P,l.DetailImage=N,l.ImageIcon=M,l.DefaultIcon=w}),226);
__d("WAWebFormatComponentUtils",[],(function(t,n,r,o,a,i){function e(e){var t=typeof e=="string"?[e]:[].concat(e);return typeof t[0]=="string"&&(t[0]=t[0].replace(" ","")),t}i.removeFirstLeadingSpace=e}),66);
__d("WAWebBlockQuoteMutatorComponent.react",["WABidi","WAWebCopyPasteSelectable.react","WAWebFormatComponentUtils","WAWebL10N","WAWebUISpacing","react","stylex"],(function(t,n,r,o,a,i,l){var e,s,u=e||(e=r("react")),c={quote:{display:"x1rg5ohu",position:"x1n2onr6",width:"xh8yej3",color:"xhslqc4",$$css:!0},quotedColor:{color:"x15rks2t",borderTopColor:"x1b4hy2t",borderInlineEndColor:"x1273586",borderBottomColor:"x1tnzt7h",borderInlineStartColor:"x1mi4oqr",$$css:!0}};function d(e){var t=e.children,n=t===void 0?"":t,a=e.inline,i=a===void 0?!1:a,l=e.quoted,d=l===void 0?!1:l,m=e.selectable,p=e.text,_=o("WABidi").dir(p),f=_==="rtl"!==r("WAWebL10N").isRTL(),g="> ";return i?u.jsx(o("WAWebCopyPasteSelectable.react").SelectableSpan,{dir:_,selectable:m,prePlainText:g,className:{0:"xt0psk2 x14atkfc xhslqc4 xct1zlm x1t7ytsu x19mw7rs x7phf20 xaso8d8",2:"xt0psk2 x14atkfc x15rks2t x1b4hy2t x1273586 x1tnzt7h xct1zlm x1t7ytsu x19mw7rs x7phf20 xaso8d8",1:"xt0psk2 x14atkfc xct1zlm x1t7ytsu x7phf20 xaso8d8 xhslqc4 x1if355w x18b5jzi xp93uhy x1p8j9ns x1gabggj",3:"xt0psk2 x14atkfc xct1zlm x1t7ytsu x7phf20 xaso8d8 x15rks2t x1b4hy2t x1tnzt7h x1mi4oqr x1if355w x18b5jzi xp93uhy x1p8j9ns x1gabggj"}[!!d<<1|!!f<<0],children:n}):u.jsxs(o("WAWebCopyPasteSelectable.react").SelectableBlockQuote,{dir:_,selectable:m,prePlainText:g,className:(s||(s=r("stylex")))([c.quote,d&&c.quotedColor,!d&&o("WAWebUISpacing").uiMargin.vert4]),children:[u.jsx("div",babelHelpers.extends({},{0:{className:"x10l6tqk x1o0tod x13vifvy x5yr21d x1g8rjiy x1518k6t xkqq1k2 x91jh78 x1xkn691 x4oqio7"},2:{className:"x10l6tqk x1o0tod x13vifvy x5yr21d x1g8rjiy x1518k6t xkqq1k2 x91jh78 x1xkn691 x4oqio7 xtijo5x"},1:{className:"x10l6tqk x1o0tod x13vifvy x5yr21d x1g8rjiy xkqq1k2 x91jh78 x1xkn691 x4oqio7 xtwfq29"},3:{className:"x10l6tqk x1o0tod x13vifvy x5yr21d x1g8rjiy xkqq1k2 x91jh78 x1xkn691 x4oqio7 xtijo5x xtwfq29"}}[!!f<<1|!!d<<0])),u.jsx("div",babelHelpers.extends({},{0:{className:"x1rg5ohu x1gx403c xj0a0fe xeaf4i8"},1:{className:"x1rg5ohu xj0a0fe xeaf4i8 x1c1uobl x1q3ajuy"}}[!!f<<0],{children:o("WAWebFormatComponentUtils").removeFirstLeadingSpace(n)}))]})}d.displayName=d.name+" [from "+i.id+"]",l.default=d}),98);
__d("WAWebBulletedListItemMutatorComponent.react",["WABidi","WAWebCopyPasteSelectable.react","WAWebFormatComponentUtils","WAWebL10N","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){if(!(e==null||e===""))return o("WABidi").dir(e)}function c(e){var t=u(e)==="rtl";return t!==r("WAWebL10N").isRTL()}function d(e){var t=e.children,n=t===void 0?"":t,r=e.inline,a=r===void 0?!1:r,i=e.selectable,l=e.symbol,u=e.text;if(a)return s.jsxs(o("WAWebCopyPasteSelectable.react").SelectableSpan,{selectable:i,children:["\u2022",n]});var d=l+" ";return s.jsx("li",babelHelpers.extends({dir:"auto"},{0:{className:"x1g0dm76 x1jieuv1 xo7wnuk x1gznph8 x1rkpvhg xlu7um4 xm78dhd x1r4uxqn"},1:{className:"x1jieuv1 xo7wnuk xlu7um4 xm78dhd x1r4uxqn xp4054r x1c1uobl xpdmqnj xh6kr0w xl717p"}}[!!c(u)<<0],{children:s.jsx(o("WAWebCopyPasteSelectable.react").SelectableSpan,{selectable:i,prePlainText:d,children:o("WAWebFormatComponentUtils").removeFirstLeadingSpace(n)})}))}d.displayName=d.name+" [from "+i.id+"]",l.default=d}),98);
__d("WAWebNumberedListItemMutatorComponent.react",["WABidi","WAWebCopyPasteSelectable.react","WAWebFormatComponentUtils","WAWebL10N","WAWebUISpacing","react","stylex"],(function(t,n,r,o,a,i,l){var e,s,u=e||(e=r("react")),c={dirMismatch:{textAlign:"xp4054r",listStylePosition:"x1cy9i3i",$$css:!0}};function d(e){if(!(e==null||e===""))return o("WABidi").dir(e)}function m(e){var t=d(e)==="rtl";return t!==r("WAWebL10N").isRTL()}function p(e){var t=e.children,n=t===void 0?"":t,a=e.inline,i=a===void 0?!1:a,l=e.numbering,d=e.selectable,p=e.text;if(i)return u.jsxs(o("WAWebCopyPasteSelectable.react").SelectableSpan,{selectable:d,children:[l,n]});var _=l+" ";return u.jsx("li",babelHelpers.extends({dir:"auto",value:l.replace(".","")},(s||(s=r("stylex"))).props([m(p)&&c.dirMismatch,o("WAWebUISpacing").uiPadding.start2]),{children:u.jsx(o("WAWebCopyPasteSelectable.react").SelectableSpan,{selectable:d,prePlainText:_,children:o("WAWebFormatComponentUtils").removeFirstLeadingSpace(n)})}))}p.displayName=p.name+" [from "+i.id+"]",l.default=p}),98);
__d("WAWebTextMutatorComponentUtils",["WAWebBulletedListItemMutatorComponent.react","WAWebNumberedListItemMutatorComponent.react"],(function(t,n,r,o,a,i,l){function e(e){var t=Array.isArray(e)?e:[e],n=[],o=[];for(var a of t)if(typeof a=="string"&&a.match(/^\r?\n$/)&&o.length)o.push(a);else if(a!=null&&typeof a=="object"&&(a.type===r("WAWebBulletedListItemMutatorComponent.react")||a.type===r("WAWebNumberedListItemMutatorComponent.react")))o.push(a);else{var i=a;o.length&&(n.push({isList:!0,children:o}),o=[],typeof i=="string"&&(i=i.replace(/^\r?\n/g,""))),n.push({isList:!1,children:i})}return o.length&&n.push({isList:!0,children:o}),n}l.groupListChildren=e}),98);
__d("WAWebBulletedListMutatorComponent.react",["WAWebL10N","WAWebTextMutatorComponentUtils","WAWebUISpacing","react","stylex"],(function(t,n,r,o,a,i,l){var e,s,u=e||(e=r("react")),c={ul:{wordBreak:"x13faqbe",whiteSpace:"xeaf4i8",position:"x1n2onr6",$$css:!0}};function d(e){var t=e.children,n=t===void 0?"":t,a=e.inline,i=a===void 0?!1:a,l=e.largerIndentation,d=l===void 0?!1:l,m=e.quoted,p=m===void 0?!1:m;if(i)return n;var _=[];return o("WAWebTextMutatorComponentUtils").groupListChildren(n).forEach(function(e,t){e.isList?_.push(u.jsx("ul",babelHelpers.extends({},(s||(s=r("stylex"))).props(c.ul,!p&&o("WAWebUISpacing").uiMargin.vert4,o("WAWebUISpacing").uiMargin.start18,d?o("WAWebUISpacing").uiMargin.start18:o("WAWebUISpacing").uiMargin.start8),{dir:r("WAWebL10N").isRTL()?"rtl":"ltr",children:e.children}),t)):_.push(e.children)}),_}d.displayName=d.name+" [from "+i.id+"]",l.default=d}),98);
__d("WAWebFormatFilter",[],(function(t,n,r,o,a,i){function e(e,t){if(e.length===1)return e;for(var n=[],r;r=e.pop();){for(var o=r,a=o[0],i=o[3],l=o[4],s=t[l],u=s[0],c=s[2],d=!0,m=n.length,p=m-1;p>=0;--p){var _=n[p],f=_[2],g=_[3],h=_[4];if(!(a>g)){var y=t[h],C=y[0],b=y[2];if(i>f){if(c<b&&n.splice(p,1))continue;d=!1;break}if(C.mutates&&!(d=!1))break;if(u.compatibility){u.nestable(C)||(d=!1);break}if(!(!u.nestable(C)&&!C.compatibility&&c<b&&n.splice(p,1))&&!u.compatibility&&!C.format){d=!1;break}}}d&&n.push(r)}return n}i.default=e}),66);
__d("WAWebFormatFlatten",[],(function(t,n,r,o,a,i){function e(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r){var o=e[n][r],a=o[0],i=o[1];t.push([a,i,n])}return t}i.default=e}),66);
__d("WAWebFormatMatch",[],(function(t,n,r,o,a,i){function e(e,t,n){n===void 0&&(n=1/0);for(var r=[],o=0;o<t.length;++o){for(var a=t[o],i=a[0],l=a[1],s=i.match(e,l,n),u=[],c=s.length,d=0,m=s[d];d<c;m=s[++d])u[d]=[m[0],m[1],m[2],m[3],o,m[4]];u.length&&r.push(u)}for(var p=0;p<r.length;p++){var _=t[r[p][0][4]][0].conflictResolvers;if(_)for(var f=0;f<r.length;f++){var g=t[r[f][0][4]][0],h=_.get(g);h==null||h(r[p],r[f])}}for(var y=[],C=0;C<r.length;++C)y[C]=r[C].length-1;for(var b=[],v=0;r.length;){for(var S=0,R=-1;S<r.length;++S)r[S][y[S]][0]>R&&(v=S,R=r[S][y[S]][0]);b.push(r[v][y[v]]),--y[v]<0&&(r.splice(v,1),y.splice(v,1))}return b}i.default=e}),66);
__d("WAWebFormatParse",["WAUnicodeUtils","WAWebFormatFilter","WAWebFormatFlatten","WAWebFormatMatch","WAWebFormatParseTree"],(function(t,n,r,o,a,i,l){function e(e,t,n){return n===void 0&&(n=1/0),s(e,r("WAWebFormatFlatten")(t),n)}function s(e,t,n){n===void 0&&(n=1/0);var a=r("WAWebFormatMatch")(e,t,n),i=a.length?r("WAWebFormatParseTree")(e,r("WAWebFormatFilter")(a,t),t):{children:[{type:"text",value:e}]},l=o("WAUnicodeUtils").numCodepoints(e);return n<l&&u(i,{limit:n}),i}function u(e,t){if(!(t.limit<=0)){if(e.type&&e.type==="text"){if(e.value.length>=t.limit){var n=o("WAUnicodeUtils").toArray(e.value);n.length>=t.limit&&(n=n.slice(0,t.limit)),e.value=n.join(""),t.limit-=n.length}else t.limit-=e.value.length;return}else if(e.type&&e.type==="delimiter")return;for(var r=0;r<e.children.length&&(u(e.children[r],t),!(t.limit<=0));)r++;e.children=e.children.slice(0,r+1)}}l.parse=e,l._parse=s}),98);
__d("WAWebFormatParseTree",["WAWebFormatParse"],(function(t,n,r,o,a,i,l){function e(e,t,n){for(var r={children:[]},a=0,i=r,l=0,u=0;u<t.length;++u){for(var c=t[u],d=c[0],m=c[1];i.parent&&d>(l=i.match[2]);){if(a<=l&&i.children.push({type:"text",value:e.substring(a,l+1)}),a=i.match[3]+1,i.mutator.fragment){var p=i.parent.children;p.pop(),p.push.apply(p,i.children)}l!==i.match[3]&&i.parent.children.push({type:"delimiter",value:e.substring(l+1,a)}),i=i.parent}a<d&&i.children.push({type:"text",value:e.substring(a,d)});var _=n[c[4]],f=_[0],g=_[1],h=f.mutates;a=m,d!==m&&i.children.push({type:"delimiter",value:e.substring(d,m)});var y={children:[],match:c,mutator:f,opts:g,parent:i};if(h){var C=e.substring(c[1],c[2]+1),b=f.mutate(C,c[5]),v=s(f,n,y),S=o("WAWebFormatParse")._parse(b,v);y.children=S.children,a=c[2]+1}i.children.push(y),i=y}do if(i.match){var R=i.match,L=R[2],E=R[3];if(a<=L&&i.children.push({type:"text",value:e.substring(a,L+1)}),a=E+1,i.mutator.fragment){var k=i.parent.children;k.pop(),k.push.apply(k,i.children)}L!==E&&i.parent.children.push({type:"delimiter",value:e.substring(L+1,a)})}while(i.parent&&(i=i.parent)&&i.parent);return a!==e.length&&i.children.push({type:"text",value:e.substring(a)}),r}function s(e,t,n){for(var r=e.format,o=[],a=u(n),i=0;i<t.length;++i)!r&&!t[i][0].compatibility||a.includes(t[i][0])||o.push(t[i]);return o}function u(e){var t=e,n=[];do t.mutator&&n.push(t.mutator);while(t.parent&&(t=t.parent));return n}l.default=e}),98);
__d("WAWebFormatSerialize",["err"],(function(t,n,r,o,a,i,l){function e(e,t,n){return e.onRoot(u(e,t.children,n),n)}function s(e,t,n){if(t.type){var o=t.value;switch(t.type){case"text":return e.onText(o,n);case"delimiter":return e.onDelimiter(o,n);default:throw r("err")("Invalid node type")}}return e.onMutator(t.mutator,u(e,t.children,n),t.match[5],t.opts,n)}function u(e,t,n){return t.reduce(function(t,r){return t.push(s(e,r,n)),t},[])}l.default=e}),98);
__d("WAWebFormat",["WAWebFormatParse","WAWebFormatSerialize"],(function(t,n,r,o,a,i,l){function e(e,t,n,a,i){return i===void 0&&(i=1/0),r("WAWebFormatSerialize")(n,o("WAWebFormatParse").parse(e,t,i),a)}l.default=e}),98);
__d("WAWebFormatSerializer",["err"],(function(t,n,r,o,a,i,l){var e=(function(){function e(){}return e.onMutator=function(t,n,o,a,i){throw r("err")("Subclasses of `Serializer` must override `onMutator()`")},e.onRoot=function(t,n){throw r("err")("Subclasses of `Serializer` must override `onRoot()`")},e.onText=function(t,n){throw r("err")("Subclasses of `Serializer` must override `onText()`")},e.onDelimiter=function(t,n){throw r("err")("Subclasses of `Serializer` must override `onDelimiter()`")},e})();l.default=e}),98);
__d("WAWebJsxTextSerializer",[],(function(t,n,r,o,a,i){function e(e){return e}i.default=e}),66);
__d("WAWebNumberedListMutatorComponent.react",["WAWebL10N","WAWebTextMutatorComponentUtils","WAWebUISpacing","react","stylex"],(function(t,n,r,o,a,i,l){var e,s,u=e||(e=r("react")),c={ol:{wordBreak:"x13faqbe",whiteSpace:"xeaf4i8",position:"x1n2onr6",listStyleType:"x3yw8vx",$$css:!0}};function d(e){var t=e.children,n=t===void 0?"":t,a=e.inline,i=a===void 0?!1:a,l=e.largerIndentation,d=l===void 0?!1:l,m=e.quoted,p=m===void 0?!1:m;if(i)return n;var _=[];return o("WAWebTextMutatorComponentUtils").groupListChildren(n).forEach(function(e,t){e.isList?_.push(u.jsx("ol",babelHelpers.extends({},(s||(s=r("stylex"))).props(c.ol,o("WAWebUISpacing").uiMargin.start30,!p&&o("WAWebUISpacing").uiMargin.vert4,d?o("WAWebUISpacing").uiMargin.start30:o("WAWebUISpacing").uiMargin.start20),{dir:r("WAWebL10N").isRTL()?"rtl":"ltr",children:e.children}),t)):_.push(e.children)}),_}d.displayName=d.name+" [from "+i.id+"]",d.displayName="NumberedList",l.default=d}),98);
__d("WAWebJsxSerializer.react",["WAWebBulletedListMutatorComponent.react","WAWebFormatSerializer","WAWebJsxTextSerializer","WAWebNumberedListMutatorComponent.react","react"],(function(t,n,r,o,a,i,l){var e,s=(e||(e=o("react"))).cloneElement,u=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(r("WAWebFormatSerializer"));u.onText=r("WAWebJsxTextSerializer"),u.onDelimiter=function(e){},u.onRoot=function(e){return d(e),c(e)},u.onMutator=function(e,t,n,r){return e.jsx(c(t),n,r)};function c(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];if(r!==void 0){if(typeof r=="string"){t.push(r);continue}var o="jsx-child-"+n;t.push(s(r,{key:o}))}}return t}function d(e){var t=-1;for(var n of e){var o;if((n==null?void 0:n.type)===r("WAWebNumberedListMutatorComponent.react")){var a=n==null||(o=n.props)==null?void 0:o.children;if(Array.isArray(a))for(var i of a){var l,u=i==null||(l=i.props)==null?void 0:l.numbering;u!=null&&(t=Math.max(t,parseInt(u,10)))}}}if(t>=10)for(var c=0;c<e.length;c++){var d=e[c];(d==null?void 0:d.type)!==r("WAWebNumberedListMutatorComponent.react")&&(d==null?void 0:d.type)!==r("WAWebBulletedListMutatorComponent.react")||(e[c]=s(d,{largerIndentation:!0}))}}l.default=u}),98);
__d("WAWebHocComponent_DEPRECATED.react",["WANullthrows","react"],(function(t,n,r,o,a,i,l){var e,s=(e||(e=o("react"))).Component;function u(e){if(typeof e=="string")return e;if(!e)return"Component";var t=e.displayName;if(t!=null&&t!=="")return t;var n=e.name;return n!=null&&n!==""?n:"Component"}var c=(function(e){function t(t){var n;return n=e.call(this,t)||this,n.setComponent=function(e){n.component=e},n.state=babelHelpers.extends({},n.state),n}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getComponent=function(){return this.component instanceof t?this.component.getComponent():r("WANullthrows")(this.component)},t})(s);l.getHocComponentDisplayName=u,l.WrappedComponent=c}),98);
__d("WAWebListenerHoc_DEPRECATED",["WAAbortError","WALogger","WAWebCmd","WAWebDocumentFlushed","WAWebHocComponent_DEPRECATED.react","WAWebUIListener","react"],(function(t,n,r,o,a,i,l){var e,s,u=s||(s=r("react")),c=(function(){function t(){var e=this;this._mounted=!1,this._unmounted=!1,this._listeners=new Set,this._remove=function(t){t.disengage(),e._listeners.delete(t)}}var n=t.prototype;return n._add=function(n){if(this._unmounted){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Listener added after unmounting"])));return}this._listeners.add(n),this._mounted&&n.engage()},n.internalUseOnlyMarkMounted=function(){this._mounted=!0,this._listeners.forEach(function(e){e.engage()})},n.internalUseOnlyMarkUnmounted=function(){this._unmounted=!0,this._listeners.forEach(this._remove),this._abortController&&this._abortController.abort()},n.add=function(t,n,r,a){var e=this,i=new(o("WAWebUIListener")).Listener(t,n,function(){e._unmounted||r.apply(this,arguments)},a,r);this._add(i)},n.addOnce=function(t,n,r,a){var e=this,i=new(o("WAWebUIListener")).Listener(t,n,function(){e._remove(i),e._unmounted||r.apply(this,arguments)},a,r);this._add(i)},n.remove=function(t,n,r,o){var e=this;this._listeners.forEach(function(a){a.represents(t,n,r,o)&&e._remove(a)})},n.uiIdle=function(t){if(o("WAWebCmd").Cmd.uiBusy){this.addOnce(o("WAWebCmd").Cmd,"ui_idle",t);return}this._abortController=this._abortController||new AbortController,o("WAWebDocumentFlushed").documentFlushed({signal:this._abortController.signal}).then(function(){t()},function(e){if(e.name!==o("WAAbortError").ABORT_ERROR)throw e})},n.testsOnlyGetListeners=function(){return this._listeners},t})();function d(e){var t,n;return t=(function(t){function n(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,e.listeners=new c,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(n,t);var r=n.prototype;return r.componentDidMount=function(){this.listeners.internalUseOnlyMarkMounted()},r.componentWillUnmount=function(){this.listeners.internalUseOnlyMarkUnmounted()},r.render=function(){return u.jsx(e,babelHelpers.extends({ref:this.setComponent},this.props,{listeners:this.listeners}))},n})(o("WAWebHocComponent_DEPRECATED.react").WrappedComponent),t.defaultProps=(n=e.defaultProps)!=null?n:void 0,t.displayName="Listener("+o("WAWebHocComponent_DEPRECATED.react").getHocComponentDisplayName(e)+")",t.wrappedComponent=null,t}l.Listeners=c,l.ListenerHOC=d}),98);
__d("WAWebEmojiText.react",["WABidi","WANullthrows","WAWebBlockQuoteMutatorComponent.react","WAWebBulletedListMutatorComponent.react","WAWebClassnames","WAWebCopyPasteSelectable.react","WAWebDebounce","WAWebEmoji","WAWebFormat","WAWebFormatConfiguration","WAWebJsxSerializer.react","WAWebL10N","WAWebListenerHoc_DEPRECATED","WAWebNonEmptyString","WAWebNumberedListMutatorComponent.react","WAWebUA","react","stylex"],(function(t,n,r,o,a,i,l){var e,s,u,c=u||(u=o("react")),d=e||(e=r("react")),m=c.PureComponent,p=c.createRef,_=[r("WAWebBulletedListMutatorComponent.react"),r("WAWebNumberedListMutatorComponent.react"),r("WAWebBlockQuoteMutatorComponent.react")],f={breakWord:{wordBreak:"x13faqbe",$$css:!0},clickable:{cursor:"x1ypdohk",":hover_textDecoration":"xt0b8zv",$$css:!0},dirMismatch:{display:"x1lliihq",width:"xh8yej3",$$css:!0},ellipsify:{flexGrow:"x1iyjqo2",overflowX:"x6ikm8r",overflowY:"x10wlt62",position:"x1n2onr6",textOverflow:"xlyipyv",whiteSpace:"xuxw1ft",$$css:!0},inlineblock:{display:"x1rg5ohu",$$css:!0},displayBlock:{display:"x1lliihq",$$css:!0},multiline:{whiteSpace:"x1fj9vlw",$$css:!0},preserveWhitespace:{whiteSpace:"x126k92a",$$css:!0},preformatted:{whiteSpace:"x1sdyfia",width:"xm6i5cn",display:"x1rg5ohu",$$css:!0}},g={SMALL:"SMALL",LARGE:"LARGE"},h=4096,y=12;function C(e){return o("WAWebEmoji").EmojiUtil.containsEmoji(e.substring(0,h))}var b=(function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a))||this,t.state={text:String(t.props.text||""),ellipsified:null},t.refContainer=p(),t.$1=!1,t.$2=r("WAWebDebounce")(function(){t.setState({ellipsified:null},t.ellipsify)},10),t.$3=function(e){var t=[],n=r("WAWebL10N").LR("ltr","rtl"),a=function(t){var e;if(t==null)return n;if(typeof t=="string"){var r;return(r=o("WABidi").dir(t))!=null?r:n}return a(t==null||(e=t.props)==null||(e=e.children)==null?void 0:e[0])},i=[],l=function(){i.length!==0&&(t.push({dir:a(i[0]),content:i}),i=[])};for(var s of e)if(typeof s=="string"){var u=s.split(/(\r?\n)/);u.forEach(function(e){e!==""&&i.push(e),e.match(/\r?\n/)&&l()})}else _.includes(s.type)?(l(),t.push({dir:n,content:[s]})):i.push(s);return l(),t},t.ellipsify=function(){var e=t.refContainer.current;if(e){var n=r("WANullthrows")(e.parentElement),a=e.querySelectorAll("img");if(a.length){var i=e.clientWidth;e.style.overflow="visible";var l=e.clientWidth!==i;if(e.style.overflow="hidden",!!l){var s=!!r("WAWebL10N").isRTL()==!!t.props.dirMismatch,u=s?n.clientWidth-k(n,e)-y:y,c=L(a,u,s),d=a[c];t.setState({ellipsified:o("WAWebNonEmptyString").asMaybeNonEmptyString(R(e,d))})}}}},t.$4=function(){return C(t.state.text)&&t.ellipsify()},t.$5=function(e,n){var o=t.props.direction,a=t.$3(e);return a.map(function(e,t){var i=o==null||e.dir===o||e.dir==="rtl"===r("WAWebL10N").isRTL(),l=i?null:e.dir,s=a.length-1===t,u={0:"",2:"x1lliihq xh8yej3",1:"x1lliihq",3:"xh8yej3 x1lliihq"}[!i<<1|!!(!s&&i)<<0];return d.jsxs("span",{dir:l,className:u,children:[e.content,s&&n?String.fromCodePoint(8230):null]},t)})},t.$6=function(){t.$1||(t.$1=!0,t.props.listeners.add(window,"resize",t.$2))},t.componentDidMount=function(){!o("WAWebUA").UA.supportsEmojiEllipsification&&t.props.ellipsify&&C(t.state.text)&&t.$6(),!(o("WAWebUA").UA.supportsEmojiEllipsification||!t.props.ellipsify)&&t.$4()},t.$7=function(){t.$1&&(t.$1=!1,t.props.listeners.remove(window,"resize",t.$2))},t.render=function(){var e,n,a;if(!t.state.text)return null;var i=t.props,l=i.onClick,u=i.ellipsify,c=i.dirMismatch,m=i.inferLinesDirection,p=i.inlineblock,_=i.direction,g=i.textLimit,y=i.multiline,C=i.preserveWhitespace,b=i.preformatted,v=i.breakWord,S=i.emojiXstyle,R=i.displayBlock,L=t.state.ellipsified!=null?t.state.ellipsified:t.state.text,E=_==="inherit"?null:_||"auto",k=!!t.props.selectable,I=t.props.formatters||o("WAWebFormatConfiguration").EmojiOnly({selectable:k,emojiXstyle:S}),T=g||1/0;u&&L.length>h&&T>h&&(T=h);var D=c===!0&&!m,x=o("WAWebClassnames").classnamesConvertMeToStylexPlease(t.props.className,(s||(s=r("stylex")))(u&&f.ellipsify,p&&f.inlineblock,R&&f.displayBlock,l&&f.clickable,D&&f.dirMismatch,y&&f.multiline,C===!0&&f.preserveWhitespace,b===!0&&f.preformatted,v&&f.breakWord,t.props.xstyle)),$=L,P=r("WAWebFormat")($,I,r("WAWebJsxSerializer.react"),void 0,T),N=t.state.ellipsified!=null||L.length>T,M=t.props.inferLinesDirection?t.$5(P,N):P,w=(e=t.props.title)!=null?e:t.state.text;return d.jsx(o("WAWebCopyPasteSelectable.react").Selectable,{"data-testid":void 0,className:x,dir:E,element:t.props.element,onClick:l,ref:t.refContainer,selectable:k,"aria-label":(n=t.props.ariaLabel)!=null?n:void 0,title:t.props.titlify?w:void 0,style:{minHeight:((a=t.props.minTextHeight)!=null?a:0)+"px"},children:M})},babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getElement=function(){return this.refContainer.current},t.getDerivedStateFromProps=function(t,n){var e,r=null,a=String((e=t.text)!=null?e:"");return a!==n.text&&(r={text:a}),o("WAWebUA").UA.supportsEmojiEllipsification||!t.ellipsify||r==null||C(a)||(r=babelHelpers.extends({},r,{ellipsified:null})),r},n.getWidth=function(){var e=this.refContainer.current;return e?e.getBoundingClientRect().width:0},n.componentDidUpdate=function(t,n){o("WAWebUA").UA.supportsEmojiEllipsification||!this.props.ellipsify||n.text===this.state.text||(C(this.state.text)?(this.$2(),this.$6()):this.$7())},n.componentWillUnmount=function(){this.$2.cancel()},t})(m);b.defaultProps={element:"span",emojiSize:g.SMALL,textLimit:1/0};var v=o("WAWebListenerHoc_DEPRECATED").ListenerHOC(b),S=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.getElement=function(){return t.getComponent().getElement()},babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getWidth=function(){return this.getComponent().getWidth()},t})(v);function R(e,t,n){if(n===void 0&&(n={found:!1}),e===t)return n.found=!0,"";if(e instanceof HTMLImageElement)return e.alt;if(e.nodeType===Node.TEXT_NODE)return e.nodeValue;for(var r=E(e),o="",a=0;a<e.childNodes.length&&(o+=R(e.childNodes[a],t,n),!n.found);)a++;if(r==null)return o;var i=r[0],l=r[1];return""+i+o+l}function L(e,t,n){for(var r=0;r<e.length;){var o=e[r];if(n&&o.offsetLeft+o.clientWidth>=t||!n&&o.offsetLeft<=t)break;r++}return r}function E(e){if(e instanceof Element)switch(e.tagName){case"CODE":return["```","```"];case"STRONG":return["*","*"];case"EM":return["_","_"];case"DEL":return["~","~"];case"LI":return["* ",""];default:return null}return null}function k(e,t){for(var n=0,r=e.childNodes,o=0;o<r.length;o++){var a=r[o];if(a===t)break;n+=a instanceof Element?a.clientWidth:0}return n}l.EMOJI_SIZE=g,l.EmojiText=S}),98);
__d("WAWebLockScreenResolver",["WAComms","WALogger","WAResolvable","WAWebChatCollection","WAWebCmd","WAWebCryptoEncKeyHelper","WAWebDbEncryptionKey","WAWebModalManager","WAWebMsgCollection","WAWebUserPrefsInfoStore","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=(function(){function e(){this.deferred=new(o("WAResolvable")).Resolvable}var t=e.prototype;return t.waitForPasscode=function(){var e;return o("WAWebCmd").Cmd.openLockScreenModal(),(e=this.deferred)==null?void 0:e.promise},t.waitForPasscodeAfterIncorrectAttempt=function(){var e;return this.deferred=new(o("WAResolvable")).Resolvable,o("WAWebCmd").Cmd.incorrectPasscodeLockScreen(),(e=this.deferred)==null?void 0:e.promise},t.enterPasscode=function(t){this.deferred.resolve(t)},t.correctPasscodeEntered=function(t){this.deferred=new(o("WAResolvable")).Resolvable,o("WAWebCmd").Cmd.correctPasscodeLockScreen(t),o("WAWebModalManager").ModalManager.close()},e})(),u=new s;function c(){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebUserPrefsInfoStore").waNoiseInfo.cachedPasscodeDerivedKey==null){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[screeen-lock] passcode derived key is null when trying to encrypt"]))).sendLogs("[screeen-lock] passcode derived key is null when trying to encrypt"),location.reload();return}var t=o("WAComms").getComms();if(t==null){location.reload();return}var n=o("WAWebChatCollection").ChatCollection.getActive();if(n&&o("WAWebCmd").Cmd.closeChat(n),yield o("WAWebMsgCollection").MsgCollection.encryptAndClearModels(),o("WAWebUserPrefsInfoStore").waNoiseInfo.resetCachedPasscodeDerivedKey(),o("WAWebDbEncryptionKey").DbEncKeyStore.deleteKeyCache(),o("WAWebDbEncryptionKey").DbEncKeyStore.resetDB(),t.softCloseSocket)t.softCloseSocket();else{location.reload();return}yield o("WAWebCryptoEncKeyHelper").initEncSalt(),t.socketLoop.start()}),d.apply(this,arguments)}l.LockScreenResolvable=u,l.lockScreenAndTriggerUnlockFlow=c}),98);
__d("WAWebChatAssignmentIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="chat-assignment";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=16,R=20;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 20 16",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{d:"M12.7 7.9998C14.7 7.9998 16.3 6.3998 16.3 4.3998C16.3 2.3998 14.7 0.799805 12.7 0.799805C10.7 0.799805 9.1 2.3998 9.1 4.3998C9.1 6.3998 10.7 7.9998 12.7 7.9998ZM12.7 9.7998C10.3 9.7998 5.5 10.9998 5.5 13.3998V15.1998H20V13.3998C19.9 10.9998 15.1 9.7998 12.7 9.7998Z",fill:"currentColor"}),c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.09961 8.06427H0.0996094V6.25781H7.09961V8.06427Z",fill:"currentColor"}),c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.85521 7.11619L3.51172 4.7727L4.77368 3.51074L8.37912 7.11619L4.77368 10.7216L3.51172 9.45968L5.85521 7.11619Z",fill:"currentColor"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.ChatAssignmentIcon=m}),98);
__d("WAWebSvgButton.react",["WAWebUnstyledButton.react","WDSFocusStateStyles","react"],(function(t,n,r,o,a,i,l){var e=["ref"],s=["Icon","disabled","onClick","type","title","aria-label","aria-haspopup","aria-expanded","dataTab","className_DONOTUSE","xstyle","testid","tabIndex"],u,c=u||(u=r("react")),d={disabled:{opacity:"x5dmra7",$$css:!0}};function m(t){var n=t.ref,a=babelHelpers.objectWithoutPropertiesLoose(t,e),i=a.Icon,l=a.disabled,u=a.onClick,m=a.type,p=a.title,_=a["aria-label"],f=a["aria-haspopup"],g=a["aria-expanded"],h=a.dataTab,y=a.className_DONOTUSE,C=a.xstyle,b=a.testid,v=a.tabIndex,S=babelHelpers.objectWithoutPropertiesLoose(a,s);return c.jsx(r("WAWebUnstyledButton.react"),{ref:n,xstyle:[C,o("WDSFocusStateStyles").WDSFocusStateStyles.genericFocus],disabled:l,onClick:u,"aria-label":_,"aria-haspopup":f,"aria-expanded":g,title:p,dataTab:h,className_DONOTUSE:y,type:m,testid:void 0,tabIndex:v,children:c.jsx(i,babelHelpers.extends({},S,{xstyle:l===!0&&d.disabled}))})}m.displayName=m.name+" [from "+i.id+"]",l.default=m}),98);
__d("WAWebName.react",["fbt","WAArrayMoveToFirst","WALogger","WAReplaceRepeatingWhitespace","WAWebABProps","WAWebBusinessProfileTypes","WAWebChatAssignmentIcon.react","WAWebChatContactUtils","WAWebChatGetters","WAWebClassnames","WAWebContactGetters","WAWebElevatedPushNamesFlag","WAWebEmojiText.react","WAWebErrorBoundary.react","WAWebFormatConfiguration","WAWebFrontendChatGetters","WAWebFrontendContactGetters","WAWebGroupMetadataCollection","WAWebGroupType","WAWebLabels.react","WAWebLidMigrationUtils","WAWebMiscGatingUtils","WAWebNewsletterName.react","WAWebParticipantListUtils","WAWebPsaVerifiedBlueIcon.react","WAWebPsaVerifiedIcon.react","WAWebSvgButton.react","WAWebUISpacing","WAWebUserPrefsMeUser","WAWebWamEnumOppositeVisibleIdentificationType","cr:17281","react","stylex","useWAWebChatValues","useWAWebContactValues","useWAWebForceUpdate","useWAWebListener","useWAWebModelValues"],(function(t,n,r,o,a,i,l,s){var e=["chat","selectable"],u=["chat","selectable"],c=["chat"],d=["contact"],m,p,_,f=p||(p=r("react")),g={spaceBefore:{"::before_content":"xjuopq5","::before_whiteSpace":"xulcptl",$$css:!0},chatAssignmentIconAssignedToYou:{color:"x29oog3",$$css:!0},chatAssignmentIconAssignedToOthers:{color:"xms21op",$$css:!0},icon:{display:"x78zum5",flex:"x3psx0u",verticalAlign:"x16dsc37",$$css:!0},labels:{display:"x3nfvp2",alignItems:"x6s0dn4",height:"x5yr21d",color:"x1eqw3am",verticalAlign:"x16dsc37",$$css:!0},hasLabels:{display:"x1jfb8zj",overflowX:"xuce83p",overflowY:"x1bft6iq",textOverflow:"x1i7k8ik",whiteSpace:"xq9mrsl",marginInlineEnd:"x11t971q",$$css:!0}},h=function(t){var e=t.contact,n=t.showNotifyName,r=t.elevatedPushNamesEnabled,a=t.useLiftMeUp,i=t.useDisplayName,l=t.useShortName,u=t.useVerifiedName,c=t.you,d=t.showMessageYourselfName,m=t.isUsernameContact,p=r&&o("WAWebElevatedPushNamesFlag").pushNameCanBeUsed(e);if(d&&o("WAWebContactGetters").getIsMe(e)){var _;return{displayName:s._(/*BTDS*/"{nameOrPhoneNumber}",[s._param("nameOrPhoneNumber",u?e.verifiedName:(_=e.name)!=null?_:o("WAWebFrontendContactGetters").getFormattedUsernameOrPhone(e))])}}var f=o("WAWebFrontendContactGetters").getDisplayName(e),g=o("WAWebContactGetters").getPushname(e);if(i&&f){var h=o("WAWebFrontendContactGetters").getDisplayNameType(e);return h===o("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.PHONE_NUMBER&&a&&g!=null?{displayName:"~"+g}:{displayName:f}}if(l&&!p){var y=o("WAWebFrontendContactGetters").getFormattedShortName(e);if(y)return{displayName:y}}if(r&&g&&m)return{displayName:"~"+g};if(u&&e.verifiedName)return{displayName:e.verifiedName};if(c&&o("WAWebContactGetters").getIsMe(e))return{displayName:o("WAWebFrontendContactGetters").getFormattedName(e)};if(n&&p){var C=o("WAWebContactGetters").getNotifyName(e);if(C!=null)return{displayName:r?o("WAWebChatContactUtils").getFormattedNotifyName(C):"~"+C,displayNameAriaLabel:o("WAWebABProps").getABPropConfigValue("elevated_push_names_v2_m2_enabled")?o("WAWebChatContactUtils").getAccessibleNotifyName(C):void 0}}if(!a)return{displayName:o("WAWebFrontendContactGetters").getFormattedUser(e)};var b=o("WAWebFrontendContactGetters").getFormattedUserAndType(e).type;return b===o("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.PHONE_NUMBER&&g!=null?{displayName:e.verifiedName}:o("WAWebContactGetters").getIsBusiness(e)&&e.verifiedLevel===o("WAWebBusinessProfileTypes").VERIFIED_LEVEL.HIGH?{displayName:e.verifiedName}:{displayName:"~"+g}},y=function(t){var e=o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().getDeviceId(),n;if(t.some(function(t){return t.deviceId===e})){var r=s._(/*BTDS*/"Asignado a ti");n=f.jsx(o("WAWebChatAssignmentIcon.react").ChatAssignmentIcon,{width:18,height:12,xstyle:[o("WAWebUISpacing").uiMargin.end4,g.chatAssignmentIconAssignedToYou],title:r})}else if(t.length>0){var a=s._(/*BTDS*/"Asignado a {agentName}",[s._param("agentName",t[0].name)]);n=f.jsx(o("WAWebChatAssignmentIcon.react").ChatAssignmentIcon,{width:18,height:12,xstyle:[o("WAWebUISpacing").uiMargin.end4,g.chatAssignmentIconAssignedToOthers],title:a})}else n=null;return n};function C(e){var t=e.contact,a=e.element,i=a===void 0?"span":a,l=e.highlightText,u=e.titlify,c=e.ellipsify,d=e.breakWord,p=e.you,C=p===void 0?!1:p,b=e.selectable,v=e.useShortName,S=v===void 0?!1:v,R=e.useDisplayName,L=R===void 0?!1:R,E=e.onClick,k=e.showLabelIcon,I=k===void 0?!1:k,T=e.showBusinessCheckmark,D=e.showNotifyName,x=D===void 0?!1:D,$=e.elevatedPushNamesEnabled,P=$===void 0?!1:$,N=e.useLiftMeUp,M=N===void 0?!1:N,w=e.useVerifiedName,A=w===void 0?!1:w,F=e.firstLabel,O=e.xstyle,B=e.showChatAssignmentIcon,W=B===void 0?!1:B,q=e.assignedAgents,U=q===void 0?[]:q,V=e.skipCheckMark,H=V===void 0?!1:V,G=e.showMessageYourselfName,z=G===void 0?!1:G,j=e.testid,K=e.isVerifiedNewsletter,Q=e.makeCheckmarkClickable,X=Q===void 0?!1:Q,Y=e.checkmarkLarge,J=Y===void 0?!1:Y,Z=e.truncateName,ee=e.emojiXstyle,te=e.containerXstyle,ne=o("useWAWebContactValues").useContactValues(t.id,[o("WAWebContactGetters").getIsPSA,o("WAWebContactGetters").getIsIAS,o("WAWebContactGetters").getIsCAPISupportAccount,o("WAWebFrontendContactGetters").getFormattedUser,o("WAWebFrontendContactGetters").getFormattedName,o("WAWebFrontendContactGetters").getFormattedShortName,o("WAWebFrontendContactGetters").getFormattedUsernameOrPhone,o("WAWebFrontendContactGetters").getDisplayName,o("WAWebContactGetters").getLabels,o("WAWebContactGetters").getName,o("WAWebContactGetters").getNotifyName,o("WAWebContactGetters").getIsMe,o("WAWebContactGetters").getVerifiedName,o("WAWebContactGetters").getId,o("WAWebFrontendContactGetters").getIsUsernameContact]),re=ne[0],oe=ne[1],ae=ne[2],ie=ne[3],le=ne[4],se=ne[5],ue=ne[6],ce=ne[7],de=ne[8],me=ne[9],pe=ne[10],_e=ne[11],fe=ne[12],ge=ne[13],he=ne[14],ye;l!=null&&l!==""&&(ye=o("WAWebFormatConfiguration").SearchName({terms:[l]}));var Ce=h({contact:t,showNotifyName:x,elevatedPushNamesEnabled:P,useLiftMeUp:M,useDisplayName:L,useShortName:S,useVerifiedName:A,you:C,showMessageYourselfName:z,isUsernameContact:he}),be=Ce.displayName,ve=Ce.displayNameAriaLabel;if(!be)return o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["displayName:",",\n               formattedName:",",\n               name:",",\n               formattedShortName:",",\n               formattedUser:",""])),be,le,me,se,ie).sendLogs("display name is null or undefined"),"";var Se=o("WAWebLidMigrationUtils").getShouldShowLidDebugUI(ge)&&n("cr:17281"),Re=r("WAReplaceRepeatingWhitespace")(be.toString()),Le=f.jsxs("div",babelHelpers.extends({},{0:{className:"x78zum5"},1:{className:"xuxw1ft x6ikm8r x10wlt62 xlyipyv x78zum5"}}[(Z===!0)<<0],{children:[f.jsx(o("WAWebEmojiText.react").EmojiText,{text:Re,ariaLabel:ve!=null?r("WAReplaceRepeatingWhitespace")(ve.toString()):void 0,element:i,className:o("WAWebClassnames").classnamesConvertMeToStylexPlease(null,e.className),formatters:ye,titlify:u,ellipsify:c,breakWord:d,direction:"auto",selectable:b,inlineblock:!0,onClick:E,xstyle:O,testid:void 0,emojiXstyle:ee}),z&&f.jsx(o("WAWebEmojiText.react").EmojiText,{emojiXstyle:ee,testid:void 0,text:s._(/*BTDS*/"(T\u00fa)"),xstyle:g.spaceBefore}),Se&&n("cr:17281")&&f.jsx(n("cr:17281"),{})]})),Ee=e.labels||de;Ee!=null&&Ee.length&&F!=null&&r("WAArrayMoveToFirst")(Ee,F);var ke=I===!0&&Ee!=null&&Ee.length?f.jsx(o("WAWebLabels.react").Labels,{labels:Ee,showName:!1,iconXstyle:o("WAWebUISpacing").uiPadding.start4}):null,Ie=!H&&(re||oe||ae||!!T||K),Te=W?y(U):null;if(Ie===!0){var De;if(o("WAWebMiscGatingUtils").isBlueEnabled()){var xe=J?24:16;De=X&&E?f.jsx(r("WAWebSvgButton.react"),{height:xe,width:xe,Icon:o("WAWebPsaVerifiedBlueIcon.react").PsaVerifiedBlueIcon,"aria-label":s._(/*BTDS*/"Informaci\u00f3n verificada"),onClick:E}):f.jsx(o("WAWebPsaVerifiedBlueIcon.react").PsaVerifiedBlueIcon,{height:xe,width:xe})}else De=f.jsx(o("WAWebPsaVerifiedIcon.react").PsaVerifiedIcon,{});return f.jsxs("div",babelHelpers.extends({},(_||(_=r("stylex"))).props(o("WAWebNewsletterName.react").styles.verified),{children:[Le,f.jsx("div",babelHelpers.extends({},_.props(K===!0?o("WAWebNewsletterName.react").styles.newsletterIcon:[g.icon,o("WAWebUISpacing").uiMargin.top1,o("WAWebUISpacing").uiMargin.start3]),{children:De})),f.jsxs("div",{className:"x3nfvp2 x6s0dn4 x5yr21d x1eqw3am x16dsc37",children:[Te,ke]})]}))}return Te||ke?f.jsxs("div",babelHelpers.extends({},(_||(_=r("stylex"))).props(o("WAWebNewsletterName.react").styles.verified),{children:[Le,f.jsxs("div",{className:"x3nfvp2 x6s0dn4 x5yr21d x1eqw3am x16dsc37",children:[Te,ke]})]})):f.jsx("div",babelHelpers.extends({},(_||(_=r("stylex"))).props(o("WAWebNewsletterName.react").styles.verified,te),{children:Le}))}C.displayName=C.name+" [from "+i.id+"]";function b(e){"use no forget";var t,a=e.chat,i=e.element,l=e.highlightText,u=e.titlify,c=e.ellipsify,d=e.breakWord,m=e.onClick,p=e.showLabelIcon,h=e.firstLabel,C=e.className,b=e.xstyle,v=e.showChatAssignmentIcon,S=v===void 0?!1:v,R=e.assignedAgents,L=R===void 0?[]:R,E=e.testid,k=e.overrideCommunityAnnouncementGroupName,I=k===void 0?!1:k,T=e.checkmarkLarge,D=T===void 0?!1:T,x,$=o("useWAWebChatValues").useChatValues(e.chat.id,[o("WAWebFrontendChatGetters").getFormattedTitle,o("WAWebChatGetters").getLabels]),P=$[0],N=$[1],M=o("useWAWebModelValues").useModelValues(e.groupMetadata,["support","isUnnamed","participants","groupType","isLidAddressingMode","isCag","parentGroup"]),w=o("useWAWebForceUpdate").useForceUpdateDONOTUSE();o("useWAWebListener").useListener(M.participants,"bulk_add bulk_remove reset sort change:isAdmin change:isSuperAdmin remove add",w),l!=null&&l!==""&&(x=o("WAWebFormatConfiguration").SearchName({terms:[l]}));var A=e.labels||N;A!=null&&A.length&&h!=null&&r("WAArrayMoveToFirst")(A,h);var F=p===!0&&A!=null&&A.length?f.jsx(o("WAWebLabels.react").Labels,{labels:A,showName:!1}):null,O=I&&M.groupType===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP?s._(/*BTDS*/"Avisos"):r("WAReplaceRepeatingWhitespace")(M!=null&&M.isUnnamed?o("WAWebParticipantListUtils").calculateUnnamedGroupFullParticipantsList(M,!0):a.title()),B=o("WAWebLidMigrationUtils").getShouldShowLidDebugUIForGroups(M.isLidAddressingMode),W=M.parentGroup,q=W?((t=r("WAWebGroupMetadataCollection").get(W))==null?void 0:t.isLidAddressingMode)===!0:!1,U=o("WAWebLidMigrationUtils").getShouldShowLidDebugUIForGroups(q),V=f.jsxs(f.Fragment,{children:[f.jsx(o("WAWebEmojiText.react").EmojiText,{text:O,element:i,className:C,xstyle:b,formatters:x,titlify:u,ellipsify:c,breakWord:d,direction:"auto",inlineblock:!0,onClick:m,testid:void 0}),B&&n("cr:17281")&&f.jsx(n("cr:17281"),{isCAG:M.isCag}),U&&n("cr:17281")&&f.jsx(n("cr:17281"),{isParentGroup:!0})]}),H=M.support;if(H){var G=D?24:20;return f.jsxs("div",babelHelpers.extends({},(_||(_=r("stylex"))).props(o("WAWebNewsletterName.react").styles.verified,!!F&&g.hasLabels),{children:[V,f.jsx("div",babelHelpers.extends({},_.props(g.icon,o("WAWebUISpacing").uiMargin.top1,o("WAWebUISpacing").uiMargin.start3),{children:o("WAWebMiscGatingUtils").isBlueEnabled()?f.jsx(o("WAWebPsaVerifiedBlueIcon.react").PsaVerifiedBlueIcon,{width:G,height:G}):f.jsx(o("WAWebPsaVerifiedIcon.react").PsaVerifiedIcon,{})})),f.jsx("div",babelHelpers.extends({},_.props(g.labels,o("WAWebUISpacing").uiMargin.start8),{children:F}))]}))}var z=S?y(L):null;return z||F?f.jsxs("span",{className:"x1jfb8zj xuce83p x1bft6iq x1i7k8ik xq9mrsl x11t971q",children:[V,f.jsxs("div",babelHelpers.extends({},(_||(_=r("stylex"))).props(g.labels,o("WAWebUISpacing").uiMargin.start8),{children:[z,F]}))]}):V}b.displayName=b.name+" [from "+i.id+"]";function v(t){var n,r,a=(n=o("useWAWebChatValues").useOptionalChatValues((r=t.chat)==null?void 0:r.id,[o("WAWebChatGetters").getIsUser,o("WAWebChatGetters").getIsNewsletter,o("WAWebFrontendChatGetters").getGroupMetadata,o("WAWebFrontendChatGetters").getFormattedTitle]))!=null?n:[!1,!1,null,null],i=a[0],l=a[1],s=a[2],m=a[3];if(t.chat&&s!=null&&!i&&!l){var p=t.chat,_=t.selectable,g=babelHelpers.objectWithoutPropertiesLoose(t,e);return f.jsx(o("WAWebErrorBoundary.react").ErrorBoundary,{name:"group-name",fallback:function(){return f.jsx("span",{children:m})},children:f.jsx(b,babelHelpers.extends({chat:p,groupMetadata:s},g))})}if(t.chat&&!i&&l){var h=t.chat,y=t.selectable,v=babelHelpers.objectWithoutPropertiesLoose(t,u);return f.jsx(o("WAWebNewsletterName.react").NewsletterName,babelHelpers.extends({chat:h,selectable:y},v))}var S,R;if(t.chat){var L=t.chat,E=babelHelpers.objectWithoutPropertiesLoose(t,c);S=L.contact,R=E}else{var k=t.contact,I=babelHelpers.objectWithoutPropertiesLoose(t,d);S=k,R=I}return f.jsx(C,babelHelpers.extends({contact:S},R))}v.displayName=v.name+" [from "+i.id+"]";function S(e){var t=e.chat,n=e.contact,o=e.xstyle;return f.jsxs("span",babelHelpers.extends({},(_||(_=r("stylex"))).props(o),{children:[f.jsx(v,{contact:n,useShortName:!!n.shortName,showNotifyName:!0,elevatedPushNamesEnabled:!0,useLiftMeUp:!0}),f.jsx("span",{children:"\xA0\u2022\xA0"}),t.groupMetadata&&f.jsx(b,{chat:t,groupMetadata:t.groupMetadata})]}))}S.displayName=S.name+" [from "+i.id+"]",l.ContactName=C,l.GroupName=b,l.Name=v,l.ContactAndGroupName=S}),226);
__d("WAWebNotificationTone",["Promise","WAWebNoop","bx"],(function(t,n,r,o,a,i,l){var e,s=new window.Audio(r("bx").getURL(r("bx")("9561")));function u(){s.play().catch(r("WAWebNoop"))}function c(t){return(e||(e=n("Promise"))).resolve(t)}l.playNotification=u,l.cachePath=c}),98);
__d("WAWebBaseNotification",["Promise","WAAbortError","WALogger","WAWebBuildConstants","WAWebEnvironment","WAWebNotificationBanner","WAWebNotificationConstants","WAWebNotificationHelpers","WAWebNotificationTone","asyncToGeneratorRuntime","cr:3133","err"],(function(t,n,r,o,a,i,l){var e,s,u,c=(e=n("cr:3133"))!=null?e:{},d=c.shouldShowBanner,m=c.shouldSuppressBanner,p=(function(){function e(){var e=this;this.creationAt=Date.now(),this.closeBanner=function(){e.notificationBanner!=null&&(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["WABaseNotification:_closeNotification()"]))),e.notificationBanner.close())}}var t=e.prototype;return t.shouldPlaySound=function(){return r("WAWebEnvironment").isWindows&&Number(o("WAWebBuildConstants").WINDOWS_BUILD)>=257300?!1:o("WAWebNotificationHelpers").shouldPlaySoundGranular()},t.shouldMute=function(t){return null},t.shouldShowBanner=function(){return d?d():o("WAWebNotificationHelpers").shouldEnableNotificationGranular()},t.shouldSquelch=function(){return null},t.shouldSuppressBanner=function(t){return!!m&&m(t)},t.buildKey=function(){throw r("err")("WABaseNotification: must implement `buildKey` method")},t.getBannerOptions=function(){throw r("err")("WABaseNotification: must implement `getBannerOptions` method")},t.getIcon=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw r("err")("WABaseNotification: must implement `getIcon` method")});function t(){return e.apply(this,arguments)}return t})(),t.matchesChat=function(t){return!1},t.beforeBannerShown=function(){return(u||(u=n("Promise"))).resolve()},t.afterBannerShown=function(t){},t.getChatKind=function(){throw r("err")("WABaseNotification: must implement `getChatKind` method")},t.performLogging=function(){},t.isReplyable=function(){return!1},t.triggerNotification=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield this.shouldMute(e);t||(t=yield this.shouldSquelch());var n=!1;if(t)if(this.shouldSuppressBanner(t))n=!0;else throw new(o("WAAbortError")).AbortError("Notification mute/squelched "+t);var r;return(yield this.shouldShowBanner())&&(yield this.beforeBannerShown(),r=yield this.showBanner(n),this.afterBannerShown(r),this.performLogging()),!t&&(yield this.shouldPlaySound())&&this.playSound(),r});function t(t){return e.apply(this,arguments)}return t})(),t.showBanner=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){e===void 0&&(e=!1),this.abortController=new AbortController;var t=this.getBannerOptions(),n=yield this.getIcon();if(this.abortController.signal.aborted)throw new(o("WAAbortError")).AbortError("Aborted through abortController");if(!r("WAWebEnvironment").isWindows&&window.Notification.permission!==o("WAWebNotificationConstants").PERMISSION_ALLOWED)throw new(o("WAAbortError")).AbortError("Permission Denied");var a=new(r("WAWebNotificationBanner"))(babelHelpers.extends({},t,{icon:n,key:this.buildKey(),isReplyable:this.isReplyable(),suppressBanner:e}));return this.notificationBanner=a,a});function t(t){return e.apply(this,arguments)}return t})(),t.playSound=function(){o("WAWebNotificationTone").playNotification()},e})();l.WABaseNotification=p}),98);
__d("WAWebBannerContextMenuActions",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["None","MuteChatForEightHours","MuteChatForOneWeek","MuteChat","DisableNotifications"]),l=e;i.default=l}),66);
__d("WAWebMuteExpirations",["fbt","WAWeb-moment","WAWebClock"],(function(t,n,r,o,a,i,l,s){var e=[{getLabel:function(){return s._(/*BTDS*/"8 horas")},duration:8,radioId:"8-hours"},{getLabel:function(){return s._(/*BTDS*/"1 semana")},duration:168,radioId:"1-week"},{getLabel:function(){return s._(/*BTDS*/"Siempre")},duration:Number.POSITIVE_INFINITY,radioId:"always"}];function u(){return e[0].duration}function c(e){return e===Number.POSITIVE_INFINITY?o("WAWebClock").MUTE_ALWAYS_EXPIRATION_SENTINEL:e*60*60+r("WAWeb-moment")().unix()}l.ALL_MUTE_DURATIONS=e,l.getDefaultMuteDuration=u,l.calculateMuteExpiration=c}),226);
__d("WAWebBaseNotificationBanner",["Promise","WALogger","WATypeUtils","WAWebBannerContextMenuActions","WAWebChatCollection","WAWebChatEntryPoint","WAWebChatMessageSearch","WAWebCmd","WAWebComposeBoxActions","WAWebEnvironment","WAWebGroupType","WAWebL10N","WAWebModalManager","WAWebMsgCollection","WAWebMsgType","WAWebMuteCollection","WAWebMuteExpirations","WAWebNewsletterCollection","WAWebNoop","WAWebSendTextMsgChatAction","WAWebUserPrefsGeneral","asyncToGeneratorRuntime","cr:3133"],(function(t,n,r,o,a,i,l){var e=["title","notification","renotify","footer","isReplyable","contextMenuItems","suppressBanner"],s,u,c,d,m,p,_,f=(s=n("cr:3133"))!=null?s:{},g=f.closeMessageNotification,h=f.showMessageNotification,y=(function(){function t(e,t,a,i,l){var s=this,c;this.isReplyable=!1,this.close=function(){s.$3().then(function(){s.notification&&o("WATypeUtils").isFunction(s.notification.close)&&s.notification.close(),g==null||g(s.key,s.tag)}).catch(r("WAWebNoop"))},this.$4=function(){s.waitingPromise.resolver(),window.removeEventListener("beforeunload",s.close);var e=s.notification;e&&(e.removeEventListener("click",s.$5),e.removeEventListener("close",s.$4)),s.msg&&s.msg.off("change:type",s.$6)},this.$5=function(){s.$1==null||s.$1(),window.focus();var e=s.chat,t=s.msg,n=s.doNotOpenChat==null?!1:s.doNotOpenChat;if(e){if(!n){var a,i,l=t&&t!==e.msgs.last()?o("WAWebChatMessageSearch").getSearchContext(e,t.id):void 0;if(((a=e.groupMetadata)==null?void 0:a.groupType)===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&(i=e.groupMetadata)!=null&&i.parentGroup&&t!=null&&(t.subtype===o("WAWebGroupType").GROUP_ACTIONS.LINKED_GROUP_PROMOTE||t.subtype===o("WAWebGroupType").GROUP_ACTIONS.LINKED_GROUP_DEMOTE)){var u;o("WAWebCmd").Cmd.openCommunityHome((u=e.groupMetadata)==null?void 0:u.parentGroup)}else{var c=r("WAWebEnvironment").isWindows?o("WAWebCmd").Cmd.openChatFromUnread({chat:e,chatEntryPoint:o("WAWebChatEntryPoint").ChatEntryPoint.Notification}):o("WAWebCmd").Cmd.openChatAt({chat:e,msgContext:l,chatEntryPoint:o("WAWebChatEntryPoint").ChatEntryPoint.Notification});c.then(function(t){t&&o("WAWebComposeBoxActions").ComposeBoxActions.focus(e)})}}o("WAWebModalManager").ModalManager.closeMedia(),s.increaseNotificationEngagement({isClick:!0}),s.close()}},this.$6=function(){!s.msg||s.msg.type!==o("WAWebMsgType").MSG_TYPE.REVOKED||s.close()},this.msg=t!=null?o("WAWebMsgCollection").MsgCollection.get(t):null,this.chat=(c=o("WAWebChatCollection").ChatCollection.get(e))!=null?c:r("WAWebNewsletterCollection").get(e),this.tag=a,this.key=i,this.$1=l.onClick,this.canBlock=l.canBlock,this.doNotOpenChat=l.doNotOpenChat,this.isReplyable=l.isReplyable;var d=new(_||(_=n("Promise")))(function(e){s.waitingPromise={resolver:e}});this.waitingPromise.promise=d;try{this.$2(i,a,l)}catch(e){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Failed to create notification: ",":",""])),e.name,e.message).devConsole(e),this.waitingPromise.resolver()}}var a=t.prototype;return a.$3=function(){return(_||(_=n("Promise"))).resolve()},a.waitForClose=function(){return this.waitingPromise.promise},a.detach=function(){this.$4()},a.click=function(){this.$5()},a.quickReply=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this.chat;t&&t.isReadOnly!==!0&&this.isReplyable&&(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["quickReply inside WAWebBaseNotificationBanner"]))),yield o("WAWebSendTextMsgChatAction").sendTextMsgToChat(t,e)),this.$4()});function t(t){return e.apply(this,arguments)}return t})(),a.$2=function(n,a,i){var t=i.title,l=i.notification,s=i.renotify,u=i.footer,c=i.isReplyable,p=i.contextMenuItems,_=i.suppressBanner,f=babelHelpers.objectWithoutPropertiesLoose(i,e);f.body&&f.body.charCodeAt(0)>=128&&(f.body=" "+f.body);var g=babelHelpers.extends({tag:a,renotify:s!=null?s:!!a,dir:"auto",lang:r("WAWebL10N").getNormalizedLocale(),silent:!0},f);if(h)h({key:n,tag:a,title:t,body:g.body,icon:g.icon,footer:u,contextMenuItems:p,isReplyable:c,suppressBanner:_,chat:this.chat});else{var y,C,b,v;this.notification=new l(t,g),(y=this.notification)==null||y.addEventListener("error",function(e){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["native notification error"]))).devConsole(e)}),(C=this.notification)==null||C.addEventListener("close",function(e){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["native notification close"]))).devConsole(e)}),(b=this.notification)==null||b.addEventListener("click",this.$5),(v=this.notification)==null||v.addEventListener("close",this.$4)}this.msg&&this.msg.on("change:type",this.$6),window.addEventListener("beforeunload",this.close),this.increaseNotificationEngagement({isShow:!0})},a.contextMenuClick=function(t){var e=this.chat;if(e){switch(t){case r("WAWebBannerContextMenuActions").MuteChatForEightHours:this.$7(e,o("WAWebMuteExpirations").ALL_MUTE_DURATIONS[0].duration);break;case r("WAWebBannerContextMenuActions").MuteChatForOneWeek:this.$7(e,o("WAWebMuteExpirations").ALL_MUTE_DURATIONS[1].duration);break;case r("WAWebBannerContextMenuActions").MuteChat:this.$7(e,o("WAWebMuteExpirations").ALL_MUTE_DURATIONS[2].duration);break;case r("WAWebBannerContextMenuActions").DisableNotifications:o("WAWebMuteCollection").MuteCollection.setAllNotificationsAndReactions(!1);break;case r("WAWebBannerContextMenuActions").None:break}this.$4()}},a.$7=function(t,n){t.mute.mute({expiration:o("WAWebMuteExpirations").calculateMuteExpiration(n),sendDevice:!0}).catch(function(e){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["mute failed: ",""])),e)})},a.increaseNotificationEngagement=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n,r=e===void 0?{}:e,a=r.isShow,i=a===void 0?!1:a,l=r.isClick,s=l===void 0?!1:l,u=yield o("WAWebUserPrefsGeneral").getNotificationEngagement();o("WAWebUserPrefsGeneral").setNotificationContentEngagement({totalNotifShown:((t=u==null?void 0:u.totalNotifShown)!=null?t:0)+(i?1:0),totalNotifTapToOpen:((n=u==null?void 0:u.totalNotifTapToOpen)!=null?n:0)+(s?1:0)})});function t(t){return e.apply(this,arguments)}return t})(),t})();l.default=y}),98);
__d("WAWebCurrencyData",[],(function(t,n,r,o,a,i){var e="USD",l=2,s={ADP:0,AFN:0,ALL:0,BHD:3,BIF:0,BYR:0,CLF:4,CLP:0,DJF:0,ESP:0,GNF:0,IQD:0,IRR:0,ISK:0,ITL:0,JOD:3,JPY:0,KMF:0,KPW:0,KRW:0,KWD:3,LAK:0,LBP:0,LUF:0,LYD:3,MGA:0,MGF:0,MMK:0,MRO:0,OMR:3,PYG:0,RSD:0,RWF:0,SLL:0,SOS:0,STD:0,SYP:0,TMM:0,TND:3,TRL:0,UGX:0,UYI:0,UYW:4,VND:0,VUV:0,XAF:0,XOF:0,XPF:0,YER:0,ZMK:0,ZWD:0},u={AC:["SHP"],AD:["EUR"],AE:["AED"],AF:["AFN"],AG:["XCD"],AI:["XCD"],AL:["ALL"],AM:["AMD"],AO:["AOA"],AR:["ARS"],AS:["USD"],AT:["EUR"],AU:["AUD"],AW:["AWG"],AX:["EUR"],AZ:["AZN"],BA:["BAM"],BB:["BBD"],BD:["BDT"],BE:["EUR"],BF:["XOF"],BG:["BGN"],BH:["BHD"],BI:["BIF"],BJ:["XOF"],BL:["EUR"],BM:["BMD"],BN:["BND"],BO:["BOB"],BQ:["USD"],BR:["BRL"],BS:["BSD"],BT:["BTN","INR"],BV:["NOK"],BW:["BWP"],BY:["BYN"],BZ:["BZD"],CA:["CAD"],CC:["AUD"],CD:["CDF"],CF:["XAF"],CG:["XAF"],CH:["CHF"],CI:["XOF"],CK:["NZD"],CL:["CLP"],CM:["XAF"],CN:["CNY"],CO:["COP"],CR:["CRC"],CU:["CUP","CUC"],CV:["CVE"],CW:["ANG"],CX:["AUD"],CY:["EUR"],CZ:["CZK"],DE:["EUR"],DG:["USD"],DJ:["DJF"],DK:["DKK"],DM:["XCD"],DO:["DOP"],DZ:["DZD"],EA:["EUR"],EC:["USD"],EE:["EUR"],EG:["EGP"],EH:["MAD"],ER:["ERN"],ES:["EUR"],ET:["ETB"],EU:["EUR"],FI:["EUR"],FJ:["FJD"],FK:["FKP"],FM:["USD"],FO:["DKK"],FR:["EUR"],GA:["XAF"],GB:["GBP"],GD:["XCD"],GE:["GEL"],GF:["EUR"],GG:["GBP"],GH:["GHS"],GI:["GIP"],GL:["DKK"],GM:["GMD"],GN:["GNF"],GP:["EUR"],GQ:["XAF"],GR:["EUR"],GS:["GBP"],GT:["GTQ"],GU:["USD"],GW:["XOF"],GY:["GYD"],HK:["HKD"],HM:["AUD"],HN:["HNL"],HR:["HRK"],HT:["HTG","USD"],HU:["HUF"],IC:["EUR"],ID:["IDR"],IE:["EUR"],IL:["ILS"],IM:["GBP"],IN:["INR"],IO:["USD"],IQ:["IQD"],IR:["IRR"],IS:["ISK"],IT:["EUR"],JE:["GBP"],JM:["JMD"],JO:["JOD"],JP:["JPY"],KE:["KES"],KG:["KGS"],KH:["KHR"],KI:["AUD"],KM:["KMF"],KN:["XCD"],KP:["KPW"],KR:["KRW"],KW:["KWD"],KY:["KYD"],KZ:["KZT"],LA:["LAK"],LB:["LBP"],LC:["XCD"],LI:["CHF"],LK:["LKR"],LR:["LRD"],LS:["ZAR","LSL"],LT:["EUR"],LU:["EUR"],LV:["EUR"],LY:["LYD"],MA:["MAD"],MC:["EUR"],MD:["MDL"],ME:["EUR"],MF:["EUR"],MG:["MGA"],MH:["USD"],MK:["MKD"],ML:["XOF"],MM:["MMK"],MN:["MNT"],MO:["MOP"],MP:["USD"],MQ:["EUR"],MR:["MRU"],MS:["XCD"],MT:["EUR"],MU:["MUR"],MV:["MVR"],MW:["MWK"],MX:["MXN"],MY:["MYR"],MZ:["MZN"],NA:["NAD","ZAR"],NC:["XPF"],NE:["XOF"],NF:["AUD"],NG:["NGN"],NI:["NIO"],NL:["EUR"],NO:["NOK"],NP:["NPR"],NR:["AUD"],NU:["NZD"],NZ:["NZD"],OM:["OMR"],PA:["PAB","USD"],PE:["PEN"],PF:["XPF"],PG:["PGK"],PH:["PHP"],PK:["PKR"],PL:["PLN"],PM:["EUR"],PN:["NZD"],PR:["USD"],PS:["ILS","JOD"],PT:["EUR"],PW:["USD"],PY:["PYG"],QA:["QAR"],RE:["EUR"],RO:["RON"],RS:["RSD"],RU:["RUB"],RW:["RWF"],SA:["SAR"],SB:["SBD"],SC:["SCR"],SD:["SDG"],SE:["SEK"],SG:["SGD"],SH:["SHP"],SI:["EUR"],SJ:["NOK"],SK:["EUR"],SL:["SLL"],SM:["EUR"],SN:["XOF"],SO:["SOS"],SR:["SRD"],SS:["SSP"],ST:["STN"],SV:["USD"],SX:["ANG"],SY:["SYP"],SZ:["SZL"],TA:["GBP"],TC:["USD"],TD:["XAF"],TF:["EUR"],TG:["XOF"],TH:["THB"],TJ:["TJS"],TK:["NZD"],TL:["USD"],TM:["TMT"],TN:["TND"],TO:["TOP"],TR:["TRY"],TT:["TTD"],TV:["AUD"],TW:["TWD"],TZ:["TZS"],UA:["UAH"],UG:["UGX"],UM:["USD"],US:["USD"],UY:["UYU"],UZ:["UZS"],VA:["EUR"],VC:["XCD"],VE:["VES"],VG:["USD"],VI:["USD"],VN:["VND"],VU:["VUV"],WF:["XPF"],WS:["WST"],XK:["EUR"],YE:["YER"],YT:["EUR"],ZA:["ZAR"],ZM:["ZMW"],ZW:["USD"]};i.DEFAULT_CURRENCY=e,i.DEFAULT_DIGITS=l,i.CURRENCY_DIGITS=s,i.REGION_TO_CURRENCY=u}),66);
__d("WAWebCurrencyUtils",["WAWebCurrencyData","WAWebL10N"],(function(t,n,r,o,a,i,l){var e={IDR:"in-ID",MXN:"es-MX",INR:"en-IN"},s=new Set(["DZD","ARS","AUD","BDT","BOB","BRL","GBP","CAD","CLP","CNY","COP","CRC","CZK","DKK","EGP","EUR","GTQ","HNL","HKD","HUF","ISK","INR","IDR","ILS","JPY","KES","KRW","MOP","MYR","MXN","NZD","NIO","NGN","NOK","PKR","PYG","PEN","PHP","PLN","QAR","RON","RUB","SAR","SGD","ZAR","SEK","CHF","TWD","THB","TRY","AED","USD","UYU","VEF","VND"]),u=["es-ES","pt-BR"],c=function(){var e;return[(e=r("WAWebL10N")).getFullLocale(),e.normalizeLocaleToBcp47Compliant(e.getNormalizedLocale()),e.normalizeLocaleToBcp47Compliant(e.getLocale())].filter(Boolean)},d=function(t,n,r,o){o===void 0&&(o=c());var e="symbol";return u.includes(Array.isArray(o)?o[0]:o)&&(e="code"),new Intl.NumberFormat(o,babelHelpers.extends({style:"currency",currency:t,currencyDisplay:e},r)).format(n)},m=function(t,n,r,o){return d(t,n/1e3,r,o)};function p(e){return new Intl.NumberFormat(e).format(1.1).substring(1,2)}function _(e){return new Intl.NumberFormat(e).format(1e4).substring(2,3)}function f(e,t){var n=m(t,0,{},e);return n.replace(/\d+([,.]\d+)?/g,"").trim()}function g(e,t){var n=c(),r=p(n),o=f(n,e),a=m(e,t),i=a.replace(o,"").trim(),l=i.indexOf(r),s=l===-1?i:i.substring(0,l),u=l===-1?"":i.substring(l);return{symbol:o,integer:s,decimal:u}}function h(t){return f(e[t],t)}function y(e,t){var n=c(),r=f(n,e),o=_(n),a=p(n);return C(t,r,a,o)}function C(e,t,n,r){var o=e.replace(t,"").trim(),a=o.split(r).join(""),i=parseFloat(a.replace(n,".")||"0");return Math.round(i*1e3)}function b(e,t){if(t==null||t.trim().length===0)return!1;var n=c(),r=_(n),o=p(n);if(t.match("/[^0-9"+r+o+"]/"))return!1;var a=f(n,e),i=y(e,t),l=m(e,i),s=l.replace(a,"").trim(),u=s.indexOf(o),d=u===-1?s:s.substring(0,u),g=s.split(r).join("");u=g.indexOf(o);var h=u===-1?g:g.substring(0,u);return t===s||t===d||t===g||t===h}function v(e,t,n,r){var a=c(),i=o("WAWebCurrencyData").CURRENCY_DIGITS[e]!==void 0?o("WAWebCurrencyData").CURRENCY_DIGITS[e]:o("WAWebCurrencyData").DEFAULT_DIGITS,l=y(e,t);if(n!=null&&l<n||r!=null&&l>r)return!1;var s=t.replace(/\D+$/g,""),u=p(a);return!(Number.isNaN(l)||s!==t||(t.split(u)[1]||"").length>i)}function S(e){var t=o("WAWebCurrencyData").REGION_TO_CURRENCY[e.toUpperCase()];return(t==null?void 0:t.length)>0?t[0]:o("WAWebCurrencyData").DEFAULT_CURRENCY}function R(e){return s.has(e)}l.formatAmount=d,l.formatAmount1000=m,l.formatAmount1000ToParts=g,l.formatLocalSymbol=h,l.valueFromString=y,l.parseValueFromString=C,l.validateAmountString=b,l.validatePriceString=v,l.currencyForCountryShortcode=S,l.isSupportedCurrency=R}),98);
__d("WAWebGetInteractiveFooterText",["fbt","WAWebInteractiveMessagesNativeFlowName","WAWebMsgType","WAWebOrderStatusButton","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l,s){"use strict";function e(e){if(e.type===o("WAWebMsgType").MSG_TYPE.INTERACTIVE&&e.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS){var t=o("WAWebOrderStatusButton").getOrderStatusButton(e);if(t!=null){var n=t.order,a=n.tracking,i=n.shipping_method;if(a)return a.courier_name+" \u2022 "+a.tracking_ref;var l=r("isStringNullOrEmpty")(i)?s._(/*BTDS*/"No disponible"):i;return s._(/*BTDS*/"M\u00e9todo de env\u00edo: {shipping_method}",[s._param("shipping_method",l)]).toString()}}return e.footer}l.getInteractiveFooterText=e}),226);
__d("WAWebBizFormatInteractiveMsg",["fbt","WAWebBizOrderDetailsParams","WAWebBrazilPixKeyFormattingUtils","WAWebCurrencyUtils","WAWebGetInteractiveFooterText","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebOrderDetails","WAWebOrderPaymentStatus","WAWebOrderStatus","WAWebOrderStatusButton","WAWebUserPrefsTypes"],(function(t,n,r,o,a,i,l,s){function e(e,t){var n,o,a=t===void 0?{}:t,i=a.formatAsSearchResult,l=i===void 0?!1:i;if(e.interactiveType===r("WAWebInteractiveMessageType").SHOPS_STOREFRONT){var s;return e.caption||((s=e.interactiveHeader)==null?void 0:s.title)||""}if(e.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO){var u=p(e);if(u!=null)return u}if(e.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS){var d=m(e);if(d!=null)return d}if(e.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS){var _=c(e);if(_!=null)return _}return[(n=e.interactiveHeader)==null?void 0:n.title,l?(o=e.interactiveHeader)==null?void 0:o.subtitle:null,e.caption,e.footer].filter(Boolean).join("\n")}function u(e){switch(e){case o("WAWebOrderStatus").OrderStatus.Pending:return s._(/*BTDS*/"Pedido pendiente");case o("WAWebOrderStatus").OrderStatus.Canceled:return s._(/*BTDS*/"Pedido cancelado");case o("WAWebOrderStatus").OrderStatus.PartiallyShipped:return s._(/*BTDS*/"Pedido enviado parcialmente");case o("WAWebOrderStatus").OrderStatus.Complete:return s._(/*BTDS*/"Pedido completado \ud83c\udf89");case o("WAWebOrderStatus").OrderStatus.Shipped:return s._(/*BTDS*/"Pedido enviado");case o("WAWebOrderStatus").OrderStatus.Processing:return s._(/*BTDS*/"Pedido en proceso");case o("WAWebOrderStatus").OrderStatus.PaymentRequested:return s._(/*BTDS*/"Pago solicitado");case o("WAWebOrderStatus").OrderStatus.PreparingToShip:return s._(/*BTDS*/"Env\u00edo del pedido en preparaci\u00f3n");case o("WAWebOrderStatus").OrderStatus.Delivered:return s._(/*BTDS*/"Pedido entregado \ud83c\udf89");case o("WAWebOrderStatus").OrderStatus.Confirmed:return s._(/*BTDS*/"Pedido confirmado");case o("WAWebOrderStatus").OrderStatus.Delayed:return s._(/*BTDS*/"Pedido demorado");case o("WAWebOrderStatus").OrderStatus.OutForDelivery:return s._(/*BTDS*/"Pedido en camino");case o("WAWebOrderStatus").OrderStatus.Failed:return s._(/*BTDS*/"Error en el pedido");case o("WAWebOrderStatus").OrderStatus.Refunded:return s._(/*BTDS*/"Se reembols\u00f3 el pedido.")}}function c(e){var t=o("WAWebOrderStatus").getOrderStatusInfo(e);if(t==null)return null;var n=o("WAWebOrderStatusButton").getOrderStatusButton(e);if(n!=null){var r=u(t.status).toString(),a=e.caption,i=o("WAWebGetInteractiveFooterText").getInteractiveFooterText(e),l=s._(/*BTDS*/"N.\u00b0 de pedido: {order-id}",[s._param("order-id",n.reference_id)]);return[r,l,a,i].filter(Boolean).join("\n")}return d(e)}function d(e){var t=o("WAWebOrderStatus").getOrderStatusInfo(e);if(t==null)return null;if(o("WAWebOrderStatus").hasOrderStatusButton(e)){var n=u(t.status).toString(),r=e.caption;return["*"+n+"*",r].filter(Boolean).join("\n")}return g(e.caption,t.status)}function m(e){var t=o("WAWebOrderDetails").getOrderInfo(e);if(t==null)return null;var n=t.items,r=t.totalAmount,a=t.currency,i=o("WAWebCurrencyUtils").formatAmount(a,r);return n.length!==0?n[0].name+" \xB7 "+i:i}function p(e){var t,n,r,a=o("WAWebOrderDetails").getOrderInfo(e);if(a==null)return null;var i=a==null?void 0:a.paymentSettings,l=s._(/*BTDS*/"Pix"),u=i==null||(t=i.at(0))==null?void 0:t[o("WAWebBizOrderDetailsParams").PaymentSettingType.PIX_STATIC_CODE],c=(n=u==null?void 0:u.merchant_name)!=null?n:"",d=(r=u==null?void 0:u.key)!=null?r:"",m=o("WAWebUserPrefsTypes").PixKeyType.cast(u==null?void 0:u.key_type);return c+" \xB7 "+l.toString()+": "+o("WAWebBrazilPixKeyFormattingUtils").getFormattedPixKey(d,m)}function _(e){var t=o("WAWebOrderPaymentStatus").getOrderPaymentStatusInfoFromNativeFlow(e);return t==null?null:h(e.caption,t==null?void 0:t.paymentStatus).toString()}function f(e){var t=o("WAWebOrderPaymentStatus").getOrderPaymentStatusInfoFromNativeFlow(e);return t==null?null:y(t==null?void 0:t.paymentMethod)}function g(e,t){var n="";switch(t){case o("WAWebOrderStatus").OrderStatus.Pending:n=s._(/*BTDS*/"Estado: Pendiente");break;case o("WAWebOrderStatus").OrderStatus.Canceled:n=s._(/*BTDS*/"Estado: Cancelado");break;case o("WAWebOrderStatus").OrderStatus.PartiallyShipped:n=s._(/*BTDS*/"Estado: Enviado parcialmente");break;case o("WAWebOrderStatus").OrderStatus.Complete:n=s._(/*BTDS*/"Estado: Completado");break;case o("WAWebOrderStatus").OrderStatus.Shipped:n=s._(/*BTDS*/"Estado: Enviado");break;case o("WAWebOrderStatus").OrderStatus.Processing:n=s._(/*BTDS*/"Estado: En proceso");break;case o("WAWebOrderStatus").OrderStatus.PaymentRequested:n=s._(/*BTDS*/"Estado: Pago solicitado");break;case o("WAWebOrderStatus").OrderStatus.PreparingToShip:n=s._(/*BTDS*/"Estado: Env\u00edo en preparaci\u00f3n");break;case o("WAWebOrderStatus").OrderStatus.Delivered:n=s._(/*BTDS*/"Estado: Entregado");break;case o("WAWebOrderStatus").OrderStatus.Confirmed:n=s._(/*BTDS*/"Estado: Confirmado");break;case o("WAWebOrderStatus").OrderStatus.Delayed:n=s._(/*BTDS*/"Estado: Demorado");break;case o("WAWebOrderStatus").OrderStatus.OutForDelivery:n=s._(/*BTDS*/"Estado: Listo para entregar");break;case o("WAWebOrderStatus").OrderStatus.Failed:n=s._(/*BTDS*/"Estado: Error");break;case o("WAWebOrderStatus").OrderStatus.Refunded:n=s._(/*BTDS*/"Estado: Reembolsado");break}return e!=null&&e.toLowerCase().includes(n.toString().toLowerCase())?e||"":(n.toString()+"\n"+(e||"")).trim()}function h(e,t){var n="";switch(t){case o("WAWebOrderPaymentStatus").OrderPaymentStatus.Captured:n=s._(/*BTDS*/"Pago: Realizado");break;case o("WAWebOrderPaymentStatus").OrderPaymentStatus.Pending:n=s._(/*BTDS*/"Pago: Pendiente");break;case o("WAWebOrderPaymentStatus").OrderPaymentStatus.Failed:n=s._(/*BTDS*/"Pago: Error");break}return(n.toString()+"\n"+(e!=null?e:"")).trim()}function y(e){var t="";switch(e){case o("WAWebOrderPaymentStatus").OrderPaymentMethod.PaymentInstruction:t=s._(/*BTDS*/"Pago fuera de WhatsApp");break;case o("WAWebOrderPaymentStatus").OrderPaymentMethod.Confirm:t=s._(/*BTDS*/"Pedido confirmado");break}return t.toString()}l.formatInteractive=e,l.getOrderStatusButtonBodyTitle=u,l.formatOrderStatusMessagePreview=c,l.formatOrderStatusMessageBody=d,l.formatOrderDetailsMessagePreview=m,l.formatPaymentInfoMessagePreview=p,l.formatOrderPaymentStatusMessage=_,l.formatOrderPaymentMethodMessage=f,l.appendPrefilledMsg=g,l.appendPrefilledOrderPaymentMsg=h}),226);
__d("WAWebFormatCallLog",["fbt","WAWebMsgGetters"],(function(t,n,r,o,a,i,l,s){function e(e){if(o("WAWebMsgGetters").getIsCallSilenced(e))return s._(/*BTDS*/"Se silenci\u00f3 la llamada de un n\u00famero desconocido.");var t=u(e.subtype);if(t!=null)return t;var n=o("WAWebMsgGetters").getCallOutcome(e),r=o("WAWebMsgGetters").getIsAdHocGroupCall(e),a=o("WAWebMsgGetters").getIsMissedCall(e),i=o("WAWebMsgGetters").getIsVideoCall(e);return n&&(t=c(r,a,i)),t!=null?t:""}function u(e){switch(e){case"miss":return s._(/*BTDS*/"Llamada perdida");case"miss_video":return s._(/*BTDS*/"Videollamada perdida");case"miss_group":case"miss_group_video":return s._(/*BTDS*/"Llamada grupal perdida")}}function c(e,t,n){return t?e?s._(/*BTDS*/"Llamada grupal perdida"):n?s._(/*BTDS*/"Videollamada perdida"):s._(/*BTDS*/"Llamada perdida"):e?s._(/*BTDS*/"Llamada grupal"):n?s._(/*BTDS*/"Videollamada"):s._(/*BTDS*/"Llamada")}l.default=e}),226);
__d("WAWebFormatEventDateString",["fbt","WATimeUtils","WAWeb-moment","WAWebClock","WAWebL10N"],(function(t,n,r,o,a,i,l,s){function e(e,t){var n=o("WATimeUtils").castToUnixTime(e),a=r("WAWeb-moment").unix(n);if(t==null||t===0)return u(a,{maybeShowAmPm:!0});var i=o("WATimeUtils").castToUnixTime(t),l=r("WAWeb-moment").unix(i);if(o("WATimeUtils").sameDay(n,i)){var c=a.format("a")===l.format("a");return s._(/*BTDS*/"{start-date} - {end-time}",[s._param("start-date",u(a,{maybeShowAmPm:!c})),s._param("end-time",u(l,{maybeShowAmPm:!0,timeOnly:!0,lowercase:!0}))])}return s._(/*BTDS*/"{start-date} - {end-date}",[s._param("start-date",u(a,{maybeShowAmPm:!0})),s._param("end-date",u(l,{maybeShowAmPm:!0,lowercase:!0}))])}function u(e,t){var n=t.maybeShowAmPm&&!o("WAWebClock").Clock.getIs24Hour(),a=o("WATimeUtils").unixTime(),i=o("WATimeUtils").castToUnixTime(e.unix());if(t.timeOnly===!0)return o("WAWebClock").Clock.timestampStr(i);var l="LT";n===!1&&(l="h:mm");var u=o("WATimeUtils").sameDay(o("WATimeUtils").castToUnixTime(r("WAWeb-moment")().subtract(1,"day").unix()),i);if(u)return t.lowercase===!0?s._(/*BTDS*/"ayer, {time}",[s._param("time",e.format(l))]):s._(/*BTDS*/"Ayer a la(s) {time}",[s._param("time",e.format(l))]);var c=o("WATimeUtils").sameDay(a,i);if(c)return t.lowercase===!0?s._(/*BTDS*/"hoy, {time}",[s._param("time",e.format(l))]):s._(/*BTDS*/"Hoy a la(s) {time}",[s._param("time",e.format(l))]);var d=o("WATimeUtils").sameDay(o("WATimeUtils").castToUnixTime(r("WAWeb-moment")().add(1,"day").unix()),i);if(d)return t.lowercase===!0?s._(/*BTDS*/"ma\u00f1ana, {time}",[s._param("time",e.format(l))]):s._(/*BTDS*/"Ma\u00f1ana a la(s) {time}",[s._param("time",e.format(l))]);var m="ddd, MMM D",p="MMM D, YYYY";r("WAWebL10N").getLanguage()!=="en"&&(m="LL",p="LL");var _=e.isSame(r("WAWeb-moment")(),"year");return _?s._(/*BTDS*/"{date}, {time}",[s._param("date",e.format(m)),s._param("time",e.format(l))]):s._(/*BTDS*/"{date}, {time}",[s._param("date",e.format(p)),s._param("time",e.format(l))])}l.getEventDateStringFor=e}),226);
__d("WAWebFormatNfmText",["WAWebBizFormatInteractiveMsg","WAWebInteractiveMessagesNativeFlowName"],(function(t,n,r,o,a,i,l){function e(e){if(e.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS){var t=o("WAWebBizFormatInteractiveMsg").formatOrderStatusMessageBody(e);if(t!=null)return t}else if(e.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").PAYMENT_STATUS){var n=o("WAWebBizFormatInteractiveMsg").formatOrderPaymentStatusMessage(e);if(n!=null)return n}else if(e.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").PAYMENT_METHOD){var a=o("WAWebBizFormatInteractiveMsg").formatOrderPaymentMethodMessage(e);if(a!=null)return a}return e.caption||""}function s(t){if(t.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS){var n=o("WAWebBizFormatInteractiveMsg").formatOrderDetailsMessagePreview(t);if(n!=null)return n}else if(t.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO){var a=o("WAWebBizFormatInteractiveMsg").formatPaymentInfoMessagePreview(t);if(a!=null)return a}return e(t)}l.formatNFMText=e,l.formatNFMTextPreview=s}),98);
__d("WAWebFormatOversizedMsg",["fbt"],(function(t,n,r,o,a,i,l,s){function e(e){return s._(/*BTDS*/"Este mensaje no se puede ver en WhatsApp Web. Puedes verlo en tu tel\u00e9fono.")}function u(e){return s._(/*BTDS*/"Este mensaje no se puede ver en WhatsApp Web. Puedes verlo en tu tel\u00e9fono.")}l.formatOversizedMsgText=e,l.formatOversizedMsgNotification=u}),226);
__d("WAWebRichResponseStrings",["fbt"],(function(t,n,r,o,a,i,l,s){"use strict";function e(){return s._(/*BTDS*/"A\u00fan no se admite este tipo de respuesta en este dispositivo. Visualiza la respuesta en tu tel\u00e9fono.")}l.getWholeRichResponseUnsupportedText=e}),226);
__d("WAWebFormatUnknownMsg",["fbt","WAWebCommonMsgUtils","WAWebMsgGetters","WAWebMsgType","WAWebRichResponseStrings"],(function(t,n,r,o,a,i,l,s){function e(e){return o("WAWebMsgGetters").getIsNewsletterMsg(e)?s._(/*BTDS*/"Recibiste una actualizaci\u00f3n de un canal en tu tel\u00e9fono, pero no es compatible con tu versi\u00f3n de WhatsApp web."):s._(/*BTDS*/"Recibiste un mensaje en tu tel\u00e9fono, pero no es compatible con esta versi\u00f3n de WhatsApp web.")}function u(e){return o("WAWebMsgGetters").getIsNewsletterMsg(e)?s._(/*BTDS*/"Enviaste una actualizaci\u00f3n de un canal desde tu tel\u00e9fono, pero no es compatible con tu versi\u00f3n de WhatsApp Web."):s._(/*BTDS*/"Enviaste un mensaje desde el tel\u00e9fono, pero no es compatible con esta versi\u00f3n de WhatsApp Web.")}function c(e){return o("WAWebMsgGetters").getIsNewsletterMsg(e)?s._(/*BTDS*/"Recibiste una actualizaci\u00f3n de un canal, pero no es compatible con tu versi\u00f3n de WhatsApp."):s._(/*BTDS*/"Recibiste un mensaje, pero no es compatible con esta versi\u00f3n de WhatsApp.")}function d(t){return o("WAWebMsgGetters").getIsSentByMe(t)?u(t):e(t)}function m(e){if(e.futureproofType===o("WAWebMsgType").MSG_TYPE.REACTION)return o("WAWebMsgGetters").getIsSentByMe(e)?s._(/*BTDS*/"Para ver reacciones, reinicia WhatsApp en tu computadora. Si sigues sin verlas, actualiza la aplicaci\u00f3n."):s._(/*BTDS*/"Recibiste una reacci\u00f3n. Actualiza la versi\u00f3n de WhatsApp para ver reacciones.");if(e.futureproofType===o("WAWebMsgType").MSG_TYPE.PROTOCOL&&e.futureproofSubtype==="message_edit")return o("WAWebMsgGetters").getIsSentByMe(e)?s._(/*BTDS*/"Enviaste un mensaje editado. Puedes verlo si tienes la versi\u00f3n m\u00e1s reciente de WhatsApp."):s._(/*BTDS*/"Recibiste un mensaje editado. Puedes verlo si tienes la versi\u00f3n m\u00e1s reciente de WhatsApp.");if(e.futureproofType===o("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT)return o("WAWebMsgGetters").getIsSentByMe(e)?d(e):s._(/*BTDS*/"Se conserv\u00f3 un mensaje de este chat para que no desapareciera.");if(e.futureproofType===o("WAWebMsgType").MSG_TYPE.PIN_MESSAGE)return o("WAWebMsgGetters").getIsSentByMe(e)?s._(/*BTDS*/"Usaste mensajes fijados en este chat. Actualiza WhatsApp a la versi\u00f3n m\u00e1s reciente en este dispositivo para poder usar mensajes fijados aqu\u00ed tambi\u00e9n."):s._(/*BTDS*/"Se usaron mensajes fijados en este chat. Actualiza WhatsApp a la versi\u00f3n m\u00e1s reciente para que t\u00fa tambi\u00e9n puedas ver y usar mensajes fijados.");if(e.futureproofType===o("WAWebMsgType").MSG_TYPE.ALBUM)return s._(/*BTDS*/"Archivos multimedia");if(e.type===o("WAWebMsgType").MSG_TYPE.AUTOMATED_GREETING_MESSAGE)return s._(/*BTDS*/"Este mensaje no se puede abrir en WhatsApp Web, pero puedes verlo en tu tel\u00e9fono.");if(o("WAWebCommonMsgUtils").isRichResponseMsg(e.type))return o("WAWebRichResponseStrings").getWholeRichResponseUnsupportedText();if(e.type===o("WAWebMsgType").MSG_TYPE.UNKNOWN&&e.futureproofType===o("WAWebMsgType").MSG_TYPE.CALL_LOG)return s._(/*BTDS*/"No se puede mostrar este mensaje aqu\u00ed. Para verlo, abre WhatsApp en tu tel\u00e9fono.");if(o("WAWebMsgGetters").getIsSentByMe(e))return d(e);switch(e.subtype){case"phone":return c(e);case"phone_only_feature":return s._(/*BTDS*/"Este mensaje no se puede abrir en WhatsApp Web, pero puedes verlo en tu tel\u00e9fono.");default:return d(e)}}function p(t){if(t.futureproofType===o("WAWebMsgType").MSG_TYPE.REACTION)return s._(/*BTDS*/"Recibiste una reacci\u00f3n. Actualiza la versi\u00f3n de WhatsApp para ver reacciones.");switch(t.subtype){case"phone":return c(t);case"phone_only_feature":return s._(/*BTDS*/"Este mensaje no se puede abrir en WhatsApp Web, pero puedes verlo en tu tel\u00e9fono.");default:return e(t)}}l.defaultFutureproofMsgText=d,l.formatUnknownMsgText=m,l.formatUnknownMsgNotification=p}),226);
__d("WAWebVcardUtils",["fbt","WATypeUtils","WAWebFbtIntlList","WAWebVcardParsingUtils","err","lodash"],(function(t,n,r,o,a,i,l,s){function e(e){var t,n,a=(t=e.ORG)==null?void 0:t[0],i=(n=e.TITLE)==null?void 0:n[0];if(a&&Array.isArray(a.value)&&a.value.length>0){var l,s=null;i!=null&&i.value&&(s=(""+i.value).trim());var u=a.value,c=u[0],d=babelHelpers.arrayLikeToArray(u).slice(1);d.push(c);var m=r("WAWebFbtIntlList")(d.map(function(e){return o("WATypeUtils").isString(e)?e.trim():""}).filter(function(e){return e.length}),r("WAWebFbtIntlList").CONJUNCTIONS.NONE,r("WAWebFbtIntlList").DELIMITERS.COMMA).toString();return(s||"")+((l=s)!=null&&l.length&&m.length?" - ":"")+m}return""}function u(e){var t,n=(t={jabber:s._(/*BTDS*/"Jabber"),"skype-username":s._(/*BTDS*/"Skype"),skype:s._(/*BTDS*/"Skype"),msn:s._(/*BTDS*/"Windows Live"),aim:s._(/*BTDS*/"AIM"),yahoo:s._(/*BTDS*/"Yahoo"),icq:s._(/*BTDS*/"ICQ"),"wa-biz-description":s._(/*BTDS*/"Descripci\u00f3n")},t[o("WAWebVcardParsingUtils").WA_BIZ_NAME]=s._(/*BTDS*/"Nombre de empresa"),t),a=e.properties["X-ABLabel"]||n[e.type.toLowerCase()];if(a!=null&&a!=="")return o("WAWebVcardParsingUtils").clean(String(a));var i={TEL:[[["cell"],s._(/*BTDS*/"Tel\u00e9fono m\u00f3vil")],[["iphone"],s._(/*BTDS*/"iPhone")],[["main"],s._(/*BTDS*/"Principal")],[["home","fax"],s._(/*BTDS*/"Fax de casa")],[["work","fax"],s._(/*BTDS*/"Fax de trabajo")],[["home"],s._(/*BTDS*/"Casa")],[["work"],s._(/*BTDS*/"Trabajo")],[["pager"],s._(/*BTDS*/"Pager")],[[],s._(/*BTDS*/"Casa")]],EMAIL:[[["home"],s._(/*BTDS*/"Casa")],[["work"],s._(/*BTDS*/"Trabajo")],[["internet"],s._(/*BTDS*/"Correo electr\u00f3nico")]],URL:[[["home"],s._(/*BTDS*/"Casa")],[["work"],s._(/*BTDS*/"Trabajo")]],ADR:[[["home"],s._(/*BTDS*/"Casa")],[["work"],s._(/*BTDS*/"Trabajo")]]};return a=e.type,r("lodash").forOwn(i,function(t){if(t){var n,r,o=t[0],i=t[1];if(Array.from(new Set(o).difference(new Set((n=(r=e.properties)==null||(r=r.type)==null?void 0:r.map(function(e){return e.toLowerCase()}))!=null?n:[]))).length===0)return a=i,!1}}),a}function c(e){return d(e.map(function(e){return e.displayName})).toString()}function d(e){var t=e.find(function(e){return!!e});return e.length?t?e.length===1?t:s._(/*BTDS*/"_j{\"*\":\"{contactName} y {count} contactos m\\u00e1s\",\"4\":\"{contactName} y {count} contacto m\\u00e1s\",\"_1\":\"{contactName} y 1 contacto m\\u00e1s\"}",[s._plural(e.length-1,"count"),s._param("contactName",t)]):s._(/*BTDS*/"_j{\"*\":\"{count} contactos\",\"4\":\"{count} contacto\",\"_1\":\"1 contacto\"}",[s._plural(e.length,"count")]):s._(/*BTDS*/"No hay contactos")}function m(e){if(e.length===0)throw r("err")("No vcards provided");return e.length===1?e[0]:{displayName:c(e),vcard:e.map(function(e){return e.vcard}).join("\n"),isMultiVcard:!0}}l.vcardGetOrganizationString=e,l.vcardGetType=u,l.getNameString=c,l.getNameStringFromNames=d,l.mergeVcards=m}),226);
__d("WAWebGetNotificationStrings",["fbt","WABidi","WALogger","WAWebAlbumsFormatAlbumMessageText","WAWebBizFormatInteractiveMsg","WAWebClock","WAWebContactCollection","WAWebContactGetters","WAWebCurrencyUtils","WAWebFormatBroadcastNotification","WAWebFormatCallLog","WAWebFormatE2ENotification","WAWebFormatEventDateString","WAWebFormatGroupNotification","WAWebFormatNfmText","WAWebFormatOversizedMsg","WAWebFormatPaymentMsg","WAWebFormatRevokedMsg","WAWebFormatUnknownMsg","WAWebFrontendMsgGetters","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebL10N","WAWebMsgGetters","WAWebMsgType","WAWebUA","WAWebUnformatMsg","WAWebVcardUtils","WAWebWidToFormattedNameOrNumber","cr:4404","fbs"],(function(t,n,r,o,a,i,l,s){var e,u,c,d,m=(e=n("cr:4404"))!=null?e:{},p=m.getNotificationBodyForPreviewOff;function _(e){var t,n,a,i,l,m=e.shouldShowNotificationPreview(),_=e.safe(),f="";if(p&&!m)return p().toString();switch(_.type){case"chat":{m&&(f=r("WAWebUnformatMsg")(e,e.body));break}case"image":{var h="";o("WAWebUA").UA.hasEmoji&&(h=_.isViewOnce?"1\uFE0F\u20E3 ":"\uD83D\uDCF7 "),f=h+(m&&r("WAWebUnformatMsg")(e,e.caption)||r("fbs")._(/*BTDS*/"Foto").toString());break}case"product":{var y=o("WAWebUA").UA.hasEmoji?"\uD83D\uDED2 ":"";f=y+(o("WAWebFrontendMsgGetters").getText(e)&&r("WAWebUnformatMsg")(e,o("WAWebFrontendMsgGetters").getText(e))||s._(/*BTDS*/"Producto").toString());break}case"interactive":{if(e.interactiveType===r("WAWebInteractiveMessageType").SHOPS_STOREFRONT){var C,b=o("WAWebUA").UA.hasEmoji?"\uD83D\uDECD\uFE0F  ":"";f=b+r("WAWebUnformatMsg")(e,e.body!=null?e.body:(C=e.interactiveHeader)==null?void 0:C.title)||"";break}if(e.interactiveType===r("WAWebInteractiveMessageType").NATIVE_FLOW&&e.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS){var v,S=e;f=o("WAWebBizFormatInteractiveMsg").formatOrderDetailsMessagePreview(S)||((v=e.caption)!=null?v:"");var R=o("WAWebUA").UA.hasEmoji?"\uD83D\uDCC3  ":"";f=R+f;break}if(e.interactiveType===r("WAWebInteractiveMessageType").NATIVE_FLOW&&e.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO){var L,E=e;f=o("WAWebBizFormatInteractiveMsg").formatPaymentInfoMessagePreview(E)||((L=e.caption)!=null?L:"");break}if(e.interactiveType===r("WAWebInteractiveMessageType").NATIVE_FLOW&&e.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS){var k,I=e;f=o("WAWebBizFormatInteractiveMsg").formatOrderStatusMessagePreview(I)||((k=e.caption)!=null?k:"");break}return o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["getNotificationBody: Unrecognized type ",""])),e.type),""}case"native_flow":if(e.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS){var T,D=e,x=o("WAWebUA").UA.hasEmoji?"\uD83D\uDCC3  ":"";f=x+(o("WAWebFormatNfmText").formatNFMTextPreview(D)||((T=e.caption)!=null?T:""));break}if(e.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO){var $,P=e;f=o("WAWebFormatNfmText").formatNFMTextPreview(P)||(($=e.caption)!=null?$:"");break}return o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["getNotificationBody: Unrecognized type ",""])),e.type),"";case"sticker":{var N=o("WAWebUA").UA.hasEmoji?"\uD83D\uDC9F":"";f=s._(/*BTDS*/"{stickerIcon} Sticker",[s._param("stickerIcon",N)]);break}case"video":{var M="",w;e.isGif?(M=o("WAWebUA").UA.hasEmoji?"\uD83D\uDC7E ":"",w=m&&r("WAWebUnformatMsg")(e,e.caption)||"GIF"):(o("WAWebUA").UA.hasEmoji&&(M=_.isViewOnce?"1\uFE0F\u20E3 ":"\uD83C\uDFA5 "),w=m&&r("WAWebUnformatMsg")(e,e.caption)||r("fbs")._(/*BTDS*/"Video").toString(),_.isViewOnce||(w=w+" ("+o("WAWebClock").Clock.durationStr(e.duration)+")")),f=""+M+w;break}case"ptv":{var A=o("WAWebUA").UA.hasEmoji?"\uD83C\uDFA5 ":"",F=m&&r("WAWebUnformatMsg")(e,e.caption)||s._(/*BTDS*/"Nota de video"),O=F.toString()+" ("+o("WAWebClock").Clock.durationStr(e.duration)+")";f=""+A+O;break}case"ptt":{var B="",W=s._(/*BTDS*/"Mensaje de voz").toString();o("WAWebUA").UA.hasEmoji&&(B=_.isViewOnce?"1\uFE0F\u20E3 ":"\uD83C\uDFA4 "),_.isViewOnce||(W=W+" ("+o("WAWebClock").Clock.durationStr(e.duration)+")"),f=""+B+W;break}case"audio":{var q=o("WAWebUA").UA.hasEmoji?"\uD83C\uDFB5 ":"";f=q+" "+r("fbs")._(/*BTDS*/"Audio").toString()+" ("+o("WAWebClock").Clock.durationStr(e.duration)+")";break}case"location":{var U=o("WAWebUA").UA.hasEmoji?"\uD83D\uDCCD ":"",V;e.isLive?V=m&&r("WAWebUnformatMsg")(e,e.comment)||s._(/*BTDS*/"Ubicaci\u00f3n en tiempo real").toString():V=m&&e.loc||r("fbs")._(/*BTDS*/"Ubicaci\u00f3n").toString(),f=U+" "+V;break}case"groups_v4_invite":f=s._(/*BTDS*/"Invitaci\u00f3n a grupo de WhatsApp");break;case"newsletter_admin_invite":f=s._(/*BTDS*/"Invitaci\u00f3n para ser admin. del canal de WhatsApp");break;case"gp2":f=r("WAWebFormatGroupNotification")(e,!0);break;case"broadcast_notification":f=r("WAWebFormatBroadcastNotification")(e);break;case"notification":f=(t=e.body)!=null?t:"";break;case"vcard":{var H=o("WAWebUA").UA.hasEmoji?"\uD83D\uDC64 ":"";f=H+(e.subtype||r("fbs")._(/*BTDS*/"Contacto").toString());break}case"multi_vcard":{var G=o("WAWebUA").UA.hasEmoji?"\uD83D\uDC65 ":"";f=G+o("WAWebVcardUtils").getNameString(e.vcardList).toString();break}case"document":{if(e.isVcardOverMmsDocument){var z=o("WAWebUA").UA.hasEmoji?"\uD83D\uDC64 ":"";f=z+(e.filename||s._(/*BTDS*/"_j{\"*\":\"{count} contactos\",\"4\":\"{count} contacto\",\"_1\":\"1 contacto\"}",[s._plural(e.pageCount,"count")]).toString());break}var j=o("WAWebUA").UA.hasEmoji?"\uD83D\uDCC4 ":"",K=e.caption;(e.caption==null||e.caption==="")&&(K=e.filename),f=j+(m&&r("WAWebUnformatMsg")(e,K)||r("fbs")._(/*BTDS*/"Documento").toString());break}case"e2e_notification":f=o("WAWebFormatE2ENotification").formatE2ENotification(_);break;case"call_log":f=r("WAWebFormatCallLog")(e);break;case"ciphertext":f=s._(/*BTDS*/"Esperando el mensaje. Esto puede demorar un poco.");break;case"revoked":f=o("WAWebFormatRevokedMsg").formatRevokedMsg(_);break;case"payment":f=g(e);break;case"oversized":f=o("WAWebFormatOversizedMsg").formatOversizedMsgNotification(e);break;case"unknown":f=o("WAWebFormatUnknownMsg").formatUnknownMsgNotification(e);break;case"list":f=(((n=e.list)==null?void 0:n.title)||"")+" "+(((a=e.list)==null?void 0:a.description)||"");break;case"list_response":f=(((i=e.listResponse)==null?void 0:i.title)||"")+" "+(((l=e.listResponse)==null?void 0:l.description)||"");break;case"poll_result_snapshot":case"poll_creation":{var Q=o("WAWebUA").UA.hasEmoji?"\uD83D\uDCCA ":"";f=""+Q+r("WAWebUnformatMsg")(e,e.pollName);break}case"event_creation":{var X,Y=o("WAWebUA").UA.hasEmoji?"\uD83D\uDCC6 ":"",J=e.eventStartTime!=null?o("WAWebFormatEventDateString").getEventDateStringFor(e.eventStartTime,(X=e.eventEndTime)!=null?X:void 0):null;f=s._(/*BTDS*/"{eventIcon} Te invitaron a un evento: {eventName} {eventTime}",[s._param("eventIcon",Y),s._param("eventName",e.eventName),s._param("eventTime",J)]);break}case"album":{var Z=o("WAWebUA").UA.hasEmoji?"\uD83D\uDCF7 ":"",ee=r("WAWebAlbumsFormatAlbumMessageText")({msg:e,options:{}});f=s._(/*BTDS*/"{albumIcon}{photoAndVideoCountText}",[s._param("albumIcon",Z),s._param("photoAndVideoCountText",ee)]);break}case"order":{var te=o("WAWebUA").UA.hasEmoji?"\uD83D\uDED2 ":"";f=s._(/*BTDS*/"_j{\"*\":\"{shoppingCartIcon}{count} art\\u00edculos{message}\",\"4\":\"{shoppingCartIcon}{count} art\\u00edculo{message}\",\"_1\":\"{shoppingCartIcon}1 art\\u00edculo{message}\"}",[s._plural(e.itemCount,"count"),s._param("shoppingCartIcon",te),s._param("message",e.message!=null&&e.message!==""?"\n"+e.message:"")]);break}case"sticker-pack":{var ne=o("WAWebUA").UA.hasEmoji?"\uD83D\uDC9F ":"";f=s._(/*BTDS*/"{stickerPackIcon} Paquete de stickers",[s._param("stickerPackIcon",ne)]);break}case"quarantined":{var re=o("WAWebUA").UA.hasEmoji?"\uD83D\uDCC4 ":"",oe=e.quarantineExtractedText!=null&&e.quarantineExtractedText!==""?e.quarantineExtractedText:s._(/*BTDS*/"Attachment blocked by Strict account settings").toString();f=""+re+oe;break}case"notification_template":case"protocol":case"hsm":case"template_button_reply":case"debug":case"debug_placeholder":case"interactive_response":case"keep_in_chat":case"request_phone_number":case"automated_greeting_message":case"rich_response":case o("WAWebMsgType").MSG_TYPE.MESSAGE_HISTORY_BUNDLE:case"message_history_notice":return"";default:return _.type,o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["getNotificationBody: Unrecognized type ",""])),e.type),""}return f.toString()}function f(e){var t=e.msgDir,n=r("WAWebL10N").isRTL()?"rtl":"ltr";if(e.body&&e.author==null&&e.action==null)return e.body;var a=e.body,i=e.author,l=e.action;if(i==null&&(i=""),l==null?l="":l=n==="ltr"?r("WAWebL10N").isolateLTR(l):r("WAWebL10N").isolateRTL(l),i){var s=o("WABidi").dir(i);return n==="ltr"&&(!t||t==="ltr")&&(!s||s==="ltr")?l?i+"\u200E: "+l+"\u200E "+a+"\u200E":i+"\u200E: "+a+"\u200E":n==="ltr"&&(!t||t==="ltr")?l?"\u200E\u202B"+i+"\u202C: "+l+"\u200E "+a+"\u200E":"\u200E\u202B"+i+"\u202C: "+a+"\u200E":n==="ltr"&&(!s||s==="ltr")?l?i+"\u200E: "+l+"\u200E \u202B"+a+"\u202C\u200E":i+"\u200E: \u202B"+a+"\u202C\u200E":n==="ltr"?l?"\u202B"+i+"\u200F: "+l+" "+a+"\u200F":"\u202B"+i+"\u200F: "+a+"\u200F":(!t||t==="rtl")&&(!s||s==="rtl")?l?i+"\u200F: "+l+"\u200F "+a+"\u200F":i+"\u200F: "+a+"\u200F":!t||t==="rtl"?l?"\u200F\u202A"+i+"\u202C: "+l+"\u200F "+a+"\u200F":"\u200F\u202A"+i+"\u202C: "+a+"\u200F":!s||s==="rtl"?l?i+"\u200F: "+l+"\u200F \u202A"+a+"\u202C\u200F":i+"\u200F: \u202A"+a+"\u202C\u200F":l?"\u202A"+i+"\u200E: "+l+" "+a+"\u200E":"\u202A"+i+"\u200E: "+a+"\u200E$"}return l?l+" "+a:a}function g(e){if(e.subtype==="invite")return o("WAWebFormatPaymentMsg").formatPaymentInviteMessageText(e.id);var t=e.paymentCurrency&&e.paymentAmount1000;if(!t)return s._(/*BTDS*/"Mensaje de Pagos \u2022 Importe no disponible");if(e.subtype!=="send"&&e.subtype!=="request")return s._(/*BTDS*/"Mensaje de pago. Abre WhatsApp en tu tel\u00e9fono para ver.");var n,a=o("WAWebCurrencyUtils").formatAmount1000(e.paymentCurrency,e.paymentAmount1000),i=r("WAWebWidToFormattedNameOrNumber")(o("WAWebMsgGetters").getSender(e)),l=r("WAWebWidToFormattedNameOrNumber")(e.paymentMessageReceiverJid),u=o("WAWebContactCollection").ContactCollection.get(e.paymentMessageReceiverJid),c=u!=null&&o("WAWebContactGetters").getIsMe(u),d=e.paymentAmount1000/1e3;return e.subtype==="send"?o("WAWebMsgGetters").getIsGroupMsg(e)?n=c?s._(/*BTDS*/"_j{\"*\":\"{senderName} te envi\\u00f3 {amount}\"}",[s._param("amount",a,[0,d]),s._param("senderName",i)]):s._(/*BTDS*/"_j{\"*\":\"{senderName} envi\\u00f3 {amount} a {receiverName}\"}",[s._param("amount",a,[0,d]),s._param("senderName",i),s._param("receiverName",l)]):n=s._(/*BTDS*/"_j{\"*\":\"Te envi\\u00f3 {amount}\"}",[s._param("amount",a,[0,d])]):o("WAWebMsgGetters").getIsGroupMsg(e)?n=c?s._(/*BTDS*/"_j{\"*\":\"{senderName} te solicit\\u00f3 {amount}\"}",[s._param("amount",a,[0,d]),s._param("senderName",i)]):s._(/*BTDS*/"_j{\"*\":\"{senderName} solicit\\u00f3 {amount} a {receiverName}\"}",[s._param("amount",a,[0,d]),s._param("senderName",i),s._param("receiverName",l)]):n=s._(/*BTDS*/"_j{\"*\":\"Te solicit\\u00f3 {amount}\"}",[s._param("amount",a,[0,d])]),n}function h(e){return e===void 0&&(e=1),s._(/*BTDS*/"_j{\"*\":\"{newMessageCount} mensajes nuevos\",\"_1\":\"1 mensaje nuevo\"}",[s._plural(e,"newMessageCount")])}h.displayName=h.name+" [from "+i.id+"]",l.getNotificationMessageBody=_,l.getNotificationBody=f,l.getPluralMessageNotificationBody=h}),226);
__d("WAWebNotificationBackend",["Promise","WAWebAiHandoffNotification","WAWebCommentNotification","WAWebMsgGetters","WAWebNotificationController","WAWebNotificationsDeviceSwitchNotification","WAWebNotificationsMsgNotification","WAWebNotificationsReactionNotification","WAWebNotificationsStatusReactionNotification","WAWebPollsVoteNotification","WAWebStatusGatingUtils","WAWebStatusNotification"],(function(t,n,r,o,a,i,l){var e;function s(e){return o("WAWebNotificationController").WANotificationController.triggerNotification(new(o("WAWebNotificationsMsgNotification")).WAMsgNotification({msg:e}))}function u(e){return o("WAWebStatusGatingUtils").isStatusLikesReceiveEnabled()&&o("WAWebMsgGetters").getIsStatus(e)?o("WAWebNotificationController").WANotificationController.triggerNotification(new(o("WAWebNotificationsStatusReactionNotification")).WAStatusReactionNotification({reactionMsg:e})):o("WAWebNotificationController").WANotificationController.triggerNotification(new(o("WAWebNotificationsReactionNotification")).WAReactionNotification({reactionMsg:e}))}function c(e){return o("WAWebNotificationController").WANotificationController.triggerNotification(new(o("WAWebCommentNotification")).WACommentNotification({commentMsg:e}))}function d(e){return o("WAWebNotificationController").WANotificationController.closeOrCancelNotification("comment:"+e.toString())}function m(t){var r=new(o("WAWebPollsVoteNotification")).PollVoteNotification({creationMsg:t}),a=o("WAWebNotificationController").WANotificationController.getNotification(r.buildKey());return a instanceof o("WAWebPollsVoteNotification").PollVoteNotification&&a.bodyText===r.bodyText?(e||(e=n("Promise"))).resolve():o("WAWebNotificationController").WANotificationController.triggerNotification(r)}function p(e){return o("WAWebNotificationController").WANotificationController.triggerNotification(new(o("WAWebNotificationsDeviceSwitchNotification")).WADeviceSwitchNotification(e))}function _(e){return o("WAWebNotificationController").WANotificationController.triggerNotification(new(o("WAWebAiHandoffNotification")).AiHandoffNotification({chat:e}))}function f(){o("WAWebNotificationController").WANotificationController.closeOrCancelAllNotifications()}function g(e){o("WAWebNotificationController").WANotificationController.closeOrCancelNotificationsForChat(e)}function h(e){return o("WAWebNotificationController").WANotificationController.triggerNotification(new(o("WAWebStatusNotification")).WAStatusNotification({msg:e}))}function y(e){o("WAWebNotificationController").WANotificationController.setAppContext(e)}l.showMsgNotification=s,l.showReactionNotification=u,l.showCommentNotification=c,l.removeCommentNotification=d,l.showPollVoteNotification=m,l.showDeviceSwitchNotification=p,l.showAiHandoffNotification=_,l.shutdownAsNeeded=f,l.closeNotifications=g,l.showStatusNotification=h,l.setAppContext=y}),98);
__d("WAWebNotificationBanner",["WAWebBaseNotificationBanner","WAWebEmoji","WAWebURLUtils"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(t){var n=t.wid,a=t.msgId,i=t.tag,l=t.title,s=t.body,u=t.icon,c=t.onClick,d=t.renotify,m=t.doNotOpenChat,p=t.key,_=t.footer,f=t.isReplyable,g=t.contextMenuItems,h=t.suppressBanner;return e.call(this,n,a,i,p,{title:o("WAWebEmoji").EmojiUtil.normalizeAllEmojis(l),notification:window.Notification,body:o("WAWebEmoji").EmojiUtil.normalizeAllEmojis(s),icon:r("WAWebURLUtils").relToAbs(u),onClick:c,renotify:d,doNotOpenChat:m,footer:_,isReplyable:f,contextMenuItems:g,suppressBanner:h})||this}return babelHelpers.inheritsLoose(t,e),t})(r("WAWebBaseNotificationBanner"));l.default=e}),98);
__d("WAWebNotificationController",["WAAbortError","WALogger","WAWebCmd","WAWebEnvironment","WAWebFrontendMsgGetters","WAWebNotificationsMsgNotification","asyncToGeneratorRuntime","cr:4692"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_=(e=n("cr:4692"))!=null?e:null,f=(function(){function e(){var e=this;this.map=new Map,this.lastMsgNotifByChat=new Map,this.$1=null,this.$2=null,_&&(this.$1=new _(this)),r("WAWebEnvironment").isWindows&&o("WAWebCmd").Cmd.on("offline_delivery_end",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["WANotificationController: show lastest unread msg due to offline delivery end"]))),e.$3()}))}var t=e.prototype;return t.notificationExists=function(t){return this.map.has(t)},t.getNotification=function(t){return this.map.get(t)},t.closeOrCancelNotification=function(t){var e=this.getNotification(t);e&&(e.notificationBanner?e.notificationBanner.close():e.abortController&&e.abortController.abort(),this.$4(t))},t.closeOrCancelAllNotifications=function(){var e=this;this.map.forEach(function(t,n){e.closeOrCancelNotification(n)})},t.closeOrCancelNotificationsForChat=function(t){var e=this;this.map.forEach(function(n,r){n.matchesChat(t)&&e.closeOrCancelNotification(r)})},t.triggerNotification=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this,n=e.buildKey();this.$5(n,e);try{var r,a=yield e.triggerNotification((r=this.$2)==null?void 0:r.call(this));if(a!=null){if(o("WAWebNotificationsMsgNotification").shouldReplaceMsgNotificationManually()&&e instanceof o("WAWebNotificationsMsgNotification").WAMsgNotification){var i=o("WAWebFrontendMsgGetters").getChat(e.msg).id.toString(),l=this.lastMsgNotifByChat.get(i);l&&self.setTimeout(function(){return l.close()},2e3),this.lastMsgNotifByChat.set(i,a),a.waitForClose().then(function(){t.lastMsgNotifByChat.get(i)===a&&t.lastMsgNotifByChat.delete(i)})}a.waitForClose().then(function(){t.$4(n)})}else o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["WANotificationController: notification not invoked:"]))).devConsole(e),this.$4(n)}catch(r){o("WAAbortError").catchAbort(function(r){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["WANotificationController: notification aborted: ",""])),r).devConsole(e),t.$4(n)})(r)}return e});function t(t){return e.apply(this,arguments)}return t})(),t.setAppContext=function(t){this.$2=t},t.$3=function(){var e=null;this.map.forEach(function(t,n){(e==null||t.creationAt>e.creationAt)&&(e=t)}),e?this.triggerNotification(e):o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["WANotificationController: showLastestUnreadMsgNotification: no unread msg notification found"])))},t.$5=function(t,n){this.map.set(t,n)},t.$4=function(t,n){var e=this.getNotification(t);if(e==null){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["WANotificationController:_removeNotificationFromMap cannot find notification in map with key: ",""])),t);return}if(n!=null&&e!==n){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["WANotificationController:_removeNotificationFromMap not removing due to strict equality"])));return}this.map.delete(t)},e})(),g=new f;l.WANotificationController=g}),98);
__d("WAWebNotificationHelpers",["fbt","WANullthrows","WAWebABProps","WAWebChatCollection","WAWebChatGetters","WAWebCmd","WAWebEnvironment","WAWebFbtCommon","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebGroupMetadataCollection","WAWebMsgGetters","WAWebMuteCollection","WAWebMuteGetters","WAWebNotificationConstants","WAWebOfflineHandler","WAWebParticipantListUtils","WAWebQuotedMsgModelUtils","WAWebSettingsGetters","WAWebSettingsModel","WAWebUserPrefsNotifications","gkx"],(function(t,n,r,o,a,i,l,s){function e(){return document.hasFocus()}function u(){return o("WAWebOfflineHandler").OfflineMessageHandler.isResumeOnSocketDisconnectInProgress()||!o("WAWebCmd").Cmd.isOfflineDeliveryEnd}function c(e,t){if(t===void 0&&(t=!0),!o("WAWebChatGetters").getIsGroup(e)||o("WAWebChatGetters").getIsGroup(e)&&e.isReadOnly)return!1;var n=Date.now(),a=e.squelch||0;return n>a?(t&&r("WAWebGroupMetadataCollection").find(e.id).then(function(t){if(t!=null){var n=d(e.id,t);e.squelch=Date.now()+n}}),!1):!0}function d(e,t){var n=t.participants.length;return Math.min(120,30+5*n)*1e3}function m(e){var t;return!!((t=o("WAWebFrontendMsgGetters").getChat(e).groupMetadata)!=null&&t.isParentGroup)}function p(e){return r("gkx")("26258")||!o("WAWebMsgGetters").getIsGroupMsg(e)||f(e)?!1:!!o("WAWebUserPrefsNotifications").getIgnoreNondirectGroupMsg()}function _(e){var t=o("WAWebFrontendMsgGetters").getChat(e);if(t==null||!o("WAWebMuteGetters").getIsMuted(t.mute))return!1;if(!o("WAWebChatGetters").getIsGroup(t))return!0;if(f(e)){var n=o("WAWebChatCollection").ChatCollection.get(o("WAWebMsgGetters").getSender(e));return n!=null&&o("WAWebMuteGetters").getIsMuted(n.mute)===!0}return!0}function f(e){return e.isMeMentioned()||o("WAWebQuotedMsgModelUtils").isMyQuotedMsg(e)}function g(e){var t=o("WAWebFrontendMsgGetters").getChat(e);if(!o("WAWebSettingsGetters").getShowArchiveV2(r("WAWebSettingsModel"))||!t.archive)return!1;if(!o("WAWebChatGetters").getIsGroup(t))return!0;if(f(e)){var n=o("WAWebChatCollection").ChatCollection.get(o("WAWebMsgGetters").getSender(e));return n!=null&&o("WAWebMuteGetters").getIsMuted(n.mute)===!0}return!0}function h(e){return o("WAWebChatGetters").getIsGroup(e)?s._(/*BTDS*/"Mensaje de grupo de WhatsApp"):s._(/*BTDS*/"Mensaje de WhatsApp")}function y(e){var t;if(e.isLocked)return r("WAWebFbtCommon")("WhatsApp").toString();if((t=e.groupMetadata)!=null&&t.isUnnamed)return o("WAWebParticipantListUtils").calculateUnnamedGroupFullParticipantsList(r("WANullthrows")(e.groupMetadata),!0);var n=e.msgs.last();if((n==null?void 0:n.subtype)==="sender_invite"){var a=o("WAWebFrontendContactGetters").getFormattedName(e.contact);return n!=null&&n.templateParams&&(n==null?void 0:n.templateParams[0])==="true"?s._(/*BTDS*/"{receiver_name} acept\u00f3 tu invitaci\u00f3n.",[s._param("receiver_name",a)]).toString():s._(/*BTDS*/"{receiver_name} se uni\u00f3 a WhatsApp.",[s._param("receiver_name",a)]).toString()}return o("WAWebFrontendContactGetters").getFormattedName(e.contact)||h(e).toString()}function C(t){return r("WAWebEnvironment").isWindows?e()&&(t==null?void 0:t.isChatsSurfaceActive)===!0:e()}function b(e){var t=o("WAWebABProps").getABPropConfigValue("wa_web_enable_granular_notifications");if(!t)return o("WAWebMuteCollection").MuteCollection.getGlobalSounds();if(e&&t){var n=o("WAWebChatGetters").getIsGroup(e);return n?o("WAWebMuteCollection").MuteCollection.getGlobalGroupSoundsEnabled():o("WAWebMuteCollection").MuteCollection.getGlobalSoundsEnabled()}return!0}function v(e){var t;if(!r("WAWebEnvironment").isWindows&&((t=window.Notification)==null?void 0:t.permission)!==o("WAWebNotificationConstants").PERMISSION_ALLOWED)return!1;var n=o("WAWebABProps").getABPropConfigValue("wa_web_enable_granular_notifications");if(!n)return o("WAWebMuteCollection").MuteCollection.getGlobalNotifications();if(e&&n){var a=o("WAWebChatGetters").getIsGroup(e);return a?o("WAWebMuteCollection").MuteCollection.getGlobalGroupNotificationsEnabled():o("WAWebMuteCollection").MuteCollection.getGlobalNotificationsEnabled()}return!0}l.appIsActive=e,l.isOfflineResumeInProgress=u,l.shouldSquelch=c,l._calculateTimeoutFromGroupMetadata=d,l.isCommunityHomeAdd=m,l.shouldIgnoreGroupMsg=p,l.isMutedAndNotMentioned=_,l.isMeUserMentionedOrQuoted=f,l.isArchivedAndNotMentioned=g,l.getNotificationTitle=y,l.shouldMuteDueToAppState=C,l.shouldPlaySoundGranular=b,l.shouldEnableNotificationGranular=v}),226);
__d("WAWebNotificationIconUtils",["WAAbortError","WACustomError","WAFilteredCatch","WALogger","WAPromiseRaceAbort","WAPromiseTimeout","WAWebChatGetters","WAWebNotificationTone","WAWebProfilePicThumbCollection","asyncToGeneratorRuntime","bx"],(function(t,n,r,o,a,i,l){var e,s,u=(s=r("bx")).getURL(s("11319")),c=s.getURL(s("9555")),d=s.getURL(s("9556")),m=s.getURL(s("11370"));function p(e){return o("WAWebChatGetters").getIsNewsletter(e)?m:o("WAWebChatGetters").getIsGroup(e)?c:d}function _(e,t,n){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){return e.isLocked?u:g(e.id,t,n!=null?n:p(e))}),f.apply(this,arguments)}function g(t,n,a){return o("WAPromiseTimeout").promiseTimeout(r("WAPromiseRaceAbort")(o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.find(t),n),1500,"showNotificationTimeout").then(function(e){var t;if(n.aborted)throw new(o("WAAbortError")).AbortError;var r=(t=e==null?void 0:e.img)!=null?t:a;return o("WAWebNotificationTone").cachePath(r)}).catch(o("WAFilteredCatch").filteredCatch(o("WACustomError").TimeoutError,function(n){return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["NotificationBackend:IconLoadTimeoutError:",""])),t.toString()).devConsole(n),o("WAWebNotificationTone").cachePath(a)}))}l.USER_DEFAULT_ICON=d,l.getDefaultChatNotificationIcon=p,l.getChatNotificationIcon=_,l.getNotificationIconByWid=g}),98);
__d("WAWebNotificationsChatAssignmentNotification",["fbt","WANullthrows","WAWebBaseNotification","WAWebChatCollection","WAWebChatGetters","WAWebConnModel","WAWebFrontendChatGetters","WAWebGetNotificationStrings","WAWebMuteGetters","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebNotificationMuteReason","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l,s){var e=(function(e){function t(t){var n,a,i=t.chats,l=t.assignmentTimestamps;return a=e.call(this)||this,a.$WAWebNotificationsChatAssignmentNotification$p_1=function(){},a.chats=i.map(function(e){return o("WAWebChatCollection").ChatCollection.get(e)}).filter(function(e){return e!=null}),a.primaryChat=r("WANullthrows")(a.chats[0]),a.assignmentTimestamps=l,a.businessName=(n=o("WAWebConnModel").Conn.pushname)!=null?n:s._(/*BTDS*/"Admin.").toString(),a}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a.shouldPlaySound=function(){return e.prototype.shouldPlaySound.call(this)?o("WAWebNotificationHelpers").shouldPlaySoundGranular(this.primaryChat):!1},a.shouldShowBanner=function(){return e.prototype.shouldShowBanner.call(this)?o("WAWebNotificationHelpers").shouldEnableNotificationGranular(this.primaryChat):!1},a.shouldMute=function(t){return o("WAWebNotificationHelpers").shouldMuteDueToAppState(t)?r("WAWebNotificationMuteReason").AppState:this.chats.filter(function(e){return e&&o("WAWebMuteGetters").getIsMuted(e.mute)}).length===this.chats.length?r("WAWebNotificationMuteReason").MutedChat:this.chats.filter(function(e){return e==null?void 0:e.archive}).length===this.chats.length?r("WAWebNotificationMuteReason").ArchivedChat:o("WAWebNotificationHelpers").isOfflineResumeInProgress()?r("WAWebNotificationMuteReason").OfflineResumeInProgress:null},a.buildKey=function(){return"chat_assignment:"+this.chats.map(function(e){return e==null?void 0:e.id.toString()}).join("-")+this.assignmentTimestamps},a.matchesChat=function(t){return this.chats.length>1?!1:this.primaryChat.equals(t)},a.getChatKind=function(){return o("WAWebFrontendChatGetters").getKind(this.primaryChat)},a.performLogging=function(){},a.getIcon=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebNotificationIconUtils").getNotificationIconByWid(o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),this.abortController.signal,o("WAWebNotificationIconUtils").USER_DEFAULT_ICON)});function t(){return e.apply(this,arguments)}return t})(),a.getBannerOptions=function(){var e=o("WAWebGetNotificationStrings").getNotificationBody(babelHelpers.extends({},u(this.primaryChat,this.businessName,this.chats.length)));return{wid:this.primaryChat.id,title:this.businessName,body:e,onClick:this.$WAWebNotificationsChatAssignmentNotification$p_1}},t})(o("WAWebBaseNotification").WABaseNotification);function u(e,t,n){var r;return n===1?o("WAWebChatGetters").getIsGroup(e)?r=s._(/*BTDS*/"{businessName} te asign\u00f3 el chat con el grupo {chatName}.",[s._param("businessName",t),s._param("chatName",e.formattedTitle)]):r=s._(/*BTDS*/"{businessName} te asign\u00f3 un chat con {chatName}.",[s._param("businessName",t),s._param("chatName",e.formattedTitle)]):r=s._(/*BTDS*/"{businessNme} te asign\u00f3 {numberOfChats}.",[s._param("businessNme",t),s._param("numberOfChats",n)]),{body:r.toString()}}l.WAWebNotificationsChatAssignmentNotification=e}),226);
__d("WAWebNotificationsDeviceSwitchNotification",["fbt","WAWebBaseNotification","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebNotificationMuteReason","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l,s){var e=(function(e){function t(t){var n,r=t.wid,o=t.otpCode;return n=e.call(this)||this,n.wid=r,n.otpCode=o,n}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a.shouldMute=function(t){return o("WAWebNotificationHelpers").appIsActive()?r("WAWebNotificationMuteReason").AppState:null},a.buildKey=function(){return"registration:"+this.wid.toString()},a.getChatKind=function(){return null},a.getIcon=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebNotificationIconUtils").getNotificationIconByWid(this.wid,this.abortController.signal,o("WAWebNotificationIconUtils").USER_DEFAULT_ICON)});function t(){return e.apply(this,arguments)}return t})(),a.getBannerOptions=function(){var e=s._(/*BTDS*/"No lo compartas con nadie. Tu c\u00f3digo es {otpCode}.",[s._param("otpCode",this.otpCode)]).toString(),t=s._(/*BTDS*/"C\u00f3digo para el tel\u00e9fono nuevo").toString();return{wid:this.wid,title:t,body:e,doNotOpenChat:!0}},t})(o("WAWebBaseNotification").WABaseNotification);l.WADeviceSwitchNotification=e}),226);
__d("WAWebMediaUtils",["WABinary"],(function(t,n,r,o,a,i,l){function e(e){return btoa(String.fromCharCode.apply(null,o("WABinary").Binary.build(e).readByteArrayView()))}function s(t){return"data:image/jpeg;base64,"+e(t)}l.convertToBase64=e,l.convertToDataURI=s}),98);
__d("WAWebNotificationsMsgNotification",["fbt","WAWebBaseNotification","WAWebBizAiAgentStatusUtils","WAWebBotGating","WAWebBotTypes","WAWebChatThreadLogging","WAWebElevatedPushNamesFlag","WAWebEnvironment","WAWebFrontendChatGetters","WAWebFrontendMsgGetters","WAWebGetNotificationStrings","WAWebGroupSafetyCheckUtils","WAWebMediaUtils","WAWebMsgGetters","WAWebMsgType","WAWebNotificationController","WAWebNotificationEngagementWamEvent","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebNotificationMuteReason","WAWebUA","WAWebViewMode.flow","WAWebViewModeUtils","WAWebVoipGatingUtils","asyncToGeneratorRuntime","cr:3133","cr:4404","gkx"],(function(t,n,r,o,a,i,l,s){var e,u,c=(e=n("cr:3133"))!=null?e:{},d=c.shouldIgnoreSquelchForGroupMention,m=c.isReplyable,p=c.getContextMenuItems,_=(u=n("cr:4404"))!=null?u:{},f=_.getMessageNotificationFooter,g=_.getNotificationBodyForPreviewOff,h=new Set([o("WAWebMsgType").MSG_TYPE.ALBUM]),y=(function(e){function t(t){var n,r=t.msg;return n=e.call(this)||this,n.msg=r,n}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a.shouldPlaySound=function(){if(!e.prototype.shouldPlaySound.call(this))return!1;var t=o("WAWebFrontendMsgGetters").getChat(this.msg);return o("WAWebNotificationHelpers").shouldPlaySoundGranular(t)&&!o("WAWebMsgGetters").getIsEdited(this.msg)},a.shouldShowBanner=function(){if(!e.prototype.shouldShowBanner.call(this))return!1;var t=o("WAWebFrontendMsgGetters").getChat(this.msg);return o("WAWebNotificationHelpers").shouldEnableNotificationGranular(t)},a.shouldMute=function(t){if(r("WAWebEnvironment").isWindows&&this.msg.viewed)return r("WAWebNotificationMuteReason").IgnoreViewedMsgs;var e=o("WAWebFrontendMsgGetters").getChat(this.msg);return o("WAWebNotificationHelpers").shouldMuteDueToAppState(t)?r("WAWebNotificationMuteReason").AppState:o("WAWebGroupSafetyCheckUtils").shouldMuteMentionWhileGroupSafetyChecked(this.msg)?r("WAWebNotificationMuteReason").GroupSafetyCheck:o("WAWebNotificationHelpers").isMutedAndNotMentioned(this.msg)?r("WAWebNotificationMuteReason").MutedChat:o("WAWebNotificationHelpers").isArchivedAndNotMentioned(this.msg)?r("WAWebNotificationMuteReason").ArchivedChat:o("WAWebNotificationHelpers").isCommunityHomeAdd(this.msg)?r("WAWebNotificationMuteReason").IgnoreAddedToCommunityHome:!r("gkx")("26258")&&o("WAWebNotificationHelpers").shouldIgnoreGroupMsg(this.msg)?r("WAWebNotificationMuteReason").IgnoreGroupMsg:o("WAWebMsgGetters").getIsFutureproof(this.msg)?r("WAWebNotificationMuteReason").IgnoreFutureProof:o("WAWebNotificationHelpers").isOfflineResumeInProgress()?r("WAWebNotificationMuteReason").OfflineResumeInProgress:o("WAWebMsgGetters").getIsBizContentPlaceholder(this.msg)?r("WAWebNotificationMuteReason").IgnoreBizContentPlaceholder:o("WAWebMsgGetters").getIsCallSilenced(this.msg)||o("WAWebVoipGatingUtils").isCallingEnabled()&&this.msg.type===o("WAWebMsgType").MSG_TYPE.CALL_LOG&&this.msg.subtype==null?r("WAWebNotificationMuteReason").IgnoreCallMsgs:e.id.isBot()&&(!o("WAWebBotGating").isBotEnabled()||this.msg.botMsgBodyType===o("WAWebBotTypes").BotMsgBodyType.VOICE)?r("WAWebNotificationMuteReason").IgnoreBotMsgs:C(this.msg)?r("WAWebNotificationMuteReason").IgnoreInternalSilentTag:o("WAWebViewModeUtils").isViewModeVisibleInSurface(o("WAWebViewMode.flow").ViewModeSurface.NOTIFICATION,this.msg.viewMode)?o("WAWebBizAiAgentStatusUtils").shouldMuteNotification(e)?r("WAWebNotificationMuteReason").AIRepliesOn:null:r("WAWebNotificationMuteReason").IgnoreHiddenViewModeMsgs},a.shouldSquelch=function(){var e=o("WAWebNotificationController").WANotificationController.notificationExists(this.buildKey());return e&&(o("WAWebMsgGetters").getIsEdited(this.msg)||h.has(this.msg.type))||d!=null&&d(this.msg)?null:o("WAWebNotificationHelpers").shouldSquelch(o("WAWebFrontendMsgGetters").getChat(this.msg))?r("WAWebNotificationMuteReason").GroupFlood:null},a.buildKey=function(){var e,t;return"msg:"+((e=(t=this.msg.latestEditMsgKey)==null?void 0:t.toString())!=null?e:this.msg.id.toString())},a.matchesChat=function(t){return t.equals(o("WAWebFrontendMsgGetters").getMaybeChat(this.msg))},a.getChatKind=function(){return o("WAWebFrontendChatGetters").getKind(o("WAWebFrontendMsgGetters").getChat(this.msg))},a.getDefaultIcon=function(){return o("WAWebMsgGetters").getIsProductListMessage(this.msg)?o("WAWebMediaUtils").convertToDataURI(o("WAWebMsgGetters").getProductListHeaderImage(this.msg)):o("WAWebNotificationIconUtils").getDefaultChatNotificationIcon(o("WAWebFrontendMsgGetters").getChat(this.msg))},a.getIcon=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebNotificationIconUtils").getChatNotificationIcon(o("WAWebFrontendMsgGetters").getChat(this.msg),this.abortController.signal,this.getDefaultIcon())});function t(){return e.apply(this,arguments)}return t})(),a.getBannerOptions=function(){var e=this.msg,t=b(e),a=o("WAWebGetNotificationStrings").getNotificationBody(babelHelpers.extends({},t,{msgDir:o("WAWebFrontendMsgGetters").getDir(e)})),i=o("WAWebFrontendMsgGetters").getChat(this.msg),l=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebChatThreadLogging").getChatThreadID(i.id.toJid());new(o("WAWebNotificationEngagementWamEvent")).NotificationEngagementWamEvent({threadId:e}).commit()});return function(){return e.apply(this,arguments)}})();return{wid:i.id,msgId:this.msg.id.toString(),tag:v()?this.msg.id.toString():i.id.toString(),title:o("WAWebNotificationHelpers").getNotificationTitle(i),body:a,onClick:function(){r("gkx")("26258")||l()},renotify:!o("WAWebMsgGetters").getIsEdited(this.msg),footer:t.footer,contextMenuItems:this.getContextMenuItems()}},a.isReplyable=function(){var e;return(e=m==null?void 0:m(this.msg))!=null?e:!1},a.getContextMenuItems=function(){var e;return(e=p==null?void 0:p(this.msg))!=null?e:[]},t})(o("WAWebBaseNotification").WABaseNotification);function C(e){var t;return!r("gkx")("26258")&&((t=e.body)==null||(t=t.toLowerCase())==null?void 0:t.includes("@silent"))===!0}function b(e){var t,n=null,r=o("WAWebFrontendMsgGetters").getChat(e),a=o("WAWebElevatedPushNamesFlag").elevatedPushNamesM2Enabled(r),i=o("WAWebMsgGetters").getIsGroupMsg(e)||o("WAWebMsgGetters").getIsMetaBotInvokeResponse(e)?e.displayName({withPushName:a,withPushNameOnly:a,newPushNameFormatting:a,showVerifiedName:a}):void 0;if(r.isLocked)return{body:o("WAWebGetNotificationStrings").getPluralMessageNotificationBody(r.unreadCount).toString()};if(e.type===o("WAWebMsgType").MSG_TYPE.CHAT&&!e.shouldShowNotificationPreview()){var l,u=(l=g==null?void 0:g())!=null?l:null;u!=null?n=u:o("WAWebMsgGetters").getIsGroupMsg(e)?i!=null?(n=s._(/*BTDS*/"Mensaje de {name}",[s._param("name",i)]),i=void 0):n=s._(/*BTDS*/"Mensaje nuevo"):n=o("WAWebGetNotificationStrings").getPluralMessageNotificationBody(r.unreadCount)}else e.type===o("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&e.subtype==="sender_invite"?e.templateParams&&e.templateParams[0]==="true"?n=s._(/*BTDS*/"Saluda por WhatsApp."):n=s._(/*BTDS*/"Env\u00eda un saludo."):n=o("WAWebGetNotificationStrings").getNotificationMessageBody(e);var c=(t=f==null?void 0:f(r.unreadCount))!=null?t:null;return babelHelpers.extends({body:n.toString(),author:i},c!=null&&{footer:c.toString()})}function v(){return o("WAWebUA").UA.isBlink&&o("WAWebUA").UA.os===o("WAWebUA").OS_TYPE.MAC}l.eligibleMessagesForNotificationRetriggering=h,l.WAMsgNotification=y,l.getNotificationParts=b,l.shouldReplaceMsgNotificationManually=v}),226);
__d("WAWebStateConcern",["WALogger","WAWebBaseMirror","WAWebBaseModel","WAWebCollections","WAWebProxyStateFactory","WAWebStreamModel"],(function(t,n,r,o,a,i,l){var e,s,u,c;n("WAWebCollections");function d(e){return typeof e=="string"?e:e.toString?e.toString():"Invalid Object"}function m(t,n,r,a){var i={$ProxyState$ComponentName:{value:t},proxyBitMask:{value:o("WAWebBaseMirror").genBitMask(n.prototype.mirrorMask,r)}},l=function(r){var n={};n.enumerable=!0,n.get=function(){return this.$ProxyState$state.get(r)},n.set=function(){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(['READ ONLY: Cannot write to proxied property "','", created in <'," />, it is not writable."])),r,t)},a||(n.set=function(e){this.$ProxyState$state.set(r,e)}),i[r]=n};for(var s of r)l(s);function u(e){n.call(this,e)}return u.prototype=Object.create(n.prototype,i),u.prototype.constructor=u,u}var p=(function(){function e(e,t,n,r,a){a===void 0&&(a=!1),this.componentName=e,this.name=t,this.$1=r,this.keys=n;var i=o("WAWebProxyStateFactory").ProxyStates[t];i||o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(['Unknown StateHOC concern type "','"'])),t).sendLogs("state-hoc-error"),this.$2=i,this.$3=m(e,i,n,a)}var t=e.prototype;return t.getModel=function(t){return t instanceof this.$2?t.$ProxyState$state:t},t.getModelAndValidate=function(t){var e=t instanceof this.$2?t.$ProxyState$state:t;return e?e instanceof o("WAWebBaseModel").BaseModel?e:(o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose([""," given invalid object for ",": ",""])),this.componentName,this.name,d(e)).sendLogs("state-hoc-error"),null):(o("WAWebStreamModel").Stream.mode===o("WAWebStreamModel").StreamMode.MAIN&&o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose([""," was not supplied the "," model with keys ","."])),this.componentName,this.name,String(this.keys)).sendLogs("state-hoc-error"),null)},t.createProxy=function(t){return new this.$3(t)},t.attachConcern=function(t,n,r){t.incObservers(!this.$1),t.mirror.addListener(r,n,this)},t.detachConcern=function(t,n){t.decObservers(),t.mirror.removeListener(n)},e})();l.default=p}),98);
__d("WAWebCxtUrl",["WAWebL10N"],(function(t,n,r,o,a,i,l){var e="https://faq.whatsapp.com";function s(t){return e+"/cxt/?entrypointid="+t+"&platform=web&lang="+r("WAWebL10N").getNormalizedLocale()}function u(){return s("invite-via-link-unavailable")}function c(){return s("community-no-longer-available")}l.getGroupInviteGrowthLockedFaqUrl=u,l.getCommunityNotAvailableFaqUrl=c}),98);
__d("WAWebSuspendedCommunityModalLoadable",["fbt","JSResourceForInteraction","WAWebLazyLoadedRetriable","WAWebLoadingConfirmPopup.react","asyncToGeneratorRuntime","react","react-loadable"],(function(t,n,r,o,a,i,l,s){var e,u=e||(e=r("react")),c=r("WAWebLazyLoadedRetriable")(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield r("JSResourceForInteraction")("WAWebSuspendedCommunityModal.react").__setRef("WAWebSuspendedCommunityModalLoadable").load();return e.SuspendedCommunityModal}),"SuspendedCommunityModal"),d=r("react-loadable")({loader:c,loading:function(t){return u.jsx(r("WAWebLoadingConfirmPopup.react"),{title:s._(/*BTDS*/"Comunidad no disponible"),error:!!t.error})}});l.SuspendedCommunityModalLoadable=d}),226);
__d("WAWebSuspendedCommunityUtils",["fbt","WAWebChatCollection","WAWebConfirmPopup.react","WAWebCxtUrl","WAWebExternalLink.react","WAWebModalManager","WAWebSuspendedCommunityModalLoadable","react"],(function(t,n,r,o,a,i,l,s){var e,u=e||(e=r("react")),c="community-suspend-appeal";function d(){o("WAWebModalManager").ModalManager.open(u.jsx(o("WAWebConfirmPopup.react").ConfirmPopup,{onOK:function(){o("WAWebModalManager").ModalManager.close()},onCancel:function(){o("WAWebModalManager").ModalManager.close(),o("WAWebExternalLink.react").openExternalLink(o("WAWebCxtUrl").getCommunityNotAvailableFaqUrl())},okText:s._(/*BTDS*/"Descartar"),cancelText:s._(/*BTDS*/"M\u00e1s informaci\u00f3n"),title:s._(/*BTDS*/"Esta comunidad ya no est\u00e1 disponible.")}),{transition:"modal-flow"})}function m(e){var t,n=(t=e.groupMetadata)==null?void 0:t.parentGroup;if(n!=null){var r=o("WAWebChatCollection").ChatCollection.get(n);r!=null&&o("WAWebModalManager").ModalManager.open(u.jsx(o("WAWebSuspendedCommunityModalLoadable").SuspendedCommunityModalLoadable,{community:r}),{transition:"modal-flow"})}}l.SUSPENDED_COMMUNITY_SUPPORT_TAG=c,l.openTerminatedCommunityModal=d,l.openSuspendedCommunityModal=m}),226);
__d("WAWebGetThreadType",["WAWebChatGetters","WAWebGroupType","WAWebWamEnumThreadType"],(function(t,n,r,o,a,i,l){function e(e){if(o("WAWebChatGetters").getIsBroadcast(e))return o("WAWebWamEnumThreadType").THREAD_TYPE.BROADCAST;if(o("WAWebChatGetters").getIsNewsletter(e))return o("WAWebWamEnumThreadType").THREAD_TYPE.CHANNEL;var t=e==null?void 0:e.groupMetadata;if(!t)return o("WAWebWamEnumThreadType").THREAD_TYPE.INDIVIDUAL;switch(t.groupType){case o("WAWebGroupType").GroupType.COMMUNITY:return o("WAWebWamEnumThreadType").THREAD_TYPE.PARENT_GROUP;case o("WAWebGroupType").GroupType.DEFAULT:return o("WAWebWamEnumThreadType").THREAD_TYPE.GROUP;case o("WAWebGroupType").GroupType.LINKED_SUBGROUP:return o("WAWebWamEnumThreadType").THREAD_TYPE.SUB_GROUP;case o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP:return o("WAWebWamEnumThreadType").THREAD_TYPE.DEFAULT_SUB_GROUP;case o("WAWebGroupType").GroupType.LINKED_GENERAL_GROUP:return o("WAWebWamEnumThreadType").THREAD_TYPE.SUB_GROUP}}l.getThreadType=e}),98);
__d("WAWebWamEnumUserRoleType",[],(function(t,n,r,o,a,i){var e=Object.freeze({MEMBER:0,ADMIN:1,CADMIN:2});i.USER_ROLE_TYPE=e}),66);
__d("WAWebGetUserRole",["WAWebWamEnumUserRoleType"],(function(t,n,r,o,a,i,l){function e(e){var t=e==null?void 0:e.groupMetadata;if(t==null)return null;var n=t.participants.iAmAdmin(),r=n&&t.isParentGroup;return r===!0?o("WAWebWamEnumUserRoleType").USER_ROLE_TYPE.CADMIN:n===!0?o("WAWebWamEnumUserRoleType").USER_ROLE_TYPE.ADMIN:o("WAWebWamEnumUserRoleType").USER_ROLE_TYPE.MEMBER}l.getUserRole=e}),98);
__d("WAWebGroupJourneyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumChatFilterActionTypes","WAWebWamEnumSurfaceType","WAWebWamEnumThreadType","WAWebWamEnumTsSurface","WAWebWamEnumUserRoleType"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({GroupJourney:[4512,{actionType:[1,o("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES],appSessionId:[2,o("WAWebWamCodegenUtils").TYPES.STRING],groupSize:[3,o("WAWebWamCodegenUtils").TYPES.INTEGER],surface:[4,o("WAWebWamEnumSurfaceType").SURFACE_TYPE],threadType:[5,o("WAWebWamEnumThreadType").THREAD_TYPE],uiSurface:[7,o("WAWebWamEnumTsSurface").TS_SURFACE],userRole:[6,o("WAWebWamEnumUserRoleType").USER_ROLE_TYPE]},[1,1,1],"regular"]},{GroupJourney:[]});l.GroupJourneyWamEvent=e}),98);
__d("WAWebCommunityGroupJourneyEventImpl",["WALogger","WAWebGetSharedSessionId","WAWebGetThreadType","WAWebGetUserRole","WAWebGroupJourneyWamEvent","WAWebWamEnumSurfaceType"],(function(t,n,r,o,a,i,l){var e,s=(function(){function t(e){var t=e.action,n=e.surface,r=e.chat;this.action=t,this.surface=n,this.chat=r,this.sessionId=o("WAWebGetSharedSessionId").getSharedSessionId()}t.inviteModalSourceToSurface=function(n){switch(n){case"community_home":return o("WAWebWamEnumSurfaceType").SURFACE_TYPE.COMMUNITY_HOME;case"community_nav":return o("WAWebWamEnumSurfaceType").SURFACE_TYPE.COMMUNITY_NAV;case"subgroup_switcher":return o("WAWebWamEnumSurfaceType").SURFACE_TYPE.COMMUNITY_NAV_SHEET;case"invite_link":return o("WAWebWamEnumSurfaceType").SURFACE_TYPE.CHAT;case"group_mention":return o("WAWebWamEnumSurfaceType").SURFACE_TYPE.CHAT;case"other":return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["No relevant communtiy journey log for this invite modal"]))),null}};var n=t.prototype;return n.shouldLogThreadType=function(){switch(this.surface){case o("WAWebWamEnumSurfaceType").SURFACE_TYPE.CHAT:case o("WAWebWamEnumSurfaceType").SURFACE_TYPE.CHATLIST:case o("WAWebWamEnumSurfaceType").SURFACE_TYPE.COMMUNITY_HOME:case o("WAWebWamEnumSurfaceType").SURFACE_TYPE.COMMUNITY_TAB:case o("WAWebWamEnumSurfaceType").SURFACE_TYPE.COMMUNITY_NAV:case o("WAWebWamEnumSurfaceType").SURFACE_TYPE.COMMUNITY_NAV_SHEET:case o("WAWebWamEnumSurfaceType").SURFACE_TYPE.COMMUNITY_SETTINGS:case o("WAWebWamEnumSurfaceType").SURFACE_TYPE.GROUP_INFO:return!0;default:return!1}},n.getThreadType=function(){var e;return!this.shouldLogThreadType()||((e=this.chat)==null?void 0:e.groupMetadata)==null?null:o("WAWebGetThreadType").getThreadType(this.chat)},n.getGroupSize=function(){var e,t,n=(e=this.chat)==null?void 0:e.groupMetadata;return n==null?0:(t=n.participants.length)!=null?t:0},n.getUserRole=function(){return o("WAWebGetUserRole").getUserRole(this.chat)},n.commit=function(){var e=new(o("WAWebGroupJourneyWamEvent")).GroupJourneyWamEvent({actionType:this.action,appSessionId:this.sessionId,surface:this.surface,groupSize:this.getGroupSize()}),t=this.getThreadType();t!=null&&(e.threadType=t);var n=this.getUserRole();n!=null&&(e.userRole=n),e.commit()},t})();l.CommunityGroupJourneyEvent=s}),98);
__d("WAWebCommunitySquircleIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox","innerStyles"],s,u,c=s||(s=r("react")),d="community-squircle";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=t.innerStyles,p=babelHelpers.objectWithoutPropertiesLoose(t,e),_;if(s){var f=s.x,g=f===void 0?0:f,h=s.y,y=h===void 0?0:h,C=s.width,b=C===void 0?0:C,v=s.height,S=v===void 0?0:v;_=[g,y,b,S].join(" ")}var R=180,L=180;return(a!=null||i!=null)&&(R=a,L=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},p,{children:c.jsxs("svg",{viewBox:_!=null?_:"0 0 180 180",height:R,width:L,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{d:"M90 0C1.43051e-05 0 0 0 0 90C0 180 1.43051e-05 180 90 180C180 180 180 180 180 90C180 0 180 0 90 0Z",fill:"currentColor",className:u(m==null?void 0:m.background)}),c.jsx("path",{transform:"translate(30, 52)",fillRule:"evenodd",clipRule:"evenodd",d:"M86.0728 25.3655C86.1287 25.7634 86.2023 26.1501 86.2934 26.5313C86.3389 26.7247 86.3886 26.9126 86.4426 27.0949C86.5491 27.4658 86.6736 27.831 86.8156 28.1888C87.0246 28.7152 87.2706 29.2248 87.5516 29.7138C87.7381 30.0342 87.939 30.3491 88.1538 30.6475C88.7962 31.5513 89.5655 32.3502 90.4362 33.0177C91.0223 33.4638 91.6483 33.8505 92.3056 34.1725C92.8094 34.4169 93.3294 34.6237 93.8617 34.7913C94.2205 34.9018 94.5877 34.9957 94.9632 35.0731C95.7326 35.2269 96.5143 35.3046 97.2978 35.3051C103.567 35.3051 108.649 30.0362 108.649 23.5368C108.649 17.0373 103.567 11.7684 97.2978 11.7684C96.5142 11.7662 95.7322 11.8439 94.9632 12.0005C94.5915 12.0741 94.2238 12.1682 93.8617 12.2822C93.3296 12.448 92.8095 12.6529 92.3056 12.8955C90.663 13.6984 89.2368 14.9092 88.1538 16.4205C87.9406 16.7244 87.7381 17.0338 87.5516 17.3598C87.2695 17.8481 87.0235 18.3579 86.8156 18.8847C86.6755 19.2383 86.5492 19.6029 86.4426 19.9731C86.3883 20.161 86.3385 20.3488 86.2934 20.5367C86.2023 20.9179 86.1287 21.3046 86.0728 21.7024C85.9037 22.9172 85.9037 24.1508 86.0728 25.3655ZM33.9272 25.3655C33.8739 25.7634 33.7977 26.1501 33.7071 26.5313C33.6617 26.7247 33.6119 26.9126 33.5579 27.0949C33.4514 27.4658 33.3269 27.8309 33.1849 28.1888C32.9755 28.7151 32.7294 29.2247 32.4484 29.7138C32.2624 30.0342 32.0615 30.3491 31.8467 30.6475C31.204 31.551 30.4347 32.3499 29.5642 33.0177C28.9782 33.4638 28.3521 33.8505 27.6948 34.1725C27.191 34.4169 26.6709 34.6237 26.1387 34.7913C25.7795 34.9018 25.4123 34.9957 25.0371 35.0731C24.2677 35.2268 23.486 35.3045 22.7024 35.3051C16.4334 35.3051 11.3514 30.0362 11.3514 23.5368C11.3514 17.0373 16.4334 11.7684 22.7024 11.7684C23.4861 11.7663 24.2681 11.844 25.0371 12.0005C25.4089 12.0742 25.7765 12.1682 26.1387 12.2822C26.6708 12.448 27.1908 12.6529 27.6948 12.8955C29.3375 13.6984 30.7636 14.9092 31.8467 16.4205C32.0599 16.7244 32.2624 17.0338 32.4484 17.3598C32.7304 17.8482 32.9766 18.3579 33.1849 18.8847C33.325 19.2383 33.4513 19.6029 33.5579 19.9731C33.6116 20.161 33.6613 20.3488 33.7071 20.5367C33.7977 20.9179 33.8718 21.3046 33.9272 21.7024C34.0963 22.9172 34.0963 24.1508 33.9272 25.3655ZM119.343 54.0764C119.204 53.836 119.05 53.5733 118.862 53.2826C118.66 52.9695 118.432 52.6341 118.171 52.2764C117.909 51.9186 117.62 51.5385 117.295 51.1472C116.97 50.7559 116.615 50.3534 116.224 49.9398C114.625 48.2625 112.798 46.8262 110.799 45.6746C110.168 45.3056 109.497 44.9591 108.788 44.6292C108.767 44.6181 108.748 44.6125 108.728 44.6013C100.676 41.1728 91.6054 41.1728 83.5538 44.6013C83.4404 44.6516 83.3336 44.7075 83.2235 44.7634C83.0429 44.8472 82.8778 44.9423 82.7027 45.0317C82.8007 45.0876 82.9003 45.1379 82.9978 45.1938C84.9925 46.3455 86.8856 47.6696 88.6562 49.1516C89.8126 50.1167 90.913 51.1488 91.952 52.2428C92.5945 52.9136 93.1818 53.5788 93.7185 54.2273C94.269 54.8925 94.7513 55.513 95.1817 56.1055C95.6249 56.7148 96.0075 57.2794 96.3488 57.7993C96.6719 58.3024 96.9455 58.7496 97.1817 59.1633C97.6294 59.9211 97.9634 60.7426 98.1726 61.6005L98.2601 62.2042H116.6C118.478 62.2042 120 60.682 120 58.8042V55.3676C119.81 54.9225 119.591 54.491 119.343 54.0764ZM77.6389 15.6162C77.5508 14.9906 77.435 14.382 77.292 13.7846C77.2208 13.4859 77.1425 13.1873 77.0577 12.8942C76.8886 12.3081 76.6929 11.7389 76.4727 11.181C76.1444 10.3541 75.7576 9.55357 75.3153 8.78587C75.0228 8.27866 74.7075 7.78837 74.3694 7.31498C72.6729 4.93631 70.4305 3.03412 67.8456 1.78084C67.0544 1.39541 66.2367 1.07141 65.3992 0.811523C64.8349 0.63682 64.2576 0.48466 63.6683 0.366313C62.4595 0.123014 61.231 0 59.9997 0C49.8923 0 42.1622 8.01379 42.1622 18.496C42.1622 28.9781 49.8923 36.9863 59.9997 36.9863C61.231 36.9863 62.4595 36.8633 63.6683 36.62C64.2576 36.5016 64.8349 36.3495 65.3992 36.1748C66.2367 35.9149 67.0544 35.5909 67.8456 35.2055C70.4305 33.9522 72.6729 32.05 74.3694 29.6713C74.7072 29.1979 75.0225 28.7076 75.3153 28.2004C75.7576 27.4327 76.1444 26.6322 76.4727 25.8053C76.6902 25.2474 76.8886 24.6726 77.0577 24.0921C77.1425 23.799 77.2208 23.5004 77.292 23.2017C77.435 22.6043 77.5508 21.9957 77.6389 21.3701C77.9042 19.462 77.9042 17.5243 77.6389 15.6162ZM93.0965 61.4246C92.8978 61.0703 92.6696 60.6818 92.4021 60.2532C92.1144 59.7961 91.7847 59.299 91.4118 58.7733C91.039 58.2476 90.623 57.6876 90.1612 57.1162C89.6993 56.5448 89.1905 55.9448 88.6326 55.3448C87.7365 54.3736 86.7887 53.456 85.7938 52.5964C84.2613 51.2774 82.6237 50.0979 80.8992 49.0708C79.999 48.5337 79.0431 48.0195 78.0315 47.5395C78.0039 47.522 77.9751 47.5067 77.9453 47.4938C73.2477 45.2653 67.3414 43.7111 59.9989 43.7111C52.6564 43.7111 46.7496 45.2653 42.0526 47.4938C41.8888 47.5681 41.7398 47.6538 41.5803 47.7338C40.8941 48.0709 40.2347 48.4252 39.6009 48.7851C39.2573 48.9851 38.9214 49.1851 38.5931 49.3851C37.0554 50.3392 35.5882 51.4126 34.204 52.5964C33.209 53.4558 32.2612 54.3734 31.3652 55.3448C30.8084 55.9448 30.3001 56.5391 29.8367 57.1162C29.3732 57.6933 28.9583 58.2419 28.5854 58.7733C28.2126 59.3047 27.8834 59.7961 27.5957 60.2532C27.3282 60.6818 27.1 61.0703 26.9018 61.4246C26.8833 61.4521 26.8664 61.4807 26.8511 61.5103C26.6425 61.8817 26.4728 62.2074 26.3385 62.476C26.0699 63.0131 25.9459 63.3159 25.9459 63.3159V70.5726C25.9459 72.4504 27.4682 73.9726 29.3459 73.9726H90.6541C92.5318 73.9726 94.0541 72.4504 94.0541 70.5726V63.3159C93.7702 62.6666 93.4505 62.035 93.0965 61.4246ZM21.7773 61.6062C21.8277 61.1833 21.9651 60.7758 22.1807 60.4102C22.3487 60.086 22.4749 59.6948 22.7367 59.2421C23.0271 58.7447 23.2558 58.3032 23.5732 57.8057C23.9132 57.2804 24.2785 56.7159 24.7161 56.1179C25.1536 55.5199 25.6319 54.8883 26.1698 54.24C26.7076 53.5917 27.2983 52.921 27.9447 52.2392C30.4236 49.6351 33.2397 47.3846 36.3159 45.5492C36.6355 45.3592 36.965 45.1692 37.2973 44.9847C37.1535 44.9121 37.0218 44.8339 36.8724 44.7668C36.7622 44.7109 36.652 44.655 36.5418 44.6047C32.5724 42.8404 28.2751 41.9636 23.9418 42.0338C19.6088 41.9636 15.3116 42.8405 11.3424 44.6047C11.3215 44.6159 11.3028 44.6215 11.2818 44.6326C10.5721 44.9624 9.90032 45.3089 9.26825 45.6778C8.05739 46.376 6.90772 47.1782 5.83185 48.0754C5.1338 48.66 4.46803 49.2832 3.83757 49.9421C3.44632 50.3557 3.08887 50.7581 2.76521 51.1493C2.44064 51.5406 2.14858 51.9206 1.88682 52.2783C1.62507 52.636 1.39363 52.9713 1.19139 53.2843C1.00403 53.5749 0.826588 53.8376 0.68717 54.0779C0.224832 54.8716 0 55.369 0 55.369V58.8042C0 60.682 1.52223 62.2042 3.4 62.2042H21.7371L21.7773 61.6062Z",fill:"#fff",className:u(m==null?void 0:m.primary)})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.CommunitySquircleIcon=m}),98);
__d("WAWebDrawerContext",["react"],(function(t,n,r,o,a,i,l){var e,s=(e||(e=o("react"))).createContext,u={type:null},c=s(u);l.undefinedDrawerContext=u,l.DrawerContext=c}),98);
__d("WAWebKeyboardRotateFocus.react",["WAWebFocusTracer","WAWebKeyboardConstants","WAWebKeyboardTabUtils","WAWebUseIsKeyboardUser","react","useMergeRefs"],(function(t,n,r,o,a,i,l){var e=["ref"],s,u,c=u||(u=r("react")),d=(s||(s=o("react"))).useRef;function m(t){var n=t.ref,a=babelHelpers.objectWithoutPropertiesLoose(t,e),i=a.focusType,l=d(null),s=r("useMergeRefs")(n,l),u=r("WAWebUseIsKeyboardUser")(),m=u.setIsKeyboardUser,p=function(t){if(!(t.metaKey||t.ctrlKey)){var e=l.current,n;t.key===o("WAWebKeyboardConstants").KEYBOARD_EVENT_KEY_VALUE.TAB?(t.stopPropagation(),t.preventDefault(),m(!0),e!=null&&(n=o("WAWebKeyboardTabUtils").getNextTabbableElement(e,t.shiftKey?o("WAWebKeyboardTabUtils").TabDirection.BACKWARD:o("WAWebKeyboardTabUtils").TabDirection.FORWARD,i))):e!=null&&e===document.activeElement&&(n=o("WAWebKeyboardTabUtils").getNextTabbableElement(e,o("WAWebKeyboardTabUtils").TabDirection.FORWARD,i,function(e){return e.nodeName.toLowerCase()==="input"})),n!=null&&_(n)}};return c.jsx("div",{ref:s,style:a.style,className:"x10l6tqk x13vifvy xtijo5x x1ey2m1c x1o0tod",onKeyDown:p,tabIndex:-1,children:a.children})}m.displayName=m.name+" [from "+i.id+"]";var p=m;function _(e){r("WAWebFocusTracer").focus(e)}l.RotateFocus=p}),98);
__d("WAWebDrawerManager.react",["WATypeUtils","WAUpperFirst","WAWebDrawerContext","WAWebDrawerManagerContext","WAWebErrorBoundary.react","WAWebFocusTracer","WAWebKeyboardRotateFocus.react","WAWebUimContext","WAWebUimUie.react","WAWebVelocityTransitionGroup","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u={container:{position:"x10l6tqk",top:"x13vifvy",insetInlineEnd:"xtijo5x",bottom:"x1ey2m1c",insetInlineStart:"x1o0tod",left:null,right:null,$$css:!0},rightContainer:{backgroundColor:"x1280gxy",$$css:!0}},c={LEFT:"drawer-left",MID:"slide-up",NONE:"none",RIGHT:"slide-left"},d={LEFT:"left",MID:"mid",RIGHT:"right",FULLSCREEN:"fullscreen"};function m(e){var t=e.animationDisabled,n=e.direction,a=e.onDrawerAnimationComplete,i=o("WAWebDrawerManagerContext").useDrawerManagerContext(n),l=i.drawer,c=i.drawerId,m=i.transition,p=i.uim,_=i.noFocus,f=i.onEnterAnimationComplete,g=i.drawerContext,h=i.focusType,y=i.disableRotateFocus,C=i.uieRef,b=i.blockTransitionRef,v=i.handleRequestDismiss,S=function(){if(C.current){var e=C.current.getElement();!e||e.contains(document.activeElement)||r("WAWebFocusTracer").focus(e)}},R=function(t){var e=a;e&&e(),!(f===void 0&&_===void 0)&&l&&t===c&&o("WATypeUtils").isFunction(f)&&f()},L=function(){return t===!0?"none":b.current||m},E;if(l){var k=y===!0?"div":o("WAWebKeyboardRotateFocus.react").RotateFocus,I=y===!0?{}:{focusType:h};E=s.jsx(o("WAWebUimUie.react").UIE,{displayName:"Drawer"+r("WAUpperFirst")(n),escapable:!0,ref:C,requestFocus:_===!0?null:S,requestDismiss:v,children:s.jsx(k,babelHelpers.extends({style:{height:"100%"}},I,{children:s.jsx(o("WAWebDrawerContext").DrawerContext.Provider,{value:g,children:s.jsx(o("WAWebErrorBoundary.react").ErrorBoundary,{name:"drawer-manager-"+n,type:"fatal",children:l})})}))},c)}var T=E!=null&&n===d.RIGHT;return s.jsx(r("WAWebUimContext").Consumer,{children:function(t){return s.jsx(r("WAWebUimContext").Provider,{value:p||t,children:s.jsx(r("WAWebVelocityTransitionGroup"),{xstyle:[u.container,T&&u.rightContainer],transitionName:L(),onAnimationComplete:function(){return R(c)},displayName:"DrawerManager",children:E})})}})}m.displayName=m.name+" [from "+i.id+"]",l.Transition=c,l.Dir=d,l.DrawerManagerComponent=m}),98);
__d("WAWebDrawerManagerContext",["WALogger","WAWebDrawerManagerGlobalContext","err","react","useWAWebDrawerManagerEvents"],(function(t,n,r,o,a,i,l){var e,s,u=s||(s=o("react")),c=s,d=c.createContext,m=c.useCallback,p=c.useContext,_=c.useEffect,f=d(null);function g(e){var t=e.children,n=e.onDrawerStateChange,r=o("useWAWebDrawerManagerEvents").useDrawerManagerEvents("left",n);return _(function(){return o("WAWebDrawerManagerGlobalContext").setGlobalDrawerManager("left",r),function(){o("WAWebDrawerManagerGlobalContext").setGlobalDrawerManager("left",null)}},[r]),u.jsx(f.Provider,{value:r,children:t})}g.displayName=g.name+" [from "+i.id+"]";var h=d(null);function y(e){var t=e.children,n=e.onDrawerStateChange,r=o("useWAWebDrawerManagerEvents").useDrawerManagerEvents("right",n);return _(function(){return o("WAWebDrawerManagerGlobalContext").setGlobalDrawerManager("right",r),function(){o("WAWebDrawerManagerGlobalContext").setGlobalDrawerManager("right",null)}},[r]),u.jsx(h.Provider,{value:r,children:t})}y.displayName=y.name+" [from "+i.id+"]";var C=d(null);function b(e){var t=e.children,n=e.onDrawerStateChange,r=o("useWAWebDrawerManagerEvents").useDrawerManagerEvents("mid",n);return _(function(){return o("WAWebDrawerManagerGlobalContext").setGlobalDrawerManager("mid",r),function(){o("WAWebDrawerManagerGlobalContext").setGlobalDrawerManager("mid",null)}},[r]),u.jsx(C.Provider,{value:r,children:t})}b.displayName=b.name+" [from "+i.id+"]";var v=d(null);function S(e){var t=e.children,n=e.onDrawerStateChange,r=o("useWAWebDrawerManagerEvents").useDrawerManagerEvents("fullscreen",n);return _(function(){return o("WAWebDrawerManagerGlobalContext").setGlobalDrawerManager("fullscreen",r),function(){o("WAWebDrawerManagerGlobalContext").setGlobalDrawerManager("fullscreen",null)}},[r]),u.jsx(v.Provider,{value:r,children:t})}S.displayName=S.name+" [from "+i.id+"]";function R(e){var t=e.children,n=e.onDrawerStateChange,r=m(function(e){n==null||n("left",e)},[n]),o=m(function(e){n==null||n("right",e)},[n]),a=m(function(e){n==null||n("mid",e)},[n]),i=m(function(e){n==null||n("fullscreen",e)},[n]);return u.jsx(g,{onDrawerStateChange:r,children:u.jsx(y,{onDrawerStateChange:o,children:u.jsx(b,{onDrawerStateChange:a,children:u.jsx(S,{onDrawerStateChange:i,children:t})})})})}R.displayName=R.name+" [from "+i.id+"]";function L(){return p(f)}function E(){return p(h)}function k(){return p(C)}function I(){return p(v)}function T(t){var n=t==="left"?f:t==="right"?h:t==="mid"?C:t==="fullscreen"?v:(function(){throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+t)})(),a=p(n);if(a==null){var i=o("WAWebDrawerManagerGlobalContext").getGlobalDrawerManager(t);if(i!=null)return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["useDrawerManagerContext: "," drawer manager context is not available. Using global context instead"])),t),i;throw r("err")("useDrawerManagerContext: "+t+" drawer manager context is not available. Make sure the component is wrapped with the appropriate DrawerManagerContextProvider.")}return a}l.LeftDrawerManagerContextProvider=g,l.RightDrawerManagerContextProvider=y,l.MiddleDrawerManagerContextProvider=b,l.FullscreenDrawerManagerContextProvider=S,l.DrawerManagerContextProvider=R,l.useLeftDrawerManagerContext=L,l.useRightDrawerManagerContext=E,l.useMiddleDrawerManagerContext=k,l.useFullscreenDrawerManagerContext=I,l.useDrawerManagerContext=T}),98);
__d("useWAWebUiIdle",["WAAbortError","WAWebCmd","WAWebDocumentFlushed","WAWebNoop","react","useWAWebListener","useWAWebUnmountSignal"],(function(t,n,r,o,a,i,l){var e,s=(e||(e=o("react"))).useCallback;function u(){var e=o("useWAWebListener").useAddListenerOnce(),t=e[0],n=r("useWAWebUnmountSignal")(),a=s(function(e){if(o("WAWebCmd").Cmd.uiBusy){t(o("WAWebCmd").Cmd,"ui_idle",e);return}o("WAWebDocumentFlushed").documentFlushed({signal:n}).then(function(){e()}).catch(o("WAAbortError").catchAbort(r("WAWebNoop")))},[t,n]);return a}l.default=u}),98);
__d("useWAWebDrawerManagerEvents",["WAWebDrawerContext","WAWebDrawerManager.react","WAWebFocusTracer","WAWebKeyboardTabUtils","WAWebNonEmptyString","lodash","react","uniqueID","useWAWebUiIdle"],(function(t,n,r,o,a,i,l){var e,s=e||(e=o("react")),u=s.useCallback,c=s.useMemo,d=s.useRef,m=s.useState,p=function(t){switch(t){case o("WAWebDrawerManager.react").Dir.LEFT:case o("WAWebDrawerManager.react").Dir.FULLSCREEN:return o("WAWebDrawerManager.react").Transition.LEFT;case o("WAWebDrawerManager.react").Dir.MID:return o("WAWebDrawerManager.react").Transition.MID;default:return o("WAWebDrawerManager.react").Transition.RIGHT}};function _(e,t){var n=r("useWAWebUiIdle")(),a=d(null),i=d(null),l=d(null),s=d(!1),_=m(void 0),f=_[0],g=_[1],h=m(!1),y=h[0],C=h[1],b=m(null),v=b[0],S=b[1],R=m(function(){return p(e)}),L=R[0],E=R[1],k=m(void 0),I=k[0],T=k[1],D=m(void 0),x=D[0],$=D[1],P=m(!1),N=P[0],M=P[1],w=m(void 0),A=w[0],F=w[1],O=m(o("WAWebDrawerContext").undefinedDrawerContext),B=O[0],W=O[1],q=m(o("WAWebKeyboardTabUtils").FocusType.CUSTOM),U=q[0],V=q[1],H=u(function(a,u){var c=u===void 0?{}:u,d=c.transition,m=d===void 0?p(e):d,_=c.uim,h=c.noFocus,y=c.onEnterAnimationComplete,b=c.newDrawerContext,v=b===void 0?o("WAWebDrawerContext").undefinedDrawerContext:b,R=c.focusType,L=c.disableRotateFocus,k=c.focusOnUnMount,I=k===void 0?!1:k,D=o("WAWebNonEmptyString").asMaybeNonEmptyString(r("uniqueID")("DrawerManager"+e)),x=null;if(I&&(x=document.activeElement),i.current=x,!s.current&&f){if(f.key!=null&&r("lodash").isEqual(f.key,a.key))return;t&&t("updated"),l.current=o("WAWebDrawerManager.react").Transition.NONE,g(a),S(D),E(m),T(_),$(h),F(y),W(v),V(R),M(L),n(function(){l.current=m}),C(I)}else t&&t("opened"),g(a),S(D),E(m),T(_),$(h),F(y),W(v),V(R),M(L),C(I)},[e,f,t,n]),G=u(function(e,a){if(!(e!=null&&v!==e)&&f){if(t){var l=a!=null&&a.isConflictingDrawerOpening?"replaced":"closed";t(l)}if(s.current=!0,g(void 0),W(o("WAWebDrawerContext").undefinedDrawerContext),n(function(){s.current=!1}),y){var u=i==null?void 0:i.current;u&&r("WAWebFocusTracer").focus(u)}}},[f,v,t,y,n]),z=u(function(){var e,t=(e=a.current)==null?void 0:e.getElement();if(t){var n=o("WAWebKeyboardTabUtils").getNextTabbableElement(t);n&&r("WAWebFocusTracer").focus(n)}},[]),j=u(function(){G(v)},[G,v]),K=u(function(){return s.current===!0?!1:!!f},[f]);return c(function(){return{drawer:f,drawerId:v,transition:L,uim:I,noFocus:x,onEnterAnimationComplete:A,drawerContext:B,focusType:U,disableRotateFocus:N,uieRef:a,blockTransitionRef:l,handleRequestDismiss:j,openDrawer:H,closeDrawer:G,existsDrawer:K,focusDrawer:z,updateContext:W}},[N,f,B,v,U,j,x,A,L,I,H,G,K,z,W])}l.useDrawerManagerEvents=_}),98);
__d("WAWebMessageCommunityCard.react",["WAWebArrowForwardIcon.react","WAWebChatCollection","WAWebChatGroupUtils","WAWebCmd","WAWebCommunityGeneralChatImage.react","WAWebCommunityGroupJourneyEventImpl","WAWebCommunitySquircleIcon.react","WAWebDetailImage.react","WAWebDrawerManagerContext","WAWebFlex.react","WAWebGroupMetadataCollection","WAWebText_DONOTUSE.react","WAWebUISpacing","WAWebUnstyledButton.react","WAWebWamEnumChatFilterActionTypes","WAWebWamEnumSurfaceType","WAWebWid","WAWebWidFactory","react","stylex"],(function(t,n,r,o,a,i,l){var e,s,u=e||(e=r("react")),c={communitySquircle:{color:"x17k9de1",$$css:!0},footerButton:{color:"xo1mcw5",display:"x78zum5",justifyContent:"xl56j7k",borderTopWidth:"x178xt8z",borderTopStyle:"x13fuv20",borderTopColor:"xx42vgk",width:"xh8yej3",$$css:!0},list:{textAlign:"x1yc453h",position:"x1n2onr6",$$css:!0}};function d(e){var t,n=e.title,a=e.subtitle,i=e.body,l=e.footer,d=e.subgroupId,m=e.openNavigation,p=m===void 0?!1:m,_=e.onFooterClick,f=o("WAWebDrawerManagerContext").useDrawerManagerContext("right"),g=null;e.communityId&&(g=e.communityId instanceof r("WAWebWid")?e.communityId:o("WAWebWidFactory").createWid(e.communityId));var h=d?o("WAWebChatCollection").ChatCollection.get(d):null,y=h?!!(o("WAWebChatGroupUtils").isCommunityAnnouncementGroup(h)||(t=h.groupMetadata)!=null&&t.isParentGroup):!1,C=h?o("WAWebChatGroupUtils").isCommunityGeneralGroup(h):!1,b=function(t){var e;if(!(!g||!((e=r("WAWebGroupMetadataCollection").get(g))!=null&&e.hasJoined()))){if(h&&new(o("WAWebCommunityGroupJourneyEventImpl")).CommunityGroupJourneyEvent({action:o("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES.COMMUNITY_RICH_SYSTEM_MESSAGE_CLICK,surface:o("WAWebWamEnumSurfaceType").SURFACE_TYPE.CHAT,chat:h}).commit(),t&&(t.preventDefault(),t.stopPropagation()),_)return _();if(!p){var n,a=(n=f.existsDrawer())!=null?n:!1;!a&&g&&o("WAWebCmd").Cmd.openCommunityTabbedInfo(g);return}o("WAWebCmd").Cmd.openCommunityHome(g)}},v;C||(g?v=u.jsx(o("WAWebDetailImage.react").DetailImage,{id:g,shape:o("WAWebDetailImage.react").DetailImageShape.Squircle}):v=u.jsx(o("WAWebCommunitySquircleIcon.react").CommunitySquircleIcon,{width:49,height:49,iconXstyle:c.communitySquircle}));var S;C?S=u.jsx("div",{className:"x1c9tyrk xeusxvb x1pahc9y x1ertn4p xpyat2d x1exxlbk x1n2onr6",children:u.jsx(o("WAWebCommunityGeneralChatImage.react").CommunityGeneralChatImage,{})}):d&&!y&&(S=u.jsxs(u.Fragment,{children:[u.jsx(o("WAWebDetailImage.react").DetailImage,{id:d,xstyle:o("WAWebUISpacing").uiMargin.end8}),u.jsx(o("WAWebArrowForwardIcon.react").ArrowForwardIcon,{directional:!0,xstyle:o("WAWebUISpacing").uiMargin.end8})]}));var R=u.jsxs(o("WAWebFlex.react").FlexRow,{justify:"center",align:"center",children:[S,v]}),L=u.jsxs("div",babelHelpers.extends({},(s||(s=r("stylex"))).props(o("WAWebUISpacing").uiMargin.top8,o("WAWebUISpacing").uiMargin.bottom12),{children:[u.jsx(o("WAWebText_DONOTUSE.react").TextHeader,{color:"primary",weight:"medium",level:"3",children:n}),a!=null?u.jsx(o("WAWebText_DONOTUSE.react").Text,{as:"p",size:"13",children:a}):null]})),E=l!=null?u.jsx(r("WAWebUnstyledButton.react"),{xstyle:[c.footerButton,o("WAWebUISpacing").uiPadding.all12],onClick:b,children:u.jsx(o("WAWebText_DONOTUSE.react").Text,{as:"span",size:"14",weight:"medium",children:l})}):null;return u.jsxs(u.Fragment,{children:[u.jsxs("div",babelHelpers.extends({},s.props(o("WAWebUISpacing").uiPadding.horiz24,o("WAWebUISpacing").uiPadding.top12,i&&o("WAWebUISpacing").uiPadding.bottom16),{children:[R,L,i]})),E]})}d.displayName=d.name+" [from "+i.id+"]";function m(e){var t=e.items;return u.jsx("ul",babelHelpers.extends({},(s||(s=r("stylex"))).props(c.list,o("WAWebUISpacing").uiMargin.start24),{children:t.map(function(e,t){return u.jsx("li",{className:"xo7wnuk x1a8jhtq x1hmns74",children:e},t)})}))}m.displayName=m.name+" [from "+i.id+"]",l.MessageCommunityCard=d,l.BulletedList=m}),98);
__d("WAWebMessageCommunityLinkGroup.react",["fbt","WAWebFormatParticipantNames","WAWebGroupMetadataCollection","WAWebMessageCommunityCard.react","WAWebUserPrefsMeUser","react"],(function(t,n,r,o,a,i,l,s){var e,u=e||(e=r("react"));function c(e){var t,n,a=e.templateParams,i=e.clickable,l=e.author,c=e.chat,m=a[0],p=r("WAWebGroupMetadataCollection").get(m),_=p==null?void 0:p.participants.iAmAdmin(),f=(t=c.groupMetadata)==null?void 0:t.membershipApprovalMode,g=(n=c.groupMetadata)==null?void 0:n.hiddenSubgroup,h;g===!0?h=s._(/*BTDS*/"Solo las personas de la comunidad que hayan recibido una invitaci\u00f3n podr\u00e1n ver este grupo y unirse a \u00e9l."):f===!0?h=s._(/*BTDS*/"Cualquier miembro de la comunidad puede solicitar unirse a este grupo."):h=s._(/*BTDS*/"Cualquier miembro de la comunidad puede unirse a este grupo.");var y=[s._(/*BTDS*/"Como miembro, puedes unirte a los grupos de esta comunidad y recibir avisos de los administradores."),h,s._(/*BTDS*/"Quienes administran la comunidad pueden ver tu perfil.")],C=[s._(/*BTDS*/"Los miembros de este grupo ahora forman parte de la comunidad."),h],b=_===!0?s._(/*BTDS*/"Administrar la comunidad"):s._(/*BTDS*/"Explorar la comunidad");return u.jsx(o("WAWebMessageCommunityCard.react").MessageCommunityCard,{communityId:m,subgroupId:c.id,title:d({templateParams:a,clickable:i,author:l}),body:u.jsx(o("WAWebMessageCommunityCard.react").BulletedList,{items:_===!0?C:y}),footer:b,openNavigation:!_})}c.displayName=c.name+" [from "+i.id+"]";function d(e){var t=e.templateParams,n=e.clickable,r=e.author,a=r?o("WAWebFormatParticipantNames").getFormattedName(r,n):null,i=o("WAWebFormatParticipantNames").getFormattedCommunityNameWithAlternative({jid:t[0],asString:!n,alternativeStringName:t[1]}),l=!i,u=o("WAWebUserPrefsMeUser").isMeAccount(r);return l?u?s._(/*BTDS*/"A\u00f1adiste este grupo a una comunidad"):a!=null?s._(/*BTDS*/"{author} a\u00f1adi\u00f3 este grupo a una comunidad",[s._param("author",a)]):s._(/*BTDS*/"Se a\u00f1adi\u00f3 este grupo a una comunidad"):u?s._(/*BTDS*/"A\u00f1adiste este grupo a la comunidad {community}",[s._param("community",i)]):a!=null?s._(/*BTDS*/"{author} a\u00f1adi\u00f3 este grupo a la comunidad {community}",[s._param("author",a),s._param("community",i)]):s._(/*BTDS*/"Se a\u00f1adi\u00f3 este grupo a la comunidad {community}.",[s._param("community",i)])}l.MessageCommunityLinkGroup=c,l.communityLinkGroupTitle=d}),226);
__d("WAWebMessageCommunitySubgroupWelcome.react",["fbt","WAWebFormatParticipantNames","WAWebMessageCommunityCard.react","react"],(function(t,n,r,o,a,i,l,s){var e,u=e||(e=r("react"));function c(e){var t=e.templateParams,n=e.clickable,r=e.author,a=e.chat,i=t[0],l=[s._(/*BTDS*/"Como miembro, puedes unirte a los grupos de esta comunidad y recibir avisos de los administradores."),s._(/*BTDS*/"Quienes administran la comunidad pueden ver tu perfil.")],c=s._(/*BTDS*/"Explorar la comunidad");return u.jsx(o("WAWebMessageCommunityCard.react").MessageCommunityCard,{communityId:i,subgroupId:a.id,title:d({templateParams:t,clickable:n,author:r}),body:u.jsx(o("WAWebMessageCommunityCard.react").BulletedList,{items:l}),footer:c,openNavigation:!0})}c.displayName=c.name+" [from "+i.id+"]";function d(e){var t=e.templateParams,n=e.clickable,r=e.author,a=r?o("WAWebFormatParticipantNames").getFormattedName(r,n):null,i=o("WAWebFormatParticipantNames").getFormattedCommunityNameWithAlternative({jid:t[0],asString:!n,alternativeStringName:t[1]}),l=!i;return l?a!=null?s._(/*BTDS*/"{user_name} te a\u00f1adi\u00f3 a un grupo en una comunidad",[s._param("user_name",a)]):s._(/*BTDS*/"Te uniste a un grupo en una comunidad mediante una invitaci\u00f3n."):a!=null?s._(/*BTDS*/"{user_name} te a\u00f1adi\u00f3 a un grupo en la comunidad {community}",[s._param("user_name",a),s._param("community",i)]):s._(/*BTDS*/"Te uniste a un grupo en la comunidad {community} mediante una invitaci\u00f3n",[s._param("community",i)])}l.MessageCommunitySubgroupWelcome=c,l.communitySubgroupWelcomeTitle=d}),226);
__d("WAWebMessageCommunityWelcomeAdmin.react",["fbt","WANullthrows","WAWebFormatLinkNotification","WAWebGroupMetadataCollection","WAWebMessageCommunityCard.react","WAWebUISpacing","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory","isStringNullOrEmpty","react","stylex"],(function(t,n,r,o,a,i,l,s){var e,u,c=e||(e=r("react"));function d(e){var t,n=e.templateParams,a=e.chat,i=e.author,l=n.length>0?n[0]:null,d;l instanceof r("WAWebWid")?d=l:r("isStringNullOrEmpty")(l)||(d=o("WAWebWidFactory").createWid(l));var p=d!=null?r("WAWebGroupMetadataCollection").get(d):null;p!=null&&p.parentGroup&&(d=p.parentGroup);var _=o("WAWebUserPrefsMeUser").isMeAccount((t=a.groupMetadata)==null?void 0:t.owner);if(!_)return c.jsx("div",babelHelpers.extends({},(u||(u=r("stylex"))).props(o("WAWebUISpacing").uiPadding.horiz12,o("WAWebUISpacing").uiPadding.top5,o("WAWebUISpacing").uiPadding.bottom6),{children:o("WAWebFormatLinkNotification").formatLinkNotification("community_create",i,null,n,!0)}));if(d==null)return null;var f=c.jsx("div",babelHelpers.extends({},(u||(u=r("stylex"))).props(o("WAWebUISpacing").uiPadding.horiz10),{children:s._(/*BTDS*/"Env\u00eda actualizaciones importantes de los administradores a todos los miembros a la vez.")})),g=s._(/*BTDS*/"Administrar comunidad");return c.jsx(o("WAWebMessageCommunityCard.react").MessageCommunityCard,{communityId:d,subgroupId:a.id,title:m({templateParams:n,chat:a,author:i}),subtitle:f,footer:g})}d.displayName=d.name+" [from "+i.id+"]";function m(e){var t,n=e.templateParams,a=e.chat,i=e.author,l=o("WAWebUserPrefsMeUser").isMeAccount((t=a.groupMetadata)==null?void 0:t.owner);return l?s._(/*BTDS*/"\u00a1Te damos la bienvenida a tu comunidad!"):r("WANullthrows")(o("WAWebFormatLinkNotification").formatLinkNotifAsFbt("community_create",i,null,n))}m.displayName=m.name+" [from "+i.id+"]",l.MessageCommunityWelcomeAdmin=d,l.communityWelcomeAdminTitle=m}),226);
__d("WAWebMessageCommunityWelcomeMember.react",["fbt","WAWebFormatParticipantNames","WAWebMessageCommunityCard.react","react"],(function(t,n,r,o,a,i,l,s){var e,u=e||(e=r("react"));function c(e){var t=e.templateParams,n=e.clickable,r=e.author,a=e.chat,i=t[0],l=r?o("WAWebFormatParticipantNames").getFormattedName(r,n):null,c=[u.jsx(u.Fragment,{children:l==null||l===""?s._(/*BTDS*/"Te uniste a esta comunidad."):s._(/*BTDS*/"{author} te a\u00f1adi\u00f3.",[s._param("author",l)])}),s._(/*BTDS*/"Aqu\u00ed, quienes administran la comunidad enviar\u00e1n avisos importantes a los miembros.")],m=s._(/*BTDS*/"Ver informaci\u00f3n de la comunidad");return u.jsx(o("WAWebMessageCommunityCard.react").MessageCommunityCard,{communityId:i,subgroupId:a.id,title:d(),body:u.jsx(o("WAWebMessageCommunityCard.react").BulletedList,{items:c}),footer:m})}c.displayName=c.name+" [from "+i.id+"]";function d(){return s._(/*BTDS*/"\u00a1Te damos la bienvenida a la comunidad!")}d.displayName=d.name+" [from "+i.id+"]",l.MessageCommunityWelcomeMember=c,l.communityWelcomeMemberTitle=d}),226);
__d("WAWebBizGetCustomUrlUserGraphqlQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"data"}],t=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"data"}],concreteType:"WAWebBizGetCustomUrlUserGraphqlQueryResponse",kind:"LinkedField",name:"xwa_custom_url_get_user",plural:!1,selections:[{alias:null,args:null,concreteType:"boolean",kind:"ScalarField",name:"success",plural:!1,storageKey:null},{alias:null,args:null,concreteType:"WAWebBizGetCustomUrlUser",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,concreteType:"string",name:"jid",kind:"ScalarField",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"number",kind:"ScalarField",name:"error_code",plural:!1,storageKey:null},{alias:null,args:null,concreteType:"string",kind:"ScalarField",name:"error_text",plural:!1,storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebBizGetCustomUrlUserGraphqlQuery",selections:t,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebBizGetCustomUrlUserGraphqlQuery",selections:t},params:{id:"WAWebBizGetCustomUrlUserGraphqlQuery",metadata:{},name:"WAWebBizGetCustomUrlUserGraphqlQuery",operationKind:"query",text:null}}})(),l=e;i.default=l}),66);
__d("WAWebBizGetCustomUrlUserGraphql",["WAWebBizGetCustomUrlUserGraphqlQuery.graphql","WAWebGraphQLServerError","WAWebRelayClient","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){return o("WAWebRelayClient").fetchQuery(e!==void 0?e:e=n("WAWebBizGetCustomUrlUserGraphqlQuery.graphql"),{data:{custom_url:{path:t}}}).then(u).catch(function(e){if(e instanceof o("WAWebGraphQLServerError").GraphQLServerError){var t,n,r,a;return{type:"graphql-error",errorCode:(t=(n=e.source)==null?void 0:n.errors[0].code)!=null?t:0,errorText:(r=(a=e.source)==null?void 0:a.errors[0].message)!=null?r:""}}return{type:"graphql-error",errorCode:0,errorText:"unknown error"}})});return function(n){return t.apply(this,arguments)}})();function u(e){var t,n;if(!(e!=null&&(t=e.xwa_custom_url_get_user)!=null&&t.success)){var r,o,a=e==null||(r=e.xwa_custom_url_get_user)==null?void 0:r.error_code,i=e==null||(o=e.xwa_custom_url_get_user)==null?void 0:o.error_text;return{type:"error",errorCode:c(a),errorText:i!=null?i:""}}var l=e==null||(n=e.xwa_custom_url_get_user)==null||(n=n.user)==null?void 0:n.jid;return l==null||l===""?{type:"error",errorCode:500,errorText:"null or missing userJid"}:{type:"success",user:{jid:l}}}function c(e){switch(e){case"CODE_404":return 404;case"CODE_400":return 400;case"CODE_403":return 403;case"CODE_500":return 500;default:return 0}}l.queryCustomUrlUser=s,l.parseResponse=u}),98);
__d("WAWebBizGetCustomUserJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWapDeprecatedSmaxID","WAWebBackendErrors","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=new(r("WADeprecatedWapParser"))("customURLResponse",function(e){e.assertTag("iq"),e.assertFromServer();var t=e.child("user"),n=t.attrUserJid("jid");return{user:{jid:n}}});function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n,a=(n=o("WAWap")).wap("iq",{smax_id:n.SMAX_ID(r("WAWapDeprecatedSmaxID").BtmCustomUrlGetUser),xmlns:"fb:thrift_iq",type:"get",to:n.S_WHATSAPP_NET,id:n.generateId()},n.wap("custom_url",null,n.wap("path",null,t))),i=yield o("WADeprecatedSendIq").deprecatedSendIq(a,e);if(!i.success)throw new(o("WAWebBackendErrors")).ServerStatusCodeError(i.errorCode,i.errorText);return i.result}),u.apply(this,arguments)}l.getUserByCustomURL=s}),98);
__d("WAWebBizGetWidFromPathCustomUrlAction",["WALogger","WAWebBackendErrors","WAWebBizGatingUtils","WAWebBizGetCustomUrlUserGraphql","WAWebBizGetCustomUserJob","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n;if(o("WAWebBizGatingUtils").isGetCustomUrlUserGraphqlMigrationEnabled()){var r=yield d(t);r!=null&&(n=o("WAWebWidFactory").createUserWidOrThrow(r))}else try{var a=yield o("WAWebBizGetCustomUserJob").getUserByCustomURL(t);n=o("WAWebWidFactory").createUserWidOrThrow(a.user.jid)}catch(t){if(t instanceof o("WAWebBackendErrors").ServerStatusCodeError)return t.statusCode!==404&&o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[custom-url] Error fetching user by custom url ",""])),t.message).sendLogs("get-user-by-custom-url-error"),null;throw t}return n}),c.apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=yield o("WAWebBizGetCustomUrlUserGraphql").queryCustomUrlUser(e);return n.type==="error"?(n.errorCode!==404&&o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[custom-url] Error fetching user by custom url "," ",""])),n.errorCode,n.errorText).sendLogs("get-user-by-custom-url-graphql-error"),null):(t=n.user)==null?void 0:t.jid}),m.apply(this,arguments)}l.getWidfromPath=u}),98);
__d("WAWebOpenChatFlow.react",["fbt","$InternalEnum","WAAbortError","WALogger","WAPromiseDelays","WATimeUtils","WAWebBizGetWidFromPathCustomUrlAction","WAWebBotProfileCollection","WAWebCmd","WAWebComposeBoxActions","WAWebConfirmPopup.react","WAWebExternalLink.react","WAWebFbtCommon","WAWebFindChatAction","WAWebFlex.react","WAWebLinkify","WAWebNoop","WAWebQueryExistsJob","WAWebSpinner.react","WAWebUserPrefsMeUser","WAWebUsernameGatingUtils","WAWebUsernameKeyVerificationFlow","asyncToGeneratorRuntime","err","react","useWAWebFlow"],(function(t,n,r,o,a,i,l,s){var e,u,c,d,m=d||(d=o("react")),p=c||(c=r("react")),_=m.useEffect,f=m.useRef,g=250,h=500,y=new Map;function C(){y.clear()}function b(e){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!e.isUser())return e;var t=y.get(e.user);if(t)return t;var n=yield o("WAWebQueryExistsJob").queryWidExists(e),r=n==null?e:n.wid;return y.set(e.user,r),r}),v.apply(this,arguments)}var S=n("$InternalEnum").Mirrored(["Confirm","Error"]);function R(t){var a=o("useWAWebFlow").useFlow(),i=a[0],l=a[1],c=f(),d=(function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var n=t.targetId,r=n.targetId,a=n.customURL,i=n.username,l=n.usernameKey;if(r!=null)return{wid:r,lookupMetod:"directWid"};if(a!=null){var s=yield o("WAWebBizGetWidFromPathCustomUrlAction").getWidfromPath(a);if(s)return{wid:s,lookupMetod:"customURL"};if(i==null)return null}if(i!=null){if(o("WAWebUsernameGatingUtils").username1on1ChatCreationEnabled()){var c=yield o("WAWebQueryExistsJob").queryUsernameExists(i,l),d;if((c==null?void 0:c.keyRequired)===!0?(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["OpenChatFlow: username query returned keyRequired"]))),d=yield o("WAWebUsernameKeyVerificationFlow").usernameKeyVerificationFlow({username:i,initWithError:l!=null})):d=c==null?void 0:c.wid,d!=null)return{wid:d,lookupMetod:"username"}}return null}o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["OpenChatFlow chatWid couldn't be created from provided props."]))).devConsole({targetId:r,customURL:a,username:i})});return function(){return r.apply(this,arguments)}})(),m=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n=t.msgText,r=t.ctwaContextLinkData,a=t.clearPreviousText,i=a===void 0?!1:a;if(r){var l=o("WAWebLinkify").findLink(r.sourceUrl||"",!1,o("WAWebUserPrefsMeUser").getMaybeMePnUser()),s=(l==null?void 0:l.suspiciousCharacters)!=null&&l.suspiciousCharacters.size>0;s&&(r=void 0)}r&&(n=r.icebreaker),e.active&&n!=null&&n!==""?(i&&o("WAWebComposeBoxActions").ComposeBoxActions.setTextContent(e,""),o("WAWebComposeBoxActions").ComposeBoxActions.paste(e,n),r&&o("WAWebComposeBoxActions").ComposeBoxActions.setCtwaContextLinkData(e,r)):(i&&e.setComposeContents({text:""}),n!=null&&n!==""&&e.setComposeContents({text:n,timestamp:o("WATimeUtils").unixTime()}),yield o("WAWebCmd").Cmd.openChatFromUnread({chat:e}).then(function(t){t&&(o("WAWebComposeBoxActions").ComposeBoxActions.focus(e),r&&o("WAWebComposeBoxActions").ComposeBoxActions.setCtwaContextLinkData(e,r))})),t.sendLogAttributes!=null&&o("WAWebComposeBoxActions").ComposeBoxActions.addMsgSendingLogAttributes(e,t.sendLogAttributes)});return function(n){return e.apply(this,arguments)}})(),y=function(){l.push(S.Error)},C=function(){var e;(e=c.current)==null||e.controller.abort(),c.current=void 0,l.end()};if(_(function(){var e=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=!1,a=new AbortController;o("WAPromiseDelays").delayMs(g).then(function(){if(a.signal.aborted)throw new(o("WAAbortError")).AbortError;e=!0,l.push(S.Confirm)}).catch(o("WAAbortError").catchAbort(r("WAWebNoop")));var i=Date.now(),s=new AbortController,u=s.signal,p=yield d();if(p==null){var _=t.targetId.fallbackURL;_!=null&&o("WAWebExternalLink.react").openExternalLink(_),l.end();return}var f=p.wid,C=p.lookupMetod,v=b(f).then(function(e){var t,n=(t=o("WAWebBotProfileCollection").BotProfileCollection.getDefaultBot())==null?void 0:t.id;if(e.isBot()&&(n==null||!n.equals(e)))throw r("err")("invalid bot chat");return o("WAWebFindChatAction").findOrCreateLatestChat(e,"debugOpenChatFlow",{forceUsync:!0})}).then((function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){if(u.aborted)throw new(o("WAAbortError")).AbortError;e||a.abort();var r=Date.now()-i,s=e?Math.max(h+g-r,0):0;yield m(n.chat),yield o("WAPromiseDelays").delayMs(s),l.end(),t.onSuccess(babelHelpers.extends({},n,{successWidLookupMethod:C}))});return function(e){return r.apply(this,arguments)}})()).catch(o("WAAbortError").catchAbort(r("WAWebNoop"))).catch(function(e){a.abort(),t.onError==null||t.onError(e),y()});c.current={controller:s,promise:v}});return function(){return e.apply(this,arguments)}})();e().catch(r("WAWebNoop"))},[]),l.step==null)return null;var v=null;switch(l.step){case S.Confirm:v=p.jsx(o("WAWebConfirmPopup.react").ConfirmPopup,{title:s._(/*BTDS*/"Iniciando chat"),onCancel:C,cancelText:s._(/*BTDS*/"Cancelar"),children:p.jsx(o("WAWebFlex.react").FlexRow,{justify:"center",align:"center",children:p.jsx(o("WAWebSpinner.react").Spinner,{stroke:6,size:24})})});break;case S.Error:t.customError!=null?v=t.customError:v=p.jsx(o("WAWebConfirmPopup.react").ConfirmPopup,{onOK:function(){return l.end()},okText:r("WAWebFbtCommon")("OK"),children:s._(/*BTDS*/"El n\u00famero de tel\u00e9fono compartido a trav\u00e9s de la direcci\u00f3n URL no es v\u00e1lido.")});break}return p.jsx(i,{flow:l,children:v})}R.displayName=R.name+" [from "+i.id+"]",l.clearChatIdCorrectionCache=C,l.OpenChatFlow=R}),226);
__d("WAWebBlockQuoteFormatMutator",["WAWebBlockQuoteMutatorComponent.react","WAWebCreateRegexMutator","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=/(?:^)\>(\s(?! +)[^\n]+(?:$)(?:\n|$))/gm,c=/(?:^)\>(\s(?! +)[^\n]*(?:$)(?:\n|$))/gm,d=r("WAWebCreateRegexMutator")(u,1),m=r("WAWebCreateRegexMutator")(c,1),p=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n,o){var e=o.selectable,a=e===void 0?!1:e,i=o.inline,l=i===void 0?!1:i,u=o.quoted,c=u===void 0?!1:u,d=n[1];return s.jsx(r("WAWebBlockQuoteMutatorComponent.react"),{selectable:a,inline:l,text:d,quoted:c,children:t})},t})(d);p.unformatDecorations={pre:">"};var _=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(m);l.BlockQuote=p,l.BlockQuoteWithEmpty=_}),98);
__d("WAWebAdjustDelimitedRange",[],(function(t,n,r,o,a,i){function e(e){return function(t,n){var r=2*e.length+t[1].length,o=t[0].length-r;return o>0&&(t.index+=o,t[0]=t[0].slice(o)),n.lastIndex--,t}}i.default=e}),66);
__d("WAWebBoldFormatRegex",[],(function(t,n,r,o,a,i){var e=/(?:^|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))\*(?![\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]|\u20E3|\uFE0F\u20E3)((?:[\0-\t\x0B-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))\*(?=$|(?!\u20E3|\uFE0F\u20E3))(?=$|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))/g,l=e;i.default=l}),66);
__d("WAWebBoldMutatorComponent.react",["WAWebCopyPasteSelectable.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){var t=e.children,n=t===void 0?"":t,r=e.selectable;return s.jsx(o("WAWebCopyPasteSelectable.react").SelectableStrong,{selectable:r,appTextTemplate:"*${appText}*",children:n})}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("WAWebBoldFormatMutator",["WAWebAdjustDelimitedRange","WAWebBoldFormatRegex","WAWebBoldMutatorComponent.react","WAWebCreateRegexMutator","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=r("WAWebAdjustDelimitedRange")("*"),c=r("WAWebCreateRegexMutator")(r("WAWebBoldFormatRegex"),1,u),d=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n,o){var e=o.selectable,a=e===void 0?!1:e;return s.jsx(r("WAWebBoldMutatorComponent.react"),{selectable:a,children:t})},t})(c);l.default=d}),98);
__d("WAWebBotCommandMutatorComponent.react",["WAWebClickable.react","WAWebComposeBoxActions","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u={link:{color:"x1ph7ams",$$css:!0}};function c(e){var t=e.children,n=t===void 0?"":t,r=function(){o("WAWebComposeBoxActions").ComposeBoxActions.paste(null,String(n)+" ",{insertLeadingSpace:!0})};return s.jsx(o("WAWebClickable.react").Clickable,{as:"span",xstyle:u.link,onClick:r,children:n})}c.displayName=c.name+" [from "+i.id+"]",l.default=c}),98);
__d("WAWebBotCommandFormatMutator",["WAWebBotCommandMutatorComponent.react","WAWebExtractRangesUsingRegex","WAWebFormatMutator","escapeRegex","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.match=function(t,n){var e=n!=null?n:{},o=e.commands;if(!o||o.length===0)return[];var a=o.map(function(e){return r("escapeRegex")("/"+e.name)}),i=new RegExp("("+a.join("|")+")(?=$|\\s)","gmi"),l=!1;return r("WAWebExtractRangesUsingRegex")(t,i,0,function(e){return l?null:(l=!0,e)})},t})(r("WAWebFormatMutator"));u.format=!1,u.jsx=function(e,t){return s.jsx(r("WAWebBotCommandMutatorComponent.react"),{children:e})},l.BotCommand=u}),98);
__d("WAWebBulletedListFormatMutator",["WAWebBulletedListMutatorComponent.react","WAWebCreateRegexMutator","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=/((?:^)(?:[\*\-\] (?! +)(?:[^\n]+)(?:\n(?:[\*\-\] (?! +)[^\n]+)){0,})(?:\n|$))/gm,c=r("WAWebCreateRegexMutator")(u,0),d=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n,o){return s.jsx(r("WAWebBulletedListMutatorComponent.react"),babelHelpers.extends({},o,{children:t}))},t})(c);d.nestable=function(){return!1},l.default=d}),98);
__d("WAWebBulletedListItemFormatMutator",["WAWebBulletedListFormatMutator","WAWebBulletedListItemMutatorComponent.react","WAWebCreateRegexMutator","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=/(?:^)[\*\]( (?! +)[^\n]+(?:$))/gm,c=/(?:^)\-( (?! +)[^\n]+(?:$))/gm,d=/(?:^)\*( (?! +)[^\n]*(?:$))/gm,m=/(?:^)\-( (?! +)[^\n]*(?:$))/gm,p=new Set([r("WAWebBulletedListFormatMutator")]);function _(e,t){var n,o=r("WAWebCreateRegexMutator")(e,1),a=(n=(function(e){function n(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(n,e),n.jsx=function(n,o,a){var e=a.selectable,i=e===void 0?!1:e,l=a.inline,u=o[1];return s.jsx(r("WAWebBulletedListItemMutatorComponent.react"),{inline:l,selectable:i,text:u,symbol:t,children:n})},n})(o),n.displayName="BulletedListItem",n.nestable=function(e){return p.has(e)},n.unformatDecorations={pre:t},n);return a}var f=_(u,"*"),g=_(c,"-"),h=_(d,"*"),y=_(m,"-");l.BulletedListItem=f,l.HyphenListItem=g,l.BulletedListItemWithEmpty=h,l.HyphenListItemWithEmpty=y}),98);
__d("WAWebEmojiMutatorComponent.react",["WAWebEmoji.react","WAWebMessageLargeEmoji.react","react","useWAWebABPropConfigValue"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){var t=e.emoji,n=e.selectable,a=e.size,i=e.xstyle;return o("useWAWebABPropConfigValue").useABPropConfigValue("custom_racing_emoji"),o("useWAWebABPropConfigValue").useABPropConfigValue("custom_racing_emoji_feb2025"),a==="xlarge"?s.jsx(o("WAWebMessageLargeEmoji.react").LargeEmoji,{emoji:t,xstyle:i,size:o("WAWebMessageLargeEmoji.react").SIZE.XLARGE,element:"span",selectable:n}):s.jsx(r("WAWebEmoji.react"),{emoji:t,xstyle:i,selectable:n,size:a})}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("WAWebEmojiFormatMutator",["WAUnicodeUtils","WAWebEmoji","WAWebEmojiMutatorComponent.react","WAWebExtractRangesUsingRegex","WAWebFormatMutator","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n,o){var e=n[0],a=o.size,i=o.selectable,l=i===void 0?!1:i,u=o.emojiXstyle;return s.jsx(r("WAWebEmojiMutatorComponent.react"),{emoji:e,size:a,selectable:l,xstyle:u})},t.match=function(t,n,a){var e=a!=null&&a!==0?a:t.length,i=o("WAUnicodeUtils").firstNCodepoints(t,e);return r("WAWebExtractRangesUsingRegex")(i,o("WAWebEmoji").EmojiUtil.emojiRegex(),0,c)},t})(r("WAWebFormatMutator"));u.compatibility=!0;function c(e,t){return o("WAWebEmoji").EmojiUtil.getGlyphId(e[0])?e:null}l.default=u}),98);
__d("WAWebHeadingFormatMutator",["$InternalEnum","WAWebBotGating","WAWebCreateRegexMutator","WAWebRichTextHeading.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=n("$InternalEnum")({LEVEL_1:1,LEVEL_2:2,LEVEL_3:3,LEVEL_4:4}),c=/^(#{1,4})\s([^\n]+)(?:$)(?:\n|$)/gm,d=r("WAWebCreateRegexMutator")(c,2);function m(e){switch(e){case"#":return u.LEVEL_1;case"##":return u.LEVEL_2;case"###":return u.LEVEL_3;case"####":return u.LEVEL_4;default:return u.LEVEL_4}}var p=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n){var e=n[2],o=n[1];return s.jsx(r("WAWebRichTextHeading.react"),{level:m(o),text:e})},t})(d),_=new Set([u.LEVEL_1,u.LEVEL_2]),f=new Set([u.LEVEL_3,u.LEVEL_4]),g=function(t){return _.has(t)},h=function(t){return f.has(t)},y=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n){var e=n[2],a=m(n[1]);return g(a)&&o("WAWebBotGating").isRichResponseHeadingReceiverEnabled()?s.jsx(r("WAWebRichTextHeading.react"),{level:a,text:e}):h(a)&&o("WAWebBotGating").isRichResponseSubheadingReceiverEnabled()?s.jsx(r("WAWebRichTextHeading.react"),{level:a,text:e}):s.jsx("span",{children:n[0]})},t})(d),C=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n){var e=n[2];return s.jsx("span",{children:e})},t})(d);C.unformatDecorations={post:" "},l.HeadingLevel=u,l.RegexMutator=d,l.Heading=p,l.AIRichResponseHeading=y,l.HeadlessHeading=C}),98);
__d("WAWebRichTextHeading.react",["WAWebHeadingFormatMutator","react","stylex"],(function(t,n,r,o,a,i,l){var e,s,u=e||(e=r("react")),c={base:{display:"x1rg5ohu",width:"xh8yej3",$$css:!0},LEVEL_1:{fontSize:"x1q74xe4",lineHeight:"x1slxwg",marginBottom:"x12nagc",$$css:!0},LEVEL_2:{fontSize:"x1aueamr",lineHeight:"xgif2c7",marginBottom:"x12nagc",$$css:!0},LEVEL_3:{fontSize:"x1603h9y",lineHeight:"x101yacv",marginBottom:"x12nagc",$$css:!0},LEVEL_4:{fontSize:"x1lkfr7t",lineHeight:"x19v9tvf",marginBottom:"x12nagc",$$css:!0}};function d(e){switch(e){case o("WAWebHeadingFormatMutator").HeadingLevel.LEVEL_1:return[c.base,c.LEVEL_1];case o("WAWebHeadingFormatMutator").HeadingLevel.LEVEL_2:return[c.base,c.LEVEL_2];case o("WAWebHeadingFormatMutator").HeadingLevel.LEVEL_3:return[c.base,c.LEVEL_3];case o("WAWebHeadingFormatMutator").HeadingLevel.LEVEL_4:return[c.base,c.LEVEL_4]}}function m(e){var t=e.level,n=e.text;return u.jsx("span",babelHelpers.extends({},(s||(s=r("stylex"))).props(d(t)),{children:n}))}m.displayName=m.name+" [from "+i.id+"]",l.default=m}),98);
__d("WAWebHighlightMutatorComponent.react",["WAWebCopyPasteSelectable.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){var t=e.children,n=t===void 0?"":t,r=e.selectable;return s.jsx(o("WAWebCopyPasteSelectable.react").SelectableSpan,{className:"matched-text",selectable:r,children:n})}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("WAWebHighlightFormatMutator",["WAWebExtractRangesUsingRegex","WAWebFormatMutator","WAWebHighlightMutatorComponent.react","WAWebL10N","escapeRegex","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.match=function(t,n){if(!n)return[];var e=n.terms,o=n.boundary,a=o===void 0?!1:o,i=n.ignoreDiacritics,l=i===void 0?!1:i;if(!e.length||e.every(function(e){return e.length===0}))return[];var s=l&&r("WAWebL10N").isLatinAlphabetLanguage(t)&&e.every(function(e){return r("WAWebL10N").isLatinAlphabetLanguage(e)})&&!r("WAWebL10N").isRTL(),u=s?r("WAWebL10N").removeAccents(t):t,d=r("WAWebExtractRangesUsingRegex")(u,c(e,a,s));return d},t})(r("WAWebFormatMutator"));u.jsx=function(e,t,n){var o=n.selectable;return s.jsx(r("WAWebHighlightMutatorComponent.react"),{selectable:o,children:e})};function c(e,t,n){var o=n?e.map(function(e){return r("WAWebL10N").removeAccents(e)}):e,a=o.filter(function(e){return e.trim().length>0}),i=a.map(r("escapeRegex")).join("|");return r("WAWebL10N").isRTL()?new RegExp((t?"(?:^|\\b)":"")+"(\\S+)?("+i+")(\\S+)?","ig"):new RegExp((t?"(?:^|\\b)":"")+"("+i+")","ig")}l.default=u}),98);
__d("WAWebInlineCodeFormatRegex",[],(function(t,n,r,o,a,i){var e=/(?:^|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))`(?![\t-\r `\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])((?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])(?:[\0-\t\x0B-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))`(?=$|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))/g,l=e;i.default=l}),66);
__d("WAWebInlineCodeMutatorComponent.react",["WAWebCopyPasteSelectable.react","WAWebUISpacing","react","stylex"],(function(t,n,r,o,a,i,l){var e,s,u=e||(e=r("react")),c={code:{borderStartStartRadius:"xbrszos",borderStartEndRadius:"xea3l6g",borderEndEndRadius:"x18isctg",borderEndStartRadius:"x2q3nzr",backgroundColor:"x1bu39yj",color:"x1bvqhpb",$$css:!0},quotedColor:{color:"x15rks2t",$$css:!0}};function d(e){var t=e.children,n=t===void 0?"":t,a=e.quoted,i=e.selectable;return u.jsx(o("WAWebCopyPasteSelectable.react").SelectableCode,{selectable:i,appTextTemplate:"`${appText}`",className:(s||(s=r("stylex")))(c.code,a&&c.quotedColor,o("WAWebUISpacing").uiPadding.horiz4,o("WAWebUISpacing").uiPadding.vert2),children:n})}d.displayName=d.name+" [from "+i.id+"]",l.default=d}),98);
__d("WAWebInlineCodeFormatMutator",["WAWebAdjustDelimitedRange","WAWebCreateRegexMutator","WAWebInlineCodeFormatRegex","WAWebInlineCodeMutatorComponent.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=r("WAWebAdjustDelimitedRange")("`"),c=r("WAWebCreateRegexMutator")(r("WAWebInlineCodeFormatRegex"),1,u),d=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n,o){var e=o.selectable,a=e===void 0?!1:e,i=o.quoted,l=i===void 0?!1:i;return s.jsx(r("WAWebInlineCodeMutatorComponent.react"),{selectable:a,quoted:l,children:t})},t})(c);d.format=!1,l.default=d}),98);
__d("WAWebItalicFormatRegex",[],(function(t,n,r,o,a,i){var e=/(?:^|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))_((?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])(?:[\0-\t\x0B-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))_(?=$|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))/g,l=e;i.default=l}),66);
__d("WAWebItalicMutatorComponent.react",["WAWebCopyPasteSelectable.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){var t=e.children,n=t===void 0?"":t,r=e.selectable;return s.jsx(o("WAWebCopyPasteSelectable.react").SelectableEm,{selectable:r,appTextTemplate:"_${appText}_",children:n})}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("WAWebItalicFormatMutator",["WAWebAdjustDelimitedRange","WAWebCreateRegexMutator","WAWebItalicFormatRegex","WAWebItalicMutatorComponent.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=r("WAWebAdjustDelimitedRange")("_"),c=r("WAWebCreateRegexMutator")(r("WAWebItalicFormatRegex"),1,u),d=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n,o){var e=o.selectable,a=e===void 0?!1:e;return s.jsx(r("WAWebItalicMutatorComponent.react"),{selectable:a,children:t})},t})(c);l.default=d}),98);
__d("WAWebLinkMutatorComponent.react",["WAWebCopyPasteSelectable.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u={link:{textDecoration:"x1bvjpef x1lku1pv x11iimpl xbvygy2 x1wp9yj1 x1e2wovf",color:"x1ph7ams x17f7hit",backgroundColor:"xn69kzl",textUnderlineOffset:"xrys4gj xhmieyt",$$css:!0}};function c(e){var t=e.children,n=t===void 0?"":t,r=e.className,a=e.dataTab,i=e.href,l=e.onClick,c=e.selectable;return s.jsx(o("WAWebCopyPasteSelectable.react").SelectableLink,{onClick:function(t){l==null||l()},onContextMenu:function(t){l==null||l()},className:r,xstyle:u.link,href:i,title:i,target:"_blank",rel:"noopener noreferrer",selectable:c,dataTab:a,children:n})}c.displayName=c.name+" [from "+i.id+"]",l.default=c}),98);
__d("WAWebStrikethroughFormatRegex",[],(function(t,n,r,o,a,i){var e=/(?:^|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))~((?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])(?:[\0-\t\x0B-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))~(?=$|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))/g,l=e;i.default=l}),66);
__d("WAWebStrikethroughMutatorComponent.react",["WAWebCopyPasteSelectable.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){var t=e.children,n=t===void 0?"":t,r=e.selectable;return s.jsx(o("WAWebCopyPasteSelectable.react").SelectableDel,{selectable:r,appTextTemplate:"~${appText}~",children:n})}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("WAWebStrikethroughFormatMutator",["WAWebAdjustDelimitedRange","WAWebCreateRegexMutator","WAWebStrikethroughFormatRegex","WAWebStrikethroughMutatorComponent.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=r("WAWebAdjustDelimitedRange")("_"),c=r("WAWebCreateRegexMutator")(r("WAWebStrikethroughFormatRegex"),1,u),d=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n,o){var e=o.selectable;return s.jsx(r("WAWebStrikethroughMutatorComponent.react"),{selectable:e,children:t})},t})(c);l.default=d}),98);
__d("WAWebSuspiciousLinkPopup.react",["fbt","WAWebCmd","WAWebConfirmPopup.react","WAWebExternalLink.react","WAWebFaqUrl","WAWebModal.react","WAWebModalManager","react"],(function(t,n,r,o,a,i,l,s){var e,u,c=u||(u=r("react")),d=(e||(e=o("react"))).Fragment,m=".",p=function(){o("WAWebModalManager").ModalManager.close(),o("WAWebCmd").Cmd.closeLongLinkModal(!0)};function _(e){var t=e.link,n=function(){var e=t.href;o("WAWebExternalLink.react").openExternalLink(e),o("WAWebModalManager").ModalManager.close(),o("WAWebCmd").Cmd.closeLongLinkModal(!0)},r=t.suspiciousCharacters,a=t.domain,i=t.href,l=a.split(m),u=l.map(function(e,t){var n=!1,o=e.split("").map(function(e,o){var a=r!=null&&r.has(e);n=a||n;var i=a?"x117nqv4":void 0;return c.jsx("span",{className:i,children:e},t+"-"+o+"-"+e)}),a=n?"xghrzdh":void 0;return c.jsxs(d,{children:[c.jsx("span",{className:a,children:o}),t+1!==l.length?c.jsx("span",{children:m}):null]},t+"-"+e)}),_=i.split(a),f=_[0],g=_[1];return c.jsxs(o("WAWebConfirmPopup.react").ConfirmPopup,{title:s._(/*BTDS*/"Enlace sospechoso"),okText:s._(/*BTDS*/"Cancelar"),cancelText:s._(/*BTDS*/"Abrir enlace"),onOK:p,onCancel:n,type:o("WAWebModal.react").ModalTheme.LinkPopup,children:[c.jsxs("div",{className:"xyorhqc",children:[s._(/*BTDS*/"Este enlace contiene caracteres inusuales. Es posible que no sea el sitio web que aparenta ser.")," ",c.jsx(o("WAWebExternalLink.react").ExternalLink,{href:o("WAWebFaqUrl").getSuspiciousLinkFaqUrl(),children:s._(/*BTDS*/"M\u00e1s informaci\u00f3n")})]}),c.jsxs("div",{className:"x104kibb x1jquxbb x1anpbxc x6ikm8r x10wlt62 x1fc57z9 xlyipyv x1mzt3pk x1gzmk7r x1ua5tub",children:[f,u,g]})]})}_.displayName=_.name+" [from "+i.id+"]",l.default=_}),226);
__d("WAWebSuspiciousLinkMutatorComponent.react",["WAWebCmd","WAWebCopyPasteSelectable.react","WAWebModalManager","WAWebSuspiciousLinkPopup.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){var t=e.children,n=t===void 0?"":t,a=e.className,i=e.dataTab,l=e.link,u=e.onClick,c=e.selectable;return s.jsx(o("WAWebCopyPasteSelectable.react").SelectableLink,{className:a,onClick:function(){o("WAWebModalManager").ModalManager.open(s.jsx(r("WAWebSuspiciousLinkPopup.react"),{link:l})),o("WAWebCmd").Cmd.openLongLinkModal(),u==null||u()},onContextMenu:function(t){u==null||u()},selectable:c,style:{cursor:"pointer"},dataTab:i,children:n})}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("WAWebLinkFormatMutator",["WAWebBoldFormatMutator","WAWebCodeFormatMutator","WAWebFormatMutator","WAWebInlineCodeFormatMutator","WAWebItalicFormatMutator","WAWebLinkMutatorComponent.react","WAWebStrikethroughFormatMutator","WAWebSuspiciousLinkMutatorComponent.react","react","stylex"],(function(t,n,r,o,a,i,l){var e,s,u=e||(e=r("react")),c=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n,o){var e=o.selectable,a=e===void 0?!1:e,i=o.linkXstyle,l=o.onLinkClick,c=o.dataTab,d=n.href,m=n.suspiciousCharacters;return m!=null&&m.size?u.jsx(r("WAWebSuspiciousLinkMutatorComponent.react"),{onClick:l,className:(s||(s=r("stylex")))(i),link:n,selectable:a,dataTab:c,children:t}):u.jsx(r("WAWebLinkMutatorComponent.react"),{className:(s||(s=r("stylex")))(i),onClick:l,href:d,selectable:a,dataTab:c,children:t})},t})(r("WAWebFormatMutator"));c.format=!1,c.compatibility=!0,c.match=function(e,t,n){if(!t)return[];var r=t.links,o=r===void 0?[]:r;return o.map(d)},c.conflictResolvers=new Map([[r("WAWebBoldFormatMutator"),m],[r("WAWebItalicFormatMutator"),m],[r("WAWebStrikethroughFormatMutator"),m],[r("WAWebInlineCodeFormatMutator"),m],[o("WAWebCodeFormatMutator").Code,m]]);function d(e){var t=e.index,n=e.url,r=t+n.length-1;return[t,t,r,r,e]}function m(e,t){for(var n=0,r=0;n<e.length&&r<t.length;){var o=t[r][3]-e[n][3];if(o>0)n++;else if(o<0)r++;else{var a=t[r][3]-t[r][2];e[n][2]-=a,e[n][3]-=a;var i=e[n][5];i.href=i.href.slice(0,-a),i.path=i.path&&i.path.slice(0,-a),i.url=i.url.slice(0,-a),r++,n++}}}l.default=c}),98);
__d("WAWebMentionAllNuxModal.react",["fbt","WAWebConfirmPopup.react","WAWebFbtCommon","WAWebFlex.react","WAWebModalManager","WDSText.react","react","useWAWebFocusOnMount"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(){var e=r("useWAWebFocusOnMount")(),t=function(){o("WAWebModalManager").ModalManager.close()};return u.jsx(o("WAWebConfirmPopup.react").ConfirmPopup,{ref:e,onOK:t,okText:r("WAWebFbtCommon")("Close"),onOverlayClick:t,testid:void 0,children:u.jsxs(o("WAWebFlex.react").FlexColumn,{children:[u.jsx(o("WAWebFlex.react").FlexRow,{align:"start",alignSelf:"stretch",justify:"start",paddingBottom:8,children:u.jsx(r("WDSText.react"),{type:"Headline1",colorName:"contentDefault",children:s._(/*BTDS*/"Menciona a todos")})}),u.jsx(o("WAWebFlex.react").FlexRow,{children:u.jsx(r("WDSText.react"),{type:"Body1",colorName:"contentDeemphasized",children:s._(/*BTDS*/"Env\u00eda una notificaci\u00f3n a todos los miembros sobre un mensaje importante.")})})]})})}c.displayName=c.name+" [from "+i.id+"]",l.default=c}),226);
__d("WAWebWrapperDisplayTypeContext",["react"],(function(t,n,r,o,a,i,l){var e,s=(e||(e=o("react"))).createContext,u=s(null);l.default=u}),98);
__d("WAWebMentionMutatorComponentBase.react",["WABidi","WAWebCopyPasteSelectable.react","WAWebDisplayType","WAWebEmojiFormatMutator","WAWebFormat","WAWebJsxSerializer.react","WAWebWrapperDisplayTypeContext","react","stylex"],(function(t,n,r,o,a,i,l){var e,s,u,c=u||(u=r("react")),d=(e||(e=o("react"))).use,m={gallery:{color:"x1heor9g",$$css:!0},matchedMention:{cursor:"x1ypdohk",color:"x1ph7ams",$$css:!0},lastMessage:{fontWeight:"xk50ysn",$$css:!0},matchedMentionRefresh:{color:"xo1mcw5",fontWeight:"x1xlr1w8",textDecoration:"x1hl2dhg",":hover_textDecoration":"xt0b8zv",":focus-visible_textDecoration":"xbvygy2",":focus-visible_color":"x17f7hit",":focus-visible_backgroundColor":"xp30eni",":focus-visible_textUnderlineOffset":"xhmieyt",$$css:!0}};function p(e){var t,n=d(r("WAWebWrapperDisplayTypeContext")),a=e.onClick,i=e.theme,l=e.selectable,u=e.text,p=e.jid,_=e.ariaLabel,f=e.lastMessage,g=o("WABidi").dir(u)||"auto",h=(t=i==null?void 0:i.quoted)!=null?t:!1,y=r("WAWebFormat")(u,[[[r("WAWebEmojiFormatMutator"),{selectable:l}]]],r("WAWebJsxSerializer.react"),void 0,1/0),C=a&&!h,b=n===o("WAWebDisplayType").DISPLAY_TYPE.GALLERY,v=[C===!0&&m.matchedMention,f===!0&&m.lastMessage,C===!0&&f!==!0&&m.matchedMentionRefresh,b&&m.gallery];return c.jsxs(o("WAWebCopyPasteSelectable.react").SelectableSpan,{dir:"auto","data-jid":p,"data-display":u,className:(s||(s=r("stylex")))(v),onClick:a,plainText:"@"+u,selectable:l,"aria-label":_,selectAll:!0,appTextTemplate:"\u200B"+p+"\u200B",children:["@",c.jsx("span",{dir:g,children:y})]})}p.displayName=p.name+" [from "+i.id+"]",l.default=p}),98);
__d("WAWebMentionAllMutatorComponent.react",["WAWebMentionAllNuxModal.react","WAWebMentionMutatorComponentBase.react","WAWebModalManager","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){var t=e.selectable,n=e.lastMessage,a=function(){o("WAWebModalManager").ModalManager.open(s.jsx(r("WAWebMentionAllNuxModal.react"),{}))};return s.jsx(r("WAWebMentionMutatorComponentBase.react"),{text:"all",jid:"@all",selectable:t,lastMessage:n,onClick:a})}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("WAWebMentionAllFormatMutator",["WAWebExtractRangesUsingRegex","WAWebFormatMutator","WAWebMentionAllMutatorComponent.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.match=function(t,n){if(!n||n.hasMentionAll!==!0)return[];var e=/@all\b/g,o=r("WAWebExtractRangesUsingRegex")(t,e),a=o.map(function(e){var t=e[0],n=e[1],r=e[2],o=e[3],a=e[4],i={text:a[0]};return[t,n,r,o,i]});return a},t.jsx=function(t,n,o){var e=o.selectable,a=o.lastMessage;return s.jsx(r("WAWebMentionAllMutatorComponent.react"),{text:n.text,selectable:e,lastMessage:a})},t})(r("WAWebFormatMutator"));u.compatibility=!0,l.default=u}),98);
__d("WAWebNumberedListFormatMutator",["WAWebCreateRegexMutator","WAWebNumberedListMutatorComponent.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=/((?:^)(?:(\d{1,2})\. (?! +)(?:[^\n]+)(?:\n(?:(\d{1,2})\. [^\n]+)){0,})(?:\n|$))/gm,c=r("WAWebCreateRegexMutator")(u,0),d=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n,o){return s.jsx(r("WAWebNumberedListMutatorComponent.react"),babelHelpers.extends({},o,{children:t}))},t})(c);d.nestable=function(){return!1},l.default=d}),98);
__d("WAWebNumberedListItemFormatMutator",["WAWebCreateRegexMutator","WAWebNumberedListFormatMutator","WAWebNumberedListItemMutatorComponent.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=/(?:^)(\d{1,2}\.)( (?! +)[^\n]+(?:$))/gm,c=/(?:^)(\d{1,2}\.)( (?! +)[^\n]*(?:$))/gm,d=new Set([r("WAWebNumberedListFormatMutator")]);function m(e){var t,n=r("WAWebCreateRegexMutator")(e,2),o=(t=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n,o){var e=o.selectable,a=e===void 0?!1:e,i=o.inline,l=n[1],u=n[2];return s.jsx(r("WAWebNumberedListItemMutatorComponent.react"),{inline:i,selectable:a,text:u,numbering:l,children:t})},t})(n),t.displayName="NumberedListItem",t.nestable=function(e){return d.has(e)},t.unformatDecorations={pre:function(t){return t[1]}},t);return o}var p=m(u),_=m(c);l.NumberedListItem=p,l.NumberedListItemWithEmpty=_}),98);
__d("WAWebWamEnumUrlStatusClicked",[],(function(t,n,r,o,a,i){var e=Object.freeze({ONE_CLICK:1,TWO_CLICKS:2,NO_CLICK:3});i.URL_STATUS_CLICKED=e}),66);
__d("WAWebLongLinkPop.react",["fbt","WAWebCmd","WAWebConfirmPopup.react","WAWebExternalLink.react","WAWebModal.react","WAWebModalManager","WAWebWamEnumUrlStatusClicked","react"],(function(t,n,r,o,a,i,l,s){var e,u=e||(e=r("react")),c=function(){o("WAWebModalManager").ModalManager.close(),o("WAWebCmd").Cmd.closeLongLinkModal(!0)};function d(e){var t=e.link,n=function(){var n;((n=e.statusItemViewEventRef)==null?void 0:n.current)!=null&&(e.statusItemViewEventRef.current.urlStatusClicked=o("WAWebWamEnumUrlStatusClicked").URL_STATUS_CLICKED.TWO_CLICKS),o("WAWebModalManager").ModalManager.close(),o("WAWebExternalLink.react").openExternalLink(t.href)};return u.jsx(o("WAWebConfirmPopup.react").ConfirmPopup,{title:s._(/*BTDS*/"Abrir en el navegador"),okText:s._(/*BTDS*/"Abrir enlace"),cancelText:s._(/*BTDS*/"Cancelar"),onOK:n,onCancel:c,type:o("WAWebModal.react").ModalTheme.LinkPopup,children:u.jsx("div",{children:t.href})})}d.displayName=d.name+" [from "+i.id+"]",l.default=d}),226);
__d("WAWebStatusContext",["react"],(function(t,n,r,o,a,i,l){var e,s=(e||(e=o("react"))).createContext,u=s({statusItemViewEventRef:null});l.StatusContext=u}),98);
__d("WAWebLongLinkMutatorComponent.react",["WAWebCmd","WAWebCopyPasteSelectable.react","WAWebLongLinkPop.react","WAWebModalManager","WAWebStatusContext","WAWebSuspiciousLinkMutatorComponent.react","react","stylex"],(function(t,n,r,o,a,i,l){var e,s,u,c=u||(u=r("react")),d=(e||(e=o("react"))).useContext,m={link:{cursor:"x1ypdohk",$$css:!0}};function p(e){var t,n=e.children,a=n===void 0?"":n,i=e.dataTab,l=e.link,u=e.selectable,p=e.xstyle,_=d(o("WAWebStatusContext").StatusContext),f=_.statusItemViewEventRef;return(t=l.suspiciousCharacters)!=null&&t.size?c.jsx(r("WAWebSuspiciousLinkMutatorComponent.react"),{className:(s||(s=r("stylex")))(p),link:l,selectable:u,children:a}):c.jsx(o("WAWebCopyPasteSelectable.react").SelectableLink,{dataTab:i,onClick:function(t){t.preventDefault(),o("WAWebModalManager").ModalManager.open(c.jsx(r("WAWebLongLinkPop.react"),{link:l,statusItemViewEventRef:f})),o("WAWebCmd").Cmd.openLongLinkModal()},selectable:u,className:(s||(s=r("stylex")))(m.link,p),children:a})}p.displayName=p.name+" [from "+i.id+"]",l.default=p}),98);
__d("WAWebStatusLinkFormatMutator",["WAWebLinkFormatMutator","WAWebLongLinkMutatorComponent.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=34,c=12,d="...";function m(e,t){var n=Math.min(t.length,Math.max(t.length-c,t.length+e.length-u));return t.length-n}function p(e,t){var n=t.length>c||t.length+e.length>u?t.slice(0,m(e,t)):t;return n}function _(e){var t=e.domain,n=e.path;return[t.replace(/^www\./,""),n==null||n.length===1?"":n]}function f(e,t){var n=p(e,t),r=e+(n.length===1?"":n),o=r.length>u?""+d+r.slice(r.length-u):r,a=t!==n?d:"";return o+a}var g=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(n,o,a){var t=_(o),i=t[0],l=t[1],u=f(i,l);if(u!==i+l){var c;return s.jsx(r("WAWebLongLinkMutatorComponent.react"),{xstyle:a.linkXstyle,selectable:(c=a.selectable)!=null?c:!1,link:o,dataTab:a.dataTab,children:u})}return e.jsx.call(this,[i+l],o,a)},t})(r("WAWebLinkFormatMutator"));l.cleanUrl=_,l.redactUrl=f,l.StatusLink=g}),98);
__d("WAWebFormatConfiguration",["WAWebABProps","WAWebBlockQuoteFormatMutator","WAWebBoldFormatMutator","WAWebBotCommandFormatMutator","WAWebBotGating","WAWebBulletedListFormatMutator","WAWebBulletedListItemFormatMutator","WAWebCodeFormatMutator","WAWebEmojiFormatMutator","WAWebGroupMentionFormatMutator","WAWebHeadingFormatMutator","WAWebHighlightFormatMutator","WAWebInlineCodeFormatMutator","WAWebItalicFormatMutator","WAWebLinkFormatMutator","WAWebMentionAllFormatMutator","WAWebMentionFormatMutator","WAWebNoop","WAWebNumberedListFormatMutator","WAWebNumberedListItemFormatMutator","WAWebPhoneNumberFormatMutator","WAWebRawGroupMentionFormatMutator","WAWebRawMentionMutator","WAWebRawShortNameMentionFormatMutator","WAWebStatusLinkFormatMutator","WAWebStrikethroughFormatMutator","WAWebTextMentionFormatMutator","cr:6000","gkx"],(function(t,n,r,o,a,i,l){var e=function(t){var e=t===void 0?{}:t,n=e.selectable,o=e.emojiXstyle;return[[[r("WAWebEmojiFormatMutator"),{selectable:n,emojiXstyle:o}]]]},s=function(t){var e=t===void 0?{}:t,n=e.selectable;return[[[r("WAWebEmojiFormatMutator"),{selectable:n,size:"large"}]]]},u=function(t){var e=t===void 0?{}:t,n=e.links,a=e.selectable,i=e.linkXstyle,l=e.emojiXstyle,s=e.dataTab;return[[[o("WAWebCodeFormatMutator").Code,{selectable:a}]],[[o("WAWebStatusLinkFormatMutator").StatusLink,{links:n,selectable:a,linkXstyle:i,dataTab:s}]],[[r("WAWebBoldFormatMutator"),{selectable:a}],[r("WAWebItalicFormatMutator"),{selectable:a}],[r("WAWebStrikethroughFormatMutator"),{selectable:a}]],[[r("WAWebEmojiFormatMutator"),{selectable:a,size:"xlarge",emojiXstyle:l}]]]},c=function(t){var e=t===void 0?{}:t,n=e.selectable;return[[[o("WAWebCodeFormatMutator").Code,{selectable:n}]],[[r("WAWebBoldFormatMutator"),{selectable:n}],[r("WAWebItalicFormatMutator"),{selectable:n}],[r("WAWebStrikethroughFormatMutator"),{selectable:n}]],[[r("WAWebEmojiFormatMutator"),{selectable:n}]]]},d=function(t){var e=t===void 0?{}:t,n=e.selectable;return[[[r("WAWebEmojiFormatMutator"),{selectable:n}]]]},m=function(t){var e=t===void 0?{}:t,a=e.mentions,i=e.groupMentions,l=e.hasMentionAll,s=e.links,u=e.phoneNumbers,c=e.selectable,d=e.trusted,m=e.fromMe,p=e.fromChatWid,_=e.commands,f=e.parseInlineCode,g=f===void 0?!1:f,h=e.parseLists,y=h===void 0?!1:h,C=e.parseQuotes,b=C===void 0?!1:C,v=e.parseHeadings,S=v===void 0?!1:v,R=e.onLinkClick,L=R===void 0?r("WAWebNoop"):R,E=e.terms,k=E===void 0?null:E,I=d&&u!=null&&u.length>0?[[r("WAWebPhoneNumberFormatMutator"),{phoneNumbers:u,selectable:c,fromMe:m}]]:null,T;return(o("WAWebBotGating").isBizBot3pEnabled()||o("WAWebBotGating").isMetaBotCommandsEnabled())&&_&&_.length>0&&(T=[[o("WAWebBotCommandFormatMutator").BotCommand,{commands:_,selectable:c}]]),[[[o("WAWebCodeFormatMutator").Code,{selectable:c}]],g?[[r("WAWebInlineCodeFormatMutator"),{selectable:c}]]:null,y?[[o("WAWebBulletedListItemFormatMutator").BulletedListItem,{selectable:c}]]:null,y?[[o("WAWebBulletedListItemFormatMutator").HyphenListItem,{selectable:c}]]:null,y?[[r("WAWebBulletedListFormatMutator"),{selectable:c}]]:null,y?[[o("WAWebNumberedListItemFormatMutator").NumberedListItem,{selectable:c}]]:null,y?[[r("WAWebNumberedListFormatMutator"),{selectable:c}]]:null,d?[[r("WAWebLinkFormatMutator"),{links:s,selectable:c,onLinkClick:L}]]:null,a?[[r("WAWebMentionFormatMutator"),{mentions:a,selectable:c}]]:null,[[r("WAWebMentionAllFormatMutator"),{hasMentionAll:l,selectable:c}]],S?[[o("WAWebHeadingFormatMutator").Heading,{selectable:c}]]:null,i?[[o("WAWebGroupMentionFormatMutator").GroupMention,{groupMentions:i,selectable:c,fromChatWid:p}]]:null,!r("gkx")("26258")&&n("cr:6000")?n("cr:6000")(c):null,I,[[r("WAWebBoldFormatMutator"),{selectable:c}],[r("WAWebItalicFormatMutator"),{selectable:c}],[r("WAWebStrikethroughFormatMutator"),{selectable:c}]],[[r("WAWebEmojiFormatMutator"),{selectable:c}]],b?[[o("WAWebBlockQuoteFormatMutator").BlockQuote,{selectable:c}]]:null,T,k!=null?[[r("WAWebHighlightFormatMutator"),{terms:k,ignoreDiacritics:!0}]]:null].filter(Boolean)},p=function(t){var e=t.boundary,n=t.terms,a=t.selectable,i=t.mentions,l=t.groupMentions;return[[[r("WAWebTextMentionFormatMutator"),{mentions:i,selectable:a}]],[[o("WAWebGroupMentionFormatMutator").GroupMention,{groupMentions:l,selectable:a,clickable:!1}]],[[r("WAWebBoldFormatMutator"),{selectable:a}],[r("WAWebItalicFormatMutator"),{selectable:a}],[r("WAWebStrikethroughFormatMutator"),{selectable:a}]],[[r("WAWebHighlightFormatMutator"),{terms:n,boundary:e,selectable:a,ignoreDiacritics:!0}]],[[r("WAWebEmojiFormatMutator"),{selectable:a}]]]},_=function(t){var e=t.terms,n=t.emojiXstyle;return[[[r("WAWebHighlightFormatMutator"),{terms:e,ignoreDiacritics:!0}]],[[r("WAWebEmojiFormatMutator"),{emojiXstyle:n,selectable:!1}]]]},f=function(t){t===void 0&&(t={});var e=o("WAWebABProps").getABPropConfigValue("enable_clear_formatted_preview"),n=t,a=n.mentions,i=n.groupMentions,l=n.selectable,s=n.isDraftMessage;return[e?null:[[o("WAWebCodeFormatMutator").Code,{selectable:l}]],a?[[r("WAWebTextMentionFormatMutator"),{mentions:a,selectable:l,lastMessage:!0,isDraftMessage:s}]]:null,i?[[o("WAWebGroupMentionFormatMutator").GroupMention,{groupMentions:i,selectable:l,clickable:!1,lastMessage:!0,isDraftMessage:s}]]:null,e?null:[[r("WAWebBoldFormatMutator"),{selectable:l}],[r("WAWebItalicFormatMutator"),{selectable:l}],[r("WAWebStrikethroughFormatMutator"),{selectable:l}]],[[r("WAWebEmojiFormatMutator"),{selectable:l}]]].filter(Boolean)},g=function(t){var e=t.boundary,n=t.mentions,a=t.groupMentions,i=t.terms,l=t.selectable;return[[[o("WAWebCodeFormatMutator").Code,{selectable:l}]],[[r("WAWebTextMentionFormatMutator"),{mentions:n,selectable:l}]],[[o("WAWebGroupMentionFormatMutator").GroupMention,{groupMentions:a,selectable:l,clickable:!1}]],[[r("WAWebBoldFormatMutator"),{selectable:l}],[r("WAWebItalicFormatMutator"),{selectable:l}],[r("WAWebStrikethroughFormatMutator"),{selectable:l}]],[[r("WAWebHighlightFormatMutator"),{terms:i,boundary:e,selectable:l}]],[[r("WAWebEmojiFormatMutator"),{selectable:l}]]]},h=function(t){var e=t===void 0?{}:t,n=e.selectable;return[[[o("WAWebCodeFormatMutator").Code,{selectable:n}]],[[r("WAWebBoldFormatMutator"),{selectable:n}],[r("WAWebItalicFormatMutator"),{selectable:n}],[r("WAWebStrikethroughFormatMutator"),{selectable:n}]],[[r("WAWebEmojiFormatMutator"),{selectable:n}]]]},y=function(t){var e=t.mentions,n=t.groupMentions,a=t.selectable;return[[[o("WAWebCodeFormatMutator").Code,{selectable:a}]],[[r("WAWebInlineCodeFormatMutator"),{selectable:a}]],[[r("WAWebTextMentionFormatMutator"),{mentions:e,selectable:a}]],[[o("WAWebGroupMentionFormatMutator").GroupMention,{groupMentions:n,selectable:a,clickable:!1}]],[[r("WAWebBoldFormatMutator"),{selectable:a}],[r("WAWebItalicFormatMutator"),{selectable:a}],[r("WAWebStrikethroughFormatMutator"),{selectable:a}]],[[r("WAWebEmojiFormatMutator"),{selectable:a}]],[[o("WAWebBlockQuoteFormatMutator").BlockQuote,{selectable:a}]]].filter(Boolean)},C=function(t){var e=t.mentions,n=t.groupMentions,a=t.selectable;return[[[o("WAWebCodeFormatMutator").Code,{selectable:a}]],[[r("WAWebInlineCodeFormatMutator"),{selectable:a,quoted:!0}]],[[o("WAWebBulletedListItemFormatMutator").BulletedListItem,{selectable:a}]],[[o("WAWebBulletedListItemFormatMutator").HyphenListItem,{selectable:a}]],[[r("WAWebBulletedListFormatMutator"),{selectable:a,quoted:!0}]],[[o("WAWebNumberedListItemFormatMutator").NumberedListItem,{selectable:a}]],[[r("WAWebNumberedListFormatMutator"),{selectable:a,quoted:!0}]],[[r("WAWebTextMentionFormatMutator"),{mentions:e,selectable:a,theme:{quoted:!0}}]],[[o("WAWebGroupMentionFormatMutator").GroupMention,{groupMentions:n,selectable:a,theme:{quoted:!0},clickable:!1}]],[[r("WAWebBoldFormatMutator"),{selectable:a}],[r("WAWebItalicFormatMutator"),{selectable:a}],[r("WAWebStrikethroughFormatMutator"),{selectable:a}]],[[r("WAWebEmojiFormatMutator"),{selectable:a}]],[[o("WAWebBlockQuoteFormatMutator").BlockQuote,{selectable:a,quoted:!0}]]].filter(Boolean)},b=function(t){var e=t.mentions,n=t.groupMentions,a=t.selectable;return[[[o("WAWebCodeFormatMutator").Code,{selectable:a}]],[[r("WAWebRawMentionMutator"),{mentions:e,selectable:a}]],[[o("WAWebRawGroupMentionFormatMutator").RawGroupMention,{groupMentions:n}]],[[r("WAWebBoldFormatMutator"),{selectable:a}],[r("WAWebItalicFormatMutator"),{selectable:a}],[r("WAWebStrikethroughFormatMutator"),{selectable:a}]]].filter(Boolean)},v=function(t){var e=t.mentions,n=t.groupMentions,a=t.selectable,i=t.groupMetadata;return[[[o("WAWebCodeFormatMutator").Code,{selectable:a}]],[[r("WAWebInlineCodeFormatMutator"),{selectable:a}]],[[r("WAWebRawShortNameMentionFormatMutator"),{mentions:e,selectable:a,groupMetadata:i}]],[[o("WAWebRawGroupMentionFormatMutator").RawGroupMention,{groupMentions:n}]],[[r("WAWebBoldFormatMutator"),{selectable:a}],[r("WAWebItalicFormatMutator"),{selectable:a}],[r("WAWebStrikethroughFormatMutator"),{selectable:a}]],[[o("WAWebBlockQuoteFormatMutator").BlockQuote,{selectable:a}]]].filter(Boolean)},S=function(t){var e,a=t.links,i=!!t.expandedFormattingEnabled,l=!!((e=t.bulletPointsEnabled)!=null?e:i),s=!0;return[[[o("WAWebCodeFormatMutator").Code,{selectable:s}]],i?[[r("WAWebInlineCodeFormatMutator"),{selectable:s}]]:null,l?[[o("WAWebBulletedListItemFormatMutator").BulletedListItem,{selectable:s}]]:null,l?[[o("WAWebBulletedListItemFormatMutator").HyphenListItem,{selectable:s}]]:null,l?[[r("WAWebBulletedListFormatMutator"),{selectable:s}]]:null,i?[[o("WAWebNumberedListItemFormatMutator").NumberedListItem,{selectable:s}]]:null,i?[[r("WAWebNumberedListFormatMutator"),{selectable:s}]]:null,[[r("WAWebLinkFormatMutator"),{links:a,selectable:s}]],[[r("WAWebBoldFormatMutator"),{selectable:s}],[r("WAWebItalicFormatMutator"),{selectable:s}],[r("WAWebStrikethroughFormatMutator"),{selectable:s}]],!r("gkx")("26258")&&n("cr:6000")?n("cr:6000")(s):null,[[r("WAWebEmojiFormatMutator"),{selectable:s}]],i?[[o("WAWebBlockQuoteFormatMutator").BlockQuote,{selectable:s}]]:null].filter(Boolean)},R=function(t){var e,a=!!(t!=null&&t.expandedFormattingEnabled),i=!!((e=t==null?void 0:t.bulletPointsEnabled)!=null?e:a),l=!0;return[[[o("WAWebCodeFormatMutator").Code,{selectable:l}]],a?[[r("WAWebInlineCodeFormatMutator"),{selectable:l}]]:null,i?[[o("WAWebBulletedListItemFormatMutator").BulletedListItem,{selectable:l}]]:null,i?[[o("WAWebBulletedListItemFormatMutator").HyphenListItem,{selectable:l}]]:null,i?[[r("WAWebBulletedListFormatMutator"),{selectable:l}]]:null,a?[[o("WAWebNumberedListItemFormatMutator").NumberedListItem,{selectable:l}]]:null,a?[[r("WAWebNumberedListFormatMutator"),{selectable:l}]]:null,[[r("WAWebBoldFormatMutator"),{selectable:l}],[r("WAWebItalicFormatMutator"),{selectable:l}],[r("WAWebStrikethroughFormatMutator"),{selectable:l}]],!r("gkx")("26258")&&n("cr:6000")?n("cr:6000")(l):null,[[r("WAWebEmojiFormatMutator"),{selectable:l}]],a?[[o("WAWebBlockQuoteFormatMutator").BlockQuote,{selectable:l}]]:null].filter(Boolean)},L=function(t){var e=t===void 0?{}:t,n=e.links,o=e.selectable,a=e.trusted;return[a===!0?[[r("WAWebLinkFormatMutator"),{links:n,selectable:o}]]:null,[[r("WAWebEmojiFormatMutator"),{selectable:o}]]].filter(Boolean)},E=function(t){t===void 0&&(t={});var e=t,n=e.mentions,a=e.groupMentions,i=e.selectable,l=e.isDraftMessage;return[[[o("WAWebCodeFormatMutator").Code,{selectable:i}]],[[r("WAWebInlineCodeFormatMutator"),{selectable:i}]],[[o("WAWebBulletedListItemFormatMutator").BulletedListItem,{selectable:i,inline:!0}]],[[o("WAWebBulletedListItemFormatMutator").HyphenListItem,{selectable:i,inline:!0}]],[[r("WAWebBulletedListFormatMutator"),{selectable:i,inline:!0}]],[[o("WAWebNumberedListItemFormatMutator").NumberedListItem,{selectable:i,inline:!0}]],[[r("WAWebNumberedListFormatMutator"),{selectable:i,inline:!0}]],n?[[r("WAWebTextMentionFormatMutator"),{mentions:n,selectable:i,lastMessage:!0,isDraftMessage:l}]]:null,a?[[o("WAWebGroupMentionFormatMutator").GroupMention,{groupMentions:a,selectable:i,clickable:!1,lastMessage:!0,isDraftMessage:l}]]:null,[[r("WAWebBoldFormatMutator"),{selectable:i}],[r("WAWebItalicFormatMutator"),{selectable:i}],[r("WAWebStrikethroughFormatMutator"),{selectable:i}]],[[r("WAWebEmojiFormatMutator"),{selectable:i}]],[[o("WAWebBlockQuoteFormatMutator").BlockQuote,{selectable:i,inline:!0}]]].filter(Boolean)},k=function(t){var e=t.selectable,n=t.parseHeadings,a=n===void 0?!0:n,i=t.parseHeadlessHeadings,l=i===void 0?!1:i,s=t.parseLists,u=s===void 0?!0:s,c=t.parseQuotes,d=c===void 0?!0:c,m=t.parseInlineCode,p=m===void 0?!0:m,_=t.showLinks,f=_===void 0?!0:_,g=t.links,h=t.onLinkClick,y=h===void 0?r("WAWebNoop"):h;return[[[o("WAWebCodeFormatMutator").Code,{selectable:e}]],p?[[r("WAWebInlineCodeFormatMutator"),{selectable:e}]]:null,[[r("WAWebBoldFormatMutator"),{selectable:e}],[r("WAWebItalicFormatMutator"),{selectable:e}],[r("WAWebStrikethroughFormatMutator"),{selectable:e}]],[[r("WAWebEmojiFormatMutator"),{selectable:e}]],d?[[o("WAWebBlockQuoteFormatMutator").BlockQuote,{selectable:e}]]:null,u?[[o("WAWebBulletedListItemFormatMutator").BulletedListItem,{selectable:e}]]:null,u?[[o("WAWebBulletedListItemFormatMutator").HyphenListItem,{selectable:e}]]:null,u?[[r("WAWebBulletedListFormatMutator"),{selectable:e}]]:null,u?[[o("WAWebNumberedListItemFormatMutator").NumberedListItem,{selectable:e}]]:null,u?[[r("WAWebNumberedListFormatMutator"),{selectable:e}]]:null,f?[[r("WAWebLinkFormatMutator"),{links:g,selectable:e,onLinkClick:y}]]:null,a?[[o("WAWebHeadingFormatMutator").AIRichResponseHeading,{selectable:e}]]:null,l?[[o("WAWebHeadingFormatMutator").HeadlessHeading,{selectable:e}]]:null].filter(Boolean)};l.EmojiOnly=e,l.LargeEmojiOnly=s,l.StatusText=u,l.StatusCaption=c,l.Compatibility=d,l.Conversation=m,l.Search=p,l.SearchName=_,l.LastMessage=f,l.FTSMessage=g,l.QuickReply=h,l.Unformat=y,l.QuotedMention=C,l.FormattedNotification=b,l.FormattedGroupNotification=v,l.TrustedGroupDesc=S,l.UntrustedGroupDesc=R,l.HeaderAndFooter=L,l.InlineMessage=E,l.RichResponse=k}),98);
__d("WAWebFormatRevokedMsg",["fbt","WAWebContactCollection","WAWebFrontendContactGetters","WAWebMsgGetters","WAWebWidFormat"],(function(t,n,r,o,a,i,l,s){var e=function(t){var e=o("WAWebContactCollection").ContactCollection.get(t);return e?e.shortName||e.name||o("WAWebFrontendContactGetters").getDisplayName(e):o("WAWebWidFormat").widToFormattedUser(t)};function u(t){return o("WAWebMsgGetters").getIsRevokedByMe(t)?s._(/*BTDS*/"Eliminaste este mensaje como admin."):t.revokeSender==null?s._(/*BTDS*/"Un admin. elimin\u00f3 este mensaje"):s._(/*BTDS*/"Un admin., {admin}, elimin\u00f3 este mensaje.",[s._param("admin",e(t.revokeSender))])}function c(e){return o("WAWebMsgGetters").getIsSentByMe(e)?s._(/*BTDS*/"Eliminaste este mensaje."):s._(/*BTDS*/"Se elimin\u00f3 este mensaje.")}function d(e){var t,n=(t=e.subtype)!=null?t:"sender";switch(n){case"sender":return c(e);case"admin":return u(e)}}function m(e){var t,n=(t=e.subtype)!=null?t:"sender";switch(n){case"sender":return c(e);case"admin":return o("WAWebMsgGetters").getIsNewsletterMsg(e)?p(e):u(e)}}function p(e){return o("WAWebMsgGetters").getIsRevokedByMe(e)?s._(/*BTDS*/"Eliminaste esta actualizaci\u00f3n."):s._(/*BTDS*/"Se elimin\u00f3 esta actualizaci\u00f3n.")}l.formatRevokedComment=d,l.formatRevokedMsg=m}),226);
__d("WAWebGroupMentionFormatMutator",["WAWebExtractRangesUsingRegex","WAWebFormatMutator","WAWebGroupMetadataCollection","WAWebRichTextInputConst","WAWebTextGroupMentionWrapperMutatorComponent.react","WAWebUnjoinedSubgroupMetadataCollection","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.match=function(t,n){if(!n)return[];var e=n.groupMentions,a=n.isDraftMessage,i=n.fromChatWid;if(this.fromChatWid=i,a===!0){for(var l=r("WAWebExtractRangesUsingRegex")(t,new RegExp(o("WAWebRichTextInputConst").groupJidRegexStr,"g")),s=0;s<l.length;++s){var u=l[s][4][1],c=r("WAWebUnjoinedSubgroupMetadataCollection").get(u)||r("WAWebGroupMetadataCollection").get(u);if(!c||!c.subject)return[];l[s][4]={groupJid:u.slice(1),groupSubject:c.subject,fromChatWid:i}}return l}if(!e||Object.keys(e).length===0)return[];for(var m=d(e),p=r("WAWebExtractRangesUsingRegex")(t,m),_=0;_<p.length;++_){var f=p[_][4][0];p[_][4]={groupJid:f.slice(1),groupSubject:e[f],fromChatWid:i}}return p},t.jsx=function(t,n,o){var e=o.selectable,a=o.theme,i=o.clickable,l=i===void 0?!0:i,u=o.lastMessage;return s.jsx(r("WAWebTextGroupMentionWrapperMutatorComponent.react"),{groupSubject:n.groupSubject,groupJid:n.groupJid,selectable:e,clickable:l,theme:a,lastMessage:u,fromChatWid:this.fromChatWid})},t})(r("WAWebFormatMutator"));u.compatibility=!0;function c(e){var t=/[\\^$.*+?()[\]{}|]/g,n=RegExp(t.source);return e&&n.test(e)?e.replace(t,"\\$&"):e}function d(e){var t=Object.keys(e).map(c).join("|");return new RegExp("("+t+")","g")}l.GroupMention=u}),98);
__d("WAWebInternFormatRegex",[],(function(t,n,r,o,a,i){var e=/(^|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))(([DPST\u017F][0-9]{6,16})|(L[0-9]{6,16}[A-Z\u017F\u212A]{0,5})|(r[A-Z\u017F\u212A]{2,32}[0-9A-F]{8,40}))(?=$|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))/gi,l=e;i.default=l}),66);
__d("WAWebInternMutatorComponent.react",["WAWebLinkMutatorComponent.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){return s.jsx(r("WAWebLinkMutatorComponent.react"),babelHelpers.extends({},e,{children:e.children}))}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("WAWebInternFormatMutator",["WAWebCreateRegexMutator","WAWebInternFormatRegex","WAWebInternMutatorComponent.react","WAWebLinkFormatMutator","WAWebMentionFormatMutator","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=r("WAWebCreateRegexMutator")(r("WAWebInternFormatRegex"),2,d),c=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n,o){var e=o.selectable,a=e===void 0?!1:e,i=p(n);return s.jsx(r("WAWebInternMutatorComponent.react"),{href:i,selectable:a,children:t})},t})(u);c.format=!1,c.compatibility=!0,c.nestable=function(e){return e!==r("WAWebLinkFormatMutator")&&e!==r("WAWebMentionFormatMutator")};function d(e,t){var n=e[1];return n&&(e.index+=n.length,e[0]=e[0].slice(n.length)),e}var m="https://www.internalfb.com/intern/bunny/?q=";function p(e){var t,n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],l=e[5];return""+m+((t=a!=null?a:i)!=null?t:l)}l.default=c}),98);
__d("WAWebMentionFormatMutator",["WAWebContactCollection","WAWebExtractRangesUsingRegex","WAWebFormatMutator","WAWebMentionMutatorComponent.react","WAWebRichTextInputConst","WAWebWidFactory","escapeRegex","isEmptyObject","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.match=function(t,n){if(!n)return[];var e=n.mentions,a=n.groupMetadata,i=n.isDraftMessage;if(i===!0){for(var l=r("WAWebExtractRangesUsingRegex")(t,new RegExp(o("WAWebRichTextInputConst").userJidRegexStr,"g")),s=0;s<l.length;++s){var u=l[s][4][1],d=o("WAWebWidFactory").createUserWidOrThrow(u),m=o("WAWebContactCollection").ContactCollection.get(d);if(m==null)return[];l[s][4]={contact:m,groupMetadata:a}}return l}if(!e||r("isEmptyObject")(e))return[];for(var p=c(e),_=r("WAWebExtractRangesUsingRegex")(t,p),f=0;f<_.length;++f)_[f][4]={contact:e[_[f][4][0]],groupMetadata:a};return _},t.jsx=function(t,n,o){var e=o.selectable,a=o.lastMessage;return s.jsx(r("WAWebMentionMutatorComponent.react"),{mentionMeta:n,selectable:e,lastMessage:a})},t})(r("WAWebFormatMutator"));u.compatibility=!0;function c(e){var t=Object.keys(e).map(r("escapeRegex")).join("|");return new RegExp("("+t+")","g")}l.default=u}),98);
__d("WAWebPhoneNumberFormatMutator",["WAWebFormatMutator","WAWebInternFormatMutator","WAWebLinkFormatMutator","WAWebMentionFormatMutator","WAWebPhoneNumberMutatorComponent.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n,o){var e=o.selectable,a=e===void 0?!1:e,i=o.fromMe,l=n.phone;return s.jsx(r("WAWebPhoneNumberMutatorComponent.react"),{phoneNumber:l,selectable:a,fromMe:i})},t})(r("WAWebFormatMutator"));u.format=!1,u.compatibility=!0,u.nestable=function(e){return e!==r("WAWebLinkFormatMutator")&&e!==r("WAWebInternFormatMutator")&&e!==r("WAWebMentionFormatMutator")},u.match=function(e,t,n){if(!t)return[];var r=t.phoneNumbers,o=r===void 0?[]:r;return o.map(c)};function c(e){var t=e.index,n=e.phone,r=t+n.length-1;return[t,t,r,r,e]}l.default=u}),98);
__d("WAWebRawGroupMentionFormatMutator",["WAWebGroupMentionFormatMutator"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebGroupMentionFormatMutator").GroupMention);e.mutates=!0,e.mutate=function(e,t){var n=t.groupSubject;return"@"+n},l.RawGroupMention=e}),98);
__d("WAWebRawMentionMutator",["WAWebABProps","WAWebChatContactUtils","WAWebContactGetters","WAWebElevatedPushNamesFlag","WAWebFrontendContactGetters","WAWebMentionFormatMutator"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(r("WAWebMentionFormatMutator"));e.mutates=!0,e.mutate=function(e,t){var n=t.contact,r=o("WAWebElevatedPushNamesFlag").pushNameCanBeUsed(n)&&o("WAWebABProps").getABPropConfigValue("elevated_push_names_v2_m2_enabled")?o("WAWebChatContactUtils").getFormattedNotifyName(o("WAWebContactGetters").getNotifyName(n),!1).toString():o("WAWebFrontendContactGetters").getDisplayName(n);return"@"+r},l.default=e}),98);
__d("WAWebRawShortNameMentionFormatMutator",["WAWebFrontendContactGetters","WAWebMentionFormatMutator","WAWebMiscGatingUtils"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(r("WAWebMentionFormatMutator"));e.mutates=!0,e.mutate=function(e,t){var n=t.contact,r=t.groupMetadata;return o("WAWebMiscGatingUtils").isDropLastNameEnabled()&&r&&r.hasUniqueShortNameMention(n)?"@"+n.shortName:"@"+o("WAWebFrontendContactGetters").getDisplayName(n)},l.default=e}),98);
__d("WAWebTextMentionFormatMutator",["WAWebMentionFormatMutator","WAWebTextMentionMutatorComponent.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react")),u=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.jsx=function(t,n,o){var e=n.contact,a=o.selectable,i=o.theme,l=o.lastMessage;return s.jsx(r("WAWebTextMentionMutatorComponent.react"),{contact:e,selectable:a,theme:i,lastMessage:l})},t})(r("WAWebMentionFormatMutator"));l.default=u}),98);
__d("WAWebChatTextMentionMutatorComponent.react",["WAWebABProps","WAWebChatContactUtils","WAWebContactGetters","WAWebElevatedPushNamesFlag","WAWebFrontendContactGetters","WAWebMentionMutatorComponentBase.react","react","useWAWebContactValues"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){var t=e.contact,n=e.onClick,a=e.theme,i=e.selectable,l=e.lastMessage,u=o("useWAWebContactValues").useContactValues(e.contact.id,[o("WAWebContactGetters").getId,o("WAWebFrontendContactGetters").getDisplayName,o("WAWebContactGetters").getNotifyName]),c=u[0],d=u[1],m=u[2],p,_;return o("WAWebElevatedPushNamesFlag").pushNameCanBeUsed(t)&&o("WAWebABProps").getABPropConfigValue("elevated_push_names_v2_m2_enabled")?(p=o("WAWebChatContactUtils").getFormattedNotifyName(m,!1).toString(),_=o("WAWebChatContactUtils").getAccessibleNotifyName(m).toString()):p=d,s.jsx(r("WAWebMentionMutatorComponentBase.react"),{text:p,jid:c.toString(),onClick:n,theme:a,selectable:i,ariaLabel:_,lastMessage:l})}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("WAWebMentionMutatorComponent.react",["WAWebTextMentionWrapperMutatorComponent.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){var t=e.mentionMeta,n=e.theme,o=e.selectable,a=e.lastMessage;return s.jsx(r("WAWebTextMentionWrapperMutatorComponent.react"),{contact:t.contact,theme:n,selectable:o,lastMessage:a})}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("WAWebPhoneNumberMutatorComponent.react",["WAWebPhoneNumberWrapperMutatorComponent.react","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){var t=e.phoneNumber,n=e.selectable,o=e.fromMe;return s.jsx(r("WAWebPhoneNumberWrapperMutatorComponent.react"),{selectable:n,phoneNumber:t,fromMe:o})}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("WAWebChatRefreshedIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="chat-refreshed";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=24,R=24;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 24 24",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.00013 9L0.940133 5.53C0.540219 4.86348 1.01283 4 1.79012 4H19.3335C20.8062 4 22.0001 5.19391 22.0001 6.66667V17.3333C22.0001 18.8061 20.8062 20 19.3335 20H5.6668C4.19404 20 3.00013 18.8061 3.00013 17.3333V9ZM5.00013 8.44603L3.53252 6H19.3335C19.7017 6 20.0001 6.29848 20.0001 6.66667V17.3333C20.0001 17.7015 19.7017 18 19.3335 18H5.6668C5.29861 18 5.00013 17.7015 5.00013 17.3333V8.44603Z",fill:"currentColor"}),c.jsx("path",{d:"M7.00013 10C7.00013 9.44772 7.44785 9 8.00013 9H17.0001C17.5524 9 18.0001 9.44772 18.0001 10C18.0001 10.5523 17.5524 11 17.0001 11H8.00013C7.44785 11 7.00013 10.5523 7.00013 10Z",fill:"currentColor"}),c.jsx("path",{d:"M7.00013 14C7.00013 13.4477 7.44785 13 8.00013 13H14.0001C14.5524 13 15.0001 13.4477 15.0001 14C15.0001 14.5523 14.5524 15 14.0001 15H8.00013C7.44785 15 7.00013 14.5523 7.00013 14Z",fill:"currentColor"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.ChatRefreshedIcon=m}),98);
__d("WAWebCopyRefreshedIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="copy-refreshed";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=24,R=24;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 24 24",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{d:"M9 18C8.45 18 7.97917 17.8042 7.5875 17.4125C7.19583 17.0208 7 16.55 7 16V4C7 3.45 7.19583 2.97917 7.5875 2.5875C7.97917 2.19583 8.45 2 9 2H18C18.55 2 19.0208 2.19583 19.4125 2.5875C19.8042 2.97917 20 3.45 20 4V16C20 16.55 19.8042 17.0208 19.4125 17.4125C19.0208 17.8042 18.55 18 18 18H9ZM9 16H18V4H9V16ZM5 22C4.45 22 3.97917 21.8042 3.5875 21.4125C3.19583 21.0208 3 20.55 3 20V7C3 6.71667 3.09583 6.47917 3.2875 6.2875C3.47917 6.09583 3.71667 6 4 6C4.28333 6 4.52083 6.09583 4.7125 6.2875C4.90417 6.47917 5 6.71667 5 7V20H15C15.2833 20 15.5208 20.0958 15.7125 20.2875C15.9042 20.4792 16 20.7167 16 21C16 21.2833 15.9042 21.5208 15.7125 21.7125C15.5208 21.9042 15.2833 22 15 22H5Z",fill:"currentColor"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.CopyRefreshedIcon=m}),98);
__d("WAWebPhoneNumberWrapperMutatorComponent.react",["fbt","WALogger","WAPhoneUtils","WAWebChatRefreshedIcon.react","WAWebCopyPasteSelectable.react","WAWebCopyRefreshedIcon.react","WAWebDropdownItem.react","WAWebFlex.react","WAWebGetOrQueryUsyncInfoContactAction","WAWebPhoneNumberContactAction","WAWebSpinner.react","WAWebText.react","WAWebUimUie.react","WAWebUimUieMenu.react","asyncToGeneratorRuntime","react"],(function(t,n,r,o,a,i,l,s){var e,u,c,d=c||(c=r("react")),m=(u||(u=o("react"))).useState,p={spinnerContainer:{width:"xc5o50y",height:"x6hvgyk",$$css:!0},spinnerText:{marginTop:"xcxhlts",paddingInlineStart:"x1gx403c",paddingInlineEnd:"x1q3ajuy",textAlign:"x2b8uid",$$css:!0},menuItem:{paddingInlineStart:"x1iw51ew",paddingInlineEnd:"xde1mab",$$css:!0},textualLinkRefreshed:{color:"xo1mcw5",fontWeight:"x1xlr1w8",textDecoration:"x1hl2dhg",":hover_textDecoration":"xt0b8zv",":focus-visible_textDecoration":"xbvygy2",":focus-visible_color":"x17f7hit",":focus-visible_backgroundColor":"xp30eni",":focus-visible_textUnderlineOffset":"xhmieyt",$$css:!0}};function _(t){var a=t.fromMe,i=t.phoneNumber,l=t.selectable,u=m(null),c=u[0],_=u[1],f=m(null),g=f[0],h=f[1],y=m(null),C=y[0],b=y[1],v=m(null),S=v[0],R=v[1];function L(t){var r;C&&C.isCached(i)?r=C:(r=o("WAWebGetOrQueryUsyncInfoContactAction").usyncContactCached(),b(r));function a(e,t){return l.apply(this,arguments)}function l(){return l=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){try{var a=yield r.getOrRun(t);k(a,n)}catch(t){k(null,n),R(null),o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["handlePhoneClick getUsync failed with exceptions ",""])),t).sendLogs("handlePhoneClick-getUsync")}}),l.apply(this,arguments)}r.isCached(i)||E(t),a(i,t)}function E(e){var t=d.jsxs(o("WAWebFlex.react").FlexColumn,{xstyle:p.spinnerContainer,align:"center",justify:"center",children:[d.jsx(o("WAWebSpinner.react").Spinner,{size:50,stroke:4,color:"highlight"}),d.jsx(o("WAWebText.react").WAWebTextSmall,{as:"span",xstyle:p.spinnerText,children:s._(/*BTDS*/"Verificando el n\u00famero de tel\u00e9fono\u2026")},"phone_number_wrapper_loading_text")]});h({menu:t,event:e}),_(null)}function k(e,t){var n=[];if(e!=null&&e.wid){var r=o("WAPhoneUtils").formatPhone(e.wid.user);n.push(d.jsx(o("WAWebDropdownItem.react").DropdownItem,{testid:void 0,xstyle:p.menuItem,action:function(n){return o("WAWebPhoneNumberContactAction").handleOpenChat(n,e.wid,a)},icon:d.jsx(o("WAWebChatRefreshedIcon.react").ChatRefreshedIcon,{}),children:s._(/*BTDS*/"Chatear con {chat-with-phoneNumber}",[s._param("chat-with-phoneNumber",d.jsx("span",{dir:"ltr",children:r}))])},"message-on-whatsapp"))}n.push(d.jsx(o("WAWebDropdownItem.react").DropdownItem,{testid:void 0,xstyle:p.menuItem,action:function(){return o("WAWebPhoneNumberContactAction").handleCopyPhoneNumber(i,e==null?void 0:e.wid,a)},icon:d.jsx(o("WAWebCopyRefreshedIcon.react").CopyRefreshedIcon,{}),children:s._(/*BTDS*/"Copiar n\u00famero de tel\u00e9fono")},"copy-phone-number")),h(null),_({menu:n,event:t}),R(e==null?void 0:e.wid),o("WAWebPhoneNumberContactAction").logClickOnPhoneNumber(e==null?void 0:e.wid,a)}var I=null,T=null;return c&&(I=d.jsx(o("WAWebUimUie.react").UIE,{displayName:"ContextMenu",escapable:!0,popable:!0,dismissOnWindowResize:!0,requestDismiss:function(){_(null),o("WAWebPhoneNumberContactAction").logCloseDialog(S,a)},children:d.jsx(r("WAWebUimUieMenu.react"),{contextMenu:c})})),g&&(T=d.jsx(o("WAWebUimUie.react").UIE,{displayName:"ContextSpinner",escapable:!0,popable:!0,dismissOnWindowResize:!0,requestDismiss:function(){h(null)},children:d.jsx(r("WAWebUimUieMenu.react"),{contextMenu:g})})),d.jsxs(d.Fragment,{children:[d.jsx(o("WAWebCopyPasteSelectable.react").SelectableLink,{onClick:L,selectable:l,xstyle:p.textualLinkRefreshed,style:{cursor:"pointer"},children:i}),I,T]})}_.displayName=_.name+" [from "+i.id+"]",l.default=_}),226);
__d("WAWebShortNameTextMentionMutatorComponent.react",["WAWebContactGetters","WAWebFrontendContactGetters","WAWebMentionMutatorComponentBase.react","WAWebMiscGatingUtils","react","useWAWebContactValues","useWAWebModelValues"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){var t=e.contact,n=e.onClick,a=e.theme,i=e.selectable,l=e.lastMessage,u=o("useWAWebContactValues").useContactValues(e.contact.id,[o("WAWebContactGetters").getId,o("WAWebFrontendContactGetters").getDisplayName,o("WAWebContactGetters").getShortName,o("WAWebFrontendContactGetters").getIsMyContact]),c=u[0],d=u[1],m=u[2],p=u[3],_=o("useWAWebModelValues").useModelValues(e.groupMetadata,["uniqueShortNameMap"]),f=function(){return o("WAWebMiscGatingUtils").isDropLastNameEnabled()&&_&&_.hasUniqueShortNameMention(t)?m:d},g=f();return s.jsx(r("WAWebMentionMutatorComponentBase.react"),{text:g,jid:c.toString(),theme:a,selectable:i,onClick:n,lastMessage:l})}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("WAWebGroupMetadataContext",["react"],(function(t,n,r,o,a,i,l){var e,s=(e||(e=o("react"))).createContext,u=s(null);l.default=u}),98);
__d("WAWebTextGroupMentionWrapperMutatorComponent.react",["WALogger","WAWebChatCollection","WAWebChatEntryPoint","WAWebCmd","WAWebCommunityGroupJourneyEventImpl","WAWebFindChatAction","WAWebGroupMetadataCollection","WAWebGroupMetadataContext","WAWebMentionMutatorComponentBase.react","WAWebUnjoinedSubgroupMetadataCollection","WAWebWamEnumChatFilterActionTypes","WAWebWamEnumSurfaceType","react"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=c||(c=r("react")),m=(u||(u=o("react"))).useContext;function p(t){var n,a,i,l=m(r("WAWebGroupMetadataContext")),u=function(){var n=t.fromChatWid;n&&new(o("WAWebCommunityGroupJourneyEventImpl")).CommunityGroupJourneyEvent({action:o("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES.SUBGROUP_MENTION_CLICK,surface:o("WAWebWamEnumSurfaceType").SURFACE_TYPE.CHAT,chat:o("WAWebChatCollection").ChatCollection.get(n)}).commit();var a=r("WAWebUnjoinedSubgroupMetadataCollection").get(t.groupJid);if(a){o("WAWebCmd").Cmd.openCommunitySubgroupJoinModal(a,"group_mention");return}var i=r("WAWebGroupMetadataCollection").get(t.groupJid);i?o("WAWebFindChatAction").findOrCreateLatestChat(i.id,"groupMentionWrapper").then(function(e){var n=e.chat;o("WAWebCmd").Cmd.openChatBottom({chat:n,chatEntryPoint:o("WAWebChatEntryPoint").ChatEntryPoint.Mention}).then(function(e){e&&new(o("WAWebCommunityGroupJourneyEventImpl")).CommunityGroupJourneyEvent({action:o("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES.GROUP_NAVIGATION,surface:o("WAWebWamEnumSurfaceType").SURFACE_TYPE.CHAT,chat:o("WAWebChatCollection").ChatCollection.get(t.groupJid)}).commit()})}).catch(function(t){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to find chat from group mention even though we have gmd for it"]))).devConsole(t)}):o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["No local model found for given group mention JID"]))).devConsole(t.groupJid)},c=(n=(a=t.theme)==null?void 0:a.quoted)!=null?n:!1,p=r("WAWebGroupMetadataCollection").get((i=l==null?void 0:l.parentGroup)!=null?i:""),_=p!=null?p.joinedSubgroups.some(function(e){return e.toString()===t.groupJid})||p.unjoinedSubgroups.some(function(e){return e.toString()===t.groupJid}):!1,f=t.clickable===!0&&_===!0&&c===!1,g=f?u:void 0;return d.jsx(r("WAWebMentionMutatorComponentBase.react"),{text:t.groupSubject,jid:t.groupJid,theme:t.theme,selectable:t.selectable,lastMessage:t.lastMessage,onClick:g})}p.displayName=p.name+" [from "+i.id+"]",l.default=p}),98);
__d("WAWebTextMentionMutatorComponent.react",["WAWebChatTextMentionMutatorComponent.react","WAWebClickable.react","WAWebDisplayType","WAWebGroupMetadataContext","WAWebMiscGatingUtils","WAWebShortNameTextMentionMutatorComponent.react","WAWebWrapperDisplayTypeContext","react"],(function(t,n,r,o,a,i,l){var e,s,u=s||(s=r("react")),c=(e||(e=o("react"))).useContext;function d(e){var t=c(r("WAWebGroupMetadataContext")),n=c(r("WAWebWrapperDisplayTypeContext")),a=u.jsx(r("WAWebChatTextMentionMutatorComponent.react"),babelHelpers.extends({},e));return o("WAWebMiscGatingUtils").isDropLastNameEnabled()&&t&&(a=u.jsx(r("WAWebShortNameTextMentionMutatorComponent.react"),babelHelpers.extends({},e,{groupMetadata:t}))),o("WAWebMiscGatingUtils").messageListA11yRedesignEnabled()&&n===o("WAWebDisplayType").DISPLAY_TYPE.CONVERSATION?u.jsx(o("WAWebClickable.react").Clickable,{as:"span",onClick:e.onClick,children:a}):n===o("WAWebDisplayType").DISPLAY_TYPE.EDITING?u.jsx("span",{className:"x1ph7ams",children:a}):a}d.displayName=d.name+" [from "+i.id+"]",l.default=d}),98);
__d("WAWebTextMentionWrapperMutatorComponent.react",["fbt","WAWebBotProfileCollection","WAWebChatCollection","WAWebChatEntryPoint","WAWebChatGroupUtils","WAWebCmd","WAWebConfirmPopup.react","WAWebDisplayType","WAWebFindChatAction","WAWebModalManager","WAWebSimpleSignalPNToFBIDMigration","WAWebTextMentionMutatorComponent.react","WAWebWrapperDisplayTypeContext","react"],(function(t,n,r,o,a,i,l,s){var e,u,c=u||(u=r("react")),d=(e||(e=o("react"))).useContext;function m(e){var t=e.contact,n=e.lastMessage,a=e.selectable,i=e.theme,l=d(r("WAWebWrapperDisplayTypeContext")),u=function(){var e,n,r=(e=o("WAWebSimpleSignalPNToFBIDMigration").getDeprecatedPnChatForFbidInvoke(t.id))!=null?e:t.id,a=(n=o("WAWebBotProfileCollection").BotProfileCollection.getDefaultBot())==null?void 0:n.id;if(r.isBot()&&!r.equals(a)&&!o("WAWebChatCollection").ChatCollection.get(r)){o("WAWebModalManager").ModalManager.open(c.jsx(o("WAWebConfirmPopup.react").ConfirmPopup,{onOK:function(){o("WAWebModalManager").ModalManager.close()},children:s._(/*BTDS*/"En este momento, no se admite iniciar un nuevo chat con un bot en WhatsApp Web.")}));return}var i=o("WAWebChatGroupUtils").getOneToOneContactFromGroupContact(r,"text_mention");i!=null&&o("WAWebFindChatAction").findOrCreateLatestChat(i,"textMentionWrapper").then(function(e){var t=e.chat;return o("WAWebCmd").Cmd.openChatBottom({chat:t,chatEntryPoint:o("WAWebChatEntryPoint").ChatEntryPoint.Mention})})},m;return l!==o("WAWebDisplayType").DISPLAY_TYPE.EDITING&&(m=u),c.jsx(r("WAWebTextMentionMutatorComponent.react"),{contact:t,theme:i,selectable:a,onClick:m,lastMessage:n})}m.displayName=m.name+" [from "+i.id+"]",l.default=m}),226);
__d("WAWebSystemMessageGatingUtils",["WAWebABProps"],(function(t,n,r,o,a,i,l){function e(){return!!o("WAWebABProps").getABPropConfigValue("system_msg_text_styling")}function s(){return!!o("WAWebABProps").getABPropConfigValue("system_msg_truncation")}l.systemMessageActionTextStylingEnabled=e,l.systemMessageTextTruncationEnabled=s}),98);
__d("WAWebFormatAddNotification",["fbt","WAWebSystemMessageGatingUtils","WAWebSystemMessagesUtils"],(function(t,n,r,o,a,i,l,s){function e(e){var t=e.author,n=e.authorClickable,r=e.subject,a=e.subjectClickable,i=e.participantsClickable,l=e.participantsCount,u=o("WAWebSystemMessageGatingUtils").systemMessageTextTruncationEnabled();return t?o("WAWebSystemMessagesUtils").isMe(t)?u&&l!=null&&l>3?s._(/*BTDS*/"A\u00f1adiste a {names} y {participants_count} m\u00e1s.",[s._param("names",i),s._param("participants_count",l-2)]):s._(/*BTDS*/"A\u00f1adiste a {names}.",[s._param("names",i)]):o("WAWebSystemMessagesUtils").isMe(r)?n!=null?s._(/*BTDS*/"{user_name} te a\u00f1adi\u00f3.",[s._param("user_name",n)]):s._(/*BTDS*/"Un miembro te agreg\u00f3."):n!=null?u&&l!=null&&l>3?s._(/*BTDS*/"{user_name} a\u00f1adi\u00f3 a {names} y {participants_count} m\u00e1s.",[s._param("user_name",n),s._param("names",i),s._param("participants_count",l-2)]):s._(/*BTDS*/"{user_name} a\u00f1adi\u00f3 a {names}.",[s._param("user_name",n),s._param("names",i)]):u&&l!=null&&l>3?s._(/*BTDS*/"Un miembro a\u00f1adi\u00f3 a {names} y {participants_count} m\u00e1s.",[s._param("names",i),s._param("participants_count",l-2)]):s._(/*BTDS*/"Un miembro a\u00f1adi\u00f3 a {names}.",[s._param("names",i)]):o("WAWebSystemMessagesUtils").isMe(r)?s._(/*BTDS*/"Se te a\u00f1adi\u00f3 al grupo."):s._(/*BTDS*/"Se a\u00f1adi\u00f3 a {user_name}.",[s._param("user_name",a)])}l.formatAddNotification=e}),226);
__d("WAWebFormatAnnounceNotification",["fbt","WAWebSystemMessagesUtils"],(function(t,n,r,o,a,i,l,s){function e(e){var t=e.author,n=e.authorClickable,r=e.body;return r==="on"?o("WAWebSystemMessagesUtils").isMe(t)?s._(/*BTDS*/"Permitiste que solo los administradores puedan enviar mensajes a este grupo."):s._(/*BTDS*/"{user_name} cambi\u00f3 los ajustes de este grupo para permitir que solo los administradores puedan enviar mensajes al grupo.",[s._param("user_name",n)]):o("WAWebSystemMessagesUtils").isMe(t)?s._(/*BTDS*/"Cambiaste los ajustes de este grupo para permitir que todos los miembros puedan enviar mensajes al grupo."):s._(/*BTDS*/"{user_name} cambi\u00f3 los ajustes de este grupo para permitir que todos los miembros puedan enviar mensajes al grupo.",[s._param("user_name",n)])}l.formatAnnounceNotification=e}),226);
__d("WAWebFormatBroadcastNotification",["fbt","WAWebFormatParticipantNames"],(function(t,n,r,o,a,i,l,s){function e(e){var t=e.subtype,n=e.body,r=e.recipients;if(t==="create"){var a=parseInt(n,10);return s._(/*BTDS*/"_j{\"*\":\"Creaste una lista de difusi\\u00f3n con {count} destinatarios.\",\"_1\":\"Creaste una lista de difusi\\u00f3n con 1 destinatario.\"}",[s._plural(a,"count")]).toString()}else if(t==="add"){var i=r.length;return s._(/*BTDS*/"_j{\"*\":\"Se a\\u00f1adieron {name} a la lista.\",\"_1\":\"Se a\\u00f1adi\\u00f3 a {name} a la lista.\"}",[s._plural(i),s._param("name",o("WAWebFormatParticipantNames").getFormattedNames(r,!1))]).toString()}else if(t==="remove"){var l=r.length;return s._(/*BTDS*/"_j{\"*\":\"Se elimin\\u00f3 a {name} de la lista.\"}",[s._plural(l),s._param("name",o("WAWebFormatParticipantNames").getFormattedNames(r,!1))]).toString()}return""}l.default=e}),226);
__d("WAWebFormatCommunityOwnerUpdateNotification",["fbt","WAWebChatCommunityUtils","WAWebFormatParticipantNames","WAWebSystemMessagesUtils"],(function(t,n,r,o,a,i,l,s){function e(e){var t=e.author,n=e.templateParams,r=e.clickable,a=t?o("WAWebFormatParticipantNames").getFormattedName(t,r):null,i=o("WAWebChatCommunityUtils").getNewCommunityOwnerFromTemplateParams(n),l=i!=null?o("WAWebFormatParticipantNames").getFormattedName(i,r):null;return t!=null?o("WAWebSystemMessagesUtils").isMe(t)?s._(/*BTDS*/"Asignaste a {user_name} como el nuevo propietario.",[s._param("user_name",l)]):o("WAWebSystemMessagesUtils").isMe(i)?s._(/*BTDS*/"{user_name} te asign\u00f3 como el nuevo propietario. M\u00e1s info.",[s._param("user_name",a)]):s._(/*BTDS*/"{author_name} asign\u00f3 a {user_name} como el nuevo propietario.",[s._param("author_name",a),s._param("user_name",l)]):o("WAWebSystemMessagesUtils").isMe(i)?s._(/*BTDS*/"Eres el nuevo propietario. M\u00e1s informaci\u00f3n"):s._(/*BTDS*/"{user_name} es el nuevo propietario.",[s._param("user_name",l)])}l.formatCommunityOwnerUpdateNotification=e}),226);
__d("WAWebFormatCreateNotification",["fbt","WAWebSystemMessagesUtils","react"],(function(t,n,r,o,a,i,l,s){var e,u=e||(e=r("react"));function c(e){var t=e.chat,n=e.author,r=e.authorClickable,a=e.groupSubject,i=e.groupSubjectAsString,l=i?a:u.jsx(o("WAWebSystemMessagesUtils").FormattedText,{text:a});if(o("WAWebSystemMessagesUtils").isMe(n))return a?s._(/*BTDS*/"Creaste el grupo \"{group_subject}\".",[s._param("group_subject",l)]):s._(/*BTDS*/"Creaste este grupo.");if(a)return r!=null?s._(/*BTDS*/"{user_name} cre\u00f3 el grupo \"{group_subject}\".",[s._param("user_name",r),s._param("group_subject",l)]):s._(/*BTDS*/"Un admin. cre\u00f3 el grupo \"{group_subject}\".",[s._param("group_subject",l)]);if(r!=null){var c=t?t.title():"";return c.trim()===""?s._(/*BTDS*/"{user_name} cre\u00f3 este grupo.",[s._param("user_name",r)]):s._(/*BTDS*/"{user_name} cre\u00f3 el grupo \"{group_subject}\".",[s._param("user_name",r),s._param("group_subject",c)])}return s._(/*BTDS*/"Un admin. cre\u00f3 este grupo")}c.displayName=c.name+" [from "+i.id+"]",l.formatCreateNotification=c}),226);
__d("WAWebFormatCreatedSubgroupSuggestionNotification",["fbt","WAWebFormatParticipantNames","WAWebSystemMessageGatingUtils"],(function(t,n,r,o,a,i,l,s){function e(e,t,n){var r=o("WAWebFormatParticipantNames").getFormattedName(e,n),a=t[0],i=o("WAWebSystemMessageGatingUtils").systemMessageActionTextStylingEnabled();return i?s._(/*BTDS*/"{suggestion-owner} sugiri\u00f3 el grupo \"{suggested-group-name}\".",[s._param("suggestion-owner",r),s._param("suggested-group-name",a)]):s._(/*BTDS*/"{suggestion-owner} sugiri\u00f3 el grupo \"{suggested-group-name}\". Haz clic para aprobar o rechazar.",[s._param("suggestion-owner",r),s._param("suggested-group-name",a)])}l.default=e}),226);
__d("WAWebFormatDeleteNotification",["fbt","WAWebChatGroupUtils"],(function(t,n,r,o,a,i,l,s){function e(e){var t=e.chat;return o("WAWebChatGroupUtils").isCommunityAnnouncementGroup(t)?s._(/*BTDS*/"Esta comunidad ya no est\u00e1 disponible."):o("WAWebChatGroupUtils").isSupportGroup(t)?s._(/*BTDS*/"Se cerr\u00f3 este chat."):s._(/*BTDS*/"Se cerr\u00f3 este grupo")}l.formatDeleteNotification=e}),226);
__d("WAWebWamEnumSystemMessageTypeType",[],(function(t,n,r,o,a,i){var e=Object.freeze({E2E_ENCRYPTED_MESSAGES_CALLS:1,E2E_ENCRYPTED_MESSAGES:2,E2E_ENCRYPTED_BROADCAST_LIST:3,E2E_ENCRYPTED_MESSAGE_YOURSELF:4,OFFICIAL_ACCOUNT_INFO:8,GROUP_ADD:9,GROUP_RESET_INVITE:10,COMMUNITY_DESCRIPTION_CHANGED:11,GROUP_DESCRIPTION_CHANGED:12,GROUP_PARTICIPANTS_CHANGED:13,COMMUNITY_MEMBERS_CHANGED:14,GROUP_INVITE_LINK_UNAVAILABLE:15,GROUP_INVITE_LINK_AVAILABLE:16,GROUP_JOIN_REQUEST:17,GROUP_SUGGEST:18});i.SYSTEM_MESSAGE_TYPE_TYPE=e}),66);
__d("WAWebFormatDescriptionNotification",["fbt","WAWebSystemMessageGatingUtils","WAWebSystemMessagesUtils","WAWebWamEnumSystemMessageTypeType"],(function(t,n,r,o,a,i,l,s){var e=o("WAWebSystemMessageGatingUtils").systemMessageActionTextStylingEnabled();function u(t){var n=t.author,r=t.authorClickable,a=t.isParentGroup,i=a===void 0?!1:a,l=t.shouldFormatAsLastMsg,u=l===void 0?!1:l;return u?o("WAWebSystemMessagesUtils").isMe(n)?i===!0?{text:s._(/*BTDS*/"Cambiaste la descripci\u00f3n de la comunidad."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.COMMUNITY_DESCRIPTION_CHANGED}:{text:s._(/*BTDS*/"Cambiaste la descripci\u00f3n del grupo."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.GROUP_DESCRIPTION_CHANGED}:r!=null?i===!0?{text:s._(/*BTDS*/"{user_name} cambi\u00f3 la descripci\u00f3n de la comunidad.",[s._param("user_name",r)]),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.COMMUNITY_DESCRIPTION_CHANGED}:{text:s._(/*BTDS*/"{user_name} cambi\u00f3 la descripci\u00f3n del grupo.",[s._param("user_name",r)]),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.GROUP_DESCRIPTION_CHANGED}:i===!0?{text:s._(/*BTDS*/"Un miembro cambi\u00f3 la descripci\u00f3n de la comunidad."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.COMMUNITY_DESCRIPTION_CHANGED}:{text:s._(/*BTDS*/"Un miembro cambi\u00f3 la descripci\u00f3n del grupo."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.GROUP_DESCRIPTION_CHANGED}:o("WAWebSystemMessagesUtils").isMe(n)?i===!0?{text:e?s._(/*BTDS*/"Cambiaste la descripci\u00f3n de la comunidad."):s._(/*BTDS*/"Cambiaste la descripci\u00f3n de la comunidad. Haz clic para verla."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.COMMUNITY_DESCRIPTION_CHANGED}:{text:e?s._(/*BTDS*/"Cambiaste la descripci\u00f3n del grupo."):s._(/*BTDS*/"Cambiaste la descripci\u00f3n del grupo. Haz clic para verla."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.GROUP_DESCRIPTION_CHANGED}:r!=null?i===!0?{text:e?s._(/*BTDS*/"{user_name} cambi\u00f3 la descripci\u00f3n de la comunidad.",[s._param("user_name",r)]):s._(/*BTDS*/"{user_name} cambi\u00f3 la descripci\u00f3n de la comunidad. Haz clic para verla.",[s._param("user_name",r)]),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.COMMUNITY_DESCRIPTION_CHANGED}:{text:e?s._(/*BTDS*/"{user_name} cambi\u00f3 la descripci\u00f3n del grupo.",[s._param("user_name",r)]):s._(/*BTDS*/"{user_name} cambi\u00f3 la descripci\u00f3n del grupo. Haz clic para verla.",[s._param("user_name",r)]),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.GROUP_DESCRIPTION_CHANGED}:i===!0?{text:e?s._(/*BTDS*/"Un miembro cambi\u00f3 la descripci\u00f3n de la comunidad."):s._(/*BTDS*/"Un miembro cambi\u00f3 la descripci\u00f3n de la comunidad. Haz clic para verla."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.COMMUNITY_DESCRIPTION_CHANGED}:{text:e?s._(/*BTDS*/"Un miembro cambi\u00f3 la descripci\u00f3n del grupo."):s._(/*BTDS*/"Un miembro cambi\u00f3 la descripci\u00f3n del grupo. Haz clic para verla."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.COMMUNITY_DESCRIPTION_CHANGED}}function c(e){var t=e.author,n=e.authorClickable,r=e.isParentGroup,o=r===void 0?!1:r,a=e.shouldFormatAsLastMsg,i=a===void 0?!1:a;return u({author:t,authorClickable:n,isParentGroup:o,shouldFormatAsLastMsg:i}).text}l.formatDescriptionNotification=c}),226);
__d("WAWebLimitSharingGatingUtils",["WAWebABProps"],(function(t,n,r,o,a,i,l){"use strict";function e(){return o("WAWebABProps").getABPropConfigValue("render_updated_disclosure")}function s(){return o("WAWebABProps").getABPropConfigValue("limit_sharing_enabled_for_group_chat")}function u(){return o("WAWebABProps").getABPropConfigValue("limit_sharing_enabled_for_1on1_chat")}function c(){return o("WAWebABProps").getABPropConfigValue("limit_sharing_update_enabled_web")}function d(){return o("WAWebABProps").getABPropConfigValue("limit_sharing_protocol_message_receiver_enabled")}function m(){return o("WAWebABProps").getABPropConfigValue("advanced_chat_privacy_content_update_july_25")}l.isRenderUpdatedDisclosureGatingEnabled=e,l.isLimitSharingSetterGatingEnabledForGroupChat=s,l.isLimitSharingSetterGatingEnabledFor1on1Chat=u,l.isLimitSharingSetterUpdateGatingEnabledForWeb=c,l.isLimitSharingReceiverGatingEnabledForChat=d,l.isLimitSharingContentUpdateJuly25Enabled=m}),98);
__d("WAWebFormatE2ENotification",["fbt","WALogger","WAWebChatGetters","WAWebChatGroupUtils","WAWebContactCollection","WAWebContactGetters","WAWebFormatE2ENotificationForDeviceChange","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebLimitSharingGatingUtils","WAWebMsgGetters","WAWebSupportChatStrings","WAWebSystemMessageGatingUtils","WAWebUserPrefsMeUser","WAWebWamEnumSystemMessageTypeType","WAWebWid","WAWebWidFormat"],(function(t,n,r,o,a,i,l,s){var e;function u(t){var n=o("WAWebSystemMessageGatingUtils").systemMessageActionTextStylingEnabled();switch(t.subtype){case"identity":{var a=t.body==null?null:o("WAWebContactCollection").ContactCollection.get(t.body);if(a!=null&&o("WAWebContactGetters").getIsMe(a)){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["generateE2ENotification: receive identity notification of self"]))).sendLogs("SelfIdentityNotificationError");var i=o("WAWebFrontendMsgGetters").getChat(t.unsafe());if(o("WAWebChatGetters").getIsUser(i)){var l=i.contact?o("WAWebFrontendContactGetters").getFormattedName(i.contact):o("WAWebWidFormat").widToFormattedUser(i.id);return{text:n?s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con {contactName}.",[s._param("contactName",l)]):s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con {contactName}. Haz clic para obtener m\u00e1s informaci\u00f3n.",[s._param("contactName",l)])}}else{if(o("WAWebChatGetters").getIsGroup(i))return{text:n?s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con todos los miembros."):s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con todos los miembros. Haz clic para obtener m\u00e1s informaci\u00f3n.")};if(o("WAWebChatGetters").getIsBroadcast(i))return{text:n?s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con todos los destinatarios."):s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con todos los destinatarios. Haz clic para obtener m\u00e1s informaci\u00f3n.")}}}var u=a?o("WAWebFrontendContactGetters").getFormattedName(a):o("WAWebWidFormat").widToFormattedUser(t.body);return{text:n?s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con {contactName}.",[s._param("contactName",u)]):s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con {contactName}. Haz clic para obtener m\u00e1s informaci\u00f3n.",[s._param("contactName",u)])}}case"device":return{text:o("WAWebFormatE2ENotificationForDeviceChange").formatE2ENotificationForDeviceChange(t),enumType:o("WAWebFormatE2ENotificationForDeviceChange").getE2ENotificationForDeviceChangeEnum(t)};case"encrypt":{var c=t.id.remote;return r("WAWebWid").isGroup(c)?o("WAWebChatGroupUtils").isSupportGroup(o("WAWebFrontendMsgGetters").getMaybeChat(t.unsafe()))?{text:o("WAWebSupportChatStrings").SupportChatSystemMessage()}:o("WAWebLimitSharingGatingUtils").isRenderUpdatedDisclosureGatingEnabled()?{text:n?s._(/*BTDS*/"Los mensajes y las llamadas est\u00e1n cifrados de extremo a extremo. Solo las personas en este chat pueden leerlos, escucharlos o compartirlos"):s._(/*BTDS*/"Los mensajes y las llamadas est\u00e1n cifrados de extremo a extremo. Solo las personas en este chat pueden leerlos, escucharlos o compartirlos. Haz clic para obtener m\u00e1s informaci\u00f3n."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_MESSAGES}:{text:n?s._(/*BTDS*/"Los mensajes est\u00e1n cifrados de extremo a extremo. Nadie fuera de este chat, ni siquiera WhatsApp, puede leerlos ni escucharlos"):s._(/*BTDS*/"Los mensajes est\u00e1n cifrados de extremo a extremo. Nadie fuera de este chat, ni siquiera WhatsApp, puede leerlos ni escucharlos. Haz clic para obtener m\u00e1s informaci\u00f3n."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_MESSAGES}:o("WAWebMsgGetters").getIsCAPISupport(t)?{text:o("WAWebSupportChatStrings").SupportChatSystemMessage()}:r("WAWebWid").isBroadcast(c)?{text:n?s._(/*BTDS*/"Los mensajes que env\u00edas a esta lista de difusi\u00f3n est\u00e1n protegidos con cifrado de extremo a extremo."):s._(/*BTDS*/"Los mensajes que env\u00edas a esta lista de difusi\u00f3n est\u00e1n protegidos con cifrado de extremo a extremo. Haz clic para obtener m\u00e1s informaci\u00f3n."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_BROADCAST_LIST}:o("WAWebUserPrefsMeUser").isMeAccount(c)?o("WAWebLimitSharingGatingUtils").isRenderUpdatedDisclosureGatingEnabled()?{text:n?s._(/*BTDS*/"Los mensajes que env\u00edas a tu propio n\u00famero est\u00e1n cifrados de extremo a extremo. Nadie m\u00e1s, ni siquiera WhatsApp, puede leerlos, escucharlos o compartirlos."):s._(/*BTDS*/"Los mensajes que env\u00edas a tu propio n\u00famero est\u00e1n cifrados de extremo a extremo. Nadie m\u00e1s, ni siquiera WhatsApp, puede leerlos, escucharlos o compartirlos. Haz clic para obtener m\u00e1s informaci\u00f3n."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_MESSAGE_YOURSELF}:{text:n?s._(/*BTDS*/"Los mensajes enviados a este mismo n\u00famero est\u00e1n cifrados de extremo a extremo. Nadie fuera de este chat, ni siquiera WhatsApp, puede leerlos ni escucharlos."):s._(/*BTDS*/"Los mensajes enviados a este mismo n\u00famero est\u00e1n cifrados de extremo a extremo. Nadie fuera de este chat, ni siquiera WhatsApp, puede leerlos ni escucharlos. Haz clic para obtener m\u00e1s informaci\u00f3n."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_MESSAGE_YOURSELF}:o("WAWebLimitSharingGatingUtils").isRenderUpdatedDisclosureGatingEnabled()?{text:n?s._(/*BTDS*/"Los mensajes y las llamadas est\u00e1n cifrados de extremo a extremo. Solo las personas en este chat pueden leerlos, escucharlos o compartirlos"):s._(/*BTDS*/"Los mensajes y las llamadas est\u00e1n cifrados de extremo a extremo. Solo las personas en este chat pueden leerlos, escucharlos o compartirlos. Haz clic para obtener m\u00e1s informaci\u00f3n."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_MESSAGES}:{text:n?s._(/*BTDS*/"Los mensajes est\u00e1n cifrados de extremo a extremo. Nadie fuera de este chat, ni siquiera WhatsApp, puede leerlos ni escucharlos"):s._(/*BTDS*/"Los mensajes est\u00e1n cifrados de extremo a extremo. Nadie fuera de este chat, ni siquiera WhatsApp, puede leerlos ni escucharlos. Haz clic para obtener m\u00e1s informaci\u00f3n."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_MESSAGES}}case"encrypt_now":return o("WAWebLimitSharingGatingUtils").isRenderUpdatedDisclosureGatingEnabled()?{text:n?s._(/*BTDS*/"Las llamadas y los mensajes ahora est\u00e1n cifrados de extremo a extremo. Solo las personas en este chat pueden leerlos, escucharlos o compartirlos."):s._(/*BTDS*/"Los mensajes y las llamadas ahora est\u00e1n cifrados de extremo a extremo. Solo las personas en este chat pueden leerlos, escucharlos o compartirlos. Haz clic para obtener m\u00e1s informaci\u00f3n."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_MESSAGES_CALLS}:{text:n?s._(/*BTDS*/"Los mensajes y las llamadas ahora est\u00e1n cifrados de extremo a extremo. Nadie fuera de este chat, ni siquiera WhatsApp, puede leerlos o escucharlos."):s._(/*BTDS*/"Los mensajes y las llamadas ahora est\u00e1n cifrados de extremo a extremo. Nadie fuera de este chat, ni siquiera WhatsApp, puede leerlos ni escucharlos. Haz clic para obtener m\u00e1s informaci\u00f3n."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_MESSAGES_CALLS};case"e2e_identity_unavailable":return{text:s._(/*BTDS*/"Ya no est\u00e1n disponibles para este chat las notificaciones relacionadas con el c\u00f3digo de seguridad.")};case"chat_psa":return{text:n?s._(/*BTDS*/"Esta es una cuenta oficial de WhatsApp."):s._(/*BTDS*/"Esta es una cuenta oficial de WhatsApp. Haz clic para obtener m\u00e1s informaci\u00f3n."),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.OFFICIAL_ACCOUNT_INFO};default:return{text:""}}}function c(e){return u(e).text}function d(e){return u(e).enumType}l.formatE2ENotification=c,l.getE2ENotificationEnum=d}),226);
__d("WAWebFormatE2ENotificationForDeviceChange",["fbt","invariant","WAWebChatGetters","WAWebContactCollection","WAWebContactGetters","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebSystemMessageGatingUtils","WAWebWidFormat"],(function(t,n,r,o,a,i,l,s,u){function e(e,t){t===void 0&&(t=!1),e.subtype==="device"||u(0,56347);var n=o("WAWebSystemMessageGatingUtils").systemMessageActionTextStylingEnabled(),r=e.body?o("WAWebContactCollection").ContactCollection.get(e.body):null,a,i=e.devicesAdded===1&&e.devicesRemoved===0,l=e.devicesAdded===0&&e.devicesRemoved===1,c=!i&&!l;if(r!=null&&o("WAWebContactGetters").getIsMe(r)){var d=o("WAWebFrontendMsgGetters").getChat(e.unsafe());if(o("WAWebChatGetters").getIsUser(d)){var m=o("WAWebFrontendContactGetters").getFormattedName(d.contact);t?i?e.isThisDeviceAdded?a=s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con {contactName} porque se inici\u00f3 sesi\u00f3n en este dispositivo.",[s._param("contactName",m)]):a=s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con {contactName} porque se inici\u00f3 sesi\u00f3n en un nuevo dispositivo tuyo.",[s._param("contactName",m)]):l?a=s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con {contactName} porque se cerr\u00f3 la sesi\u00f3n de uno de tus dispositivos.",[s._param("contactName",m)]):c&&(a=s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con {contactName} porque se inici\u00f3 o cerro sesi\u00f3n en uno o m\u00e1s de tus dispositivos.",[s._param("contactName",m)])):a=n?s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con {contactName}.",[s._param("contactName",m)]):s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con {contactName}. Haz clic para obtener m\u00e1s informaci\u00f3n.",[s._param("contactName",m)])}else o("WAWebChatGetters").getIsGroup(d)?t?i?e.isThisDeviceAdded?a=s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con todos los miembros porque se inici\u00f3 sesi\u00f3n en este dispositivo. Para verificar el c\u00f3digo de seguridad de un contacto, abre su p\u00e1gina de informaci\u00f3n y haz clic en Cifrado."):a=s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con todos los miembros porque se inici\u00f3 sesi\u00f3n en un nuevo dispositivo tuyo. Para verificar el c\u00f3digo de seguridad de un contacto, abre su p\u00e1gina de informaci\u00f3n y haz clic en Cifrado."):l?a=s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con todos los miembros porque se cerr\u00f3 la sesi\u00f3n de uno de tus dispositivos. Para verificar el c\u00f3digo de seguridad de un contacto, abre su p\u00e1gina de informaci\u00f3n y haz clic en Cifrado."):c&&(a=s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con todos los miembros porque se inici\u00f3 o cerr\u00f3 sesi\u00f3n en uno o m\u00e1s de tus dispositivos. Para verificar el c\u00f3digo de seguridad de un contacto, abre su p\u00e1gina de informaci\u00f3n y haz clic en Cifrado.")):a=n?s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con todos los miembros."):s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con todos los miembros. Haz clic para obtener m\u00e1s informaci\u00f3n."):o("WAWebChatGetters").getIsBroadcast(d)&&(t?i?e.isThisDeviceAdded?a=s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con todos los destinatarios porque se inici\u00f3 sesi\u00f3n en este dispositivo. Para verificar el c\u00f3digo de seguridad de un contacto, abre su p\u00e1gina de info. y haz clic en \"Cifrado\"."):a=s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con todos los destinatarios porque se inici\u00f3 sesi\u00f3n en un nuevo dispositivo tuyo. Para verificar el c\u00f3digo de seguridad de un contacto, abre su p\u00e1gina de info. y haz clic en \"Cifrado\"."):l?a=s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con todos los destinatarios porque se cerr\u00f3 la sesi\u00f3n de uno de tus dispositivos. Para verificar el c\u00f3digo de seguridad de un contacto, abre su p\u00e1gina de info. y haz clic en \"Cifrado\"."):c&&(a=s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con todos los destinatarios porque se inici\u00f3 o cerr\u00f3 sesi\u00f3n en uno o m\u00e1s de tus dispositivos. Para verificar el c\u00f3digo de seguridad de un contacto, abre su p\u00e1gina de info. y haz clic en \"Cifrado\".")):a=n?s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con todos los destinatarios."):s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con todos los destinatarios. Haz clic para obtener m\u00e1s informaci\u00f3n."))}else{var p=e.body;r=p==null?null:o("WAWebContactCollection").ContactCollection.get(p);var _=r?o("WAWebFrontendContactGetters").getFormattedName(r):o("WAWebWidFormat").widToFormattedUser(p);t?i?a=s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con {contactName} porque este contacto volvi\u00f3 a registrar WhatsApp en su tel\u00e9fono.",[s._param("contactName",_)]):l?a=s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con {contactName} porque se cerr\u00f3 la sesi\u00f3n de uno de sus dispositivos.",[s._param("contactName",_)]):c&&(a=s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con {contactName} porque se inici\u00f3 o cerr\u00f3 sesi\u00f3n en uno o m\u00e1s de sus dispositivos.",[s._param("contactName",_)])):a=n?s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con {contactName}.",[s._param("contactName",_)]):s._(/*BTDS*/"Cambi\u00f3 tu c\u00f3digo de seguridad con {contactName}. Haz clic para obtener m\u00e1s informaci\u00f3n.",[s._param("contactName",_)])}return a!=null||u(0,56348),{text:a}}function c(t,n){return n===void 0&&(n=!1),e(t,n).text}function d(t,n){return n===void 0&&(n=!1),e(t,n).enumType}l.formatE2ENotificationForDeviceChange=c,l.getE2ENotificationForDeviceChangeEnum=d}),226);
__d("WAWebFormatEphemeralSetting",["fbt","WALogger","WANullthrows","WAWebABProps","WAWebBizCoexGatingUtils","WAWebChatEphemerality","WAWebContactCollection","WAWebEphemeralConstants","WAWebEphemeralFbtKic","WAWebEphemeralityTypes","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebStateUtils","WAWebUserPrefsMeUser","WAWebWid","err"],(function(t,n,r,o,a,i,l,s){var e,u;function c(e){var t,n=_(e),a=n.newDuration,i=n.initiatingUser,l=o("WAWebUserPrefsMeUser").isMeAccount(r("WANullthrows")(i));if(l)t=o("WAWebEphemeralFbtKic").getDisappearingModeYouStringKic(a);else{var s=o("WAWebContactCollection").ContactCollection.gadd(r("WANullthrows")(i));t=o("WAWebEphemeralFbtKic").getDisappearingModeOtherStringKic(a,o("WAWebFrontendContactGetters").getFormattedName(s))}return t}function d(e){return C(o("WAWebStateUtils").unproxy(e.unsafe()))}function m(e){if(o("WAWebFrontendMsgGetters").getChat(e)!=null)for(var t=o("WAWebFrontendMsgGetters").getChat(e).msgs,n=t.indexOf(e),r=n-1;r>=0;r--){var a=t.at(r);if(a!=null&&a.type!=="debug"&&(a.type!=="gp2"||a.subtype==="ephemeral"))return a}}function p(e){var t=m(e);return t!=null&&(t.ephemeralDuration!=null&&t.ephemeralDuration>0||(t.subtype==="ephemeral"||t.subtype==="disappearing_mode")&&t.templateParams[0]!=null&&t.templateParams[0]!=="0")}function _(e){var t,n;if(e.templateParams.length?(n=parseInt(e.templateParams[0],10),e.templateParams[1]instanceof r("WAWebWid")&&(t=e.templateParams[1])):(t=e.ephemeralSettingUser,n=e.ephemeralDuration),n==null)throw r("err")("Duration cannot be null for DM notification");return{newDuration:n!=null?n:0,disappearingModeTrigger:null,initiatingUser:t}}function f(e){var t,n;return e.ephemeralSettingUser!==void 0?n=e.ephemeralSettingUser:n=e.from,{newDuration:(t=e.ephemeralDuration)!=null?t:0,disappearingModeTrigger:e.disappearingModeTrigger,initiatingUser:n}}function g(e){var t=e.initiatorUsername,n=e.initiatorIsMe,r=e.state;return n?r==="update"?s._(/*BTDS*/"Actualizaste la duraci\u00f3n de los mensajes."):r==="on"?s._(/*BTDS*/"Activaste los mensajes temporales."):s._(/*BTDS*/"Desactivaste los mensajes temporales."):t!=null?r==="update"?s._(/*BTDS*/"{name} actualiz\u00f3 la duraci\u00f3n de los mensajes.",[s._param("name",t)]):r==="on"?s._(/*BTDS*/"{name} activ\u00f3 los mensajes temporales.",[s._param("name",t)]):s._(/*BTDS*/"{name} desactiv\u00f3 los mensajes temporales.",[s._param("name",t)]):r==="update"?s._(/*BTDS*/"Se actualiz\u00f3 la duraci\u00f3n de los mensajes."):r==="on"?s._(/*BTDS*/"Se activaron los mensajes temporales."):s._(/*BTDS*/"Se desactivaron los mensajes temporales.")}function h(t){var n=o("WAWebEphemeralConstants").getDurationForString(t),r=n.duration,a=n.unit;switch(a){case o("WAWebEphemeralConstants").DurationUnit.Seconds:return s._(/*BTDS*/"_j{\"*\":\"{duration} seconds\",\"_1\":\"1 second\"}",[s._plural(r,"duration")]);case o("WAWebEphemeralConstants").DurationUnit.Minutes:return s._(/*BTDS*/"_j{\"*\":\"{duration} minutes\",\"_1\":\"1 minute\"}",[s._plural(r,"duration")]);case o("WAWebEphemeralConstants").DurationUnit.Hours:return s._(/*BTDS*/"_j{\"*\":\"{duration} horas\",\"4\":\"{duration} hora\",\"_1\":\"1 hora\"}",[s._plural(r,"duration")]);case o("WAWebEphemeralConstants").DurationUnit.Days:return s._(/*BTDS*/"_j{\"*\":\"{duration} d\\u00edas\",\"4\":\"{duration} d\\u00eda\",\"_1\":\"1 d\\u00eda\"}",[s._plural(r,"duration")]);case o("WAWebEphemeralConstants").DurationUnit.Weeks:return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getDisappearingMessageDurationString: Weeks are not an option for DM system messages"]))),s._(/*BTDS*/"_j{\"*\":\"{duration} weeks\",\"_1\":\"1 week\"}",[s._plural(r,"duration")])}}function y(e){var t=h(e);return s._(/*BTDS*/"Los mensajes nuevos desaparecer\u00e1n de este chat despu\u00e9s de {dm-duration} de haber sido enviados, a menos que se use la opci\u00f3n para conservarlos.",[s._param("dm-duration",t)])}function C(e){var t,n=null;switch(e.type){case"gp2":case"notification_template":n=_(e);break;case"protocol":n=f(e);break;default:break}if(n==null)throw o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Cannot parse msg to build DM system message"]))).tags("DM","DDM").devConsole(e),r("err")("Cannot parse msg to build DM system message");var a=null,i=o("WAWebUserPrefsMeUser").isMePrimary(n.initiatingUser);if(o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&n.disappearingModeTrigger===o("WAWebEphemeralityTypes").DisappearingModeTrigger.BizSupportFbHosting)return b(i);var l=null;if(n.newDuration?p(e)?l="update":l="on":l="off",l==="update"&&!o("WAWebABProps").getABPropConfigValue("dm_updated_system_message")&&(l="on"),n.initiatingUser!=null&&!i){var s=o("WAWebContactCollection").ContactCollection.gadd(n.initiatingUser);a=o("WAWebFrontendContactGetters").getIsMyContact(s)?o("WAWebFrontendContactGetters").getFormattedName(s):o("WAWebFrontendContactGetters").getFormattedUsernameOrPhone(s)}var c=o("WAWebFrontendMsgGetters").getMaybeChat(e),d=c&&o("WAWebChatEphemerality").shouldShowEphemeralSetting(c)&&(r("WAWebWid").isUser(c.id)||((t=c.groupMetadata)==null?void 0:t.canSetEphemeralSetting()));return v({newDuration:n.newDuration,state:l,initiatorUsername:a,initiatorIsMe:i,userCanChange:d===!0})}function b(e){var t=s._(/*BTDS*/"Los mensajes temporales ya no son compatibles con esta empresa."),n=s._(/*BTDS*/"Los mensajes temporales ya no son compatibles con tu empresa.");return e?n:t}function v(e){var t=e.newDuration,n=e.state,r=e.initiatorUsername,o=e.initiatorIsMe,a=e.userCanChange,i=g({initiatorUsername:r,initiatorIsMe:o,state:n}),l=s._(/*BTDS*/"Haz clic para cambiar esto.");if(!t)return a!==!0?i:s._(/*BTDS*/"{dm-sm-event} {dm-sm-action}",[s._param("dm-sm-event",i),s._param("dm-sm-action",l)]);var u=y(t);return a!==!0?s._(/*BTDS*/"{dm-sm-event} {dm-sm-explanation}",[s._param("dm-sm-event",i),s._param("dm-sm-explanation",u)]):s._(/*BTDS*/"{dm-sm-event} {dm-sm-explanation} {dm-sm-action}",[s._param("dm-sm-event",i),s._param("dm-sm-explanation",u),s._param("dm-sm-action",l)])}function S(){return s._(/*BTDS*/"Los mensajes temporales no son compatibles con este chat, por lo que tus mensajes no desaparecer\u00e1n.")}l.getDefaultDisappearingModeSystemMessageText=c,l.getDisappearingModeUpdateSystemMessageText=d,l.getDisappearingMessageDurationString=h,l.formatEphemeralSetting=C,l.buildEphemeralSystemMessage=v,l.getDMUnsupportedSystemMessageText=S}),226);
__d("WAWebFormatAllowNonAdminSubGroupCreationNotification",["fbt","WAWebCommunityGatingUtils","WAWebGroupType"],(function(t,n,r,o,a,i,l,s){function e(e,t){var n,r=t[0]&&o("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.cast(t[0].toString())===o("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.On,a=!!((n=e.groupMetadata)!=null&&n.participants.iAmAdmin());return r?a?s._(/*BTDS*/"Ahora, cualquier miembro de esta comunidad puede a\u00f1adir grupos. Haz clic para cambiar esto."):s._(/*BTDS*/"Cualquier miembro de esta comunidad puede a\u00f1adir grupos."):o("WAWebCommunityGatingUtils").memberSuggestedGroupsEnabled()?a?s._(/*BTDS*/"Solo quienes administran la comunidad pueden a\u00f1adir grupos. Los miembros pueden sugerirles grupos para que los aprueben. Haz clic para cambiar esto."):s._(/*BTDS*/"Solo quienes administran la comunidad pueden a\u00f1adir grupos. Los miembros pueden sugerirles grupos para que los aprueben."):a?s._(/*BTDS*/"Ahora, solo quienes administran esta comunidad pueden a\u00f1adir grupos. Haz clic para cambiar esto."):s._(/*BTDS*/"Ahora, solo quienes administran esta comunidad pueden a\u00f1adir grupos.")}l.default=e}),226);
__d("WAWebMessageCommunityEmptySubgroupWelcomeTitle.react",["fbt"],(function(t,n,r,o,a,i,l,s){function e(e){return s._(/*BTDS*/"Creaste el grupo {subgroup_name}.",[s._param("subgroup_name",e)])}l.communityEmptySubgroupWelcomeTitle=e}),226);
__d("WAWebMessageCommunityGeneralChatAutoAddDisabledNotification.react",["fbt","WAWebCommunityGatingUtils","WAWebGroupType"],(function(t,n,r,o,a,i,l,s){function e(e,t){var n,r,a=(n=o("WAWebGroupType").GeneralChatAutoAddDisabledReasonEnum.cast((r=t[0])==null?void 0:r.toString()))!=null?n:o("WAWebGroupType").GeneralChatAutoAddDisabledReasonEnum.Full;return a===o("WAWebGroupType").GeneralChatAutoAddDisabledReasonEnum.Server?s._(/*BTDS*/"Ya no se a\u00f1adir\u00e1 autom\u00e1ticamente a los nuevos miembros de la comunidad."):o("WAWebCommunityGatingUtils").communityGeneralChatV2Enabled()?s._(/*BTDS*/"\"{subgroup_name}\" ahora est\u00e1 completo.",[s._param("subgroup_name",e)]):s._(/*BTDS*/"\"{subgroup_name}\" est\u00e1 lleno. Los nuevos miembros de la comunidad ya no se a\u00f1adir\u00e1n autom\u00e1ticamente a \u00e9l.",[s._param("subgroup_name",e)])}l.communityGeneralChatAutoAddDisabledNotification=e}),226);
__d("WAWebMessageCommunityGeneralChatWelcomeTitle.react",["fbt"],(function(t,n,r,o,a,i,l,s){function e(e){return s._(/*BTDS*/"Les damos la bienvenida al grupo: {subgroup_name}",[s._param("subgroup_name",e)])}l.communityGeneralChatWelcomeTitle=e}),226);
__d("WAWebFormatGroupNotification",["fbt","WALogger","WAWebChatGroupUtils","WAWebContactCollection","WAWebFormatAddNotification","WAWebFormatAllowNonAdminSubGroupCreationNotification","WAWebFormatAnnounceNotification","WAWebFormatCommunityOwnerUpdateNotification","WAWebFormatCreateNotification","WAWebFormatCreatedSubgroupSuggestionNotification","WAWebFormatDeleteNotification","WAWebFormatDescriptionNotification","WAWebFormatEphemeralSetting","WAWebFormatLeaveNotification","WAWebFormatLinkNotification","WAWebFormatMembershipApprovalNotification","WAWebFormatParticipantNames","WAWebFormatPictureNotification","WAWebFormatPromoteDemoteNotification","WAWebFormatRemoveNotification","WAWebFormatReportToAdminNotification","WAWebFormatRestrictNotification","WAWebFormatSubjectNotification","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebL10N","WAWebMessageCommunityEmptySubgroupWelcomeTitle.react","WAWebMessageCommunityGeneralChatAutoAddDisabledNotification.react","WAWebMessageCommunityGeneralChatWelcomeTitle.react","WAWebMessageCommunityLinkGroup.react","WAWebMessageCommunitySubgroupWelcome.react","WAWebMessageCommunityWelcomeAdmin.react","WAWebMessageCommunityWelcomeMember.react","WAWebUserPrefsMeUser","WAWebWidFormat"],(function(t,n,r,o,a,i,l,s){var e;function u(t,n){var a="",i=t.get("type");if(i!=="gp2")return a;var l=t.get("subtype"),u=t.displayName(),c=t.get("author"),d=t.get("body"),m,p,_=!!n,f=t.recipients||[],g=o("WAWebFormatParticipantNames").getFormattedNames(f,!1),h=f[0],y=h?o("WAWebContactCollection").ContactCollection.get(h):void 0,C=y?o("WAWebFrontendContactGetters").getFormattedName(y):h?o("WAWebWidFormat").widToFormattedUser(h):"";switch(l){case"add":a=o("WAWebFormatAddNotification").formatAddNotification({author:c,authorClickable:u,subject:h,subjectClickable:C,participantsClickable:g});break;case"remove":a=o("WAWebFormatRemoveNotification").formatRemoveNotification({author:c,authorClickable:u,subject:h,subjectClickable:C,participantsClickable:g});break;case"leave":a=o("WAWebFormatLeaveNotification").formatLeaveNotification({body:d,subject:h,participantsClickable:g});break;case"picture":a=o("WAWebFormatPictureNotification").formatPictureNotification({author:c,authorClickable:u,body:d});break;case"subject":a=o("WAWebFormatSubjectNotification").formatSubjectNotification(o("WAWebFrontendMsgGetters").getChat(t),c,u,d);break;case"modify":m=o("WAWebWidFormat").widToFormattedUser(c),p=o("WAWebWidFormat").widToFormattedUser(h),a=m===u?s._(/*BTDS*/"{name} cambi\u00f3 a {new_number}",[s._param("name",u),s._param("new_number",p)]):s._(/*BTDS*/"{name} cambi\u00f3 su n\u00famero de tel\u00e9fono.",[s._param("name",u)]);break;case"create":a=o("WAWebFormatCreateNotification").formatCreateNotification({author:c,authorClickable:u,groupSubject:d,groupSubjectAsString:!0});break;case"delete":a=o("WAWebFormatDeleteNotification").formatDeleteNotification({chat:o("WAWebFrontendMsgGetters").getChat(t)});break;case"promote":case"demote":case"linked_group_promote":case"linked_group_demote":a=o("WAWebFormatPromoteDemoteNotification").formatPromoteDemoteNotification({subtype:l,subject:h,subjectClickable:C,participantsClickable:g,participantsCount:f.length});break;case"invite":a=o("WAWebUserPrefsMeUser").isMeAccount(h)?s._(/*BTDS*/"Te uniste a trav\u00e9s de un enlace de invitaci\u00f3n"):s._(/*BTDS*/"{name} se uni\u00f3 a trav\u00e9s de un enlace de invitaci\u00f3n",[s._param("name",C)]);break;case"revoke_invite":a=o("WAWebUserPrefsMeUser").isMeAccount(c)?s._(/*BTDS*/"Restableciste el enlace de invitaci\u00f3n de este grupo. Haz clic para ver el nuevo enlace de invitaci\u00f3n."):s._(/*BTDS*/"{name} restableci\u00f3 el enlace de invitaci\u00f3n de este grupo. Haz clic para ver el nuevo enlace de invitaci\u00f3n.",[s._param("name",u)]);break;case"description":a=o("WAWebFormatDescriptionNotification").formatDescriptionNotification({author:c,authorClickable:u,shouldFormatAsLastMsg:_});break;case"parent_group_description":a=o("WAWebFormatDescriptionNotification").formatDescriptionNotification({author:c,authorClickable:u,isParentGroup:!0,shouldFormatAsLastMsg:_});break;case"announce":a=o("WAWebFormatAnnounceNotification").formatAnnounceNotification({author:c,authorClickable:u,body:d});break;case"restrict":a=o("WAWebFormatRestrictNotification").formatRestrictNotification({author:c,authorClickable:u,templateParams:t.templateParams});break;case"no_frequently_forwarded":d==="on"?a=o("WAWebUserPrefsMeUser").isMeAccount(c)?s._(/*BTDS*/"Cambiaste los ajustes de este grupo para no permitir los mensajes reenviados muchas veces."):s._(/*BTDS*/"{name} cambi\u00f3 los ajustes de este grupo para no permitir los mensajes reenviados muchas veces.",[s._param("name",u)]):a=o("WAWebUserPrefsMeUser").isMeAccount(c)?s._(/*BTDS*/"Cambiaste los ajustes de este grupo para permitir mensajes reenviados muchas veces."):s._(/*BTDS*/"{name} cambi\u00f3 los ajustes de este grupo para permitir mensajes reenviados muchas veces.",[s._param("name",u)]);break;case"announce_msg_bounce":a=s._(/*BTDS*/"Solo los administradores pueden enviar mensajes a este grupo.");break;case"v4_add_invite_sent":a=s._(/*BTDS*/"Invitaste a {participants}.",[s._param("participants",g)]).toString();break;case"v4_add_invite_join":a=s._(/*BTDS*/"Se unieron {participants} con tu invitaci\u00f3n.",[s._param("participants",g)]).toString();break;case"ephemeral":return o("WAWebFormatEphemeralSetting").formatEphemeralSetting(t);case"growth_locked":a=s._(/*BTDS*/"El enlace de invitaci\u00f3n ya no est\u00e1 disponible. Haz clic para obtener m\u00e1s informaci\u00f3n.");break;case"growth_unlocked":a=s._(/*BTDS*/"El enlace de invitaci\u00f3n est\u00e1 disponible otra vez. Haz clic para ver el nuevo enlace de invitaci\u00f3n.");break;case"linked_group_join":case"parent_group_link":case"sibling_group_link":case"sub_group_link":case"parent_group_unlink":case"sibling_group_unlink":case"sub_group_unlink":case"integrity_parent_group_unlink":case"delete_parent_group":case"delete_parent_group_unlink":case"auto_add":case"default_sub_group_admin_add":case"invite_auto_add":{var b=o("WAWebFormatLinkNotification").formatLinkNotifAsFbt(l,c,h,t.templateParams);b!=null&&(a=b);break}case"community_participant_add_rich":case"community_invite_rich":case"community_invite_auto_add_rich":case"subgroup_admin_triggered_auto_add":case"subgroup_admin_triggered_invite_auto_add":a=o("WAWebMessageCommunityWelcomeMember.react").communityWelcomeMemberTitle();break;case"sub_group_participant_add_rich":case"sub_group_invite_rich":a=o("WAWebMessageCommunitySubgroupWelcome.react").communitySubgroupWelcomeTitle({templateParams:t.templateParams,clickable:!1,author:c});break;case"community_link_parent_group_rich":a=o("WAWebMessageCommunityLinkGroup.react").communityLinkGroupTitle({templateParams:t.templateParams,clickable:!1,author:c});break;case"community_create":a=o("WAWebMessageCommunityWelcomeAdmin.react").communityWelcomeAdminTitle({templateParams:t.templateParams,author:c,chat:o("WAWebFrontendMsgGetters").getChat(t)});break;case"membership_approval_mode":case"membership_approval_request":case"created_membership_requests":a=o("WAWebFormatMembershipApprovalNotification").formatMembershipApprovalNotification(l,c,t.templateParams);break;case"ephemeral_keep_in_chat":a=s._(/*BTDS*/"Ahora est\u00e1 disponible la opci\u00f3n de conservar mensajes temporales en el chat. Haz clic para obtener m\u00e1s informaci\u00f3n.");break;case"initial_pHash_mismatch":case"default_sub_group_promote":case"default_sub_group_demote":o("WAWebChatGroupUtils").isCommunityAnnouncementGroup(o("WAWebFrontendMsgGetters").getChat(t))?a=s._(/*BTDS*/"Se produjo un cambio en los miembros de la comunidad. Haz clic para verlo."):a=s._(/*BTDS*/"Se produjo un cambio en los miembros del grupo. Haz clic para verlo.");break;case"allow_admin_reports":a=o("WAWebFormatReportToAdminNotification").formatReportToAdminNotification(c,t.templateParams);break;case"allow_non_admin_sub_group_creation":a=r("WAWebFormatAllowNonAdminSubGroupCreationNotification")(o("WAWebFrontendMsgGetters").getChat(t),t.templateParams);break;case"empty_subgroup_create":{var v=t.templateParams[2];a=o("WAWebMessageCommunityEmptySubgroupWelcomeTitle.react").communityEmptySubgroupWelcomeTitle(v);break}case"created_subgroup_suggestion":{a=r("WAWebFormatCreatedSubgroupSuggestionNotification")(c,t.templateParams,!1);break}case"general_chat_add":{var S=t.templateParams[1];a=o("WAWebMessageCommunityGeneralChatWelcomeTitle.react").communityGeneralChatWelcomeTitle(S);break}case"general_group_auto_add_disabled":{a=o("WAWebMessageCommunityGeneralChatAutoAddDisabledNotification.react").communityGeneralChatAutoAddDisabledNotification(o("WAWebFrontendMsgGetters").getChat(t).formattedTitle,t.templateParams);break}case"community_owner_update":{a=o("WAWebFormatCommunityOwnerUpdateNotification").formatCommunityOwnerUpdateNotification({author:c,templateParams:t.templateParams,clickable:!1});break}default:o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["wa:formatGroupNotification:unknown message subtype: ",""])),l);break}return r("WAWebL10N").isRTL()&&(a=r("WAWebL10N").forceRTL(String(a))),a}l.default=u}),226);
__d("WAWebFormatLeaveNotification",["fbt","WAWebGroupType","WAWebSystemMessagesUtils"],(function(t,n,r,o,a,i,l,s){function e(e){var t=e.body,n=e.subject,r=e.participantsClickable;return n?o("WAWebSystemMessagesUtils").isMe(n)?s._(/*BTDS*/"Saliste del grupo"):s._(/*BTDS*/"{user_name} sali\u00f3 del grupo.",[s._param("user_name",r)]):t===o("WAWebGroupType").DELETE_REASON.INTEGRITY_DELETE_PARENT?s._(/*BTDS*/"Esta comunidad ya no est\u00e1 disponible."):s._(/*BTDS*/"Se cerr\u00f3 este grupo.")}l.formatLeaveNotification=e}),226);
__d("WAWebStringsWithMultiplePluralParts",["fbt"],(function(t,n,r,o,a,i,l,s){function e(e,t){return s._(/*BTDS*/"_j{\"*\":{\"*\":\"No se pudieron reenviar {count} mensajes porque {contact} tiene una versi\\u00f3n de WhatsApp que no es compatible.\"},\"_1\":{\"_1\":\"No se pudo reenviar 1 mensaje porque {contact} tiene una versi\\u00f3n de WhatsApp que no es compatible.\"}}",[s._plural(e,"count"),s._plural(e),s._param("contact",t)]).toString()}function u(e,t){return s._(/*BTDS*/"_j{\"*\":{\"*\":\"No se pudieron reenviar {count} mensajes porque el archivo no existe o {contact} tiene una versi\\u00f3n de WhatsApp que no es compatible.\"},\"_1\":{\"_1\":\"No se pudo reenviar 1 mensaje porque el archivo no existe o {contact} tiene una versi\\u00f3n de WhatsApp que no es compatible.\"}}",[s._plural(e,"count"),s._plural(e),s._param("contact",t)]).toString()}function c(e,t){return d(e,t).toString()}function d(e,t){return s._(/*BTDS*/"_j{\"*\":{\"*\":\"Se a\\u00f1adieron los grupos {group-names}.\"},\"_1\":{\"_1\":\"Se a\\u00f1adi\\u00f3 el grupo {group-names}.\"}}",[s._plural(t),s._plural(t),s._param("group-names",e.formattedNames)])}function m(e,t){return p(e,t).toString()}function p(e,t){return s._(/*BTDS*/"_j{\"*\":{\"*\":\"Se eliminaron los grupos {group-names}.\"},\"_1\":{\"_1\":\"Se elimin\\u00f3 el grupo {group-names}.\"}}",[s._plural(t),s._plural(t),s._param("group-names",e.formattedNames)])}l.getCannotForwardCapabilityContactString=e,l.getCannotForwardFileMissingAndCapabilityContactString=u,l.getCommunityGroupsAddedString=c,l.getCommunityGroupsAddedStringComponent=d,l.getCommunityGroupsRemovedString=m,l.getCommunityGroupsRemovedStringComponent=p}),226);
__d("WAWebFormatLinkNotification",["fbt","WALogger","WAWebFormatParticipantNames","WAWebPairList","WAWebStringsWithMultiplePluralParts","WAWebUserPrefsMeUser","WAWebWid"],(function(t,n,r,o,a,i,l,s){var e,u,c,d,m,p,_,f,g,h,y,C,b,v=function(t){return t instanceof r("WAWebWid")&&o("WAWebUserPrefsMeUser").isMeAccount(t)};function S(e){return!e}function R(e,t,n,r){return L(e,t,n,r,!1)}function L(t,n,r,a,i){var l=n?o("WAWebFormatParticipantNames").getFormattedName(n,i,t):null,s=r?o("WAWebFormatParticipantNames").getFormattedName(r,i):null;switch(t){case"parent_group_link":return M(a,i,n,l);case"sibling_group_link":return w(a,i,n,l,t);case"sub_group_link":break;case"parent_group_unlink":return N(a,i,n,l);case"integrity_parent_group_unlink":return P(a,i);case"delete_parent_group_unlink":case"delete_parent_group":return $(a,l,n,i);case"sibling_group_unlink":return A(a,i,n,l);case"sub_group_unlink":break;case"community_create":return F(a,i,n,l);case"linked_group_join":return O(r,s);case"auto_add":case"default_sub_group_admin_add":return B(a,i,l);case"invite_auto_add":return W(a,i,r,s);default:o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["wa:formatLinkNotification:unknown message subtype: ",""])),t);break}}function E(e){return s._(/*BTDS*/"Creaste la comunidad \"{community_name}\".",[s._param("community_name",e)])}function k(){return s._(/*BTDS*/"Creaste la comunidad.")}function I(e,t){return s._(/*BTDS*/"{author} cre\u00f3 la comunidad \"{community_name}\".",[s._param("author",e),s._param("community_name",t)])}function T(e){return s._(/*BTDS*/"{author} cre\u00f3 la comunidad.",[s._param("author",e)])}function D(e){return s._(/*BTDS*/"Se cre\u00f3 la comunidad \"{community_name}\".",[s._param("community_name",e)])}function x(){return s._(/*BTDS*/"Se cre\u00f3 la comunidad.")}function $(e,t,n,r){var a;return e[0]!=null&&typeof e[0]=="string"&&!S(e[0])&&(a=o("WAWebFormatParticipantNames").getClickableDeactivatedCommunityName(e[0],r)),a!=null&&t!=null?v(n)?(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["generateDeleteParentGroupNotification: render community deactivate, I am author"]))),s._(/*BTDS*/"Desactivaste la comunidad {community}.",[s._param("community",o("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(a,!r))])):(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["generateDeleteParentGroupNotification: render community deactivate, I am not author"]))),s._(/*BTDS*/"{author} desactiv\u00f3 la comunidad {community}.",[s._param("author",t),s._param("community",o("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(a,!r))])):v(n)?s._(/*BTDS*/"Desactivaste una comunidad."):t!=null?s._(/*BTDS*/"{author} desactiv\u00f3 una comunidad.",[s._param("author",t)]):s._(/*BTDS*/"Se desactiv\u00f3 una comunidad.")}function P(e,t){var n=o("WAWebFormatParticipantNames").getClickableIntegrityDeactivateCommunityName(e[0],e[1],t,!0);return n!=null?(o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["generateIntegrityParentGroupUnlinkNotification"]))),s._(/*BTDS*/"Este grupo ya no forma parte de la comunidad {community}.",[s._param("community",o("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(n,!t))])):s._(/*BTDS*/"Este grupo ya no forma parte de una comunidad.")}function N(e,t,n,r){var a=babelHelpers.arrayLikeToArray(e).slice(0),i=o("WAWebFormatParticipantNames").getFormattedCommunityNameWithAlternative({jid:a[0],asString:!t,alternativeStringName:a[1]});return i!=null&&v(n)?(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["generateParentGroupUnlinkNotification, I am author"]))),s._(/*BTDS*/"Eliminaste este grupo de la comunidad {community}.",[s._param("community",o("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(i,!t))])):i==null&&v(n)?s._(/*BTDS*/"Eliminaste este grupo de una comunidad."):i!=null&&n!=null?(o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["generateParentGroupUnlinkNotification, I am not author"]))),s._(/*BTDS*/"{author} elimin\u00f3 este grupo de la comunidad {community}.",[s._param("author",r),s._param("community",o("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(i,!t))])):i!=null&&n==null?(o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["generateParentGroupUnlinkNotification, no author"]))),s._(/*BTDS*/"Se elimin\u00f3 este grupo de la comunidad {community}.",[s._param("community",o("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(i,!t))])):i==null&&n!=null?s._(/*BTDS*/"{author} elimin\u00f3 este grupo de una comunidad.",[s._param("author",r)]):s._(/*BTDS*/"Se elimin\u00f3 este grupo de una comunidad.")}function M(e,t,n,r){var a=o("WAWebFormatParticipantNames").getFormattedCommunityNameWithAlternative({jid:e[0],asString:!t,alternativeStringName:e[1]});return!S(a)&&v(n)?(o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["generateParentGroupLinkNotification, I am author"]))),s._(/*BTDS*/"A\u00f1adiste este grupo y a sus miembros a la comunidad {community}.",[s._param("community",o("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(a,!t))])):S(a)&&v(n)?s._(/*BTDS*/"A\u00f1adiste este grupo y a sus miembros a una comunidad."):!S(a)&&n!=null?(o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["generateParentGroupLinkNotification, I am not author"]))),s._(/*BTDS*/"{author} a\u00f1adi\u00f3 este grupo y a sus miembros a la comunidad {community}.",[s._param("author",r),s._param("community",o("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(a,!t))])):!S(a)&&n==null?(o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["generateParentGroupLinkNotification, no author"]))),s._(/*BTDS*/"Se a\u00f1adi\u00f3 este grupo y a sus miembros a la comunidad {community}.",[s._param("community",o("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(a,!t))])):S(a)&&n!=null?s._(/*BTDS*/"{author} a\u00f1adi\u00f3 este grupo y a sus miembros a una comunidad.",[s._param("author",r)]):s._(/*BTDS*/"Se a\u00f1adi\u00f3 este grupo y a sus miembros a una comunidad.")}function w(e,t,n,r,a){var i=babelHelpers.arrayLikeToArray(e).slice(0),l=o("WAWebFormatParticipantNames").getFormattedGroupListForCommunity(i,!t,a),u=o("WAWebPairList").unFlattenPairList(i).length;return n!=null&&!v(n)?l==null?s._(/*BTDS*/"_j{\"*\":\"{author} a\\u00f1adi\\u00f3 {count} grupos.\",\"4\":\"{author} a\\u00f1adi\\u00f3 {count} grupo.\",\"_1\":\"{author} a\\u00f1adi\\u00f3 1 grupo.\"}",[s._plural(u,"count"),s._param("author",r)]):s._(/*BTDS*/"_j{\"*\":\"{author} a\\u00f1adi\\u00f3 los grupos {groups}.\",\"_1\":\"{author} a\\u00f1adi\\u00f3 el grupo {groups}.\"}",[s._plural(u),s._param("author",r),s._param("groups",l)]):l==null?s._(/*BTDS*/"_j{\"*\":\"Se a\\u00f1adieron {count} grupos.\",\"4\":\"Se a\\u00f1adi\\u00f3 {count} grupo.\",\"_1\":\"Se a\\u00f1adi\\u00f3 1 grupo.\"}",[s._plural(u,"count")]):t?o("WAWebStringsWithMultiplePluralParts").getCommunityGroupsAddedStringComponent({formattedNames:l,count:u},u):o("WAWebStringsWithMultiplePluralParts").getCommunityGroupsAddedString({formattedNames:l},u)}function A(e,t,n,r){var a=babelHelpers.arrayLikeToArray(e).slice(0),i=o("WAWebFormatParticipantNames").getFormattedGroupListForCommunity(a,!t),l=o("WAWebPairList").unFlattenPairList(a).length;return n!=null&&!v(n)?i==null?s._(/*BTDS*/"_j{\"*\":\"{author} elimin\\u00f3 {count} grupos.\",\"4\":\"{author} elimin\\u00f3 {count} grupo.\",\"_1\":\"{author} elimin\\u00f3 1 grupo.\"}",[s._plural(l,"count"),s._param("author",r)]):s._(/*BTDS*/"_j{\"*\":\"{author} elimin\\u00f3 los grupos {groups}.\",\"_1\":\"{author} elimin\\u00f3 el grupo {groups}.\"}",[s._plural(l),s._param("author",r),s._param("groups",i)]):i==null?s._(/*BTDS*/"_j{\"*\":\"Se eliminaron {count} grupos.\",\"4\":\"Se elimin\\u00f3 {count} grupo.\",\"_1\":\"Se elimin\\u00f3 1 grupo.\"}",[s._plural(l,"count")]):t?o("WAWebStringsWithMultiplePluralParts").getCommunityGroupsRemovedStringComponent({formattedNames:i,count:l},l):o("WAWebStringsWithMultiplePluralParts").getCommunityGroupsRemovedString({formattedNames:i},l)}function F(e,t,n,r){var a=o("WAWebFormatParticipantNames").getFormattedCommunityNameWithAlternative({jid:e[0],asString:!t,alternativeStringName:e[1]});return S(a)?r!=null?T(r):v(n)?k():x():v(n)?E(a):r!=null?I(r,a):D(a)}function O(e,t){return v(e)?s._(/*BTDS*/"Te uniste desde la comunidad."):s._(/*BTDS*/"{author} se uni\u00f3 desde la comunidad.",[s._param("author",t)])}function B(e,t,n){if(e&&e.length>=2){var r=o("WAWebFormatParticipantNames").getFormattedCommunityNameWithAlternative({jid:e[0],asString:!t,alternativeStringName:e[1]});return S(r)?s._(/*BTDS*/"{author} te a\u00f1adi\u00f3 a este grupo y a la comunidad.",[s._param("author",n)]):(o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["generateAddNotification"]))),s._(/*BTDS*/"{author} te a\u00f1adi\u00f3 a este grupo y a la comunidad {community}.",[s._param("author",n),s._param("community",o("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(r,!t))]))}return s._(/*BTDS*/"{author} te a\u00f1adi\u00f3.",[s._param("author",n)])}function W(e,t,n,r){var a,i=!1;return e&&e.length>=3&&(a=o("WAWebFormatParticipantNames").getFormattedNameIfExists(e[0]),a==null&&(a=e[1]),e[2]==="true"&&(i=!0)),i?v(n)?S(a)?s._(/*BTDS*/"Se te a\u00f1adi\u00f3 al grupo."):(o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["generateInviteAutoAddNotification, I am subject, has subgroup name"]))),s._(/*BTDS*/"Se te a\u00f1adi\u00f3 porque te uniste al grupo {group-name}.",[s._param("group-name",o("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(a,!t))])):s._(/*BTDS*/"{user_name} se uni\u00f3.",[s._param("user_name",r)]):v(n)?S(a)?s._(/*BTDS*/"Se te a\u00f1adi\u00f3 a esta comunidad."):(o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["generateInviteAutoAddNotification, I am subject, not part of community"]))),s._(/*BTDS*/"Se te a\u00f1adi\u00f3 a esta comunidad porque te uniste al grupo {group-name}.",[s._param("group-name",o("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(a,!t))])):s._(/*BTDS*/"{user_name} se uni\u00f3.",[s._param("user_name",r)])}l.formatLinkNotifAsFbt=R,l.formatLinkNotification=L}),226);
__d("WAWebFormatMembershipApprovalNotification",["fbt","WALogger","WAWebFbtIntlList","WAWebFormatParticipantNames","WAWebGroupType","WAWebSystemMessageGatingUtils","WAWebUserPrefsMeUser","WAWebWamEnumSystemMessageTypeType","WAWebWidFactory"],(function(t,n,r,o,a,i,l,s){var e;function u(t,n,a){var i=o("WAWebSystemMessageGatingUtils").systemMessageActionTextStylingEnabled(),l;switch(n&&(l=o("WAWebFormatParticipantNames").getFormattedName(n,!1)),t){case"membership_approval_mode":{var u=a[0]&&o("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.cast(a[0].toString())===o("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.On,c=a[1]&&o("WAWebGroupType").GroupSettingChangeSystemMessageIsAdmin.cast(a[1].toString())===o("WAWebGroupType").GroupSettingChangeSystemMessageIsAdmin.Admin;return u?l==null?{text:c?s._(/*BTDS*/"Los nuevos miembros necesitan la aprobaci\u00f3n de un administrador para unirse a este grupo. Haz clic para cambiar esto."):s._(/*BTDS*/"Los nuevos miembros necesitan la aprobaci\u00f3n de un administrador para unirse a este grupo.")}:o("WAWebUserPrefsMeUser").isMeAccount(n)?{text:s._(/*BTDS*/"Activaste la aprobaci\u00f3n de los admin. para unirse a este grupo. Haz clic para cambiar esto.")}:{text:c?s._(/*BTDS*/"{author} activ\u00f3 la aprobaci\u00f3n de los admin. para unirse a este grupo. Haz clic para cambiar esto.",[s._param("author",l)]):s._(/*BTDS*/"{author} activ\u00f3 la aprobaci\u00f3n de los admin. para unirse a este grupo.",[s._param("author",l)])}:l==null?{text:s._(/*BTDS*/"Se desactiv\u00f3 la aprobaci\u00f3n de los administradores para unirse a este grupo.")}:o("WAWebUserPrefsMeUser").isMeAccount(n)?{text:s._(/*BTDS*/"Desactivaste la aprobaci\u00f3n de los admin. para unirse a este grupo. Haz clic para cambiar esto.")}:{text:c?s._(/*BTDS*/"{author} desactiv\u00f3 la aprobaci\u00f3n de los admin. para unirse a este grupo. Haz clic para cambiar esto.",[s._param("author",l)]):s._(/*BTDS*/"{author} desactiv\u00f3 la aprobaci\u00f3n de los admin. para unirse a este grupo.",[s._param("author",l)])}}case"membership_approval_request":return{text:i?s._(/*BTDS*/"{author} solicit\u00f3 unirse.",[s._param("author",l)]):s._(/*BTDS*/"{author} solicit\u00f3 unirse. Haz clic para revisar esto.",[s._param("author",l)]),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.GROUP_JOIN_REQUEST};case"created_membership_requests":{var d=a.map(function(e){return o("WAWebFormatParticipantNames").getFormattedName(o("WAWebWidFactory").createWid(e.toString()),!1)}),m=d[0],p=babelHelpers.arrayLikeToArray(d).slice(1),_=r("WAWebFbtIntlList")(p,r("WAWebFbtIntlList").CONJUNCTIONS.NONE,r("WAWebFbtIntlList").DELIMITERS.COMMA);return{text:i?s._(/*BTDS*/"{author} solicit\u00f3 a\u00f1adir a {authors}.",[s._param("author",m),s._param("authors",_)]):s._(/*BTDS*/"{author} solicit\u00f3 a\u00f1adir a {authors}. Haz clic para revisar esto.",[s._param("author",m),s._param("authors",_)]),enumType:o("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.GROUP_JOIN_REQUEST}}default:o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["wa:formatMembershipApprovalNotification:unknown message subtype: ",""])),t);break}return{text:""}}function c(e,t,n){return u(e,t,n).text}l.formatMembershipApprovalNotification=c}),226);
__d("WAWebL10NEnumeration.react",["fbt"],(function(t,n,r,o,a,i,l,s){function e(e,t){if(t===void 0&&(t=!1),e.length===0)return"";var n=e[0];if(e.length===1){var r=s._(/*BTDS*/"\"{A}\"",[s._param("A",n)]);return t?r.toString():r}var o=e[e.length-1];if(e.length===2)return u(n,o,t);var a=e.slice(0,e.length-2),i=e[e.length-2];return c(a,i,o,t)}function u(e,t,n){n===void 0&&(n=!1);var r=s._(/*BTDS*/"\"{A}\" y \"{B}\"",[s._param("A",e),s._param("B",t)]);return n?r.toString():r}function c(e,t,n,r){r===void 0&&(r=!1);var o=function(t,n){return s._(/*BTDS*/"\"{A}\", {B}",[s._param("A",n),s._param("B",t)])},a=e.reverse(),i=r?a.reduce(function(e,t){return o(e,t).toString()},""):a.reduce(function(e,t){return o(e,t)},null),l=s._(/*BTDS*/"{A}\"{B}\" y \"{C}\"",[s._param("A",i),s._param("B",t),s._param("C",n)]);return r?l.toString():l}l.default=e}),226);
__d("WAWebFormatParticipantNames",["fbt","WAWebClickableLink.react","WAWebCmd","WAWebCommunityGroupJourneyEventImpl","WAWebComposeBoxActions","WAWebConfirmPopup.react","WAWebContactCollection","WAWebEmojiText.react","WAWebFbtIntlList","WAWebFindChatAction","WAWebGroupMetadataCollection","WAWebL10NEnumeration.react","WAWebModalManager","WAWebName.react","WAWebPairList","WAWebReachoutTimelockRestrictedModalLoadable","WAWebReachoutTimelockUtils","WAWebSuspendedCommunityUtils","WAWebToast.react","WAWebToastManager","WAWebUnjoinedSubgroupMetadataCollection","WAWebWamEnumChatFilterActionTypes","WAWebWamEnumSurfaceType","fbs","react"],(function(t,n,r,o,a,i,l,s){var e,u=e||(e=r("react")),c={linkColor:{color:"x1bvqhpb",$$css:!0}};function d(e,t){return function(n){n&&(n.preventDefault(),n.stopPropagation()),o("WAWebFindChatAction").findOrCreateLatestChat(e,"formatParticipantNames").then(function(e){var n=e.chat;if(o("WAWebReachoutTimelockUtils").isUserReachoutTimelocked()&&!o("WAWebReachoutTimelockUtils").canSendMsgWhileTimelocked({chat:n,contact:n.contact})){o("WAWebModalManager").ModalManager.open(u.jsx(o("WAWebReachoutTimelockRestrictedModalLoadable").ReachoutTimelockRestrictedModalLoadable,{}));return}t==="sibling_group_link"&&new(o("WAWebCommunityGroupJourneyEventImpl")).CommunityGroupJourneyEvent({action:o("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES.GROUP_SYSTEM_MESSAGE_CLICK,surface:o("WAWebWamEnumSurfaceType").SURFACE_TYPE.CHAT,chat:n}).commit(),o("WAWebCmd").Cmd.openChatFromUnread({chat:n}).then(function(e){e&&o("WAWebComposeBoxActions").ComposeBoxActions.focus(n)})})}}function m(e){return function(t){t&&(t.preventDefault(),t.stopPropagation()),o("WAWebCmd").Cmd.openCommunityHome(e,void 0)}}function p(e){return function(t){t&&(t.preventDefault(),t.stopPropagation()),o("WAWebCmd").Cmd.openCommunityTabbedInfo(e,void 0,!1,!0)}}function _(e){return function(t){t&&(t.preventDefault(),t.stopPropagation()),o("WAWebModalManager").ModalManager.open(u.jsx(o("WAWebConfirmPopup.react").ConfirmPopup,{onOK:function(){return o("WAWebModalManager").ModalManager.close()},children:s._(/*BTDS*/"Ya no eres miembro de la comunidad \"{community}\".",[s._param("community",u.jsx(o("WAWebName.react").Name,{contact:e}))])}))}}function f(){o("WAWebToastManager").ToastManager.open(u.jsx(o("WAWebToast.react").Toast,{msg:s._(/*BTDS*/"Esta comunidad ya no existe.")}))}function g(e,t){return t?u.jsx(r("WAWebClickableLink.react"),{onClick:f,xstyle:c.linkColor,children:u.jsx(o("WAWebEmojiText.react").EmojiText,{text:e})}):e}function h(e,t,n,r){var a=o("WAWebContactCollection").ContactCollection.get(e.toString());return r===!1&&a!=null?L(e,n?m(e):null):t==null||t===""?null:r===!1&&n?u.jsx(o("WAWebEmojiText.react").EmojiText,{text:t,onClick:o("WAWebSuspendedCommunityUtils").openTerminatedCommunityModal}):t}function y(e,t){t===void 0&&(t=!1);var n=o("WAWebContactCollection").ContactCollection.get(e.toString());if(!n)return null;if(t)return n.name;var a=r("WAWebGroupMetadataCollection").get(e),i=m(e);return a!=null&&a.joinedSubgroups.length||(i=_(n)),L(e,i)}function C(e,t){return t?r("fbs")._(/*BTDS*/"\"{community-name}\"",[r("fbs")._param("community-name",e)]):u.jsx("span",{className:"xuxw1ft",children:s._(/*BTDS*/"\"{community-name}\"",[s._param("community-name",e)])})}function b(e){var t=e.jid,n=e.asString,r=n===void 0?!1:n,a=e.alternativeStringName,i=y(t,r);return i==null&&a?g(a,!r):typeof i=="string"&&!r?u.jsx(o("WAWebEmojiText.react").EmojiText,{text:i}):i}function v(e,t,n){if(t===void 0&&(t=!1),o("WAWebContactCollection").ContactCollection.get(e.toString())!=null&&!t)return L(e,d(e,n));var a=r("WAWebUnjoinedSubgroupMetadataCollection").get(e.toString());return a!=null&&a.subject?a.subject:null}function S(e,t,n){t===void 0&&(t=!1);var a=o("WAWebPairList").unFlattenPairList(e).map(function(e){var r=e[0],o=e[1],a=v(r,t,n);return a!==""&&a!=null?a:o});return r("WAWebL10NEnumeration.react")(a,t)}function R(e,t,n){if(t===void 0&&(t=!0),!e.isUser())return L(e,t?d(e,n):null);var r=t?d(e,n):null;return L(e,r)}function L(e,t){var n=o("WAWebContactCollection").ContactCollection.gadd(e,{silent:!0});return u.jsx(o("WAWebName.react").Name,{contact:n,showNotifyName:!0,elevatedPushNamesEnabled:!0,onClick:t})}L.displayName=L.name+" [from "+i.id+"]";function E(e,t,n){if(t===void 0&&(t=!0),n===void 0&&(n=!1),!Array.isArray(e))return R(e,t);var o=e.map(function(e){return R(e,t)});return r("WAWebFbtIntlList")(o,n?r("WAWebFbtIntlList").CONJUNCTIONS.NONE:r("WAWebFbtIntlList").CONJUNCTIONS.AND,r("WAWebFbtIntlList").DELIMITERS.COMMA)}l.openCommunity=m,l.openCommunityInfo=p,l.getClickableDeactivatedCommunityName=g,l.getClickableIntegrityDeactivateCommunityName=h,l.getCommunityNameInQuotationMarks=C,l.getFormattedCommunityNameWithAlternative=b,l.getFormattedNameIfExists=v,l.getFormattedGroupListForCommunity=S,l.getFormattedName=R,l.getFormattedNames=E}),226);
__d("WAWebFormatPictureNotification",["fbt","WAWebSystemMessagesUtils"],(function(t,n,r,o,a,i,l,s){function e(e){var t=e.author,n=e.authorClickable,r=e.body;return r==="remove"?o("WAWebSystemMessagesUtils").isMe(t)?s._(/*BTDS*/"Eliminaste la imagen de este grupo."):n!=null?s._(/*BTDS*/"{user_name} elimin\u00f3 la imagen de este grupo.",[s._param("user_name",n)]):s._(/*BTDS*/"Un miembro elimin\u00f3 la imagen de este grupo."):o("WAWebSystemMessagesUtils").isMe(t)?s._(/*BTDS*/"Cambiaste la imagen de este grupo."):n!=null?s._(/*BTDS*/"{user_name} cambi\u00f3 la imagen de este grupo.",[s._param("user_name",n)]):s._(/*BTDS*/"Un miembro cambi\u00f3 la imagen de este grupo.")}l.formatPictureNotification=e}),226);
__d("WAWebFormatPromoteDemoteNotification",["fbt","WALogger","WAWebSystemMessagesUtils"],(function(t,n,r,o,a,i,l,s){var e;function u(t){var n=t.subtype,r=t.participantsCount,a=t.subject,i=t.subjectClickable,l=t.participantsClickable;switch(n){case"promote":return r===1&&o("WAWebSystemMessagesUtils").isMe(a)?s._(/*BTDS*/"Ahora eres admin. del grupo."):s._(/*BTDS*/"_j{\"*\":\"{participant_names} ahora son administradores.\",\"_1\":\"{participant_names} ahora es admin.\"}",[s._plural(r),s._param("participant_names",l)]);case"demote":return r===1&&o("WAWebSystemMessagesUtils").isMe(a)?s._(/*BTDS*/"Ya no eres admin. del grupo"):s._(/*BTDS*/"_j{\"*\":\"{participant_names} ya no son administradores\",\"_1\":\"{participant_names} ya no es admin.\"}",[s._plural(r),s._param("participant_names",l)]);case"linked_group_promote":return o("WAWebSystemMessagesUtils").isMe(a)?s._(/*BTDS*/"Ahora eres admin. de la comunidad."):s._(/*BTDS*/"{name} ahora es admin. de la comunidad.",[s._param("name",i)]);case"linked_group_demote":return o("WAWebSystemMessagesUtils").isMe(a)?s._(/*BTDS*/"Ya no eres admin. de la comunidad."):s._(/*BTDS*/"{name} ya no es admin. de la comunidad.",[s._param("name",i)]);default:return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["wa:formatPromoteDemoteNotification:unknown message subtype: ",""])),n),""}}l.formatPromoteDemoteNotification=u}),226);
__d("WAWebFormatRemoveNotification",["fbt","WAWebLidMigrationUtils","WAWebSystemMessagesUtils","WAWebWid"],(function(t,n,r,o,a,i,l,s){function e(e){var t=e.author,n=e.authorClickable,a=e.subject,i=e.subjectClickable,l=e.participantsClickable;return t?r("WAWebWid").equals.apply(r("WAWebWid"),o("WAWebLidMigrationUtils").toCommonAddressingMode(t,a))?s._(/*BTDS*/"Se te elimin\u00f3 del grupo"):o("WAWebSystemMessagesUtils").isMe(t)?s._(/*BTDS*/"Eliminaste a {names}.",[s._param("names",l)]):o("WAWebSystemMessagesUtils").isMe(a)?n!=null?s._(/*BTDS*/"{user_name} te elimin\u00f3.",[s._param("user_name",n)]):s._(/*BTDS*/"Un miembro te elimin\u00f3."):n!=null?s._(/*BTDS*/"{user_name} elimin\u00f3 a {names}.",[s._param("user_name",n),s._param("names",l)]):s._(/*BTDS*/"Un miembro elimin\u00f3 a {names}.",[s._param("names",l)]):o("WAWebSystemMessagesUtils").isMe(a)?s._(/*BTDS*/"Se te elimin\u00f3 del grupo"):s._(/*BTDS*/"Se elimin\u00f3 a {user_name}.",[s._param("user_name",i)])}l.formatRemoveNotification=e}),226);
__d("WAWebFormatReportToAdminNotification",["fbt","WAWebFormatParticipantNames","WAWebGroupType","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l,s){function e(e,t){var n=t[0]&&o("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.cast(t[0].toString())===o("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.On,r=t[1]&&o("WAWebGroupType").GroupSettingChangeSystemMessageIsAdmin.cast(t[1].toString())===o("WAWebGroupType").GroupSettingChangeSystemMessageIsAdmin.Admin,a=o("WAWebUserPrefsMeUser").isMeAccount(e);if(a){var i=s._(/*BTDS*/"Activaste la opci\u00f3n \"Enviar para revisi\u00f3n de admin.\" en este grupo. Haz clic para cambiar esto."),l=s._(/*BTDS*/"Desactivaste la opci\u00f3n \"Enviar para revisi\u00f3n de un administrador\" en este grupo. Haz clic para cambiar esto.");return n?i:l}if(e){var u=o("WAWebFormatParticipantNames").getFormattedName(e,!1),c=s._(/*BTDS*/"{author} activ\u00f3 la opci\u00f3n \"Enviar para revisi\u00f3n de admin.\" en este grupo. Haz clic para cambiar esto.",[s._param("author",u)]),d=s._(/*BTDS*/"{author} desactiv\u00f3 la opci\u00f3n \"Enviar para revisi\u00f3n de un administrador\" en este grupo. Haz clic para cambiar esto.",[s._param("author",u)]),m=s._(/*BTDS*/"{author} activ\u00f3 la opci\u00f3n \"Enviar para revisi\u00f3n de admin.\" en este grupo. Haz clic para obtener m\u00e1s informaci\u00f3n.",[s._param("author",u)]),p=s._(/*BTDS*/"{author} desactiv\u00f3 la opci\u00f3n \"Enviar para revisi\u00f3n de admin.\" en este grupo. Haz clic para obtener m\u00e1s informaci\u00f3n.",[s._param("author",u)]);return r?n?c:d:n?m:p}var _=s._(/*BTDS*/"En este grupo, la opci\u00f3n \"Enviar para revisi\u00f3n de admin.\" est\u00e1 activada. Haz clic para cambiar esto."),f=s._(/*BTDS*/"En este grupo, la opci\u00f3n \"Enviar para revisi\u00f3n de admin.\" est\u00e1 desactivada. Haz clic para cambiar esto."),g=s._(/*BTDS*/"La opci\u00f3n \"Enviar para revisi\u00f3n de admin.\" est\u00e1 activada en este grupo. Haz clic para obtener m\u00e1s informaci\u00f3n."),h=s._(/*BTDS*/"La opci\u00f3n \"Enviar para revisi\u00f3n de admin.\" est\u00e1 desactivada en este grupo. Haz clic para obtener m\u00e1s informaci\u00f3n.");return r?n?_:f:n?g:h}l.formatReportToAdminNotification=e}),226);
__d("WAWebFormatRestrictNotification",["fbt","WAWebSystemMessagesUtils"],(function(t,n,r,o,a,i,l,s){var e=256;function u(t){var n=t.author,r=t.authorClickable,a=t.templateParams,i=a[0];if(i==="on"){if(a[1]!=null){var l=parseInt(a[1],10)||e;return s._(/*BTDS*/"_j{\"*\":\"Este grupo tiene m\\u00e1s de {threshold} miembros, por eso solo quienes lo administran pueden editar los ajustes.\",\"_1\":\"Este grupo tiene m\\u00e1s de 1 miembro, por eso solo quienes lo administran pueden editar los ajustes.\"}",[s._plural(l,"threshold")])}return o("WAWebSystemMessagesUtils").isMe(n)?s._(/*BTDS*/"Cambiaste los ajustes para que solo los administradores puedan editar las opciones del grupo."):r!=null?s._(/*BTDS*/"{user_name} cambi\u00f3 los ajustes para que solo los administradores puedan editar las opciones del grupo.",[s._param("user_name",r)]):s._(/*BTDS*/"Un miembro cambi\u00f3 los ajustes para que solo los administradores puedan editar las opciones del grupo.")}else if(o("WAWebSystemMessagesUtils").isMe(n))return s._(/*BTDS*/"Cambiaste los ajustes para que todos los miembros puedan editar las opciones del grupo.");return r!=null?s._(/*BTDS*/"{user_name} cambi\u00f3 los ajustes para que todos los miembros puedan editar las opciones del grupo.",[s._param("user_name",r)]):s._(/*BTDS*/"Un miembro cambi\u00f3 los ajustes para que todos los miembros puedan editar las opciones del grupo.")}l.formatRestrictNotification=u}),226);
__d("WAWebFormatSubjectNotification",["fbt","WAWebChatGroupUtils","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l,s){function e(e,t,n,r){return o("WAWebChatGroupUtils").isCommunityAnnouncementGroup(e)?o("WAWebUserPrefsMeUser").isMeAccount(t)?s._(/*BTDS*/"Cambiaste el nombre de la comunidad a \"{community_name}\".",[s._param("community_name",r)]):n!=null?s._(/*BTDS*/"{user} cambi\u00f3 el nombre de la comunidad a \"{community_name}\".",[s._param("user",n),s._param("community_name",r)]):s._(/*BTDS*/"Un miembro cambi\u00f3 el nombre de la comunidad a \"{community_name}\".",[s._param("community_name",r)]):o("WAWebUserPrefsMeUser").isMeAccount(t)?s._(/*BTDS*/"Cambiaste el nombre del grupo a \"{group_name}\".",[s._param("group_name",r)]):n!=null?s._(/*BTDS*/"{user} cambi\u00f3 el nombre del grupo a \"{group_name}\".",[s._param("user",n),s._param("group_name",r)]):s._(/*BTDS*/"Un miembro cambi\u00f3 el nombre del grupo a \"{group_name}\".",[s._param("group_name",r)])}l.formatSubjectNotification=e}),226);
__d("WAWebSystemMessagesUtils",["WAWebEmojiText.react","WAWebUserPrefsMeUser","WAWebWid","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){return e instanceof r("WAWebWid")&&o("WAWebUserPrefsMeUser").isMeAccount(e)}function c(e){var t=e.text;return s.jsx(o("WAWebEmojiText.react").EmojiText,{direction:"auto",text:t})}c.displayName=c.name+" [from "+i.id+"]",l.isMe=u,l.FormattedText=c}),98);
__d("WAWebUnformatSerializer",["WAWebFormatSerializer"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(r("WAWebFormatSerializer"));e.onDelimiter=function(){},e.onMutator=function(e,t,n){if(e.unformatDecorations!=null){var r=e.unformatDecorations,o=r.pre,a=r.post;return s([typeof o=="function"?o(n):o].concat(t,[a]))}return s(t)},e.onRoot=function(e){return s(e)},e.onText=function(e){return e};function s(e){return e.filter(Boolean).join("")}l.default=e}),98);
__d("WAWebUnformatMsg",["WAWebCommonMsgUtils","WAWebFormat","WAWebFormatConfiguration","WAWebFrontendMsgGetters","WAWebMiscGatingUtils","WAWebUnformatSerializer"],(function(t,n,r,o,a,i,l){var e;function s(){return e||(e=o("WAWebFormatConfiguration").Unformat({mentions:{}})),e}function u(e,t){var n=t!=null?t:"";if(o("WAWebCommonMsgUtils").isRichResponseMsg(e.type)){var a=o("WAWebFormatConfiguration").RichResponse({links:[],parseHeadlessHeadings:!0,parseHeadings:!1});return r("WAWebFormat")(n,a,r("WAWebUnformatSerializer"))}var i=e.mentionMap(),l=e.groupMentionMap();if(!i&&!l)return c(n);if(o("WAWebMiscGatingUtils").isDropLastNameEnabled()){var s=o("WAWebFrontendMsgGetters").getChat(e).groupMetadata;if(s){var u=o("WAWebFormatConfiguration").FormattedGroupNotification({mentions:i,groupMentions:l,groupMetadata:s});return r("WAWebFormat")(n,u,r("WAWebUnformatSerializer"))}}var d=o("WAWebFormatConfiguration").FormattedNotification({mentions:i,groupMentions:l});return r("WAWebFormat")(n,d,r("WAWebUnformatSerializer"))}function c(e){return r("WAWebFormat")(e,s(),r("WAWebUnformatSerializer"))}l.default=u}),98);
__d("WAWebWidToFormattedNameOrNumber",["WAWebContactCollection","WAWebFrontendContactGetters","WAWebWidFormat"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WAWebContactCollection").ContactCollection.get(e);return t?o("WAWebFrontendContactGetters").getFormattedName(t):o("WAWebWidFormat").widToFormattedUser(e)}l.default=e}),98);
__d("WAWebFrontendChatGetters",["WALogger","WAWebBizGatingUtils","WAWebBotGating","WAWebChatConstants","WAWebChatFlowTypes","WAWebChatGetters","WAWebChatModelDerivedMethods","WAWebConstantsDeprecated","WAWebContactCollection","WAWebFrontendContactGetters","WAWebGetters","WAWebGettersCaches","WAWebGroupType","WAWebHostedGroupUtils","WAWebLastAddOnDBSerialization","WAWebMsgGetters","WAWebMsgType","WAWebPrivacyModeSystemMsg","WAWebWid"],(function(t,n,r,o,a,i,l){var e,s,u=o("WAWebGetters").createGetterFactories({root:(s=o("WAWebChatGetters")).getChatUnsafe,createCache:o("WAWebGettersCaches").createFrontendChatCache}),c=u.field,d=u.computed,m=u.clearCacheFor,p=m,_=c("groupMetadata"),f=c("contact"),g=c("pendingSeenCount",{default:0}),h=c("unreadMsgAnchor"),y=c("composeQuotedMsg"),C=c("composeQuotedMsgRemoteJid"),b=c("quotedMsgAdminGroupJid"),v=c("quotedMsgAdminGroupSubject"),S=c("quotedMsgAdminParentGroupJid"),R=c("msgs"),L=c("msgsLength"),E=c("msgsChanged"),k=c("isParentGroup"),I=c("groupType"),T=c("hasCapi"),D=c("createdLocally"),x=c("pendingDeleteForMeCount"),$=c("attachMediaContents"),P=c("formattedTitle"),N=c("assignedAgent"),M=c("isAssignedToMe",{default:!1}),w=c("mute"),A=c("presence"),F=c("newsletterMetadata"),O=c("promises",{getDefault:function(){return{reportSpamAndBlockSender:void 0,reportSpamBlockClear:void 0,reportSpamExitClear:void 0,sendNotSpam:void 0,sendUnstarAll:void 0,updateSortTime:void 0,setPin:void 0,setArchive:void 0,updateDraftMessage:void 0}}}),B=c("isFavorite",{default:!1}),W=c("trusted"),q=c("active"),U=c("pendingAction"),V=c("pttRecordingSession"),H=c("unopenedByAssignedAgent",{default:!1}),G=c("mmSignalSharingExpirationWindow"),z=d(function(t){var n=t[0],r=t[1],a=t[2],i=t[3],l=t[4],s=t[5];if(r)return s===o("WAWebGroupType").GroupType.COMMUNITY?o("WAWebChatFlowTypes").ChatKindType.Community:o("WAWebChatFlowTypes").ChatKindType.Group;if(a)return o("WAWebChatFlowTypes").ChatKindType.Broadcast;if(i)return o("WAWebChatFlowTypes").ChatKindType.Chat;if(l)return o("WAWebChatFlowTypes").ChatKindType.Newsletter;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["chat:unknown kind id:",""])),n.toLogString())},[s.getId,s.getIsGroup,s.getIsBroadcast,s.getIsUser,s.getIsNewsletter,I]),j=d(function(e){var t=e[0],n=e[1];return t&&n===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP},[s.getIsGroup,I]),K=d(function(e){var t=e[0];return o("WAWebHostedGroupUtils").isWAHostedGroupEnabled()&&t===!0},[T]),Q=d(function(e){var t=e[0],n=e[1];if(!n)return!1;if(t===o("WAWebChatFlowTypes").ChatKindType.Chat){var r=o("WAWebPrivacyModeSystemMsg").getReducedPrivacyMode(n.privacyMode);if(r===o("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.FB||r===o("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.BSP)return!1}return n.isHosted!==!0},[z,f]),X=d(function(e){var t=e[0],n=e[1];return t===r("WAWebConstantsDeprecated").MARKED_AS_UNREAD?t:Math.max(0,t-n)},[s.getUnreadCount,g]),Y=d(function(e){var t=e[0],n=e[1],r=e[2];if(t===0)return!1;if(n){var a=n.msgChunk,i=a?a.getModelsArray():[];return n!==i.find(function(e){return o("WAWebMsgGetters").getIsUnreadType(e)})}var l=r.last(),s=l!=null&&o("WAWebMsgGetters").getIsSentByMe(l);if(s)return!1;if(r.msgLoadState.noEarlierMsgs){var u=r.filter(function(e){return o("WAWebMsgGetters").getIsUnreadType(e)});return u.length!==t}return!0},[s.getUnreadCount,h,R]),J=d(function(e){var t=e[0],n=e[1],a=e[2],i=e[3],l=e[4],s=e[5],u=e[6],c=e[7],d=e[8];if(n||t.isBot()&&!o("WAWebBotGating").isBotEnabled())return!1;if(a)return t.user==="chat"?!0:o("WAWebBizGatingUtils").isBizBroadcastSendWebEnabled();if(r("WAWebWid").isStatus(t)||i===o("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.NOT_INCLUDED_IN_HIST_SYNC&&u.length===0||l&&s===!0)return!1;var m=u.some(function(e){return e.isRealMessage()});return c!==!0||m},[s.getId,s.getIsLocked,s.getIsBroadcast,s.getEndOfHistoryTransferType,s.getIsGroup,k,R,D,L]),Z=d(function(e){for(var t=e[0],n=e[1],r=e[2],a=t.length-1;a>=0;a--){var i=t.at(a);if(i&&o("WAWebChatModelDerivedMethods").isPreviewMessage(i))return i}if(t.length>0)return t.last()},[R,E,x]),ee=d(function(e){var t=e[0],n=e[1],r=e[2],a=e[3];if(!n||!r&&!a)return!1;var i=o("WAWebContactCollection").ContactCollection.get(a||t);return!(i!=null&&o("WAWebFrontendContactGetters").getIsMyContact(i))},[s.getId,s.getIsUser,s.getChangeNumberOldJid,s.getChangeNumberNewJid]),te=d(function(e){var t=e[0],n=e[1];if(t)return t;if(n)return o("WAWebLastAddOnDBSerialization").lastAddOnPreviewFromDeprecatedLastReactionPreview(n)},[s.getChatlistPreview,s.getLastReactionPreview]),ne=d(function(e){var t,n=e[0],r=e[1],o=n==null||(t=n.text)==null?void 0:t.trim();return!!(o!=null&&o!==""||r)},[s.getDraftMessage,$]);l.clearFrontendChatGetterCacheFor=p,l.getGroupMetadata=_,l.getContact=f,l.getComposeQuotedMsg=y,l.getComposeQuotedMsgRemoteJid=C,l.getQuotedMsgAdminGroupJid=b,l.getQuotedMsgAdminGroupSubject=v,l.getQuotedMsgAdminParentGroupJid=S,l.getMsgs=R,l.getIsParentGroup=k,l.getAttachMediaContents=$,l.getFormattedTitle=P,l.getAssignedAgent=N,l.getIsAssignedToMe=M,l.getMute=w,l.getPresence=A,l.getNewsletterMetadata=F,l.getPromises=O,l.getIsFavorite=B,l.getTrusted=W,l.getActive=q,l.getPendingAction=U,l.getPttRecordingSession=V,l.getUnopenedByAssignedAgent=H,l.getMmSignalSharingExpirationWindow=G,l.getKind=z,l.getIsCAG=j,l.getIsCapiHostedGroup=K,l.getIsE2ee=Q,l.getOptimisticUnreadCount=X,l.getShouldShowUnreadDivider=Y,l.getShouldAppearInList=J,l.getPreviewMessage=Z,l.getShowChangeNumberNotification=ee,l.getDerivedLastAddOnPreview=te,l.getHasDraftMessage=ne}),98);
__d("WAWebAnimatedEmojiAssetLoader",["WAConcurrentPriorityPromiseQueue","WALogger","WAWebEmojiConst","WAWebMediaHostsUtil","WAWebPonyfillsFetch","WAWebURLUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u="/wa/static/network_resource",c="nw_media";function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){s=s!=null?s:new Map;var a=new(r("WAConcurrentPriorityPromiseQueue"))(5,{emojis:5}),i=yield o("WAWebMediaHostsUtil").getStaticMediaHostName(),l=""+i+u;o("WAWebEmojiConst").getSupportedAnimatedEmojisAssetIdsMapping(t).forEach((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t[0],i=t[1];try{var u,d=r("WAWebURLUtils").build(l,{cat:c,id:i,_nc_cat:1}),m=yield a.enqueue(function(){return r("WAWebPonyfillsFetch")(d)},{group:"emojis",priority:1}),p=yield m.json();(u=s)==null||u.set(n,p)}catch(t){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["initAnimatedEmojiAssets: Fetching of animated emoji asset failed"]))).devConsole(t)}});return function(e){return t.apply(this,arguments)}})())}),m.apply(this,arguments)}function p(e){var t;return(t=s)==null?void 0:t.get(e)}l.initAnimatedEmojiAssets=d,l.getAnimatedEmojiAsset=p}),98);
__d("WAWebProductCatalogCatalogConstants",[],(function(t,n,r,o,a,i){var e=96,l=120,s=40,u=95;i.PRODUCT_LIST_ITEM_HEIGHT=e,i.CART_PRODUCT_LIST_ITEM_HEIGHT=l,i.MAX_REPLY_PRODUCT_TITLE_LENGTH=s,i.MAX_REPLY_PRODUCT_DESC_LENGTH=u}),66);
__d("WAWebTemplateButtonSubtype",[],(function(t,n,r,o,a,i){var e={QUICK_REPLY:"quick_reply",CALL:"call",URL:"url"};i.TEMPLATE_BUTTON_SUBTYPE=e}),66);
__d("WAWebFrontendMsgGetters",["WABidi","WALogger","WANullthrows","WAWebAck","WAWebAnimatedEmojiAssetLoader","WAWebAnimatedEmojiGatingUtils","WAWebBizSystemMsgSubtypes","WAWebChatCollection","WAWebChatGroupUtils","WAWebCommonMsgUtils","WAWebEmoji","WAWebFormatNfmText","WAWebGetters","WAWebGettersCaches","WAWebL10N","WAWebMessageAssociation.flow","WAWebMsgDataUtils","WAWebMsgGetters","WAWebMsgKey","WAWebMsgModelUtils","WAWebMsgType","WAWebNewsletterCollection","WAWebNewsletterGatingUtils","WAWebNewsletterMembershipUtil","WAWebNonJidMentionType","WAWebOrderStatus","WAWebProductCatalogCatalogConstants","WAWebProtobufsAICommon.pb","WAWebPtvGatingUtils","WAWebTemplateButtonSubtype","WAWebUserPrefsMeUser","lodash"],(function(t,n,r,o,a,i,l){var e,s,u,c=o("WAWebGetters").createGetterFactories({root:(u=o("WAWebMsgGetters")).getMsgUnsafe,createCache:o("WAWebGettersCaches").createFrontendMessagesCache}),d=c.field,m=c.computed,p=c.clearCacheFor,_=p,f=m(function(e){var t=e[0],n=e[1],r=e[2],a=e[3];return o("WAWebMsgModelUtils").typeIsMms({type:t,subtype:n,headerType:r,interactiveHeader:a})},[u.getType,u.getSubtype,u.getHeaderType,u.getInteractiveHeader]),g=m(function(e){var t=e[0],n=e[1],r=e[2];return t!=null&&t<o("WAWebAck").ACK.SENT&&n&&r},[u.getAck,f,u.getIsSentByMe]),h=m(function(e){var t=e[0],n=e[1],r=e[2],a=o("WAWebMsgDataUtils").eventTypeFromMsgType(t);return r?n?a===o("WAWebCommonMsgUtils").EventType.IGNORE?o("WAWebCommonMsgUtils").EventType.IGNORE:o("WAWebCommonMsgUtils").EventType.NOTEWORTHY:a:o("WAWebCommonMsgUtils").EventType.IGNORE},[u.getMsgUnsafe,u.getInvis,u.getIsNewMsg]),y=function(t){switch(t.type){case"interactive":return o("WAWebMsgGetters").getNativeFlowName(t)!=null?o("WAWebFormatNfmText").formatNFMText(t):o("WAWebMsgGetters").getCaption(t);case"native_flow":return o("WAWebFormatNfmText").formatNFMText(t)}return null},C=m(function(e){var t=e[0],n=e[1],a=e[2],i=e[3],l=e[4],s=e[5],u=e[6],c=e[7],d=e[8],m=e[9],p=e[10],_=e[11],f=e[12],g=e[13],h=e[14],C=e[15],b=e[16];if((m||p)&&!o("WAWebOrderStatus").hasOrderStatusButton(t))return n===o("WAWebMsgType").MSG_TYPE.CHAT?i:l;switch(n){case"chat":case"interactive_response":case"automated_greeting_message":return i;case"image":case"video":case"ptv":case"document":case"sticker-pack":return l;case"location":return u?s:void 0;case"payment":return c==null?void 0:c.body;case"groups_v4_invite":return s;case"list":return _==null?void 0:_.description;case"product":return r("lodash").truncate(a,{length:o("WAWebProductCatalogCatalogConstants").MAX_REPLY_PRODUCT_TITLE_LENGTH});case"hsm":return i;case"template_button_reply":return i;case"interactive":return f!=null?y(t):l;case"native_flow":return y(t);case"poll_creation":case"poll_result_snapshot":return d;case"newsletter_admin_invite":return g==null?void 0:g.inviteMessage;case"newsletter_follower_invite":return h==null?void 0:h.inviteMessage;case"event_creation":return C;case"quarantined":return b;default:return}},[u.getMsgUnsafe,u.getType,u.getTitle,u.getBody,u.getCaption,u.getComment,u.getIsLive,u.getPaymentNoteMsg,u.getPollName,u.getIsFromTemplate,u.getIsDynamicReplyButtonsMsg,u.getList,u.getNativeFlowName,u.getNewsletterAdminInviteInfo,u.getNewsletterFollowerInviteInfo,u.getEventName,u.getQuarantineExtractedText]),b=m(function(e){var t,n=e[0],a=n==null?void 0:n.newsletterId;if(a==null)return!1;var i=(t=r("WAWebNewsletterCollection").get(a))==null?void 0:t.newsletterMetadata;return o("WAWebNewsletterMembershipUtil").iAmAdmin(i)&&!o("WAWebNewsletterMembershipUtil").iAmOwner(i)},[u.getNewsletterAdminInviteInfo]),v=m(function(e){var t=e[0],n=e[1],r=e[2],a=e[3];if(t===o("WAWebMsgType").MSG_TYPE.VCARD)return n?o("WABidi").dir(n):void 0;if(r!=null){var i=a!=null&&a.length?r.replace(/@\d+@g.us/,""):r,l=o("WABidi").dir(i);return l}},[u.getType,u.getSubtype,C,u.getGroupMentions]),S=m(function(e){var t=e[0];return t==="rtl"||t===void 0&&r("WAWebL10N").isRTL()},[v]),R=m(function(e){var t=e[0],n=e[1],r=e[2];return t===o("WAWebMsgType").MSG_TYPE.VCARD?n?o("WABidi").dir(n)==="rtl":!1:!!r&&o("WABidi").dir(r)==="rtl"},[u.getType,u.getSubtype,C]),L=m(function(e){var t=e[0],n=e[1];return t!=null||n!=null},[C,u.getFooter]),E=function(t){return o("WAWebMsgGetters").getIsNewsletterMsg(t)?r("WAWebNewsletterCollection"):o("WAWebChatCollection").ChatCollection};function k(e){var t=o("WAWebChatCollection").ChatCollection;return o("WAWebMsgGetters").getIsNewsletterMsg(e)&&(t=r("WAWebNewsletterCollection")),r("WANullthrows")(t.get(r("WAWebMsgKey").from(e.id).remote))}var I=function(n){var t=E(n).get(r("WAWebMsgKey").from(n.id).remote);return t==null&&(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getChat: msgKey = ",", type = ",""])),n.id.toString(),n.type),o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["getChat: unexpected null chat"]))).sendLogs("get-chat-unexpected-null")),t},T=function(t){return E(t).get(r("WAWebMsgKey").from(t.id).remote)},D=d("carouselCards"),x=m(function(e){var t=e[0];return t==null?null:t.slice()},[D]),$=d("buttons"),P=m(function(e){var t=e[0],n=e[1];return t&&n!=null&&n.length>0},[u.getIsFromTemplate,$]),N=m(function(e){var t=e[0],n=e[1];if(!t||n==null)return!1;var r=n.at(0);return r==null?!1:r.subtype===o("WAWebTemplateButtonSubtype").TEMPLATE_BUTTON_SUBTYPE.QUICK_REPLY},[P,$]),M=m(function(e){var t=e[0];return t},[u.getMsgUnsafe]),w=m(function(e){var t=e[0];return t.type===o("WAWebMsgType").MSG_TYPE.PRODUCT&&t.id&&t.id.id.startsWith(o("WAWebBizSystemMsgSubtypes").PRODUCT_INQUIRY_TYPE)?t:null},[M,u.getType,u.getId]),A=m(function(e){var t=e[0];switch(t.type){case o("WAWebMsgType").MSG_TYPE.GP2:return t;default:return null}},[M,u.getType]),F=m(function(e){var t=e[0];return t.type===o("WAWebMsgType").MSG_TYPE.BROADCAST_NOTIFICATION?t:null},[M,u.getType]),O=m(function(e){var t=e[0];return t.type==="product"?t:null},[M,u.getType]),B=m(function(e){var t=e[0];return t.type===o("WAWebMsgType").MSG_TYPE.REVOKED?t:null},[M,u.getType]),W=d("associationType"),q=m(function(e){var t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],l=e[5],s=e[6],u=e[7],c=e[8],d=e[9],m=e[10];return(t.type===o("WAWebMsgType").MSG_TYPE.IMAGE||t.type===o("WAWebMsgType").MSG_TYPE.VIDEO&&t.isGif!==!0)&&!r&&!l&&!(c!==o("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_ALBUM&&c!==o("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_POLL&&(a!=null||u))&&!d&&!m?t:null},[M,u.getType,u.getIsNotification,u.getCaption,u.getIsForwarded,B,u.getIsGif,u.getQuotedMsg,W,u.getCtwaContext,u.getIsViewOnce]),U=m(function(e){var t=e[0],n=e[1];return o("WAWebMsgModelUtils").notRefiningTypeIsUrl({type:t,subtype:n})},[u.getType,u.getSubtype]),V=m(function(e){var t=e[0],n=e[1],r=e[2],a=e[3];if(r)return null;switch(t.type){case o("WAWebMsgType").MSG_TYPE.IMAGE:case o("WAWebMsgType").MSG_TYPE.STICKER:case o("WAWebMsgType").MSG_TYPE.AUDIO:case o("WAWebMsgType").MSG_TYPE.PTT:case o("WAWebMsgType").MSG_TYPE.VIDEO:case o("WAWebMsgType").MSG_TYPE.PTV:case o("WAWebMsgType").MSG_TYPE.DOCUMENT:return t}return a?t:null},[M,u.getType,u.getIsViewOnce,U]),H=m(function(e){var t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],l=e[5],s=e[6],u=e[7],c=e[8],d=I(t.unsafe());return t.type===o("WAWebMsgType").MSG_TYPE.STICKER&&!r&&!a&&!i&&!l&&!s&&(!(c&&o("WAWebNewsletterGatingUtils").isStickerForwardedAttributionEnabled())||!u)&&!o("WAWebChatGroupUtils").isCommunityAnnouncementGroup(d)?t:null},[M,u.getType,u.getIsNotification,B,u.getQuotedMsg,u.getCtwaContext,u.getIsNewsletterMsg,u.getIsForwarded,u.getHasOriginatedFromNewsletter]),G=m(function(e){var t=e[0],n=e[1];return t.type===o("WAWebMsgType").MSG_TYPE.DOCUMENT?t:null},[M,u.getType]),z=m(function(e){var t=e[0],n=e[1];return t.type===o("WAWebMsgType").MSG_TYPE.IMAGE?t:null},[M,u.getType]),j=m(function(e){var t=e[0],n=e[1];return t.type===o("WAWebMsgType").MSG_TYPE.VIDEO?t:null},[M,u.getType]),K=m(function(e){var t=e[0],n=e[1];return t.type===o("WAWebMsgType").MSG_TYPE.AUDIO?t:null},[M,u.getType]),Q=m(function(e){var t=e[0],n=e[1];return t.type===o("WAWebMsgType").MSG_TYPE.PTT?t:null},[M,u.getType]),X=m(function(e){var t=e[0],n=e[1];return t.type===o("WAWebMsgType").MSG_TYPE.PTV?t:null},[M,u.getType]),Y=m(function(e){var t=e[0],n=e[1];return t.type===o("WAWebMsgType").MSG_TYPE.POLL_CREATION?t:null},[M,u.getType]),J=m(function(e){var t=e[0],n=e[1];return t.type===o("WAWebMsgType").MSG_TYPE.POLL_CREATION||t.type===o("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT?t:null},[M,u.getType]),Z=m(function(e){var t=e[0],n=e[1];return t.type===o("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT?t:null},[M,u.getType]),ee=m(function(e){var t=e[0],n=e[1];return t.type===o("WAWebMsgType").MSG_TYPE.EVENT_CREATION?t:null},[M,u.getType]),te=m(function(e){var t=e[0],n=e[1];return t.type===o("WAWebMsgType").MSG_TYPE.ALBUM?t:null},[M,u.getType]),ne=m(function(e){var t=e[0],n=e[1];return t.type===o("WAWebMsgType").MSG_TYPE.CALL_LOG?t:null},[M,u.getType]),re=m(function(e){var t=e[0],n=e[1];return t.type===o("WAWebMsgType").MSG_TYPE.POLL_UPDATE?t:null},[M,u.getType]),oe=m(function(e){var t=e[0],n=e[1];return o("WAWebMsgModelUtils").typeIsMms(t)?t:null},[M,u.getType]),ae=m(function(e){var t=e[0],n=e[1],r=e[2];return o("WAWebMsgModelUtils").typeIsUrl(t)?t:null},[M,u.getType,u.getSubtype]),ie=m(function(e){var t=e[0],n=e[1];return t.type===o("WAWebMsgType").MSG_TYPE.IMAGE||t.type===o("WAWebMsgType").MSG_TYPE.VIDEO?t:null},[M,u.getType]),le=m(function(e){var t=e[0],n=e[1],r=e[2],o=e[3];return(n!=null||r!=null)&&o?n!=null?n:r:null},[u.getType,ie,Q,u.getIsViewOnce]),se=m(function(e){var t=e[0],n=e[1],r=e[2],a=e[3];return t.type===o("WAWebMsgType").MSG_TYPE.PTT||t.type===o("WAWebMsgType").MSG_TYPE.AUDIO&&a&&r!=null?t:null},[M,u.getType,u.getWaveform,u.getIsOpus]),ue=d("senderObj"),ce=d("mediaData"),de=d("replyButtons"),me=d("pendingDeleteForMe",{default:!1}),pe=d("botPluginType"),_e=m(function(e){var t,n=e[0],r=e[1],a=e[2];return a!=null&&(t=a.id)!=null&&t.isBot()&&(r===o("WAWebProtobufsAICommon.pb").BotPluginMetadata$PluginType.SEARCH||r===o("WAWebProtobufsAICommon.pb").BotPluginMetadata$PluginType.REELS)?n:null},[M,pe,ue]),fe=m(function(e){var t=e[0],n=e[1],r=e[2];return t.type===o("WAWebMsgType").MSG_TYPE.RICH_RESPONSE&&r!=null?t:null},[M,u.getType,u.getRichResponse]),ge=m(function(e){var t=e[0];return o("WAWebMsgModelUtils").getCelebrationAnimationType(t)},[C]),he=m(function(e){var t=e[0],n=e[1];return o("WAWebMsgModelUtils").isAnimatedEmoji(t,n)},[u.getBody,u.getType]),ye=m(function(e){var t=e[0],n=e[1];return o("WAWebMsgModelUtils").isSingleEmojiMessageText(t,n)},[u.getBody,u.getType]),Ce=m(function(e){var t=e[0],n=e[1],r=e[2],a=o("WAWebAnimatedEmojiGatingUtils").isStaticSingleEmojiUIEnabled()&&r!=null;return t===o("WAWebMsgType").MSG_TYPE.CHAT&&(n||a)},[u.getType,he,ye]),be=m(function(e){var t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],l=e[5],s=e[6],u=e[7],c=r!=null||u!=null;return t===o("WAWebMsgType").MSG_TYPE.STICKER?!c&&!n&&!(l&&i&&o("WAWebNewsletterGatingUtils").isStickerForwardedAttributionEnabled())&&!s:t===o("WAWebMsgType").MSG_TYPE.CHAT?!c&&a&&!s:t===o("WAWebMsgType").MSG_TYPE.PTV?o("WAWebPtvGatingUtils").isPtvReceivingEnabled():!1},[u.getType,u.getCtwaContext,u.getQuotedMsg,Ce,u.getHasOriginatedFromNewsletter,u.getIsForwarded,u.getIsQuestion,u.getQuestionReplyQuotedMessage]),ve=m(function(e){var t=e[0];if(t!=null){var n=o("WAWebEmoji").EmojiUtil.normalizeEmojiFromString(t);if(n!=null)return o("WAWebAnimatedEmojiAssetLoader").getAnimatedEmojiAsset(n)}},[u.getBody]),Se=m(function(e){var t=e[0],n=e[1],r=e[2],o=e[3],a;if(t){var i;a=(i=n==null?void 0:n.newsletterId)!=null?i:r.remote}return a!=null?a:o.id},[u.getHasOriginatedFromNewsletter,u.getForwardedNewsletterMessageInfo,u.getId,ue]),Re=m(function(e){var t=e[0],n=e[1];return!t&&o("WAWebUserPrefsMeUser").isMeAccount(n)},[u.getIsNewsletterMsg,u.getSender]),Le=m(function(e){var t=e[0],n=e[1],r=e[2],o=T(t.unsafe()),a;return n&&(a=o==null?void 0:o.contact),a!=null?a:r},[M,u.getIsNewsletterMsg,ue]),Ee=m(function(e){var t=e[0];if(t==null)return!1;var n=r("WAWebNonJidMentionType").MENTION_ALL;return(t&n)===n},[u.getNonJidMentions]);l.clearFrontendMsgGetterCacheFor=_,l.getIsMms=f,l.getIsUnsentMedia=g,l.getEventType=h,l.getText=C,l.getIsNewsletterInviteAccepted=b,l.getDir=v,l.getIsRTL=S,l.getRtl=R,l.getHasBodyOrFooter=L,l.getChatCollection=E,l.getCurrentChat=k,l.getChat=I,l.getMaybeChat=T,l.getCarouselCardsCollection=D,l.getCarouselCards=x,l.getButtons=$,l.getHasTemplateButtons=P,l.getIsQuickReply=N,l.getSafeMsg=M,l.getAsProductInquiry=w,l.getAsGroupNotification=A,l.getAsBroadcastNotification=F,l.getAsProduct=O,l.getAsRevoked=B,l.getAssociationType=W,l.getAsAlbumAsset=q,l.getIsUrlMessage=U,l.getAsAutoDownloadableMedia=V,l.getAsGroupedSticker=H,l.getAsDoc=G,l.getAsImage=z,l.getAsVideo=j,l.getAsAudio=K,l.getAsPtt=Q,l.getAsPtv=X,l.getAsPollCreation=Y,l.getAsPoll=J,l.getAsPollResultSnapshot=Z,l.getAsEventCreation=ee,l.getAsAlbum=te,l.getAsCallLog=ne,l.getAsPollUpdate=re,l.getAsMms=oe,l.getAsUrl=ae,l.getAsVisualMedia=ie,l.getAsViewOnce=le,l.getAsPttLike=se,l.getSenderObj=ue,l.getMediaData=ce,l.getReplyButtons=de,l.getPendingDeleteForMe=me,l.getBotPluginType=pe,l.getAsBotPluginCarouselMsg=_e,l.getAsRichResponse=fe,l.getCelebrationAnimationCandidate=ge,l.getIsAnimatedEmoji=he,l.getIsSingleEmoji=ye,l.getIsTransparentMsgEmoji=Ce,l.getIsTransparentMsg=be,l.getJSONAssetForAnimatedEmoji=ve,l.getMsgSenderId=Se,l.getShouldDisplaySelf=Re,l.getSenderForReplyMsg=Le,l.getHasMentionAll=Ee}),98);
__d("WAWebFrontendPollVoteGetters",["WANullthrows","WAWebAck","WAWebContactCollection","WAWebFrontendMsgGetters","WAWebGetters","WAWebGettersCaches","WAWebMsgCollection","WAWebPollVoteGetters","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){var e,s=o("WAWebGetters").createGetterFactories({root:(e=o("WAWebPollVoteGetters")).getPollVoteUnsafe,createCache:o("WAWebGettersCaches").createFrontendPollVotesCache}),u=s.field,c=s.computed,d=s.clearCacheFor,m=d,p=u("isSendFailure",{default:!1}),_=c(function(e){var t=e[0],n=r("WANullthrows")(o("WAWebMsgCollection").MsgCollection.get(t));return r("WANullthrows")(o("WAWebFrontendMsgGetters").getAsPollCreation(n))},[e.getParentMsgKey]),f=c(function(e){var t=e[0];return o("WAWebContactCollection").ContactCollection.gadd(t)},[e.getSender]),g=c(function(e){var t=e[0],n=e[1],r=e[2],a=o("WAWebUserPrefsMeUser").isMeAccount(t)&&n!=null&&n<o("WAWebAck").ACK.CLOCK;return a||!!r},[e.getSender,e.getAck,p]);l.clearFrontendPollVoteGetterCacheFor=m,l.getParentMsg=_,l.getSenderObj=f,l.getIsFailed=g}),98);
__d("WAWebUseValuesUtils",["WAWebDummyCacheMap","WAWebGetters","lodash"],(function(t,n,r,o,a,i,l){var e=new(o("WAWebDummyCacheMap")).FakeCacheMap,s=r("lodash").memoize(function(t){return o("WAWebGetters").createGetterFactories({root:t,createCache:function(){return e}})}),u=r("lodash").memoize(function(e){var t=e[0].$$root,n=s(t),r=n.computed;return r(function(e){return e},e)},function(e){return e.map(m).join("-")}),c=new WeakMap,d=0;function m(e){var t=c.get(e);return t==null&&(t=(d++).toString(),c.set(e,t)),t}l.computedForComponent=u}),98);
__d("useWAWebValues",["WAArraysShallowEqual","WANullthrows","WAWebNoop","WAWebUseValuesUtils","react","useWAWebStableCallback"],(function(t,n,r,o,a,i,l){var e,s=e||(e=o("react")),u=s.useEffect,c=s.useMemo,d=s.useRef,m=s.useState,p=function(t){return r("WAWebNoop")};function _(e,t,n){var o=f(e,t,n);return r("WANullthrows")(o)}function f(e,t,n){var a,i=c(function(){return o("WAWebUseValuesUtils").computedForComponent(t)},t),l=m(function(){return e==null?null:i(e)}),s=l[0],_=l[1],f=r("useWAWebStableCallback")(function(){_(function(t){var n=e==null?null:i(e);return g(t,n)?t:n})}),h=d(e),y=h.current;e!==y&&(h.current=e,f());var C=(a=n==null?void 0:n.subscribe)!=null?a:p;return u(function(){return C(function(){f()})},[C,f]),s}function g(e,t){return e==t?!0:e==null||t==null?!1:r("WAArraysShallowEqual")(e,t,function(e,t){return!!(e===t||Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0)})}l.useValues=_,l.useOptionalValues=f}),98);
__d("useWAWebCollectionValues",["invariant","WANullthrows","react","useWAWebListener","useWAWebValues"],(function(t,n,r,o,a,i,l,s){var e,u=e||(e=o("react")),c=u.useCallback,d=u.useMemo,m=u.useState;function p(e,t,n,o){var a=_(e,t,n,o),i=m(function(){return r("WANullthrows")(a,"[useCollectionValues] Expected model to be present in collection")}),l=i[0],s=i[1];return a!=null&&a!==l&&s(a),l}function _(e,t,n,r){var a=d(function(){return Array.isArray(e)?e:[e]},[e]),i,l;typeof n=="function"&&Array.isArray(r)?(i=n,l=r):(Array.isArray(n)||s(0,72179),i=function(t){return t},l=n);var u=m(function(){return t==null?null:h(a,t)}),c=u[0],p=u[1],_=function(){var e=t==null?null:h(a,t);(e!==c||(e==null?void 0:e.id.toString())!==(c==null?void 0:c.id.toString()))&&p(e)};_(),o("useWAWebListener").useListeners(a.map(function(e){return{source:e,eventOrEvents:"add",callback:function(){_()}}}));var f=c==null?null:i(c);return o("useWAWebValues").useOptionalValues(f,l,{subscribe:g(c)})}function f(e,t){return o("useWAWebValues").useValues(e,t,{subscribe:g(e)})}function g(e){return c(function(t){if(e!=null)return e.on("change",t),e.incObservers(!0),function(){e.decObservers(),e.off("change",t)}},[e])}function h(e,t){for(var n of e){var r=n.get(t);if(r!=null)return r}return null}l.useCollectionValues=p,l.useOptionalCollectionValues=_,l.useModelGetterValues=f}),98);
__d("useWAWebChatValues",["WAWebChatCollection","WAWebNewsletterCollection","useWAWebCollectionValues"],(function(t,n,r,o,a,i,l){function e(e,t){return o("useWAWebCollectionValues").useCollectionValues([o("WAWebChatCollection").ChatCollection,r("WAWebNewsletterCollection")],e,t)}function s(e,t){return o("useWAWebCollectionValues").useOptionalCollectionValues([o("WAWebChatCollection").ChatCollection,r("WAWebNewsletterCollection")],e,t)}l.useChatValues=e,l.useOptionalChatValues=s}),98);
__d("useWAWebContactValues",["WAWebContactCollection","useWAWebCollectionValues"],(function(t,n,r,o,a,i,l){function e(e,t){return o("useWAWebCollectionValues").useCollectionValues(o("WAWebContactCollection").ContactCollection,e,t)}function s(e,t){return o("useWAWebCollectionValues").useOptionalCollectionValues(o("WAWebContactCollection").ContactCollection,e,t)}l.useContactValues=e,l.useOptionalContactValues=s}),98);
__d("useWAWebModelValues",["WACustomError","WALogger","WANullthrows","WAWebStateConcern","WAWebStateUtils","react"],(function(t,n,r,o,a,i,l){var e,s,u=s||(s=o("react")),c=u.useCallback,d=u.useEffect,m=u.useRef,p=u.useState,_=(function(e){function t(t){var n="Received a null value for model key: "+t;return e.call(this,n)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WACustomError").customError("StateHookMissingModelError"));function f(t,n,a){if(t==null)throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["useModelValues hook received an unexpected `null` model"],["useModelValues hook received an unexpected \\`null\\` model"]))).devConsole("See https://fburl.com/wiki/h7g96q1s for ways to handle this").sendLogs("state-hook-null-model"),new _("Unknown");var i=g(t,n,a);return r("WANullthrows")(i)}function g(e,t,n){var a=n!=null?n:{},i=a.isStrong,l=i===void 0?!0:i,s=a.componentName,u=e?o("WAWebStateUtils").unproxy(e):null,_=m();function f(){if(!u)return null;if(_.current==null){if(!u)return null;_.current=new(r("WAWebStateConcern"))(s!=null?s:"Hook(useModelValues)",u.proxyName,Array.from(new Set(t)),l,!0)}return _.current}var g=p(function(){var e=f();if(!e)return null;var t=e.getModelAndValidate(u);return t?e.createProxy(t):null}),h=g[0],y=g[1],C=c(function(e,t){var n=e.getModelAndValidate(t);y(n?e.createProxy(n):null)},[]);d(function(){var e=f();if(!(!e||!h)){var t=e.getModel(u);return e.attachConcern(t,h.proxyBitMask,C),function(){e.detachConcern(t,C)}}},[u,h,C]);var b=p(u),v=b[0],S=b[1],R=f();if(v!==u&&R){v&&R.detachConcern(v,C);var L=R.getModelAndValidate(u);S(L),y(L?R.createProxy(L):null)}return!R&&h!=null&&y(null),h}l.StateHookMissingModelError=_,l.useModelValues=f,l.useOptionalModelValues=g}),98);
__d("WAWebCollections",["WAWebAdCollection","WAWebAgentCollection","WAWebBlocklistCollection","WAWebBotProfileCollection","WAWebBusinessCategoriesResultCollection","WAWebBusinessProfileCollection","WAWebCallCollection","WAWebCatalogCollection","WAWebChatAssignmentCollection","WAWebChatCollection","WAWebChatPreferenceCollection","WAWebCommentCollection","WAWebCommunityActivityCollection","WAWebContactCollection","WAWebConversionTupleCollection","WAWebDailyAggregatedStatsCollection","WAWebEmojiVariantCollection","WAWebEventResponseCollection","WAWebFavoriteCollection","WAWebFavoriteStickerCollection","WAWebGroupMetadataCollection","WAWebLabelCollection","WAWebMsgCollection","WAWebMsgInfoCollection","WAWebMuteCollection","WAWebNewsletterCollection","WAWebNewsletterMetadataCollection","WAWebOptOutListCollection","WAWebOrderCollection","WAWebPinInChatCollection","WAWebPollsPollVoteCollection","WAWebPremiumMessageCollection","WAWebPresenceCollection","WAWebProfilePicThumbCollection","WAWebQuickReplyCollection","WAWebReactionsCollection","WAWebRecentEmojiCollection","WAWebRecentReactionsCollection","WAWebRecentStickerCollection","WAWebRecentStickerCollectionMd","WAWebStarredMsgCollection","WAWebStatusCollection","WAWebStickerCollection","WAWebStickerPackCollectionMd","WAWebStickerSearchCollection","WAWebSubscriptionCollection","WAWebTextStatusCollection","WAWebUnattributedMessageCollection","WAWebUnjoinedSubgroupMetadataCollection","WAWebUserDisclosureCollection"],(function(t,n,r,o,a,i,l){var e={AdCollection:o("WAWebAdCollection").AdCollection,Blocklist:o("WAWebBlocklistCollection").BlocklistCollection,OptOutList:o("WAWebOptOutListCollection").OptOutListCollection,BotProfile:o("WAWebBotProfileCollection").BotProfileCollection,BusinessCategoryResult:o("WAWebBusinessCategoriesResultCollection").BusinessCategoriesResultCollection,BusinessProfile:o("WAWebBusinessProfileCollection").BusinessProfileCollection,Call:r("WAWebCallCollection"),Catalog:o("WAWebCatalogCollection").CatalogCollection,Chat:o("WAWebChatCollection").ChatCollection,ChatAssignment:o("WAWebChatAssignmentCollection").ChatAssignmentCollection,ChatPreference:r("WAWebChatPreferenceCollection"),Contact:o("WAWebContactCollection").ContactCollection,ConversionTuple:r("WAWebConversionTupleCollection"),DailyAggregatedStats:o("WAWebDailyAggregatedStatsCollection").DailyAggregatedStatsCollection,EmojiVariant:o("WAWebEmojiVariantCollection").EmojiVariantCollection,FavoriteCollection:o("WAWebFavoriteCollection").FavoriteCollection,GroupMetadata:r("WAWebGroupMetadataCollection"),Label:o("WAWebLabelCollection").LabelCollection,Msg:o("WAWebMsgCollection").MsgCollection,MsgInfo:o("WAWebMsgInfoCollection").MsgInfoCollection,Mute:o("WAWebMuteCollection").MuteCollection,Order:o("WAWebOrderCollection").OrderCollection,PollVote:o("WAWebPollsPollVoteCollection").PollVoteCollection,Presence:o("WAWebPresenceCollection").PresenceCollection,ProfilePicThumb:o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection,QuickReply:o("WAWebQuickReplyCollection").QuickReplyCollection,RecentEmoji:o("WAWebRecentEmojiCollection").RecentEmojiCollection,RecentSticker:o("WAWebRecentStickerCollection").RecentStickerCollection,StarredMsg:o("WAWebStarredMsgCollection").AllStarredMsgsCollection,TextStatus:o("WAWebTextStatusCollection").TextStatusCollection,Status:o("WAWebStatusCollection").StatusCollection,Sticker:o("WAWebStickerCollection").StickerCollection,StickerSearch:o("WAWebStickerSearchCollection").StickerSearchCollection,RecentStickerMD:o("WAWebRecentStickerCollectionMd").RecentStickerCollectionMd,StickerPackCollectionMD:o("WAWebStickerPackCollectionMd").StickerPackCollectionMd,FavoriteSticker:o("WAWebFavoriteStickerCollection").FavoriteStickerCollection,Reactions:o("WAWebReactionsCollection").ReactionsCollection,RecentReactions:o("WAWebRecentReactionsCollection").RecentReactionsCollection,UnjoinedSubgroupMetadataCollection:r("WAWebUnjoinedSubgroupMetadataCollection"),AgentCollection:o("WAWebAgentCollection").AgentCollection,SubscriptionCollection:o("WAWebSubscriptionCollection").SubscriptionCollection,UnattributedMessageCollection:o("WAWebUnattributedMessageCollection").UnattributedMessageCollection,CommunityActivityCollection:r("WAWebCommunityActivityCollection"),CommentCollection:o("WAWebCommentCollection").CommentCollection,PinInChat:o("WAWebPinInChatCollection").PinInChatCollection,NewsletterCollection:r("WAWebNewsletterCollection"),NewsletterMetadataCollection:r("WAWebNewsletterMetadataCollection"),PremiumMessageCollection:o("WAWebPremiumMessageCollection").PremiumMessageCollection,UserDisclosureCollection:o("WAWebUserDisclosureCollection").UserDisclosureCollection,EventResponseCollection:o("WAWebEventResponseCollection").EventResponseCollection};l.default=e}),98);
__d("WAWebConversionTupleCollection",["WATimeUtils","WAWebApiParse","WAWebBaseCachePolicy","WAWebBaseCollection","WAWebConversionTupleModel","WAWebUserPrefsKeys"],(function(t,n,r,o,a,i,l){var e=["conversionData"],s=(function(t){function n(){return t.apply(this,arguments)||this}babelHelpers.inheritsLoose(n,t);var r=n.prototype;return r.initializeFromCache=function(n){if(n){var t=o("WATimeUtils").unixTime()-o("WAWebConversionTupleModel").ConversionTupleExpiry,r=n.filter(function(e){return e.timestamp-t>0}),a=r.map(function(t){var n=t.conversionData,r=babelHelpers.objectWithoutPropertiesLoose(t,e);if(n==null)return r;var a=o("WAWebApiParse").parseConversionData(n);return a?babelHelpers.extends({},r,{conversionData:a}):r});this.add(a),this.saveToCache()}},n})(o("WAWebBaseCollection").BaseCollection);s.model=o("WAWebConversionTupleModel").ConversionTuple,s.cachePolicy={id:o("WAWebUserPrefsKeys").COLLECTIONS_KEYS.CONVERSION_TUPLE_COLLECTION,policy:o("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:1e3};var u=new s;l.default=u}),98);
__d("WAWebConversionTupleModel",["WABinary","WALogger","WATimeUtils","WAWebAlarm","WAWebBaseModel","WAWebConversionTupleCollection","WAWebWid"],(function(t,n,r,o,a,i,l){var e=["conversionData"],s,u=604800,c=(function(t){function n(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.id=o("WAWebBaseModel").prop(),e.conversionData=o("WAWebBaseModel").prop(),e.conversionSource=o("WAWebBaseModel").prop(),e.ctwaSignals=o("WAWebBaseModel").prop(),e.timestamp=o("WAWebBaseModel").prop(function(){return o("WATimeUtils").unixTime()}),e.alarmId=o("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.initialize=function(){var e=this;t.prototype.initialize.call(this),this.listenTo(this,"change:timestamp",function(){return e.$ConversionTupleImpl$p_1()}),this.$ConversionTupleImpl$p_1()},a.$ConversionTupleImpl$p_1=function(){var e=this,t=this.timestamp+u;if(t<0){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Invalid conversionTuple timer"]))),this.delete();return}this.alarmId=r("WAWebAlarm").setLocalTimeout(function(){e.delete()},t*1e3,this.alarmId)},a.$ConversionTupleImpl$p_2=function(){this.alarmId!=null&&(r("WAWebAlarm").clearTimeout(this.alarmId),this.alarmId=void 0)},a.toJSON=function(){var t=this.serialize(),n=t.conversionData,r=babelHelpers.objectWithoutPropertiesLoose(t,e);if(n instanceof ArrayBuffer){var a=new(o("WABinary")).Binary(n);r.conversionData=a.readString(n.byteLength)}return r},a.delete=function(){t.prototype.delete.call(this),this.getCollection().remove(this.id),this.$ConversionTupleImpl$p_2()},a.getCollection=function(){return r("WAWebConversionTupleCollection")},n})(o("WAWebBaseModel").BaseModel);c.Proxy="conversionTuple",c.idClass=r("WAWebWid");var d=o("WAWebBaseModel").defineModel(c);l.ConversionTupleExpiry=u,l.ConversionTuple=d}),98);
__d("WAWebProductSelectors",["isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){var e=function(t){return t.salePriceAmount1000!=null&&(t.salePriceStartDate==null||t.salePriceStartDate<=Date.now())&&(t.salePriceEndDate==null||t.salePriceEndDate>Date.now())},s=function(n){return e(n)?n.salePriceAmount1000:n.priceAmount1000},u=function(n){var t,r;return e(n)?Math.max(0,((t=n.priceAmount1000)!=null?t:0)-((r=n.salePriceAmount1000)!=null?r:0)):0},c=function(t){var e=t.currency,n=t.priceAmount1000,o=s(t);return r("isStringNullOrEmpty")(e)||n==null||o==null};l.isSalePriceActive=e,l.getActivePrice=s,l.getSavings=u,l.isEmptyPrice=c}),98);
__d("WAWebBizCreateProductInquiry",["WATimeUtils","WAWebAck","WAWebMediaOpaqueData","WAWebMsgKey","WAWebMsgModel","WAWebMsgType","WAWebProductSelectors","WAWebUserPrefsMeUser","WAWebViewMode.flow"],(function(t,n,r,o,a,i,l){function e(e,t,n,a,i){var l={ack:o("WAWebAck").ACK.CLOCK,id:new(r("WAWebMsgKey"))({id:"product_inquiry_"+r("WAWebMsgKey").newId_DEPRECATED(),remote:t,fromMe:!0}),from:t,to:o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),t:o("WATimeUtils").unixTime(),type:o("WAWebMsgType").MSG_TYPE.PRODUCT,kind:o("WAWebMsgType").MsgKind.Product,viewMode:o("WAWebViewMode.flow").ViewModeType.VISIBLE,title:e.name,description:e.description,businessOwnerJid:n.toString({legacy:!0}),productId:e.id.toString(),url:e.url,productImageCount:e.getProductImageCollectionCount(),body:a.preview instanceof r("WAWebMediaOpaqueData")?a.preview.getBase64():null,currencyCode:e.currency,priceAmount1000:e.priceAmount1000,salePriceAmount1000:o("WAWebProductSelectors").isSalePriceActive(e)?e.salePriceAmount1000:null,sessionId:i,retailerId:e.retailerId},s=new(o("WAWebMsgModel")).Msg(l);return s.mediaData.set(a),s}l.createProductInquiry=e}),98);
__d("WAWebBusinessCategoriesResultCollection",["WAWebBaseCollection","WAWebBizBusinessProfileAction","WAWebBusinessCategoriesResultModel","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a))||this,t.findImpl=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebBizBusinessProfileAction").queryBusinessCategories(e),n=t.categories,r=t.notABizId;return{id:e,categories:n,notABizId:r}});return function(t){return e.apply(this,arguments)}})(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebBusinessCategoriesResultModel").BusinessCategoriesResult,e.staleCollection=!0;var s=new e;l.BusinessCategoriesResultCollectionImpl=e,l.BusinessCategoriesResultCollection=s}),98);
__d("WAWebBusinessCategoriesResultModel",["WAWebBaseModel","WAWebBusinessCategoriesResultCollection"],(function(t,n,r,o,a,i,l){var e="__empty_query__",s=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.categories=o("WAWebBaseModel").prop(),t.notABizId=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getCollection=function(){return o("WAWebBusinessCategoriesResultCollection").BusinessCategoriesResultCollection},t})(o("WAWebBaseModel").BaseModel);s.Proxy="BusinessCategoriesResult";var u=o("WAWebBaseModel").defineModel(s);l.BUSINESS_CATEGORY_EMPTY_STR_ID=e,l.BusinessCategoriesResult=u}),98);
__d("WAWebApiDirectConnectionKeys",["WALogger","WAWebSchemaDirectConnectionKeys"],(function(t,n,r,o,a,i,l){var e;function s(e){return o("WAWebSchemaDirectConnectionKeys").getDirectConnectionKeysTable().createOrMerge(e.id,e)}function u(t){return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] Removing direct connection keys from persistent DB"]))),o("WAWebSchemaDirectConnectionKeys").getDirectConnectionKeysTable().remove(t)}function c(e){return o("WAWebSchemaDirectConnectionKeys").getDirectConnectionKeysTable().get(e)}l.createOrUpdateDirectConnectionKeys=s,l.removeDirectConnectionKeys=u,l.fetchDirectConnectionKeys=c}),98);
__d("WAWebBusinessDirectConnectionModel",["WAWebBaseModel","WAWebWid"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.cypher=o("WAWebBaseModel").prop(),t.cypherExpirationTimestamp=o("WAWebBaseModel").prop(),t.cypherType=o("WAWebBaseModel").prop(),t.postcode=o("WAWebBaseModel").prop(),t.postcodeSetByUser=o("WAWebBaseModel").prop(),t.postcodeLocationName=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="business_direct_connection",e.idClass=r("WAWebWid");var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebBusinessDirectConnectionCollection",["Promise","WALogger","WANullthrows","WAWebApiDirectConnectionKeys","WAWebBaseCollection","WAWebBizBusinessProfileAction","WAWebBusinessDirectConnectionModel","WAWebBusinessDirectUtils","WAWebDirectConnectionCypher","WAWebDirectConnectionUtils","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v=(function(t){function a(){return t.apply(this,arguments)||this}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i._getValidCertAndSignedUserInfo=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){if(!r&&t!=null&&t.certificateChain){var a=yield(b||(b=n("Promise"))).all([o("WAWebBusinessDirectUtils").getValidCertificate(o("WAWebDirectConnectionUtils").stringToCertificateString(t.certificateChain)),o("WAWebBizBusinessProfileAction").querySignedUserInfo(e)]),i=a[0],l=a[1];if(i)return{signedUserInfo:l,validCertificate:i}}var s=yield(b||(b=n("Promise"))).all([o("WAWebBizBusinessProfileAction").querySignedUserInfo(e),o("WAWebBusinessDirectUtils").fetchCertificateFullChain(e)]),u=s[0],c=s[1],d=c.certificateString,m=c.leaftCertificateCommonName;if(u.businessDomain!==m)throw new(o("WAWebBusinessDirectUtils")).DCCertificateDomainMismatchError("[direct-connection] certificate common name does not match business domain");var p=yield o("WAWebBusinessDirectUtils").getValidCertificate(d);return{signedUserInfo:u,validCertificate:p}});function t(t,n,r){return e.apply(this,arguments)}return t})(),i._getCypherTypeForConversation=function(t,n){return o("WAWebBusinessDirectUtils").userHasSentMessageToBusiness(t)||n?o("WAWebDirectConnectionCypher").CypherType.PhoneNumberAndPostcode:o("WAWebDirectConnectionCypher").CypherType.Postcode},i._fetchPostcode=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(typeof(t==null?void 0:t.postcode)=="string"&&t.postcodeSetByUser===!0){var n;return{postcode:t.postcode,postcodeSetByUser:t.postcodeSetByUser,postcodeLocationName:(n=t.postcodeLocationName)!=null?n:""}}var r=yield o("WAWebBusinessDirectUtils").fetchDefaultPostcode(e);if(r)return babelHelpers.extends({},r,{postcodeSetByUser:!1})});function t(t,n){return e.apply(this,arguments)}return t})(),i._getCypherFromDborApi=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){n===void 0&&(n=!1);var r=yield o("WAWebApiDirectConnectionKeys").fetchDirectConnectionKeys(t.toJid());if(!n&&r&&this._isRowDataInGoodCondition(t,r))return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] cypher found in client persistent DB. Using stored cypher ",""])),r.cypherType),{id:t,cypher:o("WAWebDirectConnectionCypher").stringToCypherString(r.cypher),cypherExpirationTimestamp:r.cypherExpirationTimestamp,cypherType:r.cypherType,certificateChain:r.certificateChain,postcode:r.postcode,postcodeSetByUser:r.postcodeSetByUser,postcodeLocationName:r.postcodeLocationName};o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] cypher not found / cypher unusable in client DB. Generating direct connection keys"])));var a=this._getCypherTypeForConversation(t,typeof(r==null?void 0:r.postcode)=="string"&&r.postcodeSetByUser===!0),i=yield this.genNewCypher(t,a,{rowData:r,forceRenew:n});return i==null?(o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] Cannot generate cypher"]))),null):(yield o("WAWebApiDirectConnectionKeys").createOrUpdateDirectConnectionKeys(babelHelpers.extends({},i,{id:t.toJid(),cypher:o("WAWebDirectConnectionCypher").cypherStringToString(i.cypher)})),i)});function r(e,n){return t.apply(this,arguments)}return r})(),i._verifyPostcode=function(t,n){return o("WAWebPersistedJobManager").getJobManager().waitUntilCompleted(o("WAWebPersistedJobDefinitions").jobSerializers.verifyPostcode(t,n))},i._updateModel=function(t){return this.set([t])},i.genNewCypher=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a){var i=a.rowData,l=a.forceRenew;o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] new cypher type ",""])),t);var s=yield(b||(b=n("Promise"))).all([this._getValidCertAndSignedUserInfo(e,i,!!l),this._fetchPostcode(e,i)]),u=s[0],p=u.validCertificate,_=u.signedUserInfo,f=s[1];if(p==null)return o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] no certificate returned from the get_public_key IQ"]))),null;if(f==null)return o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] Post code data could not be found"]))),null;var g=r("WANullthrows")(yield o("WAWebBusinessDirectUtils").getCypher(p.chain,f.postcode,_,t)),h=g.cypher,y=t===o("WAWebDirectConnectionCypher").CypherType.PhoneNumberAndPostcode?_.phoneNumberSignatureExpiration:null,C=o("WAWebDirectConnectionUtils").certificateStringToString(p.string);return{id:e,cypher:h,cypherExpirationTimestamp:y,cypherType:t,certificateChain:C,postcode:f.postcode,postcodeSetByUser:f.postcodeSetByUser,postcodeLocationName:f.postcodeLocationName}});function t(t,n,r){return e.apply(this,arguments)}return t})(),i.verifyAndSavePostcode=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){n===void 0&&(n=!1),o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] verify and save postcode called"])));var a=yield o("WAWebApiDirectConnectionKeys").fetchDirectConnectionKeys(e.toJid()),i=o("WAWebDirectConnectionCypher").CypherType.PhoneNumberAndPostcode;o("WALogger").DEV(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] verify postcode: using cypherType: ",""])),i);var l=yield this._getValidCertAndSignedUserInfo(e,a,n),s=l.validCertificate,u=l.signedUserInfo;if(s==null)return o("WALogger").WARN(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] certificate is null during verify postcode"]))),null;var c=r("WANullthrows")(yield o("WAWebBusinessDirectUtils").getCypher(s.chain,t,u,i)),d=c.cypher,m=c.exportedAesKey,h=c.iv,y=i===o("WAWebDirectConnectionCypher").CypherType.PhoneNumberAndPostcode?u.phoneNumberSignatureExpiration:null;try{var C=yield this._verifyPostcode(e,d),b=C.resultCode,v=C.encryptedLocationName;if(b==="success"&&typeof v=="string"){var S=yield o("WAWebDirectConnectionCypher").decryptDataWithSymmetricKeyToString(m,v,h),R=o("WAWebDirectConnectionUtils").certificateStringToString(s.string),L={cypherExpirationTimestamp:y,certificateChain:R,cypherType:i,postcode:t,postcodeSetByUser:!0,postcodeLocationName:S};return yield o("WAWebApiDirectConnectionKeys").createOrUpdateDirectConnectionKeys(babelHelpers.extends({id:e.toJid(),cypher:o("WAWebDirectConnectionCypher").cypherStringToString(d)},L)),this._updateModel(babelHelpers.extends({id:e,cypher:d},L)),{resultCode:b,decryptedLocationName:S}}return{resultCode:b}}catch(n){if(o("WAWebBusinessDirectUtils").errorIsDirectConnectionCypherError421(n))return o("WALogger").DEV(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] Received 421 from Direct Connection request during verify postcode. Renewing certificate and retrying."]))),this.verifyAndSavePostcode(e,t,!0);throw n}});function t(t,n,r){return e.apply(this,arguments)}return t})(),i.removeCypher=function(t){var e=this.get(t);return e?(o("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] removing cypher from cache"]))),this.remove(e),o("WAWebApiDirectConnectionKeys").removeDirectConnectionKeys(t.toJid())):(b||(b=n("Promise"))).resolve()},i._isCypherInGoodCondition=function(t,n,r,a){return!o("WAWebBusinessDirectUtils").isCypherFromLaunch1(n)&&!o("WAWebBusinessDirectUtils").isCypherExpired(n,r)&&n===this._getCypherTypeForConversation(t,a)},i._isRowDataInGoodCondition=function(t,n){return this._isCypherInGoodCondition(t,n.cypherType,n.cypherExpirationTimestamp,n.postcodeSetByUser===!0)},i._isModelDataInGoodCondition=function(t,n){return this._isCypherInGoodCondition(t,n.cypherType,n.cypherExpirationTimestamp,n.postcodeSetByUser===!0)},i.getCypher=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=t===void 0?{}:t,r=n.forceRenew,a=r===void 0?!1:r,i=a?null:this.get(e);return!i||!this._isModelDataInGoodCondition(e,i)?(o("WALogger").DEV(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] cypher not found / usable cypher in client cache."]))),[].concat(yield this.update(e,{forceRenewDirectConnection:a}))[0]):(o("WALogger").DEV(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] cypher found in client cache. Using cached cypher"]))),i)});function t(t,n){return e.apply(this,arguments)}return t})(),i.findImpl=function(t){return this._getCypherFromDborApi(t)},i._update=function(t,n){var e=n.forceRenewDirectConnection;return this._getCypherFromDborApi(t,e)},a})(o("WAWebBaseCollection").BaseCollection);v.model=r("WAWebBusinessDirectConnectionModel");var S=new v;l.default=S}),98);
__d("WAWebBusinessDirectUtils",["Promise","WAArraysShallowEqual","WACustomError","WALogger","WANullthrows","WAWeb-moment","WAWebBackendErrors","WAWebBizBusinessProfileAction","WAWebBusinessProfileCollection","WAWebBusinessProfileVersioningBridge","WAWebChatCollection","WAWebDirectConnectionCypher","WAWebDirectConnectionGatingUtils","WAWebDirectConnectionUtils","WAWebDirectConnectionX509","WAWebServerPropConstants","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u="YYYYMMDDTHHmmssZ",c=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WACustomError").customError("DCCertificateDomainMismatchError"));function d(t,n,a){if(a===void 0&&(a=r("WAWeb-moment")()),t!==o("WAWebDirectConnectionCypher").CypherType.PhoneNumberAndPostcode)return!1;if(n==null)return!0;var i=r("WAWeb-moment")(n,u),l=!(i.isValid()&&i.isAfter(a));return l&&o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] cypher is expired."]))),l}function m(e){return!e}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebDirectConnectionX509").extractCertificates(o("WAWebDirectConnectionUtils").certificateStringToString(e)),n=yield o("WAWebDirectConnectionX509").validateCertificates(t.slice(1,-1),t.slice(-1)),r=n.result;return r?{string:e,chain:t}:null}),_.apply(this,arguments)}function f(e,t,n){switch(e){case o("WAWebDirectConnectionCypher").CypherType.PhoneNumberAndPostcode:return{postcode:t,phone_number:n.phoneNumber,ttl_timestamp:n.phoneNumberSignatureExpiration,phone_number_signature:n.phoneNumberSignature};case o("WAWebDirectConnectionCypher").CypherType.Postcode:return{postcode:t}}}function g(e,t,n,r){var a=f(r,t,n);return o("WAWebDirectConnectionCypher").genCypher(e[0],a)}function h(e){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,a=yield(s||(s=n("Promise"))).all([o("WAWebBizBusinessProfileAction").queryBusinessPublicKey(e),o("WAWebDirectConnectionX509").fetchFromCABundle()]),i=a[0].certificate,l=a[1];if(i==null)throw r("err")("[direct-connection] no certificate returned from the get_public_key IQ");var u=yield o("WAWebDirectConnectionX509").extractCertificates(o("WAWebDirectConnectionUtils").certificateStringToString(i)),c=u.length>0?(t=u[0].subject.typesAndValues.find(function(e){return e.type==="2.5.4.3"}))==null?void 0:t.value.valueBlock.value:null,d=r("WANullthrows")(yield o("WAWebDirectConnectionX509").genRootIssuers(u,l));return{certificateString:o("WAWebDirectConnectionX509").encodeToString([].concat(u,d)),leaftCertificateCommonName:c}}),y.apply(this,arguments)}function C(e){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t;return!!(o("WAWebDirectConnectionGatingUtils").supportsDirectConnection()&&o("WAWebChatCollection").ChatCollection.get(e)!=null&&((t=yield o("WAWebBusinessProfileCollection").BusinessProfileCollection.find(e))!=null&&t.isBusinessDirectConnection()))}),b.apply(this,arguments)}function v(e){var t=o("WAWebChatCollection").ChatCollection.get(e);return!!t&&t.hasMaybeSentMsgToChat()}function S(e){var t,n;return((t=e.directConnection)==null?void 0:t.enabled)===!0&&typeof((n=e.directConnection.defaultPostcode)==null?void 0:n.code)=="string"}function R(e){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=yield o("WAWebBusinessProfileCollection").BusinessProfileCollection.find(e);if((t=n.directConnection)!=null&&t.enabled&&n.directConnection.defaultPostcode)return{postcode:n.directConnection.defaultPostcode.code,postcodeLocationName:n.directConnection.defaultPostcode.locationName}}),L.apply(this,arguments)}var E=421;function k(e){return e instanceof o("WAWebBackendErrors").ServerStatusCodeError&&e.statusCode===E}var I=function(t,n){if(t===o("WAWebServerPropConstants").UNINITIALIZED_VALUE_WEB_BIZ_PROFILE_OPTIONS)return!1;var e=(o("WAWebBusinessProfileVersioningBridge").getBusinessProfileQueryVersionWithCustomBizProfileOptions(t)&o("WAWebBusinessProfileVersioningBridge").DIRECT_CONNECTION_FLAG)>0,r=(o("WAWebBusinessProfileVersioningBridge").getBusinessProfileQueryVersionWithCustomBizProfileOptions(n)&o("WAWebBusinessProfileVersioningBridge").DIRECT_CONNECTION_FLAG)>0;return e!==r},T=function(t,n){return t!=null&&!r("WAArraysShallowEqual")(t,n)};l.timestampFormat=u,l.DCCertificateDomainMismatchError=c,l.isCypherExpired=d,l.isCypherFromLaunch1=m,l.getValidCertificate=p,l.getCypher=g,l.fetchCertificateFullChain=h,l.isCypherNeeded=C,l.userHasSentMessageToBusiness=v,l.businessSupportsPostcode=S,l.fetchDefaultPostcode=R,l.errorIsDirectConnectionCypherError421=k,l.isDirectConnectionFlagChanged=I,l.isDirectConnectionNumbersAbPropChanged=T}),98);
__d("WAWebBusinessProfileCollection",["Promise","WALogger","WAWebABPropsLocalStorage","WAWebApiBusinessProfile","WAWebBaseCollection","WAWebBizBusinessProfileAction","WAWebBizGatingUtils","WAWebBusinessDirectUtils","WAWebBusinessProfileModel","WAWebBusinessProfileUtils","WAWebCmd","WAWebContactCollection","WAWebDirectConnectionGatingUtils","WAWebHandleBizBotAutomatedTypeAction","WAWebHandleBizBotWelcomeMsgProtocolModeAction","WAWebLidMigrationUtils","WAWebServerPropConstants","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f="catalog_exists",g=(function(t){function a(){var n;n=t.call(this)||this,n._inflightDbQueryMap=new Map;var r=o("WAWebABPropsLocalStorage").isABPropsAfterFirstSync()?o("WAWebDirectConnectionGatingUtils").directConnectionBusinessNumbersFromAbprop():null,a=o("WAWebABPropsLocalStorage").isABPropsAfterFirstSync()?o("WAWebBizGatingUtils").webBizProfileOptions():o("WAWebServerPropConstants").UNINITIALIZED_VALUE_WEB_BIZ_PROFILE_OPTIONS;return n.listenTo(o("WAWebCmd").Cmd,"on_ab_props_update",function(){var t=o("WAWebBizGatingUtils").webBizProfileOptions();o("WAWebBusinessDirectUtils").isDirectConnectionFlagChanged(a,t)&&(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] change in direct connection bit detected. marking relevant biz profiles from abprop numbers as stale"]))),n._markBizProfilesAsStale(o("WAWebDirectConnectionGatingUtils").directConnectionBusinessNumbersFromAbprop())),a=t;try{var i=o("WAWebDirectConnectionGatingUtils").directConnectionBusinessNumbersFromAbprop();o("WAWebBusinessDirectUtils").isDirectConnectionNumbersAbPropChanged(r,i)&&n._markBizProfilesAsStale(Array.from(new Set((r!=null?r:[]).concat(i)))),r=i}catch(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] Failed to force update biz profiles on abprop biz numbers change"]))).verbose().devConsole(e).sendLogs("direct-connection-biz-number-abprop-sync-fail"+e)}}),n}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.findImpl=function(t){return this._findAndParse(t,{queryCatalog:!0})},i._update=function(t,n){return this._findAndParse(t,{queryCatalog:!1,getMerchantCompliance:n==null?void 0:n.getMerchantCompliance})},i._findAndParse=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var r=t.queryCatalog,a=t.getMerchantCompliance,i=this.gadd(e);if(!i.id.isUserNotPSA()||i.id.isFbidBot())return o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Store:BusinessProfile:_findAndParse businessProfile is only available to users (",")"])),String(e)),(_||(_=n("Promise"))).resolve({id:e});var l=o("WAWebBizBusinessProfileAction").queryBusinessProfile([{wid:i.id,tag:i.tag}],a),s=yield l;if(!Array.isArray(s))return o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Received invalid business profile response"]))).devConsole(s),null;if(s.length===0)return o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Store:BusinessProfile:_findAndParse No businessProfile found for ",""])),String(e)),{id:e};var p=s[0],f=p.wid,g=p.tag,h={id:f,tag:g,dataSource:"server"},y=p.profile;if(y){var C=o("WAWebContactCollection").ContactCollection.get(e);C&&!C.isContactSyncCompleted&&(C.set("isBusiness",!0),C.set("forcedBusinessUpdateFromServer",!0));var b=o("WAWebBusinessProfileUtils").parseBusinessProfile({id:p.wid,profile:y,queryCatalog:r}),v=i.dataSource==="placeholder"?null:i.automatedType,S=b.automatedType;yield o("WAWebHandleBizBotAutomatedTypeAction").handleBizBotAutomatedTypeTransition(i.id,v,S);var R=i.dataSource==="placeholder"?null:i.welcomeMsgProtocolMode,L=b.welcomeMsgProtocolMode;return yield o("WAWebHandleBizBotWelcomeMsgProtocolModeAction").handleBizBotWelcomeMsgProtocolModeTransition(i.id,R,L),yield o("WAWebApiBusinessProfile").createOrMergeBusinessProfileRecordLidAware({id:h.id,automatedType:b.automatedType,welcomeMsgProtocolMode:b.welcomeMsgProtocolMode,prompts:b.prompts,commands:b.commands,commandsDescription:b.commandsDescription}),o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Store:BusinessProfile:_findAndParse parse and save business profile from server ",""])),e.toString()).devConsole(b),babelHelpers.extends({},b,h)}return h});function t(t,n){return e.apply(this,arguments)}return t})(),i.fetchBizProfile=function(t){var e=this.get(t);return e&&e.markStale(),this.find(t)},i.getValid=function(t){var e=this.get(t);if(e!=null&&e.isValid())return e},i.markProfileAsStale=function(t){var e;(e=this.get(t))==null||e.markStale()},i.hasBusinessProfileInCache=function(t){return!!this.get(t)},i.convertBusinessProfileIdForLidMigration=function(t){var e=t instanceof r("WAWebWid")?t:o("WAWebWidFactory").createWid(t.toString());if(e.isLid()){var n=o("WAWebLidMigrationUtils").toPn(e);if(n!=null)return n}return e},i._markBizProfilesAsStale=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this;yield(_||(_=n("Promise"))).all(e.map(function(e){return o("WAWebWidFactory").createUserWidOrThrow(e)}).filter(function(e){return t.hasBusinessProfileInCache(e)}).map(function(e){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] forcefully marking biz profile as stale"]))),t.markProfileAsStale(e)}))});function t(t){return e.apply(this,arguments)}return t})(),a})(o("WAWebBaseCollection").BaseCollection);g.model=o("WAWebBusinessProfileModel").BusinessProfile,g.staleCollection=!0;var h=new g;l.CATALOG_EXISTS=f,l.BusinessProfileCollection=h}),98);
__d("WAWebBusinessProfileModel",["WAWebBaseModel","WAWebBotGating","WAWebBotTypes","WAWebBusinessProfileCollection","WAWebBusinessProfileTypes","WAWebChatCollection","WAWebChatGroupUtils","WAWebContactCollection","WAWebOrderRequestMsg.flow","WAWebProductCatalogMetaLinkingGatingUtils","WAWebWid"],(function(t,n,r,o,a,i,l){var e="wa.me/",s=3,u=(function(t){function n(){for(var n,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=t.call.apply(t,[this].concat(a))||this,n.id=o("WAWebBaseModel").prop(),n.dataSource=o("WAWebBaseModel").prop("placeholder"),n.tag=o("WAWebBaseModel").prop(),n.description=o("WAWebBaseModel").prop(),n.categories=o("WAWebBaseModel").prop(),n.profileOptions=o("WAWebBaseModel").prop(),n.email=o("WAWebBaseModel").prop(),n.website=o("WAWebBaseModel").prop(),n.latitude=o("WAWebBaseModel").prop(),n.longitude=o("WAWebBaseModel").prop(),n.businessHours=o("WAWebBaseModel").prop(),n.catalogStatus=o("WAWebBaseModel").prop(),n.address=o("WAWebBaseModel").prop(),n.structuredAddress=o("WAWebBaseModel").prop(),n.serviceAreas=o("WAWebBaseModel").prop(),n.legalEntityDetails=o("WAWebBaseModel").prop(),n.fbPage=o("WAWebBaseModel").prop(),n.igProfessional=o("WAWebBaseModel").prop(),n.isProfileLinked=o("WAWebBaseModel").prop(),n.directConnection=o("WAWebBaseModel").prop(),n.customUrlPath=o("WAWebBaseModel").prop(),n.isProfileLocked=o("WAWebBaseModel").prop(!0),n.memberSinceText=o("WAWebBaseModel").prop(),n.customUrl=o("WAWebBaseModel").derived(function(){var t;if(this.customUrlPath!=null)t=this.customUrlPath;else return null;return""+e+t},["customUrlPath"]),n.coverPhoto=o("WAWebBaseModel").prop(),n.automatedType=o("WAWebBaseModel").prop(o("WAWebBotTypes").BizBotAutomatedType.UNKNOWN),n.welcomeMsgProtocolMode=o("WAWebBaseModel").prop(o("WAWebBotTypes").BotWelcomeMsgProtocolModeType.NONE),n.prompts=o("WAWebBaseModel").prop(),n.commandsDescription=o("WAWebBaseModel").prop(),n.commands=o("WAWebBaseModel").prop(),n.stale=o("WAWebBaseModel").session(!0),n.isBizBot3p=o("WAWebBaseModel").derived(function(){return this.automatedType===o("WAWebBotTypes").BizBotAutomatedType.FULL_3P},["automatedType"]),n.isBizBot1p=o("WAWebBaseModel").derived(function(){return this.automatedType===o("WAWebBotTypes").BizBotAutomatedType.PARTIAL_1P},["automatedType"]),n.isCatalogDisabledDueToMetaLinking=o("WAWebBaseModel").derived(function(){return o("WAWebProductCatalogMetaLinkingGatingUtils").shouldDisableCatalogDueToMetaLinkingForProfile(this)},["profileOptions"]),babelHelpers.assertThisInitialized(n)||babelHelpers.assertThisInitialized(n)}babelHelpers.inheritsLoose(n,t);var r=n.prototype;return r.initialize=function(){var e=this;t.prototype.initialize.call(this),this.listenTo(this,"change:automatedType",function(){e.$BusinessProfileImpl$p_1(),e.$BusinessProfileImpl$p_2()}),this.$BusinessProfileImpl$p_1(),this.$BusinessProfileImpl$p_2()},r.markStale=function(){this.stale=!0,this.hasObservers()&&this.getCollection().find(this.id)},r.getCollection=function(){return o("WAWebBusinessProfileCollection").BusinessProfileCollection},r.isValid=function(){return Array.isArray(this.categories)},r.isBusinessDirectConnection=function(){var e,t,n,r;return(e=(t=(n=this.directConnection)==null?void 0:n.enabled)!=null?t:(r=this.profileOptions)==null?void 0:r.directConnection)!=null?e:!1},r.getCatalogType=function(){var e,t;return((e=this.profileOptions)==null?void 0:e.commerceExperience)===o("WAWebBusinessProfileTypes").CommerceExperienceTypes.META_CATALOG?o("WAWebOrderRequestMsg.flow").CatalogType.SMB_META_CATALOG:((t=this.profileOptions)==null?void 0:t.commerceExperience)===o("WAWebBusinessProfileTypes").CommerceExperienceTypes.CATALOG?o("WAWebOrderRequestMsg.flow").CatalogType.NATIVE:o("WAWebOrderRequestMsg.flow").CatalogType.UNKNOWN},r.$BusinessProfileImpl$p_2=function(){if(!(!o("WAWebBotGating").isBizBot3pEnabled()||!this.isBizBot3p)){var e=o("WAWebContactCollection").ContactCollection.get(this.id);e==null||e.updateName()}},r.$BusinessProfileImpl$p_1=function(){var e=o("WAWebChatCollection").ChatCollection.getLatestChatForWid(this.id);e&&o("WAWebChatGroupUtils").updateCanSend(e,this)},n})(o("WAWebBaseModel").BaseModel);u.Proxy="businessProfile",u.idClass=r("WAWebWid");var c=o("WAWebBaseModel").defineModel(u),d={description:null,email:null,website:null,latitude:null,longitude:null};l.BUSINESS_URL_DOMAIN=e,l.MAX_BUSINESS_CATEGORIES=s,l.BusinessProfile=c,l.DEFAULTS=d}),98);
__d("WAWebSmbUtils",["fbt","WAWeb-moment","WAWebBusinessProfileTypes","WAWebSmbUtilsTimeUtils"],(function(t,n,r,o,a,i,l,s){function e(e){return r("WAWeb-moment").weekdays(e)}function u(e,t){switch(e==null?void 0:e.mode){case o("WAWebBusinessProfileTypes").BUSINESS_HOUR_MODES.SPECIFIC_HOURS:return t?d(e==null?void 0:e.hours):c(e==null?void 0:e.hours);case o("WAWebBusinessProfileTypes").BUSINESS_HOUR_MODES.APPOINTMENT_ONLY:return s._(/*BTDS*/"Solo con cita");case o("WAWebBusinessProfileTypes").BUSINESS_HOUR_MODES.OPEN_24H:return s._(/*BTDS*/"Abierto 24 horas");default:return s._(/*BTDS*/"Cerrado")}}function c(e){return e?e.map(function(e){return e.map(o("WAWebSmbUtilsTimeUtils").minutesToTime).join(" - ")}).join("\n"):""}function d(e){if((e==null?void 0:e.length)===1)return e[0].map(o("WAWebSmbUtilsTimeUtils").minutesToTime).join(" - ");if((e==null?void 0:e.length)===2){var t,n=(t=o("WAWebSmbUtilsTimeUtils")).minutesToTime(e[0][0]),r=t.minutesToTime(e[0][1]),a=t.minutesToTime(e[1][0]),i=t.minutesToTime(e[1][1]);return s._(/*BTDS*/"{openTime} - {closeTime} y {additionalOpenTime} - {additionalCloseTime}",[s._param("openTime",n),s._param("closeTime",r),s._param("additionalOpenTime",a),s._param("additionalCloseTime",i)])}return""}function m(t,n){var r=t.config,a=new Date().getDay(),i=o("WAWebBusinessProfileTypes").DAYS_OF_WEEK.map(function(t,i){var l=(a+i)%o("WAWebBusinessProfileTypes").DAYS_OF_WEEK.length,s=o("WAWebBusinessProfileTypes").DAYS_OF_WEEK[l],c=e(l),d=u(r[s],n).toString();return{day:c,first:i===0,hours:d}});return i}function p(t){var n=t==null?{}:t.config,a=t||{},i=a.note,l=a.timezone,s,u=o("WAWebBusinessProfileTypes").DAYS_OF_WEEK.map(function(t,r){var a=n[t],i=!a,l=e(r),u;return a&&(s=a.mode,a.hours&&(u=a.hours.map(function(e){var t=e[0],n=e[1];return[o("WAWebSmbUtilsTimeUtils").minutesToTime(t),o("WAWebSmbUtilsTimeUtils").minutesToTime(n)]}))),{closed:i,dayKey:t,dayName:l,hours:u}}),c=r("WAWeb-moment").weekdays(!0,0),d=r("WAWeb-moment").weekdays().indexOf(c),m=u.splice(d),p=[].concat(m,u);return{days:p,mode:s,note:i,timezone:l}}l.getBusinessHours=m,l.getBusinessHoursForEdit=p}),226);
__d("WAWebBusinessProfileUtils",["fbt","WALogger","WAUpperFirst","WAWebBizGatingUtils","WAWebBotTypes","WAWebBusinessProfileModel","WAWebBusinessProfileTypes","WAWebCatalogCollection","WAWebContactCollection","WAWebExternalLink.react","WAWebSmbUtils","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l,s){var e,u=["business_hours","catalog_status","structured_address","service_areas","profile_options","address","legal_entity_details","fb_page","ig_professional","profile_is_linked","cover_photo","custom_url","automated_type","commands_description","welcome_message_protocol_mode","member_since_text","prompts","commands"],c="catalog_exists",d="https://business.facebook.com/commerce/",m=function(t){var e=t.config,n=t.timezone,r={};return e.forEach(function(e){var t=e.day_of_week,n=e.mode;if(o("WAWebBusinessProfileTypes").isBusinessHoursDayName(t))if(n===o("WAWebBusinessProfileTypes").BUSINESS_HOUR_MODES.SPECIFIC_HOURS){var a,i=e.open_time,l=e.close_time;r[t]||(r[t]={mode:n,hours:[]}),i!=null&&l!=null&&(a=r[t])!=null&&a.hours&&r[t].hours.push([i,l])}else r[t]={mode:n}}),{config:r,timezone:n}},p=function(t){var e,n;return(t==null||(e=t.profile_options)==null?void 0:e.commerce_experience)===o("WAWebBusinessProfileTypes").CommerceExperienceTypes.CATALOG||(t==null||(n=t.profile_options)==null?void 0:n.commerce_experience)===o("WAWebBusinessProfileTypes").CommerceExperienceTypes.META_CATALOG&&o("WAWebBizGatingUtils").isCatalogVariantsViewingEnabled()||(t==null?void 0:t.catalog_status)===c},_=function(t){if(t&&t instanceof o("WAWebBusinessProfileModel").BusinessProfile){var e,n;return((e=t.profileOptions)==null?void 0:e.commerceExperience)===o("WAWebBusinessProfileTypes").CommerceExperienceTypes.CATALOG||((n=t.profileOptions)==null?void 0:n.commerceExperience)===o("WAWebBusinessProfileTypes").CommerceExperienceTypes.META_CATALOG&&o("WAWebBizGatingUtils").isCatalogVariantsViewingEnabled()||t.catalogStatus===c}return p(t)},f=function(t){var e,n;return(t==null||(e=t.profileOptions)==null?void 0:e.commerceExperience)===o("WAWebBusinessProfileTypes").CommerceExperienceTypes.SHOP&&!!(!(t==null||(n=t.profileOptions)==null)&&n.shopURL)},g=function(t){var e,n;return(t==null||(e=t.profileOptions)==null?void 0:e.commerceExperience)===o("WAWebBusinessProfileTypes").CommerceExperienceTypes.NONE||f(t)&&!!(t!=null&&(n=t.profileOptions)!=null&&n.isBanned)},h=function(t){var e,n=t==null||(e=t.profileOptions)==null?void 0:e.shopURL;n!=null&&n!==""&&o("WAWebExternalLink.react").openExternalLink(n)},y=function(t){var e,n=t==null||(e=t.profileOptions)==null?void 0:e.commerceManagerURL,r=n!=null&&n!==""?n:d;o("WAWebExternalLink.react").openExternalLink(r)},C=function(t){return p(t)},b=function(t){var e=t.email,n=t.landline_number,o=t.mobile_number,a={email:e};return r("isStringNullOrEmpty")(n)||(a.landlineNumber=n),r("isStringNullOrEmpty")(o)||(a.mobileNumber=o),a},v=function(t){var e=t.email,n=t.landline_number,r=t.mobile_number;return b({email:e,landline_number:n,mobile_number:r})},S=function(t){var e=t.name,n=t.email,r=t.landline_number,o=t.mobile_number,a=b({email:n,landline_number:r,mobile_number:o});return babelHelpers.extends({},a,{name:e})},R=function(t){var e=t.entity_name,n=t.entity_type,o=t.is_registered,a=t.entity_type_custom,i=t.customer_care_details,l=t.grievance_officer_details,s={entityName:e,entityType:n,isRegistered:o};return r("isStringNullOrEmpty")(a)||(s.entityTypeCustom=a),i&&(s.customerCareDetails=v(i)),l&&(s.grievanceOfficerDetails=S(l)),s},L=function(n){var t=n.profile,a=n.id,i=n.queryCatalog;if(!t)return{id:a};var l=t.business_hours,s=t.catalog_status,c=t.structured_address,d=t.service_areas,p=t.profile_options,_=t.address,f=t.legal_entity_details,g=t.fb_page,h=t.ig_professional,y=t.profile_is_linked,b=t.cover_photo,v=t.custom_url,S=t.automated_type,L=t.commands_description,E=t.welcome_message_protocol_mode,k=t.member_since_text,I=t.prompts,T=t.commands,D=babelHelpers.objectWithoutPropertiesLoose(t,u),x={id:a};return l?x.businessHours=m(l):x.businessHours=null,k!=null&&o("WAWebBizGatingUtils").getFmxAgmEnabled()&&(x.memberSinceText=k),p&&(x.profileOptions={commerceExperience:p.commerce_experience,directConnection:p.direct_connection},p.cart_enabled!=null&&(x.profileOptions.cartEnabled=p.cart_enabled),p.shop_url!=null&&(x.profileOptions.shopURL=p.shop_url),p.commerce_manager_url!=null&&(x.profileOptions.commerceManagerURL=p.commerce_manager_url),p.is_banned!=null&&(x.profileOptions.isBanned=p.is_banned),p.is_profile_edit_disabled!=null&&(x.profileOptions.isProfileEditDisabled=p.is_profile_edit_disabled)),C(t)&&(x.catalogStatus=s,i&&o("WAWebCatalogCollection").CatalogCollection.findCarouselCatalog(a).then(function(e){var t=Array.isArray(e)?e[0]:e,n=o("WAWebContactCollection").ContactCollection.get(a);n&&(n.businessCatalog=t)}).catch(function(t){return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Store:BusinessProfile:missing catalog"]))).devConsole(t)})),c?x.structuredAddress={streetAddress:c.street_address,cityId:c.city_id,localizedCityName:c.localized_city_name,zipCode:c.zip_code}:x.address=r("isStringNullOrEmpty")(_)?null:_,f&&(x.legalEntityDetails=R(f)),g&&(x.fbPage={displayName:g.display_name,likes:g.likes,id:g.id}),h&&(x.igProfessional={handle:h.ig_handle,followers:h.followers}),y!=null&&(x.isProfileLinked=!!y),v!=null&&(x.customUrlPath=v),x.automatedType=S!=null?S:o("WAWebBotTypes").BizBotAutomatedType.UNKNOWN,x.welcomeMsgProtocolMode=E!=null?E:o("WAWebBotTypes").BotWelcomeMsgProtocolModeType.NONE,x.commandsDescription=L!=null?L:null,x.prompts=I!=null?I:null,x.commands=T!=null?T:null,x.coverPhoto=b!=null?{id:b.id,url:b.url}:null,babelHelpers.extends({},o("WAWebBusinessProfileModel").DEFAULTS,D,x)},E=function(t){var e,n;return t.address!=null&&t.description!=null&&((e=t.businessHours)==null?void 0:e.config)!=null&&Object.keys(t.businessHours.config).length!==0&&t.email!=null&&((n=t.website)==null?void 0:n.length)!==0},k={OPEN:"open",CLOSED:"closed",OPEN_TODAY:"open_today",CLOSED_TODAY:"closed_today",OPEN_APPOINTMENT:"open_appointment",OPEN_24H:"open_24h",UNKNOWN:"unknown"};function I(e,t){if(e.timezone==null)return{status:"unknown"};var n=t||new Date,r=new Date(n.toLocaleString("en-US",{timeZone:e.timezone})),a=(n.getTime()-r.getTime())/1e3/60,i=e.config[o("WAWebBusinessProfileTypes").DAYS_OF_WEEK[n.getDay()]];if(!i)return{status:k.CLOSED_TODAY};var l=i.mode;switch(l){case o("WAWebBusinessProfileTypes").BUSINESS_HOUR_MODES.OPEN_24H:if(i)return{status:k.OPEN_24H};break;case o("WAWebBusinessProfileTypes").BUSINESS_HOUR_MODES.APPOINTMENT_ONLY:if(i)return{status:k.OPEN_APPOINTMENT};break;case o("WAWebBusinessProfileTypes").BUSINESS_HOUR_MODES.SPECIFIC_HOURS:{var s,u,c=n.getHours()*60+n.getMinutes();if(((s=i.hours)==null?void 0:s.length)===1){var d=i.hours[0][0],m=i.hours[0][1];return c>=d&&c<=m?{status:k.OPEN,openUntil:T(a+m)}:c<=d?{status:k.CLOSED,opensAt:T(a+d)}:{status:k.CLOSED}}else if(((u=i.hours)==null?void 0:u.length)===2){var p=i.hours[0][0],_=i.hours[0][1],f=i.hours[1][0],g=i.hours[1][1];return c>=p&&c<=_?{status:k.OPEN,openUntil:T(a+_),additionalOpen:T(a+f),additionalClose:T(a+g)}:c<p?{status:k.CLOSED,opensAt:T(a+p),additionalOpen:T(a+f),additionalClose:T(a+g)}:c>=f&&c<=g?{status:k.OPEN,openUntil:T(a+g)}:c<f?{status:k.CLOSED,opensAt:T(a+f)}:{status:k.CLOSED}}break}}return{status:"unknown"}}function T(e){var t=new Date,n=Math.floor(e/60);return t.setHours(n),t.setMinutes(e%60),t.setSeconds(0),t}function D(e){var t=I(e);switch(t.status){case k.OPEN_24H:case k.OPEN_APPOINTMENT:case k.OPEN:return!0;case k.CLOSED:case k.CLOSED_TODAY:default:return!1}}function x(e){var t=D(e)?s._(/*BTDS*/"En este momento est\u00e1 *abierto*"):s._(/*BTDS*/"En este momento est\u00e1 *cerrado*"),n=s._(/*BTDS*/"Nuestro horario comercial es el siguiente:"),a=o("WAWebSmbUtils").getBusinessHours(e,!0),i=a.map(function(e){return r("WAUpperFirst")(e.day)+": "+e.hours}).join("\n");return[t,n,i].join("\n")}l.CATALOG_EXISTS=c,l.hasCatalog=_,l.hasShop=f,l.isShopBanned=g,l.goToShop=h,l.goToCommerceManager=y,l.parseBusinessProfile=L,l.isCompleteBizProfile=E,l.BUSINESS_OPEN_STATUS=k,l.getBusinessOpenState=I,l.quickReplyHoursStr=x}),226);
__d("WAWebButtonCollection",["WAWebBaseCollection","WAWebButtonModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=r("WAWebButtonModel"),l.ButtonCollection=e}),98);
__d("WAWebChatProductMsgsCollection",["Promise","WAWebBaseCollection","WAWebFrontendMsgGetters","WAWebMsgModel"],(function(t,n,r,o,a,i,l){var e,s=(function(t){function r(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,e.hasProductBefore=!0,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(r,t);var a=r.prototype;return a.delete=function(){t.prototype.delete.call(this),this.stopListening(),this.reset()},a.queryProducts=function(r,a){var t=r.msgs;this.hasProductBefore=!1;var i=t.filter(function(e){return o("WAWebFrontendMsgGetters").getAsProduct(e)!=null});return i.length===0?this.trigger("products_loaded"):this.add(i,{at:0}),(e||(e=n("Promise"))).resolve()},r})(o("WAWebBaseCollection").BaseCollection);s.model=o("WAWebMsgModel").Msg,s.comparator=function(e,t){return e.t-t.t},l.default=s}),98);
__d("WAWebMsgButtonReplyMsgModel",["WAWebBaseModel","WAWebMsgKey"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.unsyncedButtonReplies=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="msgButtonReplyMsg",e.idClass=r("WAWebMsgKey");var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebMsgButtonReplyMsgCollection",["WAWebBaseCollection","WAWebMsgButtonReplyMsgModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=r("WAWebMsgButtonReplyMsgModel"),l.default=e}),98);
__d("WAWebTemplateButtonCollection",["WAWebBaseCollection","WAWebTemplateButtonModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=r("WAWebTemplateButtonModel"),e.comparator=function(e,t){return e.id<t.id?-1:e.id>t.id?1:0},l.TemplateButtonCollection=e}),98);
__d("WAWebTemplateButtonReplyMsgCollection",["WAWebBaseCollection","WAWebMsgModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebMsgModel").Msg,e.comparator=function(e,t){return t.t-e.t},l.default=e}),98);
__d("WAWebAgentCollection",["WAWebAgentModel","WAWebAgentModelUtils","WAWebBaseCollection","WAWebConnModel","WAWebSyncdOrphan","promiseDone"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){var t;return t=e.call(this)||this,t.$AgentCollectionImpl$p_1=new Map,t.triggerDeviceIdMapUpdate=function(){t.$AgentCollectionImpl$p_1=new Map,t.getModelsArray().forEach(function(e){t.$AgentCollectionImpl$p_1.set(e.deviceId,e)})},t.on("remove reset",t.triggerDeviceIdMapUpdate),o("WAWebConnModel").Conn.on("change:pushname",function(){var e=t.getModelsArray().filter(function(e){return e.deviceId===o("WAWebAgentModelUtils").PRIMARY_DEVICE_ID})[0];e!=null&&e.set("name",o("WAWebAgentModelUtils").getFormattedAgentNameForAgent(e))}),t}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.add=function(n,a){var t=e.prototype.add.call(this,n,a);return this.triggerDeviceIdMapUpdate(),r("promiseDone")(o("WAWebSyncdOrphan").checkOrphanAgents(t.map(function(e){var t;return(t=e==null?void 0:e.id)!=null?t:""}))),t},n.getByDeviceId=function(t){return this.$AgentCollectionImpl$p_1.get(t)},n.initializeFromCache=function(t){this.add(t,{merge:!0})},t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebAgentModel").Agent;var s=new e;l.AgentCollection=s}),98);
__d("WAWebAgentModel",["WAWebAgentCollection","WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.deviceId=o("WAWebBaseModel").prop(),t.name=o("WAWebBaseModel").prop(),t.isDeleted=o("WAWebBaseModel").prop(!1),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getCollection=function(){return o("WAWebAgentCollection").AgentCollection},t})(o("WAWebBaseModel").BaseModel);e.Proxy="agent";var s=o("WAWebBaseModel").defineModel(e);l.Agent=s}),98);
__d("WAWebAgentModelUtils",["fbt","WAWebBizGatingUtils","WAWebConnModel","WAWebPremiumAccessEngine"],(function(t,n,r,o,a,i,l,s){function e(){return s._(/*BTDS*/"{business-name} (admin.)",[s._param("business-name",o("WAWebConnModel").Conn.pushname)])}function u(){return o("WAWebBizGatingUtils").isMultiDeviceMessageAttributionEnabled()&&o("WAWebPremiumAccessEngine").isInitializedAndFeatureFlagEnabled("MD_EXTENSION")}var c=0;function d(t,n){return n===c?e().toString():t}function m(e){return d(e.name,e.deviceId)}l.canUserSeeMessageAttribution=u,l.PRIMARY_DEVICE_ID=c,l.getFormattedAgentName=d,l.getFormattedAgentNameForAgent=m}),226);
__d("WAWebUnattributedMessageCollection",["WAWebBaseCachePolicy","WAWebBaseCollection","WAWebUnattributedMessageModel","WAWebUserPrefsKeys"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebUnattributedMessageModel").UnattributedMessage,e.cachePolicy={id:o("WAWebUserPrefsKeys").COLLECTIONS_KEYS.UNATTRIBUTED_MESSAGE_COLLECTION,policy:o("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:1e3};var s=new e;l.UnattributedMessageCollection=s}),98);
__d("WAWebUnattributedMessageModel",["WAWebBaseModel","WAWebUnattributedMessageCollection"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.deviceId=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getCollection=function(){return o("WAWebUnattributedMessageCollection").UnattributedMessageCollection},t})(o("WAWebBaseModel").BaseModel);e.Proxy="unattributed_message";var s=o("WAWebBaseModel").defineModel(e);l.UnattributedMessage=s}),98);
__d("WAWebPremiumAccessEngine",["Promise","WALogger","WAWebBizGatingUtils","WAWebInitFromStorage","WAWebSubscriptionCollection","asyncToGeneratorRuntime","err","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f="{}";r("gkx")("26258")||(f='{"CUSTOM_URL": ["WA_PREMIUM_1"], "MD_EXTENSION": ["WA_PREMIUM_1"]}');var g=new Map,h=new Map,y=!1,C=null;function b(e){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e===void 0&&(e=f),!y&&o("WAWebBizGatingUtils").isSmbOrangeEnabled()){yield o("WAWebInitFromStorage").restoreSubscriptions(),C=D(e);var t=T();t.forEach(function(e,t){h.set(t,{subscription:e[0].clone(),hasChanged:!1})}),y=!0,yield(_||(_=n("Promise"))).resolve(),g.forEach(function(e,t){var n=h.get(t);e.forEach(function(e){try{e((n==null?void 0:n.subscription)||null,(n==null?void 0:n.hasChanged)||!1)}catch(e){o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["PremiumAccessEngine: error calling handler during initialize for feature ",", error ",""])),t,e).sendLogs("PremiumAccessEngine")}})})}}),v.apply(this,arguments)}function S(t,r){if(!o("WAWebBizGatingUtils").isSmbOrangeEnabled())return(_||(_=n("Promise"))).resolve().then(function(){return r(null,!1)}),function(){};var a=g.get(t);return a||(a=new Set,g.set(t,a)),a.add(r),y&&(_||(_=n("Promise"))).resolve().then(function(){var n=h.get(t);try{r((n==null?void 0:n.subscription)||null,(n==null?void 0:n.hasChanged)||!1)}catch(n){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["PremiumAccessEngine: error calling handler during listen for feature ",", error ",""])),t,n).sendLogs("PremiumAccessEngine")}}),function(){var e=g.get(t);e&&e.delete(r)}}function R(e){var t,n;if(!o("WAWebBizGatingUtils").isSmbOrangeEnabled())return null;if(!y)throw r("err")("Premium access engine getFeatureFlagState() for feature "+e+" called before initialize()");return(t=(n=h.get(e))==null?void 0:n.subscription)!=null?t:null}function L(e){var t;try{t=R(e)}catch(t){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(['isFeatureFlagEnabled: trying to read feature "','" before PremiumAccessEngine has been initialized, error ',""])),e,t).sendLogs("isFeatureFlagEnabled")}return t==null?!1:!t.isDeactivated||!1}function E(e){return y?L(e):!1}function k(){if(o("WAWebBizGatingUtils").isSmbOrangeEnabled()){if(!y)throw r("err")("Premium access engine update() called before initialize()");var e=T(),t=new Set;h.forEach(function(n,r){if(!e.has(r))n.hasChanged=!0,n.subscription=null,I(r),t.add(r);else{var o,a,i=(o=e.get(r))==null?void 0:o[0];(a=n.subscription)!=null&&a.equal(i)?n.hasChanged&&(n.hasChanged=!1,I(r)):(n.hasChanged=!0,n.subscription=i==null?void 0:i.clone(),I(r))}}),e.forEach(function(e,t){h.has(t)||(h.set(t,{hasChanged:!0,subscription:e[0].clone()}),I(t))}),t.forEach(function(e){return h.delete(e)})}}function I(e){var t=g.get(e),r=h.get(e);t&&r&&t.forEach(function(t){(_||(_=n("Promise"))).resolve().then(function(){t(r.subscription,r.hasChanged)}).catch(function(t){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["PremiumAccessEngine: error calling handler for feature ",", error ",""])),e,t).sendLogs("PremiumAccessEngine")})})}function T(){var e=new Map;return C&&Object.entries(C).forEach(function(t){var n=t[0],r=t[1];if(!(n!=="MD_EXTENSION"&&n!=="CUSTOM_URL")){var a=r.map(function(e){return o("WAWebSubscriptionCollection").SubscriptionCollection.get(e)}).filter(Boolean);a.length>0&&(a.length>1&&x(a),e.set(n,a))}}),e}function D(e){var t=!1,n=JSON.parse(e),r=Object.keys(n);return r.length>0?r.forEach(function(e){var r=n[e];Array.isArray(r)||(t=!0,o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["PremiumAccessEngine: invalid config for key ",", value is not an array"])),e).sendLogs("PremiumAccessEngine")),r.length===0&&(t=!0,o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["PremiumAccessEngine: invalid config for key ",", value is empty array"])),e).sendLogs("PremiumAccessEngine"))}):(o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["PremiumAccessEngine: config has no keys"]))),t=!0),t?null:n}function x(e){e.sort(function(e,t){return e.isDeactivated&&!t.isDeactivated?1:!e.isDeactivated&&t.isDeactivated?-1:e.isDeactivated&&t.isDeactivated?0:e.isAutoRenewing&&!t.isAutoRenewing?-1:t.isAutoRenewing&&!e.isAutoRenewing?1:!e.isAutoRenewing&&!t.isAutoRenewing?(t.expirationDate||0)-(e.expirationDate||0):0})}l.initialize=b,l.listen=S,l.getFeatureFlagState=R,l.isFeatureFlagEnabled=L,l.isInitializedAndFeatureFlagEnabled=E,l.update=k}),98);
__d("WAWebSubscriptionModel",["WAWebBaseModel","lodash"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.isDeactivated=o("WAWebBaseModel").prop(!1),t.isAutoRenewing=o("WAWebBaseModel").prop(!1),t.expirationDate=o("WAWebBaseModel").prop(),t.creationTime=o("WAWebBaseModel").prop(),t.newMessageCappingEnabled=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.equal=function(t){return t?t.id===this.id&&t.isAutoRenewing===this.isAutoRenewing&&t.isDeactivated===this.isDeactivated&&t.expirationDate===this.expirationDate&&t.creationTime===this.creationTime&&t.newMessageCappingEnabled===this.newMessageCappingEnabled:!1},n.clone=function(){var e=r("lodash").clone(this);return e},t})(o("WAWebBaseModel").BaseModel);e.Proxy="subscription";var s=o("WAWebBaseModel").defineModel(e);l.Subscription=s}),98);
__d("WAWebSubscriptionCollection",["WAWebBaseCollection","WAWebSubscriptionModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initializeFromCache=function(t){this.add(t,{merge:!0})},t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebSubscriptionModel").Subscription;var s=new e;l.SubscriptionCollection=s}),98);
__d("WAWebCartCollection",["WALogger","WAWebBaseCachePolicy","WAWebBaseCollection","WAWebCartModel","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebUserPrefsCartLidMigration","WAWebUserPrefsKeys","WAWebWidFactory"],(function(t,n,r,o,a,i,l){var e,s=(function(t){function n(e,n){var r;return r=t.call(this)||this,r.imageWidth=100,r.imageHeight=100,e!=null&&(r.imageWidth=e),n!=null&&(r.imageHeight=n),r}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.initializeFromCache=function(n){var t=this;try{var a=n||[];a.forEach(function(e){var n=new(r("WAWebCartModel"))({id:e.id,itemCount:e.itemCount,total:e.total,currency:e.currency,message:e.message});t.add(n,{merge:!0});var o=t.get(n.id);o==null||o.cartItemCollection.add(e.products,{merge:!0})})}catch(t){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Error while restoring carts from cache, ",""])),String(t))}},a.findCart=function(t){if(o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&o("WAWebUserPrefsCartLidMigration").isCartLidMigrationComplete()){var e=o("WAWebLidMigrationUtils").toUserLidOrThrow(o("WAWebWidFactory").createUserWidOrThrow(t));return this.gadd(e.toString())}return this.gadd(t)},n})(o("WAWebBaseCollection").BaseCollection);s.model=r("WAWebCartModel"),s.cachePolicy={id:o("WAWebUserPrefsKeys").COLLECTIONS_KEYS.CART_COLLECTION,policy:o("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:2e3};var u=new s;l.CartCollection=u}),98);
__d("WAWebCartItemCollection",["WAWebBaseCollection","WAWebCartItemModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebCartItemModel").CartItem,l.CartItemCollection=e}),98);
__d("WAWebCartItemModel",["WAWebBaseModel","WAWebCartCollection"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.priceAmount1000=o("WAWebBaseModel").prop(),t.currency=o("WAWebBaseModel").prop(),t.name=o("WAWebBaseModel").prop(),t.quantity=o("WAWebBaseModel").prop(),t.imageHash=o("WAWebBaseModel").prop(),t.imageCdnUrl=o("WAWebBaseModel").prop(),t.maxAvailable=o("WAWebBaseModel").prop(),t.variantProperties=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getCollection=function(){return o("WAWebCartCollection").CartCollection},t})(o("WAWebBaseModel").BaseModel);e.Proxy="cart-item";var s=o("WAWebBaseModel").defineModel(e);l.CartItem=s}),98);
__d("WAWebCartModel",["WAWebBaseModel","WAWebCartCollection","WAWebCartItemCollection"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.products=o("WAWebBaseModel").prop(),t.itemCount=o("WAWebBaseModel").prop(),t.total=o("WAWebBaseModel").prop(),t.currency=o("WAWebBaseModel").prop(),t.message=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.countTotals=function(){var e=this.cartItemCollection.reduce(function(e,t){var n;return e.currency.add(t.currency),{itemCount:e.itemCount+t.quantity,total:e.total+t.quantity*((n=t.priceAmount1000)!=null?n:0),currency:e.currency}},{itemCount:0,total:0,currency:new Set}),t=e.currency.size===1,n={itemCount:e.itemCount,total:t?e.total:null,currency:t?e.currency.values().next().value:null};this.set(n,{silent:!0})},n.initialize=function(){e.prototype.initialize.call(this),this.cartItemCollection=new(o("WAWebCartItemCollection")).CartItemCollection,this.listenTo(this,"change:cartItemCollection",this.countTotals)},n.getCollection=function(){return o("WAWebCartCollection").CartCollection},t})(o("WAWebBaseModel").BaseModel);e.Proxy="cart";var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebAssignedAgentsCollection",["WAWebAgentModel","WAWebBaseCollection"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebAgentModel").Agent,l.AssignedAgentsCollection=e}),98);
__d("WAWebChatAssignmentCollection",["WALogger","WAWebAgentCollection","WAWebAssignedAgentsCollection","WAWebBaseCollection","WAWebChatAssignmentModel","WAWebWidFactory"],(function(t,n,r,o,a,i,l){var e,s=(function(t){function n(){var e;return e=t.call(this)||this,e.$ChatAssignmentCollectionImpl$p_1=new Map,e.$ChatAssignmentCollectionImpl$p_2=new Map,e.$ChatAssignmentCollectionImpl$p_3=[],e.listenTo(e,"add",e.$ChatAssignmentCollectionImpl$p_4),e.listenTo(e,"remove",e.$ChatAssignmentCollectionImpl$p_5),e.listenTo(e,"change",e.$ChatAssignmentCollectionImpl$p_6),e.listenTo(o("WAWebAgentCollection").AgentCollection,"add",e.$ChatAssignmentCollectionImpl$p_7),e}babelHelpers.inheritsLoose(n,t);var r=n.prototype;return r.$ChatAssignmentCollectionImpl$p_4=function(n){this.$ChatAssignmentCollectionImpl$p_1.set(n.chatId,!n.chatOpenedByAgent);var t=this.getAgentCollectionForChatId(o("WAWebWidFactory").createWid(n.chatId));if(n.agent==null){var r=o("WAWebAgentCollection").AgentCollection.get(n.agentId);r!=null?n.agent=r:o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["chat_assignment_collection:_handleAdd failed"]))).sendLogs("chat_assignment_collection:_handleAdd: attempted to add assignment without agent")}n.agent!=null&&t.add(n.agent)},r.$ChatAssignmentCollectionImpl$p_5=function(t){var e=this.$ChatAssignmentCollectionImpl$p_2.get(t.chatId);e&&e.remove(t.agent),this.$ChatAssignmentCollectionImpl$p_1.delete(t.chatId)},r.$ChatAssignmentCollectionImpl$p_6=function(t){this.$ChatAssignmentCollectionImpl$p_1.set(t.chatId,!t.chatOpenedByAgent),this.getAgentCollectionForChatId(o("WAWebWidFactory").createWid(t.chatId)).trigger("change",[])},r.$ChatAssignmentCollectionImpl$p_7=function(t){var e=this.$ChatAssignmentCollectionImpl$p_3.filter(function(e){return e.agentId===t.id});this.processChatAssignments(e)},r.processChatAssignments=function(t){var e=this,n=[];t.forEach(function(t){var r,a=o("WAWebAgentCollection").AgentCollection.get(t.agentId);if(((r=e.get(t.id))==null?void 0:r.agent.id)===t.agentId){var i;(i=e.get(t.id))==null||i.set({chatOpenedByAgent:t.chatOpenedByAgent})}else a&&!a.isDeleted?n.push(new(o("WAWebChatAssignmentModel")).ChatAssignment({id:t.id,chatId:t.chatId,chatOpenedByAgent:t.chatOpenedByAgent,agent:a})):e.$ChatAssignmentCollectionImpl$p_3.push(t)}),this.add(n,{merge:!0})},r.getChatUnopenedStatus=function(t){return!!this.$ChatAssignmentCollectionImpl$p_1.get(t.toString({legacy:!0}))},r.reset=function(){this.$ChatAssignmentCollectionImpl$p_2.forEach(function(e){e.reset()}),t.prototype.reset.call(this)},r.getAgentCollectionForChatId=function(t){var e=this.$ChatAssignmentCollectionImpl$p_2.get(t.toString({legacy:!0}));return e||(e=new(o("WAWebAssignedAgentsCollection")).AssignedAgentsCollection,this.$ChatAssignmentCollectionImpl$p_2.set(t.toString({legacy:!0}),e)),e},r.initializeFromCache=function(t){this.processChatAssignments(t)},n})(o("WAWebBaseCollection").BaseCollection);s.model=o("WAWebChatAssignmentModel").ChatAssignment;var u=new s;l.ChatAssignmentCollection=u}),98);
__d("WAWebChatAssignmentModel",["WAWebBaseModel","WAWebChatAssignmentCollection"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.chatId=o("WAWebBaseModel").prop(),t.agent=o("WAWebBaseModel").prop(),t.agentId=o("WAWebBaseModel").prop(),t.chatOpenedByAgent=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getCollection=function(){return o("WAWebChatAssignmentCollection").ChatAssignmentCollection},t})(o("WAWebBaseModel").BaseModel);e.Proxy="chat_assignment";var s=o("WAWebBaseModel").defineModel(e);l.ChatAssignment=s}),98);
__d("WAWebChatAssignmentUtils",["WAWebBizGatingUtils","WAWebPremiumAccessEngine","WAWebProtobufsE2E.pb"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebBizGatingUtils").chatAssignmentEnabled()&&o("WAWebPremiumAccessEngine").isInitializedAndFeatureFlagEnabled("MD_EXTENSION")}function s(e){return e==null?!1:e.every(function(e){return u(e)})}function u(t){return o("WAWebBizGatingUtils").isBizAiChatAssignmentHidingEnabled()===!1?e():t==null?!1:e()&&t.capiThreadControl!==o("WAWebProtobufsE2E.pb").Message$CloudAPIThreadControlNotification$CloudAPIThreadControl.CONTROL_TAKEN}function c(t){return t!==!0&&o("WAWebBizGatingUtils").chatAssignmentSystemMessagesEnabled()&&e()}l.canAssignChats=e,l.canAssignAllChats=s,l.canAssignChat=u,l.shouldUseChatAssignmentCTA=c}),98);
__d("WAWebBizOrderGetFriendlyRandomIdAction",[],(function(t,n,r,o,a,i){function e(){var e=typeof BigInt=="function"?BigInt:Number;return e(String(Date.now())+Math.random().toFixed(4).slice(-4)).toString(36).toUpperCase()}i.default=e}),66);
__d("WAWebOrderCollection",["Promise","WAWebBaseCollection","WAWebBizOrderAction","WAWebBizOrderGetFriendlyRandomIdAction","WAWebCurrencyUtils","WAWebE2EProtoUtils","WAWebL10NCountryCodes","WAWebOrderModel","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=(function(t){function a(e,n){var r;return r=t.call(this)||this,r.width=80,r.height=80,e!=null&&(r.width=e),n!=null&&(r.height=n),r}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.addOrder=function(){var e=r("WAWebBizOrderGetFriendlyRandomIdAction")(),n=o("WAWebUserPrefsMeUser").getMePnUserOrThrow();return t.prototype.add.call(this,{id:e,fetchedFromServer:!1,sellerJid:o("WAWebE2EProtoUtils").encodeJid(n),createdAt:Math.round(new Date().getTime()/1e3),currency:o("WAWebCurrencyUtils").currencyForCountryShortcode(o("WAWebL10NCountryCodes").getCountryShortcodeByPhone(n.user)),products:[],tax:null,subtotal:null,total:null}),this.assertGet(e)},i.findOrder=function(r,o,a){var t=this.get(r);return t!=null?(e||(e=n("Promise"))).resolve(t):this.$OrderCollectionImpl$p_1(r,o,a)},i.$OrderCollectionImpl$p_1=(function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(r,a,i){var l=yield o("WAWebBizOrderAction").queryOrder(o("WAWebWidFactory").createWid(a),r,this.width,this.height,i);t.prototype.add.call(this,babelHelpers.extends({id:r,fetchedFromServer:!0,sellerJid:a},l));var s=this.get(r);if(s!=null)return(e||(e=n("Promise"))).resolve(s)});function a(e,t,n){return r.apply(this,arguments)}return a})(),a})(o("WAWebBaseCollection").BaseCollection);s.model=r("WAWebOrderModel"),s.staleCollection=!0;var u=new s;l.OrderCollection=u}),98);
__d("WAWebOrderItemCollection",["WAWebBaseCollection","WAWebOrderItemModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=r("WAWebOrderItemModel"),l.OrderItemCollection=e}),98);
__d("WAWebOrderItemModel",["WAWebBaseModel","WAWebOrderCollection","WAWebOrderItemGetters"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.price=o("WAWebBaseModel").prop(),t.currency=o("WAWebBaseModel").prop(),t.name=o("WAWebBaseModel").prop(),t.quantity=o("WAWebBaseModel").prop(),t.thumbnailId=o("WAWebBaseModel").prop(),t.thumbnailUrl=o("WAWebBaseModel").prop(),t.isCustomItem=o("WAWebBaseModel").prop(),t.isQuantitySet=o("WAWebBaseModel").prop(),t.properties=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getCollection=function(){return o("WAWebOrderCollection").OrderCollection},n.delete=function(){e.prototype.delete.call(this),o("WAWebOrderItemGetters").clearOrderItemGetterCacheFor(this)},t})(o("WAWebBaseModel").BaseModel);e.Proxy="order-item";var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebOrderGetters",["WAWebGetters","WAWebGettersCaches"],(function(t,n,r,o,a,i,l){var e=o("WAWebGetters").createGetterFactories({createCache:o("WAWebGettersCaches").createOrderCache}),s=e.field,u=e.computed,c=e.clearCacheFor,d=c,m=s("products"),p=u(function(e){var t=e[0];return t.reduce(function(e,t){return e+t.quantity},0)},[m]);l.clearOrderGetterCacheFor=d,l.getTotalItemCount=p}),98);
__d("WAWebOrderModel",["WAWebBaseModel","WAWebOrderCollection","WAWebOrderGetters","WAWebOrderItemCollection","WAWebOrderItemModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.products=o("WAWebBaseModel").prop(),t.itemCount=o("WAWebBaseModel").prop(),t.subtotal=o("WAWebBaseModel").prop(),t.tax=o("WAWebBaseModel").prop(),t.total=o("WAWebBaseModel").prop(),t.currency=o("WAWebBaseModel").prop(),t.createdAt=o("WAWebBaseModel").prop(),t.sellerJid=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){e.prototype.initialize.call(this),this.orderItemCollection=new(o("WAWebOrderItemCollection")).OrderItemCollection,this.listenTo(this,"change:cartItemCollection",this.triggerItemCollectionUpdate),this.triggerItemCollectionUpdate()},n.triggerItemCollectionUpdate=function(){this.orderItemCollection.set(this.products.map(function(e){return new(r("WAWebOrderItemModel"))(babelHelpers.extends({},e))}),{merge:!0})},n.getCollection=function(){return o("WAWebOrderCollection").OrderCollection},n.delete=function(){e.prototype.delete.call(this),o("WAWebOrderGetters").clearOrderGetterCacheFor(this)},t})(o("WAWebBaseModel").BaseModel);e.Proxy="order";var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebProductCatalogLogQplEvents",["WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule"],(function(t,n,r,o,a,i,l){function e(e){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_MESSAGE_SEND,e)}function s(e){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_CATALOG_VIEW,e)}l.qplPointProductMessageSend=e,l.qplPointCatalogView=s}),98);
__d("WAWebCatalogCollection",["Promise","WALogger","WAWebBackendErrors","WAWebBaseCollection","WAWebBizGatingUtils","WAWebBizProductCatalogAction","WAWebBizProductCatalogBridge","WAWebCatalogModel","WAWebCatalogVariantHelper","WAWebLidMigrationUtils","WAWebMsgGetters","WAWebProductCatalogLogQplEvents","WAWebQplQuickPerformanceLoggerModule","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","err","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,e.selfCatalogErrorEmailMask=null,e.findQueryImpl=function(t,n){return e._findImplCommon(t,n).then(function(e){return[e]})},e.findImpl=function(t){var n=e.convertCatalogIdForLidMigration(t);return e._findImplCommon(n)},babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.addMsgAsProduct=function(n){var e=o("WAWebMsgGetters").getBusinessOwnerJid(n.unsafe()),r=e!=null?o("WAWebWidFactory").createWid(e):null;if(r!=null){var a=this.get(r),i=n.productId!=null?a==null?void 0:a.msgProductCollection.get(n.productId):null,l=n.productId!=null?a==null?void 0:a.productCollection.get(n.productId):null;if(!(l!=null&&l.t&&l.t>=n.t)&&!(i!=null&&i.fetchedFromServer)){var s=o("WAWebBizProductCatalogBridge").mapMsgToProductModel(n);return t.prototype.add.call(this,{id:r,afterCursor:void 0,_msgs:[s],stale:!0,fetchedFromServer:!!l},{merge:!0})}}},i._queryProduct=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var a=e.catalogWid,i=e.productId,l=e.productMsgMediaData,s=e.width,u=e.height,c=e.shouldFetchComplianceFields,m=e.canLogQpl,p=yield o("WAWebBizProductCatalogAction").queryProduct(a,i,s,u,c,m);if(p.error==="NOT_FOUND"){var _=this.get(a);return _==null||_.productCollection.remove(i),(d||(d=n("Promise"))).reject(new(o("WAWebBackendErrors")).E404("CatalogCollection:findProduct:_queryProduct NOT_FOUND"))}if(!p.data)return t.prototype.add.call(this,{id:a,afterCursor:void 0});var f=p.data;if(!f.image_cdn_urls)return(d||(d=n("Promise"))).reject(r("err")("CatalogCollection:findProduct:_queryProduct: could not find image_cdn_urls for product"));var g=o("WAWebBizProductCatalogBridge").mapProductResponseToModel(f,a);if(g.productMsgMediaData=l,g.variantInfo!=null){var h;((h=this.get(a))==null?void 0:h.productCollection.get(f.id))==null&&(g.displayPriority=1)}var y=[g];return t.prototype.add.call(this,{id:a,afterCursor:void 0,_products:y,_msgs:y},{merge:!0})});function a(t){return e.apply(this,arguments)}return a})(),i.findProduct=function(t){var e=t.catalogWid,o=t.productId,a=t.productMsgMediaData,i=t.shouldFetchComplianceFields,l=t.canLogQpl,s=this.convertCatalogIdForLidMigration(e);return r("isStringNullOrEmpty")(o)?(d||(d=n("Promise"))).reject(r("err")("CatalogCollection:findProduct Received productId type "+(o===void 0?"undefined":"null"))):this._queryProduct({catalogWid:s,productId:o,productMsgMediaData:a,shouldFetchComplianceFields:i,canLogQpl:l})},i._queryCatalog=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i,l,c,m){var p=t?t.index:0;m&&o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(m,"datasource_catalog_start");var _,f,g;try{o("WAWebBizGatingUtils").isCatalogVariantsViewingEnabled()&&(_=o("WAWebCatalogVariantHelper").FULL_VARIANT_INFO_FIELDS,f=o("WAWebCatalogVariantHelper").VARIANT_THUMBNAIL_IMAGE_SIZE,g=o("WAWebCatalogVariantHelper").VARIANT_THUMBNAIL_IMAGE_SIZE);var h=yield o("WAWebBizProductCatalogAction").queryCatalog(a,i,10,void 0,void 0,l,c,_,f,g);if(m&&o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(m,"datasource_catalog_end"),this.hasSelfCatalogErrorEmailMask()&&this.shouldUseCatalogErrorEmailMask(a)&&this.resetSelfCatalogErrorEmailMask(),!h.data.length)return{id:a,afterCursor:""};var y=[];h.data.forEach(function(e){e.image_cdn_urls&&y.push(o("WAWebBizProductCatalogBridge").mapProductResponseToModel(e,a))});var C={type:"success",catalog:h};this.trigger("catalog-loaded",C);var b=this.get(a);return b&&b.catalogId!=null&&h.catalog_id!=null&&b.catalogId!==h.catalog_id&&o("WAWebBizGatingUtils").isCatalogVariantsViewingEnabled()&&(o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[Catalog] Catalog model is being reset due to CatalogId changed"]))),this.remove(a)),{id:a,afterCursor:h.paging.cursors.after,_products:y,catalogId:h.catalog_id,catalogType:h.catalog_type,catalogName:h.catalog_name,fetchedFromServer:!0,index:p+y.length}}catch(e){if(e instanceof o("WAWebBackendErrors").AdAccountRecoveryRequiredError&&this.shouldUseCatalogErrorEmailMask(a)){if(r("isStringNullOrEmpty")(e.emailMask))return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Catalog:AdAccountRecoveryRequiredError received empty email mask"]))).sendLogs("catalog email mask empty"),(d||(d=n("Promise"))).reject(new(o("WAWebBackendErrors")).AdAccountRecoveryRequiredEmailMaskEmptyError);this.updateSelfCatalogErrorEmailMask(e.emailMask)}else if(e instanceof o("WAWebBackendErrors").CatalogIncorrectNonceError&&this.shouldUseCatalogErrorEmailMask(a)){var v={type:"incorrect-nonce"};return this.trigger("catalog-loaded",v),(d||(d=n("Promise"))).reject(e)}else if(this.hasSelfCatalogErrorEmailMask()&&this.shouldUseCatalogErrorEmailMask(a)&&this.resetSelfCatalogErrorEmailMask(),e instanceof o("WAWebBackendErrors").ServerStatusCodeError&&e.statusCode===404){var S=this.get(a);S!=null&&o("WAWebBizGatingUtils").isCatalogVariantsViewingEnabled()&&(o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[Catalog] Catalog model is being reset due to CatalogId not found anymore."]))),this.remove(a))}var R={type:"error"};return this.trigger("catalog-loaded",R),(d||(d=n("Promise"))).reject(e)}});function a(e,n,r,o,a,i){return t.apply(this,arguments)}return a})(),i._findImplCommon=function(t,n){var e=this.get(t),a=e&&!e.stale?e.afterCursor:void 0,i=t instanceof r("WAWebWid")?t:o("WAWebWidFactory").createWid(t.toString());return this._queryCatalog(e,i,a,void 0,void 0,n==null?void 0:n.markerId)},i.findCarouselCatalog=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n=this.convertCatalogIdForLidMigration(e),r=this.get(n);r&&r.set({index:0});var o=yield this._queryCatalog(r,n,void 0,void 0,!1);return r&&r.markProductCollectionOld(),t.prototype.add.call(this,o,{merge:!0})});function r(t){return e.apply(this,arguments)}return r})(),i.findNextProductPage=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=this.convertCatalogIdForLidMigration(e);t===!0&&o("WAWebProductCatalogLogQplEvents").qplPointCatalogView("datasource_start");var r=yield this.update(n);t===!0&&o("WAWebProductCatalogLogQplEvents").qplPointCatalogView("datasource_end");var a=Array.isArray(r)?r[0]:r;return a.productCollection.getProductModels()});function t(t,n){return e.apply(this,arguments)}return t})(),i.findCollectionMembership=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,n){var r=this.convertCatalogIdForLidMigration(e),o=this.get(r),a=o&&!o.stale?o.afterCursor:void 0,i=yield this._queryCatalog(o,r,a,n);t.prototype.add.call(this,i,{merge:!0}),o=this.get(r),o&&(o.stale=!1)});function r(t,n){return e.apply(this,arguments)}return r})(),i.removeCatalog=function(t){var e=this.convertCatalogIdForLidMigration(t),n=this.get(e);n?this.remove(e):o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Catalog data cleanup called on a non-existent catalogId"])))},i.get=function(n){return t.prototype.get.call(this,this.convertCatalogIdForLidMigration(n))},i.assertGet=function(n){return t.prototype.assertGet.call(this,this.convertCatalogIdForLidMigration(n))},i.convertCatalogIdForLidMigration=function(t){var e=t instanceof r("WAWebWid")?t:o("WAWebWidFactory").createWid(t.toString());if(!o("WAWebBizGatingUtils").isLidMigrationForCatalogEnabled())return e;if(e.isLid()){var n=o("WAWebLidMigrationUtils").toPn(e);if(n!=null)return n}return e},i.getSelfCatalogErrorEmailMask=function(){return this.selfCatalogErrorEmailMask},i.updateSelfCatalogErrorEmailMask=function(t){this.selfCatalogErrorEmailMask=t,this.trigger("change:selfCatalogErrorEmailMask")},i.resetSelfCatalogErrorEmailMask=function(){this.updateSelfCatalogErrorEmailMask(null)},i.hasSelfCatalogErrorEmailMask=function(){return this.selfCatalogErrorEmailMask!=null},i.shouldUseCatalogErrorEmailMask=function(t){return!(t==null||!o("WAWebUserPrefsMeUser").isMeAccount(t)||!o("WAWebBizGatingUtils").catalogTokenRecoveryEnabled())},a})(o("WAWebBaseCollection").BaseCollection);m.model=r("WAWebCatalogModel"),m.staleCollection=!0;var p=new m;l.CatalogCollection=p}),98);
__d("WAWebCatalogModel",["WANullthrows","WAWebBaseModel","WAWebBizProductCatalogAction","WAWebBizProductCatalogBridge","WAWebCatalogCollection","WAWebProductCollCollection","WAWebProductCollection","WAWebProductModel","WAWebWid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.catalogId=o("WAWebBaseModel").prop(),t.catalogType=o("WAWebBaseModel").prop(),t.catalogName=o("WAWebBaseModel").prop(),t.afterCursor=o("WAWebBaseModel").prop(),t.index=o("WAWebBaseModel").prop(),t.hasCatalogCategories=o("WAWebBaseModel").prop(),t.fetchedFromServer=o("WAWebBaseModel").session(),t._products=o("WAWebBaseModel").session(),t._msgs=o("WAWebBaseModel").session(),t.lastUsedCountryCode=o("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a.initialize=function(){e.prototype.initialize.call(this),this.productCollection=new(o("WAWebProductCollection")).ProductCollection,this.msgProductCollection=new(o("WAWebProductCollection")).ProductCollection,this.collections=new(o("WAWebProductCollCollection")).ProductCollCollection,this.listenTo(this,"change:_products",this.triggerProductUpdate),this.listenTo(this,"change:_msgs",this.triggerMsgUpdate),this.triggerProductUpdate(),this.triggerMsgUpdate()},a.triggerProductUpdate=function(){this._products&&this.productCollection.add(this._products,{merge:!0}),this._products=void 0},a.triggerMsgUpdate=function(){this._msgs&&this.msgProductCollection.add(this._msgs,{merge:!0}),this._msgs=void 0},a.markProductCollectionOld=function(){this.productCollection.forEach(function(e){return e.markOld()})},a.addProduct=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=this.id;this.maybeUpdateLastUsedCountryCode((t=e.complianceInfo)==null?void 0:t.countryCodeOrigin);var a=yield o("WAWebBizProductCatalogAction").addProduct(e);a.catalogWid=n;var i=this.productCollection.add(a,{merge:!0,at:0})[0];return r("WANullthrows")(i)});function t(t){return e.apply(this,arguments)}return t})(),a.editProduct=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=yield o("WAWebBizProductCatalogAction").editProduct(e);this.maybeUpdateLastUsedCountryCode((t=e.complianceInfo)==null?void 0:t.countryCodeOrigin);var a=this.productCollection.add(n,{merge:!0})[0];return this.collections&&this.collections.forEach(function(t){t.productCollection.get(e.id)&&t.productCollection.add(n,{merge:!0})}),r("WANullthrows")(a)});function t(t){return e.apply(this,arguments)}return t})(),a.refreshProduct=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this.productCollection.get(e);t&&(t.stale=!0);var n=yield o("WAWebBizProductCatalogAction").queryProduct(this.id,e);if(n.data!=null){var r=o("WAWebBizProductCatalogBridge").mapProductResponseToModel(n.data,this.id);t&&this.productCollection.add(r,{merge:!0}),this.collections&&this.collections.forEach(function(t){t.productCollection.get(e)&&t.productCollection.add(r,{merge:!0})})}});function t(t){return e.apply(this,arguments)}return t})(),a.maybeUpdateLastUsedCountryCode=function(t){t!=null&&(this.lastUsedCountryCode=t)},a.pullProduct=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WAWebBizProductCatalogAction").queryProduct(this.id,e,void 0,void 0,void 0,t);if(n.error==="NOT_FOUND"&&this.productCollection.remove(e),n.data!=null){var r=new(o("WAWebProductModel")).Product(o("WAWebBizProductCatalogBridge").mapProductResponseToModel(n.data,this.id));r.variantInfo!=null&&this.productCollection.get(r.id)==null&&(r.displayPriority=1),this.updateProduct(r)}});function t(t,n){return e.apply(this,arguments)}return t})(),a.updateProduct=function(t){if(this.productCollection.add(t,{merge:!1}),t.variantInfo!=null){var e=this.productCollection.get(t.id);e&&e.set("variantInfo",t.variantInfo)}},a.getCollection=function(){return o("WAWebCatalogCollection").CatalogCollection},a.getMostRecentlyApprovedProduct=function(){return this.productCollection.findFirst(function(e){return!e.isHidden&&e.isSanctioned!==!0&&e.reviewStatus==="APPROVED"})},t})(o("WAWebBaseModel").BaseModel);e.Proxy="catalog",e.idClass=r("WAWebWid");var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebBizCatalogManagementFetchCollectionsQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9687699931342731"}),null);
__d("WAWebBizCatalogManagementFetchCollectionsQuery.graphql",["WAWebBizCatalogManagementFetchCollectionsQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"request"}],t=[{kind:"Variable",name:"request",variableName:"request"}],r={alias:null,args:null,concreteType:"XFBWhatsAppCatalogPagingInfo",kind:"LinkedField",name:"paging",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"after",storageKey:null}],storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"catalog_type",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},_=[i,p],f=[{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},l,a,{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[a,s,u],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},i,c,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null},c,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null}],storageKey:null},d,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[m,d],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:_,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[i,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[p,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[a,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},s,u],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:_,storageKey:null}],storageKey:null}],g={alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[m,{alias:null,args:null,kind:"ScalarField",name:"commerce_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reject_reason",storageKey:null},d],storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementFetchCollectionsQuery",selections:[{alias:null,args:t,concreteType:"XFBWhatsAppCatalogGetCollectionsResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_collections",plural:!1,selections:[r,o,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogCollectionInfo",kind:"LinkedField",name:"collections",plural:!0,selections:[a,i,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"products",plural:!0,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebBizCatalogManagementParseProductGraphql_product",selections:f,args:null,argumentDefinitions:[]}],storageKey:null},g],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebBizCatalogManagementFetchCollectionsQuery",selections:[{alias:null,args:t,concreteType:"XFBWhatsAppCatalogGetCollectionsResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_collections",plural:!1,selections:[r,o,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogCollectionInfo",kind:"LinkedField",name:"collections",plural:!0,selections:[a,i,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"products",plural:!0,selections:f,storageKey:null},g],storageKey:null}],storageKey:null}]},params:{id:n("WAWebBizCatalogManagementFetchCollectionsQuery_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementFetchCollectionsQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebBizCatalogManagementFetchCollections",["Promise","WALogger","WAWebBizCatalogManagementFetchCollectionsQuery.graphql","WAWebBizCatalogManagementParseProductGraphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebProductTypes.flow","WAWebRelayClient"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m={type:"error"},p=e!==void 0?e:e=n("WAWebBizCatalogManagementFetchCollectionsQuery.graphql");function _(e){return o("WAWebBizGatingUtils").graphQLForGetCollectionsEnabled()?f(e).then(function(e){return e.type==="success"?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["fetchCollections: success"]))),e):(e.type,o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(['fetchCollections: failed as "','"'])),e.type),e)}):(d||(d=n("Promise"))).resolve({type:"not-enabled"})}function f(e){return o("WAWebFetchAdAccountToken").fetchToken().then(function(t){return t.type==="success"?g(t.token,e).then(function(e){return e.type!=="success"&&e.type==="auth-failure"?o("WAWebFetchAdAccountToken").markTokenAsInvalid():e.type,e}):(t.type,t)})}function g(e,t){var n;return r("WAWebNetworkStatus").waitIfOffline().then(function(){return o("WAWebRelayClient").fetchQuery(p,{request:t},{environmentType:"facebook",accessToken:e,getInlineDataReader:function(t){n=t}})}).then(function(e){var t,r,a,i;if(e==null)return m;var l=(t=e.xfb_whatsapp_catalog_collections)==null?void 0:t.collections;if(l==null)return m;var s=(r=e.xfb_whatsapp_catalog_collections)==null?void 0:r.paging,u=(a=s==null?void 0:s.after)!=null?a:"",c=l.map(function(e){var t,r=e.id,a=e.name,i=e.status_info,l=i==null?void 0:i.status,s=(t=l!=null?o("WAWebProductTypes.flow").asProductReviewType(l):void 0)!=null?t:"APPROVED",u=e.products.map(function(e){return n(o("WAWebBizCatalogManagementParseProductGraphql").PARSE_PRODUCT_FRAGMENT,e)}).map(o("WAWebBizCatalogManagementParseProductGraphql").parseProductGraphQL);return{id:r!=null?r:"",name:a!=null?a:"",rejectReason:i==null?void 0:i.reject_reason,commerceUrl:i==null?void 0:i.commerce_url,canAppeal:(i==null?void 0:i.can_appeal)==="true",reviewStatus:s,totalItemsCount:0,products:u,isHidden:!1}});return{type:"success",collectionsResult:{collections:c,afterCursor:u,catalog_type:(i=e.xfb_whatsapp_catalog_collections)==null?void 0:i.catalog_type}}}).catch(function(e){return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["fetchCollectionsWithToken: failed with error"]))).devConsole(e),o("WAWebFetchAdAccountToken").hasGraphQLAuthError(e)?{type:"auth-failure"}:e instanceof o("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:e}:m})}l.fetchCollections=_}),98);
__d("WAWebQueryProductCollectionsQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"request"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},c=[n,u],d=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"request"}],concreteType:"XWAProductCatalogGetCollectionsResponseSuccess",kind:"LinkedField",name:"xwa_product_catalog_get_collections",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,concreteType:"XWACatalogProductCollection",kind:"LinkedField",name:"collections",plural:!0,selections:[t,n,{alias:null,args:null,concreteType:"XWAProductCatalogCollectionStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[r,o,{alias:null,args:null,kind:"ScalarField",name:"reject_reason",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"commerce_url",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogProduct",kind:"LinkedField",name:"products",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},n,a,{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},i,{alias:null,args:null,concreteType:"XWAProductCatalogProductStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[o,r],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[t,l,s],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XWAVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:c,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[n,{alias:null,args:null,concreteType:"XWACatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[u,{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[t,{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},l,s],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:c,storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogPaging",kind:"LinkedField",name:"paging",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"after",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebQueryProductCollectionsQuery",selections:d,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebQueryProductCollectionsQuery",selections:d},params:{id:"9430970660362540",metadata:{},name:"WAWebQueryProductCollectionsQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebQueryProductCollections",["errorCode","WALogger","WAWebBackendErrors","WAWebBizCatalogManagementFetchCollections","WAWebBizGatingUtils","WAWebBizParseProductGraphql","WAWebCatalogEventLogger","WAWebGraphQLServerError","WAWebMaybeThrowCatalogErrors","WAWebProductTypes.flow","WAWebQueryProductCollectionsQuery.graphql","WAWebRelayClient","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l,s){var e,u,c,d=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(o("WAWebBackendErrors")).E451;try{var r=t.catalogWid,a=t.afterCursor,i=t.limit,l=t.productsCount,s=t.width,c=t.height,d=t.directConnectionEncryptedInfo,m=t.variantInfoFields,p=t.variantThumbnailHeight,_=t.variantThumbnailWidth,f=yield o("WAWebRelayClient").fetchQuery(e!==void 0?e:e=n("WAWebQueryProductCollectionsQuery.graphql"),{request:{collections:{biz_jid:r.toString(),collection_limit:String(i),item_limit:String(l),after:a,width:String(s),height:String(c),direct_connection_encrypted_info:d,variant_info_fields:m,variant_thumbnail_height:p!=null?String(p):null,variant_thumbnail_width:_!=null?String(_):null}}},{eventLogger:o("WAWebCatalogEventLogger").createCatalogEventLogger(o("WAWebCatalogEventLogger").GRAPHQL_CATALOG_ENDPOINT.GET_COLLECTIONS)});if((f==null?void 0:f.xwa_product_catalog_get_collections)==null)return{afterCursor:"",collections:[],catalog_type:null};var g=f.xwa_product_catalog_get_collections,h=g.collections,y=g.paging;return{afterCursor:(y==null?void 0:y.after)||"",collections:h.map(function(e){var t,n=e.id,r=e.name,a=e.status_info,i=e.products,l=a==null?void 0:a.status,s=(t=l!=null?o("WAWebProductTypes.flow").asProductReviewType(l):void 0)!=null?t:"APPROVED";return{id:n||"",name:r||"",canAppeal:(a==null?void 0:a.can_appeal)==="true",isHidden:!1,reviewStatus:s,totalItemsCount:0,products:i.map(o("WAWebBizParseProductGraphql").parseProductGraphQL),rejectReason:a==null?void 0:a.reject_reason,commerceUrl:a==null?void 0:a.commerce_url}}),catalog_type:null}}catch(e){if(e instanceof o("WAWebGraphQLServerError").GraphQLServerError){var C,b=((C=e.source)==null?void 0:C.errors)||[],v=b[0];if((v==null?void 0:v.code)===2498052)return{collections:[],afterCursor:"",catalog_type:null};o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(e)}throw o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["GraphQL: Failed fetching xwa_product_catalog_get_collections query."]))),new(o("WAWebBackendErrors")).CatalogUnknownError}});return function(n){return t.apply(this,arguments)}})(),m=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(o("WAWebBackendErrors")).E451;var t=e.catalogWid,n=e.afterCursor,r=e.limit,a=e.productsCount,i=e.width,l=e.height,s=e.directConnectionEncryptedInfo,u=e.variantInfoFields,d=e.variantThumbnailHeight,m=e.variantThumbnailWidth,p=yield o("WAWebBizCatalogManagementFetchCollections").fetchCollections({collections:{biz_jid:t.toJid(),after:n,collection_limit:String(r),item_limit:String(a),width:String(i),height:String(l),direct_connection_encrypted_info:s,variant_info_fields:u,variant_thumbnail_height:d!=null?String(d):null,variant_thumbnail_width:m!=null?String(m):null}});if(p.type==="success")return p.collectionsResult;if(p.type==="graphql-error"){var _;if(((_=p.error.source.errors[0])==null?void 0:_.code)===2498052)return{collections:[],afterCursor:"",catalog_type:null};o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(p.error)}else p.type;throw o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["queryCollectionsGraphQLByOwner: error handling flow not implemented for ",""])),JSON.stringify(p)),new(o("WAWebBackendErrors")).CatalogUnknownError});return function(n){return e.apply(this,arguments)}})(),p=function(t){var e=o("WAWebUserPrefsMeUser").getMaybeMePnUser();return e!=null&&e.equals(t.catalogWid)?m(t):d(t)},_=p;l.default=_}),98);
__d("WAWebBizCatalogManagementFetchSingleCollectionQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9547298772047931"}),null);
__d("WAWebBizCatalogManagementFetchSingleCollectionQuery.graphql",["WAWebBizCatalogManagementFetchSingleCollectionQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"request"}],t=[{kind:"Variable",name:"request",variableName:"request"}],r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},l={alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"commerce_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reject_reason",storageKey:null},i],storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},p=[o,m],_=[{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},s,r,{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[r,u,c],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},o,d,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null},d,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null}],storageKey:null},i,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[a,i],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[s,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:p,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[o,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[m,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[r,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},u,c],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:p,storageKey:null}],storageKey:null}],f={alias:null,args:null,concreteType:"XFBWhatsAppCatalogPagingInfo",kind:"LinkedField",name:"paging",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"after",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementFetchSingleCollectionQuery",selections:[{alias:null,args:t,concreteType:"XFBWhatsAppCatalogGetCollectionResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_collection",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogCollectionInfo",kind:"LinkedField",name:"collection",plural:!1,selections:[r,o,l,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"products",plural:!0,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebBizCatalogManagementParseProductGraphql_product",selections:_,args:null,argumentDefinitions:[]}],storageKey:null}],storageKey:null},f],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebBizCatalogManagementFetchSingleCollectionQuery",selections:[{alias:null,args:t,concreteType:"XFBWhatsAppCatalogGetCollectionResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_collection",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogCollectionInfo",kind:"LinkedField",name:"collection",plural:!1,selections:[r,o,l,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"products",plural:!0,selections:_,storageKey:null}],storageKey:null},f],storageKey:null}]},params:{id:n("WAWebBizCatalogManagementFetchSingleCollectionQuery_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementFetchSingleCollectionQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebBizCatalogManagementFetchSingleCollection",["Promise","WALogger","WAWebBizCatalogManagementFetchSingleCollectionQuery.graphql","WAWebBizCatalogManagementParseProductGraphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebProductTypes.flow","WAWebRelayClient"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m={type:"error"},p=e!==void 0?e:e=n("WAWebBizCatalogManagementFetchSingleCollectionQuery.graphql");function _(e){return o("WAWebBizGatingUtils").graphQLForGetSingleCollectionEnabled()?f(e).then(function(e){return e.type==="success"?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["fetchSingleCollection: success"]))),e):(e.type,o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(['fetchSingleCollection: failed as "','"'])),e.type),e)}):(d||(d=n("Promise"))).resolve({type:"not-enabled"})}function f(e){return o("WAWebFetchAdAccountToken").fetchToken().then(function(t){return t.type==="success"?g(t.token,e).then(function(e){return e.type!=="success"&&e.type==="auth-failure"?o("WAWebFetchAdAccountToken").markTokenAsInvalid():e.type,e}):(t.type,t)})}function g(e,t){var n;return r("WAWebNetworkStatus").waitIfOffline().then(function(){return o("WAWebRelayClient").fetchQuery(p,{request:t},{environmentType:"facebook",accessToken:e,getInlineDataReader:function(t){n=t}})}).then(function(e){var t,r,a,i;if(e==null)return m;var l=(t=e.xfb_whatsapp_catalog_collection)==null?void 0:t.collection;if(l==null)return m;var s=(r=e.xfb_whatsapp_catalog_collection)==null?void 0:r.paging,u=(a=s==null?void 0:s.after)!=null?a:"",c=l.id,d=l.name,p=l.status_info,_=l.products,f=p==null?void 0:p.status,g=(i=f!=null?o("WAWebProductTypes.flow").asProductReviewType(f):void 0)!=null?i:"APPROVED",h=_.map(function(e){return n(o("WAWebBizCatalogManagementParseProductGraphql").PARSE_PRODUCT_FRAGMENT,e)}).map(o("WAWebBizCatalogManagementParseProductGraphql").parseProductGraphQL),y={id:c!=null?c:"",name:d!=null?d:"",rejectReason:p==null?void 0:p.reject_reason,commerceUrl:p==null?void 0:p.commerce_url,canAppeal:(p==null?void 0:p.can_appeal)==="true",reviewStatus:g,totalItemsCount:0,products:h,isHidden:!1};return{type:"success",collectionsResult:{collections:[y],afterCursor:u,catalog_type:null}}}).catch(function(e){return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["fetchSingleCollectionWithToken: failed with error"]))).devConsole(e),o("WAWebFetchAdAccountToken").hasGraphQLAuthError(e)?{type:"auth-failure"}:e instanceof o("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:e}:m})}l.fetchSingleCollection=_}),98);
__d("WAWebQueryProductSingleCollectionQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"request"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},c=[n,u],d=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"request"}],concreteType:"XWAProductCatalogGetSingleCollectionResponseSuccess",kind:"LinkedField",name:"xwa_product_catalog_get_single_collection",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogProductCollection",kind:"LinkedField",name:"collection",plural:!1,selections:[t,n,{alias:null,args:null,concreteType:"XWAProductCatalogCollectionStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[r,o,{alias:null,args:null,kind:"ScalarField",name:"reject_reason",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"commerce_url",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogProduct",kind:"LinkedField",name:"products",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},n,a,{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},i,{alias:null,args:null,concreteType:"XWAProductCatalogProductStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[o,r],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[t,l,s],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XWAVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:c,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[n,{alias:null,args:null,concreteType:"XWACatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[u,{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[t,{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},l,s],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:c,storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogPaging",kind:"LinkedField",name:"paging",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"after",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebQueryProductSingleCollectionQuery",selections:d,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebQueryProductSingleCollectionQuery",selections:d},params:{id:"9546992575408789",metadata:{},name:"WAWebQueryProductSingleCollectionQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebQueryProductSingleCollection",["WALogger","WAWebBackendErrors","WAWebBizCatalogManagementFetchSingleCollection","WAWebBizGatingUtils","WAWebBizParseProductGraphql","WAWebCatalogEventLogger","WAWebGraphQLServerError","WAWebMaybeThrowCatalogErrors","WAWebProductTypes.flow","WAWebQueryProductSingleCollectionQuery.graphql","WAWebRelayClient","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(o("WAWebBackendErrors")).E451;try{var r,a=t.catalogWid,i=t.collectionId,l=t.afterCursor,u=t.limit,c=t.width,d=t.height,m=t.directConnectionEncryptedInfo,p=yield o("WAWebRelayClient").fetchQuery(e!==void 0?e:e=n("WAWebQueryProductSingleCollectionQuery.graphql"),{request:{collection:{biz_jid:a.toString(),id:i,limit:String(u),after:l,width:String(c),height:String(d),direct_connection_encrypted_info:m}}},{eventLogger:o("WAWebCatalogEventLogger").createCatalogEventLogger(o("WAWebCatalogEventLogger").GRAPHQL_CATALOG_ENDPOINT.GET_SINGLE_COLLECTION)}),_=(p==null?void 0:p.xwa_product_catalog_get_single_collection)||{},f=_.collection,g=_.paging,h=f||{},y=h.id,C=h.name,b=h.status_info,v=h.products,S=b==null?void 0:b.status,R=(r=S!=null?o("WAWebProductTypes.flow").asProductReviewType(S):void 0)!=null?r:"APPROVED";return{afterCursor:(g==null?void 0:g.after)||"",catalog_type:null,collections:[{id:y||"",name:C||"",canAppeal:(b==null?void 0:b.can_appeal)==="true",isHidden:!1,reviewStatus:R,totalItemsCount:0,products:v!=null?v.map(o("WAWebBizParseProductGraphql").parseProductGraphQL):[],rejectReason:b==null?void 0:b.reject_reason,commerceUrl:b==null?void 0:b.commerce_url}]}}catch(e){throw e instanceof o("WAWebGraphQLServerError").GraphQLServerError&&o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(e),o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["GraphQL: Failed fetching xwa_product_catalog_get_single_collection query."]))),new(o("WAWebBackendErrors")).CatalogUnknownError}});return function(n){return t.apply(this,arguments)}})(),d=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(o("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(o("WAWebBackendErrors")).E451;var t=e.catalogWid,n=e.collectionId,r=e.afterCursor,a=e.limit,i=e.width,l=e.height,s=e.directConnectionEncryptedInfo,c=yield o("WAWebBizCatalogManagementFetchSingleCollection").fetchSingleCollection({collection:{biz_jid:t.toJid(),id:n,limit:String(a),after:r,width:String(i),height:String(l),direct_connection_encrypted_info:s}});if(c.type==="success")return c.collectionsResult;throw c.type==="graphql-error"?o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(c.error):c.type,o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["queryProductSingleCollectionGraphQLByOwner: error handling flow not implemented for ",""])),JSON.stringify(c)),new(o("WAWebBackendErrors")).CatalogUnknownError});return function(n){return e.apply(this,arguments)}})(),m=function(t){var e=o("WAWebUserPrefsMeUser").getMaybeMePnUser();return e!=null&&e.equals(t.catalogWid)?d(t):c(t)},p=m;l.default=p}),98);
__d("WAWebProductCollCollection",["WALogger","WAWebBaseCollection","WAWebBizProductCatalogBridge","WAWebBusinessDirectConnectionBridge","WAWebBusinessProfileCollection","WAWebCatalogVariantHelper","WAWebProductCollModel","WAWebQplQuickPerformanceLoggerModule","WAWebQueryProductCollections","WAWebQueryProductSingleCollection","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u=100,c=10,d=function(t){var e={id:t.id,name:t.name,reviewStatus:t.reviewStatus,totalItemsCount:t.totalItemsCount,canAppeal:t.canAppeal,commerceUrl:t.commerceUrl,rejectReason:t.rejectReason};return e},m=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,e.afterCursor="",babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.findCollectionsList=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a,i){var l=this;i&&o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(i,"datasource_collections_start");try{var s,m,p,_=yield o("WAWebBusinessProfileCollection").BusinessProfileCollection.find(t);o("WAWebCatalogVariantHelper").shouldRequestVariantInfo(_)&&(s=o("WAWebCatalogVariantHelper").FULL_VARIANT_INFO_FIELDS,m=o("WAWebCatalogVariantHelper").VARIANT_THUMBNAIL_IMAGE_SIZE,p=o("WAWebCatalogVariantHelper").VARIANT_THUMBNAIL_IMAGE_SIZE);var f=yield o("WAWebBusinessDirectConnectionBridge").attemptWithDirectConnectionRetry(t,function(e){return r("WAWebQueryProductCollections")({catalogWid:t,afterCursor:l.afterCursor,limit:c,productsCount:n,width:u,height:u,directConnectionEncryptedInfo:e,variantInfoFields:s,variantThumbnailHeight:m,variantThumbnailWidth:p})});i&&o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(i,"datasource_collections_end"),this.afterCursor=f.afterCursor,this.add(f.collections.map(d),{merge:!0}),f.collections.forEach(function(e){var n=l.get(e.id);n&&n.addProducts(e.products.map(function(e){return o("WAWebBizProductCatalogBridge").mapProductResponseToModel(e,t)}))}),this.trigger("change")}catch(t){throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed findCollectionsList, error: ",""])),t).verbose().devConsole(t).sendLogs("Find collections list failed"),t}});function a(e,n,r,o){return t.apply(this,arguments)}return a})(),i.getCollectionModels=function(t){var e=this.toArray();return t?e:e.filter(function(e){return!e.isHidden&&e.reviewStatus==="APPROVED"})},i.findCollectionProducts=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a){var i=this.get(t),l=i?i.afterCursor:void 0;a&&o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(a,"datasource_start");try{var m=yield o("WAWebBusinessDirectConnectionBridge").attemptWithDirectConnectionRetry(e,function(n){return r("WAWebQueryProductSingleCollection")({catalogWid:e,collectionId:t,afterCursor:l,limit:c,width:u,height:u,directConnectionEncryptedInfo:n})});a&&o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(a,"datasource_end"),m.collections.length===1&&(this.add(m.collections.map(d),{merge:!0}),i=this.get(t),i&&(i.addProducts(m.collections[0].products.map(function(t){return o("WAWebBizProductCatalogBridge").mapProductResponseToModel(t,e)})),i.afterCursor=m.afterCursor))}catch(e){throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Failed findCollectionProducts, error: ",""])),e).verbose().devConsole(e).sendLogs("Find collection products failed"),e}});function t(t,n,r,o){return e.apply(this,arguments)}return t})(),a})(o("WAWebBaseCollection").BaseCollection);m.model=r("WAWebProductCollModel"),m.staleCollection=!0,l.ProductCollCollection=m}),98);
__d("WAWebProductCollModel",["WAWebBaseModel","WAWebProductCollection"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.name=o("WAWebBaseModel").prop(),t.isHidden=o("WAWebBaseModel").prop(),t.reviewStatus=o("WAWebBaseModel").prop(),t.commerceUrl=o("WAWebBaseModel").prop(),t.rejectReason=o("WAWebBaseModel").prop(),t.totalItemsCount=o("WAWebBaseModel").prop(),t.afterCursor=o("WAWebBaseModel").prop(),t.canAppeal=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){e.prototype.initialize.call(this),this.productCollection=new(o("WAWebProductCollection")).ProductCollection,this.afterCursor=void 0},n.addProducts=function(t){this.productCollection.add(t,{merge:!0})},t})(o("WAWebBaseModel").BaseModel);e.Proxy="productColl";var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebProductCollection",["Promise","WAWebBaseCollection","WAWebBizGatingUtils","WAWebProductModel","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){var e,s={NO_REVIEW:"NO_REVIEW",PENDING:"PENDING",REJECTED:"REJECTED",APPROVED:"APPROVED",OUTDATED:"OUTDATED"};function u(e,t){return e.displayPriority-t.displayPriority}var c=new Set([s.OUTDATED,s.NO_REVIEW,s.APPROVED,s.REJECTED,s.PENDING]),d=new Set([s.APPROVED]);function m(e){var t=new Set;return e.filter(function(e){if(e.variantInfo!=null){var n,o=(n=e.variantInfo)==null||(n=n.availability)==null?void 0:n.listing.some(function(e){return e&&!r("isStringNullOrEmpty")(e.product_id)&&t.has(e.product_id)});if(o===!0)return!1}return t.add(e.id.toString()),!0})}var p=(function(t){function r(){return t.apply(this,arguments)||this}babelHelpers.inheritsLoose(r,t);var a=r.prototype;return a.getProductModels=function(n){n===void 0&&(n=!1);var e=t.prototype.toArray.call(this);if(t.prototype.length<1)return e;var r=t.prototype.head.call(this),a=r==null?void 0:r.catalogWid;if(!a)return e;var i=n?c:d,l=t.prototype.filter.call(this,function(e){return i.has(e.reviewStatus)&&!e.old}),s=m(l);return n?s:s.filter(function(e){return!e.isHidden&&(!o("WAWebBizGatingUtils").isCountryOfOriginEnabled()||!e.isSanctioned)})},a.add=function(n,r){var e=r?t.prototype.add.call(this,n,r):t.prototype.add.call(this,n);return this.sort(),e},a.evictImagesFromCache=function(t){var e=this.get(t);e&&e.evictImagesFromCache()},a.findImpl=function(r){var t=this.get(r);return t?(e||(e=n("Promise"))).resolve(t):(e||(e=n("Promise"))).resolve({id:r})},r})(o("WAWebBaseCollection").BaseCollection);p.model=o("WAWebProductModel").Product,p.comparator=u,l.PRODUCT_REVIEW_STATUS=s,l.ProductCollection=p}),98);
__d("WAWebProductImageCollection",["WAWebBaseCollection","WAWebProductImageModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.toArray=function(){var t=this;return e.prototype.filter.call(this,function(e){return e.old?(t.remove(e),!1):e})},t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebProductImageModel").ProductImage,l.ProductImageCollection=e}),98);
__d("WAWebProductImageModel",["Promise","WABackoffDelay","WALogger","WAPromiseBackoffs","WAWebBaseModel","WAWebCryptoCalculateFilehash","WAWebMedia","WAWebMediaData","WAWebMediaDataUtils","WAWebMediaOpaqueData","WAWebMediaStore","WAWebMediaTypes","WAWebMiscErrors","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c="https://static.whatsapp.net",d=1e3,m=900*1e3,p=10,_=o("WAPromiseBackoffs").createTimer({algo:{type:"fibonacci",first:0,second:1},jitter:.25,max:m});function f(e){var t="_productimage_"+(e.includes(c)?e:new URL(e).pathname);return t}var g=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.id=o("WAWebBaseModel").prop(),e.type=o("WAWebBaseModel").prop(),e.mediaUrl=o("WAWebBaseModel").prop(),e.videoUrl=o("WAWebBaseModel").prop(),e.blobUrl=o("WAWebBaseModel").session(),e.mediaData=o("WAWebBaseModel").session(),e.fetchedFromServer=o("WAWebBaseModel").prop(),e.old=o("WAWebBaseModel").session(!1),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.initialize=function(){t.prototype.initialize.call(this),this.listenTo(this,"change:mediaUrl change:fetchedFromServer",this.triggerImageUpdate),this.triggerImageUpdate()},i._processAndUpdateMediaData=function(a){var t=this,i={},l=r("WAWebMediaOpaqueData").createFromData(a,"image/jpeg");o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["_processAndUpdateMediaData: before prepRawMedia"])));var s=o("WAWebMedia").prepRawMedia(l,{});s.waitForPrep().then(function(e){return i=babelHelpers.extends({},i,{mediaBlob:e.mediaBlob,type:e.type,mimetype:e.mimetype,fullWidth:e.fullWidth,fullHeight:e.fullHeight}),(u||(u=n("Promise"))).all([typeof e.preview=="string"?r("WAWebMediaOpaqueData").createFromBase64Jpeg(e.preview):(u||(u=n("Promise"))).resolve(null),r("WAWebMediaOpaqueData").createFromData(e.mediaBlob),o("WAWebCryptoCalculateFilehash").calculateFilehashFromBlob(e.mediaBlob)])}).then(function(e){var n=e[0],r=e[1],a=e[2];i=babelHelpers.extends({},i,{preview:n,mediaBlob:r,renderableUrl:r.url(),mediaStage:o("WAWebMediaTypes").MediaDataStage.RESOLVED,filehash:a}),a!==t.mediaData.filehash&&t.mediaData.set(i)})},i.triggerImageUpdate=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=this;if(!(!this.fetchedFromServer||!this.mediaUrl)){this.mediaData||this.addChild("mediaData",new(r("WAWebMediaData"))({mediaStage:o("WAWebMediaTypes").MediaDataStage.PREPARING}));var t=f(this.mediaUrl),a=yield o("WAWebMediaStore").LruMediaStore.get(t);if(a)return this._processAndUpdateMediaData(a);var i={delay:function(t){var e=t.taskDuration,n=d*_();return Math.max(n-e,0)},signal:new AbortController().signal,retries:p};try{var l=yield o("WABackoffDelay").backoff(i,(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=yield o("WAWebMediaDataUtils").fetchMedia(e.mediaUrl);return!n||!(n.status>=200&&n.status<300)?t(new(o("WAWebMiscErrors")).CatalogImageDownloadError):n});return function(e){return t.apply(this,arguments)}})()),u=l.result;o("WAWebMediaStore").LruMediaStore.put(t,u),this._processAndUpdateMediaData(u)}catch(e){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Failed to fetch ",""])),this.mediaUrl).devConsole(e),this.mediaData.set({mediaStage:o("WAWebMediaTypes").MediaDataStage.ERROR_MISSING})}}});function t(){return e.apply(this,arguments)}return t})(),i.markOld=function(){this.old=!0},i.evictFromCache=function(){if(this.mediaUrl){var e=f(this.mediaUrl);o("WAWebMediaStore").LruMediaStore.del(e)}},a})(o("WAWebBaseModel").BaseModel);g.Proxy="productImage";var h=o("WAWebBaseModel").defineModel(g);l.STATIC_WHATSAPP_IMAGE_URI=c,l.ProductImage=h}),98);
__d("WAWebProductMessageListCollection",["Promise","WAWebBaseCollection","WAWebBizProductCatalogAction","WAWebProductMessageListModel","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=(function(t){function r(){for(var r,o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return r=t.call.apply(t,[this].concat(a))||this,r.findQueryImpl=function(e){return r.findImpl(e).then(function(e){return[e]})},r.findImpl=function(t,o){var a=r.get(t);return a==null?(e||(e=n("Promise"))).resolve({id:t}):r._queryProductList(a,o==null?void 0:o.markerId)},babelHelpers.assertThisInitialized(r)||babelHelpers.assertThisInitialized(r)}babelHelpers.inheritsLoose(r,t);var a=r.prototype;return a._queryProductList=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=e.catalogId,r=yield o("WAWebBizProductCatalogAction").queryProductList(n,e.getNextProductBatchToLoad(),void 0,void 0,t);return{id:e.id,_products:r}});function t(t,n){return e.apply(this,arguments)}return t})(),a.getOrAdd=function(t,n,r,a,i){var e=this.get(t);if(e!=null)return e;if(a==null)return null;var l=o("WAWebWidFactory").createWid(a);return e=this.add({id:t,catalogId:l,_productList:n,title:i,requiresDirectConnection:r})[0],e!=null?e:null},r})(o("WAWebBaseCollection").BaseCollection);s.model=o("WAWebProductMessageListModel").ProductMessageList,s.staleCollection=!0;var u=new s;l.ProductMessageListCollection=u}),98);
__d("WAWebProductMessageListModel",["WAWebBaseModel","WAWebBizProductCatalogBridge","WAWebBizProductMessageListAction","WAWebBusinessDirectUtils","WAWebCatalogCollection","WAWebChatCollection","WAWebMsgKey","WAWebProductCollection","WAWebProductMessageListConstant","WAWebProductTypes.flow","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=["ERROR","SUCCESS"],s=(function(t){function r(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.id=o("WAWebBaseModel").prop(),e.catalogId=o("WAWebBaseModel").prop(),e.title=o("WAWebBaseModel").prop(),e.requiresDirectConnection=o("WAWebBaseModel").prop(),e._productsLoadingStatus=o("WAWebBaseModel").session(),e._productList=o("WAWebBaseModel").session(),e._products=o("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(r,t);var a=r.prototype;return a.initialize=function(){t.prototype.initialize.call(this),this.productCollection=o("WAWebCatalogCollection").CatalogCollection.gadd({id:this.catalogId}).productCollection,this._productsLoadingStatus=new Map,this.listenTo(this,"change:_products",this.triggerProductUpdate),this.triggerProductUpdate(),this.listenTo(this.productCollection,"remove",this.triggerProductRemoved),this.listenTo(o("WAWebChatCollection").ChatCollection,"add",this.triggerChatAdded)},a.triggerProductRemoved=function(t){o("WAWebBizProductMessageListAction").updateProductListHeaderImageRejected(t,this.id)},a.triggerProductUpdate=function(){var e=this;this._products!=null&&(this._products.forEach(function(t){var n=e._getFetchStatus(t);if(e.setProductLoadingStatus(t.id,n),t.status==="DELETED"&&e.triggerProductRemoved(t),t.status!=="DELETED"&&n!=="ERROR"){var r=o("WAWebBizProductCatalogBridge").mapProductResponseToModel(t,e.catalogId);r.reviewStatus===o("WAWebProductCollection").PRODUCT_REVIEW_STATUS.REJECTED&&e.triggerProductRemoved(r),e.productCollection.add(r,{merge:!0})}}),this._products=void 0)},a.triggerChatAdded=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){e.id.equals(this.catalogId)&&(yield o("WAWebBusinessDirectUtils").isCypherNeeded(this.catalogId))&&(this.productCollection.reset(),this._productsLoadingStatus=new Map)});function t(t){return e.apply(this,arguments)}return t})(),a.getNextProductBatchToLoad=function(){var e=this,t=this.getPageSize(),n=this._productList.productSections.reduce(function(t,n){var r=n.products;return[].concat(t,r.map(function(e){var t=e.productId;return t}).filter(Boolean).filter(function(t){return e.getProductLoadingStatus(t)==="NONE"}))},[]).slice(0,t);return n.forEach(function(t){return e.setProductLoadingStatus(t,"PENDING")}),n},a.getPageSize=function(){var e=o("WAWebProductTypes.flow").PRODUCT_PAGE_SIZE,t=this.getProductSize();return t<3*e?t:e*2},a.getProductSize=function(){return this._productList.productSections.reduce(function(e,t){var n=t.products;return e+n.length},0)},a.setProductLoadingStatus=function(t,n){this._productsLoadingStatus.set(t,n)},a.getProductLoadingStatus=function(t){return this._productsLoadingStatus.get(t)||"NONE"},a.getTotalProductsFetchedOrFailed=function(){return Array.from(this._productsLoadingStatus).filter(function(t){var n=t[0],r=t[1];return e.includes(r)}).length},a.getProductList=function(){return this._productList},a.getSections=function(){return this._productList.productSections},a.getSectionsCount=function(){return this._productList.productSections.reduce(function(e,t){var n=t.title;return n!=null&&n!==""?e+1:e},0)},a.isFetching=function(){var e=!1;return this._productsLoadingStatus.forEach(function(t){t==="PENDING"&&(e=!0)}),e},a._getFetchStatus=function(t){return t.status===o("WAWebProductMessageListConstant").INVALID_PRODUCT_TOKEN||!t.image_cdn_urls?"ERROR":"SUCCESS"},r})(o("WAWebBaseModel").BaseModel);s.Proxy="product_list",s.idClass=r("WAWebMsgKey");var u=o("WAWebBaseModel").defineModel(s);l.ProductMessageList=u}),98);
__d("WAWebProductModel",["WAWebBaseModel","WAWebBizGatingUtils","WAWebFileUtils","WAWebMediaData","WAWebMediaTypes","WAWebProductImageCollection"],(function(t,n,r,o,a,i,l){var e=0,s=4503599627370496,u=10,c=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.old=o("WAWebBaseModel").session(!1),t.checkmark=o("WAWebBaseModel").session(!1),t.id=o("WAWebBaseModel").prop(),t.isHidden=o("WAWebBaseModel").prop(),t.catalogWid=o("WAWebBaseModel").prop(),t.url=o("WAWebBaseModel").prop(),t.signedShimmedUrl=o("WAWebBaseModel").prop(),t.name=o("WAWebBaseModel").prop(),t.description=o("WAWebBaseModel").prop(),t.availability=o("WAWebBaseModel").prop(),t.maxAvailable=o("WAWebBaseModel").prop(),t.reviewStatus=o("WAWebBaseModel").prop(),t.isSanctioned=o("WAWebBaseModel").prop(),t.canAppeal=o("WAWebBaseModel").prop(),t.currency=o("WAWebBaseModel").prop(),t.priceAmount1000=o("WAWebBaseModel").prop(),t.salePriceAmount1000=o("WAWebBaseModel").prop(),t.salePriceStartDate=o("WAWebBaseModel").prop(),t.salePriceEndDate=o("WAWebBaseModel").prop(),t.retailerId=o("WAWebBaseModel").prop(),t.productImageCollection=o("WAWebBaseModel").session(),t.imageCount=o("WAWebBaseModel").prop(),t.displayPriority=o("WAWebBaseModel").prop(),t.videos=o("WAWebBaseModel").prop(),t.variantInfo=o("WAWebBaseModel").prop(),t.additionalImageCdnUrl=o("WAWebBaseModel").prop(),t.additionalImageHashes=o("WAWebBaseModel").prop(),t.imageCdnUrl=o("WAWebBaseModel").prop(),t.imageHash=o("WAWebBaseModel").prop(),t.complianceInfo=o("WAWebBaseModel").prop(),t.importerInformationExempt=o("WAWebBaseModel").prop(),t.productMsgMediaData=o("WAWebBaseModel").session(),t.fetchedFromServer=o("WAWebBaseModel").session(),t.t=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){e.prototype.initialize.call(this),this.productImageCollection=new(o("WAWebProductImageCollection")).ProductImageCollection,this.listenTo(this,"change:imageCdnUrl",this.triggerMainImageUpdate),this.initImageUpdate()},n.triggerAdditionalImageUpdate=function(){var e,t=this,n=0;if((e=this.additionalImageCdnUrl)==null||e.forEach(function(e,r){t.productImageCollection.gadd({id:"_"+(r+1),mediaUrl:e,fetchedFromServer:t.fetchedFromServer,old:!1},{merge:!0}),n=r+1}),o("WAWebBizGatingUtils").isCatalogVideoViewEnabled()){var r;(r=this.videos)==null||r.forEach(function(e,r){t.productImageCollection.gadd({id:"_"+(r+n+1),mediaUrl:e.thumbnail_url,fetchedFromServer:t.fetchedFromServer,old:!1,videoUrl:e.original_video_url},{merge:!0}),n+=r+1})}this.productImageCollection.filter(function(e,t){return t>n}).forEach(function(e){return e.markOld()})},n.triggerMainImageUpdate=function(){if(this.imageCdnUrl!=null&&this.imageCdnUrl!=="")this.productImageCollection.gadd({id:"_0",mediaUrl:this.imageCdnUrl,fetchedFromServer:this.fetchedFromServer,old:!1},{merge:!0});else{var e;(e=this.productImageCollection.get("_0"))==null||e.markOld()}},n.initImageUpdate=function(){if(!this.fetchedFromServer&&this.productMsgMediaData){for(var e=0;e<this.imageCount;e++)this.productImageCollection.gadd({id:"_"+e,type:"product",mediaData:new(r("WAWebMediaData"))({mediaStage:o("WAWebMediaTypes").MediaDataStage.PREPARING}),fetchedFromServer:this.fetchedFromServer,old:!1},{merge:!0});return}this.triggerMainImageUpdate()},n.markOld=function(){this.old=!0},n.lazyloadProductImageCollection=function(){return this.triggerAdditionalImageUpdate(),this.productImageCollection},n.getProductImageCollectionCount=function(){return this.productImageCollection.length},n.getProductImageCollectionHead=function(){return this.productImageCollection.head()},n.getHeadImageFile=function(){var e,t=this.productImageCollection,n=this.name,r=t.head();if(r){var a,i=(e=r.mediaData)==null?void 0:e.mediaBlob;if(i instanceof Blob?a=i:a=i.getBlob(),a!=null){var l=o("WAWebFileUtils").createFile([a],n+".jpg",{type:"image/jpeg"});return l}}},n.evictImagesFromCache=function(){this.productImageCollection.forEach(function(e){return e.evictFromCache()})},n.getPreviewImage=function(){return this.productImageCollection.head()},n.getCollection=function(){return this.collection},n.setIsHidden=function(t){this.isHidden=t},t})(o("WAWebBaseModel").BaseModel);c.Proxy="product";var d=o("WAWebBaseModel").defineModel(c);l.MIN_PRICE=e,l.MAX_PRICE=s,l.MAX_PRODUCT_IMAGES=u,l.Product=d}),98);
__d("WAWebChatComparator",[],(function(t,n,r,o,a,i){var e=function(t,n){var e=t.pin||0,r=n.pin||0;if(e||r)return e!==r?e>r?-1:1:t.id.toString()<n.id.toString()?-1:1;var o=Math.max(t.previewT||0,t.draftMessageSortTs||0,t.draftAttachMediaContentsSortTs||0,t.t||0),a=Math.max(n.previewT||0,n.draftMessageSortTs||0,n.draftAttachMediaContentsSortTs||0,n.t||0);return o!==a?o>a?-1:1:t.id.toString()<n.id.toString()?-1:1},l=e;i.default=l}),66);
__d("WAWebChatCollection",["WALogger","WAWebBaseCollection","WAWebChatComparator","WAWebChatGetters","WAWebChatLockUpdateDailyStats","WAWebChatModel","WAWebIdleTaskRunner","WAWebLidMigrationUtils","WAWebSendUnstarAllChatAction","WAWebSocketConstants","WAWebSocketModel","lodash"],(function(t,n,r,o,a,i,l){var e,s=18e5,u=(function(t){function n(){var e;return e=t.call(this)||this,e.notSpam={},e.promises={sendUnstarAll:null},e._sortEnabled=!1,e._viewOnceCleanupTaskQueue=new Set,e.setIndexes=function(){e.forEach(function(e,t){e.initialIndex=t})},e.enableSortListener(),e.listenTo(o("WAWebSocketModel").Socket,"change:stream",function(){o("WAWebSocketModel").Socket.stream===o("WAWebSocketConstants").SOCKET_STREAM.RESUMING&&e.forEach(function(e){e.pendingMsgs=!1})}),e.listenToOnce(e,"sort",r("lodash").debounce(e.setIndexes,100)),e._scheduleViewOnceMediaCleanup(),e.listenTo(e,"change:isLocked",r("lodash").debounce(function(){o("WAWebChatLockUpdateDailyStats").updateChatLockDailyStats({totalFolderChatsCount:e.filter(function(e){return e.isLocked}).length})},500)),e}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a._scheduleViewOnceMediaCleanup=function(){var e=this;self.clearTimeout(this._viewOnceCleanupTimeout),this._viewOnceCleanupTimeout=self.setTimeout(function(){o("WAWebIdleTaskRunner").IdleCallbackTasks.enqueue(function(){e._runViewOnceMediaCleanup(),e._scheduleViewOnceMediaCleanup()})},s)},a._runViewOnceMediaCleanup=function(){var e=this;this.forEach(function(t){var n=t.id;e._viewOnceCleanupTaskQueue.has(n)||(o("WAWebIdleTaskRunner").IdleCallbackTasks.enqueue(function(){e._viewOnceCleanupTaskQueue.delete(n);var t=e.get(n);(t==null?void 0:t.active)===!1&&t.deregisterExpiredViewOnceBulkMessages(t.msgs)}),e._viewOnceCleanupTaskQueue.add(n))})},a.getUnreadCount=function(){return this.filter(function(e){return e.showUnreadInTitle}).length},a.enableSortListener=function(t){this._sortEnabled||(this.listenTo(this,"change:t change:pin change:id change:isLocked change:endOfHistoryTransferType change:isParentGroup change:msgs change:createdLocally change:msgsLength",this.sort),t===!0&&this.sort(),this._sortEnabled=!0)},a.disableSortListener=function(){this._sortEnabled&&(this.stopListening(null,null,this.sort),this._sortEnabled=!1)},a.getActive=function(){var t=this.filter(function(e){return e.active});return t.length>1&&o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["ChatCollection:getActive more than one active chat"]))).sendLogs("more-than-one-active-chat-in-chat-collection"),t[0]},a.getChatByAccountLid=function(t){var e=this.get(t);if(e)return e;var n=o("WAWebLidMigrationUtils").toPn(t),r=n?this.get(n):null;return t.equals(r==null?void 0:r.accountLid)?r:null},a.getLatestChatForWid=function(t){var e=o("WAWebLidMigrationUtils").shouldHaveAccountLid(t)?o("WAWebLidMigrationUtils").toLid(t):null;return e!=null?c.getChatByAccountLid(e):c.get(t)},a.unstarAllMessages=function(t,n){return o("WAWebSendUnstarAllChatAction").unstarAllMessages(t,n)},a.hasAnyUnreadSinceGivenTimestamp=function(t){return this.length===0?!1:this.some(function(e){var n,r=(n=e.t)!=null?n:0;return o("WAWebChatGetters").getHasUnread(e)&&r>t})},a.delete=function(){t.prototype.delete.call(this),this.listenToOnce(this,"sort",r("lodash").debounce(this.setIndexes,100))},n})(o("WAWebBaseCollection").BaseCollection);u.model=o("WAWebChatModel").Chat,u.comparator=r("WAWebChatComparator");var c=new u;l.ChatCollectionImpl=u,l.ChatCollection=c}),98);
__d("WAWebChatCommunityUtils",["WAWebChatCollection","WAWebChatGroupUtils","WAWebCommunityGatingUtils","WAWebFrontendContactGetters","WAWebGroupMetadataCollection","WAWebGroupType","WAWebLidMigrationUtils","WAWebUnjoinedSubgroupMetadataCollection","WAWebUserPrefsMeUser","WAWebWidFactory","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){var e=91,s=new Set(["add","remove","demote","linked_group_demote"]);function u(e){var t;return e?(e==null||(t=e.groupMetadata)==null?void 0:t.groupType)===o("WAWebGroupType").GroupType.COMMUNITY&&o("WAWebChatGroupUtils").isSuspendedGroup(e)&&o("WAWebCommunityGatingUtils").isCommunitySuspendAppealEnabled():!1}function c(e){var t;return e?(e==null||(t=e.groupMetadata)==null?void 0:t.groupType)===o("WAWebGroupType").GroupType.COMMUNITY&&o("WAWebChatGroupUtils").isSuspendedGroup(e)&&o("WAWebChatGroupUtils").isTerminatedGroup(e):!1}function d(e){if(!(e!=null&&e.groupMetadata))return!1;var t=e.groupMetadata,n=t.participants;return n.iAmSuperAdmin()}function m(e){if(!(e!=null&&e.groupMetadata)||c(e)||u(e))return!1;var t=e.groupMetadata,n=t.participants,r=!!t.allowNonAdminSubGroupCreation&&o("WAWebCommunityGatingUtils").memberAddedGroupsM1Enabled();return r||n.iAmAdmin()||d(e)||o("WAWebCommunityGatingUtils").memberSuggestedGroupsEnabled()}function p(e){return r("WAWebGroupMetadataCollection").filter(function(t){return t.parentGroup===e&&t.defaultSubgroup===!0}).map(function(e){return e.id})}function _(e,t){return e.map(function(e){var n,a,i=t?(n=o("WAWebChatCollection").ChatCollection.get(e))==null?void 0:n.formattedTitle:(a=r("WAWebUnjoinedSubgroupMetadataCollection").get(e))==null?void 0:a.subject;return{id:e,subject:i!=null?i:""}})}function f(e){if(!e||!e.contact.name)return!1;var t=o("WAWebChatCollection").ChatCollection.findFirst(function(t){var n,r;return((n=t.groupMetadata)==null?void 0:n.parentGroup)===e.id&&((r=t.groupMetadata)==null?void 0:r.defaultSubgroup)});return!t||!t.contact.name?!1:t.contact.name!==e.contact.name}function g(e){if(!e)return!1;var t=r("WAWebGroupMetadataCollection").get(e);if(!t)return!1;var n=t.participants.iAmAdmin();return t.allowNonAdminSubGroupCreation!==!0&&!n&&o("WAWebCommunityGatingUtils").memberSuggestedGroupsEnabled()}function h(e,t,n){if(t==null)return!0;var r;if(n==null){var a,i,l=(a=o("WAWebLidMigrationUtils").toPn(t.id))!=null?a:t.id,s=e==null||(i=e.groupMetadata)==null||(i=i.getParentGroupChat())==null||(i=i.groupMetadata)==null?void 0:i.participants;r=!!(s!=null&&s.iAmAdmin())||l.isUser()&&!!(s!=null&&s.userIsAdmin(l))}else r=n.iAmCommunityAdmin||n.isSenderAdmin;return!e||o("WAWebUserPrefsMeUser").isMeAccount(t.id)||o("WAWebFrontendContactGetters").getIsMyContact(t)||!o("WAWebChatGroupUtils").isCommunityAnnouncementGroup(e)||r?!1:t.id.isLid()?!0:o("WAWebChatGroupUtils").isCommunityAnnouncementGroup(e)}function y(e){var t=e.length!==0?e[0].toString():null;return!r("isStringNullOrEmpty")(t)&&o("WAWebWidFactory").isWidlike(t)?o("WAWebWidFactory").createWidFromWidLike(t):null}function C(e,t){var n=t.groupMetadata;return!!(n!=null&&n.isCag)&&s.has(e.subtype)&&!(n!=null&&n.participants.iAmAdmin())}l.SUBGROUP_V2_CHAT_CELL_HEIGHT=e,l.isSuspendedCommunity=u,l.isIntegrityDeactivatedCommunity=c,l.isCommunitySuperAdmin=d,l.canAddGroupToCommunity=m,l.getCagIdFromCommunity=p,l.formatSubgroupUpdateTypes=_,l.cagAndCommunitySubjectDiffer=f,l.isSubgroupSuggestionCreation=g,l.shouldMaskPhoneNumberForChat=h,l.getNewCommunityOwnerFromTemplateParams=y,l.isInvalidCommunitySystemMsg=C}),98);
__d("WAWebChatDocMsgsCollection",["Promise","WAFilteredCatch","WALogger","WAWebBackendErrors","WAWebBaseCollection","WAWebFrontendMsgGetters","WAWebMsgCollection","WAWebMsgModel","WAWebNoop","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u=(function(t){function a(){for(var r,a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return r=t.call.apply(t,[this].concat(i))||this,r.hasDocBefore=!0,r.$ChatDocMsgsCollection$p_1=null,r.count=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n;if(r.$ChatDocMsgsCollection$p_1!=null)return r.$ChatDocMsgsCollection$p_1;var a=t.msgs.filter(c),i=(n=a[0])!=null?n:t.msgs.head();if(i==null)return 0;try{var l,s=yield o("WAWebMsgCollection").MsgCollection.queryMedia(i.id.remote,1/0,"before",i.id,"document"),u=(l=s.length)!=null?l:0,d=u>0&&a.length>0?1:0;return r.$ChatDocMsgsCollection$p_1=u+a.length-d,r.$ChatDocMsgsCollection$p_1}catch(n){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to count docs for chat ",""])),t.id).verbose().devConsole(n).sendLogs("md-failed-docs-count: "+n.message),null}});return function(e){return t.apply(this,arguments)}})(),babelHelpers.assertThisInitialized(r)||babelHelpers.assertThisInitialized(r)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.delete=function(){t.prototype.delete.call(this),this.stopListening(),this.reset()},i.add=function(n,r){return this.$ChatDocMsgsCollection$p_1=null,t.prototype.add.call(this,n,r)},i.remove=function(n,r){return this.$ChatDocMsgsCollection$p_1=null,t.prototype.remove.call(this,n,r)},i.queryDocs=function(t,a){var e=this;if(a){if(this.queryDocBefore)return this.queryDocBefore;var i=this.queryDocBefore=o("WAWebMsgCollection").MsgCollection.queryMedia(a.id.remote,o("WAWebMsgCollection").MEDIA_QUERY_LIMIT,"before",a.id,"document").then(function(t){(!t||t.length<o("WAWebMsgCollection").MEDIA_QUERY_LIMIT)&&(e.hasDocBefore=!1),e.add(t.filter(c),{at:0})}).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").E404,r("WAWebNoop"))).finally(function(){e.queryDocBefore=null,e.trigger("query_doc_before")});return this.trigger("query_doc_before"),i}var l=t.msgs;if(this.length===0){if(!l||l.length===0)return this.hasDocBefore=!1,(s||(s=n("Promise"))).resolve();this.add(l.filter(c),{at:0})}if(t.msgs.msgLoadState.noEarlierMsgs)return this.hasDocBefore=!1,(s||(s=n("Promise"))).resolve();if(this.length<=2*o("WAWebMsgCollection").MEDIA_QUERY_LIMIT){var u=this.length===0?l.head():this.head();return this.queryDocs(t,u)}return(s||(s=n("Promise"))).resolve()},a})(o("WAWebBaseCollection").BaseCollection);u.model=o("WAWebMsgModel").Msg;function c(e){return o("WAWebFrontendMsgGetters").getAsDoc(e)!=null&&!e.isVcardOverMmsDocument}l.default=u}),98);
__d("WAWebTosCountryGating",["WAWebABPropsInternalNumber","WAWebBizGatingUtils","WAWebHandleMsgTypes.flow"],(function(t,n,r,o,a,i,l){function e(e){if(o("WAWebBizGatingUtils").countryGatingEnabled()){var t;return((t=e.privacyMode)==null?void 0:t.hostStorage)===o("WAWebHandleMsgTypes.flow").HostStorageEnumType.Facebook&&!o("WAWebABPropsInternalNumber").getFbBrandedNumber(e.id.user)}return!1}l.shouldBlockByCountry=e}),98);
__d("WAWebChatGroupUtils",["Promise","WALogger","WATimeUtils","WAWebABProps","WAWebApiContact","WAWebBizAiAgentGating","WAWebBizAiAgentStatusUtils","WAWebBotGating","WAWebBotTos","WAWebChatGetters","WAWebCommunityGatingUtils","WAWebCurrentUser","WAWebDBUpdateChatTable","WAWebFrontendContactGetters","WAWebGroupGatingUtils","WAWebGroupType","WAWebIndividualNewChatMessageCappingLimitUtils","WAWebLid1X1MigrationGating","WAWebNewsletterMembershipUtil","WAWebNoop","WAWebReachoutTimelockUtils","WAWebStateUtils","WAWebTosCountryGating","WAWebTosGating","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e){var t;if(!e)return!1;var n=o("WAWebStateUtils").unproxy(e);return o("WAWebChatGetters").getIsGroup(n)&&((t=n.groupMetadata)==null?void 0:t.support)===!0}function m(e){var t,n=o("WAWebStateUtils").unproxy(e);return o("WAWebChatGetters").getIsGroup(n)&&!!((t=n.groupMetadata)!=null&&t.terminated)}function p(e){var t,n=o("WAWebStateUtils").unproxy(e);return o("WAWebChatGetters").getIsGroup(n)&&((t=n.groupMetadata)==null?void 0:t.groupType)===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP}function _(e){var t,n=o("WAWebStateUtils").unproxy(e);return o("WAWebChatGetters").getIsGroup(n)&&((t=n.groupMetadata)==null?void 0:t.groupType)===o("WAWebGroupType").GroupType.LINKED_GENERAL_GROUP}function f(e){var t;if(!e)return!1;var n=o("WAWebStateUtils").unproxy(e);return o("WAWebChatGetters").getIsGroup(n)&&!!((t=n.groupMetadata)!=null&&t.suspended)}function g(e){var t=o("WAWebStateUtils").unproxy(e);return t.canSend&&!f(t)&&!m(t)}function h(e){var t,n=o("WAWebStateUtils").unproxy(e);return o("WAWebChatGetters").getIsGroup(n)&&((t=n.groupMetadata)==null?void 0:t.growthLockType)==="invite"&&(n.groupMetadata.growthLockExpiration||0)>o("WATimeUtils").unixTime()}function y(e){var t;if(!e)return!1;var n=o("WAWebStateUtils").unproxy(e),r=m(n),a=f(n)&&!((t=n.groupMetadata)!=null&&t.participants.iAmMember());return(r||a)&&!p(n)}function C(e){var t,n=o("WAWebStateUtils").unproxy(e);return((t=n.groupMetadata)==null?void 0:t.groupType)===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&f(n)&&o("WAWebCommunityGatingUtils").isCommunitySuspendAppealEnabled()}function b(e){var t,n=o("WAWebStateUtils").unproxy(e);return((t=n.groupMetadata)==null?void 0:t.groupType)===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&f(n)&&m(n)}function v(){return o("WAWebABProps").getABPropConfigValue("group_suspend_appeal_include_entity_id_enabled")}function S(e){var t,n=o("WAWebStateUtils").unproxy(e);return((t=n.groupMetadata)==null?void 0:t.groupType)===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&m(n)}function R(e){return f(e)||m(e)}function L(t){var a,i=o("WAWebStateUtils").unproxy(t);if(!(d(i)&&i.isReadOnly)){var l=(c||(c=n("Promise"))).resolve();if(o("WAWebChatGetters").getIsNewsletter(i)){var s=!o("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(i.newsletterMetadata)||i.isSuspendedOrTerminated();i.isReadOnly!==s&&o("WAWebDBUpdateChatTable").updateChatTable(i.id,{isReadOnly:s}).then(function(){i.isReadOnly=s,D(i)}).catch(r("WAWebNoop"));return}if(o("WAWebChatGetters").getIsGroup(i)&&!((a=i.groupMetadata)!=null&&a.stale)){var u,p,_=((u=i.groupMetadata)==null?void 0:u.groupType)!==o("WAWebGroupType").GroupType.COMMUNITY&&(!((p=i.groupMetadata)!=null&&p.participants.iAmMember())||m(i));i.isReadOnly!==_&&(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["chat:updateReadOnly:old ",", new ",""])),i.isReadOnly,_),l=o("WAWebDBUpdateChatTable").updateChatTable(i.id,{isReadOnly:_}).then(function(){i.isReadOnly=_,D(i)}))}l.then(function(){o("WAWebChatGetters").getIsBroadcast(i)&&T(i)})}}function E(e){var t,n=o("WAWebStateUtils").unproxy(e);return((t=n.groupMetadata)==null?void 0:t.participants.length)||1}function k(e,t,n){var r=o("WAWebUserPrefsMeUser").getMeLidUserOrThrow();if(r.equals(e))return o("WAWebUserPrefsMeUser").getMePnUserOrThrow();if(o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()||!e.isLid())return e;var a=o("WAWebApiContact").getPhoneNumber(e);return a==null?(o("WAWebCurrentUser").isEmployee()&&o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["getOneToOneContactFromGroupContact: could not find PN for Lid ",""])),e.toString()),o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["getOneToOneContactFromGroupContact: Participant LID does not have PN mapping. context: ",". more context: ",""])),t,n).sendLogs("lid-group-get-one-to-one-contact"),null):a}function I(e){var t,n=e.participants,r=(t=e.size)!=null?t:0,o=n.iAmAdmin()?r:n.length;return o}function T(e){if(o("WAWebChatGetters").getIsBroadcast(e)){var t,n,r;e.formattedTitle=(t=e.contact.name)!=null?t:((n=(r=e.groupMetadata)==null?void 0:r.participants)!=null?n:[]).map(function(e){return o("WAWebFrontendContactGetters").getFormattedShortName(e.contact)}).join(", ")}else if(o("WAWebChatGetters").getIsUser(e)){var a;e.formattedTitle=(a=o("WAWebFrontendContactGetters").getFormattedUser(e.contact))!=null?a:""}else if(o("WAWebChatGetters").getIsGroup(e)){var i,l;e.formattedTitle=(i=e.contact.name)!=null?i:(l=e.groupMetadata)==null?void 0:l.subject}else if(o("WAWebChatGetters").getIsNewsletter(e)){var s,u;e.formattedTitle=(s=e.contact.name)!=null?s:(u=e.newsletterMetadata)==null?void 0:u.name}}function D(e,t){var n;return e.isReadOnly||e.isAnnounceGrpRestrict===!0||o("WAWebTosGating").shouldBlockByTos(e.contact)||o("WAWebTosGating").shouldBlockByBotTos(e.contact)||o("WAWebTosCountryGating").shouldBlockByCountry(e.contact)||!o("WAWebBotGating").isBotEnabled()&&e.id.isBot()||!o("WAWebBotGating").isFbidBotEnabled()&&e.id.isFbidBot()||o("WAWebBizAiAgentGating").isAiAgentAutoReplyEnabled()&&(o("WAWebBizAiAgentStatusUtils").shouldShowAiAgentBlockBar(e)||o("WAWebBizAiAgentStatusUtils").tryToEnableAiAgent(e))||(n=t!=null?t:e.contact.businessProfile)!=null&&n.isBizBot3p&&(!o("WAWebBotGating").isBizBot3pAvailable()||!o("WAWebBotTos").hasAcceptedBizBotTos())?(e.canSend=!1,!1):o("WAWebChatGetters").getIsUser(e)?e.canSend=!(e.contact.isContactBlocked||o("WAWebChatGetters").getIsPSA(e)||o("WAWebChatGetters").getIsIAS(e)||o("WAWebReachoutTimelockUtils").isUserReachoutTimelocked()&&!o("WAWebReachoutTimelockUtils").canSendMsgWhileTimelocked({chat:e,contact:e.contact})||o("WAWebIndividualNewChatMessageCappingLimitUtils").isUserCapped()&&!o("WAWebIndividualNewChatMessageCappingLimitUtils").canSendMsgWhileCapped({chat:e,contact:e.contact})):o("WAWebChatGetters").getIsNewsletter(e)?e.canSend=o("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(e.newsletterMetadata):(e.canSend=!0,!0)}function x(e){return o("WAWebChatGetters").getIsGroup(e)&&o("WAWebGroupGatingUtils").isGroupExitExperienceEnabled()&&!p(e)&&!e.isReadOnly}l.isSupportGroup=d,l.isTerminatedGroup=m,l.isCommunityAnnouncementGroup=p,l.isCommunityGeneralGroup=_,l.isSuspendedGroup=f,l.canSendToGroup=g,l.isInviteGrowthLockedGroup=h,l.isTerminatedGroupOrNotMember=y,l.isSuspendedCommunityAnnouncementGroup=C,l.isIntegrityDeactivatedCommunityAnnouncementGroup=b,l.shouldIncludeEntityIdInAppealRequest=v,l.isDeactivatedCommunityAnnouncementGroup=S,l.shouldBlockCall=R,l.updateReadOnly=L,l.getParticipantCount=E,l.getOneToOneContactFromGroupContact=k,l.getGroupParticipantsCount=I,l.updateTitle=T,l.updateCanSend=D,l.isGroupExitExperienceEnabledForChat=x}),98);
__d("WAWebChatLinkMsgsCollection",["Promise","WAFilteredCatch","WALogger","WAPromiseLoop","WAWebBackendErrors","WAWebBaseCollection","WAWebMsgCollection","WAWebMsgLinks","WAWebMsgModel","WAWebNoop","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u=(function(t){function a(){for(var r,a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return r=t.call.apply(t,[this].concat(i))||this,r.hasLinkBefore=!0,r.$ChatLinkMsgsCollection$p_1=null,r.count=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n;if(r.$ChatLinkMsgsCollection$p_1!=null)return r.$ChatLinkMsgsCollection$p_1;var a=t.msgs.filter(function(e){return o("WAWebMsgLinks").getLinksFromMsg(e).length>0}),i=(n=a[0])!=null?n:t.msgs.head();if(i==null)return 0;try{var l,s=yield o("WAWebMsgCollection").MsgCollection.queryMedia(i.id.remote,1/0,"before",i.id,"url"),u=(l=s.length)!=null?l:0,c=u>0&&a.length>0?1:0;return r.$ChatLinkMsgsCollection$p_1=u+a.length-c,r.$ChatLinkMsgsCollection$p_1}catch(n){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to count medias for chat ",""])),t.id).verbose().devConsole(n).sendLogs("md-failed-medias-count: "+n.message),null}});return function(e){return t.apply(this,arguments)}})(),babelHelpers.assertThisInitialized(r)||babelHelpers.assertThisInitialized(r)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.delete=function(){t.prototype.delete.call(this),this.stopListening(),this.reset()},i.add=function(n,r){return this.$ChatLinkMsgsCollection$p_1=null,t.prototype.add.call(this,n,r)},i.remove=function(n,r){return this.$ChatLinkMsgsCollection$p_1=null,t.prototype.remove.call(this,n,r)},i.queryLinks=function(t,a){var e=this;if(a){if(this.queryLinkBefore)return this.queryLinkBefore;var i=this.queryLinkBefore=o("WAWebMsgCollection").MsgCollection.queryMedia(a.id.remote,o("WAWebMsgCollection").MEDIA_QUERY_LIMIT,"before",a.id,"url").then(function(t){(!t||t.length<o("WAWebMsgCollection").MEDIA_QUERY_LIMIT)&&(e.hasLinkBefore=!1),e.add(t,{at:0}),e.createLinksAndAddMsgs(t)}).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").E404,r("WAWebNoop"))).finally(function(){e.queryLinkBefore=null,e.trigger("query_link_before")});return this.trigger("query_link_before"),i}var l=t.msgs.getModelsArray();if(this.length===0){if(!l||l.length===0)return this.hasLinkBefore=!1,(s||(s=n("Promise"))).resolve();this.add(l.filter(function(e){return o("WAWebMsgLinks").getLinksFromMsg(e).length>0}),{at:0}),this.createLinksAndAddMsgs(l)}if(t.msgs.msgLoadState.noEarlierMsgs)return this.hasLinkBefore=!1,(s||(s=n("Promise"))).resolve();if(this.length<=2*o("WAWebMsgCollection").MEDIA_QUERY_LIMIT){var u=this.length===0?t.msgs.head():this.head();return this.queryLinks(t,u)}return(s||(s=n("Promise"))).resolve()},i.createLinksAndAddMsgs=function(t){var e=this,n=[];o("WAPromiseLoop").promiseLoop(function(e,r,a){if(t.length===a){e();return}var i=t[a];if(i!=null){var l=o("WAWebMsgLinks").getLinksFromMsg(i);l.length&&n.push(i)}}).then(function(){e.add(n),e.trigger("query_link_before")})},a})(o("WAWebBaseCollection").BaseCollection);u.model=o("WAWebMsgModel").Msg,u.comparator=function(e,t){return e.t-t.t},l.default=u}),98);
__d("WAWebWamEnumWebcMessageQueryDirection",[],(function(t,n,r,o,a,i){var e=Object.freeze({LOAD_PREV:0,LOAD_NEXT:1,LOAD_AROUND:2});i.WEBC_MESSAGE_QUERY_DIRECTION=e}),66);
__d("WAWebWebcMessageQueryWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebcChatType","WAWebWamEnumWebcMessageQueryDirection","WAWebWamEnumWebcQueryTriggerType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WebcMessageQuery:[1876,{webcAudioMessageCount:[14,e.TYPES.INTEGER],webcBrowserNetworkType:[1,e.TYPES.STRING],webcBrowserStorageQuotaBytes:[20,e.TYPES.INTEGER],webcBrowserStorageQuotaUsedBytes:[21,e.TYPES.INTEGER],webcChatPosition:[2,e.TYPES.INTEGER],webcChatType:[13,o("WAWebWamEnumWebcChatType").WEBC_CHAT_TYPE],webcDocumentMessageCount:[16,e.TYPES.INTEGER],webcEarliestMessageIndex:[11,e.TYPES.INTEGER],webcEarliestMessageT:[12,e.TYPES.TIMER],webcMessageCount:[4,e.TYPES.INTEGER],webcMessageQueryTrigger:[19,o("WAWebWamEnumWebcQueryTriggerType").WEBC_QUERY_TRIGGER_TYPE],webcMessageQueryType:[3,o("WAWebWamEnumWebcMessageQueryDirection").WEBC_MESSAGE_QUERY_DIRECTION],webcOtherMessageCount:[18,e.TYPES.INTEGER],webcPhotoMessageCount:[7,e.TYPES.INTEGER],webcPttMessageCount:[15,e.TYPES.INTEGER],webcQueryT:[9,e.TYPES.TIMER],webcResponseBytes:[10,e.TYPES.INTEGER],webcStickerMessageCount:[17,e.TYPES.INTEGER],webcTextMessageCount:[5,e.TYPES.INTEGER],webcVideoMessageCount:[6,e.TYPES.INTEGER]},[1,1,5],"regular"]},{WebcMessageQuery:[]});l.WebcMessageQueryWamEvent=s}),98);
__d("WAWebMsgCountReporter",["WAWebMsgType","WAWebWebcMessageQueryWamEvent"],(function(t,n,r,o,a,i,l){function e(e){return new(o("WAWebWebcMessageQueryWamEvent")).WebcMessageQueryWamEvent({webcResponseBytes:0,webcMessageCount:0,webcTextMessageCount:0,webcVideoMessageCount:0,webcPhotoMessageCount:0,webcAudioMessageCount:0,webcPttMessageCount:0,webcStickerMessageCount:0,webcDocumentMessageCount:0,webcOtherMessageCount:0,webcMessageQueryTrigger:e})}function s(e,t){e.webcMessageCount+=t.length;for(var n=0,r=t[n];n<t.length;++n,r=t[n])switch(r.type){case o("WAWebMsgType").MSG_TYPE.CHAT:case o("WAWebMsgType").MSG_TYPE.LOCATION:case o("WAWebMsgType").MSG_TYPE.PAYMENT:case o("WAWebMsgType").MSG_TYPE.VCARD:case o("WAWebMsgType").MSG_TYPE.CIPHERTEXT:case o("WAWebMsgType").MSG_TYPE.MULTI_VCARD:case o("WAWebMsgType").MSG_TYPE.REVOKED:case o("WAWebMsgType").MSG_TYPE.OVERSIZED:e.webcTextMessageCount+=1;break;case o("WAWebMsgType").MSG_TYPE.IMAGE:case o("WAWebMsgType").MSG_TYPE.PRODUCT:e.webcPhotoMessageCount+=1;break;case o("WAWebMsgType").MSG_TYPE.VIDEO:e.webcVideoMessageCount+=1;break;case o("WAWebMsgType").MSG_TYPE.AUDIO:e.webcAudioMessageCount+=1;break;case o("WAWebMsgType").MSG_TYPE.PTT:e.webcPttMessageCount+=1;break;case o("WAWebMsgType").MSG_TYPE.STICKER:e.webcStickerMessageCount+=1;break;case o("WAWebMsgType").MSG_TYPE.DOCUMENT:e.webcDocumentMessageCount+=1;break;default:e.webcOtherMessageCount+=1;break}}l.newMessageQueryEvent=e,l.logMessageCounts=s}),98);
__d("WAWebChatLoadMessages",["Promise","WAAbortError","WABackoffUtils","WAFilteredCatch","WALogger","WANullthrows","WAPromiseDelays","WAPromiseLoop","WARaceSignal","WAStorageEstimator","WAWebBackendErrors","WAWebChatConstants","WAWebChatGetters","WAWebCollectionConstants","WAWebGetNewsletterCursor","WAWebMiscErrors","WAWebMsgCollection","WAWebMsgCountReporter","WAWebNetworkType","WAWebNewsletterGatingUtils","WAWebNewsletterGetMessageUpdatesAction","WAWebNewsletterPullMessagesFromServerAction","WAWebNewsletterSystemMessages","WAWebStateUtils","WAWebSyncGatingUtils","WAWebWamEnumWebcMessageQueryDirection","WAWebWamEnumWebcQueryTriggerType","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t,n){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){var a=o("WAWebStateUtils").unproxy(e),i=t;if(i||(i=a.msgs),p(a,i))return(s||(s=n("Promise"))).resolve();if(i.msgLoadState.isLoadingRecentMsgs)return i.loadRecentPromise;var l=yield _(a,"after",i,o("WAWebWamEnumWebcQueryTriggerType").WEBC_QUERY_TRIGGER_TYPE.USER_SCROLL,r),u=l.msgs;return u}),c.apply(this,arguments)}function d(e,t,n,r){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,a){var i=o("WAWebStateUtils").unproxy(e);yield i.waitForChatLoading();var l=t,u=r!=null?r:o("WAWebWamEnumWebcQueryTriggerType").WEBC_QUERY_TRIGGER_TYPE.USER_SCROLL;if(l||(l=i.msgs),l.msgLoadState.noEarlierMsgs)return(s||(s=n("Promise"))).resolve();if(l.msgLoadState.isLoadingEarlierMsgs)return l.loadEarlierPromise;var c=l?l.head():null;if(o("WAWebChatGetters").getIsNewsletter(i)&&c!=null&&o("WAWebNewsletterSystemMessages").isEarliestNewsletterSystemMsg(c))return l.msgLoadState.noEarlierMsgs=!0,[];var d=function(){return c?c.msgChunk:l},m=yield _(i,"before",l,u,a),p=m.msgs,f=m.hasMoreMsgs,g=d();return g&&!f&&(g.msgLoadState.noEarlierMsgs=i.endOfHistoryTransferType!==o("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.INCOMPLETE,o("WAWebSyncGatingUtils").isHistorySyncOnDemandEnabled()&&(g.msgLoadState.noEarlierMsgs=g.msgLoadState.noEarlierMsgs&&i.endOfHistoryTransferType!==o("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY)),p}),m.apply(this,arguments)}function p(e,t){return e.msgs===t}function _(e,t,n,r,o){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a){var i;t==="after"?i=n.last():i=n.head();var l={};i?l=i.id.clone():l.remote=e.id,l.count=o("WAWebCollectionConstants").PAGE_SIZE,l.direction=t;var s=o("WAWebMsgCountReporter").newMessageQueryEvent(r),u=yield g(e,i,n,o("WAWebMsgCollection").MsgCollection.findQuery.bind(o("WAWebMsgCollection").MsgCollection,l),t,s,!0,a);o("WAWebChatGetters").getIsNewsletter(e)&&o("WAWebNewsletterGatingUtils").isNewsletterReactionEnabled()&&(yield o("WAWebNewsletterGetMessageUpdatesAction").maybeUpdateMsgsAddOns(u,e));var c=u.length>=o("WAWebCollectionConstants").PAGE_SIZE;if(c||!o("WAWebChatGetters").getIsNewsletter(e)||!o("WAWebNewsletterGatingUtils").isNewsletterEnabled())return{msgs:u,hasMoreMsgs:c};try{var d=u[0];if(t==="before"&&d!=null&&o("WAWebNewsletterSystemMessages").isNewsletterSystemMsg(d))return{msgs:u,hasMoreMsgs:!1};var m=u.length>o("WAWebCollectionConstants").PAGE_SIZE,p=m?[]:yield o("WAWebNewsletterPullMessagesFromServerAction").pullNewsletterMessagesFromServer(e,{messageCount:o("WAWebCollectionConstants").PAGE_SIZE-u.length,cursor:o("WAWebGetNewsletterCursor").getNewsletterCursor(n,t,u),resetUnreadCount:!0}),_=t==="before"?p.concat(u):u.concat(p),f=_.length>=o("WAWebCollectionConstants").PAGE_SIZE,h=_[0];if(t==="before"&&!f&&(h==null||!o("WAWebNewsletterSystemMessages").isNewsletterSystemMsg(h))){var y=yield o("WAWebNewsletterSystemMessages").addSystemMessagesToChat(e);_.unshift.apply(_,y)}return{msgs:_,hasMoreMsgs:f}}catch(e){return{msgs:u,hasMoreMsgs:!0}}}),f.apply(this,arguments)}function g(t,a,i,l,u,c,d,m){d===void 0&&(d=!0);var p=o("WAWebStateUtils").unproxy(t),_=self.performance.now();u==="after"?(i.msgLoadState.isLoadingRecentMsgs=!0,c.webcMessageQueryType=o("WAWebWamEnumWebcMessageQueryDirection").WEBC_MESSAGE_QUERY_DIRECTION.LOAD_NEXT):u==="before"?(i.msgLoadState.isLoadingEarlierMsgs=!0,c.webcMessageQueryType=o("WAWebWamEnumWebcMessageQueryDirection").WEBC_MESSAGE_QUERY_DIRECTION.LOAD_PREV):u==="around"&&(i.msgLoadState.isLoadingAroundMsgs=!0,c.webcMessageQueryType=o("WAWebWamEnumWebcMessageQueryDirection").WEBC_MESSAGE_QUERY_DIRECTION.LOAD_AROUND),c.webcBrowserNetworkType=o("WAWebNetworkType").getEffectiveNetworkType(),c.webcChatType=p.getWebcChatType(),typeof p.initialIndex=="number"&&(c.webcChatPosition=p.initialIndex);var f=r("WARaceSignal")([m,p.getDeleteSignal()].filter(Boolean),function(t){return o("WAPromiseLoop").promiseLoop((function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(r,d,m){if(t.aborted)throw new(o("WAAbortError")).AbortError;var f=o("WAPromiseDelays").delayMs(o("WABackoffUtils").expBackoff(m,12e4,1e3,.1)),g=(s||(s=n("Promise"))).resolve();try{yield g;var y=yield l();if(t.aborted)throw new(o("WAAbortError")).AbortError;c.webcQueryT=Math.ceil(self.performance.now()-_);var C;Array.isArray(y[0])?(C=y[0][0],y.forEach(function(e){return o("WAWebMsgCountReporter").logMessageCounts(c,e)})):(C=y[0],o("WAWebMsgCountReporter").logMessageCounts(c,y)),C&&(c.webcEarliestMessageT=C.t,C.msgChunk===p.msgs&&(c.webcEarliestMessageIndex=p.msgs.length-1)),o("WAStorageEstimator").estimateStorage().then(function(e){if(e.success){var t=e.value,n=t.quota,r=t.usage;c.webcBrowserStorageQuotaBytes=n,c.webcBrowserStorageQuotaUsedBytes=r}}).finally(function(){return c.commit()}),h(a,i,u),r(y)}catch(t){if(t.name===o("WAAbortError").ABORT_ERROR)throw t;return m>3||t===404?(h(a,i,u),o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["chat:loadMsgs:error ",""])),String(t)),t===404?(s||(s=n("Promise"))).reject(new(o("WAWebBackendErrors")).E404):(s||(s=n("Promise"))).reject(new(o("WAWebMiscErrors")).GaveUpRetry("Gave up msg fetch after "+m+" tries"))):f}});return function(e,t,n){return r.apply(this,arguments)}})(),0)}).catch(o("WAFilteredCatch").filteredCatch(o("WAWebMiscErrors").GaveUpRetry,function(){return[]})).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").E404,function(e){if(d)return[];throw e}));return u==="after"?i.loadRecentPromise=f:u==="before"?i.loadEarlierPromise=f:u==="around"&&(i.loadAroundPromise=f),f}function h(e,t,n){var o=(e==null?void 0:e.msgChunk)&&e.msgChunk!==t;t.msgLoadState.contextLoaded=!0,e&&o&&(r("WANullthrows")(e.msgChunk).msgLoadState.contextLoaded=!0),n==="after"?t.msgLoadState.isLoadingRecentMsgs=!1:n==="before"?t.msgLoadState.isLoadingEarlierMsgs=!1:n==="around"&&(t.msgLoadState.isLoadingAroundMsgs=!1)}l.loadRecentMsgs=u,l.loadEarlierMsgs=d,l.loadMsgsPromiseLoop=g}),98);
__d("WAWebChatMedia",["Promise","WAWebCarouselMsgUtils","WAWebChatMediaMsgsCollection","WAWebFrontendMsgGetters","WAWebMessageAssociationUIUtils","WAWebMsgGetters","WAWebMsgLinks","WAWebStateUtils"],(function(t,n,r,o,a,i,l){var e;function s(e){var t=o("WAWebStateUtils").unproxy(e),n=t.mediaMsgs,r=t.linkMsgs,a=t.docMsgs,i=t.productMsgs;n&&(n.delete(),n.queryMedia({chat:t})),r&&(r.delete(),r.queryLinks(t)),a&&(a.delete(),a.queryDocs(t)),i&&(i.delete(),i.queryProducts(t))}function u(e){return o("WAWebMsgGetters").getIsMedia(e)&&!e.isViewOnce}function c(e,t,n){if(t){var r=o("WAWebStateUtils").unproxy(e),a=o("WAWebCarouselMsgUtils").flattenMsgs(Array.isArray(t)?t:[t]),i=[],l=[],s=[],c=[];a.forEach(function(e){u(e)&&i.push(e),o("WAWebFrontendMsgGetters").getAsDoc(e)&&s.push(e),o("WAWebMsgLinks").getGalleryLinks(e).length&&l.push(e),o("WAWebFrontendMsgGetters").getAsProduct(e)!=null&&c.push(e)});var d=r.mediaMsgs;if(d&&i.length){var m=babelHelpers.extends({},n,{silent:!1});d.add(i,m)}r.linkMsgs&&l.length&&r.linkMsgs.add(l,n),r.docMsgs&&s.length&&r.docMsgs.add(s,n),r.productMsgs&&c.length&&r.productMsgs.add(c,n)}}function d(e,t){var n=o("WAWebStateUtils").unproxy(e),a=new(r("WAWebChatMediaMsgsCollection")),i=n.getMediaMsgs().filter(o("WAWebMessageAssociationUIUtils").shouldDisplayOrphanMessage);if(t||a.add(i),!t||t.isViewOnce)return a;if((i.includes(t)||t.msgChunk===n.msgs)&&(a.add(i),a.hasMediaAfter=!1),!i.includes(t)){var l=t.msgChunk!=null?t.msgChunk.slice():[t],s=l.filter(o("WAWebMessageAssociationUIUtils").shouldDisplayOrphanMessage),c=o("WAWebCarouselMsgUtils").flattenMsgs(s);a.add(c.filter(u))}return a}function m(t){var r=o("WAWebStateUtils").unproxy(t);return r.promises.sendDelete!=null?(e||(e=n("Promise"))).resolve(0):(e||(e=n("Promise"))).all([r.getMediaMsgs(),r.getLinkMsgs(),r.getDocMsgs()].map(function(e){return e.count(r)})).then(function(e){return e.reduce(function(e,t){return e+(t!=null?t:0)},0)})}l.resetMediaMsgs=s,l.addMediaMsgs=c,l.constructMediaMsgs=d,l.countAllMedia=m}),98);
__d("WAWebChatMediaMsgsCollection",["Promise","WAFilteredCatch","WALogger","WAWebBackendErrors","WAWebBaseCollection","WAWebCarouselMsgUtils","WAWebMessageAssociationUIUtils","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgModel","WAWebNoop","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u={before:"before",after:"after"};function c(e){return o("WAWebMsgGetters").getIsMedia(e)&&!e.isViewOnce&&o("WAWebMessageAssociationUIUtils").shouldDisplayOrphanMessage(e)}var d=(function(t){function a(){for(var r,a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return r=t.call.apply(t,[this].concat(i))||this,r.hasMediaBefore=!0,r.hasMediaAfter=!0,r.$ChatMediaMsgsCollection$p_1=null,r.count=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n;if(r.$ChatMediaMsgsCollection$p_1!=null)return r.$ChatMediaMsgsCollection$p_1;var a=t.msgs.filter(c),i=(n=a[0])!=null?n:t.msgs.head();if(i==null)return 0;try{var l,s=yield o("WAWebMsgCollection").MsgCollection.queryMedia(i.id.remote,1/0,"before",i.id),u=(l=s.mediaCount)!=null?l:0,d=u>0&&a.length>0?1:0;return r.$ChatMediaMsgsCollection$p_1=u+a.length-d,r.$ChatMediaMsgsCollection$p_1}catch(n){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to count medias for chat "," with error ",""])),t.id,n).verbose().devConsole(n).sendLogs("md-failed-medias-count"),null}});return function(e){return t.apply(this,arguments)}})(),babelHelpers.assertThisInitialized(r)||babelHelpers.assertThisInitialized(r)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.delete=function(){t.prototype.delete.call(this),this.stopListening()},i.add=function(n,r){return this.$ChatMediaMsgsCollection$p_1=null,t.prototype.add.call(this,n,r)},i.remove=function(n,r){return this.$ChatMediaMsgsCollection$p_1=null,t.prototype.remove.call(this,n,r)},i.getAfter=function(t){var e=this.indexOf(t);return e<0||e===this.length-1?null:this.at(e+1)},i.getBefore=function(t){var e=this.indexOf(t);return e<=0?null:this.at(e-1)},i.loadEarlierMedias=function(){var e=this.head();if(e){if(e.isCarouselCard){var t;e=(t=o("WAWebCarouselMsgUtils").getParentMsgFromCarouselCard(e))!=null?t:e}this.queryMedia({msg:e})}},i.loadRecentMedias=function(){var e=this.last();if(e){if(e.isCarouselCard){var t;e=(t=o("WAWebCarouselMsgUtils").getParentMsgFromCarouselCard(e))!=null?t:e}this.queryMedia({msg:e,direction:u.after})}},i.loadMoreAroundIfNeeded=function(t){if(!(!t||t.isViewOnce)){var e=this.indexOf(t);e<20&&this.hasMediaBefore&&this.loadEarlierMedias(),this.length-e<20&&this.hasMediaAfter&&this.loadRecentMedias()}},i.queryMedia=function(t){var e,a=this,i=t.chat,l=t.msg,d=(e=t.direction)!=null?e:u.before;if(!l&&i){var p=i.msgs;if(!p||p.length===0)return this.hasMediaBefore=!1,new(s||(s=n("Promise")))(function(e){e({eof:!0})});this.add(p.filter(c),{at:0});var _=this.toArray();if(i.msgs.msgLoadState.noEarlierMsgs)return this.hasMediaBefore=!1,new(s||(s=n("Promise")))(function(e){e({eof:!0})});if(_.length<=2*o("WAWebMsgCollection").MEDIA_QUERY_LIMIT){var f=_.length===0?p.head():_[0];return this.queryMedia({chat:i,msg:f})}return new(s||(s=n("Promise")))(function(e){e({eof:!1})})}if(l&&d===u.before){if(this.queryMediaBefore)return this.queryMediaBefore;var g=0;return this.queryMediaBefore=o("WAWebMsgCollection").MsgCollection.queryMedia(l.id.remote,o("WAWebMsgCollection").MEDIA_QUERY_LIMIT,d,o("WAWebMsgGetters").getIsMedia(l)?l.id:void 0).then(function(e){var t=e.messages;(!t||t.length<o("WAWebMsgCollection").MEDIA_QUERY_LIMIT)&&(a.hasMediaBefore=!1);var n=[];return t&&t.length>0&&(n=m(t)),a.add(n,{at:0}),g=n.length,{length:g}}).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").E404,r("WAWebNoop"))).finally(function(){a.queryMediaBefore=null,a.trigger("query_media_before",g)}),this.trigger("query_media_before",0),this.queryMediaBefore}else if(l&&d===u.after)return this.queryMediaAfter?this.queryMediaAfter:this.queryMediaAfter=o("WAWebMsgCollection").MsgCollection.queryMedia(l.id.remote,o("WAWebMsgCollection").MEDIA_QUERY_LIMIT,d,l.id).then(function(e){var t=e.messages;(!t||t.length<o("WAWebMsgCollection").MEDIA_QUERY_LIMIT)&&(a.hasMediaAfter=!1);var n=[];return t&&t.length>0&&(n=m(t)),a.add(n),{length:n.length}}).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").E404,r("WAWebNoop"))).finally(function(){a.queryMediaAfter=null,a.trigger("query_media_after")})},a})(o("WAWebBaseCollection").BaseCollection);d.model=o("WAWebMsgModel").Msg,d.comparator=function(e,t){return e.t-t.t};function m(e){return o("WAWebCarouselMsgUtils").flattenMsgs(e).filter(c)}l.default=d}),98);
__d("WAWebChatMessageSearch",["WANullthrows","WAWebChatAssignmentUtils","WAWebChatConstants","WAWebChatGetters","WAWebChatLoadMessages","WAWebChatMsgsCollection","WAWebChatSearchFilters","WAWebCollectionConstants","WAWebContactGetters","WAWebFrontendChatGetters","WAWebFrontendContactGetters","WAWebMessageAssociation.flow","WAWebMsgCollection","WAWebMsgCountReporter","WAWebStateUtils","WAWebViewMode.flow","WAWebViewModeUtils","WAWebWamEnumWebcQueryTriggerType","isEmptyObject"],(function(t,n,r,o,a,i,l){function e(e,t,n){var a,i,l,s=o("WAWebStateUtils").unproxy(e),u=o("WAWebMsgCollection").MsgCollection.get(t),c=t,d=n,m=(a=u)==null?void 0:a.parentMsgKey;m&&((i=u)==null?void 0:i.associationType)===o("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_ALBUM&&!o("WAWebViewModeUtils").isViewModeVisibleInSurface(o("WAWebViewMode.flow").ViewModeSurface.CHAT,(l=u)==null?void 0:l.viewMode)&&(u=o("WAWebMsgCollection").MsgCollection.get(m),c=m,d=u);var p=u?u.msgChunk:void 0,_=Math.trunc(o("WAWebCollectionConstants").PAGE_SIZE/3*2);if(!p||!p.msgLoadState.contextLoaded){var f;p||(p=new(o("WAWebChatMsgsCollection")).ChatMsgsCollection,s.msgChunks.push(p),u&&p.add(u));var g=u?u.id.clone():c.clone();g.count=_,g.serverId=(f=u)==null?void 0:f.serverId;var h=function(){if(u)return u.msgChunk;if(c!=null){var e=o("WAWebMsgCollection").MsgCollection.get(c);return e!=null&&e.msgChunk?e.msgChunk:p}return p},y=o("WAWebMsgCountReporter").newMessageQueryEvent(o("WAWebWamEnumWebcQueryTriggerType").WEBC_QUERY_TRIGGER_TYPE.SEARCH_RESULT_CLICK);o("WAWebChatLoadMessages").loadMsgsPromiseLoop(s,u,p,o("WAWebMsgCollection").MsgCollection.getContext.bind(o("WAWebMsgCollection").MsgCollection,g,h),"around",y,d==null).then(function(e){var t=h();t&&p&&t!==p&&s.notifyMsgCollectionMerge(t,p,t);var n=e[0],a=c?o("WAWebMsgCollection").MsgCollection.get(c):u;a&&Array.isArray(n)&&n.length<_&&(r("WANullthrows")(a.msgChunk).msgLoadState.noEarlierMsgs=s.endOfHistoryTransferType!==o("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.INCOMPLETE,p&&a.msgChunk!==p&&(p.msgLoadState.noEarlierMsgs=s.endOfHistoryTransferType!==o("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.INCOMPLETE))}).catch(function(){d&&(d.isQuotedMsgAvailable=!1)})}return{collection:p,msg:u,key:c,highlightMsg:!0}}function s(e,t,n,r){n===void 0&&(n=1);var a=o("WAWebStateUtils").unproxy(e);if(n===1){var i=a.ftsCache[t];if(i)return i;var l=o("WAWebMsgCollection").MsgCollection.search(t,n,r,a.id);a.ftsCache[t]=l;var s=function(){a.ftsCache[t]=null};return self.setTimeout(s,o("WAWebChatConstants").FTS_TTL),l.catch(s),l}return o("WAWebMsgCollection").MsgCollection.search(t,n,r,a.id)}function u(e){var t=o("WAWebStateUtils").unproxy(e);t.ftsCache={}}function c(e){return!!o("WAWebChatGetters").getHasUnread(e)&&!o("WAWebChatGetters").getIsBroadcast(e)||o("WAWebChatAssignmentUtils").canAssignChats()&&e.isAssignedToMe&&e.unopenedByAssignedAgent}function d(e,t){t===void 0&&(t={});var n=o("WAWebStateUtils").unproxy(e);if(r("isEmptyObject")(t))return!0;if(t.label)return n.labels!=null&&n.labels.includes(t.label);if(t.kind===o("WAWebChatSearchFilters").SearchFilters.UNREAD)return c(n);if(t.kind===o("WAWebChatSearchFilters").SearchFilters.FAVORITES)return n.isFavorite;if(t.kind===o("WAWebChatSearchFilters").SearchFilters.CONTACT)return o("WAWebFrontendContactGetters").getIsMyContact(n.contact)&&!o("WAWebContactGetters").getIsGroup(n.contact)&&!o("WAWebChatGetters").getIsBroadcast(n);if(t.kind===o("WAWebChatSearchFilters").SearchFilters.NON_CONTACT)return!o("WAWebFrontendContactGetters").getIsMyContact(n.contact)&&!o("WAWebContactGetters").getIsGroup(n.contact)&&!o("WAWebChatGetters").getIsBroadcast(n);if(t.kind===o("WAWebChatSearchFilters").SearchFilters.ASSIGNED_TO_YOU)return o("WAWebChatAssignmentUtils").canAssignChats()&&n.isAssignedToMe;var a=o("WAWebFrontendChatGetters").getKind(n);return a!=null&&t.kind===o("WAWebChatSearchFilters").SearchFilters.cast(a)}l.getSearchContext=e,l.fts=s,l.clearFtsCache=u,l.matchFilter=d}),98);
__d("WAWebChatParticipantColor",["WALogger","WAMd5","WAWebContactGetters","WAWebLidMigrationUtils","WAWebStateUtils","WAWebUserPrefsGeneral","lodash"],(function(t,n,r,o,a,i,l){var e;function s(e){var t,n,a=o("WAWebStateUtils").unproxy(e);if(a.colors){var i=(t=(n=a.groupMetadata)==null?void 0:n.participants)!=null?t:[],l=a.colors,s=Array.from(new Set(Object.keys(l)).difference(new Set(i.map(function(e){return e.id.toString()}).map(r("WAMd5")))));s.forEach(function(e){delete l[e]}),s.length&&a.saveAssignedColorsDebounced()}}function u(e){var t=o("WAWebStateUtils").unproxy(e);return t.groupMetadata&&t.listenTo(t.groupMetadata.participants,"remove reset",s),o("WAWebUserPrefsGeneral").getGroupParticipantAssignedColor(t.id)}function c(e){if(e.isUser()){var t;return(t=o("WAWebLidMigrationUtils").toLid(e))!=null?t:e}return e}function d(e){var t=o("WAWebStateUtils").unproxy(e),n=t.colors;n&&o("WAWebUserPrefsGeneral").setGroupParticipantAssignedColor(t.id,n)}function m(t,n){var a=o("WAWebStateUtils").unproxy(t);if(o("WAWebContactGetters").getIsNewsletter(a))return 1;if(n==null)return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["received a null sender wid when getting assigned color"]))).tags("messaging").devConsole(a).sendLogs("unexpected null sender wid for getting assigned color"),1;var i=a.colors||(a.colors=u(a)),l,s=r("WAMd5")(c(n).toString());if(l=i[s])return l;var d={};r("lodash").forOwn(i,function(e,t){d[e]?d[e].push(t):d[e]=[t]});for(var m=Number.POSITIVE_INFINITY,p=17,_=1;_<=p;_++)if(d[_])d[_].length<m&&(m=d[_].length,l=_);else{l=_;break}return i[s]=l,a.saveAssignedColorsDebounced(),l}l.saveAssignedColors=d,l.getAssignedColor=m}),98);
__d("WAWebEphemeralKeepInChatAbpropUtils",["WAWebABProps","WAWebRevokeMsgConstants"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebABProps").getABPropConfigValue("keep_in_chat_undo_duration_limit")||o("WAWebRevokeMsgConstants").REVOKE_WINDOW}function s(){return o("WAWebABProps").getABPropConfigValue("supports_keep_in_chat_in_cag")}l.getUndoKeepInChatExpiration=e,l.isKeepInChatInCAGEnabled=s}),98);
__d("WAWebChatModel",["fbt","Promise","WAAbortError","WAFilteredCatch","WAInOrderPromiseQueue","WALogger","WANullthrows","WATimeUtils","WAWebABProps","WAWebAck","WAWebAiThreadCollection","WAWebAlarm","WAWebAppTracker","WAWebBackendErrors","WAWebBaseModel","WAWebBizAiAgentGating","WAWebBizGatingUtils","WAWebBizLabelUtils","WAWebBotGating","WAWebBotProfileCollection","WAWebChatAssignmentCollection","WAWebChatCollection","WAWebChatConstants","WAWebChatDocMsgsCollection","WAWebChatEphemerality","WAWebChatFlowTypes","WAWebChatGetters","WAWebChatGroupUtils","WAWebChatLinkMsgsCollection","WAWebChatLoadMessages","WAWebChatMedia","WAWebChatMediaMsgsCollection","WAWebChatMessageSearch","WAWebChatModelDerivedMethods","WAWebChatParticipantColor","WAWebChatProductMsgsCollection","WAWebChatUpdates","WAWebCmd","WAWebConnModel","WAWebConstantsDeprecated","WAWebContactCollection","WAWebContactGetters","WAWebCurrentUser","WAWebDBEphemeralMessage","WAWebDBUpdateChatTable","WAWebDBUpdateContactTable","WAWebEphemeralKeepInChatAbpropUtils","WAWebEventMsgsCollection","WAWebEventsWaitForBbEvent","WAWebFavoriteCollection","WAWebFrontendChatGetters","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebGroupMetadataCollection","WAWebGroupSafetyCheckUtils","WAWebGroupType","WAWebGroupUnreadMessageType","WAWebHandleNewMsgAction","WAWebKeptMsgCollection","WAWebL10N","WAWebLidMigrationUtils","WAWebLimitSharingModelUtils","WAWebListsGatingUtils","WAWebMedia","WAWebMobilePlatforms","WAWebMsgDataFromModel","WAWebMsgGetters","WAWebMsgLinks","WAWebMsgModelUtils","WAWebMuteCollection","WAWebNewsletterCollection","WAWebNewsletterMetadataCollection","WAWebNoop","WAWebNotificationBackend","WAWebNotificationHelpers","WAWebOTPLoggingHelper","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebPresenceChatAction","WAWebPresenceCollection","WAWebProtobufsE2E.pb","WAWebReachoutTimelockGatingUtils","WAWebSendNotSpamAction","WAWebStarredMsgCollection","WAWebSuperChatMsgs","WAWebTos","WAWebTosGating","WAWebTrustedContactsUtils","WAWebUnreadMentionModel","WAWebUpdateDraftMessageChatAction","WAWebUpdateLastAddOnPreviewChatAction","WAWebUserPrefsMeUser","WAWebViewOnceState","WAWebWamEnumChatAssignmentChatType","WAWebWamEnumWebcChatType","WAWebWid","asyncToGeneratorRuntime","isStringNullOrEmpty","lodash"],(function(t,n,r,o,a,i,l,s){var e,u,c,d,m,p,_,f,g,h=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.id=o("WAWebBaseModel").prop(),e.accountLid=o("WAWebBaseModel").prop(),e.t=o("WAWebBaseModel").prop(),e.unreadCount=o("WAWebBaseModel").prop(0),e.unreadDividerOffset=o("WAWebBaseModel").prop(0),e.archive=o("WAWebBaseModel").prop(),e.isReadOnly=o("WAWebBaseModel").prop(),e.isLocked=o("WAWebBaseModel").prop(),e.isAnnounceGrpRestrict=o("WAWebBaseModel").prop(),e.modifyTag=o("WAWebBaseModel").prop(),e.muteExpiration=o("WAWebBaseModel").prop(0),e.isAutoMuted=o("WAWebBaseModel").prop(!1),e.wallpaper=o("WAWebBaseModel").prop(),e.showDoodle=o("WAWebBaseModel").prop(),e.name=o("WAWebBaseModel").prop(),e.notSpam=o("WAWebBaseModel").prop(),e.pin=o("WAWebBaseModel").prop(),e.changeNumberOldJid=o("WAWebBaseModel").prop(),e.changeNumberNewJid=o("WAWebBaseModel").prop(),e.lastReceivedKey=o("WAWebBaseModel").prop(),e.capiThreadControl=o("WAWebBaseModel").prop(),e.ephemeralDuration=o("WAWebBaseModel").prop(),e.ephemeralSettingTimestamp=o("WAWebBaseModel").prop(),e.disappearingModeInitiator=o("WAWebBaseModel").prop(),e.disappearingModeTrigger=o("WAWebBaseModel").prop(),e.disappearingModeInitiatedByMe=o("WAWebBaseModel").prop(),e.createdLocally=o("WAWebBaseModel").prop(),e.pendingAction=o("WAWebBaseModel").session(),e.formattedTitle=o("WAWebBaseModel").session(),e.active=o("WAWebBaseModel").session(),e.pausedTimerId=o("WAWebBaseModel").session(),e.presenceResendTimerId=o("WAWebBaseModel").session(),e.recording=o("WAWebBaseModel").session(),e.typing=o("WAWebBaseModel").session(),e.colors=o("WAWebBaseModel").session(),e.attachMediaContents=o("WAWebBaseModel").session(),e.draftAttachMediaContentsSortTs=o("WAWebBaseModel").session(),e.isComposingPoll=o("WAWebBaseModel").session(!1),e.pttRecordingSession=o("WAWebBaseModel").session(),e.squelch=o("WAWebBaseModel").session(),e.reactionSquelch=o("WAWebBaseModel").session(),e.pendingSeenCount=o("WAWebBaseModel").session(0),e.markedUnread=o("WAWebBaseModel").session(),e.trusted=o("WAWebBaseModel").session(),e.groupSafetyChecked=o("WAWebBaseModel").session(),e.canSend=o("WAWebBaseModel").session(),e.showUnreadInTitle=o("WAWebBaseModel").session(!1),e.activeUnreadCount=o("WAWebBaseModel").session(),e.isFavorite=o("WAWebBaseModel").session(!1),e.promises=o("WAWebBaseModel").session(function(){return{}}),e.ftsCache=o("WAWebBaseModel").session(function(){return{}}),e.composeQuotedMsg=o("WAWebBaseModel").session(),e.composeQuotedMsgRemoteJid=o("WAWebBaseModel").session(),e.quotedMsgAdminGroupJid=o("WAWebBaseModel").session(),e.quotedMsgAdminGroupSubject=o("WAWebBaseModel").session(),e.quotedMsgAdminParentGroupJid=o("WAWebBaseModel").session(),e.groupMetadata=o("WAWebBaseModel").session(),e.newsletterMetadata=o("WAWebBaseModel").session(),e.presence=o("WAWebBaseModel").session(),e.mute=o("WAWebBaseModel").session(),e.contact=o("WAWebBaseModel").session(),e.mediaCount=o("WAWebBaseModel").session(0),e.linkCount=o("WAWebBaseModel").session(0),e.docCount=o("WAWebBaseModel").session(0),e.productCount=o("WAWebBaseModel").session(0),e.pendingDeleteForMeCount=o("WAWebBaseModel").session(0),e.isParentGroup=o("WAWebBaseModel").session(),e.groupType=o("WAWebBaseModel").session(),e.hasCapi=o("WAWebBaseModel").session(),e.unreadMentionsOfMe=o("WAWebBaseModel").prop(),e.unreadMentionCount=o("WAWebBaseModel").prop(),e.hasUnreadMention=o("WAWebBaseModel").prop(!1),e.archiveAtMentionViewedInDrawer=o("WAWebBaseModel").prop(!1),e.hasChatBeenOpened=o("WAWebBaseModel").prop(!1),e.tcToken=o("WAWebBaseModel").prop(),e.tcTokenTimestamp=o("WAWebBaseModel").prop(),e.tcTokenSenderTimestamp=o("WAWebBaseModel").prop(),e.msgUnsyncedButtonReplyMsgs=o("WAWebBaseModel").prop(),e.endOfHistoryTransfer=o("WAWebBaseModel").session(!1),e.endOfHistoryTransferType=o("WAWebBaseModel").prop(),e.pendingInitialLoading=o("WAWebBaseModel").prop(!1),e.lastReactionPreview=o("WAWebBaseModel").prop(),e.chatlistPreview=o("WAWebBaseModel").prop(),e.previewT=o("WAWebBaseModel").prop(),e.unopenedByAssignedAgent=o("WAWebBaseModel").session(!1),e.isAssignedToMe=o("WAWebBaseModel").session(!1),e.assignedAgent=o("WAWebBaseModel").session(),e.unreadEditTimestampMs=o("WAWebBaseModel").prop(),e.celebrationAnimationLastPlayed=o("WAWebBaseModel").prop(0),e.animationCandidateData=o("WAWebBaseModel").prop(),e.draftMessage=o("WAWebBaseModel").prop(),e.draftMessageSortTs=o("WAWebBaseModel").session(),e.ephemeralDisplayedExemptions=o("WAWebBaseModel").prop(),e.hasOpened=o("WAWebBaseModel").prop(),e.botInitialTypingIndicatorMsgId=o("WAWebBaseModel").session(),e.hasCreatedBotInvokeSystemMsg=o("WAWebBaseModel").prop(),e.bizBotSystemMsgType=o("WAWebBaseModel").prop(),e.hasRequestedWelcomeMsg=o("WAWebBaseModel").prop(!1),e.lidOriginType=o("WAWebBaseModel").prop(),e.hasPreloaded=o("WAWebBaseModel").session(!1),e.chatEntryPoint=o("WAWebBaseModel").session(null),e.forceDismissAiAgentBlockBar=o("WAWebBaseModel").session(!1),e.attempToEnableAi=o("WAWebBaseModel").session(!1),e.limitSharing=o("WAWebBaseModel").prop(),e.mmSignalSharingExpirationWindow=o("WAWebBaseModel").prop(),e.toneId=o("WAWebBaseModel").prop(),e.aiThreads=o("WAWebBaseModel").session(null),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.initialize=function(){var e=this,n;t.prototype.initialize.call(this),this.$ChatImpl$p_4(),this.addQueue=new(r("WAInOrderPromiseQueue")),this.sendQueue=new(r("WAInOrderPromiseQueue")),this.$ChatImpl$p_1=new Set,this.$ChatImpl$p_2=new Map,this.$ChatImpl$p_3=new AbortController,this.$ChatImpl$p_5(),this.msgs.msgLoadState.contextLoaded=!0,this.addChild("presence",o("WAWebPresenceCollection").PresenceCollection.gadd(this.id));var a=o("WAWebMuteCollection").MuteCollection.get(this.id);if(a?this.addChild("mute",a):this.addChild("mute",o("WAWebMuteCollection").MuteCollection.gadd({id:this.id,expiration:this.muteExpiration,isAutoMuted:this.isAutoMuted})),this.listenTo(this.mute,"change:expiration",function(){return o("WAWebChatUpdates").updateMuteExpiration(e)}),this.listenTo(this.mute,"change:isAutoMuted",function(){return o("WAWebChatUpdates").updateMuteExpiration(e)}),this.addChild("contact",o("WAWebContactCollection").ContactCollection.gadd(this.id)),this.name&&!this.contact.name){var i={name:this.name};o("WAWebChatGetters").getIsGroup(this)?this.contact.set(i):o("WAWebChatGetters").getIsNewsletter(this)?this.contact.set(i):o("WAWebDBUpdateContactTable").updateContactTable(this.contact.id,i).then(function(){e.contact.set(i)})}if(this.listenTo(this.contact,"change:name",function(){return o("WAWebChatGroupUtils").updateTitle(e)}),this.listenTo(this.contact,"change:isContactBlocked",function(){return o("WAWebChatGroupUtils").updateCanSend(e)}),this.listenTo(this,"change:id change:archive change:unreadCount change:pendingSeenCount change:muteExpiration change:isLocked",this.$ChatImpl$p_6),this.listenTo(o("WAWebFavoriteCollection").FavoriteCollection,"add remove change",function(){e.isFavorite=!!o("WAWebFavoriteCollection").FavoriteCollection.get(e.id.toString())}),o("WAWebChatGetters").getIsGroup(this)&&(this.trusted=!0),this.listenTo(o("WAWebTos").TosManager,"change",function(){return o("WAWebChatGroupUtils").updateCanSend(e)}),this.listenTo(this.contact,"change:privacyMode",function(){return o("WAWebChatGroupUtils").updateCanSend(e)}),o("WAWebChatGetters").getIsGroup(this)||o("WAWebChatGetters").getIsBroadcast(this)){var l=this.getGroupMetadataCollection(),s;o("WAWebChatGetters").getIsBroadcast(this)&&!l.get(this.id)&&(s=!0);var u=l.gadd(this.id);this.addChild("groupMetadata",u),this.listenTo(u,"change:stale change:announce",this.$ChatImpl$p_7),this.listenTo(u,"change:groupType",function(){e.$ChatImpl$p_6(),e.groupType=u.groupType}),this.groupType=u.groupType,this.listenTo(u,"change:hasCapi",function(){e.hasCapi=u.hasCapi}),this.hasCapi=u.hasCapi,this.listenTo(u.participants,"change:isAdmin bulk_add bulk_remove",this.$ChatImpl$p_7),this.listenTo(u,"change:trusted change:stale",this.isTrusted),this.listenTo(u,"change:groupSafetyCheck change:stale",this.isGroupSafetyChecked),this.listenTo(u,"change:participants change:stale change:suspended change:terminated",function(){o("WAWebChatGroupUtils").updateReadOnly(e)}),this.listenTo(u.participants,"change:contact.formattedShortName",function(){return o("WAWebChatGroupUtils").updateTitle(e)}),this.$ChatImpl$p_8(u),this.listenTo(u.unreadMentionMetadata.unreadMentionCollection,"add remove reset",this.$ChatImpl$p_9),this.listenTo(u.unreadMentionMetadata,"change:pendingUnreadMentionCount",this.$ChatImpl$p_9),this.$ChatImpl$p_7(),o("WAWebChatGroupUtils").updateReadOnly(this);var c=this.id;this.listenTo(this,"change:isAnnounceGrpRestrict",function(){o("WAWebChatGroupUtils").updateReadOnly(e),o("WAWebChatGroupUtils").updateCanSend(e)}),this.listenTo(u,"change:isParentGroup",function(){e.isParentGroup=u.isParentGroup}),this.isParentGroup=u.isParentGroup,s&&l.update(c)}else if(o("WAWebChatGetters").getIsNewsletter(this)){var d=this.getNewsletterMetadataCollection(),m=d.gadd(this.id);this.addChild("newsletterMetadata",m),o("WAWebChatGroupUtils").updateReadOnly(this),o("WAWebChatGroupUtils").updateCanSend(this),this.listenTo(m,"change:membershipType",function(){o("WAWebChatGroupUtils").updateReadOnly(e),o("WAWebChatGroupUtils").updateCanSend(e)})}else this.listenTo(this.presence,"change:isOnline",function(){return o("WAWebPresenceChatAction").presenceOnlineChanged(e)});this.listenTo(this,"change:isReadOnly",function(){if((o("WAWebChatGetters").getIsGroup(this)||o("WAWebChatGetters").getIsNewsletter(this))&&(this.isTrusted(),o("WAWebChatGroupUtils").updateCanSend(this)),o("WAWebChatGetters").getIsGroup(this)){var e=this.getGroupMetadataCollection();e.update(this.id)}});var p=this.getCollection();if(p.notSpam[this.id]&&!this.notSpam&&r("WAWebSendNotSpamAction")(this).catch(r("WAWebNoop")),p.notSpam[this.id]=!!this.notSpam,this.notSpam||this.listenTo(this,"change:notSpam",this.$ChatImpl$p_10),o("WAWebChatGroupUtils").updateTitle(this),this.isTrusted(),this.groupSafetyChecked=!!((n=this.groupMetadata)!=null&&n.groupSafetyCheck),o("WAWebChatGroupUtils").updateCanSend(this),this.listenTo(this.contact,"change:name",this.isTrusted),this.listenTo(this.msgs,"add",function(t){o("WAWebHandleNewMsgAction").handleNewMsgForChat(e,t)}),this.listenTo(this.msgs,"update_sort_time",function(){return o("WAWebChatUpdates").updateSortTime(e)}),this.listenTo(this.msgs,"bulk_add",function(t,n){return o("WAWebChatMedia").addMediaMsgs(e,t,n)}),this.listenTo(this.msgs,"add",this.$ChatImpl$p_11),this.listenTo(this.msgs,"bulk_add",this.deregisterExpiredViewOnceBulkMessages),this.listenTo(this.msgs,"add remove change:ephemeralExpirationTimestamp change:kicState",this.$ChatImpl$p_12),this.listenTo(this.msgs,"bulk_add",function(t){t.forEach(function(t){e.$ChatImpl$p_12(t)})}),this.listenTo(this.msgs,"change:kicState",function(t){var n=e.keptMsgs;n&&(o("WAWebMsgGetters").getIsKept(t)?n.add(t):n.remove(t))}),this.listenTo(this,"change:msgs",function(){return o("WAWebChatMedia").resetMediaMsgs(e)}),this.saveAssignedColorsDebounced=r("lodash").debounce(function(){return o("WAWebChatParticipantColor").saveAssignedColors(e)},1e3),this.listenTo(this,"change:active",this.$ChatImpl$p_13),this.pendingAction=0,this.listenTo(this,"change:t change:modifyTag",function(){return o("WAWebChatMessageSearch").clearFtsCache(e)}),this.listenTo(r("WAWebL10N"),"locale_change",function(){o("WAWebChatGroupUtils").updateTitle(e)}),(o("WAWebConnModel").Conn.isSMB||o("WAWebListsGatingUtils").isListsEnabled())&&o("WAWebBizLabelUtils").initializeLabels(this),o("WAWebConnModel").Conn.isSMB&&this.$ChatImpl$p_14(),this.$ChatImpl$p_6(),this.$ChatImpl$p_15(),o("WAWebChatGetters").getIsBot(this)&&o("WAWebBotGating").isAiChatThreadsInfraEnabled()){var _=new(o("WAWebAiThreadCollection")).AiThreadCollection;this.aiThreads=_}this.id.isFbidBot()&&(o("WAWebBotProfileCollection").BotProfileCollection.get(this.id)||o("WAWebBotProfileCollection").BotProfileCollection.find(this.id)),o("WAWebBizAiAgentGating").isAiAgentAutoReplyEnabled()&&this.listenTo(this,"change:capiThreadControl change:forceDismissAiAgentBlockBar change:attempToEnableAi",function(){o("WAWebChatGroupUtils").updateCanSend(e)}),this.listenTo(o("WAWebCmd").Cmd,"reachout_timelock_state_change",function(){return o("WAWebChatGroupUtils").updateCanSend(e)}),this.listenTo(o("WAWebCmd").Cmd,"new_chat_message_capping_state_change",function(){return o("WAWebChatGroupUtils").updateCanSend(e)}),o("WAWebReachoutTimelockGatingUtils").isReachoutTimelockEnabled()&&this.listenTo(this,"add:tcToken change:tcToken remove:tcToken",function(){return o("WAWebChatGroupUtils").updateCanSend(e)})},i.$ChatImpl$p_14=function(){var e=this;if(o("WAWebBizGatingUtils").chatAssignmentEnabled()){this.set("unopenedByAssignedAgent",o("WAWebChatAssignmentCollection").ChatAssignmentCollection.getChatUnopenedStatus(this.id));var t=o("WAWebChatAssignmentCollection").ChatAssignmentCollection.getAgentCollectionForChatId(this.id);this.set("isAssignedToMe",this.$ChatImpl$p_16()),this.set("assignedAgent",t.at(0)),this.listenTo(t,"add remove change",function(){e.set("unopenedByAssignedAgent",o("WAWebChatAssignmentCollection").ChatAssignmentCollection.getChatUnopenedStatus(e.id)),e.set("isAssignedToMe",e.$ChatImpl$p_16()),e.set("assignedAgent",t.at(0))})}},i.$ChatImpl$p_8=function(t){var e=this;if(this.unreadMentionsOfMe){var n=new Map(this.unreadMentionsOfMe.map(function(e){return[String(e.id),e]}));this.listenTo(this.msgs,"bulk_add",function(a){for(var i of a){var l=i.id.toString(),s=n.get(l);!s||!e.isUnreadMsg(i)||t.unreadMentionMetadata.addUnreadMentions([new(r("WAWebUnreadMentionModel"))(s)],o("WAWebGroupUnreadMessageType").UnreadMessageType.PERSISTANCE_LOAD)}})}this.unreadMentionCount!=null&&(t.unreadMentionMetadata.pendingUnreadMentionCount=this.unreadMentionCount),this.$ChatImpl$p_9()},i.$ChatImpl$p_15=function(){var e=this;this.eventMsgs=new(o("WAWebEventMsgsCollection")).EventMsgsCollection(this),this.listenTo(this.msgs,"bulk_add",function(t,n){var r=t.filter(function(e){return o("WAWebFrontendMsgGetters").getAsEventCreation(e)});r.length&&e.getEventMsgs().add(r,n)}),this.listenTo(this.msgs,"change:msgs",function(){if(e.eventMsgs){var t;e.eventMsgs.delete(),(t=e.eventMsgs)==null||t.initialize()}})},i.$ChatImpl$p_16=function(){var e=o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().getDeviceId();return o("WAWebChatAssignmentCollection").ChatAssignmentCollection.getAgentCollectionForChatId(this.id).getModelsArray().some(function(t){return t.deviceId===e})},i.$ChatImpl$p_9=function(){o("WAWebChatGetters").getIsGroup(this)&&this.groupMetadata&&(this.hasUnreadMention=this.groupMetadata.unreadMentionMetadata.getUnreadMentionCount()>0)},i.set=function(n,r,o){return typeof n=="string"?(n==="muteExpiration"&&this.mute&&this.mute.setMute(r),n==="isAutoMuted"&&this.mute&&this.mute.setAutoMuted(r)):Object.prototype.hasOwnProperty.call(n,"muteExpiration")&&this.mute&&this.mute.setMute(n.muteExpiration,n.isAutoMuted),t.prototype.set.call(this,n,r,o),this},i.equals=function(t){return this.id.equals(t==null?void 0:t.id)},i.addPendingAction=function(t){var e=this,n=function(){e.decPending()};t.then(n,n),this.pendingAction++},i.decPending=function(){this.pendingAction>0?this.pendingAction--:(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["chat:onPendingActionUpdate pendingAction value is invalid"]))),this.pendingAction=0)},i.$ChatImpl$p_5=function(){if(o("WAWebFrontendChatGetters").getHasDraftMessage(this)){var e;this.draftMessageSortTs=(e=this.draftMessage)==null?void 0:e.timestamp}else this.draftMessageSortTs!=null&&(this.draftMessageSortTs=null)},i.$ChatImpl$p_4=function(){try{o("WAWebLidMigrationUtils").shouldHaveAccountLid(this.id)&&this.accountLid==null&&(o("WAWebLidMigrationUtils").logLidMetadata(),o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["created chat model without account_lid. isEmployee: ",", chat id: ",""])),o("WAWebCurrentUser").isEmployee(),this.id.toLogString()).sendLogs("chat-model-without-account-lid").tags("missing-lid"))}catch(e){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["WAWebChatModel: failed to validate lid chat: ",""])),e)}},i.$ChatImpl$p_13=function(){var e=this;if(o("WAWebChatGetters").getIsGroup(this)&&this.active&&(this.squelch=r("WAWebConstantsDeprecated").SQUELCH_RESET_VALUE,this.reactionSquelch=r("WAWebConstantsDeprecated").SQUELCH_RESET_VALUE,this.hasChatBeenOpened=!0),this.presence.chatActive=this.active,!this.active){this.$ChatImpl$p_5(),this.getCollection().sort(),this.deregisterExpiredViewOnceBulkMessages(this.msgs);var t=Array.from(this.$ChatImpl$p_1);o("WAWebDBEphemeralMessage").removeExpiredMessagesFromHistory(t).then(function(){var n=t.map(function(e){return e.id.toString()});n.length>0&&(o("WAWebUpdateLastAddOnPreviewChatAction").deleteModelsForLastAddOnPreview(n),o("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(o("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(e.id.toString(),n)))}),this.$ChatImpl$p_1.forEach(function(t){e.$ChatImpl$p_1.delete(t),t.delete({skipUpdatingSortTime:!0,doNotResetLastReceived:!0})})}},i.$ChatImpl$p_10=function(){var e=this.getCollection();e.notSpam[this.id]=this.notSpam,this.isTrusted(),this.notSpam&&this.stopListening(this,"change:notSpam")},i.senderMsgCount=function(){return this.getAllMsgs().filter(function(e){return!o("WAWebMsgGetters").getIsSentByMe(e)&&!o("WAWebMsgGetters").getIsNotification(e)}).length},i.isCAGAdmin=function(){var e,t=(e=this.groupMetadata)==null?void 0:e.participants.iAmAdmin();return t!=null?t&&o("WAWebFrontendChatGetters").getIsCAG(this):!1},i.hasMaybeSentMsgToChat=function(){return this.getAllMsgs().some(function(e){return o("WAWebMsgGetters").getIsSentByMe(e)})},i.isTrusted=function(){var e=!1;if(o("WAWebChatGetters").getIsGroup(this)){var t;e=this.isReadOnly||this.notSpam||((t=this.groupMetadata)==null?void 0:t.isTrusted())}else o("WAWebChatGetters").getIsBroadcast(this)||o("WAWebChatGetters").getIsNewsletter(this)?e=!0:o("WAWebChatGetters").getIsUser(this)&&(e=this.notSpam||o("WAWebFrontendContactGetters").getIsMyContact(this.contact));return e!==!0&&this.hasMaybeSentMsgToChat()&&(e=!0),o("WAWebChatGetters").getIsGroup(this)&&e!==this.trusted&&o("WAWebGroupSafetyCheckUtils").handleIsTrustedChangeForGroupSafety(this,!!e),this.trusted=!!e},i.isGroupSafetyChecked=function(){var e=!1;if(this.groupMetadata){var t;e=(t=this.groupMetadata)==null?void 0:t.groupSafetyCheck,e!==this.groupSafetyChecked&&o("WAWebGroupSafetyCheckUtils").handleGroupSafetyCheckStateUpdate(this,!!this.trusted,e)}return this.groupSafetyChecked=!!e},i.isSuspendedOrTerminated=function(){if(o("WAWebChatGetters").getIsGroup(this)){var e;return!!((e=this.groupMetadata)!=null&&e.isSuspendedOrTerminated())}else if(o("WAWebChatGetters").getIsNewsletter(this)){var t;return!!((t=this.newsletterMetadata)!=null&&t.isSuspendedOrTerminated)}return!1},i.isSuspended=function(){if(o("WAWebChatGetters").getIsGroup(this)){var e;return!!((e=this.groupMetadata)!=null&&e.suspended)}else if(o("WAWebChatGetters").getIsNewsletter(this)){var t;return!!((t=this.newsletterMetadata)!=null&&t.suspended)}return!1},i.canBlockFromNotification=function(){return o("WAWebABProps").getABPropConfigValue("block_from_notification")&&o("WAWebChatGetters").getIsUser(this)&&!this.isTrusted()},i.canToggleFavorite=function(){var e,t,n,r;return o("WAWebListsGatingUtils").isListsEnabled()||this.isFavorite?!0:(o("WAWebChatGetters").getIsGroup(this)&&((e=this.groupMetadata)==null?void 0:e.groupType)!==o("WAWebGroupType").GroupType.COMMUNITY&&((t=this.groupMetadata)==null?void 0:t.groupType)!==o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&((n=this.groupMetadata)==null?void 0:n.participants.iAmMember())&&!((r=this.groupMetadata)!=null&&r.isSuspendedOrTerminated())||o("WAWebFrontendChatGetters").getKind(this)===o("WAWebChatFlowTypes").ChatKindType.Chat&&o("WAWebFrontendContactGetters").getIsMyContact(this.contact)&&!o("WAWebContactGetters").getId(this.contact).isBot()&&!o("WAWebContactGetters").getIsMe(this.contact))&&this.trusted},i.title=function(){var e;return o("WAWebChatGetters").getIsGroup(this)?(e=this.formattedTitle)!=null?e:s._(/*BTDS*/"Asunto desconocido").toString():this.formattedTitle},i.getTcToken=function(){return this.tcToken==null||this.tcTokenTimestamp==null||o("WAWebTrustedContactsUtils").isTokenExpired(this.tcTokenTimestamp,o("WAWebTrustedContactsUtils").TcTokenMode.Receiver)?null:this.tcToken},i.shouldShowUnreadDivider=function(){return o("WAWebFrontendChatGetters").getShouldShowUnreadDivider(this)},i.delete=function(){t.prototype.delete.call(this),this.getCollection().remove(this.id),this.$ChatImpl$p_3.abort(),this.presence.delete(),o("WAWebCmd").Cmd.closeChat(this),this.groupMetadata&&this.groupMetadata.delete(),this.mediaMsgs&&this.mediaMsgs.delete(),this.linkMsgs&&this.linkMsgs.delete(),this.docMsgs&&this.docMsgs.delete(),this.productMsgs&&this.productMsgs.delete(),this.eventMsgs&&this.eventMsgs.delete();var e=this.starredMsgs;e&&(e.delete(),e.stopListening(),e.reset()),o("WAWebChatGetters").clearChatGetterCacheFor(this),o("WAWebFrontendChatGetters").clearFrontendChatGetterCacheFor(this)},i.isDirty=function(){return this.unreadCount!==0},i.canPin=function(){var e;if(this.archive)return!1;var t=((e=this.promises)==null||(e=e.setArchive)==null?void 0:e.archive)===!0;return!t},i.canArchive=function(){return!o("WAWebChatGetters").getIsBroadcast(this)},i.supportsChatLock=function(){return!0},i.hasUnreadEdit=function(){return this.unreadEditTimestampMs!=null},i.setComposeContents=function(t){var e,n=t.text;if(((e=t.text)==null?void 0:e.trim())===""){var r;n=(r=t.text)==null?void 0:r.trim()}var a={text:n,ctwaContext:t.ctwaContext,ctwaContextLinkData:t.ctwaContextLinkData,timestamp:t.timestamp,omittedUrl:t.omittedURL};o("WAWebUpdateDraftMessageChatAction").updateDraftMessageChat(this.id,a)},i.getComposeContents=function(){if(this.draftMessage){var e={timestamp:this.draftMessage.timestamp,text:this.draftMessage.text},t=this.draftMessage,n=t.ctwaContext,r=t.ctwaContextLinkData,o=t.omittedUrl;return o!=null&&(e.omittedURL=o),n!=null&&(e.ctwaContext=n),r!=null&&(e.ctwaContextLinkData=r),e}},i.setAttachMediaContents=function(t){this.attachMediaContents=t,this.draftAttachMediaContentsSortTs=t?o("WATimeUtils").unixTime():null},i.isComposingWithUnsavedChanges=function(){return this.isComposingPoll},i.isBusinessGroup=function(){var e,t=(e=this.groupMetadata)==null?void 0:e.participants.getAdmins();if(!t)return!1;for(var n of t){var r=o("WAWebContactCollection").ContactCollection.get(n.id);if(r!=null&&r.isBusiness)return!0}return!1},i.isCAG=function(){return o("WAWebFrontendChatGetters").getIsCAG(this)},i.preload=function(){this.msgs.length===1&&o("WAWebChatLoadMessages").loadEarlierMsgs(this).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").E404,r("WAWebNoop"))).catch(function(e){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["chat:preload failed\n",""],["chat:preload failed\\n",""])),e)})},i.onEmptyMRM=function(){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["models:Chat:removeMsg 0 messages left, querying..."]))),o("WAWebChatLoadMessages").loadEarlierMsgs(this).catch(o("WAFilteredCatch").filteredCatch(o("WAWebBackendErrors").E404,r("WAWebNoop"))).catch(function(e){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["chat:onEmptyMRM failed\n",""],["chat:onEmptyMRM failed\\n",""])),e)})},i.deleteMsgs=function(t,n){this.deleteMsgsBeforeMsgInclusive(void 0,!t,n)},i.deleteMsgsBeforeMsgInclusive=function(t,n,a){n===void 0&&(n=!1);var e;if(!t)e=this.msgs.length;else if(this.msgs.get(t.id))e=this.msgs.indexOf(t);else return;var i=function(i,l,s){return!r("isStringNullOrEmpty")(a)&&!o("WAWebMsgModelUtils").msgMatchesType(i,a)||i.msgChunk===this.msgs&&l>e||n&&i.star||o("WAWebMsgGetters").getIsInitialE2ENotification(i)&&n};this.deleteMsgsPartial(i,!0)},i.deleteMsgsPartial=function(t,n){var e=this;n===void 0&&(n=!1);var a=this.unreadCount;if(this.getAllCMCs().forEach(function(r){var a=r.filter(function(n,r,o){return!t.apply(e,[n,r,o])});r.remove(a,void 0,n),a.forEach(function(e){o("WAWebMsgGetters").getIsAuthenticationMessage(e)&&o("WAWebOTPLoggingHelper").logOTPMessageDeleted(o("WAWebMsgDataFromModel").msgDataFromMsgModel(e)),e.delete()})}),r("lodash").clone(this.msgChunks).forEach(function(t){t.length===0&&e.removeMsgsCollection(t)}),this.msgs.length>0){var i=a>this.msgs.length?this.msgs.length:a;o("WAWebDBUpdateChatTable").updateChatTable(this.id,{unreadCount:i}).then(function(){e.unreadCount=i,e.msgs.msgLoadState.noEarlierMsgs=e.endOfHistoryTransferType!==o("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.INCOMPLETE})}},i.deleteMessages=function(t){var e=function(n,r,o){return!t.includes(n.id.toString())};this.deleteMsgsPartial(e,!0),this.getAllMsgs().length===0&&o("WAWebChatLoadMessages").loadEarlierMsgs(this),o("WAWebLimitSharingModelUtils").createLimitSharingMsgOnChatClear(this.id)},i.getLastMsgKeyForAction=function(){var e=this.msgs.last(),t;return e&&(!this.lastReceivedKey||e.id.fromMe&&e.local&&e.ack===o("WAWebAck").ACK.CLOCK?t=e.id:t=this.lastReceivedKey),t||void 0},i.getWebcChatType=function(){var e=o("WAWebFrontendChatGetters").getKind(this);if(e!=null)switch(e){case o("WAWebChatFlowTypes").ChatKindType.Chat:return o("WAWebWamEnumWebcChatType").WEBC_CHAT_TYPE.INDIVIDUAL;case o("WAWebChatFlowTypes").ChatKindType.Group:return o("WAWebWamEnumWebcChatType").WEBC_CHAT_TYPE.GROUP;case o("WAWebChatFlowTypes").ChatKindType.Broadcast:return o("WAWebWamEnumWebcChatType").WEBC_CHAT_TYPE.BROADCAST_LIST;case o("WAWebChatFlowTypes").ChatKindType.Newsletter:return o("WAWebWamEnumWebcChatType").WEBC_CHAT_TYPE.NEWSLETTER;case o("WAWebChatFlowTypes").ChatKindType.Community:return o("WAWebWamEnumWebcChatType").WEBC_CHAT_TYPE.COMMUNITY}else throw new TypeError("Invalid Chat.kind "+String(e))},i.getMdChatAssignmentChatType=function(){return o("WAWebChatModelDerivedMethods").getMdChatAssignmentChatTypeFn(this)},i.getChatAssignmentChatType=function(){var e=o("WAWebFrontendChatGetters").getKind(this);if(e!=null)switch(e){case o("WAWebChatFlowTypes").ChatKindType.Chat:return o("WAWebWamEnumChatAssignmentChatType").CHAT_ASSIGNMENT_CHAT_TYPE.INDIVIDUAL;case o("WAWebChatFlowTypes").ChatKindType.Group:return o("WAWebWamEnumChatAssignmentChatType").CHAT_ASSIGNMENT_CHAT_TYPE.GROUP;case o("WAWebChatFlowTypes").ChatKindType.Broadcast:case o("WAWebChatFlowTypes").ChatKindType.Community:return o("WAWebWamEnumChatAssignmentChatType").CHAT_ASSIGNMENT_CHAT_TYPE.COMMUNITY;case o("WAWebChatFlowTypes").ChatKindType.Newsletter:return o("WAWebWamEnumChatAssignmentChatType").CHAT_ASSIGNMENT_CHAT_TYPE.CHANNEL}else throw new TypeError("Invalid Chat.kind "+String(e))},i.deregisterExpiredViewOnceBulkMessages=function(t){t.forEach(this.$ChatImpl$p_11)},i.$ChatImpl$p_11=function(t){o("WAWebViewOnceState").isExpired(t.safe())&&(o("WAWebAppTracker").AppTracker.mark(o("WAWebAppTracker").AppTrackerType.PurgeViewOnce),o("WAWebMedia").deregisterMsg(t))},i.$ChatImpl$p_12=function(t){var e=this;r("WAWebAlarm").clearTimeout(this.$ChatImpl$p_2.get(t)),this.$ChatImpl$p_2.delete(t),this.$ChatImpl$p_1.delete(t);var a=o("WAWebMsgGetters").getEphemeralExpirationTimestamp(t);if(!(a==null||!this.msgs.includes(t)||o("WAWebMsgGetters").getIsKept(t))){var i=(function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){e.$ChatImpl$p_2.delete(t),e.active?e.$ChatImpl$p_1.add(t):(yield o("WAWebDBEphemeralMessage").removeExpiredMessagesFromHistory([t]),o("WAWebUpdateLastAddOnPreviewChatAction").deleteModelsForLastAddOnPreview([t.id.toString()]),yield o("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(o("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(e.id.toString(),[t.id.toString()])),t.delete({skipUpdatingSortTime:!0,doNotResetLastReceived:!0}))});return function(){return r.apply(this,arguments)}})();if(t.isExpired())i();else{var l=r("WAWebAlarm").setGlobalTimeout(function(){return void i()},a*1e3);this.$ChatImpl$p_2.set(t,l)}}},i.isUnreadMsg=function(t){var e=this.msgs.filter(function(e){return o("WAWebMsgGetters").getIsUnreadType(e)});return e.includes(t,e.length-this.unreadCount)},i.isActiveUnreadMsg=function(t){var e=this.msgs.filter(function(e){return o("WAWebMsgGetters").getIsUnreadType(e)});return e.includes(t,e.length-this.activeUnreadCount)},i.setCelebrationAnimationLastPlayed=function(){this.animationCandidateData&&this.celebrationAnimationLastPlayed<this.animationCandidateData.msgTimestampSeconds&&(this.celebrationAnimationLastPlayed=this.animationCandidateData.msgTimestampSeconds)},i.setChatWallpaper=function(t){return this.wallpaper=t,o("WAWebDBUpdateChatTable").updateChatTable(this.id,{wallpaper:t})},i.setShowDoodle=function(t){return this.showDoodle=t,o("WAWebDBUpdateChatTable").updateChatTable(this.id,{showDoodle:t})},i.setCapiThreadControl=function(t){return this.capiThreadControl=t,this.forceDismissAiAgentBlockBar=!1,t===o("WAWebProtobufsE2E.pb").Message$CloudAPIThreadControlNotification$CloudAPIThreadControl.CONTROL_PASSED&&(this.unreadCount=1,o("WAWebNotificationBackend").showAiHandoffNotification(this).catch(o("WAAbortError").catchAbort(function(e){o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[Maiba] Aborted notification ",""])),e)}))),o("WAWebDBUpdateChatTable").updateChatTable(this.id,{capiThreadControl:t,unreadCount:this.unreadCount})},i.setForceDismissAiAgentBlockingBar=function(t){this.forceDismissAiAgentBlockBar=t},i.setAttempToEnableAi=function(t){this.attempToEnableAi=t},i.getAttempToEnableAi=function(){return this.attempToEnableAi},i.setAnimationCandidateData=function(t){this.animationCandidateData=t},i.$ChatImpl$p_7=function(){var e=this,t=this.groupMetadata;if(o("WAWebChatGetters").getIsGroup(this)&&t!=null&&!t.stale){var n=!t.participants.iAmAdmin()&&t.announce;this.isAnnounceGrpRestrict!==n&&(o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["chat:_updateIsAnnounceGrpRestrict:old ",", new: ",""])),this.isAnnounceGrpRestrict,n),o("WAWebDBUpdateChatTable").updateChatTable(this.id,{isAnnounceGrpRestrict:n}).then(function(){return e.isAnnounceGrpRestrict=n}))}},i.sortMsgs=function(t){var e=t.map(function(e){var t=r("WANullthrows")(e.msgChunk);return{msg:e,chunkT:r("WANullthrows")(t.at(0)).t,index:t.indexOf(e)}});return e.sort(function(e,t){return e.chunkT===t.chunkT?e.index-t.index:e.chunkT-t.chunkT}).map(function(e){return e.msg})},i.waitForChatLoading=function(){var e=this,t=(g||(g=n("Promise"))).resolve();return this.pendingInitialLoading&&(t=r("WAWebEventsWaitForBbEvent")(this,"change:pendingInitialLoading",function(){return!e.pendingInitialLoading})),t},i.unstarAll=function(){var e=this.getAllMsgs();e.forEach(function(e){e&&(e.star=!1)}),o("WAWebStarredMsgCollection").removeStarredMsgs(e)},i.$ChatImpl$p_6=function(){var e,t=!!this.muteExpiration;if(this.archive){this.showUnreadInTitle=!1;return}if(this.isLocked){this.showUnreadInTitle=!1;return}if(this.id.isBot()&&!o("WAWebBotGating").isBotEnabled()){this.showUnreadInTitle=!1;return}if(o("WAWebFrontendChatGetters").getOptimisticUnreadCount(this)<=0){this.showUnreadInTitle=!1;return}if(!o("WAWebChatGetters").getIsGroup(this)){this.showUnreadInTitle=!t;return}if(((e=this.groupMetadata)==null?void 0:e.groupType)===o("WAWebGroupType").GroupType.COMMUNITY){this.showUnreadInTitle=!1;return}if(!t){this.showUnreadInTitle=!0;return}if(!this.msgs||this.msgs.length===0){this.showUnreadInTitle=!1;return}for(var n=!1,r=this.msgs,a=o("WAWebFrontendChatGetters").getOptimisticUnreadCount(this),i=Math.max(0,r.length-a);i<r.length;i++){var l=this.msgs.at(i);if(l&&o("WAWebNotificationHelpers").isMeUserMentionedOrQuoted(l)){var s=this.getCollection().get(o("WAWebMsgGetters").getSender(l));if(!s||!s.muteExpiration){n=!0;break}}}this.showUnreadInTitle=n},i.removeFromCollection=function(t){if(t.star&&o("WAWebStarredMsgCollection").removeStarredMsgs([t]),o("WAWebMsgGetters").getIsMedia(t)&&this.mediaMsgs?this.mediaMsgs.remove(t):o("WAWebMsgLinks").getLinksFromMsg(t).length>0&&this.linkMsgs?this.linkMsgs.remove(t):o("WAWebFrontendMsgGetters").getAsDoc(t)&&this.docMsgs?this.docMsgs.remove(t):o("WAWebFrontendMsgGetters").getAsProduct(t)!=null&&this.productMsgs?this.productMsgs.remove(t):o("WAWebFrontendMsgGetters").getAsEventCreation(t)!=null&&this.eventMsgs&&this.eventMsgs.remove(t),o("WAWebMsgGetters").getIsKept(t)&&this.keptMsgs&&this.keptMsgs.remove(t),o("WAWebChatGetters").getIsGroup(o("WAWebFrontendMsgGetters").getChat(t))){var e;(e=o("WAWebFrontendMsgGetters").getChat(t).groupMetadata)==null||e.unreadMentionMetadata.removeUnreadMentions(t.id.toString())}},i.getMediaMsgs=function(){return this.mediaMsgs||(this.mediaMsgs=new(r("WAWebChatMediaMsgsCollection"))),this.mediaMsgs},i.getLinkMsgs=function(){return this.linkMsgs||(this.linkMsgs=new(r("WAWebChatLinkMsgsCollection"))),this.linkMsgs},i.getDocMsgs=function(){return this.docMsgs||(this.docMsgs=new(r("WAWebChatDocMsgsCollection"))),this.docMsgs},i.getEventMsgs=function(){return this.eventMsgs||(this.eventMsgs=new(o("WAWebEventMsgsCollection")).EventMsgsCollection(this)),this.eventMsgs},i.getParticipantCount=function(){var e;return((e=this.groupMetadata)==null?void 0:e.participants.length)||1},i.iAmAdmin=function(){return this.groupMetadata?this.groupMetadata.participants.iAmAdmin():!1},i.getProductMsgs=function(){return this.productMsgs||(this.productMsgs=new(r("WAWebChatProductMsgsCollection"))),this.productMsgs},i.getStarredMsgs=function(){var e=this,t=this.starredMsgs;return t||(this.starredMsgs=t=new(o("WAWebStarredMsgCollection")).StarredMsgCollection,this.starredMsgs.add(o("WAWebStarredMsgCollection").AllStarredMsgsCollection.filter(function(t){return o("WAWebFrontendMsgGetters").getChat(t)===e}))),t},i.getKeptMsgs=function(){var e=this.keptMsgs;return e||(this.keptMsgs=e=new(o("WAWebKeptMsgCollection")).KeptMsgCollection,this.keptMsgs.add(this.msgs.filter(function(e){return o("WAWebMsgGetters").getIsKept(e)}))),e},i.hasKeptMsgs=function(){return this.msgs.some(function(e){return o("WAWebMsgGetters").getIsKept(e)})},i.canSendPolls=function(){return o("WAWebChatModelDerivedMethods").canSendPolls(this)},i.canInvokeBot=function(){var e,t;return!(!o("WAWebBotGating").isBotEnabled()||o("WAWebChatGetters").getIsNewsletter(this)||o("WAWebContactGetters").getIsMe(this.contact)||o("WAWebFrontendChatGetters").getIsCapiHostedGroup(this)||this.id.isBot()||o("WAWebChatEphemerality").isEphemeralSettingOn(this)||((e=this.contact.businessProfile)==null?void 0:e.isBizBot3p)===!0||((t=this.contact.businessProfile)==null?void 0:t.isBizBot1p)===!0||o("WAWebTosGating").shouldBlockBotInvokeAsTosNotAvailable()||!o("WAWebMobilePlatforms").isSMB()&&this.contact.isBusiness)},i.getAbortController=function(){return this.$ChatImpl$p_3},i.getDeleteSignal=function(){return this.getAbortController().signal},i.getCollection=function(){return o("WAWebChatGetters").getIsNewsletter(this)?r("WAWebNewsletterCollection"):o("WAWebChatCollection").ChatCollection},i.getGroupMetadataCollection=function(){return r("WAWebGroupMetadataCollection")},i.getNewsletterMetadataCollection=function(){return r("WAWebNewsletterMetadataCollection")},i.updateBotInvokeSystemMsgCreated=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield o("WAWebDBUpdateChatTable").updateChatTable(this.id,{hasCreatedBotInvokeSystemMsg:!0}),this.hasCreatedBotInvokeSystemMsg=!0});function t(){return e.apply(this,arguments)}return t})(),i.updateBizBotSysMsgCreated=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield o("WAWebDBUpdateChatTable").updateChatTable(this.id,{bizBotSystemMsgType:e}),this.bizBotSystemMsgType=e});function t(t){return e.apply(this,arguments)}return t})(),i.supportsKIC=function(){return!(o("WAWebFrontendChatGetters").getIsCAG(this)&&!o("WAWebEphemeralKeepInChatAbpropUtils").isKeepInChatInCAGEnabled())},a})(r("WAWebSuperChatMsgs"));h.Proxy="chat",h.idClass=r("WAWebWid");var y=o("WAWebBaseModel").defineModel(h);l.Chat=y}),226);
__d("WAWebChatModelDerivedMethods",["WAWebABProps","WAWebChatFlowTypes","WAWebChatGetters","WAWebChatGroupUtils","WAWebFrontendChatGetters","WAWebMsgType","WAWebNewsletterGatingUtils","WAWebPollsGatingUtils","WAWebViewMode.flow","WAWebViewModeUtils","WAWebWamEnumMdChatAssignmentChatType"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WAWebFrontendChatGetters").getKind(e);if(t!=null)switch(t){case o("WAWebChatFlowTypes").ChatKindType.Chat:return o("WAWebWamEnumMdChatAssignmentChatType").MD_CHAT_ASSIGNMENT_CHAT_TYPE.INDIVIDUAL;case o("WAWebChatFlowTypes").ChatKindType.Group:return o("WAWebWamEnumMdChatAssignmentChatType").MD_CHAT_ASSIGNMENT_CHAT_TYPE.GROUP;case o("WAWebChatFlowTypes").ChatKindType.Broadcast:return o("WAWebWamEnumMdChatAssignmentChatType").MD_CHAT_ASSIGNMENT_CHAT_TYPE.BROADCAST_LIST;case o("WAWebChatFlowTypes").ChatKindType.Newsletter:return o("WAWebWamEnumMdChatAssignmentChatType").MD_CHAT_ASSIGNMENT_CHAT_TYPE.CHANNEL;case o("WAWebChatFlowTypes").ChatKindType.Community:return o("WAWebWamEnumMdChatAssignmentChatType").MD_CHAT_ASSIGNMENT_CHAT_TYPE.COMMUNITY}else throw new TypeError("Invalid Chat.kind "+String(t))}function s(e){return e.type!==o("WAWebMsgType").MSG_TYPE.E2E_NOTIFICATION&&(e.type!==o("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE||e.subtype==="chat_assignment"||e.subtype==="chat_assignment_unassign"||e.subtype==="limit_sharing_system_message"||e.subtype==="change_username")&&e.type!==o("WAWebMsgType").MSG_TYPE.REACTION&&e.type!==o("WAWebMsgType").MSG_TYPE.POLL_UPDATE&&e.type!==o("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT&&e.subtype!=="newsletter_admin_context_card"&&e.subtype!=="newsletter_privacy"&&!e.pendingDeleteForMe&&e.botPluginReferenceIndex==null&&o("WAWebViewModeUtils").isViewModeVisibleInSurface(o("WAWebViewMode.flow").ViewModeSurface.CHAT_LIST,e.viewMode)}function u(e){if(o("WAWebChatGetters").getIsNewsletter(e))return o("WAWebNewsletterGatingUtils").isNewsletterPollsCreationEnabled();if(o("WAWebChatGetters").getIsBroadcast(e))return!1;var t=e.groupMetadata;return t==null?!0:o("WAWebFrontendChatGetters").getIsCAG(e)?o("WAWebChatGroupUtils").getGroupParticipantsCount(t)<=o("WAWebABProps").getABPropConfigValue("pnh_cag_disable_polls_group_size")&&o("WAWebPollsGatingUtils").isPollsCreationEnabledInCags():!0}l.getMdChatAssignmentChatTypeFn=e,l.isPreviewMessage=s,l.canSendPolls=u}),98);
__d("WAWebChatMsgsCollectionComparator",[],(function(t,n,r,o,a,i){function e(e,t){return e.serverId==null||t.serverId==null?0:e.serverId-t.serverId}i.msgComparator=e}),66);
__d("WAWebChatMsgsCollection",["invariant","WAWebBaseCollection","WAWebBaseModel","WAWebBizSystemMsgSubtypes","WAWebChatMsgsCollectionComparator","WAWebCommonCTWALogging","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgModel","WAWebViewModeUtils"],(function(t,n,r,o,a,i,l,s){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.noEarlierMsgs=o("WAWebBaseModel").prop(),t.isLoadingEarlierMsgs=o("WAWebBaseModel").prop(),t.isLoadingRecentMsgs=o("WAWebBaseModel").prop(),t.isLoadingAroundMsgs=o("WAWebBaseModel").prop(),t.isRepairingMsgHistory=o("WAWebBaseModel").prop(),t.contextLoaded=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="msgLoad";var u=o("WAWebBaseModel").defineModel(e),c=(function(e){function t(){var t;return t=e.call(this)||this,t.triggerChangeLast=function(e,n,r){var o=t.last();if(t.$ChatMsgsCollection$p_1!==o){t.$ChatMsgsCollection$p_1=o;var a=!1,i=!!r.add,l=!!r.remove;e!=null&&n.includes(e)&&i&&!l&&(a=!0),t.trigger("change:last",o,a)}},t.msgLoadState=new u({noEarlierMsgs:!1,isLoadingEarlierMsgs:!1,isLoadingRecentMsgs:!1,isLoadingAroundMsgs:!1,contextLoaded:!1,isRepairingMsgHistory:!1}),t.listenTo(t,"add remove",t.triggerChangeLast),t.listenTo(t,"sort reset",function(e,n){t.triggerChangeLast(null,e,n!=null?n:{})}),t}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.delete=function(){this.stopListening(),e.prototype.delete.call(this),this.msgLoadState.delete()},n.last=function(){return e.prototype.getModelsArray.call(this).findLast(function(e){return o("WAWebViewModeUtils").isMessageExistingInChat(e)})},n.add=function(n,r){var t=this,a;Array.isArray(n)?n.length===1&&(a=n[0]):a=n;var i=[];if(a!=null&&(o("WAWebMsgGetters").getIsInitialE2ENotification(a)||o("WAWebMsgGetters").getIsDisappearingModeSystemMessage(a))){var l=this.some(function(e){return o("WAWebMsgGetters").getIsInitialE2ENotification(e)});if(o("WAWebMsgGetters").getIsInitialE2ENotification(a)&&(l||(i=e.prototype.add.call(this,n,babelHelpers.extends({},r,{at:0})))),o("WAWebMsgGetters").getIsDisappearingModeSystemMessage(a)){var s=this.some(function(e){return o("WAWebMsgGetters").getIsDisappearingModeSystemMessage(e)});if(!s){var u=l?1:0;i=e.prototype.add.call(this,n,babelHelpers.extends({},r,{at:u}))}}i&&this.trigger("insert_msgs",i,r)}else{var c,d=a!=null?o("WAWebMsgGetters").getSubtype(a):null,m=d!=null&&o("WAWebBizSystemMsgSubtypes").COEX_MSG_SUBTYPES.includes(d)&&((c=this.last())==null?void 0:c.subtype)===d;m||(i=e.prototype.add.call(this,n,r))}if(i.length>0){var p=o("WAWebMsgCollection").MsgCollection.add(i.filter(Boolean),r);p.forEach(function(e){e&&t.isModel(e)&&(e.msgChunk=t)}),this.trigger("bulk_add",i,r),p.forEach(function(e){return o("WAWebCommonCTWALogging").logDeepConversation(e)})}return i},n.remove=function(n,r,o){r===void 0&&(r={}),o===void 0&&(o=!1);var t=e.prototype.remove.call(this,n,r),a=r?r.silent:!1,i=t.filter(function(e){return!!e});return i.length&&a!==!0&&(this.trigger("remove_msgs",i,r),o||this.trigger("update_sort_time")),t},n.replace=function(t){var e=this;this.msgLoadState=t.msgLoadState,this.loadRecentPromise=t.loadRecentPromise,this.loadEarlierPromise=t.loadEarlierPromise,this.loadAroundPromise=t.loadAroundPromise;var n=t.getModelsArray();this.set(n,{silent:!0,merge:!1}),n.forEach(function(t){e.isModel(t)&&(t.msgChunk=e)}),this.trigger("bulk_add",n)},n.onMsgLoadStateChange=function(t){var e=this,n,r=function(){t()},o=function(){n!=null||s(0,56282),n.off("change",r);var o=e.msgLoadState;o.on("change",r),n=o,t()};n=this.msgLoadState,n.on("change",r),this.on("bulk_add",o);var a=function(){n!=null||s(0,56281),e.off("bulk_add",o),n.off("change",r)};return function(){var e=a;e&&(a=null,e())}},t})(o("WAWebBaseCollection").BaseCollection);c.model=o("WAWebMsgModel").Msg,c.comparator=o("WAWebChatMsgsCollectionComparator").msgComparator,l.ChatMsgsCollection=c}),98);
__d("WAWebWallpaper",["fbt"],(function(t,n,r,o,a,i,l,s){var e="default_chat_wallpaper",u="0.06",c="0.1",d="data-asset-chat-background-beige",m={"#BBE4E5":{doodle:"dark",opacity:"0.42",getColorName:function(){return s._(/*BTDS*/"Cruise")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Cruise, color hexadecimal: #BBE4E5, tono: verde")}},"#AED8C7":{doodle:"dark",opacity:"0.3",getColorName:function(){return s._(/*BTDS*/"Scandal")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Scandal, color hexadecimal: #AED8C7, tono: verde")}},"#7ACBA5":{doodle:"dark",opacity:"0.26",getColorName:function(){return s._(/*BTDS*/"Monte carlo")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Monte Carlo, color hexadecimal: #7ACBA5, tono: verde")}},"#CBDAEC":{doodle:"dark",opacity:"0.42",getColorName:function(){return s._(/*BTDS*/"Hawkes blue")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Hawkes Blue, color hexadecimal: #CBDAEC, tono: azul")}},"#66D2D5":{doodle:"dark",opacity:"0.26",getColorName:function(){return s._(/*BTDS*/"Downy")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Downy, color hexadecimal: #66D2D5, tono: verde")}},"#63BDCF":{doodle:"dark",opacity:"0.26",getColorName:function(){return s._(/*BTDS*/"Seagull")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Seagull, color hexadecimal: #63BDCF, tono: azul")}},"#D6D0F0":{doodle:"dark",opacity:"0.36",getColorName:function(){return s._(/*BTDS*/"Quartz")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Quartz, color hexadecimal: #D6D0F0, tono: blanco")}},"#CECECE":{doodle:"dark",opacity:"0.36",getColorName:function(){return s._(/*BTDS*/"Gris muy claro")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Very Light Grey, color hexadecimal: #CECECE, tono: gris")}},"#D1DABE":{doodle:"dark",opacity:"0.36",getColorName:function(){return s._(/*BTDS*/"Orinoco")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Orinoco, color hexadecimal: #D1DABE, tono: verde")}},"#E6E1B1":{doodle:"dark",opacity:"0.42",getColorName:function(){return s._(/*BTDS*/"Tusk")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Tusk, color hexadecimal: #E6E1B1, tono: verde")}},"#FEEFA9":{doodle:"light",opacity:"0.06",getColorName:function(){return s._(/*BTDS*/"Cape honey")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Cape Honey, color hexadecimal: #FEEFA9, tono: amarillo")}},"#FED297":{doodle:"dark",opacity:"0.42",getColorName:function(){return s._(/*BTDS*/"Caramel")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Caramel, color hexadecimal: #FED297, tono: amarillo")}},"#FD9A9B":{doodle:"dark",opacity:"0.26",getColorName:function(){return s._(/*BTDS*/"Rose bud")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Rose Bud, color hexadecimal: #FD9A9B, tono: rojo")}},"#FD6769":{doodle:"dark",opacity:"0.26",getColorName:function(){return s._(/*BTDS*/"Bittersweet")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Bittersweet, color hexadecimal: #FD6769, tono: naranja")}},"#FB4668":{doodle:"dark",opacity:"0.26",getColorName:function(){return s._(/*BTDS*/"Radical red")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Radical Red, color hexadecimal: #FB4668, tono: rojo")}},"#922040":{doodle:"dark",opacity:"0.17",invertTransparentWallpaperColors:!0,getColorName:function(){return s._(/*BTDS*/"Mandarian orange")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Mandarian Orange, color hexadecimal: #922040, tono: naranja")}},"#DC6E4F":{doodle:"dark",opacity:"0.2",getColorName:function(){return s._(/*BTDS*/"Flamingo")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Flamingo, color hexadecimal: #DC6E4F, tono: naranja")}},"#644D52":{doodle:"dark",opacity:"0.13",invertTransparentWallpaperColors:!0,getColorName:function(){return s._(/*BTDS*/"Buccaneer")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Buccaneer, color hexadecimal: #644D52, tono: rojo")}},"#517E7E":{doodle:"dark",opacity:"0.13",getColorName:function(){return s._(/*BTDS*/"Breaker bay")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Breaker Bay, color hexadecimal: #517E7E, tono: verde")}},"#3190BB":{doodle:"dark",opacity:"0.13",getColorName:function(){return s._(/*BTDS*/"Pelorous")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Pelorous, color hexadecimal: #3190BB, tono: azul")}},"#35558A":{doodle:"dark",opacity:"0.1",invertTransparentWallpaperColors:!0,getColorName:function(){return s._(/*BTDS*/"Tory blue")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Tory Blue, color hexadecimal: #35558A, tono: azul")}},"#55626F":{doodle:"dark",opacity:"0.1",invertTransparentWallpaperColors:!0,getColorName:function(){return s._(/*BTDS*/"Fiord")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Fiord, color hexadecimal: #55626F, tono: azul")}},"#1D2326":{doodle:"dark",opacity:"0.1",invertTransparentWallpaperColors:!0,getColorName:function(){return s._(/*BTDS*/"Cinder")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Cinder, color hexadecimal: #1D2326, tono: gris")}},"#301E34":{doodle:"dark",opacity:"0.1",invertTransparentWallpaperColors:!0,getColorName:function(){return s._(/*BTDS*/"Tolopea")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Tolopea, color hexadecimal: #301E34, tono: violeta")}},"#ECF0F1":{doodle:"light",opacity:"0.06",getColorName:function(){return s._(/*BTDS*/"Solitude")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Solitude, color hexadecimal: #ECF0F1, tono: azul")}},"#FFFEA2":{doodle:"light",opacity:"0.06",getColorName:function(){return s._(/*BTDS*/"Canary")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Canary, color hexadecimal: #FFFEA2, tono: amarillo")}},"#E7E8D2":{doodle:"light",opacity:"0.06",getColorName:function(){return s._(/*BTDS*/"Willow Brook")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Willow Brook, color hexadecimal: #E7E8D2, tono: verde")}}},p={"#0F2424":{doodle:"dark",opacity:"0.05",getColorName:function(){return s._(/*BTDS*/"Nordic")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Nordic, color hexadecimal: #0F2424, tono: azul")}},"#12261F":{doodle:"dark",opacity:"0.055",getColorName:function(){return s._(/*BTDS*/"Cardin green")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Cardin Green, color hexadecimal: #12261F, tono: verde")}},"#11241C":{doodle:"dark",opacity:"0.055",getColorName:function(){return s._(/*BTDS*/"Cardin green")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Cardin Green, color hexadecimal: #11241C, tono: verde")}},"#111E27":{doodle:"dark",opacity:"0.06",getColorName:function(){return s._(/*BTDS*/"Tangaroa")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Tangaroa, color hexadecimal: #111E27, tono: azul")}},"#0F2224":{doodle:"dark",opacity:"0.06",getColorName:function(){return s._(/*BTDS*/"Nordic")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Nordic, color hexadecimal: #0F2224, tono: azul")}},"#0E2125":{doodle:"dark",opacity:"0.055",getColorName:function(){return s._(/*BTDS*/"Tiber")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Tiber, color hexadecimal: #0E2125, tono: verde")}},"#1F1D25":{doodle:"dark",opacity:"0.06",getColorName:function(){return s._(/*BTDS*/"Black russian")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Black Russian, color hexadecimal: #1F1D25, tono: gris")}},"#212121":{doodle:"dark",opacity:"0.055",getColorName:function(){return s._(/*BTDS*/"Nero")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Nero, color hexadecimal: #212121, tono: gris")}},"#1F211C":{doodle:"dark",opacity:"0.055",getColorName:function(){return s._(/*BTDS*/"Marshland")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Marshland, color hexadecimal: #1F211C, tono: verde")}},"#23231B":{doodle:"dark",opacity:"0.055",getColorName:function(){return s._(/*BTDS*/"Maire")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Maire, color hexadecimal: #23231B, tono: amarillo")}},"#262419":{doodle:"dark",opacity:"0.055",getColorName:function(){return s._(/*BTDS*/"Black magic")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Black Magic, color hexadecimal: #262419, tono: marr\u00f3n")}},"#261F17":{doodle:"dark",opacity:"0.055",getColorName:function(){return s._(/*BTDS*/"Cocoa brown")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Cocoa Brown, color hexadecimal: #261F17, tono: marr\u00f3n")}},"#261717":{doodle:"dark",opacity:"0.055",getColorName:function(){return s._(/*BTDS*/"Wood Bark")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Wood Bark, color hexadecimal: #261717, tono: marr\u00f3n")}},"#260F10":{doodle:"dark",opacity:"0.06",getColorName:function(){return s._(/*BTDS*/"Seal brown")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Seal Brown, color hexadecimal: #260F10, tono: marr\u00f3n")}},"#260A10":{doodle:"dark",opacity:"0.07",getColorName:function(){return s._(/*BTDS*/"Seal brown")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Seal Brown, color hexadecimal: #260A10, tono: marr\u00f3n")}},"#19050B":{doodle:"dark",opacity:"0.075",getColorName:function(){return s._(/*BTDS*/"Seal brown")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Seal Brown, color hexadecimal: #19050B, tono: marr\u00f3n")}},"#21100C":{doodle:"dark",opacity:"0.07",getColorName:function(){return s._(/*BTDS*/"Seal brown")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Seal Brown, color hexadecimal: #21100C, tono: marr\u00f3n")}},"#0F0C0C":{doodle:"dark",opacity:"0.065",getColorName:function(){return s._(/*BTDS*/"Black")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Black, color hexadecimal: #0F0C0C, tono: negro")}},"#101919":{doodle:"dark",opacity:"0.06",getColorName:function(){return s._(/*BTDS*/"Black pearl")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Black Pearl, color hexadecimal: #101919, tono: azul")}},"#0A1D25":{doodle:"dark",opacity:"0.055",getColorName:function(){return s._(/*BTDS*/"Cyprus")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Cyprus, color hexadecimal: #0A1D25, tono: verde")}},"#0D1523":{doodle:"dark",opacity:"0.065",getColorName:function(){return s._(/*BTDS*/"Blue whale")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Blue Whale, color hexadecimal: #0D1523, tono: azul")}},"#0D0F11":{doodle:"dark",opacity:"0.07",getColorName:function(){return s._(/*BTDS*/"Black pearl")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Black Pearl, color hexadecimal: #0D0F11, tono: azul")}},"#0A0C0D":{doodle:"dark",opacity:"0.07",getColorName:function(){return s._(/*BTDS*/"Black pearl")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Black Pearl, color hexadecimal: #0A0C0D, tono: azul")}},"#110B12":{doodle:"dark",opacity:"0.07",getColorName:function(){return s._(/*BTDS*/"Tolopea")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Tolopea, color hexadecimal: #110B12, tono: violeta")}},"#1E1F1F":{doodle:"dark",opacity:"0.055",getColorName:function(){return s._(/*BTDS*/"Woodsmoke")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Woodsmoke, color hexadecimal: #1E1F1F, tono: gris")}},"#262618":{doodle:"dark",opacity:"0.055",getColorName:function(){return s._(/*BTDS*/"Black magic")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Black Magic, color hexadecimal: #262618, tono: marr\u00f3n")}},"#23231F":{doodle:"dark",opacity:"0.055",getColorName:function(){return s._(/*BTDS*/"Maire")},getAriaLabel:function(){return s._(/*BTDS*/"Color: Maire, color hexadecimal: #23231F, tono: amarillo")}}},_=Object.keys(m),f=Object.keys(p);function g(e){return e==="light"?_:f}function h(t,n){var r=g(n);if(t===e)return e;var o=r.findIndex(function(e){return e.toUpperCase()===t.toUpperCase()});return o!==-1?n==="light"?f[o]:_[o]:t}function y(t,n){var r=g(n);return t===e?!0:r.some(function(e){return e.toUpperCase()===t.toUpperCase()})}function C(e,t,n){var r=t==="light"?m:p;for(var o in r)if(o.toUpperCase()===e.toUpperCase())return r[o][n];return null}function b(t,n){var r=C(t,n,"opacity");return r||(n==="light"&&t===e?c:u)}function v(t,n){var r;if(t===e)return n==="light"?s._(/*BTDS*/"Color: Beige, color hexadecimal: #F5F1EB, tono: beige"):s._(/*BTDS*/"Color: Black, color hexadecimal: #161717, tono: negro");var o=n==="light"?m:p,a=(r=o[t])==null||r.getAriaLabel==null?void 0:r.getAriaLabel();return a}function S(t,n){var r;if(t===e)return n==="light"?s._(/*BTDS*/"Beige"):s._(/*BTDS*/"Negro");var o=n==="light"?m:p,a=(r=o[t])==null?void 0:r.getColorName();return a}function R(t,n){if(n==="light"&&t!==e){var r=C(t,n,"doodle");if(r)return"data-asset-chat-background-"+r}var o="data-asset-chat-background-"+n;return n==="light"&&t===e&&(o=d),o}function L(t,n){return t==="light"&&n!==e?!!C(n,t,"invertTransparentWallpaperColors"):!1}l.DEFAULT_CHAT_WALLPAPER=e,l.getWallpaperColors=g,l.toggleWallpaperColor=h,l.colorExistsInTheme=y,l.getWallpaperColorPropValue=C,l.getDoodleOpacity=b,l.getWallpaperColorAriaLabel=v,l.getWallpaperColorName=S,l.getDoodleAssetName=R,l.invertTransparentWallpaperColors=L}),226);
__d("WAWebChatPreferenceCollection",["WANullthrows","WAWebBaseCachePolicy","WAWebBaseCollection","WAWebChatPreferenceModel","WAWebUserPrefsKeys","WAWebWallpaper"],(function(t,n,r,o,a,i,l){var e={id:o("WAWebChatPreferenceModel").DEFAULT_PREFERENCE,wallpaper:o("WAWebWallpaper").DEFAULT_CHAT_WALLPAPER,saveToCameraRoll:!0,showDoodle:!0,spellcheck:!0,transformTextEmoji:!0,enterIsSend:!0,showExpandedComposer:!1,autoplayAnimatedImages:!0,hdMediaEnabled:!1},s=(function(t){function n(){return t.apply(this,arguments)||this}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.initializeFromCache=function(n){var t=n||[];this.add([e].concat(t),{merge:!0})},a.get=function(n){return t.prototype.get.call(this,n)||t.prototype.get.call(this,o("WAWebChatPreferenceModel").DEFAULT_PREFERENCE)},a.getDefault=function(){return r("WANullthrows")(t.prototype.get.call(this,o("WAWebChatPreferenceModel").DEFAULT_PREFERENCE))},a.delete=function(){t.prototype.delete.call(this),this.add(e)},n})(o("WAWebBaseCollection").BaseCollection);s.model=o("WAWebChatPreferenceModel").ChatPreference,s.cachePolicy={id:o("WAWebUserPrefsKeys").COLLECTIONS_KEYS.CHAT_PREFERENCE_COLLECTION,policy:o("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:1e3};var u=new s;l.default=u}),98);
__d("WAWebChatPreferenceModel",["WAWebBaseModel","WAWebChatPreferenceCollection","WAWebWid"],(function(t,n,r,o,a,i,l){var e="defaultPreference",s=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.wallpaper=o("WAWebBaseModel").prop(),t.saveToCameraRoll=o("WAWebBaseModel").prop(),t.showDoodle=o("WAWebBaseModel").prop(),t.spellcheck=o("WAWebBaseModel").prop(),t.transformTextEmoji=o("WAWebBaseModel").prop(),t.enterIsSend=o("WAWebBaseModel").prop(),t.showExpandedComposer=o("WAWebBaseModel").prop(),t.autoplayAnimatedImages=o("WAWebBaseModel").prop(),t.hdMediaEnabled=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getCollection=function(){return r("WAWebChatPreferenceCollection")},t})(o("WAWebBaseModel").BaseModel);s.Proxy="chatPreference",s.idClass=r("WAWebWid"),s.allowedIds=[e];var u=o("WAWebBaseModel").defineModel(s);l.DEFAULT_PREFERENCE=e,l.ChatPreference=u}),98);
__d("WAWebChatUnreadMentionCollection",["WAWebCollection","WAWebUnreadMentionModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.oldestUnreadMention=function(){var e,t=(e=this.last())!=null?e:null;return t&&this.remove(t),t},t})(r("WAWebCollection"));e.model=r("WAWebUnreadMentionModel"),e.comparator=function(e,t){return t.timestamp-e.timestamp},l.default=e}),98);
__d("WAWebChatGetMessage",["WAWebAck","WAWebCommonMsgUtils","WAWebMsgDataUtils","WAWebMsgGetters","WAWebStateUtils"],(function(t,n,r,o,a,i,l){function e(e){for(var t=o("WAWebStateUtils").unproxy(e),n=t.msgs.length-1;n>=0;n--){var r=t.msgs.at(n);if(r&&(!r.local||r.ack>o("WAWebAck").ACK.CLOCK))return r}}function s(e){for(var t=o("WAWebStateUtils").unproxy(e),n=t.msgs.length-1;n>=0;n--){var r=t.msgs.at(n);if(r&&o("WAWebMsgDataUtils").eventTypeFromMsgType(r)!==o("WAWebCommonMsgUtils").EventType.IGNORE)return r}}function u(e){for(var t=o("WAWebStateUtils").unproxy(e),n=t.msgs.length-1;n>=0;n--){var r=t.msgs.at(n);if(r!=null&&o("WAWebMsgGetters").getIsSentByMe(r))return r}}l.getLastReceivedMsg=e,l.getLastTimestampMsg=s,l.getLastSentMsg=u}),98);
__d("WAWebChatUpdates",["WAAbortError","WAPromiseDelays","WARaceSignal","WAWebChatGetMessage","WAWebChatLoadMessages","WAWebDBUpdateChatTable","WAWebNoop"],(function(t,n,r,o,a,i,l){function e(e){var t=Number(e.mute.expiration);o("WAWebDBUpdateChatTable").updateChatTable(e.id,{muteExpiration:t}).then(function(){return e.muteExpiration=t})}function s(e){if(!e.promises.updateSortTime){var t=new AbortController,n=t.signal,a=r("WARaceSignal")([n,e.getAbortController().signal],function(t){return o("WAPromiseDelays").delayMs(0).then(function(){var t=o("WAWebChatGetMessage").getLastTimestampMsg(e);if(t){e.t=t.t;return}else{if(e.msgs.msgLoadState.noEarlierMsgs)return;if(e.pendingMsgs)return}return o("WAWebChatLoadMessages").loadEarlierMsgs(e)}).then(function(n){if(t.aborted)throw new(o("WAAbortError")).AbortError;if(n){var r=o("WAWebChatGetMessage").getLastTimestampMsg(e);e.t=r?r.t:void 0}}).catch(r("WAWebNoop")).finally(function(){e.promises.updateSortTime=void 0})});e.promises.updateSortTime={promise:a,abortController:t}}}l.updateMuteExpiration=e,l.updateSortTime=s}),98);
__d("WAWebMuteCollection",["WALogger","WAWebABProps","WAWebBaseCachePolicy","WAWebBaseCollection","WAWebConnModel","WAWebMuteModel","WAWebUserPrefsKeys","WAWebUserPrefsNotifications","WAWebUserPrefsStore","gkx"],(function(t,n,r,o,a,i,l){var e,s;function u(e){throw new TypeError('"'+e+'" is read-only')}var c=!0,d=!0,m=!0,p=!1,_=!1,f=!1,g=!1,h=!1,y=!1,C=!1,b=!1,v=!0,S=!1,R=!1,L=!0,E=!1,k=!1,I=!0,T=(function(t){function n(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,e.isGranularNotificationsEnabled=!1,babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.initializeFromCache=function(t){var e=this;this.isGranularNotificationsEnabled=o("WAWebABProps").getABPropConfigValue("wa_web_enable_granular_notifications"),Array.isArray(t)&&t.forEach(function(t){o("WAWebMuteModel").GLOBAL_REACTIONS_MUTE===t.id&&e.add(t,{remove:!1})}),this.setGlobalCallNotifications(o("WAWebUserPrefsNotifications").getGlobalCallNotifications()),this.setGlobalNotifications(o("WAWebUserPrefsNotifications").getGlobalNotifications()),this.setGlobalOfflineNotifications(o("WAWebUserPrefsNotifications").getGlobalOfflineNotifications()),this.setGlobalSounds(o("WAWebUserPrefsNotifications").getGlobalSounds()),this.setGlobalCallRingtone(o("WAWebUserPrefsNotifications").getGlobalCallRingtone()),this.setGlobalPreviews(o("WAWebUserPrefsNotifications").getGlobalPreviews()),this.setCollapseMuted(o("WAWebUserPrefsNotifications").getCollapseMuted()),this.setOutgoingMessageSound(o("WAWebUserPrefsNotifications").getOutgoingMessageSound()),this.setIgnoreNondirectGroupMsg(o("WAWebUserPrefsNotifications").getIgnoreNondirectGroupMsg()),this.setGlobalNotificationsEnabled(o("WAWebUserPrefsNotifications").getGlobalNotificationsEnabled()),this.setGlobalNotificationReactionsEnabled(o("WAWebUserPrefsNotifications").getGlobalNotificationReactionsEnabled(!this.globalReactionsMute())),this.setGlobalSoundsEnabled(o("WAWebUserPrefsNotifications").getGlobalSoundsEnabled()),this.setGlobalGroupNotificationsEnabled(o("WAWebUserPrefsNotifications").getGlobalGroupNotificationsEnabled()),this.setGlobalGroupNotificationReactionsEnabled(o("WAWebUserPrefsNotifications").getGlobalGroupNotificationReactionsEnabled()),this.setGlobalGroupSoundsEnabled(o("WAWebUserPrefsNotifications").getGlobalGroupSoundsEnabled()),this.setGlobalStatusNotificationsEnabled(o("WAWebUserPrefsNotifications").getGlobalStatusNotificationsEnabled()),this.setGlobalStatusNotificationReactionsEnabled(o("WAWebUserPrefsNotifications").getGlobalStatusNotificationReactionsEnabled()),this.setGlobalStatusSoundsEnabled(o("WAWebUserPrefsNotifications").getGlobalStatusSoundsEnabled())},a.saveToCache=function(){if(o("WAWebConnModel").Conn.shouldSaveToCache()){var t=this.constructor.cachePolicy.id,n=[];o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["models:mute:cache-save: ",""])),String(t));var a=this.get(o("WAWebMuteModel").GLOBAL_REACTIONS_MUTE);a&&n.push(a.toJSON()),n.length?r("WAWebUserPrefsStore").setCollection(t,n):o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["models:mute:cache-save: globalMuteModel or globalReactionsMuteModel does not exist"])))}},a.globalReactionsMute=function(){var e=this.get(o("WAWebMuteModel").GLOBAL_REACTIONS_MUTE);if(e)return e;var t=new(o("WAWebMuteModel")).Mute({id:o("WAWebMuteModel").GLOBAL_REACTIONS_MUTE});return this.add(t),t},a.getGlobalSounds=function(){return c},a.setGlobalSounds=function(t){c=t,o("WAWebUserPrefsNotifications").setGlobalSounds(t),this.isGranularNotificationsEnabled||(this.setGlobalSoundsEnabled(t),this.setGlobalGroupSoundsEnabled(t),this.setGlobalStatusSoundsEnabled(t))},a.getGlobalCallRingtone=function(){return m},a.setGlobalCallRingtone=function(t){m=t,o("WAWebUserPrefsNotifications").setGlobalCallRingtone(t)},a.getGlobalNotifications=function(){return p},a.setGlobalNotifications=function(t){p=t,o("WAWebUserPrefsNotifications").setGlobalNotifications(t),this.isGranularNotificationsEnabled||(this.setGlobalNotificationsEnabled(t),this.setGlobalGroupNotificationsEnabled(t),this.setGlobalStatusNotificationsEnabled(t))},a.getGlobalCallNotifications=function(){return d},a.setGlobalCallNotifications=function(t){d=t,o("WAWebUserPrefsNotifications").setGlobalCallNotifications(t)},a.getGlobalOfflineNotifications=function(){return _},a.setGlobalOfflineNotifications=function(t){_=t,o("WAWebUserPrefsNotifications").setGlobalOfflineNotifications(t)},a.getGlobalPreviews=function(){return f},a.setGlobalPreviews=function(t){f=t,o("WAWebUserPrefsNotifications").setGlobalPreviews(t)},a.getCollapseMuted=function(){return g},a.setCollapseMuted=function(t){g=t,o("WAWebUserPrefsNotifications").setCollapseMuted(t),this.trigger("change:collapseMuted",g)},a.getOutgoingMessageSound=function(){return h},a.setOutgoingMessageSound=function(t){h=t,o("WAWebUserPrefsNotifications").setOutgoingMessageSound(t)},a.getIgnoreNondirectGroupMsg=function(){return r("gkx")("26258")?!1:y},a.setIgnoreNondirectGroupMsg=function(t){r("gkx")("26258")||(y=t,o("WAWebUserPrefsNotifications").setIgnoreNondirectGroupMsg(t))},a.getGlobalNotificationsEnabled=function(){return C},a.setGlobalNotificationsEnabled=function(t){C=t,o("WAWebUserPrefsNotifications").setGlobalNotificationsEnabled(t),this.isGranularNotificationsEnabled&&this.setGlobalNotifications(t)},a.getGlobalNotificationReactionsEnabled=function(){return b},a.setGlobalNotificationReactionsEnabled=function(t){b=t,o("WAWebUserPrefsNotifications").setGlobalNotificationReactionsEnabled(t),this.isGranularNotificationsEnabled&&(t?this.globalReactionsMute().unmute():this.globalReactionsMute().mute({expiration:-1}))},a.getGlobalSoundsEnabled=function(){return v},a.setGlobalSoundsEnabled=function(t){v=t,o("WAWebUserPrefsNotifications").setGlobalSoundsEnabled(t),this.isGranularNotificationsEnabled&&this.setGlobalSounds(t)},a.getGlobalGroupNotificationsEnabled=function(){return S},a.setGlobalGroupNotificationsEnabled=function(t){S=t,o("WAWebUserPrefsNotifications").setGlobalGroupNotificationsEnabled(t)},a.getGlobalGroupNotificationReactionsEnabled=function(){return R},a.setGlobalGroupNotificationReactionsEnabled=function(t){R=t,o("WAWebUserPrefsNotifications").setGlobalGroupNotificationReactionsEnabled(t)},a.getGlobalGroupSoundsEnabled=function(){return L},a.setGlobalGroupSoundsEnabled=function(t){L=t,o("WAWebUserPrefsNotifications").setGlobalGroupSoundsEnabled(t)},a.getGlobalStatusNotificationsEnabled=function(){return E},a.setGlobalStatusNotificationsEnabled=function(t){E=t,o("WAWebUserPrefsNotifications").setGlobalStatusNotificationsEnabled(t)},a.getGlobalStatusNotificationReactionsEnabled=function(){return k},a.setGlobalStatusNotificationReactionsEnabled=function(t){k=t,o("WAWebUserPrefsNotifications").setGlobalStatusNotificationReactionsEnabled(t)},a.getGlobalStatusSoundsEnabled=function(){return I},a.setGlobalStatusSoundsEnabled=function(t){I=t,o("WAWebUserPrefsNotifications").setGlobalStatusSoundsEnabled(t)},a.setAllNotificationsAndReactions=function(t){this.setGlobalNotificationReactionsEnabled(t),this.setGlobalGroupNotificationReactionsEnabled(t),this.setGlobalStatusNotificationReactionsEnabled(t),this.isGranularNotificationsEnabled?(this.setGlobalNotificationsEnabled(t),this.setGlobalGroupNotificationsEnabled(t),this.setGlobalStatusNotificationsEnabled(t)):(this.setGlobalNotifications(t),t?this.globalReactionsMute().unmute():this.globalReactionsMute().mute({expiration:-1}))},n})(o("WAWebBaseCollection").BaseCollection);T.model=o("WAWebMuteModel").Mute,T.cachePolicy={id:o("WAWebUserPrefsKeys").COLLECTIONS_KEYS.MUTE_COLLECTION,policy:o("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:1e3};var D=new T;l.MuteCollection=D}),98);
__d("WAWebMuteModel",["fbt","Promise","WALogger","WATypeUtils","WAWeb-moment","WAWebActionToast.react","WAWebAlarm","WAWebBaseModel","WAWebChatMuteBridge","WAWebGroupMetadataCollection","WAWebMiscErrors","WAWebMuteCollection","WAWebMuteGetters","WAWebNewsletterGatingUtils","WAWebNewsletterMetadataCollection","WAWebNewsletterToggleMuteStateAction","WAWebToastManager","WAWebUserPrefsMeUser","WAWebWamEnumChannelEventSurface","WAWebWid","err","react"],(function(t,n,r,o,a,i,l,s){var e,u,c,d,m,p,_,f,g,h,y,C,b,v;function S(e){throw new TypeError('"'+e+'" is read-only')}var R=v||(v=r("react")),L=-1,E="global_reactions_mute";function k(e,t){return r("WAWebWid").isGroup(e)&&!t?"group":r("WAWebWid").isNewsletter(e)&&!t?"newsletter":"chat"}var I=(function(t){function a(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.id=o("WAWebBaseModel").prop(),e.expiration=o("WAWebBaseModel").prop(0),e.callExpiration=o("WAWebBaseModel").prop(0),e.isAutoMuted=o("WAWebBaseModel").prop(!1),e.$MuteImpl$p_1=o("WAWebBaseModel").session(),e.$MuteImpl$p_2=o("WAWebBaseModel").session(),e.promises=o("WAWebBaseModel").session(function(){return{mute:null,unmute:null}}),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.initialize=function(){t.prototype.initialize.call(this),this.expiration!=null&&this.expiration!==0&&this.mute({expiration:this.expiration,isAutoMuted:this.isAutoMuted}),this.callExpiration!=null&&this.callExpiration!==0&&this.muteCall(this.callExpiration)},i.setMute=function(t,n,r){n===void 0&&(n=!1),!(!t&&!this.expiration||t===this.expiration)&&(t?this.mute({expiration:t,isAutoMuted:n,sendDevice:r}):this.unmute({sendDevice:r}))},i.setAutoMuted=function(t){this.set({isAutoMuted:t})},i.mute=function(a){var t=this,i=a.expiration,l=a.sendDevice,p=a.toastId,_=a.fromMultiselect,f=_===void 0?!1:_,g=a.isAutoMuted,h=g===void 0?!1:g,y=a.showToast,C=y===void 0?!0:y,v=i;if(!o("WATypeUtils").isNumber(v))return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:mute called with invalid expiration ",""])),v),(b||(b=n("Promise"))).reject(new(o("WAWebMiscErrors")).ActionError);v=Math.round(v),v>2e9&&o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:mute called with wrong units?"," exp:",""])),this.id.toString(),v);var S=function(){if(o("WAWebMuteGetters").getIsMuted(t)&&(r("WAWebAlarm").clearTimeout(t.$MuteImpl$p_1),t.unset("_unmuteTimer")),v===L)o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:mute "," muted, no expiration"])),t.id.toString());else{var e=v-r("WAWeb-moment")().unix();o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:mute "," duration:",""])),t.id.toString(),e),t.$MuteImpl$p_1=r("WAWebAlarm").setGlobalTimeout(function(){return void t.unmute()},v*1e3)}t.set({expiration:v,isAutoMuted:h})},E=k(this.id,f);if(l===!0){var I;if(!r("WAWebWid").isNewsletter(this.id)&&this.promises.mute!=null)return this.promises.mute;var T=r("WAWebWid").isNewsletter(this.id)?(I=this.promises.mute)!=null?I:(b||(b=n("Promise"))).reject(r("err")("No promise for newsletter mute")):this.promises.mute=o("WAWebChatMuteBridge").sendConversationMute(this.id,v,this.expiration),D=new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Silenciando el chat\u2026"));E==="group"?D=new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Silenciando grupo\u2026")):E==="newsletter"&&(D=new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Silenciando el canal\u2026")));var x=p!=null?p:o("WAWebActionToast.react").genId(),$=this.promises.mute.catch(function(e){o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:mute dropped"]))).devConsole(e);var n=s._(/*BTDS*/"No se pudo silenciar el chat.");if(E==="group"?n=s._(/*BTDS*/"No se pudo silenciar el grupo."):E==="newsletter"&&(D=new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"No se pudo silenciar el canal"))),!r("WAWebWid").isNewsletter(t.id))throw new(o("WAWebActionToast.react")).ActionType(n,{actionText:s._(/*BTDS*/"Vuelve a intentarlo."),actionHandler:function(){return t.mute({expiration:v,isAutoMuted:h,sendDevice:l,toastId:x})}})}).then(function(e){if(e.status===200){var n=s._(/*BTDS*/"Chat silenciado");return E==="group"?n=s._(/*BTDS*/"Grupo silenciado"):E==="newsletter"&&(n=s._(/*BTDS*/"Se desactivaron las notificaciones.")),f?new(o("WAWebActionToast.react")).ActionType(n):new(o("WAWebActionToast.react")).ActionType(n,{actionText:s._(/*BTDS*/"Deshacer"),actionHandler:function(){return r("WAWebWid").isNewsletter(t.id)?o("WAWebNewsletterToggleMuteStateAction").unmuteNewsletterAction(t.id,{eventSurface:o("WAWebWamEnumChannelEventSurface").CHANNEL_EVENT_SURFACE.CHANNEL_PROFILE}):t.unmute({sendDevice:l,toastId:x})}})}else if(e.status>=400)throw E==="newsletter"?new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Error al silenciar el canal")):E==="group"?new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"No se pudo silenciar el grupo.")):new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"No se pudo silenciar el chat."))});return C&&o("WAWebToastManager").ToastManager.open(R.jsx(o("WAWebActionToast.react").ActionToast,{id:x,initialAction:D,pendingAction:$})),T.then(function(e){e.status===200&&S()}).finally(function(){t.promises.mute=null})}return S(),(b||(b=n("Promise"))).resolve()},i.muteCall=function(t){var e=this,a=t;if(!o("WATypeUtils").isNumber(a))return o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:muteCall called with invalid expiration ",""])),a),(b||(b=n("Promise"))).reject(new(o("WAWebMiscErrors")).ActionError);if(a=Math.round(a),a>2e9&&o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:muteCall called with wrong units?"," exp:",""])),this.id.toString(),a),o("WAWebMuteGetters").getIsCallMuted(this)&&(r("WAWebAlarm").clearTimeout(this.$MuteImpl$p_2),this.unset("_unmuteCallTimer")),a===L)o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:muteCall "," muted, no expiration"])),this.id.toString());else{var i=a-r("WAWeb-moment")().unix();o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:muteCall "," duration:",""])),this.id.toString(),i),this.$MuteImpl$p_2=r("WAWebAlarm").setGlobalTimeout(function(){return void e.unmuteCall()},a*1e3)}return this.set({callExpiration:a}),(b||(b=n("Promise"))).resolve()},i.canMute=function(){var e=!1;if(o("WAWebUserPrefsMeUser").isMeAccount(this.id))return!1;if(r("WAWebWid").isGroup(this.id)){var t=r("WAWebGroupMetadataCollection").get(this.id);t&&(e=t.participants.iAmMember())}if(o("WAWebNewsletterGatingUtils").isNewsletterEnabled()&&r("WAWebWid").isNewsletter(this.id)){var n=r("WAWebNewsletterMetadataCollection").get(this.id);n!=null&&(e=n.canBeMuted)}return e||r("WAWebWid").isUser(this.id)},i.$MuteImpl$p_3=function(){r("WAWebAlarm").clearTimeout(this.$MuteImpl$p_1),this.unset("_unmuteTimer"),this.expiration=0},i.$MuteImpl$p_4=function(){r("WAWebAlarm").clearTimeout(this.$MuteImpl$p_2),this.unset("_unmuteCallTimer"),this.callExpiration=0},i.unmute=function(t){var e=this,a=t===void 0?{}:t,i=a.sendDevice,l=a.toastId,u=a.fromMultiselect,c=u===void 0?!1:u,d=a.showToast,m=d===void 0?!0:d,p=!1,_=function(){o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:unmute ",""])),e.id.toString()),e.$MuteImpl$p_3(),e.set({isAutoMuted:p})},f=k(this.id,c);if(i===!0){var g;if(!r("WAWebWid").isNewsletter(this.id)&&this.promises.unmute)return this.promises.unmute;var C=r("WAWebWid").isNewsletter(this.id)?(g=this.promises.unmute)!=null?g:(b||(b=n("Promise"))).reject(r("err")("No promise for newsletter mute")):this.promises.unmute=o("WAWebChatMuteBridge").sendConversationMute(this.id,0,this.expiration),v=new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Desactivando el silencio en el chat\u2026"));f==="group"?v=new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Desactivando el silencio del grupo\u2026")):f==="newsletter"&&(v=new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Desactivando el silencio del canal\u2026")));var S=l||o("WAWebActionToast.react").genId(),L=this.promises.unmute.catch(function(t){o("WALogger").WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:unmute dropped"]))).devConsole(t);var n=s._(/*BTDS*/"No se pudo desactivar el silencio en el chat.");if(f==="group"?n=s._(/*BTDS*/"No se pudo desactivar el silencio del grupo."):f==="newsletter"&&(n=s._(/*BTDS*/"No se pudo desactivar el silencio del canal.")),!r("WAWebWid").isNewsletter(e.id))throw new(o("WAWebActionToast.react")).ActionType(n,{actionText:s._(/*BTDS*/"Vuelve a intentarlo."),actionHandler:function(){return e.unmute({sendDevice:i,toastId:S})}})}).then(function(t){if(t.status===200)return f==="group"?new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Silencio desactivado")):f==="newsletter"?new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Se activaron las notificaciones."),{actionText:s._(/*BTDS*/"Deshacer"),actionHandler:function(){return o("WAWebNewsletterToggleMuteStateAction").muteNewsletterAction(e.id,{eventSurface:o("WAWebWamEnumChannelEventSurface").CHANNEL_EVENT_SURFACE.CHANNEL_THREAD})}}):new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Silencio desactivado"));if(t.status>=400)throw f==="newsletter"?new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"Error al desactivar el silencio del canal")):f==="group"?new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"No se pudo desactivar el silencio del grupo.")):new(o("WAWebActionToast.react")).ActionType(s._(/*BTDS*/"No se pudo desactivar el silencio en el chat."))});return m&&o("WAWebToastManager").ToastManager.open(R.jsx(o("WAWebActionToast.react").ActionToast,{id:S,initialAction:v,pendingAction:L})),C.then(function(e){e.status===200&&_()}).finally(function(){e.promises.unmute=null})}return _(),(b||(b=n("Promise"))).resolve()},i.unmuteCall=function(){return o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:unmuteCall ",""])),this.id.toString()),this.$MuteImpl$p_4(),(b||(b=n("Promise"))).resolve()},i.delete=function(){t.prototype.delete.call(this),this.getCollection().remove(this.id),this.$MuteImpl$p_3(),o("WAWebMuteGetters").clearMuteGetterCacheFor(this)},i.getCollection=function(){return o("WAWebMuteCollection").MuteCollection},a})(o("WAWebBaseModel").BaseModel);I.Proxy="mute",I.idClass=r("WAWebWid"),I.allowedIds=[E];var T=o("WAWebBaseModel").defineModel(I);l.GLOBAL_REACTIONS_MUTE=E,l.Mute=T}),226);
__d("WAWebSuperChatMsgs",["WALogger","WAWebBaseModel","WAWebChatMsgsCollection","err","lodash"],(function(t,n,r,o,a,i,l){var e,s,u=(function(t){function n(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.id=o("WAWebBaseModel").prop(),e.pendingMsgs=o("WAWebBaseModel").prop(),e.labels=o("WAWebBaseModel").prop(),e.msgChunks=o("WAWebBaseModel").session(function(){return[]}),e.lastReceivedKey=o("WAWebBaseModel").session(),e.unreadMsgAnchor=o("WAWebBaseModel").session(),e.disableUnreadAnchor=o("WAWebBaseModel").session(),e.msgsLength=o("WAWebBaseModel").session(),e.msgsChanged=o("WAWebBaseModel").session(0),e.msgs=o("WAWebBaseModel").collection(o("WAWebChatMsgsCollection").ChatMsgsCollection),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.initialize=function(){var e=this;t.prototype.initialize.call(this),this.listenTo(this.msgs,"change:last",function(){e.msgsChanged++}),this.listenTo(this.msgs,"add remove bulk_add",function(){e.msgsChanged++,e.msgsLength=e.msgs.length})},a.onEmptyMRM=function(){throw r("err")("onEmptyMRM not implemented")},a.delete=function(){t.prototype.delete.call(this),this.getAllCMCs().forEach(function(e){e.forEach(function(e){e.delete()}),e.delete()})},a.removeMsg=function(n){var t=n.msgChunk;if(t){var r=t.indexOf(n);r<0||(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["models:Chat:removeMsg ",""])),n.get("id")),t.remove(n),t.length===0&&(t===this.msgs?this.onEmptyMRM():this.removeMsgsCollection(t)))}},a.getAllCMCs=function(){return this.msgChunks.concat([this.msgs])},a.getAllMsgs=function(){return r("lodash").flatten(this.getAllCMCs().map(function(e){return e.getModelsArray()}))},a.replaceMsgsCollection=function(t){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["model:Chat:replaceMsgsCollection:",""])),this.id.toString());var e={msg:t.last()};this.msgs.replace(t),this.notifyMsgCollectionMerge(t,this.msgs,this.msgs,e),this.msgChunks=this.msgChunks.filter(function(e){return e!==t}),t.delete()},a.removeMsgsCollection=function(t){this.msgChunks=this.msgChunks.filter(function(e){return e!==t}),t.delete()},a.notifyMsgCollectionMerge=function(t,n,r,o){this.trigger("change:cmc:merge",t,n,r,o)},n})(o("WAWebBaseModel").BaseModel);l.default=u}),98);
__d("WAWebContactCollection",["Promise","WALogger","WAWebBaseCollection","WAWebContactComparator","WAWebContactGetters","WAWebContactModel","WAWebFrontendContactGetters","WAWebLid1X1MigrationGating","WAWebSocketConstants","WAWebSocketModel","WAWebUserPrefsMeUser","WAWebUsernameGatingUtils","WAWebWid","lodash"],(function(t,n,r,o,a,i,l){var e,s,u=(function(t){function a(){var e;return e=t.call(this)||this,e._sort=r("lodash").debounce(function(){return t.prototype.sort.call(e)},1e3),e._silentSort=r("lodash").debounce(function(){return t.prototype.sort.call(e,{silent:!0})},1e3),e.findImpl=function(t){var r=e.get(t);return r?(s||(s=n("Promise"))).resolve({id:r.id,stale:r.stale}):(s||(s=n("Promise"))).resolve({id:t})},e.listenTo(o("WAWebSocketModel").Socket,"change:stream",function(){o("WAWebSocketModel").Socket.stream===o("WAWebSocketConstants").SOCKET_STREAM.RESUMING&&e.forEach(function(e){e.unset("verificationString"),e.unset("verificationBinary")})}),e}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.sort=function(t){return this},i.ensureSorted=function(){this._sort.flush()},i.initializeFromCache=function(n){n&&(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Store:Contact init from cache"]))),this.add(n,{silent:!0,merge:!0}))},i.isFilteredContact=function(t){return!!t.name&&!o("WAWebContactGetters").getIsMe(t)&&!o("WAWebContactGetters").getIsPSA(t)&&o("WAWebContactGetters").getIsWAContact(t)},i.getFilteredContacts=function(t){var e=t.showMe,n=e===void 0?!1:e,a=t.showWithoutName,i=a===void 0?!1:a,l=t.filterFn,s=l===void 0?null:l,u=t.cancelAt,c=u===void 0?null:u,d=[];for(var m of this._models){if(c!=null&&d.length>=c){d=[];break}var p=o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&o("WAWebUsernameGatingUtils").usernameContactUIEnabled();if(!(p&&!m.id.isLid())){{if(!p&&m.id.isLid())continue;if(m.id.isBot())continue;if(r("WAWebWid").isPSA(m.id))continue;if(o("WAWebContactGetters").getIsMe(m)){if(n){if(s!=null&&s(m)!==!0)continue;d.push(m)}continue}}(!(m.name||i)||!o("WAWebContactGetters").getIsWAContact(m))&&!o("WAWebFrontendContactGetters").getIsUsernameContact(m)||s!=null&&s(m)!==!0||d.push(m)}}return d.sort(o("WAWebContactComparator").ContactComparator)},i.getGroupContacts=function(){return this.filter(function(e){return o("WAWebContactGetters").getIsGroup(e)})},i.getMeContact=function(){var e=o("WAWebUserPrefsMeUser").getMaybeMePnUser();return e==null?null:this.get(e)},a})(o("WAWebBaseCollection").BaseCollection);u.model=r("WAWebContactModel"),u.comparator=o("WAWebContactComparator").ContactComparator;var c=new u;l.ContactCollectionImpl=u,l.ContactCollection=c}),98);
__d("WAWebContactShortName",["WALogger","WAWebAlphaRegex","WAWebNonEmptyString"],(function(t,n,r,o,a,i,l){var e;function s(t){if(t==null)return null;var n=t.split(/\s/),a=n[0];return r("WAWebAlphaRegex").exec(a)?o("WAWebNonEmptyString").asMaybeNonEmptyString(a):(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[short-name] unable to get short name for contact"]))),null)}l.getShortName=s}),98);
__d("WAWebContactModel",["fbt","WALogger","WATimeUtils","WAWebAlarm","WAWebApiContact","WAWebBaseModel","WAWebBizBusinessChangeAction","WAWebBizGatingUtils","WAWebBizLabelUtils","WAWebBlocklistCollection","WAWebBotGating","WAWebBusinessProfileCollection","WAWebConnModel","WAWebContactCollection","WAWebContactGetters","WAWebContactManagementGating","WAWebContactShortName","WAWebFrontendContactGetters","WAWebL10N","WAWebListsGatingUtils","WAWebOptOutListCollection","WAWebProfilePicThumbCollection","WAWebTextStatusCollection","WAWebTextStatusGatingUtils","WAWebTextStatusUtils","WAWebUpdateTextStatusForContact","WAWebUsernameGatingUtils","WAWebWid","WAWebWidFactory","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l,s){var e,u,c=1e3,d=(function(t){function n(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.id=o("WAWebBaseModel").prop(),e.name=o("WAWebBaseModel").prop(),e.shortName=o("WAWebBaseModel").prop(),e.pushname=o("WAWebBaseModel").prop(),e.type=o("WAWebBaseModel").prop("in"),e.verifiedName=o("WAWebBaseModel").prop(),e.isBusiness=o("WAWebBaseModel").prop(),e.isEnterprise=o("WAWebBaseModel").prop(),e.isSmb=o("WAWebBaseModel").prop(),e.verifiedLevel=o("WAWebBaseModel").prop(),e.privacyMode=o("WAWebBaseModel").prop(),e.statusMute=o("WAWebBaseModel").prop(),e.parentStatusMute=o("WAWebBaseModel").prop(),e.sectionHeader=o("WAWebBaseModel").prop(),e.labels=o("WAWebBaseModel").prop(),e.isContactSyncCompleted=o("WAWebBaseModel").prop(),e.forcedBusinessUpdateFromServer=o("WAWebBaseModel").prop(),e.disappearingModeDuration=o("WAWebBaseModel").prop(),e.disappearingModeSettingTimestamp=o("WAWebBaseModel").prop(),e.textStatusString=o("WAWebBaseModel").prop(),e.textStatusEmoji=o("WAWebBaseModel").prop(),e.textStatusEphemeralDuration=o("WAWebBaseModel").prop(),e.textStatusLastUpdateTime=o("WAWebBaseModel").prop(o("WAWebTextStatusUtils").TEXT_STATUS_NOT_FETCHED),e.textStatusExpiryTs=o("WAWebBaseModel").prop(),e.requestedPnTimestamp=o("WAWebBaseModel").prop(),e.username=o("WAWebBaseModel").prop(),e.usernameKey=o("WAWebBaseModel").prop(),e.usernameCountryCode=o("WAWebBaseModel").prop(),e.isUsernameContact=o("WAWebBaseModel").prop(!1),e.syncToAddressbook=o("WAWebBaseModel").prop(!1),e.isContactBlocked=o("WAWebBaseModel").session(!1),e.isContactOptedOut=o("WAWebBaseModel").session(!1),e.isEverOptedOutOfMarketingMessages=o("WAWebBaseModel").session(!1),e.isMarketingMessageThread=o("WAWebBaseModel").session(!1),e.pendingAction=o("WAWebBaseModel").session(),e.promises=o("WAWebBaseModel").session(function(){return{}}),e.status=o("WAWebBaseModel").session(),e.profilePicThumb=o("WAWebBaseModel").session(),e.businessProfile=o("WAWebBaseModel").session(),e.commonGroups=o("WAWebBaseModel").session(),e.businessCatalog=o("WAWebBaseModel").session(),e.locale=o("WAWebBaseModel").session(),e.shareOwnPn=o("WAWebBaseModel").session(),e.phoneNumber=o("WAWebBaseModel").session(),e.displayNameLID=o("WAWebBaseModel").session(),e.isHosted=o("WAWebBaseModel").session(!1),e.isOrHasBeenHosted=o("WAWebBaseModel").session(!1),e.isFavorite=o("WAWebBaseModel").session(!1),e.meTextStatusExpiryTimer=o("WAWebBaseModel").session(),e.maybeCommonGroupChatModel=o("WAWebBaseModel").session(),e.canSendMsgWhileTimelocked=o("WAWebBaseModel").session(!0),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.$Contact$p_1=function(){var e;r("WAWebAlarm").clearTimeout(this.meTextStatusExpiryTimer),this.unset(["meTextStatusExpiryTimer"]),o("WAWebUpdateTextStatusForContact").updateTextStatusForContact(this.id,(e=o("WAWebTextStatusUtils")).CLEAR_TEXT_STATUS_STRING_VAL,e.CLEAR_TEXT_STATUS_EMOJI_VAL,e.CLEAR_TEXT_STATUS_EPHEMERAL_DURATION_VAL,e.CLEAR_TEXT_STATUS_LAST_UPDATE_TIME_VAL)},a.setupStatusExpiration=function(){var e=this,t=this.textStatusExpiryTs;t!=null&&(this.meTextStatusExpiryTimer!=null&&r("WAWebAlarm").clearTimeout(this.meTextStatusExpiryTimer),t<o("WATimeUtils").unixTime()?self.setTimeout(function(){e.$Contact$p_1()}):this.meTextStatusExpiryTimer=r("WAWebAlarm").setGlobalTimeout(function(){return e.$Contact$p_1()},t*c,this.meTextStatusExpiryTimer))},a.initialize=function(){var e=this;if(t.prototype.initialize.call(this),!!this.id){o("WAWebContactGetters").getIsMe(this)&&this.addChild("status",o("WAWebTextStatusCollection").TextStatusCollection.gadd(this.id)),o("WAWebContactGetters").getIsMe(this)&&o("WAWebTextStatusGatingUtils").receiveTextStatusEnabled()&&(this.setupStatusExpiration(),this.listenTo(this,"change:textStatusExpiryTs",function(){self.setTimeout(function(){e.setupStatusExpiration()})})),o("WAWebContactGetters").getIsMe(this)&&this.addChild("profilePicThumb",o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.gadd(this.id)),(this.isBusiness||o("WAWebContactGetters").getIsMe(this)&&o("WAWebConnModel").Conn.isSMB)&&this.addChild("businessProfile",o("WAWebBusinessProfileCollection").BusinessProfileCollection.gadd(this.id)),this.listenTo(this,"change:isBusiness",function(){return o("WAWebBizBusinessChangeAction").handleBusinessChange(e)}),o("WAWebContactGetters").getIsMe(this)&&this.listenTo(o("WAWebConnModel").Conn,"change:pushname",function(){e.set({pushname:o("WAWebConnModel").Conn.pushname})}),this.listenTo(r("WAWebL10N"),"locale_change",function(){e.locale=r("WAWebL10N").getLocale()}),this.id.isUser()&&(this.updateContactBlocked(),this.updateContactOptedOutOfMarketingMessages()),this.listenTo(this,"change:name",this.updateShortName),this.listenTo(this,"change:name",this.updateName),this.pendingAction=0,(o("WAWebConnModel").Conn.isSMB||o("WAWebListsGatingUtils").isListsEnabled())&&o("WAWebBizLabelUtils").initializeLabels(this);var n=this.id;if(n.isLid()){var a=this.phoneNumber||o("WAWebApiContact").getPhoneNumber(n);a!=null&&this.copyFieldsFromPnContact(a)}else this.id.isUser()&&(this.updateLidFields(),this.listenTo(this,"change:name change:statusMute",function(){e.updateLidFields()}));this.id.isBot()&&(this.name||(this.id.user==="13135550002"?this.set({name:"Meta AI"}):this.set({name:s._(/*BTDS*/"IA").toString()}),this.set({type:"out"})))}},a.updateName=function(){var e;!o("WAWebFrontendContactGetters").getIsMyContact(this)&&o("WAWebBotGating").isBizBot3pEnabled()&&((e=this.businessProfile)==null?void 0:e.isBizBot3p)===!0&&this.verifiedName!=null&&this.set({name:this.verifiedName})},a.updateShortName=function(){if(o("WAWebContactGetters").getIsUser(this)&&this.name&&!this.shortName){var e=o("WAWebContactShortName").getShortName(this.name);e!=null&&this.set("shortName",e)}},a.getCurrentLidContact=function(){var e=o("WAWebWidFactory").asUserWidOrThrow(this.id);if(e.isLid())return this;var t=o("WAWebApiContact").getCurrentLid(e);return t!=null?o("WAWebContactCollection").ContactCollection.get(t):null},a.updateLidFields=function(){var e=this.getCurrentLidContact();e&&(e.set({name:this.name}),e.set({parentStatusMute:this.statusMute}))},a.isActive=function(){var e=this.id;return e.isLid()?e.equals(o("WAWebApiContact").getLatestLid(e)):!0},a.copyFieldsFromPnContact=function(t){var e=this.getCollection().get(t);(e==null?void 0:e.name)!=null&&this.set({name:e.name}),(e==null?void 0:e.statusMute)!=null&&this.set({parentStatusMute:e.statusMute}),this.set({phoneNumber:t})},a.getStatus=function(){return r("WAWebWid").user(this.id)||o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["contact:getStatus for non-user ",""])),this.id.toString()),this.status=o("WAWebTextStatusCollection").TextStatusCollection.gadd(this.id)},a.getProfilePicThumb=function(){return this.profilePicThumb=o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.gadd(this.id)},a.addPendingAction=function(t){var e=this,n=function(){e.decPending()};return t.then(n,n),this.pendingAction++,t},a.decPending=function(){this.pendingAction>0?this.pendingAction--:(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["contact:onPendingActionUpdate pendingAction value is invalid"]))),this.pendingAction=0)},a.updateContactBlocked=function(){if(this.id.isUser())if(o("WAWebBlocklistCollection").BlocklistCollection.get(this.id))this.isContactBlocked=!0;else if(this.id.isLid()&&this.phoneNumber!=null)this.isContactBlocked=o("WAWebBlocklistCollection").BlocklistCollection.get(this.phoneNumber)!=null;else{var e=o("WAWebApiContact").getAlternateUserWid(o("WAWebWidFactory").asUserWidOrThrow(this.id)),t=e!=null&&o("WAWebBlocklistCollection").BlocklistCollection.get(e)!=null;this.isContactBlocked=t}},a.updateContactOptedOutOfMarketingMessages=function(){if(this.id.isUser()){if(o("WAWebOptOutListCollection").OptOutListCollection.get(this.id))this.isContactOptedOut=!0;else if(this.id.isLid()&&this.phoneNumber!=null)this.isContactOptedOut=o("WAWebOptOutListCollection").OptOutListCollection.get(this.phoneNumber)!=null;else{var e=o("WAWebApiContact").getAlternateUserWid(o("WAWebWidFactory").asUserWidOrThrow(this.id)),t=e!=null&&o("WAWebOptOutListCollection").OptOutListCollection.get(e)!=null;this.isContactOptedOut=t}this.isContactOptedOut&&(this.isEverOptedOutOfMarketingMessages=!0)}},a.setIsMarketingMessageThread=function(t){this.isMarketingMessageThread=t},a.getIsMarketingMessageThread=function(){return this.isMarketingMessageThread},a.$Contact$p_2=function(){var e=o("WAWebFrontendContactGetters").getUsername(this);if(r("isStringNullOrEmpty")(e))return!1;var t=o("WAWebFrontendContactGetters").getSearchName(this);if(!r("isStringNullOrEmpty")(t))return!1;var n=o("WAWebContactGetters").getSearchVerifiedName(this);return r("isStringNullOrEmpty")(n)},a.$Contact$p_3=function(t,n,a){var e=o("WAWebFrontendContactGetters").getSearchName(this);if((o("WAWebBizGatingUtils").canDisplayLabel()||o("WAWebListsGatingUtils").isListsEnabled())&&!r("isStringNullOrEmpty")(a)){var i,l=o("WAWebFrontendContactGetters").getUsername(this);return t&&!r("isStringNullOrEmpty")(e)&&!e.includes(t)&&!r("isStringNullOrEmpty")(l)&&!l.includes(t)?!1:!!((i=this.labels)!=null&&i.includes(a))}if(!t)return!1;if(!r("isStringNullOrEmpty")(e)&&e.includes(t))return!0;var u=o("WAWebContactGetters").getUserid(this);if(!r("isStringNullOrEmpty")(u)&&u.includes(t)&&!this.$Contact$p_2())return!0;if(!r("isStringNullOrEmpty")(n)&&!this.$Contact$p_2()){if(this.id.isLid()){if(u!=null){var c=o("WAWebWidFactory").asUserLidOrThrow(o("WAWebWidFactory").createUserWidOrThrow(u,"lid")),d=o("WAWebApiContact").getPhoneNumber(c);if(d!=null&&d.toString().includes(n))return!0}}else if(u!=null&&u.includes(n))return!0}var m=o("WAWebContactGetters").getSearchVerifiedName(this);if(!r("isStringNullOrEmpty")(m)&&m.includes(t)||this.pushname&&r("WAWebL10N").accentFold(this.pushname).includes(t))return!0;if(this.username!=null){var p=r("WAWebL10N").accentFold(this.username);if(p.includes(t)&&o("WAWebUsernameGatingUtils").usernameDisplayedEnabled())return!0}if(o("WAWebContactGetters").getIsMe(this)){var _=r("WAWebL10N").accentFold(s._(/*BTDS*/"Yo").toString());if(_.includes(t))return!0}return!1},a.searchMatch=function(t,n,r){if(t.startsWith("@")&&o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()){var e=t.slice(1).replace(/#.*/,"");return this.$Contact$p_3(e,n,r)||this.$Contact$p_3(t,n,r)}return this.$Contact$p_3(t,n,r)},a.set=function(n,r,a){var e=t.prototype.set.call(this,n,r,a);if(typeof n!="string"&&r!=null&&r.merge&&e){if(o("WAWebContactGetters").getIsPSA(e)||e.id.isBot())return e;!n.name&&e.name&&(e.unset("name"),e.unset("shortName")),!n.verifiedName&&e.verifiedName&&e.unset("verifiedName")}return e},a.getCollection=function(){return o("WAWebContactCollection").ContactCollection},a.setNotMyContact=function(){this.name&&(this.set("name",void 0),this.set("shortName",void 0),this.set("type","out")),this.set("isUsernameContact",!1)},a.getSyncToAddressbook=function(){var e;return o("WAWebContactManagementGating").contactManagementEnabled()?(e=this.syncToAddressbook)!=null?e:!0:!1},a.canToggleFavorite=function(){return o("WAWebListsGatingUtils").isListsEnabled()||this.isFavorite?!0:o("WAWebFrontendContactGetters").getIsMyContact(this)&&!this.id.isBot()&&!o("WAWebContactGetters").getIsMe(this)},n})(o("WAWebBaseModel").BaseModel);d.Proxy="contact",d.idClass=r("WAWebWid");var m=o("WAWebBaseModel").defineModel(d);l.default=m}),226);
__d("WAWebDailyAggregatedStats",["$InternalEnum","WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=n("$InternalEnum")({NARRATIVE_APPEAR:1,DIALOG_APPEAR:2,DIALOG_SELECT:3}),s=1440*60*1e3,u=21*s,c=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.startTime=o("WAWebBaseModel").prop(),t.pttCancelBroadcast=o("WAWebBaseModel").prop(0),t.pttCancelGroup=o("WAWebBaseModel").prop(0),t.pttCancelIndividual=o("WAWebBaseModel").prop(0),t.pttCancelNewsletter=o("WAWebBaseModel").prop(0),t.pttDraftReviewBroadcast=o("WAWebBaseModel").prop(0),t.pttDraftReviewGroup=o("WAWebBaseModel").prop(0),t.pttDraftReviewIndividual=o("WAWebBaseModel").prop(0),t.pttDraftReviewNewsletter=o("WAWebBaseModel").prop(0),t.pttFastplaybackBroadcast=o("WAWebBaseModel").prop(0),t.pttFastplaybackGroup=o("WAWebBaseModel").prop(0),t.pttFastplaybackIndividual=o("WAWebBaseModel").prop(0),t.pttFastplaybackNewsletter=o("WAWebBaseModel").prop(0),t.pttLockBroadcast=o("WAWebBaseModel").prop(0),t.pttLockGroup=o("WAWebBaseModel").prop(0),t.pttLockIndividual=o("WAWebBaseModel").prop(0),t.pttLockNewsletter=o("WAWebBaseModel").prop(0),t.pttPlaybackBroadcast=o("WAWebBaseModel").prop(0),t.pttPlaybackGroup=o("WAWebBaseModel").prop(0),t.pttPlaybackIndividual=o("WAWebBaseModel").prop(0),t.pttPlaybackNewsletter=o("WAWebBaseModel").prop(0),t.pttRecordBroadcast=o("WAWebBaseModel").prop(0),t.pttRecordGroup=o("WAWebBaseModel").prop(0),t.pttRecordIndividual=o("WAWebBaseModel").prop(0),t.pttRecordNewsletter=o("WAWebBaseModel").prop(0),t.pttSendBroadcast=o("WAWebBaseModel").prop(0),t.pttSendGroup=o("WAWebBaseModel").prop(0),t.pttSendIndividual=o("WAWebBaseModel").prop(0),t.pttSendNewsletter=o("WAWebBaseModel").prop(0),t.pttPausedRecordBroadcast=o("WAWebBaseModel").prop(0),t.pttPausedRecordGroup=o("WAWebBaseModel").prop(0),t.pttPausedRecordIndividual=o("WAWebBaseModel").prop(0),t.pttPausedRecordNewsletter=o("WAWebBaseModel").prop(0),t.pttOutOfChatBroadcast=o("WAWebBaseModel").prop(0),t.pttOutOfChatGroup=o("WAWebBaseModel").prop(0),t.pttOutOfChatIndividual=o("WAWebBaseModel").prop(0),t.pttOutOfChatNewsletter=o("WAWebBaseModel").prop(0),t.goldenBoxContactNarrativeAppearCount=o("WAWebBaseModel").prop(0),t.goldenBoxContactDialogAppearCount=o("WAWebBaseModel").prop(0),t.goldenBoxContactDialogSelectCount=o("WAWebBaseModel").prop(0),t.goldenBoxGroupNarrativeAppearCount=o("WAWebBaseModel").prop(0),t.goldenBoxGroupDialogAppearCount=o("WAWebBaseModel").prop(0),t.goldenBoxGroupDialogSelectCount=o("WAWebBaseModel").prop(0),t.infoScreenContactNarrativeAppearCount=o("WAWebBaseModel").prop(0),t.infoScreenContactDialogAppearCount=o("WAWebBaseModel").prop(0),t.infoScreenContactDialogSelectCount=o("WAWebBaseModel").prop(0),t.infoScreenGroupNarrativeAppearCount=o("WAWebBaseModel").prop(0),t.infoScreenGroupDialogAppearCount=o("WAWebBaseModel").prop(0),t.infoScreenGroupDialogSelectCount=o("WAWebBaseModel").prop(0),t.chatsListNarrativeAppearCount=o("WAWebBaseModel").prop(0),t.chatsListDialogAppearCount=o("WAWebBaseModel").prop(0),t.chatsListDialogSelectCount=o("WAWebBaseModel").prop(0),t.statusListNarrativeAppearCount=o("WAWebBaseModel").prop(0),t.statusListDialogAppearCount=o("WAWebBaseModel").prop(0),t.statusListDialogSelectCount=o("WAWebBaseModel").prop(0),t.callingScreenAudioNarrativeAppearCount=o("WAWebBaseModel").prop(0),t.callingScreenAudioDialogAppearCount=o("WAWebBaseModel").prop(0),t.callingScreenAudioDialogSelectCount=o("WAWebBaseModel").prop(0),t.prinaLastEvent=o("WAWebBaseModel").prop(0),t.communityTabGroupNavigations=o("WAWebBaseModel").prop(0),t.communityTabToHomeViews=o("WAWebBaseModel").prop(0),t.communityTabViews=o("WAWebBaseModel").prop(0),t.communityTabViewsViaContextMenu=o("WAWebBaseModel").prop(0),t.communityNoActionTabViews=o("WAWebBaseModel").prop(0),t.communityHome=o("WAWebBaseModel").prop(function(){return{}}),t.pnhCagActions=o("WAWebBaseModel").prop(function(){return{}}),t.animatedEmojiSend=o("WAWebBaseModel").prop(0),t.singleEmojiSend=o("WAWebBaseModel").prop(0),t.emojiReply=o("WAWebBaseModel").prop(0),t.kicGroupNotificationTaps=o("WAWebBaseModel").prop(0),t.kicGroupNotifications=o("WAWebBaseModel").prop(0),t.kicNotificationTaps=o("WAWebBaseModel").prop(0),t.kicNotifications=o("WAWebBaseModel").prop(0),t.chatLockFolderChatsCount=o("WAWebBaseModel").prop(0),t.chatLockFolderOpenCount=o("WAWebBaseModel").prop(0),t.chatLockLockFolderHidden=o("WAWebBaseModel").prop(null),t.chatLockNewAddChatCount=o("WAWebBaseModel").prop(0),t.chatLockNewRemoveChatCount=o("WAWebBaseModel").prop(0),t.chatLockSecretCodeActive=o("WAWebBaseModel").prop(null),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){e.prototype.initialize.call(this)},n.getEndTime=function(){return this.startTime+s},n.shouldBeSubmitted=function(){return!this.isExpired()&&this.getEndTime()<Date.now()},n.isExpired=function(){var e=Date.now()-u;return this.startTime<e},t})(o("WAWebBaseModel").BaseModel);c.Proxy="daily-aggregated-stats";var d=o("WAWebBaseModel").defineModel(c);l.PrinaDailyActionType=e,l.DailyAggregatedStats=d}),98);
__d("WAWebDailyAggregatedStatsCollection",["WANullthrows","WAWebBaseCachePolicy","WAWebBaseCollection","WAWebDailyAggregatedStats","WAWebUserPrefsGeneral","WAWebUserPrefsKeys"],(function(t,n,r,o,a,i,l){var e=864e5,s=(function(t){function n(){return t.apply(this,arguments)||this}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.gaddForDate=function(n){var t,a=o("WAWebUserPrefsGeneral").getDailyStatsStartTime(),i=n.getTime()-a,l=Math.floor(i/e),s=a+e*l;return(t=this.get(s))!=null?t:r("WANullthrows")(this.add({id:s.toString(),startTime:s})[0])},a.gaddForToday=function(){return this.gaddForDate(new Date)},a.initializeFromCache=function(t){if(t!=null){var e=t.map(function(e){return new(o("WAWebDailyAggregatedStats")).DailyAggregatedStats(e)}).filter(function(e){return c(e)&&!e.isExpired()});this.add(e)}},a.serialize=function(){return this.toArray().filter(function(e){return c(e)&&!e.isExpired()}).map(function(e){return e.toJSON()})},n})(o("WAWebBaseCollection").BaseCollection);s.model=o("WAWebDailyAggregatedStats").DailyAggregatedStats,s.cachePolicy={id:o("WAWebUserPrefsKeys").COLLECTIONS_KEYS.DAILY_AGGREGATED_STATS_COLLECTION,policy:o("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:1e3};var u=new s;function c(t){return(t.startTime-o("WAWebUserPrefsGeneral").getDailyStatsStartTime())%e===0}l.DailyAggregatedStatsCollectionImpl=s,l.DailyAggregatedStatsCollection=u}),98);
__d("WAWebSingleEmojiDailyUtils",["$InternalEnum","WALogger","WAWebDailyAggregatedStatsCollection","WAWebFrontendMsgGetters","WAWebMsgGetters"],(function(t,n,r,o,a,i,l){var e,s=n("$InternalEnum").Mirrored(["ANIMATED_EMOJI_SEND","SINGLE_EMOJI_SEND","EMOJI_REPLY"]);function u(e){var t=o("WAWebFrontendMsgGetters").getIsSingleEmoji(e);if(t!=null){var n=o("WAWebFrontendMsgGetters").getIsAnimatedEmoji(e);c(n?s.ANIMATED_EMOJI_SEND:s.SINGLE_EMOJI_SEND),o("WAWebMsgGetters").getQuotedMsg(e)&&c(s.EMOJI_REPLY)}}function c(t){var n=o("WAWebDailyAggregatedStatsCollection").DailyAggregatedStatsCollection.gaddForToday();switch(o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Wam:IncrementSingleEmojiEvent"]))).devConsole(t),t){case s.ANIMATED_EMOJI_SEND:n.animatedEmojiSend++;break;case s.SINGLE_EMOJI_SEND:n.singleEmojiSend++;break;case s.EMOJI_REPLY:n.emojiReply++;break}}l.maybeIncrementSingleEmojiDailyStatsCount=u}),98);
__d("WAWebEmojiVariantModel",["WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.variant=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="emojiVariant";var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebEmojiVariantCollection",["WAWebBaseCachePolicy","WAWebBaseCollection","WAWebEmoji","WAWebEmojiVariantModel","WAWebUserPrefsKeys","err"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.setVariant=function(t,n){var e=o("WAWebEmoji").EmojiUtil.getSkinToneBase(t);if(e)this.gadd({id:e,variant:n});else throw r("err")("attempt to store variantless emoji")},n.getVariant=function(t){if(o("WAWebEmoji").EmojiUtil.getSkinToneBase(t)){var e=this.get(t);return e?o("WAWebEmoji").EmojiUtil.normalizeEmoji(e.variant):null}throw r("err")("attempt to get variantless emoji")},n.getVariantIfExists=function(t){if(o("WAWebEmoji").EmojiUtil.getSkinToneBase(t)){var e=this.get(t);return e?o("WAWebEmoji").EmojiUtil.normalizeEmoji(e.variant):null}return null},t})(o("WAWebBaseCollection").BaseCollection);e.model=r("WAWebEmojiVariantModel"),e.cachePolicy={id:o("WAWebUserPrefsKeys").COLLECTIONS_KEYS.EMOJI_VARIANT_COLLECTION,policy:o("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:1e3};var s=new e;l.EmojiVariantCollection=s}),98);
__d("WAWebRecentEmojiModel",["WAWebBaseModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.weight=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="recentEmoji";var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebRecentEmojiCollection",["WAWebBaseCachePolicy","WAWebBaseCollection","WAWebEmoji","WAWebRecentEmojiModel","WAWebUserPrefsKeys","lodash"],(function(t,n,r,o,a,i,l){var e=100,s=36,u=(function(t){function n(){var n;return n=t.call(this)||this,n.dirty=!1,n.listenTo(n,"change:weight change:length",r("lodash").debounce(n._sortTrimScale,e)),n}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a._sortTrimScale=function(){var e=this.length;e&&(this.sort(),e>s&&this.remove(this.slice(s)))},a.delete=function(){t.prototype.delete.call(this),this.dirty=!1},a.increment=function(t){var e=o("WAWebEmoji").EmojiUtil.getSkinToneBase(t)||t;this.get(e)||this.add({id:e,weight:0}),this.forEach(function(t){t.id===e?t.weight+=1:t.weight*=.9}),this.dirty=!0},n})(o("WAWebBaseCollection").BaseCollection);u.cachePolicy={id:o("WAWebUserPrefsKeys").COLLECTIONS_KEYS.RECENT_EMOJI_COLLECTION,policy:o("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:2e3},u.comparator=function(e,t){return e.weight>t.weight?-1:1},u.model=r("WAWebRecentEmojiModel");var c=new u;l.RecentEmojiCollection=c}),98);
__d("WAWebCommunityActivityModel",["$InternalEnum","WATimeUtils","WAWebBaseModel","WAWebModelUtils"],(function(t,n,r,o,a,i,l){var e=n("$InternalEnum").Mirrored(["SUB_GROUP_LINK","NEW_COMMUNITY"]),s=5*o("WATimeUtils").DAY_SECONDS,u=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebModelUtils").prop(),t.communityId=o("WAWebModelUtils").prop(),t.type=o("WAWebModelUtils").prop(),t.timestamp=o("WAWebModelUtils").prop(),t.subgroupName=o("WAWebModelUtils").prop(),t.subgroupId=o("WAWebModelUtils").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);u.Proxy="communityActivity";var c=o("WAWebBaseModel").defineModel(u);l.ActivityTypeType=e,l.EXPIRATION_TIME_FOR_SUB_GROUP_LINK=s,l.CommunityActivity=c}),98);
__d("WAWebCommunityActivityCollection",["fbt","WATimeUtils","WAWebBaseCollection","WAWebChatCollection","WAWebCommunityActivityModel","WAWebDBMessageStoreUtils","WAWebGroupType","WAWebUnjoinedSubgroupMetadataCollection","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l,s){var e=(function(e){function t(){var t;return t=e.call(this)||this,t.listenTo(r("WAWebUnjoinedSubgroupMetadataCollection"),"add remove change:subject",t.$CommunityActivityCollection$p_1),t}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a.$CommunityActivityCollection$p_1=function(t){var e=this.findFirst(function(e){var n;return(n=e.subgroupId)==null?void 0:n.equals(t.id)});e!=null&&(e.subgroupName=t.subject)},a.getActivityFor=function(t){return this.filter(function(e){return e.communityId.equals(t)})},a.shouldShowTabBadge=function(){var e;if(this.length===0)return!1;var t=(e=o("WAWebUserPrefsMultiDevice").getCommunityTabLastSeenTimestamp())!=null?e:0;return this.some(function(e){return e.timestamp>t})},a.syncActivityFor=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=this,a=(t=o("WAWebUserPrefsMultiDevice").getCommunityTabLastSeenTimestamp())!=null?t:0,i=yield o("WAWebDBMessageStoreUtils").getMessagesBefore(e.toString(),function(e){return e.t<o("WATimeUtils").unixTime()-o("WAWebCommunityActivityModel").EXPIRATION_TIME_FOR_SUB_GROUP_LINK});i.length!==0&&i.forEach(function(t){if(t.author!=null){var i=o("WAWebWidFactory").createWidFromWidLike(t.author);if(!o("WAWebUserPrefsMeUser").isMeAccount(i)){var l=t.t;if(t.subtype===o("WAWebGroupType").GROUP_ACTIONS.SUB_GROUP_LINK){var u,c,d=o("WAWebWidFactory").createWidFromWidLike((u=t.templateParams)==null?void 0:u[0]),m=(c=o("WAWebChatCollection").ChatCollection.get(d))==null?void 0:c.formattedTitle;if(m==null){var p,_,f=(p=r("WAWebUnjoinedSubgroupMetadataCollection").get(d.toString()))==null?void 0:p.subject,g=(_=t.templateParams)==null?void 0:_[1];f!=null?m=f:typeof g=="string"?m=g:m=s._(/*BTDS*/"asunto desconocido").toString()}var h=new(o("WAWebCommunityActivityModel")).CommunityActivity({id:t.id,type:o("WAWebCommunityActivityModel").ActivityTypeType.SUB_GROUP_LINK,communityId:e,timestamp:l,subgroupName:m,subgroupId:d});n.addDeduppedSubgroupLink([h])}else t.subtype===o("WAWebGroupType").GROUP_ACTIONS.ADD&&l>a&&n.add({id:e.toString(),communityId:e,timestamp:l,type:o("WAWebCommunityActivityModel").ActivityTypeType.NEW_COMMUNITY})}}})});function t(t){return e.apply(this,arguments)}return t})(),a.addDeduppedSubgroupLink=function(t){var e=this,n=t.filter(function(t){return!e.some(function(e){var n;return(n=e.subgroupId)==null?void 0:n.equals(t.subgroupId)})});return this.add(n)},t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebCommunityActivityModel").CommunityActivity,e.comparator=function(e,t){return e.timestamp-t.timestamp};var u=new e;l.default=u}),226);
__d("WAWebGroupMembershipApprovalRequestCollection",["WAWebCollection","WAWebGroupMembershipApprovalRequestModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(r("WAWebCollection"));e.model=r("WAWebGroupMembershipApprovalRequestModel"),e.comparator=function(e,t){return t.t-e.t},l.default=e}),98);
__d("WAWebGroupMembershipApprovalRequestModel",["WAWebBaseModel","WAWebContactCollection","WAWebWid"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.t=o("WAWebBaseModel").prop(),t.addedBy=o("WAWebBaseModel").prop(),t.requestMethod=o("WAWebBaseModel").prop(),t.parentGroupId=o("WAWebBaseModel").prop(),t.contact=o("WAWebBaseModel").session(),t.addedByContact=o("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){e.prototype.initialize.call(this),this.addChild("contact",o("WAWebContactCollection").ContactCollection.gadd(this.id)),this.addChild("addedByContact",o("WAWebContactCollection").ContactCollection.gadd(this.addedBy))},t})(o("WAWebBaseModel").BaseModel);e.Proxy="membership_approval_request",e.idClass=r("WAWebWid");var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebGroupMetadataCollection",["Promise","WALogger","WAWebBaseCollection","WAWebChatCollection","WAWebFindGroupMetadataAction","WAWebGroupMetadataModel","WAWebIsCagGroupCache","WAWebProfilePicThumbCollection","WAWebUpdateSubgroupsCommunityAction","WAWebWid","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c=(function(t){function a(){var a;return a=t.call(this)||this,a._handleIsParentGroupChange=function(e){e.isParentGroup===!0&&o("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.update(e.id)},a.findImpl=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(r("WAWebWid").isGroup(t)){var a,i=o("WAWebChatCollection").ChatCollection.get(t);return i!=null&&i.isReadOnly&&(i==null||(a=i.groupMetadata)==null?void 0:a.stale)===!1?(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["groupMetadata: skip trying to find groupMetadata wid ",""])),t.toString()),(u||(u=n("Promise"))).resolve({id:t})):o("WAWebFindGroupMetadataAction").findGroupMetadata(t).then(function(e){return e==null?e:babelHelpers.extends({},e)})}else if(r("WAWebWid").isBroadcast(t))return(u||(u=n("Promise"))).resolve({id:t});return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["groupMetadata:find trying to fetch non-group/bclist wid ",""])),t.toString()),(u||(u=n("Promise"))).reject(r("err")("groupMetadata:find trying to fetch non-group/bclist wid "+t.toString()))});return function(e){return t.apply(this,arguments)}})(),a.listenTo(a,"add",a._handleGroupAdd),a.listenTo(a,"remove",a._handleGroupRemove),a.listenTo(a,"change:parentGroup",a._handleParentGroupChange),a.listenTo(a,"change:isParentGroup",a._handleIsParentGroupChange),a.listenTo(a,"change:defaultSubgroup",a._handleDefaultSubgroupChange),a}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i._handleGroupAdd=function(t){if(t.defaultSubgroup===!0&&r("WAWebIsCagGroupCache").add(t.id),!!t.participants.iAmMember()){var e=t.parentGroup?this.get(t.parentGroup.toString()):null;if(e!=null){var n=t.id;o("WAWebUpdateSubgroupsCommunityAction").subgroupUnjoinedToJoined(e,n)}}},i._handleGroupRemove=function(t){if(t.defaultSubgroup===!0&&r("WAWebIsCagGroupCache").remove(t.id),!!t.participants.iAmMember()){var e=t.parentGroup?this.get(t.parentGroup.toString()):null;e!=null&&o("WAWebUpdateSubgroupsCommunityAction").updateJoinedSubgroups(e)}},i._handleParentGroupChange=function(t,n,r){if(t.participants.iAmMember()){var e=t.id,a=n!=null?this.get(n.toString()):null,i=r!=null?this.get(r.toString()):null;a!=null?(o("WAWebUpdateSubgroupsCommunityAction").subgroupUnjoinedToJoined(a,e),i!=null&&o("WAWebUpdateSubgroupsCommunityAction").updateJoinedSubgroups(i)):i!=null&&o("WAWebUpdateSubgroupsCommunityAction").unlinkParentGroup(i,e)}},i._handleDefaultSubgroupChange=function(t,n){n===!0?r("WAWebIsCagGroupCache").add(t.id):r("WAWebIsCagGroupCache").remove(t.id)},a})(o("WAWebBaseCollection").BaseCollection);c.model=r("WAWebGroupMetadataModel"),c.staleCollection=!0;var d=new c;l.default=d}),98);
__d("WAWebGroupMetadataModel",["fbt","Promise","WALogger","WAShiftTimer","WAWebBaseModel","WAWebChatCollection","WAWebCommunityGatingUtils","WAWebContactCollection","WAWebFrontendContactGetters","WAWebGroupMembershipApprovalRequestCollection","WAWebGroupMetadataCollection","WAWebGroupParticipantCollection","WAWebGroupPendingParticipantCollection","WAWebGroupType","WAWebInviteV4QueryGroupAction","WAWebMiscGatingUtils","WAWebPastParticipantCollection","WAWebSchemaGroupMetadata","WAWebSubgroupSuggestionCollection","WAWebUnjoinedSubgroupMetadataCollection","WAWebUnreadMentionMetadataModel","WAWebUpdateSubgroupsCommunityAction","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l,s){var e,u,c="https://chat.whatsapp.com/",d=(function(t){function a(){for(var e,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a))||this,e.participants=o("WAWebBaseModel").collection(r("WAWebGroupParticipantCollection")),e.pendingParticipants=o("WAWebBaseModel").collection(r("WAWebGroupPendingParticipantCollection")),e.pastParticipants=o("WAWebBaseModel").collection(r("WAWebPastParticipantCollection")),e.membershipApprovalRequests=o("WAWebBaseModel").collection(r("WAWebGroupMembershipApprovalRequestCollection")),e.subgroupSuggestions=o("WAWebBaseModel").collection(r("WAWebSubgroupSuggestionCollection")),e.id=o("WAWebBaseModel").prop(),e.creation=o("WAWebBaseModel").prop(),e.owner=o("WAWebBaseModel").prop(),e.subject=o("WAWebBaseModel").prop(),e.subjectTime=o("WAWebBaseModel").prop(),e.desc=o("WAWebBaseModel").prop(),e.descId=o("WAWebBaseModel").prop(),e.descTime=o("WAWebBaseModel").prop(),e.descOwner=o("WAWebBaseModel").prop(),e.restrict=o("WAWebBaseModel").prop(),e.announce=o("WAWebBaseModel").prop(),e.noFrequentlyForwarded=o("WAWebBaseModel").prop(),e.ephemeralDuration=o("WAWebBaseModel").prop(),e.disappearingModeTrigger=o("WAWebBaseModel").prop(),e.disappearingModeInitiatedByMe=o("WAWebBaseModel").prop(),e.membershipApprovalMode=o("WAWebBaseModel").prop(),e.memberAddMode=o("WAWebBaseModel").prop(),e.memberLinkMode=o("WAWebBaseModel").prop(),e.growthLockExpiration=o("WAWebBaseModel").prop(),e.growthLockType=o("WAWebBaseModel").prop(),e.reportToAdminMode=o("WAWebBaseModel").prop(),e.size=o("WAWebBaseModel").prop(),e.numSubgroups=o("WAWebBaseModel").prop(),e.support=o("WAWebBaseModel").prop(),e.suspended=o("WAWebBaseModel").prop(!1),e.terminated=o("WAWebBaseModel").prop(!1),e.uniqueShortNameMap=o("WAWebBaseModel").prop(),e.isLidAddressingMode=o("WAWebBaseModel").prop(),e.isParentGroup=o("WAWebBaseModel").prop(),e.isParentGroupClosed=o("WAWebBaseModel").prop(),e.parentGroup=o("WAWebBaseModel").prop(),e.defaultSubgroup=o("WAWebBaseModel").prop(),e.generalSubgroup=o("WAWebBaseModel").prop(),e.hiddenSubgroup=o("WAWebBaseModel").prop(),e.groupSafetyCheck=o("WAWebBaseModel").prop(),e.groupAdder=o("WAWebBaseModel").prop(),e.generalChatAutoAddDisabled=o("WAWebBaseModel").prop(),e.lastCommunityPollTimestamp=o("WAWebBaseModel").prop(),e.unjoinedSubgroups=o("WAWebBaseModel").session(function(){return[]}),e.joinedSubgroups=o("WAWebBaseModel").session(function(){return[]}),e.allowNonAdminSubGroupCreation=o("WAWebBaseModel").prop(),e.lastActivityTimestamp=o("WAWebBaseModel").prop(),e.lastSeenActivityTimestamp=o("WAWebBaseModel").prop(),e.lastReportToAdminTimestamp=o("WAWebBaseModel").prop(),e.hasCapi=o("WAWebBaseModel").prop(),e.stale=o("WAWebBaseModel").session(!0),e.deviceStale=o("WAWebBaseModel").session(!1),e.trusted=o("WAWebBaseModel").session(!0),e.inviteCode=o("WAWebBaseModel").session(),e.groupInviteCodePromise=o("WAWebBaseModel").session(),e.revokeGroupInvitePromise=o("WAWebBaseModel").session(),e.participantQueryPromise=o("WAWebBaseModel").session(),e.deviceQueryPromise=o("WAWebBaseModel").session(),e.unjoinedSubgroupsQueryPromise=o("WAWebBaseModel").session(),e.displayedDesc=o("WAWebBaseModel").session(""),e.revokeGroupsV4AddInvitePromise=o("WAWebBaseModel").session(),e.groupInviteLink=o("WAWebBaseModel").derived(function(){return this.inviteCode?""+c+this.inviteCode:null},["inviteCode"]),e.cachedDeviceCount=o("WAWebBaseModel").session(),e.cachedDeviceSizeBucket=o("WAWebBaseModel").session(),e.groupType=o("WAWebBaseModel").derived(function(){return this.defaultSubgroup===!0?o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP:this.generalSubgroup===!0?o("WAWebGroupType").GroupType.LINKED_GENERAL_GROUP:this.parentGroup!=null?o("WAWebGroupType").GroupType.LINKED_SUBGROUP:this.isParentGroup===!0?o("WAWebGroupType").GroupType.COMMUNITY:o("WAWebGroupType").GroupType.DEFAULT},["parentGroup","isParentGroup","defaultSubgroup","generalSubgroup"]),e.isCag=o("WAWebBaseModel").derived(function(){return this.groupType===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP},["groupType"]),e.isUnnamed=o("WAWebBaseModel").derived(function(){return this.subject===""},["subject"]),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.isNonAdminAndACAGJREnabled=function(){var e,t=!this.participants.iAmAdmin(),n=this.participants.iAmMember(),r=this.memberAddMode===o("WAWebSchemaGroupMetadata").MemberAddMode.ALL_MEMBER_ADD,a=(e=this.membershipApprovalMode)!=null?e:!1;return t&&n&&r&&a},i.hasUniqueShortNameMention=function(t){var e;if(!this.uniqueShortNameMap||!t.shortName||!o("WAWebFrontendContactGetters").getIsMyContact(t))return!1;var n=this.$GroupMetadata$p_2(t.shortName);return(e=this.uniqueShortNameMap.get(n))!=null?e:!1},i.$GroupMetadata$p_2=function(t){return t.toLowerCase().trim()},i.isSuspendedOrTerminated=function(){return this.suspended||this.terminated},i.delete=function(){t.prototype.delete.call(this),this.getCollection().remove(this.id),this.participants.delete()},i.canSetSubject=function(){return this.isSuspendedOrTerminated()||this.groupType===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP?!1:this.groupType===o("WAWebGroupType").GroupType.COMMUNITY?this.participants.iAmAdmin():this.participants.iAmMember()?this.participants.iAmAdmin()?!this.support:this.restrict===!0?!1:!this.support:!1},i.canSetDescription=function(){return!this.participants.iAmMember()||!this.participants.iAmAdmin()&&this.restrict||this.isSuspendedOrTerminated()||(this.groupType===o("WAWebGroupType").GroupType.COMMUNITY||this.groupType===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP)&&!this.participants.iAmAdmin()?!1:!this.support},i.searchMatch=function(t){var e;if(t==null)return!1;var n=this.id,r=(e=o("WAWebChatCollection").ChatCollection.get(n))==null?void 0:e.formattedTitle;return!!(r!=null&&r.toLowerCase().includes(t))},i.canSetGroupProperty=function(){return this.isSuspendedOrTerminated()||this.groupType===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP?!1:this.participants.iAmAdmin()?!this.support:!1},i.userCanSetEphemeralSetting=function(t){var e=!this.support;if(this.isSuspendedOrTerminated())return!1;if(t.isUser()){if(!this.participants.userIsMember(t))return!1;if(this.participants.userIsAdmin(t))return e}return this.restrict||this.groupType===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP?!1:e},i.canSetEphemeralSetting=function(){var e=this;return o("WAWebUserPrefsMeUser").getMePNandLIDWids().some(function(t){return e.userCanSetEphemeralSetting(o("WAWebWidFactory").asUserWidOrThrow(t))})},i.initialize=function(){var e=this;o("WAWebBaseModel").BaseModel.prototype.initialize.call(this),this.listenTo(this.participants,"change:isAdmin change:isSuperAdmin change:contact.isMyContact sort remove reset",function(){e.isTrusted(),e.$GroupMetadata$p_3()}),this.listenTo(this.participants,"bulk_add bulk_remove reset",this.triggerParticipantsChange),this.listenTo(this,"change:owner",this.isTrusted),this.listenTo(this,"change:isParentGroup",this.$GroupMetadata$p_4),this.listenTo(this,"change:desc",this.$GroupMetadata$p_3),this.listenTo(this,"change:groupType",this.$GroupMetadata$p_3),this.$GroupMetadata$p_3(),this.isTrusted(),this.$GroupMetadata$p_1=this.$GroupMetadata$p_5(),this.listenTo(this.participants,"change:contact.shortName",this.$GroupMetadata$p_6),this.uniqueShortNameMap=new Map,this.unreadMentionMetadata=new(r("WAWebUnreadMentionMetadataModel")),this.groupType===o("WAWebGroupType").GroupType.COMMUNITY&&this.$GroupMetadata$p_4()},i.$GroupMetadata$p_6=function(){var e;(e=this.$GroupMetadata$p_1)==null||e.debounce(a.UPDATE_NAME_MAP_DEBOUNCE_TIME)},i.triggerParticipantsChange=function(){if(o("WAWebMiscGatingUtils").isDropLastNameEnabled()){var e;(e=this.$GroupMetadata$p_1)==null||e.debounce(a.UPDATE_NAME_MAP_DEBOUNCE_TIME)}this.trigger("change:participants")},i.$GroupMetadata$p_5=function(){var e=this;return new(o("WAShiftTimer")).ShiftTimer(function(){if(o("WAWebMiscGatingUtils").isDropLastNameEnabled()){var t=new Map;e.participants&&e.participants.forEach(function(n){if(n.contact.shortName&&o("WAWebFrontendContactGetters").getIsMyContact(n.contact)){var r=e.$GroupMetadata$p_2(n.contact.shortName);t.has(r)?t.set(r,!1):t.set(r,!0)}}),e.uniqueShortNameMap=t}})},i.$GroupMetadata$p_7=function(){return this.participants.some(function(e){return e.isAdmin&&o("WAWebFrontendContactGetters").getIsMyContact(e.contact)})},i.isTrusted=function(){if(this.stale)return this.trusted;if(this.support)return this.trusted=!0;if(this.owner){if(o("WAWebUserPrefsMeUser").isMeAccount(this.owner))return this.trusted=!0;var e=o("WAWebContactCollection").ContactCollection.get(this.owner);if(e!=null&&o("WAWebFrontendContactGetters").getIsMyContact(e))return this.trusted=!0}if(this.groupAdder!=null){var t=o("WAWebContactCollection").ContactCollection.get(this.groupAdder);if(t!=null&&o("WAWebFrontendContactGetters").getIsMyContact(t))return this.trusted=!0}return this.$GroupMetadata$p_7()?this.trusted=!0:this.trusted=!1},i.hasJoined=function(){var e=this.id,t=this.groupType,n=this.joinedSubgroups;if(t===o("WAWebGroupType").GroupType.COMMUNITY)return n.length>0;var r=o("WAWebChatCollection").ChatCollection.get(e);return r?r.isReadOnly===!1:!1},i.$GroupMetadata$p_3=function(){this.groupType===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&!this.canSetDescription()&&(this.desc==null||this.desc==="")?this.displayedDesc=s._(/*BTDS*/"Recibe los avisos m\u00e1s recientes de quienes administran esta comunidad.").toString():this.displayedDesc=this.desc},i.$GroupMetadata$p_4=function(){o("WAWebUpdateSubgroupsCommunityAction").updateJoinedSubgroups(this),o("WAWebUpdateSubgroupsCommunityAction").updateUnjoinedSubgroups(this)},i.revokeGroupsV4AddInvite=function(r){var t=this;if(this.revokeGroupsV4AddInvitePromise)return this.revokeGroupsV4AddInvitePromise;var a=o("WAWebWidToJid").widToGroupJid(this.id),i=this.pendingParticipants,l=(u||(u=n("Promise"))).resolve();return l=o("WAWebInviteV4QueryGroupAction").revokeGroupInviteV4(r,a),this.revokeGroupsV4AddInvitePromise=l.then(function(e){return e.status>=200&&e.status<300&&i.remove(r),e.status}).catch(function(t){return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["models:groupMetadata:participantCollection:revokeGroupsV4AddInvite failed"]))).devConsole(t),500}).finally(function(){t.revokeGroupsV4AddInvitePromise=null})},i.queryGroupsV4PendingInvite=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=this,t=yield o("WAWebInviteV4QueryGroupAction").getPendingParticipants(this.id,this.isLidAddressingMode===!0);t.forEach(function(t){e.pendingParticipants.add({id:o("WAWebWidFactory").createUserWidOrThrow(t)})})});function t(){return e.apply(this,arguments)}return t})(),i.getJoinedSubgroupsMetadata=function(){var e=this.getCollection();return this.joinedSubgroups.map(function(t){return e.get(t.toString())}).filter(Boolean)},i.getJoinedSubgroupsChat=function(){return this.joinedSubgroups.map(function(e){return o("WAWebChatCollection").ChatCollection.get(e.toString())}).filter(Boolean)},i.getUnjoinedSubgroupsMetadata=function(){var e=this.getUnjoinedCollection();return this.unjoinedSubgroups.map(function(t){return e.get(t.toString())}).filter(Boolean)},i.getSubgroupsMetadata=function(){return[].concat(this.getJoinedSubgroupsMetadata(),this.getUnjoinedSubgroupsMetadata())},i.getSubgroupSuggestions=function(){var e=new Set;return this.subgroupSuggestions.filter(function(t){var n=t.groupId,r=t.isExistingGroup;return e.has(n.toString())?!1:e.add(n.toString())&&!(r&&!o("WAWebCommunityGatingUtils").memberSuggestedGroupsM3ReceiverEnabled())})},i.getParentGroupChat=function(){var e=this.parentGroup;if(e)return o("WAWebChatCollection").ChatCollection.get(e)},i.isParentGroupParticipant=function(){var e=this.parentGroup;if(!e)return!1;var t=this.getCollection().get(e);return!!(t!=null&&t.joinedSubgroups.length)},i.getUnjoinedCollection=function(){return r("WAWebUnjoinedSubgroupMetadataCollection")},i.getCollection=function(){return r("WAWebGroupMetadataCollection")},a})(o("WAWebBaseModel").BaseModel);d.Proxy="groupMetadata",d.idClass=r("WAWebWid"),d.UPDATE_NAME_MAP_DEBOUNCE_TIME=200;var m=o("WAWebBaseModel").defineModel(d);l.default=m}),226);
__d("WAWebGroupParticipantComparator",["WAWebContactComparator"],(function(t,n,r,o,a,i,l){var e=function(t,n){return o("WAWebContactComparator").ContactComparator(t.contact,n.contact)},s=e;l.default=s}),98);
__d("WAWebGroupParticipantCollection",["WAWebApiContact","WAWebChatCollection","WAWebCollection","WAWebContactCollection","WAWebFrontendContactGetters","WAWebGroupMetadataCollection","WAWebGroupParticipantComparator","WAWebGroupParticipantModel","WAWebGroupType","WAWebHostedGroupUtils","WAWebL10N","WAWebProfilePicPrivacyTokenGating","WAWebSchemaGroupMetadata","WAWebSendForNeededAddRequest","WAWebUpdateSubgroupsCommunityAction","WAWebUserPrefsMeUser","WAWebWidFactory","lodash"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(t,n){var a;return n===void 0&&(n={}),a=e.call(this,t,n)||this,a.$ParticipantCollection$p_2=function(e,t,n){a.$ParticipantCollection$p_3(e),o("WAWebProfilePicPrivacyTokenGating").isProfilePicIQPrivacyTokenEnabled()&&n.add===!0&&a.$ParticipantCollection$p_4(e)},a.$ParticipantCollection$p_4=function(e){if(o("WAWebProfilePicPrivacyTokenGating").isProfilePicIQPrivacyTokenEnabled()&&a.iAmMember()){var t=o("WAWebChatCollection").ChatCollection.get(a.parent.id);t&&(t==null?void 0:t.tcToken)==null&&(e==null||e.contact.set({maybeCommonGroupChatModel:t},{isSilent:!0}))}},a.$ParticipantCollection$p_3=function(e){var t,n;if(!(!e||!o("WAWebUserPrefsMeUser").isMeAccount(e.id))){var r=a.parent.id,i=r?(t=o("WAWebChatCollection").ChatCollection.get(r.toString()))==null?void 0:t.groupMetadata:null,l=i==null||(n=i.getParentGroupChat())==null?void 0:n.groupMetadata;l!=null&&(a.iAmMember()?o("WAWebUpdateSubgroupsCommunityAction").subgroupUnjoinedToJoined(l,r):o("WAWebUpdateSubgroupsCommunityAction").subgroupJoinedToUnjoined(l,r))}},a.$ParticipantCollection$p_1=r("lodash").debounce(function(){return a.sort()},1e3),a.sendForNeededAddRequest=function(e){var t,n,r,i=a.getChat(),l=a.getGroupMetadata(),s=(t=l==null?void 0:l.desc)!=null?t:"",u=(n=(r=i==null?void 0:i.formattedTitle)!=null?r:i==null?void 0:i.name)!=null?n:"";o("WAWebSendForNeededAddRequest").sendForNeededAddRequest(e,u,s,a.parent.id)},a.listenTo(a,"change:contact.name",a.$ParticipantCollection$p_1),a.listenTo(r("WAWebL10N"),"locale_change",a.$ParticipantCollection$p_1),a.listenTo(a,"add remove",a.$ParticipantCollection$p_2),a}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.delete=function(){this.forEach(function(e){e.delete()}),this.stopListening(),this.reset()},n.ensureSorted=function(){this.$ParticipantCollection$p_1.flush()},n.set=function(n,r){var t=r||{};t.isParticipantCollectionAdd!==!0&&(t=babelHelpers.extends({},t,{remove:!0}));var o=e.prototype.set.call(this,n,t);return this.trigger("bulk_add",o),t.remove===!0&&this.trigger("bulk_remove",o),o},n.add=function(n,r){var t=r||{};t=babelHelpers.extends({},t,{isParticipantCollectionAdd:!0});var o=e.prototype.add.call(this,n,t);return this.trigger("bulk_add",o),o},n.remove=function(n,r){var t=r||{},o=e.prototype.remove.call(this,n,t);return this.trigger("bulk_remove",o),o},n.canAdd=function(){if(this.iAmAdmin())return!0;var e=this.getGroupMetadata();return this.iAmMember()&&(e==null?void 0:e.memberAddMode)===o("WAWebSchemaGroupMetadata").MemberAddMode.ALL_MEMBER_ADD},n.canTransferOwnership=function(t){if(o("WAWebUserPrefsMeUser").isMeAccount(t.id)||!this.iAmSuperAdmin()||!t.isAdmin)return!1;var e=this.getGroupMetadata();return(e==null?void 0:e.groupType)===o("WAWebGroupType").GroupType.COMMUNITY},n.canPromote=function(t){if(!t||o("WAWebUserPrefsMeUser").isMeAccount(t.id)||!this.iAmAdmin()||t.isAdmin)return!1;var e=this.getGroupMetadata();return!(e!=null&&e.isCag)},n.canDemote=function(t){if(!t||!this.iAmAdmin())return!1;var e=this.getGroupMetadata();if((e==null?void 0:e.groupType)!==o("WAWebGroupType").GroupType.COMMUNITY&&(e==null?void 0:e.groupType)!==o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&o("WAWebUserPrefsMeUser").isMeAccount(t.id))return!1;var n=t.isSuperAdmin;return n?(e==null?void 0:e.groupType)===o("WAWebGroupType").GroupType.COMMUNITY||(e==null?void 0:e.groupType)===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP?o("WAWebUserPrefsMeUser").isMeAccount(t.id):!1:!(!t.isAdmin||(e==null?void 0:e.groupType)===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP)},n.canRemove=function(t){if(!t||o("WAWebUserPrefsMeUser").isMeAccount(t.id)||!this.iAmAdmin())return!1;var e=this.getGroupMetadata();return!(e!=null&&e.isCag&&(t.isAdmin||t.isSuperAdmin))},n.canVerifyIdentity=function(t){var e;if(!t||o("WAWebUserPrefsMeUser").isMeAccount(t.id))return!1;var n=this.getGroupMetadata();return!(o("WAWebHostedGroupUtils").isWAHostedGroupEnabled()&&(n==null?void 0:n.hasCapi)===!0&&t.id.toString()===(n==null||(e=n.owner)==null?void 0:e.toString()))},n.userIsMember=function(t){return this.isParticipantWidOrAlternateWidValid(t,function(e){return e!=null})},n.userIsAdmin=function(t){return this.isParticipantWidOrAlternateWidValid(t,function(e){return(e==null?void 0:e.isAdmin)===!0})},n.userIsSuperAdmin=function(t){return this.isParticipantWidOrAlternateWidValid(t,function(e){return(e==null?void 0:e.isSuperAdmin)===!0})},n.isParticipantWidOrAlternateWidValid=function(t,n){var e=this.get(t);if(n(e))return!0;var r=o("WAWebApiContact").getAlternateUserWid(o("WAWebWidFactory").asUserWidOrThrow(t)),a=r?this.get(r):null;return n(a)},n.iAmMember=function(){var e=this.getMeParticipant();return!!e},n.iAmRestrictedMember=function(){var e=this.getGroupMetadata(),t=(e==null?void 0:e.restrict)===!0;return t&&!this.iAmAdmin()},n.iAmAdmin=function(){var e=this.getMeParticipant();return(e==null?void 0:e.isAdmin)===!0},n.iAmSuperAdmin=function(){var e=this.getMeParticipant();return(e==null?void 0:e.isSuperAdmin)===!0},n.getAdmins=function(){return this.where({isAdmin:!0})},n.getSuperAdmin=function(){return this.findFirst(function(e){return e.isSuperAdmin})},n.getMyContacts=function(){return this.filter(function(e){var t=o("WAWebContactCollection").ContactCollection.get(e.id);return t!=null&&o("WAWebFrontendContactGetters").getIsMyContact(t)})},n.getMeParticipant=function(){var e;return(e=this.get(o("WAWebUserPrefsMeUser").getMePnUserOrThrow()))!=null?e:this.get(o("WAWebUserPrefsMeUser").getMeLidUserOrThrow())},n.getChat=function(){var e=this.parent.id;return o("WAWebChatCollection").ChatCollection.get(e)},n.getGroupMetadata=function(){var e=this.parent.id;return r("WAWebGroupMetadataCollection").get(e)},t})(r("WAWebCollection"));e.model=r("WAWebGroupParticipantModel"),e.comparator=r("WAWebGroupParticipantComparator"),l.default=e}),98);
__d("WAWebGroupParticipantModel",["WAWebBaseModel","WAWebContactCollection","WAWebWid"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.isAdmin=o("WAWebBaseModel").prop(),t.isSuperAdmin=o("WAWebBaseModel").prop(),t.leaveTs=o("WAWebBaseModel").prop(),t.leaveReason=o("WAWebBaseModel").prop(),t.contact=o("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){e.prototype.initialize.call(this),this.addChild("contact",o("WAWebContactCollection").ContactCollection.gadd(this.id))},t})(o("WAWebBaseModel").BaseModel);e.Proxy="participant",e.idClass=r("WAWebWid");var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebGroupPendingParticipantCollection",["WAWebCollection","WAWebGroupParticipantComparator","WAWebGroupParticipantModel","WAWebL10N","lodash"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(t,n){var o;return n===void 0&&(n={}),o=e.call(this,t,n)||this,o.$PendingParticipantCollection$p_1=r("lodash").debounce(function(){return o.sort()},1e3),o.listenTo(o,"change:contact.name",o.$PendingParticipantCollection$p_1),o.listenTo(r("WAWebL10N"),"locale_change",o.$PendingParticipantCollection$p_1),o}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.delete=function(){this.forEach(function(e){e.delete()}),this.stopListening(),this.reset()},n.ensureSorted=function(){this.$PendingParticipantCollection$p_1.flush()},n.set=function(n,r){return r===void 0&&(r={}),r.isParticipantCollectionAdd!==!0&&(r.remove=!0),e.prototype.set.call(this,n,r)},n.add=function(n,r){return r===void 0&&(r={}),r.isParticipantCollectionAdd=!0,e.prototype.add.call(this,n,r)},t})(r("WAWebCollection"));e.model=r("WAWebGroupParticipantModel"),e.comparator=r("WAWebGroupParticipantComparator"),l.default=e}),98);
__d("WAWebPastParticipantCollection",["WATimeUtils","WAWebCollection","WAWebGroupConstants","WAWebGroupParticipantModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getValidRecords=function(){return this.filter(function(e){var t=o("WATimeUtils").castToUnixTime(e.leaveTs),n=o("WATimeUtils").DAY_SECONDS*o("WAWebGroupConstants").PAST_PARTICIPANT_EXPIRATION_DAYS;return o("WATimeUtils").happenedWithin(t,n)})},t})(r("WAWebCollection"));e.model=r("WAWebGroupParticipantModel"),e.comparator=function(e,t){return t.leaveTs-e.leaveTs},l.default=e}),98);
__d("WAWebSubgroupSuggestionCollection",["WAWebBaseCollection","WAWebSubgroupSuggestionModel"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);e.model=r("WAWebSubgroupSuggestionModel"),e.comparator=function(e,t){return e.t-t.t},l.default=e}),98);
__d("WAWebCellRequestState",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["Pending","Loading","Approved","Rejected","Canceled","Error"]);i.State=e}),66);
__d("WAWebSubgroupSuggestionModel",["WAWebBaseModel","WAWebCellRequestState","WAWebContactCollection"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.groupId=o("WAWebBaseModel").prop(),t.parentGroupId=o("WAWebBaseModel").prop(),t.subject=o("WAWebBaseModel").prop(),t.desc=o("WAWebBaseModel").prop(),t.owner=o("WAWebBaseModel").prop(),t.t=o("WAWebBaseModel").prop(),t.isExistingGroup=o("WAWebBaseModel").prop(),t.participantCount=o("WAWebBaseModel").prop(),t.hiddenSubgroup=o("WAWebBaseModel").prop(),t.ownerContact=o("WAWebBaseModel").session(),t.currentState=o("WAWebBaseModel").session(),t.error=o("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){e.prototype.initialize.call(this),this.addChild("ownerContact",o("WAWebContactCollection").ContactCollection.gadd(this.owner)),this.resetState()},n.resetState=function(){this.currentState=o("WAWebCellRequestState").State.Pending,this.error=void 0},t})(o("WAWebBaseModel").BaseModel);e.Proxy="subgroup_suggestion";var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebUnjoinedSubgroupMetadataCollection",["WAWebBaseCollection","WAWebGroupMetadataCollection","WAWebUnjoinedSubgroupMetadataModel","WAWebUpdateSubgroupsCommunityAction"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){var t;return t=e.call(this)||this,t.listenTo(t,"add",t.$UnjoinedSubgroupMetadataCollection$p_1),t.listenTo(t,"remove",t.$UnjoinedSubgroupMetadataCollection$p_1),t.listenTo(t,"change:parentGroupId",t.$UnjoinedSubgroupMetadataCollection$p_2),t}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.$UnjoinedSubgroupMetadataCollection$p_3=function(t){t&&o("WAWebUpdateSubgroupsCommunityAction").updateUnjoinedSubgroups(t)},n.$UnjoinedSubgroupMetadataCollection$p_1=function(t){var e=r("WAWebGroupMetadataCollection").get(t.parentGroupId.toString());this.$UnjoinedSubgroupMetadataCollection$p_3(e)},n.$UnjoinedSubgroupMetadataCollection$p_2=function(t,n,o){var e=n!=null?r("WAWebGroupMetadataCollection").get(n.toString()):null,a=o!=null?r("WAWebGroupMetadataCollection").get(o.toString()):null;this.$UnjoinedSubgroupMetadataCollection$p_3(e),this.$UnjoinedSubgroupMetadataCollection$p_3(a)},t})(o("WAWebBaseCollection").BaseCollection);e.model=r("WAWebUnjoinedSubgroupMetadataModel");var s=new e;l.default=s}),98);
__d("WAWebUnjoinedSubgroupMetadataModel",["fbt","WAWebBaseModel","WAWebGroupParticipantCollection","WAWebGroupType","WAWebWid"],(function(t,n,r,o,a,i,l,s){var e=(function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a))||this,t.id=o("WAWebBaseModel").prop(),t.subject=o("WAWebBaseModel").prop(),t.subjectTime=o("WAWebBaseModel").prop(),t.parentGroupId=o("WAWebBaseModel").prop(),t.defaultSubgroup=o("WAWebBaseModel").prop(),t.generalSubgroup=o("WAWebBaseModel").prop(),t.desc=o("WAWebBaseModel").prop(),t.creation=o("WAWebBaseModel").prop(),t.owner=o("WAWebBaseModel").prop(),t.size=o("WAWebBaseModel").prop(),t.adminRequestRequired=o("WAWebBaseModel").prop(),t.membershipApprovalMode=o("WAWebBaseModel").prop(),t.membershipApprovalRequest=o("WAWebBaseModel").prop(),t.hiddenSubgroup=o("WAWebBaseModel").prop(),t.suspended=o("WAWebBaseModel").prop(),t.participants=o("WAWebBaseModel").collection(r("WAWebGroupParticipantCollection")),t.groupType=o("WAWebBaseModel").derived(function(){return this.defaultSubgroup===!0?o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP:this.generalSubgroup===!0?o("WAWebGroupType").GroupType.LINKED_GENERAL_GROUP:o("WAWebGroupType").GroupType.LINKED_SUBGROUP},["defaultSubgroup","generalSubgroup"]),t.displayedDesc=o("WAWebBaseModel").derived(function(){return this.groupType===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&(this.desc==null||this.desc==="")?s._(/*BTDS*/"Recibe los avisos m\u00e1s recientes de quienes administran esta comunidad.").toString():this.desc},["desc","groupType"]),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseModel").BaseModel);e.Proxy="unjoinedSubgroupMetadata",e.idClass=r("WAWebWid");var u=o("WAWebBaseModel").defineModel(e);l.default=u}),226);
__d("WAWebUnreadMentionMetadataModel",["WAWebBaseModel","WAWebChatUnreadMentionCollection"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.unreadMentionCollection=o("WAWebBaseModel").prop(),t.pendingUnreadMentionCount=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){this.unreadMentionCollection=new(r("WAWebChatUnreadMentionCollection")),this.pendingUnreadMentionCount=0},n.hasMentionId=function(t){return this.unreadMentionCollection.get(t)!=null},n.addUnreadMentions=function(t,n){this.unreadMentionCollection.add(t)},n.removeUnreadMentions=function(t){this.unreadMentionCollection.remove(t)},n.oldestUnreadMention=function(){return this.unreadMentionCollection.oldestUnreadMention()},n.reset=function(){this.pendingUnreadMentionCount=0,this.unreadMentionCollection.reset()},n.getUnreadMentionCount=function(){return this.pendingUnreadMentionCount+this.unreadMentionCollection.length},t})(o("WAWebBaseModel").BaseModel),s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebCarouselCardsCollection",["WAWebBaseCollection","WAWebMsgModel"],(function(t,n,r,o,a,i,l){function e(e){throw new TypeError('"'+e+'" is read-only')}var s=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.clone=function(){var e=new t;return e.add(this.slice()),e},n.getCardsById=function(){var e={};return this.forEach(function(t){e[t.id.toString()]=t}),e},t})(o("WAWebBaseCollection").BaseCollection);s.model=o("WAWebMsgModel").Msg,l.default=s}),98);
__d("WAWebCarouselMsgUtils",["WALogger","WAWebMsgCollection"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(t){if(!t.isCarouselCard){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getParentMsgFromCarouselCard called on non carousel card."]))).sendLogs("getParentMsgFromCarouselCard-error");return}if(t.parentMsgId==null){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["parentMsgId is null on carousel card."]))).sendLogs("getParentMsgFromCarouselCard-error");return}var n=o("WAWebMsgCollection").MsgCollection.get(t.parentMsgId);return n==null&&o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Could not find parent msg (id=",") for carousel card."])),t.parentMsgId).sendLogs("getParentMsgFromCarouselCard-error"),n}function d(e){var t=[],n=function(n){return t.push(n)};for(var r of e)r.carouselCards!=null?r.carouselCards.forEach(n):n(r);return t}l.getParentMsgFromCarouselCard=c,l.flattenMsgs=d}),98);
__d("WAWebSettingsFBT",["fbt","WAWebABProps","WAWebBizGatingUtils","WAWebConnModel"],(function(t,n,r,o,a,i,l,s){function e(){return s._(/*BTDS*/"Fondo del chat")}function u(){return s._(/*BTDS*/"Solicitar info. de mi cuenta")}function c(){return s._(/*BTDS*/"Reportes de canales")}function d(){return s._(/*BTDS*/"Herramientas para la empresa")}function m(){return s._(/*BTDS*/"Perfil de empresa")}function p(){return s._(/*BTDS*/"Cat\u00e1logo")}function _(){return s._(/*BTDS*/"Pedidos")}function f(){return s._(/*BTDS*/"Anunciar")}function g(){return s._(/*BTDS*/"Respuestas r\u00e1pidas")}function h(){return s._(/*BTDS*/"Etiquetas")}function y(){return s._(/*BTDS*/"Centro de ayuda para empresas")}function C(){return s._(/*BTDS*/"Notificaciones")}function b(){var e=o("WAWebABProps").getABPropConfigValue("wa_web_enable_granular_notifications");return e?s._(/*BTDS*/"Mensajes, grupos, sonidos"):s._(/*BTDS*/"Notificaciones de mensajes")}function v(){return s._(/*BTDS*/"Idioma y hora")}function S(){return s._(/*BTDS*/"Usa este ajuste para reemplazar el idioma establecido en tu tel\u00e9fono.")}function R(){return s._(/*BTDS*/"Idioma")}function L(){return s._(/*BTDS*/"Formato de hora")}function E(){return s._(/*BTDS*/"Descarga autom\u00e1tica de archivos multimedia")}function k(){return s._(/*BTDS*/"Calidad de subida de los archivos multimedia")}function I(){return s._(/*BTDS*/"Seguridad")}function T(){return s._(/*BTDS*/"Privacidad")}function D(){return s._(/*BTDS*/"Contactos bloqueados, mensajes temporales")}function x(){return o("WAWebABProps").getABPropConfigValue("public_bug_reporting_settings")?s._(/*BTDS*/"Ayuda y comentarios"):s._(/*BTDS*/"Ayuda")}function $(){return s._(/*BTDS*/"Centro de ayuda, cont\u00e1ctanos, pol\u00edtica de privacidad")}function P(){return s._(/*BTDS*/"Atajos del teclado")}function N(){return s._(/*BTDS*/"Acciones r\u00e1pidas")}function M(){return s._(/*BTDS*/"Developer")}function w(){return s._(/*BTDS*/"Internal tools, feature flags, debug options")}function A(){return s._(/*BTDS*/"AB Props")}function F(){return s._(/*BTDS*/"Infra Settings")}function O(){return s._(/*BTDS*/"WWW Settings")}function B(){return s._(/*BTDS*/"Notificaciones de mensajes")}function W(){return s._(/*BTDS*/"Se muestran notificaciones de mensajes nuevos.")}function q(){return s._(/*BTDS*/"Mostrar vista previa")}function U(){return s._(/*BTDS*/"Muestra una vista previa del texto en las notificaciones de mensajes.")}function V(){return s._(/*BTDS*/"Sincroniza los mensajes en segundo plano para obtener un rendimiento m\u00e1s r\u00e1pido")}function H(){return s._(/*BTDS*/"Se reproduce un sonido cuando hay mensajes salientes")}function G(){return s._(/*BTDS*/"Mostrar notificaciones de reacciones")}function z(){return s._(/*BTDS*/"Notificaciones de llamadas")}function j(){return s._(/*BTDS*/"Muestra notificaciones para las llamadas entrantes.")}function K(){return s._(/*BTDS*/"Llamadas entrantes")}function Q(){return s._(/*BTDS*/"Reproduce sonidos para las llamadas entrantes.")}function X(){return s._(/*BTDS*/"Sonidos para mensajes entrantes")}function Y(){return s._(/*BTDS*/"Se reproduce un sonido cuando hay mensajes entrantes.")}function J(){return s._(/*BTDS*/"Hora de \u00falt. vez y En l\u00ednea")}function Z(){return s._(/*BTDS*/"Qui\u00e9n puede ver mi informaci\u00f3n personal")}function ee(){return s._(/*BTDS*/"Foto del perfil")}function te(){return s._(/*BTDS*/"Info.")}function ne(){return s._(/*BTDS*/"Text Status")}function re(){return s._(/*BTDS*/"Confirmaciones de lectura")}function oe(){return s._(/*BTDS*/"Desactivar vistas previas de enlaces")}function ae(){return s._(/*BTDS*/"Bloquea los mensajes de cuentas desconocidas")}function ie(){return s._(/*BTDS*/"Mensajes temporales")}function le(){return s._(/*BTDS*/"Estado")}function se(){return s._(/*BTDS*/"Duraci\u00f3n predeterminada de los mensajes")}function ue(){return s._(/*BTDS*/"Grupos")}function ce(){return s._(/*BTDS*/"Contactos bloqueados")}function de(){return s._(/*BTDS*/"Bloqueo de aplicaci\u00f3n")}function me(){return s._(/*BTDS*/"Tema")}function pe(){return s._(/*BTDS*/"Claro")}function _e(){return s._(/*BTDS*/"Oscuro")}function fe(){return s._(/*BTDS*/"Predeterminado del sistema")}function ge(){return s._(/*BTDS*/"Centro de ayuda")}function he(){return s._(/*BTDS*/"Preguntas frecuentes")}function ye(){return s._(/*BTDS*/"Cont\u00e1ctanos")}function Ce(){return s._(/*BTDS*/"Chatea con Soporte para obtener respuestas.")}function be(){return s._(/*BTDS*/"Calificar la aplicaci\u00f3n")}function ve(){return s._(/*BTDS*/"Enviar comentarios")}function Se(){return s._(/*BTDS*/"Problemas t\u00e9cnicos, sugerencias")}function Re(){return o("WAWebConnModel").Conn.isSMB?s._(/*BTDS*/"Condiciones"):s._(/*BTDS*/"Condiciones y Pol\u00edtica de privacidad")}function Le(){var e=o("WAWebBizGatingUtils").showDataSharingInSettingsAfterCtwaMessageReceived()?s._(/*BTDS*/"Actividad del cliente"):s._(/*BTDS*/"Uso compartido de datos de anuncios");return e}function Ee(){return s._(/*BTDS*/"Listas")}function ke(){return s._(/*BTDS*/"Administrar personas y grupos")}function Ie(){return s._(/*BTDS*/"Cerrar sesi\u00f3n")}function Te(){return s._(/*BTDS*/"Cuenta")}function De(){return s._(/*BTDS*/"Notificaciones de seguridad, informaci\u00f3n de la cuenta")}function xe(){return s._(/*BTDS*/"Chats")}function $e(){return s._(/*BTDS*/"Tema, fondo, ajustes del chat")}function Pe(){return s._(/*BTDS*/"C\u00f3mo eliminar mi cuenta")}function Ne(){return s._(/*BTDS*/"A fin de proteger tu cuenta y mejorar el rendimiento del dispositivo, WhatsApp bloquear\u00e1 los mensajes de cuentas desconocidas si superan un determinado volumen.")}function Me(){return s._(/*BTDS*/"Anuncio en estados")}function we(){return s._(/*BTDS*/"Consulta los detalles en tu tel\u00e9fono")}l.wallpaperTitle=e,l.requestAccountInfoTitle=u,l.newsletterReportsTitle=c,l.businessToolsTitle=d,l.businessToolsBusinessProfileTitle=m,l.businessToolsCatalogTitle=p,l.businessToolsOrdersTitle=_,l.businessToolsAdvertiseTitle=f,l.businessToolsQuickRepliesTitle=g,l.businessToolsLabelsTitle=h,l.businessToolsHelpCenterTitle=y,l.notificationsTitle=C,l.notificationsSecondaryTitle=b,l.languageAndTimeTitle=v,l.languageHeaderTitle=S,l.languageTitle=R,l.timeFormatTitle=L,l.mediaAutoDownloadTitle=E,l.mediaUploadQualityTitle=k,l.securityTitle=I,l.privacyTitle=T,l.privacySecondaryTitle=D,l.helpTitle=x,l.helpSecondaryTitle=$,l.keyboardShortcutsTitle=P,l.keyboardShortcutsSecondaryTitle=N,l.developerTitle=M,l.developerSecondaryTitle=w,l.developerABPropsTitle=A,l.developerInfraSettingsTitle=F,l.developerWWWSettingsTitle=O,l.messageNotificationsTitle=B,l.messageNotificationsSubtitle=W,l.showPreviewsTitle=q,l.showPreviewsSubtitle=U,l.offlineSyncSubtitle=V,l.outgoingAudioToneSubtitle=H,l.showReactionsTitle=G,l.showCallsTitle=z,l.showCallsSubtitle=j,l.playCallRingtoneTitle=K,l.playCallRingtoneSubtitle=Q,l.soundsTitle=X,l.soundsSubtitle=Y,l.privacyLastSeenOnlineEnabledTitle=J,l.privacyPersonalInfoHeaderTitle=Z,l.privacyProfilePhotoTitle=ee,l.privacyAboutTitle=te,l.privacyTextStatusTitle=ne,l.privacyReadReceiptsTitle=re,l.privacyLinkPreviewsTitle=oe,l.antiBrigadingTitle=ae,l.privacyDMTitle=ie,l.privacyStatusPostingTitle=le,l.privacyDDMTitle=se,l.privacyGroupsTitle=ue,l.privacyBlockedTitle=ce,l.privacyScreenlockTitle=de,l.themeTitle=me,l.themeLightLabel=pe,l.themeDarkLabel=_e,l.themeSystemLabel=fe,l.helpCenterTitle=ge,l.helpCenterSubtitle=he,l.contactUsTitle=ye,l.contactUsSubtitle=Ce,l.rateTheApp=be,l.sendFeedbackTitle=ve,l.sendFeedbackSubtitle=Se,l.termsTitle=Re,l.dataSharingTitle=Le,l.listsTitle=Ee,l.listsSecondaryTitle=ke,l.logoutTitle=Ie,l.accountTitle=Te,l.accountSecondaryTitle=De,l.chatsTitle=xe,l.chatsSecondaryTitle=$e,l.deleteAccountTitle=Pe,l.antiBrigadingDescription=Ne,l.wamoNonAGMMessagePreviewTitle=Me,l.wamoNonAGMMessagePreviewDescription=we}),226);
__d("WAWebBizCtwaAGMUtils",["fbt","WAWebABProps","WAWebBizGatingUtils","WAWebCtwaAGMUtils","WAWebMsgType","WAWebSettingsFBT","WAWebURLUtils"],(function(t,n,r,o,a,i,l,s){"use strict";function e(){return s._(/*BTDS*/"Ver detalles")}function u(e){return e===o("WAWebCtwaAGMUtils").AGM_SOURCE_APP.WHATSAPP&&o("WAWebBizGatingUtils").getWamoAgmEnabled()?o("WAWebSettingsFBT").wamoNonAGMMessagePreviewTitle():s._(/*BTDS*/"Anuncio de {ad source}",[s._param("ad source",e)])}function c(e){return r("WAWebURLUtils").withoutWww(r("WAWebURLUtils").hostname(e))}function d(e){if(e.sourceUrl==null)return null;var t=c(e.sourceUrl),n=t.split(".")[0];return n==="fb"?"facebook":n}function m(e){return s._(/*BTDS*/"{ad source} A\u00f1adir vista previa de la imagen",[s._param("ad source",e)])}function p(){return s._(/*BTDS*/"Error al cargar la foto")}function _(e,t,n){var r=o("WAWebBizGatingUtils").getWamoAgmEnabled(),a=e===o("WAWebCtwaAGMUtils").AGM_SOURCE_APP.FACEBOOK||e===o("WAWebCtwaAGMUtils").AGM_SOURCE_APP.INSTAGRAM,i=t===o("WAWebMsgType").MSG_TYPE.AUTOMATED_GREETING_MESSAGE&&n===!0&&o("WAWebBizGatingUtils").getFmxAgmEnabled();return(r||a)&&i}function f(e){if(e.type===o("WAWebMsgType").MSG_TYPE.AUTOMATED_GREETING_MESSAGE&&e.ctwaContext!=null){var t=e.ctwaContext,n=o("WAWebCtwaAGMUtils").extractAGMPayload(t);return(n==null?void 0:n.ctaType)===o("WAWebCtwaAGMUtils").AGM_CTA_TYPE.FLOW?o("WAWebABProps").getABPropConfigValue("flows_wa_web")&&o("WAWebABProps").getABPropConfigValue("enable_agm_flow_cta"):!0}return!1}function g(e){var t,n;return f(e)&&_((t=e.ctwaContext)==null?void 0:t.sourceApp,e.type,((n=e.ctwaContext)==null?void 0:n.automatedGreetingMessageShown)===!0)}function h(e){var t=e.getAllMsgs(),n=t.find(function(e){return e.type!==o("WAWebMsgType").MSG_TYPE.E2E_NOTIFICATION&&e.type!==o("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&e.type!==o("WAWebMsgType").MSG_TYPE.NOTIFICATION});return(n==null?void 0:n.type)===o("WAWebMsgType").MSG_TYPE.AUTOMATED_GREETING_MESSAGE}l.getCtwaDetailsLabel=e,l.getAdSourceLabel=u,l.getHostnameLabel=d,l.getAdImageAlt=m,l.getAdImgError=p,l.isAutomatedGreetingMessage=_,l.isAGMFutureproof=g,l.isCtWAInitiatedChat=h}),226);
__d("WAWebMsgActionCapability",["WALogger","WANullthrows","WATimeUtils","WAWebABProps","WAWebAck","WAWebBizCoexGatingUtils","WAWebBizCtwaAGMUtils","WAWebBotGating","WAWebBotGenTypingIndicatorMsg","WAWebBotProfileCollection","WAWebBusinessHSMTypes","WAWebChatGetters","WAWebChatGroupUtils","WAWebCommonMsgSubtypeTypes","WAWebContactGetters","WAWebContactModel","WAWebDisplayType","WAWebFrontendChatGetters","WAWebFrontendMsgGetters","WAWebInteractiveMessagesNativeFlowName","WAWebMediaTypes","WAWebMessageAssociation.flow","WAWebMessageEditGatingUtils","WAWebMessageEditUtils","WAWebMiscGatingUtils","WAWebMobilePlatforms","WAWebMsgGetters","WAWebMsgLinks","WAWebMsgModel","WAWebMsgType","WAWebNewsletterFutureProofUtils","WAWebNewsletterGatingUtils","WAWebNewsletterMembershipUtil","WAWebPinMsgGatingUtils","WAWebPollCreationUtils","WAWebProtobufsE2E.pb","WAWebQuestionsGatingUtils","WAWebRevokeMsgConstants","WAWebSpamUtils","WAWebStateUtils","WAWebUserPrefsMultiDevice","cr:6009"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e,t){return e.isWamoSub===!0&&!o("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(t)}function m(e){var t=e.ctwaContext;return(t==null?void 0:t.sourceApp)==="whatsapp"}function p(e,t){return!(o("WAWebChatGetters").getIsNewsletter(t)&&e.isWamoSub===!0&&!o("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(t.newsletterMetadata)&&o("WAWebNewsletterGatingUtils").isWamoSubMessagesSupported())}function _(e,t){if(!C(e))return!1;if(t instanceof r("WAWebContactModel")||!o("WAWebChatGetters").getIsNewsletter(t))return!0;switch(e.type){case o("WAWebMsgType").MSG_TYPE.PTV:return o("WAWebNewsletterGatingUtils").isNewsletterPTVForwardingEnabled();case o("WAWebMsgType").MSG_TYPE.AUDIO:case o("WAWebMsgType").MSG_TYPE.PTT:return o("WAWebNewsletterGatingUtils").isNewsletterAudioFileSendingEnabled()||o("WAWebMsgGetters").getHasOriginatedFromNewsletter(e)}return o("WAWebNewsletterFutureProofUtils").isMsgTypeSupported(e.type)}function f(e,t,n){if(!e.isBot())return!0;if(!o("WAWebBotGating").isAiWebForwardEnabled())return!1;var r=o("WAWebBotProfileCollection").BotProfileCollection.get(e);if((r==null?void 0:r.isDefault)!==!0||t.length!==1)return!1;var a=t[0].type===o("WAWebMsgType").MSG_TYPE.CHAT;return a}function g(e,t){return e.isNewsletter()?!0:t.hasMusicAnnotations!==!0}function h(e,t,n){n===void 0&&(n={});var r=e.id;return f(r,t,n)&&g(r,n)}function y(e){return e.length===1&&e[0].type===o("WAWebMsgType").MSG_TYPE.CHAT}function C(e){var t,n,a,i,l=o("WAWebStateUtils").unproxy(e);if(l.isCarouselCard||l.carouselCards||l.associationType===o("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_POLL)return!1;var s=o("WAWebFrontendMsgGetters").getMaybeChat(l);if(s!=null&&s.isSuspendedOrTerminated()&&o("WAWebMiscGatingUtils").isGroupSuspendV2Enabled())return!1;var u=s!=null&&o("WAWebChatGetters").getIsNewsletter(s);if(u&&(!o("WAWebNewsletterGatingUtils").isNewsletterMessageForwardSendingEnabled()||s!=null&&!p(l,s))||o("WAWebMsgGetters").getIsQuestion(l)&&!o("WAWebQuestionsGatingUtils").isQuestionForwardingEnabledForMsg(l)||o("WAWebMsgGetters").getQuestionReplyQuotedMessage(l)!=null&&!o("WAWebQuestionsGatingUtils").isQuestionReplyForwardingEnabledForMsg(l))return!1;switch(l.type){case o("WAWebMsgType").MSG_TYPE.CALL_LOG:case o("WAWebMsgType").MSG_TYPE.CIPHERTEXT:case o("WAWebMsgType").MSG_TYPE.DEBUG_PLACEHOLDER:case o("WAWebMsgType").MSG_TYPE.EVENT_CREATION:case o("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE:case o("WAWebMsgType").MSG_TYPE.NEWSLETTER_ADMIN_INVITE:case o("WAWebMsgType").MSG_TYPE.ORDER:case o("WAWebMsgType").MSG_TYPE.OVERSIZED:case o("WAWebMsgType").MSG_TYPE.PAYMENT:case o("WAWebMsgType").MSG_TYPE.QUARANTINED:case o("WAWebMsgType").MSG_TYPE.REQUEST_PHONE_NUMBER:case o("WAWebMsgType").MSG_TYPE.REVOKED:case o("WAWebMsgType").MSG_TYPE.RICH_RESPONSE:case o("WAWebMsgType").MSG_TYPE.UNKNOWN:return!1;case o("WAWebMsgType").MSG_TYPE.POLL_CREATION:return u&&l.pollContentType!==o("WAWebPollCreationUtils").PollContentType.IMAGE&&o("WAWebNewsletterGatingUtils").isNewsletterPollForwardingEnabled();case o("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT:return o("WAWebNewsletterGatingUtils").isNewsletterPollForwardingEnabled();case o("WAWebMsgType").MSG_TYPE.LIST:return((t=l.list)==null?void 0:t.listType)===o("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.PRODUCT_LIST;case o("WAWebMsgType").MSG_TYPE.INTERACTIVE_RESPONSE:return(l==null?void 0:l.nativeFlowName)!==r("WAWebInteractiveMessagesNativeFlowName").CTA_FLOW}if(l.type===o("WAWebMsgType").MSG_TYPE.LOCATION&&l.isLive||l.type===o("WAWebMsgType").MSG_TYPE.INTERACTIVE&&l.nativeFlowName!=null||!l.interactiveButtonsReleased()||l.ack<o("WAWebAck").ACK.SENT&&o("WAWebMsgGetters").getIsSentByMe(l)||l.type===o("WAWebMsgType").MSG_TYPE.CHAT&&l.subtype===o("WAWebBotGenTypingIndicatorMsg").BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE)return!1;if(o("WAWebFrontendMsgGetters").getAsMms(l)){var c=l.mediaData;if(c.mediaStage===o("WAWebMediaTypes").MediaDataStage.EXISTS)return!0;if(c.mediaStage===o("WAWebMediaTypes").MediaDataStage.ERROR_MISSING||c.mediaStage===o("WAWebMediaTypes").MediaDataStage.ERROR_UNSUPPORTED||c.mediaStage!==o("WAWebMediaTypes").MediaDataStage.RESOLVED&&(l.type===o("WAWebMsgType").MSG_TYPE.IMAGE||l.type===o("WAWebMsgType").MSG_TYPE.VIDEO||l.type===o("WAWebMsgType").MSG_TYPE.PTV||l.type===o("WAWebMsgType").MSG_TYPE.PTT)&&(!o("WAWebMsgGetters").getIsNewsletterMsg(l)||!o("WAWebNewsletterGatingUtils").isNewsletterQuickForwardingEnabled()))return!1;if(l.type===o("WAWebMsgType").MSG_TYPE.PTV){if(u){if(!o("WAWebNewsletterGatingUtils").isNewsletterPTVForwardingEnabled())return!1}else if(!o("WAWebMsgGetters").getIsSentByMe(l))return!1}if(l.isViewOnce||o("WAWebFrontendMsgGetters").getIsUnsentMedia(l))return!1}return!((n=l.nativeFlowButtons)!=null&&n.length||l.hsmTag===o("WAWebBusinessHSMTypes").HSM_TAG_TYPE.AUTHENTICATION||o("WAWebBizCtwaAGMUtils").isAutomatedGreetingMessage((a=l.ctwaContext)==null?void 0:a.sourceApp,l.type,(i=l.ctwaContext)==null?void 0:i.automatedGreetingMessageShown)||m(l))}function b(e){var t=o("WAWebStateUtils").unproxy(e);return!C(e)||o("WAWebMsgGetters").getIsFrequentlyForwarded(t)||o("WAWebMsgLinks").getSuspiciousLinks(t).length!==0||o("WAWebFrontendMsgGetters").getAsPttLike(t)!=null||t.type===o("WAWebMsgType").MSG_TYPE.STICKER||!t.interactiveButtonsReleased()||o("WAWebChatGetters").getIsNewsletter(o("WAWebFrontendMsgGetters").getChat(t))&&o("WAWebNewsletterGatingUtils").isNewsletterQuickForwardingEnabled()?!1:o("WAWebFrontendMsgGetters").getAsMms(t)!=null||o("WAWebMsgGetters").getLinkPreview(t)||t.type===o("WAWebMsgType").MSG_TYPE.VCARD||t.type===o("WAWebMsgType").MSG_TYPE.LOCATION||t.type===o("WAWebMsgType").MSG_TYPE.POLL_CREATION||t.type===o("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT||t.ctwaContext!=null}function v(e){var t=o("WAWebStateUtils").unproxy(e);return o("WAWebChatGetters").getIsNewsletter(o("WAWebFrontendMsgGetters").getChat(t))||t.isCarouselCard||t.ctwaContext!=null&&o("WAWebBizCtwaAGMUtils").isAutomatedGreetingMessage(t.ctwaContext.sourceApp,t.type,t.ctwaContext.automatedGreetingMessageShown)?!1:(!o("WAWebMsgGetters").getIsEphemeral(t)||t.supportsStarWithKeepInChat())&&!o("WAWebMsgGetters").getIsNotification(t)&&!o("WAWebMsgGetters").getIsFutureproof(t)&&!t.isViewOnce&&t.type!==o("WAWebMsgType").MSG_TYPE.REVOKED&&t.type!==o("WAWebMsgType").MSG_TYPE.DEBUG_PLACEHOLDER&&!(t.ack<o("WAWebAck").ACK.SENT&&o("WAWebMsgGetters").getIsSentByMe(t))&&t.interactiveButtonsReleased()&&!o("WAWebFrontendMsgGetters").getAsAlbum(t)}function S(e){var t,n,a=o("WAWebStateUtils").unproxy(e),i=o("WAWebFrontendMsgGetters").getChat(a);if(a.isViewOnce===!0||a.subtype==="view_once_unavailable_fanout"||o("WAWebChatGetters").getIsNewsletter(i)||i.id.isBot()||a.isCarouselCard)return!1;if(o("WAWebMsgGetters").getIsGroupMsg(a)){var l=r("WANullthrows")(i.groupMetadata);if(!l.participants.iAmMember()||(l.restrict||l.announce)&&!l.participants.iAmAdmin())return!1}return o("WAWebBizCtwaAGMUtils").isAutomatedGreetingMessage((t=a.ctwaContext)==null?void 0:t.sourceApp,a.type,(n=a.ctwaContext)==null?void 0:n.automatedGreetingMessageShown)?!1:!o("WAWebMsgGetters").getIsNotification(a)&&!o("WAWebMsgGetters").getIsFutureproof(a)&&!o("WAWebMsgGetters").getIsViewOnce(a)&&a.type!==o("WAWebMsgType").MSG_TYPE.REVOKED&&a.type!==o("WAWebMsgType").MSG_TYPE.DEBUG_PLACEHOLDER&&!(a.ack<o("WAWebAck").ACK.SENT&&o("WAWebMsgGetters").getIsSentByMe(a))&&a.interactiveButtonsReleased()&&!a.isExpiredAndNotKept()&&o("WAWebPinMsgGatingUtils").isPinnedMessagesM1SenderEnabled()&&!o("WAWebFrontendMsgGetters").getAsAlbum(a)}function R(e,t){var n,r;if(t===void 0&&(t=!1),o("WAWebMsgGetters").getIsBotQuery(e))return!1;var a=o("WAWebFrontendMsgGetters").getChat(e);if(o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&a!=null&&(n=a.id)!=null&&n.isUser()&&((a==null||(r=a.contact)==null?void 0:r.isHosted)===!0||o("WAWebUserPrefsMultiDevice").getIsHostedMeAccountFromLocalStorage()===!0)&&!o("WAWebABProps").getABPropConfigValue("coex_edit_msg_enabled"))return!1;var i=o("WAWebMsgGetters").getIsEdited(e)&&o("WAWebMsgGetters").getIsFailed(e)&&!t||!e.mayFail();return o("WAWebChatGetters").getIsNewsletter(o("WAWebFrontendMsgGetters").getChat(e))?o("WAWebNewsletterGatingUtils").isNewsletterMessageEditingEnabled()&&o("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(o("WAWebFrontendMsgGetters").getChat(e).newsletterMetadata)&&i&&!e.isForwarded:o("WAWebMsgGetters").getIsSentByMe(e)&&!e.isForwarded&&e.local&&(o("WAWebMessageEditGatingUtils").sendCagMsgEditEnabled()||!o("WAWebFrontendChatGetters").getIsCAG(o("WAWebFrontendMsgGetters").getChat(e)))&&i&&o("WAWebFrontendMsgGetters").getChat(e).canSend&&!o("WAWebFrontendMsgGetters").getChat(e).contact.isEnterprise}function L(e){var t=o("WAWebMsgGetters").getIsGroupMsg(e),n=o("WAWebMsgGetters").getIsSentByMe(e),r=o("WAWebFrontendMsgGetters").getChat(e).groupMetadata;return!o("WAWebABProps").getABPropConfigValue("report_to_admin_kill_switch")||n||e.isViewOnce||o("WAWebChatGetters").getIsNewsletter(o("WAWebFrontendMsgGetters").getChat(e))||o("WAWebMsgGetters").getIsMetaBotResponse(e)||!t?!1:!!(r!=null&&r.reportToAdminMode)}function E(e,t){return t===void 0&&(t=!1),(o("WAWebMsgGetters").getIsNewsletterMsg(e)?o("WAWebNewsletterGatingUtils").isNewsletterMessageEditingEnabled():o("WAWebMessageEditGatingUtils").sendTextEditEnabled())&&o("WAWebMessageEditUtils").getMsgEditType(e.type)===o("WAWebMessageEditUtils").MsgEditType.TextEdit&&R(e,t)}function k(e,t){return t===void 0&&(t=!1),(o("WAWebMsgGetters").getIsNewsletterMsg(e)?o("WAWebNewsletterGatingUtils").isNewsletterMessageEditingEnabled():o("WAWebMessageEditGatingUtils").sendCaptionEditEnabled())&&o("WAWebMessageEditUtils").getMsgEditType(e.type)===o("WAWebMessageEditUtils").MsgEditType.CaptionEdit&&!!e.caption&&o("WAWebFrontendMsgGetters").getAsViewOnce(e)==null&&R(e,t)}function I(e){switch(e){case o("WAWebDisplayType").DISPLAY_TYPE.CONVERSATION:case o("WAWebDisplayType").DISPLAY_TYPE.ANNOUNCEMENT:return!0;case o("WAWebDisplayType").DISPLAY_TYPE.NEWSLETTER:return o("WAWebNewsletterGatingUtils").isNewsletterMessageEditingEnabled();default:return!1}}function T(e){if((n("cr:6009")==null?void 0:n("cr:6009").messageEditRestrictionEnabled())===!1)return!0;var t=o("WAWebStateUtils").unproxy(e);return o("WAWebMsgGetters").getIsQuestion(t)?!1:(E(t,!0)||k(t,!0))&&o("WAWebMessageEditUtils").isParentWithinEditUIWindow({parentTsInSeconds:t.t,msgKey:t.id})}function D(e){if((n("cr:6009")==null?void 0:n("cr:6009").messageEditRestrictionEnabled())===!1)return!0;var t=o("WAWebStateUtils").unproxy(e);return o("WAWebMsgGetters").getIsQuestion(t)?!1:E(t)&&o("WAWebMessageEditUtils").isParentWithinEditProcessingWindow({parentTsInSeconds:t.t,msgKey:t.id})}function x(e){if((n("cr:6009")==null?void 0:n("cr:6009").messageEditRestrictionEnabled())===!1)return!0;var t=o("WAWebStateUtils").unproxy(e);return o("WAWebMsgGetters").getIsQuestion(t)?!1:k(t)&&o("WAWebMessageEditUtils").isParentWithinEditProcessingWindow({parentTsInSeconds:t.t,msgKey:t.id})}function $(e){var t,n,a=o("WAWebStateUtils").unproxy(e);return o("WAWebMsgGetters").getIsSentByMe(a)||o("WAWebMsgGetters").getIsPSA(a)||o("WAWebMsgGetters").getIsBotResponse(a)||o("WAWebBizCtwaAGMUtils").isAutomatedGreetingMessage((t=a.ctwaContext)==null?void 0:t.sourceApp,a.type,(n=a.ctwaContext)==null?void 0:n.automatedGreetingMessageShown)?!1:(a.type===o("WAWebMsgType").MSG_TYPE.INTERACTIVE||a.type===o("WAWebMsgType").MSG_TYPE.INTERACTIVE_RESPONSE)&&(a==null?void 0:a.nativeFlowName)===r("WAWebInteractiveMessagesNativeFlowName").CTA_FLOW?!0:o("WAWebSpamUtils").isMsgTypeSupportedForMsgLevelReporting(a.type)}function P(e){return o("WATimeUtils").unixTime()-o("WAWebMsgGetters").getT(e)<=o("WAWebRevokeMsgConstants").NEWSLETTER_REVOKE_WINDOW}function N(t){var n,r=o("WAWebFrontendMsgGetters").getCurrentChat(t);if(!o("WAWebChatGetters").getIsNewsletter(r))return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["canRevokeNewsletterMsg called on a non-newsletter chat"]))),!1;if(w(t))return!1;var a=((n=t.ack)!=null?n:o("WAWebAck").ACK.CLOCK)<o("WAWebAck").ACK.CLOCK;return(P(t)||a)&&o("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(r.newsletterMetadata)}function M(e){var t=o("WAWebFrontendMsgGetters").getChat(e);return!o("WAWebChatGetters").getIsNewsletter(t)||!P(e)?!1:t.newsletterMetadata==null?(o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["chat doesn't have newsletter metadata, will be impossible to generate message link"]))),!1):t.newsletterMetadata.inviteCode==null?(o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["chat doesn't have a newsletter invite code, will be impossible to generate message link"]))),!1):e.serverId==null?(o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["msg doesn't have a server ID, will be impossible to generate message link"]))),!1):!(e.type===o("WAWebMsgType").MSG_TYPE.REVOKED||!p(e,t))}function w(e){var t=!1;return e.type===o("WAWebMsgType").MSG_TYPE.PROTOCOL&&(e.subtype===o("WAWebCommonMsgSubtypeTypes").MsgSubtype.AdminRevoke||o("WAWebCommonMsgSubtypeTypes").MsgSubtype.SenderRevoke)&&(t=!0),t||e.type===o("WAWebMsgType").MSG_TYPE.REVOKED}function A(e){var t;if(w(e))return!1;var n=o("WAWebFrontendMsgGetters").getCurrentChat(e);return o("WAWebChatGetters").getIsNewsletter(n)?N(e):o("WAWebChatGetters").getIsGroup(n)&&!((t=n.groupMetadata)!=null&&t.participants.iAmMember())||o("WAWebContactGetters").getIsMe(n.contact)||n.contact.isEnterprise&&!n.contact.id.isBot()||o("WAWebFrontendChatGetters").getIsCapiHostedGroup(n)||o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&!o("WAWebChatGetters").getIsGroup(n)&&(n.contact.isHosted===!0||o("WAWebUserPrefsMultiDevice").getIsHostedMeAccountFromLocalStorage())?!1:e.type===o("WAWebMsgType").MSG_TYPE.COMMENT?e.ack!=null&&e.ack>=o("WAWebAck").ACK.SENT:o("WAWebMsgGetters").getIsUserCreatedType(e)&&!(e.broadcast!=null&&e.broadcast)&&(e instanceof o("WAWebMsgModel").Msg&&!e.isUnsentPhoneMsg()||o("WAWebMsgGetters").getIsEdited(e))&&!o("WAWebFrontendMsgGetters").getIsUnsentMedia(e)&&!o("WAWebChatGroupUtils").isSuspendedGroup(o("WAWebFrontendMsgGetters").getCurrentChat(e))&&!o("WAWebChatGroupUtils").isTerminatedGroup(o("WAWebFrontendMsgGetters").getCurrentChat(e))}function F(e){var t=e;e instanceof o("WAWebMsgModel").Msg&&(t=o("WAWebStateUtils").unproxy(e));var n=o("WATimeUtils").unixTime()-o("WAWebMsgGetters").getT(t)<=o("WAWebRevokeMsgConstants").REVOKE_WINDOW;return A(t)&&t.id.fromMe&&n}function O(e){var t,n=e;e instanceof o("WAWebMsgModel").Msg&&(n=o("WAWebStateUtils").unproxy(e));var r=o("WAWebFrontendMsgGetters").getCurrentChat(n);if(o("WAWebChatGetters").getIsNewsletter(r))return N(n);var a=o("WATimeUtils").unixTime()-o("WAWebMsgGetters").getT(n)<=o("WAWebRevokeMsgConstants").REVOKE_WINDOW;return A(n)&&!n.id.fromMe&&!!((t=r.groupMetadata)!=null&&t.participants.iAmAdmin())&&a}function B(e){var t=e;e instanceof o("WAWebMsgModel").Msg&&(t=o("WAWebStateUtils").unproxy(e));var n=o("WAWebRevokeMsgConstants").REVOKE_WINDOW,r=o("WAWebMsgGetters").isMetaBotResponseToMyInvoke(t),a=o("WATimeUtils").unixTime()-o("WAWebMsgGetters").getT(t)<=n;return o("WAWebBotGating").isBotEnabled()&&A(t)&&a&&r}function W(e,t){var n,r=o("WAWebStateUtils").unproxy(e);return o("WAWebFrontendMsgGetters").getChat(r).isSuspendedOrTerminated()&&o("WAWebMiscGatingUtils").isGroupSuspendV2Enabled()||r.type===o("WAWebMsgType").MSG_TYPE.STICKER_PACK||o("WAWebFrontendMsgGetters").getAsRevoked(r)||r.isViewOnce?!1:r.type===o("WAWebMsgType").MSG_TYPE.VCARD||r.type===o("WAWebMsgType").MSG_TYPE.MULTI_VCARD?!0:!(!((n=r.mediaData)!=null&&n.isDownloadable())&&t!==!0||r.type===o("WAWebMsgType").MSG_TYPE.STICKER||r.type===o("WAWebMsgType").MSG_TYPE.PTV&&!o("WAWebMsgGetters").getIsSentByMe(r)||!p(r,o("WAWebFrontendMsgGetters").getChat(r)))}function q(e){var t=o("WAWebFrontendMsgGetters").getChat(e);return!o("WAWebMobilePlatforms").isSMB()||o("WAWebChatGetters").getIsNewsletter(t)?!1:!o("WAWebFrontendMsgGetters").getAsRevoked(e)}function U(e){var t,n;return o("WAWebBizCtwaAGMUtils").isAutomatedGreetingMessage((t=e.ctwaContext)==null?void 0:t.sourceApp,e.type,(n=e.ctwaContext)==null?void 0:n.automatedGreetingMessageShown)?!1:!o("WAWebChatGetters").getIsNewsletter(o("WAWebFrontendMsgGetters").getChat(e))||N(e)}l.isWamoSubMsgAndNotAdminOrOwner=d,l.isWamoMsg=m,l.canWamoSubMsgBeSharedByUser=p,l.canForwardMsgToChat=_,l.allowedChatOrContactForForwarding=h,l.canForwardMsgToMetaAi=y,l.canForwardMsg=C,l.canQuickForwardMsg=b,l.canStarMsg=v,l.canPinMsg=S,l.canReportToAdmin=L,l.displayTypeSupportsEditing=I,l.canEnterEditingFlow=T,l.canEditText=D,l.canEditCaption=x,l.canReportMsg=$,l.isNewsletterMsgOnServer=P,l.canRevokeNewsletterMsg=N,l.canCopyNewsletterMessageLink=M,l.canSenderRevokeMsg=F,l.canAdminRevokeMsg=O,l.canBotResponseBeRevokeByInvoker=B,l.canDownloadMsg=W,l.canAddLabelToMsg=q,l.canDeleteMsg=U}),98);
__d("WAWebFtsConstants",[],(function(t,n,r,o,a,i){var e=6e4,l=300,s=30;i.FTS_TTL=e,i.FTS_TYPING_DELAY=l,i.FTS_NUM_RESULTS=s}),66);
__d("WAWebMsgOpaqueData",["WAWebDBMsgOpaqueDataKeys","WAWebMsgKey","WAWebPollsDbUtils","WAWebProtobufsMdStorageMsgRowOpaqueData.pb","WAWebUserPrefsInfoStore","asyncToGeneratorRuntime","decodeProtobuf","encodeProtobuf"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebUserPrefsInfoStore").waNoiseInfo.cachedPasscodeDerivedKey;if(t==null){location.reload();return}var n=m(e),r=new Uint8Array(16);self.crypto.getRandomValues(r);var a=yield self.crypto.subtle.encrypt({iv:r,name:"AES-GCM"},t,n);e.encryptedData={iv:r,data:a}}),s.apply(this,arguments)}function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=e.encryptedData;if(n!=null){var r=yield self.crypto.subtle.decrypt({iv:n.iv,name:"AES-GCM"},t,n.data);d(e,r),e.encryptedData=null}}),c.apply(this,arguments)}function d(e,t){var n=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgRowOpaqueDataSpec,t),r=n.currentMsg,a=n.quotedMsg;r&&_(e,r),e.quotedMsg&&a&&_(e.quotedMsg,r),e.encryptedData=null}function m(e){var t={currentMsg:{},quotedMsg:{}};t.currentMsg=p(e),e.quotedMsg&&(t.quotedMsg=p(e.quotedMsg));var n=o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgRowOpaqueDataSpec,t);return n.readBuffer()}var p=function(t){var e,n={};return(e=t.paymentNoteMsg)!=null&&e.body&&(n.paymentNoteMsgBody=t.paymentNoteMsg.body,t.paymentNoteMsg.body=void 0),o("WAWebDBMsgOpaqueDataKeys").MSG_OPAQUE_DATA_KEYS.forEach(function(e){t[e]&&o("WAWebDBMsgOpaqueDataKeys").MsgKeyFieldsInOpaqueData.includes(e)?n[e]=t[e].toString():n[e]=t[e],t[e]=void 0}),n.pollOptions=o("WAWebPollsDbUtils").compressPollOptions(t.pollOptions),t.pollOptions=void 0,n.pollVotesSnapshot=o("WAWebPollsDbUtils").compressPollVotesSnapshot(t.pollVotesSnapshot),t.pollVotesSnapshot=void 0,n},_=function(t,n){n.paymentNoteMsgBody!=null&&t.paymentNoteMsg&&(t.paymentNoteMsg.body=n==null?void 0:n.paymentNoteMsgBody),o("WAWebDBMsgOpaqueDataKeys").MSG_OPAQUE_DATA_KEYS.forEach(function(e){var a=n[o("WAWebDBMsgOpaqueDataKeys").getKey(t.type,e)];a&&o("WAWebDBMsgOpaqueDataKeys").MsgKeyFieldsInOpaqueData.includes(e)?t[e]=r("WAWebMsgKey").fromString(a):t[e]=a}),t.pollOptions=o("WAWebPollsDbUtils").expandPollOptions(n==null?void 0:n.pollOptions),t.pollVotesSnapshot=o("WAWebPollsDbUtils").expandPollVotesSnapshot(n==null?void 0:n.pollVotesSnapshot)};l.encryptDataInMsgModel=e,l.decryptDataInMsgModel=u}),98);
__d("WAWebMsgCollection",["Promise","WALogger","WANullthrows","WAPromiseProps","WATimeUtils","WATypeUtils","WAWebAck","WAWebBackendErrors","WAWebBaseCollection","WAWebBotGenTypingIndicatorMsg","WAWebChatCollection","WAWebCollectionConstants","WAWebCollectionUtils","WAWebDBMessageFindLocal","WAWebDBMsgUtils","WAWebEventsWaitForBbEvent","WAWebFrontendMsgGetters","WAWebFtsConstants","WAWebInvisiblePlaceholderViewModeProcessor","WAWebLidMigrationUtils","WAWebMessageAssociationUIUtils","WAWebMsgDataFromModel","WAWebMsgGetters","WAWebMsgModel","WAWebMsgOpaqueData","WAWebMsgType","WAWebNewsletterMsgHistoryUtils","WAWebNewsletterViewModeUIUtils","WAWebNoop","WAWebProcessMultipleMsgsAction","WAWebProductMessageListCollection","WAWebProtobufsE2E.pb","WAWebSyncButtonState","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebViewModeUtils","WAWebWid","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x=50,$=(function(t){function a(){var a;return a=t.call(this)||this,a.pendingAdd={},a.ftsCache={},a.productListMessagesPrefetchChain=(D||(D=n("Promise"))).resolve([]),a._editKeyByParentKey=new Map,a._parentKeyByEditKey=new Map,a._encryptedData=null,a.findQueryImpl=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var i=a,l;switch(t.direction){case"before":case"after":l=t.direction;break;default:l="before";break}var c={add:l,isHistory:!0};o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:findQuery: start ",", ",""])),t,l);var d=yield o("WAWebDBMessageFindLocal").msgFindQuery(l,t);if(d.status>=400)return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:findQuery error ",""])),d.status),(D||(D=n("Promise"))).reject(d.status);var m=i.get(t);r("WAWebWid").isNewsletter(t.remote)&&m!=null&&(d=yield o("WAWebNewsletterMsgHistoryUtils").fillMsgHistoryGaps({jid:t.remote,msgs:l==="before"?d.concat(o("WAWebMsgDataFromModel").msgDataFromMsgModel(m)):[o("WAWebMsgDataFromModel").msgDataFromMsgModel(m)].concat(d),serverIdsToSkip:o("WAWebNewsletterViewModeUIUtils").getHiddenMessageServerIdsForChat(t.remote)}));var p=function(){var e=i.get(t);if(e!=null)return e.msgChunk;var n=o("WAWebChatCollection").ChatCollection.get(t.remote);return n!=null?n.msgs:void 0};return d.forEach(function(e){e.invis=!0}),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:findQuery:got:",":",""])),d.length,t.direction),i.processMultipleMessages(t.remote,d,c,"msgCollectionFindQuery",p)});return function(e){return t.apply(this,arguments)}})(),a.byParentMessage=o("WAWebCollectionUtils").aggregated(function(e){var t=e.parentMsgKey,n=e.type;return n===o("WAWebMsgType").MSG_TYPE.CIPHERTEXT||n===o("WAWebMsgType").MSG_TYPE.UNKNOWN?"UNCATEGORIZED":t},{subscribeToKey:"parentMsgKey"}),a.byChat=o("WAWebCollectionUtils").aggregated(function(e){var t=e.id;return t.remote}),a.byThreadId=o("WAWebCollectionUtils").aggregated(function(e){var t=e.threadIds;return t}),a.listenTo(a,"remove",a.removeFromCollection),a}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.removeFromCollection=function(t){var e=o("WAWebFrontendMsgGetters").getMaybeChat(t);e==null||e.removeFromCollection(t)},i.add=function(n,a){var e=Array.isArray(n)?n:[n],i=e.filter(function(e){if(e.ephemeralDuration==null||e.ephemeralDuration===0)return!0;var t=new(o("WAWebMsgModel")).Msg(e);return!t.isExpiredAndNotKept()}),l=t.prototype.add.call(this,i,a);return this.makeParentMessagesVisibleInChat(l),r("WAWebSyncButtonState")(l),this._prefetchProductListMessages(l),this.processVCardMessagesForLidMappings(l),this.processEditedMessages(l),l},i.makeParentMessagesVisibleInChat=function(t){var e=this;t.filter(Boolean).forEach(function(t){var n=t.parentMsgKey,r=t.viewMode;if(n&&!o("WAWebViewModeUtils").isViewModeVisibleInSurface(o("WAWebViewMode.flow").ViewModeSurface.CHAT,r)){var a,i=e.get(n);i&&(a=o("WAWebInvisiblePlaceholderViewModeProcessor").InvisiblePlaceholderViewModeProcessor.compatibleMessageTypes)!=null&&a.includes(i.type)&&!o("WAWebMessageAssociationUIUtils").shouldHideParentMessage({parentMsg:i,duringDetach:!1})&&!o("WAWebViewModeUtils").isViewModeVisibleInSurface(o("WAWebViewMode.flow").ViewModeSurface.CHAT,i==null?void 0:i.viewMode)&&i.set("viewMode",o("WAWebViewMode.flow").ViewModeType.VISIBLE)}})},i.processVCardMessagesForLidMappings=function(t){var e=t.reduce(function(e,t){if(t==null||t.type!==o("WAWebMsgType").MSG_TYPE.VCARD&&t.type!==o("WAWebMsgType").MSG_TYPE.MULTI_VCARD)return e;var n=t.type===o("WAWebMsgType").MSG_TYPE.VCARD?t.getVcardWids():t.getMultiVcardWids();if(n==null)return e;var r=n.filter(function(e){return o("WAWebLidMigrationUtils").toUserLid(e)==null});return r.length===0?e:e==null?new Set(r):(r.forEach(function(t){return e.add(t)}),e)},null);e!=null&&o("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("syncContactListJob",{contactIds:Array.from(e),shouldSyncDevice:!1,mode:"query"})},i._prefetchProductListMessages=function(t){this.productListMessagesPrefetchChain=t.filter(function(e){var t,n;return e!=null&&e.isNewMsg&&e.type===o("WAWebMsgType").MSG_TYPE.LIST&&((t=e.list)==null?void 0:t.listType)===o("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.PRODUCT_LIST&&((n=e.list)==null?void 0:n.productListInfo)!=null}).reduce(function(e,t){var n,r;if(t==null)return e;var a=t.requiresDirectConnection,i=t.isForwarded?t.businessOwnerJid:t.from.toString({legacy:!0}),l=(n=t.list)==null?void 0:n.productListInfo;if(i==null||l==null)return e;var s=o("WAWebProductMessageListCollection").ProductMessageListCollection.getOrAdd(t.id,l,a,i,(r=t.list)==null?void 0:r.title);return s!=null&&s.productCollection.getModelsArray().length===0&&!s.isFetching()?e.then(function(){return o("WAWebProductMessageListCollection").ProductMessageListCollection.update(s.id)}):e},this.productListMessagesPrefetchChain)},i.getStarred=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){var a={count:typeof t=="number"&&!isNaN(t)?t:o("WAWebCollectionConstants").PAGE_SIZE,chat:e||void 0,remote:r==null?void 0:r.remote,id:r==null?void 0:r.id,fromMe:r==null?void 0:r.fromMe,participant:r==null?void 0:r.participant},i={add:"search"},l=yield o("WAWebDBMessageFindLocal").msgFindQuery("star",a),s=l.status;return l.status>=400?(s===499?o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getStarred error 499 (unimplemented)"]))):o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getStarred error ",""])),s),(D||(D=n("Promise"))).reject(s)):this.processMultipleMessages(void 0,l,i,"msgCollectionGetStarred")});function t(t,n,r){return e.apply(this,arguments)}return t})(),i.getEventMsgs=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r={count:typeof t=="number"&&!Number.isNaN(t)?t:o("WAWebCollectionConstants").PAGE_SIZE,chat:e,remote:n==null?void 0:n.remote,id:n==null?void 0:n.id,fromMe:n==null?void 0:n.fromMe,participant:n==null?void 0:n.participant},a={add:"search"},i=yield o("WAWebDBMessageFindLocal").msgFindQuery("event",r),l=i.status;if(i.status>=400)throw l===499?o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getEventMsgs error 499 (unimplemented)"]))):o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getEventMsgs error ",""])),l),new(o("WAWebBaseCollection")).CollectionSilentQueryError(l);return this.processMultipleMessages(void 0,i,a,"msgCollectionGetEvents")});function t(t,n,r){return e.apply(this,arguments)}return t})(),i.getVoipCallLogMsgs=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var r={count:typeof e=="number"&&!isNaN(e)?e:o("WAWebCollectionConstants").PAGE_SIZE,chat:void 0,remote:t==null?void 0:t.remote,id:t==null?void 0:t.id,fromMe:t==null?void 0:t.fromMe,participant:t==null?void 0:t.participant},a=yield o("WAWebDBMessageFindLocal").msgFindQuery("call_log",r),i=a.status;return a.status>=400?(i===499?o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getVoipCallLogMsgs error 499 (unimplemented)"]))):o("WALogger").WARN(f||(f=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getVoipCallLogMsgs error ",""])),i),(D||(D=n("Promise"))).reject(i)):this.processMultipleMessages(void 0,a,{add:"search"},"msgCollectionGetVoipCallLogs")});function t(t,n){return e.apply(this,arguments)}return t})(),i.getAllMediaMsgs=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var r={count:e!=null?e:x,chat:void 0,remote:t==null?void 0:t.remote,id:t==null?void 0:t.id,fromMe:t==null?void 0:t.fromMe,participant:t==null?void 0:t.participant,media:"allMedia"},a=yield o("WAWebDBMessageFindLocal").msgFindQuery("media",r),i=a.status;return a.status!=null&&a.status>=400?(i===499?o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getAllMediaMsgs error 499 (unimplemented)"]))):o("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getAllMediaMsgs error ",""])),i),(D||(D=n("Promise"))).reject(i)):this.processMultipleMessages(void 0,Array.isArray(a)?a:a.messages,{add:"search"},"msgCollectionGetAllMedia")});function t(t,n){return e.apply(this,arguments)}return t})(),i.getAllLinksMsgs=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var r={count:e!=null?e:x,chat:void 0,remote:t==null?void 0:t.remote,id:t==null?void 0:t.id,fromMe:t==null?void 0:t.fromMe,participant:t==null?void 0:t.participant,media:"allLinks"},a=yield o("WAWebDBMessageFindLocal").msgFindQuery("media",r),i=a.status;return a.status!=null&&a.status>=400?(i===499?o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getAllLinksMsgs error 499 (unimplemented)"]))):o("WALogger").WARN(C||(C=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getAllLinksMsgs error ",""])),i),(D||(D=n("Promise"))).reject(i)):this.processMultipleMessages(void 0,Array.isArray(a)?a:a.messages,{add:"search"},"msgCollectionGetAllMedia")});function t(t,n){return e.apply(this,arguments)}return t})(),i.getAllDocsMsgs=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var r={count:e!=null?e:x,chat:void 0,remote:t==null?void 0:t.remote,id:t==null?void 0:t.id,fromMe:t==null?void 0:t.fromMe,participant:t==null?void 0:t.participant,media:"allDocs"},a=yield o("WAWebDBMessageFindLocal").msgFindQuery("media",r),i=a.status;return a.status!=null&&a.status>=400?(i===499?o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getAllDocsMsgs error 499 (unimplemented)"]))):o("WALogger").WARN(v||(v=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getAllDocsMsgs error ",""])),i),(D||(D=n("Promise"))).reject(i)):this.processMultipleMessages(void 0,Array.isArray(a)?a:a.messages,{add:"search"},"msgCollectionGetAllMedia")});function t(t,n){return e.apply(this,arguments)}return t})(),i.getMessagesById=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebDBMsgUtils").getMsgsByMsgKey(e);return o("WAPromiseProps").promiseProps({messages:this.processMultipleMessages(void 0,t,{add:"search"},"msgCollectionGetMessagesById"),eof:!0,canceled:!1})});function t(t){return e.apply(this,arguments)}return t})(),i.hydrateOrGetMessages=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this,n=e.filter(function(e){return!t.get(e)});if(n.length>0){var a=yield this.getMessagesById(n),i=a.messages;if(i.length!==n.length)throw new(o("WAWebBaseCollection")).CollectionSilentQueryError("No message found for one or more ids")}return e.map(function(e){return r("WANullthrows")(t.get(e))})});function t(t){return e.apply(this,arguments)}return t})(),i.queryVcard=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebDBMessageFindLocal").queryVcard(e);return this.processMultipleMessages(void 0,t,{add:"search"},"msgCollectionQueryVCard")});function t(t){return e.apply(this,arguments)}return t})(),i.incrementalStarredUpdate=function(t){return this.processMultipleMessages(void 0,t,{add:"search"},"msgCollectionIncrementalStarredUpdate")},i.search=function(t,n,r,a,i){var e=this;n===void 0&&(n=1),i===void 0&&(i={});var l=t+"__"+(i.label||i.kind&&i.kind||"");if(n===1&&!a){var s=this.ftsCache[l];if(s)return s;var u=this._search(t,n,r,a,i.label,i.kind);this.ftsCache[l]=u;var c=function(){e.ftsCache[l]=null};return self.setTimeout(c,o("WAWebFtsConstants").FTS_TTL),u.catch(c),u}return this._search(t,n,r,a,i.label,i.kind)},i._search=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,a,i,l){var s={searchTerm:e,page:o("WATypeUtils").isNumber(t)&&t!==0?t:1,count:o("WATypeUtils").isNumber(r)&&r!==0?r:o("WAWebCollectionConstants").PAGE_SIZE,remote:a,tagToCancel:a?this.pendingSearchTag:void 0,label:i,kind:l},u={add:"search"},c=yield o("WAWebDBMessageFindLocal").msgFindQuery("search",s);if(s.tagToCancel===this.pendingSearchTag&&(this.pendingSearchTag=void 0),c.status===499)return o("WAPromiseProps").promiseProps({messages:(D||(D=n("Promise"))).resolve([]),eof:!1,canceled:!0});if(c.status===404)return(D||(D=n("Promise"))).reject(new(o("WAWebBackendErrors")).E404);if(c.status>=400)return o("WALogger").WARN(S||(S=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:search error ",""])),c.status),(D||(D=n("Promise"))).reject(new(o("WAWebBackendErrors")).ServerStatusCodeError(c.status,"failed to find a msg during fts"));var d=Array.isArray(c)?c:c.messages,m=Array.isArray(c)?!0:c.eof,p=d.filter(function(e){return(e==null?void 0:e.isGroupStatus)!==!0});return o("WAPromiseProps").promiseProps({messages:this.processMultipleMessages(void 0,p,u,"msgCollectionSearch"),eof:m,canceled:!1})});function t(t,n,r,o,a,i){return e.apply(this,arguments)}return t})(),i.queryMedia=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,a,i){var l={remote:e,count:o("WATypeUtils").isNumber(t)&&t!==0?t:o("WAWebCollectionConstants").PAGE_SIZE,id:a==null?void 0:a.id,fromMe:a==null?void 0:a.fromMe,participant:a==null?void 0:a.participant,direction:r||"before",media:i,msgKey:a},s={add:"search"},u=yield o("WAWebDBMessageFindLocal").msgFindQuery("media",l);return u.status>=400?(o("WALogger").WARN(R||(R=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:media error ",""])),u.status),u.status===404?(D||(D=n("Promise"))).reject(new(o("WAWebBackendErrors")).E404):(D||(D=n("Promise"))).reject(new(o("WAWebBackendErrors")).ServerStatusCodeError(u.status,"failed to find a msg during media query"))):i?this.processMultipleMessages(void 0,u,{add:"search"},"msgCollectionQueryMedia"):o("WAPromiseProps").promiseProps({docCount:u.docCount,linkCount:u.linkCount,mediaCount:u.mediaCount,messages:this.processMultipleMessages(void 0,u.messages,s,"msgCollectionQueryMedia")})});function t(t,n,r,o,a){return e.apply(this,arguments)}return t})(),i.getContext=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var a=this,i=this.get(e),l=r("WAWebWid").isNewsletter(e.remote);if(i&&!i.fromQuotedMsg)return(D||(D=n("Promise"))).all([o("WAWebDBMessageFindLocal").msgFindQuery("before",e),o("WAWebDBMessageFindLocal").msgFindQuery("after",e)]).then((function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(r){var s=r[0],u=r[1];if((!Array.isArray(s)||!Array.isArray(u))&&!l)throw o("WALogger").WARN(L||(L=babelHelpers.taggedTemplateLiteralLoose(["model:msg:getContext fetch error"]))).devConsole(s,u),s.status||u.status;var c=Array.isArray(s)?s:[],d=Array.isArray(u)?u:[],m=i.serverId;return i.search=!1,(D||(D=n("Promise"))).all([a.processMultipleMessages(e.remote,!l||m==null?c:yield o("WAWebNewsletterMsgHistoryUtils").fillMsgHistoryGaps({jid:e.remote,msgs:c.concat(o("WAWebMsgDataFromModel").msgDataFromMsgModel(i)),range:{start:m-e.count,end:m},serverIdsToSkip:o("WAWebNewsletterViewModeUIUtils").getHiddenMessageServerIdsForChat(e.remote)}),{add:"before",isHistory:!0},"msgCollectionGetContext",t),a.processMultipleMessages(e.remote,!l||m==null?d:yield o("WAWebNewsletterMsgHistoryUtils").fillMsgHistoryGaps({jid:e.remote,msgs:[o("WAWebMsgDataFromModel").msgDataFromMsgModel(i)].concat(d),range:{start:m,end:m+e.count},serverIdsToSkip:o("WAWebNewsletterViewModeUIUtils").getHiddenMessageServerIdsForChat(e.remote)}),{add:"after",isHistory:!0},"msgCollectionGetContext",t)])});return function(e){return r.apply(this,arguments)}})());var s={add:"after",isHistory:!0};return o("WAWebDBMessageFindLocal").msgFindQuery("after",e).then((function(){var i=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){if(!Array.isArray(n))throw o("WALogger").WARN(E||(E=babelHelpers.taggedTemplateLiteralLoose(["model:msg:getContext:after fetch error"]))).devConsole(n),n.status;if(r("WAWebWid").isStatus(n[0].id.remote))throw r("err")("status, stop querying before the msg");var i=e.serverId;return a.processMultipleMessages(e.remote,!l||i==null?n:yield o("WAWebNewsletterMsgHistoryUtils").fillMsgHistoryGaps({jid:e.remote,msgs:n,range:{start:i,end:i+e.count},serverIdsToSkip:o("WAWebNewsletterViewModeUIUtils").getHiddenMessageServerIdsForChat(e.remote)}),s,"msgCollectionFindQuery",t)});return function(e){return i.apply(this,arguments)}})()).then(function(t){var i=r("WANullthrows")(t[0]),s=i.id.clone();s.count=e.count+1;var u={add:"before",isHistory:!0};return(D||(D=n("Promise"))).all([o("WAWebDBMessageFindLocal").msgFindQuery("before",s).then((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(!Array.isArray(t))throw o("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["model:msg:getContext:before fetch error"]))).devConsole(t),t.status;var n=t[t.length-1];n.fromQuotedMsg=!1;var r=n.id;if(!r.equals(e))throw o("WALogger").WARN(I||(I=babelHelpers.taggedTemplateLiteralLoose(["model:msg:getContext:before ctx message mismatch"]))).devConsole(t),405;var s=function(){return i.msgChunk},c=i.serverId;return a.processMultipleMessages(e.remote,!l||c==null?t:yield o("WAWebNewsletterMsgHistoryUtils").fillMsgHistoryGaps({jid:e.remote,msgs:t,range:{start:c,end:c-e.count},serverIdsToSkip:o("WAWebNewsletterViewModeUIUtils").getHiddenMessageServerIdsForChat(e.remote)}),u,"msgCollectionFindQuery",s)});return function(e){return t.apply(this,arguments)}})()),D.resolve(t)])})});function t(t,n){return e.apply(this,arguments)}return t})(),i.hasSynced=function(){return r("WAWebEventsWaitForBbEvent")(this,o("WAWebCollectionConstants").COLLECTION_HAS_SYNCED)},i.processMultipleMessages=function(t,n,a,i,l,s){var e=this;s===void 0&&(s=!0),t!=null&&t.isRegularUser()&&o("WALogger").LOG(T||(T=babelHelpers.taggedTemplateLiteralLoose(["processMultipleMessages. processMessageOrigin: ",""])),i).tags("missing-lid");var u=function(){return o("WAWebProcessMultipleMsgsAction")._processMultipleMessages(t,n,a,i,l)};if(t){var c,d=this.pendingAdd[t];return d&&s?c=d.then(u):c=u(),c.finally(function(){t&&e.pendingAdd[t]===c&&(e.pendingAdd[t]=null)}).catch(r("WAWebNoop")),this.pendingAdd[t]=c}return u()},i.hasUnsentMessages=function(){return this.some(function(e){return e.ack===o("WAWebAck").ACK.CLOCK&&e.local&&o("WAWebMsgGetters").getIsSentByMe(e)})},i.getByEditMsgKey=function(t){var e=this._parentKeyByEditKey.get(t.toString());return e&&this.get(e)},i.processEditedMessages=function(t){var e=this;t.forEach(function(t){if(!(!t||!o("WAWebMsgGetters").getIsEdited(t))){var n=e._editKeyByParentKey.get(t.id.toString());n!=null&&e._parentKeyByEditKey.delete(n);var r=t.latestEditMsgKey;r&&(e._editKeyByParentKey.set(t.id.toString(),r.toString()),e._parentKeyByEditKey.set(r.toString(),t.id))}})},i.addInitialBotTypingIndicatorToChat=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n,r=o("WAWebChatCollection").ChatCollection.get(e);if(!(!r||!(r!=null&&r.id.isBot())&&!((n=r.contact.businessProfile)!=null&&n.isBizBot3p))){if(r.botInitialTypingIndicatorMsgId!=null){var a=this.get(r.botInitialTypingIndicatorMsgId);if(a==null)return;a==null||a.delete({skipUpdatingSortTime:!0})}r.set({botInitialTypingIndicatorMsgId:t},{silent:!0});var i={id:t,t:o("WATimeUtils").unixTime(),from:e,to:o("WAWebUserPrefsMeUser").getMaybeMePnUser(),type:"chat",subtype:o("WAWebBotGenTypingIndicatorMsg").BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE,body:""};this.processMultipleMessages(e,[babelHelpers.extends({},i,{recvFresh:!0,isNewMsg:!0})],{add:"after",isHistory:!1},"createChatOnNewMsg",null,!0)}});function t(t,n){return e.apply(this,arguments)}return t})(),i.encryptAndClearModels=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=this._models.map(function(e){return o("WAWebMsgOpaqueData").encryptDataInMsgModel(e)});yield(D||(D=n("Promise"))).all(e)});function t(){return e.apply(this,arguments)}return t})(),i.decryptAndSetModels=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this._models.map(function(t){return o("WAWebMsgOpaqueData").decryptDataInMsgModel(t,e)});yield(D||(D=n("Promise"))).all(t)});function t(t){return e.apply(this,arguments)}return t})(),a})(o("WAWebBaseCollection").BaseCollection);$.model=o("WAWebMsgModel").Msg;var P=new $;l.MEDIA_QUERY_LIMIT=x,l.MsgCollectionImpl=$,l.MsgCollection=P}),98);
__d("WAWebMsgInfoAction",["WAWebAck","WAWebStateUtils","WAWebWid"],(function(t,n,r,o,a,i,l){function e(e,t,n,a){var i=o("WAWebStateUtils").unproxy(e),l=i.id,c=r("WAWebWid").isUser(l.remote);c?s(i,t,n,a):u(i,t,n,a)}function s(e,t,n,r){t===o("WAWebAck").ACK.PLAYED?(e.played.get(n)||(e.playedRemaining-=1),e.played.add({id:n,t:r})):t===o("WAWebAck").ACK.READ?(e.read.get(n)||(e.readRemaining-=1),e.read.add({id:n,t:r})):t===o("WAWebAck").ACK.RECEIVED&&(e.delivery.get(n)||(e.deliveryRemaining-=1),e.delivery.add({id:n,t:r}))}function u(e,t,n,r){var a,i=o("WAWebAck").ACK.CLOCK;if(e.played.get(n)?i=o("WAWebAck").ACK.PLAYED:e.read.get(n)?i=o("WAWebAck").ACK.READ:e.delivery.get(n)&&(i=o("WAWebAck").ACK.RECEIVED),!(t<=i)){if(t>o("WAWebAck").ACK.RECEIVED){var l=e.delivery.get(n);l?e.delivery.remove(l):e.deliveryRemaining-=1}if(t>o("WAWebAck").ACK.READ){var s=e.read.get(n);s?e.read.remove(s):e.readRemaining-=1}t===o("WAWebAck").ACK.READ&&e!=null&&(a=e.id)!=null&&(a=a.remote)!=null&&a.isGroup()&&n!=null&&n.isBot()&&(e.readRemaining+=1),t===o("WAWebAck").ACK.PLAYED?(e.played.get(n)||(e.playedRemaining-=1),e.played.add({id:n,t:r})):t===o("WAWebAck").ACK.READ?(e.read.get(n)||(e.readRemaining-=1),e.read.add({id:n,t:r})):t===o("WAWebAck").ACK.RECEIVED&&(e.delivery.get(n)||(e.deliveryRemaining-=1),e.delivery.add({id:n,t:r}))}}l.updateMsgInfo=e}),98);
__d("WAWebMsgInfoCollection",["Promise","WALogger","WAWebApiMessageInfoStore","WAWebBaseCollection","WAWebChatGetters","WAWebHandleMsgTypes.flow","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgInfoAction","WAWebMsgInfoModel","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d;function m(t,n){var a=n.read,i=n.played,l=n.delivery,s=n.readRemaining,u=n.playedRemaining,c=n.deliveryRemaining,d=n.deliveryPrivacyMode,m={id:t,read:a.map(function(e){return babelHelpers.extends({},e)}),readRemaining:s,played:i.map(function(e){return babelHelpers.extends({},e)}),playedRemaining:u,delivery:l.map(function(e){return babelHelpers.extends({},e)}),deliveryRemaining:c};if(d!=null){var p=o("WAWebHandleMsgTypes.flow").HostStorageEnumType.cast(d.hostStorage),_=o("WAWebHandleMsgTypes.flow").ActualActorsEnumType.cast(d.actualActors);if(_==null||p==null)throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["queryMsgInfo: got unsupported host storage or actual actors"]))).sendLogs("queryMsgInfo-incorrect-enums"),r("err")("queryMsgInfo: got unsupported host storage or actual actors");var f={hostStorage:p,privacyModeTs:d.privacyModeTs,actualActors:_};m.deliveryPrivacyMode=f}return m}function p(e){var t=e.id;return o("WAWebChatGetters").getIsNewsletter(e)?t.fromMe:t.self==="in"||o("WAWebMsgGetters").getIsNotification(e)?!1:o("WAWebUserPrefsMeUser").isMeAccount(e.from)}var _=(function(e){function t(){for(var t,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a))||this,t.findImpl=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebMsgCollection").MsgCollection.get(e);if(t){if(!o("WAWebMsgGetters").getIsSentByMe(t))return p(t)&&o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["message not sent by me: from: ",", fromMe: ",", isMeAccount: ",", type: ",", isNewsletter: ",""])),t.from.toString(),t.id.fromMe,o("WAWebUserPrefsMeUser").isMeAccount(t.from),t.type,o("WAWebChatGetters").getIsNewsletter(t)).sendLogs("msg-info-collection-msg-not-sent-by-me"),(d||(d=n("Promise"))).reject(new(o("WAWebBaseCollection")).CollectionSilentQueryError("message not sent by me"))}else return(d||(d=n("Promise"))).reject(new(o("WAWebBaseCollection")).CollectionSilentQueryError("No message found for id: "+e.toString()));var r;try{r=yield o("WAWebApiMessageInfoStore").queryMsgInfo(e)}catch(e){throw o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["queryMsgInfo: failed to find msg info in storage"]))).verbose().devConsole(e).sendLogs("queryMsgInfo failed"),e}var a=m(e,r);return babelHelpers.extends({},a,{usePlayReceipt:t.type===o("WAWebMsgType").MSG_TYPE.PTT||t.isViewOnce})});return function(t){return e.apply(this,arguments)}})(),t.findManyAndUpdate=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=new Map,r=[];e.forEach(function(e){var t=o("WAWebMsgCollection").MsgCollection.get(e);t&&o("WAWebMsgGetters").getIsSentByMe(t)&&r.push(t)});var a;try{a=yield o("WAWebApiMessageInfoStore").queryMsgInfos(e)}catch(e){throw o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["queryMsgInfos: failed to find msg info in storage"]))).verbose().devConsole(e).sendLogs("queryMsgInfos failed"),e}return r.forEach(function(e){var r=e.id,i=a.get(r.toString());if(!i)return(d||(d=n("Promise"))).reject(new(o("WAWebBaseCollection")).CollectionSilentQueryError("query returned no msg info for msg "+r.toString()));var l=babelHelpers.extends({},m(r,i),{usePlayReceipt:e.type===o("WAWebMsgType").MSG_TYPE.PTT||e.isViewOnce}),s=f.gaddUp(l);t.set(r.toString(),s)}),t});return function(t){return e.apply(this,arguments)}})(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a.updateInfo=function(t,n,a,i,l,s){var e=new(r("WAWebMsgKey"))({from:n,to:a,id:t,participant:l}),u=new(r("WAWebMsgKey"))({from:n,to:a,id:t}),c=this.get(e)||this.get(u);if(c)return o("WAWebMsgInfoAction").updateMsgInfo(c,i,l,s)},t})(o("WAWebBaseCollection").BaseCollection);_.model=o("WAWebMsgInfoModel").MsgInfo,_.staleCollection=!0;var f=new _;l.MsgInfoCollection=f}),98);
__d("WAWebMsgInfoGetters",["WAWebGetters","WAWebGettersCaches"],(function(t,n,r,o,a,i,l){var e=o("WAWebGetters").createGetterFactories({createCache:o("WAWebGettersCaches").createMsgInfosCache}),s=e.field,u=e.clearCacheFor,c=u,d=s("playedRemaining"),m=s("readRemaining"),p=s("deliveryRemaining");l.clearMsgInfoGetterCacheFor=c,l.getPlayedRemaining=d,l.getReadRemaining=m,l.getDeliveryRemaining=p}),98);
__d("WAWebMsgInfoModel",["WAWebBaseModel","WAWebCollection","WAWebContactCollection","WAWebContactComparator","WAWebMsgInfoCollection","WAWebMsgInfoGetters","WAWebMsgKey","WAWebWid"],(function(t,n,r,o,a,i,l){var e,s=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.t=o("WAWebBaseModel").prop(),t.contact=o("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.initialize=function(){e.prototype.initialize.call(this),this.addChild("contact",o("WAWebContactCollection").ContactCollection.gadd(this.id))},t})((e=o("WAWebBaseModel")).BaseModel);s.Proxy="msgInfoParticipant",s.idClass=r("WAWebWid");var u=e.defineModel(s),c=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(r("WAWebCollection"));c.model=u,c.comparator=function(e,t){return o("WAWebContactComparator").ContactComparator(e.contact,t.contact)};var d=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.usePlayReceipt=o("WAWebBaseModel").prop(),t.playedRemaining=o("WAWebBaseModel").prop(0),t.readRemaining=o("WAWebBaseModel").prop(0),t.deliveryRemaining=o("WAWebBaseModel").prop(0),t.deliveryPrivacyMode=o("WAWebBaseModel").prop(),t.played=o("WAWebBaseModel").collection(c),t.read=o("WAWebBaseModel").collection(c),t.delivery=o("WAWebBaseModel").collection(c),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getCollection=function(){return o("WAWebMsgInfoCollection").MsgInfoCollection},n.delete=function(){e.prototype.delete.call(this),o("WAWebMsgInfoGetters").clearMsgInfoGetterCacheFor(this)},t})(e.BaseModel);d.Proxy="msgInfo",d.idClass=r("WAWebMsgKey");var m=e.defineModel(d);l.MsgInfoParticipant=u,l.ParticipantCollection=c,l.MsgInfo=m}),98);
__d("WAWebMsgInfoUtils",["WAWebAgentModelUtils","WAWebBizCtwaAGMUtils","WAWebChatCollection","WAWebFrontendMsgGetters","WAWebGroupType","WAWebMsgGetters"],(function(t,n,r,o,a,i,l){function e(e){var t,n;return o("WAWebMsgGetters").getIsNewsletterMsg(e)||o("WAWebFrontendMsgGetters").getAsAlbum(e)||o("WAWebFrontendMsgGetters").getAsCallLog(e)||o("WAWebBizCtwaAGMUtils").isAutomatedGreetingMessage((t=e.ctwaContext)==null?void 0:t.sourceApp,e.type,(n=e.ctwaContext)==null?void 0:n.automatedGreetingMessageShown)?!1:!!(o("WAWebMsgGetters").getIsSentByMe(e)&&!o("WAWebFrontendMsgGetters").getAsRevoked(e)&&!e.mayFail()&&(!e.isMdHistoryMsg||o("WAWebAgentModelUtils").canUserSeeMessageAttribution()&&e.agentId!=null))}function s(e,t){var n={};return e.isGroup()&&(n.groupData=u(e,t)),n}function u(e,t){var n=o("WAWebChatCollection").ChatCollection.get(e),r={groupId:e.toString(),amIAdmin:null,isCag:null,isLid:t,isLidAddressingMode:null,wamTypeOfGroup:null,participantCount:null,deviceCount:null,deviceSizeBucket:null,isCapiGroup:null},a=n==null?void 0:n.groupMetadata;if(a){var i=!!(a!=null&&a.isLidAddressingMode),l=o("WAWebGroupType").getGroupTypeFromGroupMetadata(a),s=l===o("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP;r.wamTypeOfGroup=o("WAWebGroupType").groupTypeToWamEnum(l),r.isCag=s,r.isLidAddressingMode=i,r.isCapiGroup=a.hasCapi===!0,r.amIAdmin=a.participants.iAmAdmin(),r.participantCount=a.participants.length}return r}l.canOpenInfoDrawer=e,l.getGroupMessageSendReporterOptions=s}),98);
__d("WAWebMsgLinks",["WAUnicodeUtils","WAWebABProps","WAWebFrontendMsgGetters","WAWebLinkify","WAWebMsgGetters","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebStateUtils","uniqueBy"],(function(t,n,r,o,a,i,l){function e(e){var t=e.content,n=e.sender,r=e.cachedValue,a=r===void 0?[]:r,i=e.currentIndex,l=i===void 0?0:i,u=e.endIndex,c=u===void 0?1/0:u;if(l>=c)return[a,c];var d=o("WAUnicodeUtils").firstNCodepoints(t,c),m=!1,p=o("WAWebLinkify").findLinks(d,m,n);return p.length>0&&(p=s(p,t,d,c,n)),[p,c]}var s=function(t,n,r,a,i){if(o("WAWebABProps").getABPropConfigValue("wa_web_dont_linkify_trauncated_links_enabled")!==!0)return t;var e=o("WAUnicodeUtils").numCodepoints(r),l=o("WAUnicodeUtils").numCodepoints(n);if(e<l&&t.length>0){var s=t[t.length-1];if(s==null||s.index==null||s.url==null||s.href==null)return t.pop(),t;var u=o("WAUnicodeUtils").numCodepoints(r.slice(0,s.index)),c=u+o("WAUnicodeUtils").numCodepoints(s.url);if(c===a){var d=o("WAWebLinkify").findLinks(n,!1,i),m=u,p=d[d.length-1];if(p==null||p.url==null)return t.filter(function(e){return e.href!==s.href});var _=m+o("WAUnicodeUtils").numCodepoints(p.url);if(_>e)return t.filter(function(e){return e.href!==s.href})}}return t};function u(t,n){var r=o("WAWebStateUtils").unproxy(t),a=n!=null?n:r.linksIndexParsed?r.linksIndexParsed:o("WAWebMsgGetters").getInitialPageSize(r)+1,i=o("WAWebFrontendMsgGetters").getText(r);if(i==null||r.linksIndexParsed===1/0)return r.getRawLinks();var l=e({content:i,sender:o("WAWebMsgGetters").getSender(r),cachedValue:r.getRawLinks(),currentIndex:r.linksIndexParsed,endIndex:a}),s=l[0],u=l[1];return r.linksIndexParsed=u,r.setRawLinks(s),s}function c(t,n){var r,a=o("WAWebStateUtils").unproxy(t);if(a.pollOptions==null)return null;if(a.getRawPollOptionsToLinks()==null){var i,l=new Map((i=a.pollOptions)==null?void 0:i.map(function(t){var n=e({content:t.name,sender:o("WAWebMsgGetters").getSender(a)}),r=n[0];return[t,r]}));a.setRawPollOptionsToLinks(l)}return(r=a.getRawPollOptionsToLinks())==null?void 0:r.get(n)}function d(e,t){if(t){var n,r;return e.type==="list"&&((n=e.list)==null?void 0:n.listType)===o("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.SINGLE_SELECT&&((r=e.list)==null?void 0:r.title)!=null}return e.isDynamicReplyButtonsMsg===!0&&e.title!=null}function m(t,n){if(t.getRawHeaderLinks().length>0)return t.getRawHeaderLinks();var r=e({content:n,sender:o("WAWebMsgGetters").getSender(t),cachedValue:t.getRawHeaderLinks()}),a=r[0];return a.length>0&&t.setRawHeaderLinks(a),a}function p(e){var t,n=o("WAWebStateUtils").unproxy(e);if(d(n,!0)){var r;return m(n,((r=n.list)==null?void 0:r.title)||"")}else{if(d(n,!1))return m(n,n.title);if(n.type===o("WAWebMsgType").MSG_TYPE.INTERACTIVE&&((t=n.interactiveHeader)==null?void 0:t.title)!=null)return m(n,n.interactiveHeader.title)}return[]}function _(t){var n=o("WAWebStateUtils").unproxy(t),r=n.footer;if(!o("WAWebMsgGetters").getSupportsMessageFooterLinks(n)||r==null)return[];if(n.getRawFooterLinks().length>0)return n.getRawFooterLinks();var a=e({content:r,sender:o("WAWebMsgGetters").getSender(n),cachedValue:n.getRawFooterLinks()}),i=a[0];return i.length>0&&n.setRawFooterLinks(i),i}function f(e){var t=o("WAWebStateUtils").unproxy(e);return r("uniqueBy")(u(t),function(e){return e.href}).filter(function(e){return e.isHttp})}function g(e){var t=o("WAWebStateUtils").unproxy(e);return u(t).filter(function(e){var t;return(t=e.suspiciousCharacters)==null?void 0:t.size})}l.getLinksFromMsgImpl=e,l.getLinksFromMsg=u,l.getPollOptionLinks=c,l.shouldDisplayHeaderLinks=d,l.getHeaderLinks=p,l.getFooterLinks=_,l.getGalleryLinks=f,l.getSuspiciousLinks=g}),98);
__d("WAWebSuspendedGroupMediaDownloadFailureModal.react",["fbt","WAWebConfirmPopup.react","WAWebModalManager","react"],(function(t,n,r,o,a,i,l,s){var e,u=e||(e=r("react"));function c(){var e=function(){return o("WAWebModalManager").ModalManager.close()};return u.jsx(o("WAWebConfirmPopup.react").ConfirmPopup,{onOK:e,title:s._(/*BTDS*/"Descarga fallida"),children:s._(/*BTDS*/"El archivo multimedia ya no est\u00e1 disponible.")})}c.displayName=c.name+" [from "+i.id+"]",l.default=c}),226);
__d("WAWebMsgModel",["Promise","WAJids","WALogger","WATimeUtils","WATypeUtils","WAWebAck","WAWebApiContact","WAWebBaseModel","WAWebBizLabelUtils","WAWebBotGenTypingIndicatorMsg","WAWebBotTypes","WAWebBusinessHSMTypes","WAWebBusinessProfileTypes","WAWebCarouselCardsCollection","WAWebChangePresenceHandlerAction","WAWebChatCollection","WAWebChatCommunityUtils","WAWebChatContactUtils","WAWebChatGetMessage","WAWebChatGetters","WAWebChatGroupUtils","WAWebCmd","WAWebCommonMsgUtils","WAWebConnModel","WAWebConstantsDeprecated","WAWebContactCollection","WAWebDBUpdateMessageTable","WAWebDirectConnectionGatingUtils","WAWebEphemeralKeepInChatAbpropUtils","WAWebEphemeralityTypes","WAWebEventsWaitForBbEvent","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebInvisiblePlaceholderViewModeProcessor","WAWebLabelCollection","WAWebLidMigrationUtils","WAWebMedia","WAWebMediaData","WAWebMediaTypes","WAWebMessageAssociationGatingUtils","WAWebMessageAssociationUIUtils","WAWebMessageReceiptUtils","WAWebMiscGatingUtils","WAWebModalManager","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgKey","WAWebMsgModelPropUtils","WAWebMsgModelUtils","WAWebMsgType","WAWebMuteCollection","WAWebNewsletterCollection","WAWebNewsletterSendMsgAction","WAWebNotificationsMsgNotification","WAWebPinInChatCollection","WAWebPromiseQueue","WAWebSendMessageEditAction","WAWebSendMsgRecordAction","WAWebStarredMsgCollection","WAWebSuspendedGroupMediaDownloadFailureModal.react","WAWebUserPrefsMeUser","WAWebUsernameGatingUtils","WAWebVcardParsingUtils","WAWebViewMode.flow","WAWebViewModeUtils","WAWebViewOnceState","WAWebWamEnumDisappearingChatInitiatorType","WAWebWamEnumWebcRmrReasonCode","WAWebWamMsgUtils","WAWebWid","WAWebWidFactory","WAWebWidFormat","asyncToGeneratorRuntime","err","fbs","gkx","isStringNullOrEmpty","lodash","react"],(function(t,n,r,o,a,i,l){var e=["id","t","notifyName","from","to","author","ack","invis","isNewMsg","star","recvFresh","recipients","broadcast","quotedMsg","quotedStanzaID","quotedRemoteJid","quotedParticipant","quotedType","senderObj","multicast","replyButtons","buttons","latestEditMsgKey","latestEditSenderTimestampMs"],s,u,c,d,m,p,_,f,g,h=g||(g=r("react")),y=(function(t){function a(){for(var e,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a))||this,e.id=o("WAWebBaseModel").prop(),e.rowId=o("WAWebBaseModel").prop(),e.serverId=o("WAWebBaseModel").prop(),e.parentServerId=o("WAWebBaseModel").prop(),e.questionResponseInfo=o("WAWebBaseModel").prop(),e.viewCount=o("WAWebBaseModel").prop(),e.viewed=o("WAWebBaseModel").prop(!1),e.body=o("WAWebBaseModel").prop(),e.type=o("WAWebBaseModel").prop(),e.typeFlag=o("WAWebBaseModel").prop(),e.subtype=o("WAWebBaseModel").prop(),e.t=o("WAWebBaseModel").prop(),e.clientReceivedTsMillis=o("WAWebBaseModel").prop(),e.revokeTimestamp=o("WAWebBaseModel").prop(),e.notifyName=o("WAWebBaseModel").prop(),e.from=o("WAWebBaseModel").prop(),e.to=o("WAWebBaseModel").prop(),e.author=o("WAWebBaseModel").prop(),e.ack=o("WAWebBaseModel").prop(),e.invis=o("WAWebBaseModel").prop(),e.isNewMsg=o("WAWebBaseModel").prop(),e.star=o("WAWebBaseModel").prop(!1),e.kicKey=o("WAWebBaseModel").prop(),e.kicState=o("WAWebBaseModel").prop(),e.kicTimestampMs=o("WAWebBaseModel").prop(),e.kicNotified=o("WAWebBaseModel").prop(!1),e.keepType=o("WAWebBaseModel").prop(),e.keptMessageKey=o("WAWebBaseModel").prop(),e.keptCount=o("WAWebBaseModel").prop(),e.recvFresh=o("WAWebBaseModel").prop(),e.caption=o("WAWebBaseModel").prop(),e.interactiveAnnotations=o("WAWebBaseModel").prop(),e.contextInfo=o("WAWebBaseModel").prop(),e.clientUrl=o("WAWebBaseModel").prop(),e.loc=o("WAWebBaseModel").prop(),e.lat=o("WAWebBaseModel").prop(),e.lng=o("WAWebBaseModel").prop(),e.isLive=o("WAWebBaseModel").prop(),e.accuracy=o("WAWebBaseModel").prop(),e.speed=o("WAWebBaseModel").prop(),e.degrees=o("WAWebBaseModel").prop(),e.comment=o("WAWebBaseModel").prop(),e.sequence=o("WAWebBaseModel").prop(),e.shareDuration=o("WAWebBaseModel").prop(),e.finalLat=o("WAWebBaseModel").prop(),e.finalLng=o("WAWebBaseModel").prop(),e.finalAccuracy=o("WAWebBaseModel").prop(),e.finalThumbnail=o("WAWebBaseModel").prop(),e.finalSpeed=o("WAWebBaseModel").prop(),e.finalDegrees=o("WAWebBaseModel").prop(),e.finalTimeOffset=o("WAWebBaseModel").prop(),e.deprecatedMms3Url=o("WAWebBaseModel").prop(),e.directPath=o("WAWebBaseModel").prop(),e.mimetype=o("WAWebBaseModel").prop(),e.duration=o("WAWebBaseModel").prop(),e.filehash=o("WAWebBaseModel").prop(),e.encFilehash=o("WAWebBaseModel").prop(),e.size=o("WAWebBaseModel").prop(),e.filename=o("WAWebBaseModel").prop(),e.streamingSidecar=o("WAWebBaseModel").prop(),e.mediaKey=o("WAWebBaseModel").prop(),e.mediaKeyTimestamp=o("WAWebBaseModel").prop(),e.pageCount=o("WAWebBaseModel").prop(),e.isGif=o("WAWebBaseModel").prop(),e.gifAttribution=o("WAWebBaseModel").prop(),e.accessibilityLabel=o("WAWebBaseModel").prop(),e.isViewOnce=o("WAWebBaseModel").prop(),e.streamable=o("WAWebBaseModel").prop(),e.width=o("WAWebBaseModel").prop(),e.height=o("WAWebBaseModel").prop(),e.thumbnailDirectPath=o("WAWebBaseModel").prop(),e.thumbnailSha256=o("WAWebBaseModel").prop(),e.thumbnailEncSha256=o("WAWebBaseModel").prop(),e.thumbnailHeight=o("WAWebBaseModel").prop(),e.thumbnailWidth=o("WAWebBaseModel").prop(),e.metadataUrl=o("WAWebBaseModel").prop(),e.waveform=o("WAWebBaseModel").prop(),e.staticUrl=o("WAWebBaseModel").prop(),e.stickerPackId=o("WAWebBaseModel").prop(),e.stickerPackName=o("WAWebBaseModel").prop(),e.stickerPackPublisher=o("WAWebBaseModel").prop(),e.stickers=o("WAWebBaseModel").prop(),e.trayIconFileName=o("WAWebBaseModel").prop(),e.stickerPackSize=o("WAWebBaseModel").prop(),e.mediaHandle=o("WAWebBaseModel").prop(),e.scanLengths=o("WAWebBaseModel").prop(),e.scansSidecar=o("WAWebBaseModel").prop(),e.isFromTemplate=o("WAWebBaseModel").prop(!1),e.devicesAdded=o("WAWebBaseModel").prop(),e.devicesRemoved=o("WAWebBaseModel").prop(),e.isThisDeviceAdded=o("WAWebBaseModel").prop(),e.firstFrameLength=o("WAWebBaseModel").prop(),e.firstFrameSidecar=o("WAWebBaseModel").prop(),e.isAnimated=o("WAWebBaseModel").prop(),e.isLottie=o("WAWebBaseModel").prop(),e.matchedText=o("WAWebBaseModel").prop(),e.thumbnail=o("WAWebBaseModel").prop(),e.thumbnailHQ=o("WAWebBaseModel").prop(),e.richPreviewType=o("WAWebBaseModel").prop(),e.doNotPlayInline=o("WAWebBaseModel").prop(),e.rcat=o("WAWebBaseModel").prop(),e.faviconMMSMetadata=o("WAWebBaseModel").prop(),e.title=o("WAWebBaseModel").prop(),e.description=o("WAWebBaseModel").prop(),e.isAdsMedia=o("WAWebBaseModel").prop(!1),e.paymentLinkMetadata=o("WAWebBaseModel").prop(),e.businessOwnerJid=o("WAWebBaseModel").prop(),e.productId=o("WAWebBaseModel").prop(),e.currencyCode=o("WAWebBaseModel").prop(),e.priceAmount1000=o("WAWebBaseModel").prop(),e.salePriceAmount1000=o("WAWebBaseModel").prop(),e.retailerId=o("WAWebBaseModel").prop(),e.url=o("WAWebBaseModel").prop(),e.productImageCount=o("WAWebBaseModel").prop(),e.sessionId=o("WAWebBaseModel").prop(),e.pollName=o("WAWebBaseModel").prop(),e.pollOptions=o("WAWebBaseModel").prop(),e.pollSelectableOptionsCount=o("WAWebBaseModel").prop(),e.pollInvalidated=o("WAWebBaseModel").prop(!1),e.pollContentType=o("WAWebBaseModel").prop(),e.pollType=o("WAWebBaseModel").prop(),e.correctOptionIndex=o("WAWebBaseModel").prop(),e.isSentCagPollCreation=o("WAWebBaseModel").prop(!1),e.pollUpdateParentKey=o("WAWebBaseModel").prop(),e.encPollVote=o("WAWebBaseModel").prop(),e.selectedOptionLocalIds=o("WAWebBaseModel").prop(),e.pollVotesSnapshot=o("WAWebBaseModel").prop(),e.quarantineExtractedText=o("WAWebBaseModel").prop(),e.quarantineOriginalProtobuf=o("WAWebBaseModel").prop(),e.senderTimestampMs=o("WAWebBaseModel").prop(),e.latestEditMsgKey=o("WAWebBaseModel").prop(null),e.latestEditSenderTimestampMs=o("WAWebBaseModel").prop(null),e.editMsgType=o("WAWebBaseModel").prop(),e.recipients=o("WAWebBaseModel").prop(),e.broadcast=o("WAWebBaseModel").prop(),e.quotedMsg=o("WAWebBaseModel").prop(),e.quotedStanzaID=o("WAWebBaseModel").prop(),e.quotedRemoteJid=o("WAWebBaseModel").prop(),e.quotedParticipant=o("WAWebBaseModel").prop(),e.quotedGroupSubject=o("WAWebBaseModel").prop(),e.quotedParentGroupJid=o("WAWebBaseModel").prop(),e.quotedType=o("WAWebBaseModel").prop(),e.mentionedJidList=o("WAWebBaseModel").prop(),e.reporterJidList=o("WAWebBaseModel").prop(),e.groupMentions=o("WAWebBaseModel").prop(),e.footer=o("WAWebBaseModel").prop(),e.hydratedButtons=o("WAWebBaseModel").prop(),e.buttons=o("WAWebBaseModel").session(),e.hsmTag=o("WAWebBaseModel").prop(),e.hsmCategory=o("WAWebBaseModel").prop(),e.templateId=o("WAWebBaseModel").prop(),e.eventName=o("WAWebBaseModel").prop(),e.isEventCanceled=o("WAWebBaseModel").prop(!1),e.eventDescription=o("WAWebBaseModel").prop(),e.eventJoinLink=o("WAWebBaseModel").prop(),e.eventStartTime=o("WAWebBaseModel").prop(),e.eventEndTime=o("WAWebBaseModel").prop(),e.eventLocation=o("WAWebBaseModel").prop(),e.eventInvalidated=o("WAWebBaseModel").prop(!1),e.eventIsScheduledCall=o("WAWebBaseModel").prop(),e.eventExtraGuestsAllowed=o("WAWebBaseModel").prop(),e.selectedId=o("WAWebBaseModel").prop(),e.selectedIndex=o("WAWebBaseModel").prop(),e.selectedCarouselCardIndex=o("WAWebBaseModel").prop(),e.multicast=o("WAWebBaseModel").prop(),e.urlText=o("WAWebBaseModel").prop(),e.urlNumber=o("WAWebBaseModel").prop(),e.statusMentioned=o("WAWebBaseModel").prop(),e.isWamoSub=o("WAWebBaseModel").prop(),e.clearMedia=o("WAWebBaseModel").prop(),e.isVcardOverMmsDocument=o("WAWebBaseModel").prop(!1),e.isCaptionByUser=o("WAWebBaseModel").prop(),e.vcardList=o("WAWebBaseModel").prop(),e.vcardFormattedName=o("WAWebBaseModel").prop(),e.revokeSender=o("WAWebBaseModel").prop(),e.protocolMessageKey=o("WAWebBaseModel").prop(),e.futureproofBuffer=o("WAWebBaseModel").prop(),e.futureproofParams=o("WAWebBaseModel").prop(),e.futureproofType=o("WAWebBaseModel").prop(),e.futureproofSubtype=o("WAWebBaseModel").prop(),e.templateParams=o("WAWebBaseModel").prop(),e.textColor=o("WAWebBaseModel").prop(),e.backgroundColor=o("WAWebBaseModel").prop(),e.font=o("WAWebBaseModel").prop(),e.cannotBeRanked=o("WAWebBaseModel").prop(),e.campaignId=o("WAWebBaseModel").prop(),e.campaignDuration=o("WAWebBaseModel").prop(),e.actionLink=o("WAWebBaseModel").prop(),e.statusPSAReadTimestamp=o("WAWebBaseModel").prop(),e.isForwarded=o("WAWebBaseModel").prop(!1),e.isQuestion=o("WAWebBaseModel").prop(!1),e.questionReplyQuotedMessage=o("WAWebBaseModel").prop(null),e.questionResponsesCount=o("WAWebBaseModel").prop(0),e.readQuestionResponsesCount=o("WAWebBaseModel").prop(0),e.forwardingScore=o("WAWebBaseModel").prop(),e.labels=o("WAWebBaseModel").prop(),e.hasReaction=o("WAWebBaseModel").prop(!1),e.paymentCurrency=o("WAWebBaseModel").prop(),e.paymentAmount1000=o("WAWebBaseModel").prop(),e.paymentMessageReceiverJid=o("WAWebBaseModel").prop(),e.paymentTransactionTimestamp=o("WAWebBaseModel").prop(),e.paymentStatus=o("WAWebBaseModel").prop(),e.paymentTxnStatus=o("WAWebBaseModel").prop(),e.paymentNoteMsg=o("WAWebBaseModel").prop(),e.paymentRequestMessageKey=o("WAWebBaseModel").prop(),e.paymentExpiryTimestamp=o("WAWebBaseModel").prop(),e.paymentInviteServiceType=o("WAWebBaseModel").prop(),e.ephemeralDuration=o("WAWebBaseModel").prop(),e.ephemeralSettingTimestamp=o("WAWebBaseModel").prop(),e.ephemeralOutOfSync=o("WAWebBaseModel").prop(),e.ephemeralSharedSecret=o("WAWebBaseModel").prop(),e.disappearingModeInitiator=o("WAWebBaseModel").prop(),e.ephemeralSettingUser=o("WAWebBaseModel").prop(),e.disappearingModeTrigger=o("WAWebBaseModel").prop(),e.disappearingModeInitiatedByMe=o("WAWebBaseModel").prop(),e.parentMsgKey=o("WAWebBaseModel").prop(),e.associationType=o("WAWebBaseModel").prop(),e.viewMode=o("WAWebBaseModel").prop(),e.messageSecret=o("WAWebBaseModel").prop(),e.originalSelfAuthor=o("WAWebBaseModel").prop(),e.bizPrivacyStatus=o("WAWebBaseModel").prop(),e.privacyModeWhenSent=o("WAWebBaseModel").prop(),e.verifiedBizName=o("WAWebBaseModel").prop(),e.inviteCode=o("WAWebBaseModel").prop(),e.inviteCodeExp=o("WAWebBaseModel").prop(),e.inviteGrp=o("WAWebBaseModel").prop(),e.inviteGrpName=o("WAWebBaseModel").prop(),e.inviteGrpJpegThum=o("WAWebBaseModel").prop(),e.inviteGrpType=o("WAWebBaseModel").prop(),e.threadIds=o("WAWebBaseModel").prop(),e.aiThreadInfo=o("WAWebBaseModel").prop(),e.sellerJid=o("WAWebBaseModel").prop(),e.message=o("WAWebBaseModel").prop(),e.orderTitle=o("WAWebBaseModel").prop(),e.itemCount=o("WAWebBaseModel").prop(),e.orderId=o("WAWebBaseModel").prop(),e.surface=o("WAWebBaseModel").prop(),e.status=o("WAWebBaseModel").prop(),e.token=o("WAWebBaseModel").prop(),e.totalAmount1000=o("WAWebBaseModel").prop(),e.totalCurrencyCode=o("WAWebBaseModel").prop(),e.catalogType=o("WAWebBaseModel").prop(),e.historySyncMetaData=o("WAWebBaseModel").prop(),e.isSendFailure=o("WAWebBaseModel").prop(),e.errorCode=o("WAWebBaseModel").prop(),e.appStateSyncKeyShare=o("WAWebBaseModel").prop(),e.appStateSyncKeyRequest=o("WAWebBaseModel").prop(),e.appStateFatalExceptionNotification=o("WAWebBaseModel").prop(),e.peerDataOperationRequestMessage=o("WAWebBaseModel").prop(),e.peerDataOperationRequestResponseMessage=o("WAWebBaseModel").prop(),e.broadcastParticipants=o("WAWebBaseModel").prop(),e.broadcastEphSettings=o("WAWebBaseModel").prop(),e.broadcastId=o("WAWebBaseModel").prop(),e.smbClientCampaignId=o("WAWebBaseModel").prop(),e.ctwaContext=o("WAWebBaseModel").prop(),e.utm=o("WAWebBaseModel").session(),e.list=o("WAWebBaseModel").prop(),e.listResponse=o("WAWebBaseModel").prop(),e.productListItemCount=o("WAWebBaseModel").prop(),e.productHeaderImageRejected=o("WAWebBaseModel").prop(!1),e.agentId=o("WAWebBaseModel").prop(),e.lastPlaybackProgress=o("WAWebBaseModel").prop(0),e.local=o("WAWebBaseModel").session(!1),e.search=o("WAWebBaseModel").session(),e.msgChunk=o("WAWebBaseModel").session(),e.startOfDay=o("WAWebBaseModel").session(),e.startOfDaySkew=o("WAWebBaseModel").session(),e.quotedMsgKey=o("WAWebBaseModel").session(),e.isQuotedMsgAvailable=o("WAWebBaseModel").session(!0),e.fromQuotedMsg=o("WAWebBaseModel").session(!1),e.senderObj=o("WAWebBaseModel").session(),e.mediaData=o("WAWebBaseModel").session(),e.forwardedFromWeb=o("WAWebBaseModel").session(!1),e.nonce=o("WAWebBaseModel").session(),e.squelch=o("WAWebBaseModel").session(),e.wamMessageSendReporter=o("WAWebBaseModel").session(),e.wamMessageSendPerfReporter=o("WAWebBaseModel").session(),e.pendingDeleteForMe=o("WAWebBaseModel").session(!1),e.isDynamicReplyButtonsMsg=o("WAWebBaseModel").prop(!1),e.dynamicReplyButtons=o("WAWebBaseModel").prop(),e.replyButtons=o("WAWebBaseModel").session(),e.buttonsResponse=o("WAWebBaseModel").prop(),e.selectedButtonId=o("WAWebBaseModel").prop(),e.headerType=o("WAWebBaseModel").prop(),e.nativeFlowName=o("WAWebBaseModel").prop(),e.nativeFlowButtons=o("WAWebBaseModel").prop(),e.interactiveHeader=o("WAWebBaseModel").prop(),e.interactiveType=o("WAWebBaseModel").prop(),e.interactivePayload=o("WAWebBaseModel").prop(),e.nativeFlowInteractiveMsg=o("WAWebBaseModel").prop(),e.carouselCardsParsed=o("WAWebBaseModel").prop(),e.carouselCards=o("WAWebBaseModel").session(),e.isCarouselCard=o("WAWebBaseModel").prop(!1),e.parentMsgId=o("WAWebBaseModel").prop(null),e.callSilenceReason=o("WAWebBaseModel").prop(null),e.callOutcome=o("WAWebBaseModel").prop(),e.isVideoCall=o("WAWebBaseModel").prop(!1),e.callDuration=o("WAWebBaseModel").prop(null),e.callCreator=o("WAWebBaseModel").prop(null),e.callParticipants=o("WAWebBaseModel").prop(null),e.isCallLink=o("WAWebBaseModel").prop(null),e.callLinkToken=o("WAWebBaseModel").prop(null),e.finalCallOutcome=o("WAWebBaseModel").prop(),e.reactionParentKey=o("WAWebBaseModel").prop(),e.reactionText=o("WAWebBaseModel").prop(),e.reactionTimestamp=o("WAWebBaseModel").prop(),e.targetMessageKey=o("WAWebBaseModel").prop(),e.encIv=o("WAWebBaseModel").prop(),e.encPayload=o("WAWebBaseModel").prop(),e.replyCount=o("WAWebBaseModel").prop(),e.pinParentKey=o("WAWebBaseModel").prop(),e.pinMessageType=o("WAWebBaseModel").prop(),e.pinSenderTimestampMs=o("WAWebBaseModel").prop(),e.pinExpiryDuration=o("WAWebBaseModel").prop(),e.revokeDuration=o("WAWebBaseModel").session(),e.isMdHistoryMsg=o("WAWebBaseModel").prop(!1),e.stickerSentTs=o("WAWebBaseModel").prop(0),e.isAvatar=o("WAWebBaseModel").prop(!1),e.bizSource=o("WAWebBaseModel").prop(),e.pmCampaignId=o("WAWebBaseModel").prop(),e.lastUpdateFromServerTs=o("WAWebBaseModel").prop(0),e.botEditType=o("WAWebBaseModel").prop(),e.invokedBotWid=o("WAWebBaseModel").prop(null),e.botMessageSecret=o("WAWebBaseModel").prop(),e.botFeedbackKind=o("WAWebBaseModel").prop(),e.botFeedbackText=o("WAWebBaseModel").prop(),e.botTargetSenderJid=o("WAWebBaseModel").prop(),e.bizBotType=o("WAWebBaseModel").prop(null),e.botPersonaId=o("WAWebBaseModel").prop(),e.activeBotMsgStreamingInProgress=o("WAWebBaseModel").session(!1),e.botEditTimeoutID=o("WAWebBaseModel").session(),e.lastBotEditBodyLength=o("WAWebBaseModel").session(),e.botEditTargetId=o("WAWebBaseModel").session(),e.botRespOrInvocationRevokeBotWid=o("WAWebBaseModel").session(null),e.botResponseTargetId=o("WAWebBaseModel").prop(null),e.botPluginType=o("WAWebBaseModel").prop(null),e.botPluginReferenceIndex=o("WAWebBaseModel").prop(null),e.botPluginSearchProvider=o("WAWebBaseModel").prop(null),e.botPluginSearchUrl=o("WAWebBaseModel").prop(null),e.botPluginSearchQuery=o("WAWebBaseModel").prop(null),e.botPluginMaybeParent=o("WAWebBaseModel").prop(!1),e.botReelPluginThumbnailCdnUrl=o("WAWebBaseModel").prop(null),e.botMessageDisclaimerText=o("WAWebBaseModel").prop(null),e.botMsgBodyType=o("WAWebBaseModel").prop(null),e.isSupportAIMessage=o("WAWebBaseModel").prop(),e.supportCitations=o("WAWebBaseModel").prop(),e.richResponse=o("WAWebBaseModel").prop(),e.forwardedNewsletterMessageInfo=o("WAWebBaseModel").prop(),e.forwardedAiBotMessageInfo=o("WAWebBaseModel").prop(),e.encryptedData=o("WAWebBaseModel").prop(),e.newsletterAdminInviteInfo=o("WAWebBaseModel").prop(),e.newsletterFollowerInviteInfo=o("WAWebBaseModel").prop(),e.reportingTokenInfo=o("WAWebBaseModel").prop(),e.reportingTokenContent=o("WAWebBaseModel").prop(),e.plainProtobufBytes=o("WAWebBaseModel").session(),e.preMatChat=o("WAWebBaseModel").session(),e.senderWithDevice=o("WAWebBaseModel").session(),e.isRetry=o("WAWebBaseModel").session(!1),e.isOffline=o("WAWebBaseModel").session(!1),e.memberLabelData=o("WAWebBaseModel").prop(),e.musicArtwork=o("WAWebBaseModel").prop(),e.$MsgImpl$p_1=o("WAWebBaseModel").session(function(){return[]}),e.$MsgImpl$p_2=o("WAWebBaseModel").session(function(){return[]}),e.$MsgImpl$p_3=o("WAWebBaseModel").session(function(){return[]}),e.linksIndexParsed=o("WAWebBaseModel").session(0),e.$MsgImpl$p_4=o("WAWebBaseModel").session(),e.$MsgImpl$p_5=o("WAWebBaseModel").session(function(){return[]}),e.$MsgImpl$p_6=o("WAWebBaseModel").session(function(){return[]}),e.$MsgImpl$p_7=o("WAWebBaseModel").session(function(){return[]}),e.phoneNumbersIndexParsed=o("WAWebBaseModel").session(0),e.$MsgImpl$p_8=o("WAWebBaseModel").session(),e.requiresDirectConnection=o("WAWebBaseModel").prop(null),e.isGroupStatus=o("WAWebBaseModel").prop(),e.isOverwrittenByRevoke=o("WAWebBaseModel").session(!1),e.bizContentPlaceholderType=o("WAWebBaseModel").prop(null),e.hostedBizEncStateMismatch=o("WAWebBaseModel").prop(!1),e.senderOrRecipientAccountTypeHosted=o("WAWebBaseModel").prop(!1),e.placeholderCreatedWhenAccountIsHosted=o("WAWebBaseModel").prop(!1),e.limitSharing=o("WAWebBaseModel").prop(),e.galaxyFlowWAMMessageId=o("WAWebBaseModel").prop(),e.galaxyFlowQPLMessageId=o("WAWebBaseModel").prop(),e.galaxyFlowDisabled=o("WAWebBaseModel").prop(),e.groupHistoryBundleMessageKey=o("WAWebBaseModel").prop(null),e.groupHistoryBundleMetadata=o("WAWebBaseModel").prop(null),e.nonJidMentions=o("WAWebBaseModel").prop(null),e.createdMediaDataOnInit=o("WAWebBaseModel").session(!1),e.createdMediaDataOnUpdate=o("WAWebBaseModel").session(!1),e.oldType=o("WAWebBaseModel").session(),e.newType=o("WAWebBaseModel").session(),e.typeOnInit=o("WAWebBaseModel").session(),e.calledCiphertextDecrypted=o("WAWebBaseModel").session(!1),e.$MsgImpl$p_18=r("lodash").debounce(function(e,t){o("WAWebDBUpdateMessageTable").updateMessageTable(e,{lastPlaybackProgress:t})},500),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.pendingAckUpdate_TESTONLY=function(){return this.$MsgImpl$p_9},i.initializeMedia=function(){this.$MsgImpl$p_10(),(!this.isViewOnce||o("WAWebViewOnceState").isUnviewed(this.safe()))&&o("WAWebMedia").registerMsg(this)},i.initialize=function(){var e=this,n;t.prototype.initialize.call(this),this.typeOnInit=this.type,this.carouselCardsParsed!=null&&this.$MsgImpl$p_11(),this.type===o("WAWebMsgType").MSG_TYPE.INTERACTIVE&&this.listenTo(this,"change:carouselCardsParsed",this.$MsgImpl$p_11),this.$MsgImpl$p_9=new(o("WAWebPromiseQueue")).PromiseQueue;var a=o("WAWebMsgModelUtils").getValidatedSender(this);a&&(this.addChild("senderObj",o("WAWebContactCollection").ContactCollection.gadd(a.isUser()&&!a.isFbidBot()&&!a.isHosted()&&!a.isNewsletter()?o("WAWebWidFactory").createWid(a.isLid()?o("WAJids").toLidUserJid(a.user):o("WAJids").toPhoneUserJid(a.user)):a)),this.hsmTag===o("WAWebBusinessHSMTypes").HSM_TAG_TYPE.MARKETING&&this.senderObj.setIsMarketingMessageThread(!0)),this.mentionedJidList=this.mentionedJidList||[],this.groupMentions=this.groupMentions||[],this.mentionedJidList.forEach(function(e){return o("WAWebContactCollection").ContactCollection.gadd(e)}),this.type===o("WAWebMsgType").MSG_TYPE.CIPHERTEXT&&this.listenToOnce(this,"change:type",this.$MsgImpl$p_12),this.mediaObject=void 0,o("WAWebMsgModelUtils").typeIsMms(this)&&(this.createdMediaDataOnInit=!0,this.initializeMedia()),o("WAWebConnModel").Conn.isSMB&&o("WAWebBizLabelUtils").initializeLabels(this),this.isViewOnce&&(this.listenTo(this,"change:ack",this.$MsgImpl$p_13),this.listenTo(this.mediaData,"change:mediaStage",this.$MsgImpl$p_13)),this.listenTo(this,"change:viewMode",this.$MsgImpl$p_14),o("WAWebViewModeUtils").isViewModeVisibleInSurface(o("WAWebViewMode.flow").ViewModeSurface.CHAT,this.viewMode)||this.$MsgImpl$p_14(),r("gkx")("26258")||this.listenTo(this,"change:t",function(){Number.isInteger(e.t)||o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Invalid timestamp value in msg, raw ts value: ",", msgId: ",", msgType: ","_",""])),e.t,e.id.toString(),e.type,e.subtype).tags("date_marker").sendLogs("Msg TS updated to invalid value")}),o("WAWebMsgGetters").getIsMetaBotResponse(this)&&this.listenTo(this,"change:botEditType",this.$MsgImpl$p_15),this.recvFresh&&(n=this.senderObj)!=null&&(n=n.id)!=null&&n.isBot()&&(this.activeBotMsgStreamingInProgress=!0),this.$MsgImpl$p_15()},i.$MsgImpl$p_14=function(){var e,t,n=(e=(t=o("WAWebFrontendMsgGetters").getMaybeChat(this))==null?void 0:t.msgs)!=null?e:this.msgChunk;o("WAWebViewModeUtils").isViewModeVisibleInSurface(o("WAWebViewMode.flow").ViewModeSurface.CHAT,this.viewMode)?n==null||n.trigger("insert_msgs",[this],{}):(this._triggerNotificationForParentMessage(),this.alterChatFields({messageInHiddenViewMode:!0}),n==null||n.trigger("remove_msgs",[this],{})),n==null||n.triggerChangeLast(null,n,{})},i.hideParentMessageInChat=function(t){var e=t.duringDetach,n=this.parentMsgKey;if(n){var r,a=this.getCollection().get(n);a&&(r=o("WAWebInvisiblePlaceholderViewModeProcessor").InvisiblePlaceholderViewModeProcessor.compatibleMessageTypes)!=null&&r.includes(a.type)&&o("WAWebMessageAssociationUIUtils").shouldHideParentMessage({parentMsg:a,duringDetach:e})&&a.set("viewMode",o("WAWebViewMode.flow").ViewModeType.INVISIBLE_PLACEHOLDER)}},i._triggerNotificationForParentMessage=function(){var e=o("WAWebFrontendMsgGetters").getEventType(this),t=this.parentMsgKey,n=this.recvFresh&&!o("WAWebMsgGetters").getIsSentByMe(this)&&(e===o("WAWebCommonMsgUtils").EventType.DEFAULT||e===o("WAWebCommonMsgUtils").EventType.SIGNIFICANT);if(t&&n){var r=this.getCollection().get(t);r&&o("WAWebNotificationsMsgNotification").eligibleMessagesForNotificationRetriggering.has(r.type)?o("WAWebCmd").Cmd.alertNewMsg(r):o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Msg: _triggerNotificationForParentMessage: parentMsg for "," not found in MsgCollection or not eligible for notification re-triggering"])),this.id.toString())}},i.$MsgImpl$p_11=function(){var e,t,n=this.carouselCardsParsed;if(n!=null){var o=(e=(t=this.carouselCards)==null?void 0:t.getCardsById())!=null?e:{},a=[];for(var i of n){var l=i.id.toString();if(o[l]!=null){var s=o[l];s.set(i),a.push(s)}else{var u=babelHelpers.extends({},i);a.push(u)}}var c=new(r("WAWebCarouselCardsCollection"));c.add(a),this.carouselCards=c,this.getCollection().add(c.slice())}},i.$MsgImpl$p_15=function(){var e=this;if(this.subtype===o("WAWebBotGenTypingIndicatorMsg").BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE){var t=o("WAWebBotGenTypingIndicatorMsg").getBotTypingIndicatorTimeout();self.setTimeout(function(){e.delete()},t),r("WAWebChangePresenceHandlerAction")({id:this.id.remote,type:"typing"});return}var n=this.botEditType;if(n!=null){var a=o("WAWebBotGenTypingIndicatorMsg").getBotTypingIndicatorTimeout();switch(n){case o("WAWebBotTypes").BotMsgEditType.LAST:case o("WAWebBotTypes").BotMsgEditType.FULL:this.activeBotMsgStreamingInProgress=!1,this.botEditTimeoutID&&self.clearTimeout(this.botEditTimeoutID);return;default:this.botEditTimeoutID=self.setTimeout(function(){e.activeBotMsgStreamingInProgress=!1,e.botEditType=o("WAWebBotTypes").BotMsgEditType.LAST,o("WAWebDBUpdateMessageTable").updateMessageTable(e.id,{botEditType:o("WAWebBotTypes").BotMsgEditType.LAST})},a)}}},i.getRawLinks=function(){return this.type===o("WAWebMsgType").MSG_TYPE.REVOKED&&this.$MsgImpl$p_1.length>0&&this.clearRawLinks(),this.$MsgImpl$p_1},i.setRawLinks=function(t){t.length>0&&(this.$MsgImpl$p_1=t)},i.clearRawLinks=function(){this.$MsgImpl$p_1=[],this.linksIndexParsed=0},i.getRawPollOptionsToLinks=function(){return this.$MsgImpl$p_4},i.setRawPollOptionsToLinks=function(t){this.$MsgImpl$p_4=t},i.getRawHeaderLinks=function(){return this.$MsgImpl$p_2},i.setRawHeaderLinks=function(t){t.length>0&&(this.$MsgImpl$p_2=t)},i.getRawFooterLinks=function(){return this.$MsgImpl$p_3},i.setRawFooterLinks=function(t){t.length>0&&(this.$MsgImpl$p_3=t)},i.getRawPhoneNumbers=function(){return this.$MsgImpl$p_5},i.setRawPhoneNumbers=function(t){t.length>0&&(this.$MsgImpl$p_5=t)},i.clearRawPhoneNumbers=function(){this.$MsgImpl$p_5=[],this.phoneNumbersIndexParsed=0},i.getRawHeaderPhoneNumbers=function(){return this.$MsgImpl$p_6},i.setRawHeaderPhoneNumbers=function(t){t.length>0&&(this.$MsgImpl$p_6=t)},i.getRawFooterPhoneNumbers=function(){return this.$MsgImpl$p_7},i.setRawFooterPhoneNumbers=function(t){t.length>0&&(this.$MsgImpl$p_7=t)},i.$MsgImpl$p_10=function(){this.addChild("mediaData",new(r("WAWebMediaData")))},i.mayFail=function(){return o("WAWebMsgGetters").getIsSentByMe(this)&&this.ack<o("WAWebAck").ACK.SENT},i.isUnsentPhoneMsg=function(){return!this.local&&o("WAWebMsgGetters").getIsSentByMe(this)&&this.ack<o("WAWebAck").ACK.SENT},i.supportsStarWithKeepInChat=function(){return o("WAWebMsgGetters").getIsEphemeral(this)&&(this.star||this.isGif||o("WAWebMsgGetters").getIsStickerMsg(this))},i.interactiveButtonsReleased=function(){return this.isFromTemplate||!o("WAWebFrontendMsgGetters").getHasTemplateButtons(this)&&this.type!==o("WAWebMsgType").MSG_TYPE.TEMPLATE_BUTTON_REPLY},i.getVcardWids=function(){return this.type!==o("WAWebMsgType").MSG_TYPE.VCARD?null:o("WAWebVcardParsingUtils").vcardAllWids(o("WAWebMsgGetters").getVcard(this))},i.getMultiVcardWids=function(){if(this.type!==o("WAWebMsgType").MSG_TYPE.MULTI_VCARD)return null;var e=o("WAWebMsgGetters").getVcardList(this).map(function(e){return e.vcard}).filter(Boolean).map(function(e){return o("WAWebVcardParsingUtils").parseMultiVcard(e)}).flat(),t=e.map(function(e){return o("WAWebVcardParsingUtils").vcardAllWids(e)}).flat();return Array.from(new Set(t))},i.getLocObject=function(){var e=this.loc;if(e){var t=e.split("\n"),n=t[0],r=t[1],o=r===void 0?null:r;return{name:n,addr:o}}return null},i.resumeRemoteUpload=function(){return o("WAWebMsgGetters").getIsNewsletterMsg(this)?o("WAWebMedia").resumeUploadMsg(this):(this.isUnsentPhoneMsg()&&o("WAWebSendMsgRecordAction").sendMsgRecord(this),this.forceDownloadMediaEvenIfExpensive())},i.forceRMR=function(){return(f||(f=n("Promise"))).reject(r("err")("unimplemented forceRMR"))},i.isForcingRMR=function(){return!1},i.cancelDownload=function(){o("WAWebMedia").cancelDownloadMsg(this)},i.resumeUpload=function(){return this.mediaData.mediaStage!==o("WAWebMediaTypes").MediaDataStage.NEED_UPLOAD&&o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["resumeUpload called while state was ",""])),this.mediaData.mediaStage).sendLogs("resume-non-need-upload"),o("WAWebMedia").resumeUploadMsg(this).then(function(e){return e==null?void 0:e.messageSendResult})},i.cancelUpload=function(){o("WAWebMedia").cancelUploadMsg(this)},i.waitForPhoneUpload=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=this;this.mediaData!=null&&this.mediaData.filehash&&!this.isUnsentPhoneMsg()||(this.$MsgImpl$p_8||(this.$MsgImpl$p_8=r("WAWebEventsWaitForBbEvent")(this.mediaData,"change:mediaStage change:filehash",function(){return!!e.mediaData.filehash&&!e.isUnsentPhoneMsg()})),yield this.$MsgImpl$p_8,this.$MsgImpl$p_8=null)});function t(){return e.apply(this,arguments)}return t})(),i.forceDownloadMediaEvenIfExpensive=function(){return this.downloadMedia({downloadEvenIfExpensive:!0,rmrReason:o("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.MSG_CLICK,isUserInitiated:!0})},i.downloadMedia=function(t){var e=this,a;if(o("WAWebFrontendMsgGetters").getAsRevoked(this))return(f||(f=n("Promise"))).resolve();var i=t.downloadEvenIfExpensive,l=t.rmrReason,s=t.isUserInitiated,u=t.isAutoDownload,c=t.shouldSequenceDownload;if(!s&&!o("WAWebMsgModelPropUtils").isTrusted(this))return(f||(f=n("Promise"))).resolve();if(!o("WAWebMsgGetters").getIsStatus(this)&&o("WAWebFrontendMsgGetters").getChat(this).isSuspendedOrTerminated()&&o("WAWebMiscGatingUtils").isGroupSuspendV2Enabled())return s&&o("WAWebModalManager").ModalManager.open(h.jsx(r("WAWebSuspendedGroupMediaDownloadFailureModal.react"),{}),{transition:"modal-flow"}),(f||(f=n("Promise"))).resolve();if(o("WAWebFrontendMsgGetters").getAsMms(this)||o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),this.id.toString(),this.type).devConsole(this).sendLogs("media-fault: downloadMedia msg is not mms type"),this.isUnsentPhoneMsg()){var m=this.$MsgImpl$p_8;return m||(m=this.$MsgImpl$p_8=r("WAWebEventsWaitForBbEvent")(this.mediaData,"change:mediaStage change:filehash",function(){return!!e.mediaData.filehash&&!e.isUnsentPhoneMsg()}).then(function(){e.$MsgImpl$p_8=null})),m.then(function(){return e.downloadMedia(t)})}return o("WAWebMedia").downloadMsg({msg:this,isUserClick:l===o("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.MSG_CLICK,downloadEvenIfExpensive:i,rmrReason:l,rmrData:this.$MsgImpl$p_16(l),mode:s?"manual":"auto",isAutoDownload:u,chatWid:(a=o("WAWebFrontendMsgGetters").getMaybeChat(this))==null?void 0:a.id,shouldSequenceDownload:c})},i.$MsgImpl$p_16=function(t){var e={webcRmrReason:t,webcMessageT:this.t},n=o("WAWebFrontendMsgGetters").getMaybeChat(this);if(n){e.webcChatType=n.getWebcChatType(),n.initialIndex!=null&&(e.webcChatPosition=n.initialIndex);var r=this.msgChunk;r&&r===n.msgs&&(e.webcMessageIndex=r.length-r.indexOf(this)-1)}return e},i.applyUpdate=function(t){var e=this;return t.type&&this.type!==t.type&&(this.oldType=this.type,this.newType=t.type),t.type&&this.type!==t.type&&o("WAWebMsgModelUtils").typeIsMms(t)?(!o("WAWebCommonMsgUtils").isPlaceholderMsg(this.type)&&!o("WAWebMsgGetters").getIsFutureproof(this)&&o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["updated "," from "," to ",""])),this.id.toString(),this.type,String(t.type)).sendLogs("invalid-type-update"),this.createdMediaDataOnUpdate=!0,this.$MsgImpl$p_10(),o("WAWebMedia").registerMsgEarly(this,t),o("WAWebMedia").prepareMsg(this).then(function(){e.set(t)}).catch(function(e){o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["error = ",""])),String(e)).devConsole(e).sendLogs("preregister-error")})):(this.set(t),(f||(f=n("Promise"))).resolve())},i.waitForPrep=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e,t=this,r=o("WAWebMsgModelUtils").typeIsMms(this);r&&this.mediaData==null&&(o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Msg: waitForPrep called while mediaData was null. id: ","\n            createdMediaDataOnInit: ",", createdMediaDataOnUpdate: ",",\n            type on init: ",", type before change: ",", type after change: ","\n            calledCiphertextDecrypted: ",""])),this.id.toString(),this.createdMediaDataOnInit,this.createdMediaDataOnUpdate,this.typeOnInit,this.oldType,this.newType,this.calledCiphertextDecrypted),this.initializeMedia());var a=this.requiresDirectConnection==null?o("WAWebDirectConnectionGatingUtils").genDirectConnectionMessageModifiers(this.type,(e=this.list)==null?void 0:e.listType,this.businessOwnerJid).then(function(e){return t.set(e)}):(f||(f=n("Promise"))).resolve(),i=r?o("WAWebMedia").prepareMsg(this):(f||(f=n("Promise"))).resolve();return yield a,i});function t(){return e.apply(this,arguments)}return t})(),i.alterChatFields=function(t){var e=this.$MsgImpl$p_17().get(this.id.remote);if(e){var n;(this.id.remote.isBot()||((n=e.contact.businessProfile)==null?void 0:n.isBizBot3p)===!0)&&this.subtype===o("WAWebBotGenTypingIndicatorMsg").BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE&&e.botInitialTypingIndicatorMsgId&&e.botInitialTypingIndicatorMsgId.equals(this.id)&&e.set({botInitialTypingIndicatorMsgId:null},{silent:!0}),e.unreadMsgAnchor===this&&(e.unreadMsgAnchor=void 0);var r=(t==null?void 0:t.messageInHiddenViewMode)===!0||!t||!t.doNotResetLastReceived;if(r&&e.lastReceivedKey===this.id){var a=void 0,i=o("WAWebChatGetMessage").getLastReceivedMsg(e);i&&(a=i.id),e.lastReceivedKey=a}e.composeQuotedMsg===this&&(t==null?void 0:t.messageInHiddenViewMode)!==!0&&(e.composeQuotedMsg=null)}},i.delete=function(n){t.prototype.delete.call(this),this.botEditTimeoutID&&self.clearTimeout(this.botEditTimeoutID),o("WAWebStarredMsgCollection").AllStarredMsgsCollection.remove(this),o("WAWebPinInChatCollection").PinInChatCollection.deleteByParentMessageKey(this.id),o("WAWebLabelCollection").LabelCollection.removeAllLabelsMD(this),o("WAWebMsgModelUtils").typeIsMms(this)&&o("WAWebMedia").deregisterMsg(this);var e=this.getCollection();o("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&o("WAWebMessageAssociationUIUtils").getHiddenAssociatedMessages(this.id).forEach(function(e){e.delete()}),e.remove(this.id),this.hideParentMessageInChat({duringDetach:!1}),this.msgChunk&&this.msgChunk.remove(this.id,{},!!(n!=null&&n.skipUpdatingSortTime)),this.alterChatFields(n),o("WAWebMsgGetters").clearMsgGetterCacheFor(this),o("WAWebFrontendMsgGetters").clearFrontendMsgGetterCacheFor(this)},i.isLastMessage=function(){var e=o("WAWebFrontendMsgGetters").getChat(this).msgs.last();return this.id.equals(e==null?void 0:e.id)},i.msgContextInfo=function(n){var t=this.toJSON(),r=t.id,a=t.t,i=t.notifyName,l=t.from,s=t.to,u=t.author,c=t.ack,d=t.invis,m=t.isNewMsg,p=t.star,_=t.recvFresh,f=t.recipients,g=t.broadcast,h=t.quotedMsg,y=t.quotedStanzaID,C=t.quotedRemoteJid,b=t.quotedParticipant,v=t.quotedType,S=t.senderObj,R=t.multicast,L=t.replyButtons,E=t.buttons,k=t.latestEditMsgKey,I=t.latestEditSenderTimestampMs,T=babelHelpers.objectWithoutPropertiesLoose(t,e),D=this.id,x=null;n&&!D.remote.equals(n)&&(x=D.remote);var $=o("WAWebMsgModelUtils").getQuotedParticipantForContextInfo(this);return{quotedMsg:T,quotedParticipant:$,quotedStanzaID:D.id,quotedRemoteJid:x}},i.displayName=function(t){var e;t===void 0&&(t={});var n=t,a=n.showShortName,i=a===void 0?!1:a,l=n.showVerifiedName,s=l===void 0?!1:l,u=n.withPushName,c=u===void 0?!1:u,d=n.withPushNameOnly,m=d===void 0?!1:d,p=n.newPushNameFormatting,_=p===void 0?!1:p;if(!o("WAWebMsgGetters").getSender(this))return"";if(o("WAWebUserPrefsMeUser").isMeAccount(o("WAWebMsgGetters").getSender(this)))return r("fbs")._(/*BTDS*/"T\u00fa").toString();if(o("WAWebMsgGetters").getIsPSA(this))return o("WAWebConnModel").Conn.isSMB?r("fbs")._(/*BTDS*/"WhatsApp Business").toString():r("fbs")._(/*BTDS*/"WhatsApp").toString();if(this.senderObj==null)return"";var f=this.senderObj,g=i?f.shortName:void 0;if(r("isStringNullOrEmpty")(g)){if(f.name)return f.name}else return g;if(s&&f.verifiedLevel===o("WAWebBusinessProfileTypes").VERIFIED_LEVEL.HIGH&&f.verifiedName)return f.verifiedName;if(o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()){var h=o("WAWebFrontendContactGetters").getFormattedUsernameAndType(f);if(h!=null)return h.displayName}var y=_?o("WAWebChatContactUtils").getFormattedNotifyName(this.notifyName).toString():"~"+this.notifyName,C=c&&this.notifyName?y:"";if(m&&C)return C;var b=(e=o("WAWebMsgGetters").getSender(this))!=null&&e.isLid()?o("WAWebFrontendContactGetters").getUserDisplayNameForLid(f):o("WAWebWidFormat").widToFormattedUser(o("WAWebMsgGetters").getSender(this));return o("WAWebChatCommunityUtils").shouldMaskPhoneNumberForChat(o("WAWebFrontendMsgGetters").getChat(this),f)&&(b=o("WAWebFrontendContactGetters").getMaskedPhoneLid(f)),""+b+(C?" ":"")+C},i.isMeMentioned=function(){return this.mentionedJidList?this.mentionedJidList.some(o("WAWebUserPrefsMeUser").isMeAccount):!1},i.mentionMap=function(){if(!this.mentionedJidList||!this.mentionedJidList.length)return null;var e={};return this.mentionedJidList.forEach(function(t){e["@"+(r("WAWebWid").user(t)||"")]=o("WAWebContactCollection").ContactCollection.gadd(t)}),e},i.groupMentionMap=function(){var e;return!this.groupMentions||!this.groupMentions.length?null:(e=this.groupMentions)==null?void 0:e.reduce(function(e,t){var n="@"+t.groupJid.toString();return e[n]=t.groupSubject,e},{})},i.updateAck=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){t===void 0&&(t=!1);var n=this.ack,r=o("WAWebFrontendMsgGetters").getMaybeChat(this);if(!(!o("WAWebMsgGetters").getIsStatus(this)&&r!=null&&o("WAWebChatGetters").getIsGroup(r)&&this.isMdHistoryMsg&&e>=o("WAWebAck").ACK.RECEIVED&&this.id.fromMe)){var a=this.id;if(this.id.remote.isStatus()){var i=yield o("WAWebMessageReceiptUtils").fixStatusReceiptKeys([a]);a=i[0]}o("WATypeUtils").isNumber(e)&&(n===void 0||e>n||e===o("WAWebAck").ACK.FAILED)?(this.ack=e,t||this.$MsgImpl$p_9.enqueue(function(){return o("WAWebDBUpdateMessageTable").updateMessageTable(a,{ack:e})})):e===o("WAWebAck").ACK.FAILED&&this.ack===o("WAWebAck").ACK.CLOCK&&(this.ack=o("WAWebAck").ACK.FAILED,this.$MsgImpl$p_9.enqueue(function(){return o("WAWebDBUpdateMessageTable").updateMessageTable(a,{ack:e})}))}});function t(t,n){return e.apply(this,arguments)}return t})(),i.updateErrorCode=function(t){return this.errorCode=t,o("WAWebDBUpdateMessageTable").updateMessageTable(this.id,{errorCode:t})},i.updateReadQuestionResponsesCount=function(){return this.readQuestionResponsesCount=this.questionResponsesCount,o("WAWebDBUpdateMessageTable").updateMessageTable(this.id,{readQuestionResponsesCount:this.questionResponsesCount})},i.updateGalaxyFlowMsgLoggingIds=function(t,n){return this.galaxyFlowWAMMessageId=t,this.galaxyFlowQPLMessageId=n,o("WAWebDBUpdateMessageTable").updateMessageTable(this.id,{galaxyFlowWAMMessageId:t,galaxyFlowQPLMessageId:n})},i.updateNFMButtonsState=function(t){return o("WAWebDBUpdateMessageTable").updateMessageTable(this.id,{galaxyFlowDisabled:t})},i.updateLastPlaybackProgress=function(t){this.lastPlaybackProgress=t,this.$MsgImpl$p_18(this.id,t)},i.avParams=function(){return o("WAWebMedia").mediaMetadata(this)},i.resend=function(){var e=this;if(o("WAWebMsgGetters").getIsFailed(this)){if(o("WAWebMsgGetters").getIsEdited(this))return o("WAWebSendMessageEditAction").resendLatestEdit(this);var t={ack:o("WAWebAck").ACK.CLOCK};return t.isSendFailure=!1,this.$MsgImpl$p_9.enqueue(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield o("WAWebDBUpdateMessageTable").updateMessageTable(e.id,t),e.set(t)})),o("WAWebMsgGetters").getIsNewsletterMsg(this)?o("WAWebNewsletterSendMsgAction").resendNewsletterMsg(this).then(function(e){return e&&e.messageSendResult}):o("WAWebFrontendMsgGetters").getAsMms(this)?o("WAWebMsgGetters").getIsSentByMeFromWeb(this)?this.resumeUpload():this.resumeRemoteUpload():o("WAWebSendMsgRecordAction").sendMsgRecord(this).then(function(e){return e.messageSendResult})}return(f||(f=n("Promise"))).resolve()},i.$MsgImpl$p_12=function(){if(this.calledCiphertextDecrypted=!0,!o("WAWebMsgGetters").getIsStatus(this)){var e=o("WAWebFrontendMsgGetters").getChat(this),t=e.msgs.length,n=e.msgs.indexOf(this);n!==-1&&t-n<=10&&!o("WAWebMsgGetters").getIsSentByMe(this)&&o("WAWebCmd").Cmd.alertNewMsg(this)}},i.$MsgImpl$p_13=function(){if(this.isViewOnce&&this.mediaData!=null){var e=o("WAWebMsgGetters").getIsSentByMe(this)&&this.ack>=o("WAWebAck").ACK.SENT&&this.mediaData.mediaStage===o("WAWebMediaTypes").MediaDataStage.RESOLVED,t=!o("WAWebMsgGetters").getIsSentByMe(this)&&this.ack>=o("WAWebAck").ACK.PLAYED;(e||t)&&(this.stopListening(this,"change:ack",this.$MsgImpl$p_13),this.stopListening(this.mediaData,"change:mediaStage",this.$MsgImpl$p_13),o("WAWebMedia").deregisterMsg(this))}},i.isReaction=function(){return o("WAWebMsgGetters").getIsReaction(this)},i.isEditProtocolMsg=function(){return o("WAWebMsgGetters").getIsEditProtocolMsg(this)},i.getWamDisappearingModeInitiator=function(){var e=this.disappearingModeInitiator;if(e==null)return null;switch(e){case o("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe:return o("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE.INITIATED_BY_ME;case o("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByOther:case o("WAWebEphemeralityTypes").DisappearingModeInitiator.BizUpgradeFbHosting:return o("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE.INITIATED_BY_OTHER;case o("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat:return o("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE.CHAT}},i.getWamMessageType=function(){return o("WAWebWamMsgUtils").getWamMessageType(this)},i.getWamMediaType=function(){return o("WAWebWamMsgUtils").getWamMediaType(this)},i.getWamEditType=function(){return o("WAWebMsgGetters").getWamEditType(this)},i.getForwardingScoreWhenForwarded=function(){var e=5,t=o("WAWebMsgGetters").getNumTimesForwarded(this)+(o("WAWebMsgGetters").getShouldDisplayAsForwarded(this)?1:0);return t>=e?r("WAWebConstantsDeprecated").FREQUENTLY_FORWARDED_SENTINEL:t},i.isExpired=function(){var e=o("WAWebMsgGetters").getEphemeralExpirationTimestamp(this);return e==null?!1:e<=o("WATimeUtils").unixTime()},i.isRealMessage=function(){var e=this.type===o("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE&&this.from.equals(o("WAWebUserPrefsMeUser").getMaybeMePnUser());return!e&&!o("WAWebMsgGetters").getIsInitialE2ENotification(this)&&this.type!==o("WAWebMsgType").MSG_TYPE.CALL_LOG&&!o("WAWebMsgGetters").getIsBizNotification(this)&&!["change_number","change_username","masked_thread_created"].includes(this.subtype)&&!o("WAWebMsgGetters").getIsDisappearingModeSystemMessage(this)},i.isExpiredAndNotKept=function(){return this.isExpired()&&!o("WAWebMsgGetters").getIsKept(this)},i.timeUntilExpiration=function(){var e=o("WAWebMsgGetters").getEphemeralExpirationTimestamp(this);return e==null?null:this.isExpired()?0:e-o("WATimeUtils").unixTime()},i.getCollection=function(){return o("WAWebMsgCollection").MsgCollection},i.$MsgImpl$p_17=function(){return o("WAWebMsgGetters").getIsNewsletterMsg(this)?r("WAWebNewsletterCollection"):o("WAWebChatCollection").ChatCollection},i.safe=function(){return this},i.unsafe=function(){return this},i.$MsgImpl$p_19=function(){return o("WAWebUserPrefsMeUser").isMeAccount(o("WAWebMsgGetters").getKicSender(this))},i.keepIsLockedForMe=function(){return this.keepIsLockedByDmSettingsForUser(o("WAWebUserPrefsMeUser").getMePnUserOrThrow())},i.keepIsLockedForUser=function(t){return this.keepIsLockedByDmSettingsForUser(t)},i.keepIsLockedForMeSenderSuperpower=function(){var e=o("WAWebMsgGetters").getKicSender(this),t=r("WAWebWid").equals.apply(r("WAWebWid"),o("WAWebLidMigrationUtils").toCommonAddressingMode(e,o("WAWebMsgGetters").getSender(this)));return o("WAWebMsgGetters").getIsUnkept(this)&&t&&!this.$MsgImpl$p_19()},i.keepIsLockedByDmSettingsForUser=function(t){var e,n=o("WAWebChatGetters").getIsGroup(o("WAWebFrontendMsgGetters").getChat(this))?!((e=o("WAWebFrontendMsgGetters").getChat(this).groupMetadata)!=null&&e.userCanSetEphemeralSetting(t)):!1;return n},i.$MsgImpl$p_20=function(){return o("WAWebFrontendMsgGetters").getChat(this).supportsKIC()?o("WAWebMsgGetters").getIsEphemeral(this)&&this.type!==o("WAWebMsgType").MSG_TYPE.REVOKED&&!this.isViewOnce&&!o("WAWebFrontendMsgGetters").getAsAlbum(this):!1},i.canShowKeepOrUnkeepOption=function(){return this.canShowKeepOption()||this.canShowUnkeepOption()},i.canShowKeepOption=function(){var e;return this.$MsgImpl$p_20()&&(o("WAWebChatGroupUtils").canSendToGroup(o("WAWebFrontendMsgGetters").getChat(this))||((e=o("WAWebFrontendMsgGetters").getChat(this).groupMetadata)==null?void 0:e.pastParticipants.get(o("WAWebUserPrefsMeUser").getMePnUserOrThrow()))!=null)&&!this.keepIsLockedForMe()&&!this.star&&!this.isGif&&!o("WAWebMsgGetters").getIsStickerMsg(this)},i.canShowUnkeepOption=function(){return o("WAWebMsgGetters").getIsKept(this)&&this.$MsgImpl$p_20()&&(this.canRevokeUnkeep()||this.canShowKeepOption()||this.isGif||o("WAWebMsgGetters").getIsStickerMsg(this))},i.canRevokeUnkeep=function(){if(o("WAWebMsgGetters").getIsSentByMe(this)){var e;if(o("WAWebChatGetters").getIsGroup(o("WAWebFrontendMsgGetters").getChat(this))&&((e=o("WAWebFrontendMsgGetters").getChat(this).groupMetadata)==null?void 0:e.participants.iAmMember())===!0)return!0;if(o("WAWebChatGetters").getIsUser(o("WAWebFrontendMsgGetters").getChat(this))&&!o("WAWebFrontendMsgGetters").getChat(this).contact.isContactBlocked)return!0}return!1},i.isPastUnkeepExpirationLimit=function(){var e=o("WAWebMsgGetters").getEphemeralExpirationTimestamp(this);if(e!=null){var t=Math.trunc(+new Date/1e3)-e;return o("WAWebMsgGetters").getIsKept(this)&&t>o("WAWebEphemeralKeepInChatAbpropUtils").getUndoKeepInChatExpiration()}return!1},i.shouldShowNotificationPreview=function(){var e;return!((e=o("WAWebFrontendMsgGetters").getAsViewOnce(this))!=null&&e.isViewOnce)&&o("WAWebMuteCollection").MuteCollection.getGlobalPreviews()},i.senderIsGroupParticipant=function(){var e=o("WAWebFrontendMsgGetters").getChat(this).groupMetadata;if(e==null)return!1;var t=o("WAWebMsgGetters").getSender(this);if(t!=null&&e.participants.get(t)!=null)return!0;if(!e.isCag)return!1;var n=t!=null?o("WAWebApiContact").getCurrentLid(o("WAWebWidFactory").asUserWidOrThrow(t)):null;return n==null?!1:e.participants.get(n)!=null},i.detachAssociatedMsg=function(){this.hideParentMessageInChat({duringDetach:!0}),this.set({viewMode:o("WAWebViewMode.flow").ViewModeType.VISIBLE,associationType:null,parentMsgKey:null})},i.updateGroupHistoryBundleProcessState=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return this.groupHistoryBundleMetadata==null?(f||(f=n("Promise"))).reject():(this.set({groupHistoryBundleMetadata:babelHelpers.extends({},this.groupHistoryBundleMetadata,{processState:e})}),(f||(f=n("Promise"))).resolve())});function t(t){return e.apply(this,arguments)}return t})(),a})(o("WAWebBaseModel").BaseModel);y.Proxy="msg",y.idClass=r("WAWebMsgKey"),y.kind="__MOCKED_KIND__";var C=o("WAWebBaseModel").defineModel(y);l.Msg=C}),226);
__d("WAWebMsgModelPropUtils",["WAWebBusinessProfileTypes","WAWebChatGetters","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebMsgGetters","WAWebMsgType","WAWebStateUtils","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WAWebStateUtils").unproxy(e);return t.type===o("WAWebMsgType").MSG_TYPE.INTERACTIVE?t.interactiveType===r("WAWebInteractiveMessageType").SHOPS_STOREFRONT||t.interactiveType===r("WAWebInteractiveMessageType").NATIVE_FLOW&&t.nativeFlowName!=null&&[r("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS,r("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO].includes(t.nativeFlowName):t.type===o("WAWebMsgType").MSG_TYPE.NATIVE_FLOW?t.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS||t.nativeFlowName===r("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO:t.type===o("WAWebMsgType").MSG_TYPE.PROTOCOL?t.subtype==="event_edit_decrypted":["image","video","ptv","audio","ptt","location","vcard","multi_vcard","document","ciphertext","debug_placeholder","oversized","unknown","call_log","revoked","sticker","payment","poll_creation","poll_result_snapshot","groups_v4_invite","newsletter_admin_invite","product","order","event_creation","biz_content_placeholder","album","sticker-pack","newsletter_follower_invite"].includes(t.type)}function s(e){var t=o("WAWebStateUtils").unproxy(e);if(o("WAWebUserPrefsMeUser").isMeAccount(o("WAWebMsgGetters").getSender(t))||t.senderObj!=null&&o("WAWebFrontendContactGetters").getIsMyContact(t.senderObj))return!0;var n=o("WAWebFrontendMsgGetters").getChat(t);if(o("WAWebChatGetters").getIsGroup(n)||o("WAWebChatGetters").getIsNewsletter(n))return n.isTrusted();if(o("WAWebMsgGetters").getIsPSA(t)||o("WAWebMsgGetters").getIsCAPISupport(t)||t.isFromTemplate)return!0;var r=o("WAWebChatGetters").getIsGroup(n)?t.senderObj:n.contact;return(r==null?void 0:r.verifiedLevel)===o("WAWebBusinessProfileTypes").VERIFIED_LEVEL.HIGH?!0:n.notSpam}function u(e){var t,n=o("WAWebStateUtils").unproxy(e);return((t=o("WAWebFrontendMsgGetters").getChat(n).groupMetadata)==null?void 0:t.participants.iAmMember())===!0}l.hasSymbol=e,l.isTrusted=s,l.iAmGroupParticipant=u}),98);
__d("WAWebCongratulationsAnimationsGatingUtils",["WAWebABProps","gkx"],(function(t,n,r,o,a,i,l){function e(){return!r("gkx")("26258")&&o("WAWebABProps").getABPropConfigValue("fullscreen_animation_for_keyword")}l.isCongratulationsAnimationsEnabled=e}),98);
__d("WAWebCongratulationsAnimationsUtils",["$InternalEnum","WAWebURLUtils"],(function(t,n,r,o,a,i,l){var e=n("$InternalEnum").Mirrored(["DEFAULT"]),s="https://static.whatsapp.net/wa/static/test";function u(t){var n=null;if(t===e.DEFAULT){var o={cat:"test",id:"confetti-falling",test:"1"};n=r("WAWebURLUtils").build(s,o)}return n}l.CelebrationAnimationType=e,l.getCongratulationsAnimationPath=u}),98);
__d("WAWebMsgModelUtils",["WALogger","WAWebAck","WAWebAnimatedEmojiGatingUtils","WAWebBackendErrors","WAWebChatEphemerality","WAWebChatMsgsCollection","WAWebChatPreferenceCollection","WAWebCommonMsgUtils","WAWebCongratulationsAnimationsGatingUtils","WAWebCongratulationsAnimationsUtils","WAWebEmoji","WAWebEmojiConst","WAWebFileUtils","WAWebFindChatAction","WAWebFrontendMsgGetters","WAWebGroupMetadataCollection","WAWebInteractiveMessageHeaderMediaType","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgKey","WAWebMsgModel","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebWid","WAWebWidJsonReviver","promiseDone"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f={image:!0,video:!0,audio:!0,ptt:!0,sticker:!0,document:!0,product:!0};function g(e){var t;switch(e.type){case"image":case"video":case"ptv":case"audio":case"ptt":case"sticker":case"document":case"product":case"sticker-pack":case o("WAWebMsgType").MSG_TYPE.MESSAGE_HISTORY_BUNDLE:return!0;case"protocol":return e.subtype==="history_sync_notification";case o("WAWebMsgType").MSG_TYPE.NATIVE_FLOW:return e.headerType===o("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.IMAGE;case o("WAWebMsgType").MSG_TYPE.INTERACTIVE:return!!((t=e.interactiveHeader)!=null&&t.mediaType&&o("WAWebInteractiveMessageHeaderMediaType").IM_MEDIA_HEADER_TYPES.has(e.interactiveHeader.mediaType));default:return!1}}function h(e){return e.type===o("WAWebMsgType").MSG_TYPE.CHAT&&e.subtype==="url"}function y(e){return e.type===o("WAWebMsgType").MSG_TYPE.CHAT&&e.subtype==="url"}function C(e,t){switch(t){case"text":return e.type===o("WAWebMsgType").MSG_TYPE.CHAT&&e.subtype!=="url";case"image":return e.type===o("WAWebMsgType").MSG_TYPE.IMAGE;case"video":return e.type===o("WAWebMsgType").MSG_TYPE.VIDEO&&!e.isGif;case"gif":return e.type===o("WAWebMsgType").MSG_TYPE.VIDEO&&e.isGif;case"audio":return e.type===o("WAWebMsgType").MSG_TYPE.AUDIO;case"ptt":return e.type===o("WAWebMsgType").MSG_TYPE.PTT;case"document":return e.type===o("WAWebMsgType").MSG_TYPE.DOCUMENT;case"location":return e.type===o("WAWebMsgType").MSG_TYPE.LOCATION;case"vcard":return e.type===o("WAWebMsgType").MSG_TYPE.VCARD||e.type===o("WAWebMsgType").MSG_TYPE.MULTI_VCARD;case"url":return e.type===o("WAWebMsgType").MSG_TYPE.CHAT&&e.subtype==="url";case"sticker":return e.type===o("WAWebMsgType").MSG_TYPE.STICKER;case void 0:return!1;default:return!1}}function b(e){if(!e)return null;var t=typeof e.id=="string"?e.id:e.id.id,n=new(r("WAWebMsgKey"))({from:e.from,to:e.to,id:t,participant:e.participant,selfDir:e.self});e.id=n;var a=new(o("WAWebMsgModel")).Msg(e);return a.fromQuotedMsg=!0,a}function v(e){if(e.length>1)return null;var t=e.filter(function(e){return!o("WAWebMsgGetters").getHasOriginatedFromNewsletter(e)&&(o("WAWebMsgGetters").getIsMedia(e)||o("WAWebFileUtils").isDocument(e))&&!!e.caption});return t.length===1?t[0]:null}function S(t){var n,a,i,l;if(t instanceof o("WAWebMsgModel").Msg)i=t,l=t.id;else if(t instanceof r("WAWebMsgKey"))l=t;else{o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["model:msgs:broadcastFanout: unknown msgOrKey: ",""])),String(t)).devConsole(t);return}if(!r("WAWebWid").isStatus(l.remote)){if((n=i)!=null&&n.recipients&&i.recipients.length!==0)a=i.recipients;else{var u=r("WAWebGroupMetadataCollection").get(l.remote);u?a=u.participants.map(function(e){return e.id}):o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["model:msgs:broadcastFanout no group_metadata rec for bclist, cant fanout: ",""])),l.remote.toString())}return a?a.map(function(e){return new(r("WAWebMsgKey"))({fromMe:l.fromMe,remote:e,id:l.id})}):void 0}}function R(e){var t;if(!e.invis){var n=S(e);n&&(t=n.map(function(e){return e.remote}),n.forEach(function(t){if(!o("WAWebMsgCollection").MsgCollection.some(function(e){return e.id.equals(t)})){var n=I(e);n.to=t.remote,n.id=t,n.broadcast=!0;var a=o("WAWebMsgCollection").MsgCollection.add(n,{merge:!0});r("promiseDone")(o("WAWebFindChatAction").findOrCreateLatestChat(t.remote,"msgModelBroadcastFanout"),function(e){var t=e.chat,n=a.reduce(function(e,n){if(n==null)return e;if(n.type!==o("WAWebMsgType").MSG_TYPE.PROTOCOL){o("WAWebChatEphemerality").isEphemeralSettingOn(t)&&(n.ephemeralDuration=o("WAWebChatEphemerality").getEphemeralSetting(t));var r=o("WAWebChatEphemerality").getEphemeralSettingTimestamp(t);r!=null&&(n.ephemeralSettingTimestamp=r);var a=o("WAWebChatEphemerality").getDisappearingModeInitiator(t);a!=null&&(n.disappearingModeInitiator=a)}return e.push(n),e},[]);L(n,t,!0)})}}))}return t}function L(e,t,n,r,a,i,l){var s=r||t.msgs;if(e.length!==0){var d=s===t.msgs;if(i)if(d)o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["models:msg:store:resetMostRecentMsgs .msgs === cmc !"]))),E(t,s,e);else{d=!0,E(t,s,e);var m=new(o("WAWebChatMsgsCollection")).ChatMsgsCollection;m.replace(t.msgs),t.msgChunks.push(m),t.replaceMsgsCollection(s),t.msgs.trigger("change:last",t.msgs.last())}else if(n)d?E(t,s,e):k(s,e);else{var p=0;if(l){var _=s.get(l);if(_){var f=s.indexOf(_);f!==-1&&(p=f,o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["models:msg:store:insert group history messages at index "," before anchor ",""])),p,l.toString()))}}k(s,e,{at:p,silent:e.every(T)})}var g=a;g&&!t.unreadMsgAnchor&&(t.disableUnreadAnchor?t.disableUnreadAnchor=!1:t.unreadMsgAnchor=e.find(function(e){return e.id.toString()===g.toString()}))}}function E(e,t,n){var r=n.at(-1);r&&(k(t,n),e.lastReceivedKey=r.id)}function k(e,t,n){try{e.add(t,n)}catch(e){if(e instanceof o("WAWebBackendErrors").LogoutDrop)o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["setRecords LogoutDrop: ",""])),e.toString()).devConsole(e);else throw e}}function I(e){return e!=null&&typeof e=="object"?JSON.parse(JSON.stringify(e),o("WAWebWidJsonReviver").jsonWidReviver):e}function T(e){return o("WAWebFrontendMsgGetters").getEventType(e)===o("WAWebCommonMsgUtils").EventType.IGNORE}function D(e){return e.filter(function(e){return e.ack===o("WAWebAck").ACK.READ}).map(function(e){return e.id.toString()})}var x=new RegExp(["congratulations","congrats"].join("|"));function $(e){if(!o("WAWebCongratulationsAnimationsGatingUtils").isCongratulationsAnimationsEnabled())return null;if(e!=null){var t=x.test(e.toLocaleLowerCase());if(t)return o("WAWebCongratulationsAnimationsUtils").CelebrationAnimationType.DEFAULT}return null}function P(e,t){if(t===o("WAWebMsgType").MSG_TYPE.CHAT&&!(e==null||e==="")){var n=o("WAWebEmoji").EmojiUtil.matchLargeEmojiPattern(e);if(!(n==null||n.length!==1)){var r=o("WAWebEmoji").EmojiUtil.normalizeEmoji(n[0]);return r}}}function N(e,t){if(!o("WAWebAnimatedEmojiGatingUtils").isAnimatedEmojiEnabled()||!r("WAWebChatPreferenceCollection").get("autoplayAnimatedImages"))return!1;var n=P(e,t);return n!=null&&o("WAWebEmojiConst").getSupportedAnimatedEmojis().includes(n)}var M=new Set([(_=o("WAWebMsgType")).MSG_TYPE.NOTIFICATION,_.MSG_TYPE.NOTIFICATION_TEMPLATE,_.MSG_TYPE.GP2,_.MSG_TYPE.BROADCAST_NOTIFICATION,_.MSG_TYPE.E2E_NOTIFICATION,_.MSG_TYPE.CALL_LOG,_.MSG_TYPE.PROTOCOL,_.MSG_TYPE.DEBUG,_.MSG_TYPE.CIPHERTEXT]);function w(e){var t=o("WAWebMsgGetters").getSender(e);if(t==null&&!M.has(e.type)){var n;o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Undefined sender for "," subtype:"," from:",", author:",""])),e.id.toString(),e.subtype,e.from.toString(),(n=e.author)==null?void 0:n.toString()),o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Messages should have a sender!"]))).sendLogs(e.type+"-msg-missing-sender",{sampling:.01})}return t}function A(e){var t=o("WAWebMsgGetters").getSender(e);return o("WAWebMsgGetters").getIsNewsletterMsg(e)?t=e.id.remote:o("WAWebMsgGetters").getIsGroupStatus(e)&&(t=e.author),t}l.typeIsMms=g,l.typeIsUrl=h,l.notRefiningTypeIsUrl=y,l.msgMatchesType=C,l.createQuotedMsg=b,l.getMediaMsgWithCaptionForForwarding=v,l.getBroadcastFanoutKeys=S,l.broadcastFanout=R,l.addRecordsToChat=L,l.getReadMsgKeys=D,l.getCelebrationAnimationType=$,l.isSingleEmojiMessageText=P,l.isAnimatedEmoji=N,l.getValidatedSender=w,l.getQuotedParticipantForContextInfo=A}),98);
__d("WAWebLogoFacebookIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="logo-facebook";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=28,R=28;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 28 28",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),version:"1.1",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{d:"M15.0896028,14.7272727 L15.1043384,26 L4.33333333,26 C1.91438192,26 0,24.0856181 0,21.6666667 L0,4.33333333 C0,1.91438192 1.91438192,0 4.33333333,0 L21.6666667,0 C24.0856181,0 26,1.91438192 26,4.33333333 L26,21.6666667 C26,24.0856181 24.0856181,26 21.6666667,26 L16.3649427,26 L16.3502071,14.7272727 L19.8103776,14.7272727 L20.017785,13.4545455 L16.3550034,13.4545455 L16.3636733,12.4459498 L16.3818182,10.3393939 C16.3818182,8.69776256 17.1633755,7.73939393 18.9587599,7.74051324 L20.1818182,7.68259683 L20.1818182,6.38433052 L20.1617937,6.38468908 C19.4139177,6.39804401 18.7382334,6.4060606 18.2060606,6.4060606 C16.1406731,6.4060606 15.1030303,7.44259476 15.103009,9.67926308 L15.0783339,13.4545455 L11.8018536,13.4545455 L11.8042105,14.7272727 L15.0896028,14.7272727 Z M14.1030303,25 L14.0909091,15.7272727 L10.8060606,15.7272727 L10.8,12.4545455 L14.0848485,12.4545455 L14.1030303,9.67272727 C14.1030303,6.8060606 15.6727273,5.4060606 18.2060606,5.4060606 C19.4060606,5.4060606 21.1818182,5.36363637 21.1818182,5.36363636 L21.1818182,8.63636364 L19.0060606,8.73939393 C17.6060606,8.73939393 17.3818182,9.4060606 17.3818182,10.3393939 L17.3636364,12.4545455 L21.1939394,12.4545455 L20.6606061,15.7272727 L17.3515151,15.7272727 L17.3636364,25 L21.6666667,25 C23.5333333,25 25,23.5333333 25,21.6666667 L25,4.33333333 C25,2.46666667 23.5333333,1 21.6666667,1 L4.33333333,1 C2.46666667,1 1,2.46666667 1,4.33333333 L1,21.6666667 C1,23.5333333 2.46666667,25 4.33333333,25 L14.1030303,25 Z",fillOpacity:.3,fill:"#263238",fillRule:"nonzero"}),c.jsx("path",{d:"M14.1030303,25 L4.33333333,25 C2.46666667,25 1,23.5333333 1,21.6666667 L1,4.33333333 C1,2.46666667 2.46666667,1 4.33333333,1 L21.6666667,1 C23.5333333,1 25,2.46666667 25,4.33333333 L25,21.6666667 C25,23.5333333 23.5333333,25 21.6666667,25 L17.3636364,25 L17.3515151,15.7272727 L20.6606061,15.7272727 L21.1939394,12.4545455 L17.3636364,12.4545455 L17.3818182,10.3393939 C17.3818182,9.4060606 17.6060606,8.73939393 19.0060606,8.73939393 L21.1818182,8.63636364 L21.1818182,5.36363636 C21.1818182,5.36363637 19.4060606,5.4060606 18.2060606,5.4060606 C15.6727273,5.4060606 14.1030303,6.8060606 14.1030303,9.67272727 L14.0848485,12.4545455 L10.8,12.4545455 L10.8060606,15.7272727 L14.0909091,15.7272727 L14.1030303,25 Z",fillOpacity:.6,fill:"#FFFFFF"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.LogoFacebookIcon=m}),98);
__d("WAWebLogoInstagramIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="logo-instagram";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=28,R=28;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 28 28",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),version:"1.1",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{d:"M13.0000238,0 C16.0471863,0 16.5726824,0.00844009118 17.9931478,0.0732517966 C19.2870609,0.132267821 20.2814874,0.332106718 21.2226416,0.697902272 C22.1770489,1.06875343 22.952994,1.56696125 23.6930681,2.30698242 C24.4330127,3.04697986 24.9312153,3.82289637 25.3021335,4.77732795 C25.667913,5.71859186 25.8677347,6.71299539 25.9267474,8.00683567 C25.9915599,9.42731803 26,9.95281754 26,13.0000238 C26,16.0471863 25.9915599,16.5726824 25.9267482,17.9931478 C25.8677347,19.2870046 25.667913,20.2814081 25.3021264,21.2226904 C24.9312153,22.1771036 24.4330127,22.9530201 23.6930176,23.6930681 C22.9530201,24.4330127 22.1771036,24.9312153 21.222672,25.3021335 C20.2814081,25.667913 19.2870046,25.8677347 17.9931643,25.9267474 C16.5726824,25.9915599 16.0471863,26 13.0000238,26 C9.95281754,26 9.42731803,25.9915599 8.00685221,25.9267482 C6.71299539,25.8677347 5.71859186,25.667913 4.77730956,25.3021264 C3.82289637,24.9312153 3.04697986,24.4330127 2.30693194,23.6930176 C1.56696125,22.952994 1.06875343,22.1770489 0.697933759,21.2227226 C0.332106718,20.2814874 0.132267821,19.2870609 0.0732525511,17.9931643 C0.00844009118,16.5726824 0,16.0471863 0,13.0000238 C0,9.95281754 0.00844007012,9.42731803 0.0732517966,8.00685221 C0.132267821,6.71293915 0.332106718,5.71851257 0.697902272,4.77735844 C1.06875343,3.82295107 1.56696125,3.04700595 2.30698242,2.30693194 C3.04700595,1.56696125 3.82295107,1.06875343 4.77727742,0.697933759 C5.71851257,0.332106718 6.71293915,0.132267821 8.00683567,0.0732525511 C9.42731803,0.00844007012 9.95281754,0 13.0000238,0 Z M13.0000238,4.1621583 C10.0092642,4.1621583 9.54871163,4.16940019 8.19652181,4.23109475 C7.31647529,4.27122389 6.77862056,4.38554609 6.284987,4.57739421 C5.8537324,4.74499635 5.57155295,4.92857388 5.25004154,5.25012175 C4.92857388,5.57155295 4.74499635,5.8537324 4.57739222,6.28499212 C4.38554609,6.77862056 4.27122389,7.31647529 4.23109353,8.19654849 C4.16940019,9.54871163 4.1621583,10.0092642 4.1621583,13.0000238 C4.1621583,15.9907394 4.16940021,16.4512887 4.23109475,17.8034782 C4.27122389,18.6835247 4.38554609,19.2213794 4.57739421,19.715013 C4.74497012,20.1462001 4.92857819,20.4284149 5.25012175,20.7499585 C5.57155295,21.0714261 5.8537324,21.2550037 6.28499212,21.4226078 C6.77862056,21.6144539 7.31647529,21.7287761 8.19655363,21.7689067 C9.54857728,21.8306006 10.0090682,21.8378417 13.0000238,21.8378417 C15.9909551,21.8378417 16.4514881,21.8306 17.8034782,21.7689053 C18.6835247,21.7287761 19.2213794,21.6144539 19.715013,21.4226058 C20.1462676,21.2550037 20.4284471,21.0714261 20.7499585,20.7498782 C21.0714261,20.4284471 21.2550037,20.1462676 21.4226078,19.7150079 C21.6144539,19.2213794 21.7287761,18.6835247 21.7689065,17.8034515 C21.8305998,16.4512887 21.8378417,15.9907394 21.8378417,13.0000238 C21.8378417,10.0092642 21.8305998,9.54871163 21.7689053,8.19652181 C21.7287761,7.31647529 21.6144539,6.77862056 21.4226058,6.284987 C21.2550037,5.8537324 21.0714261,5.57155295 20.7498782,5.25004154 C20.4284471,4.92857388 20.1462676,4.74499635 19.7150079,4.57739222 C19.2213794,4.38554609 18.6835247,4.27122389 17.8034515,4.23109353 C16.4512887,4.16940021 15.9907394,4.1621583 13.0000238,4.1621583 Z M13.0000238,5.8378417 C16.9555813,5.8378417 20.1621583,9.04443587 20.1621583,13.0000238 C20.1621583,16.9555727 16.9555727,20.1621583 13.0000238,20.1621583 C9.04443587,20.1621583 5.8378417,16.9555813 5.8378417,13.0000238 C5.8378417,9.04442731 9.04442731,5.8378417 13.0000238,5.8378417 Z M13.0000238,16 C14.6568646,16 16,14.6568646 16,13.0000238 C16,11.343141 14.6568701,10 13.0000238,10 C11.3431354,10 10,11.3431354 10,13.0000238 C10,14.6568701 11.343141,16 13.0000238,16 Z M19.8456418,6.59438394 C19.8456418,6.83737839 19.6486491,7.03436203 19.4056161,7.03436203 C19.1626284,7.03436203 18.965638,6.83737614 18.965638,6.59438394 C18.965638,6.35137243 19.1626477,6.15435822 19.4056161,6.15435822 C19.6486298,6.15435822 19.8456418,6.35137018 19.8456418,6.59438394 Z M21.8456418,6.59438394 C21.8456418,5.24680068 20.7531993,4.15435822 19.4056161,4.15435822 C18.0580679,4.15435822 16.965638,5.24681316 16.965638,6.59438394 C16.965638,7.94195587 18.0580691,9.03436203 19.4056161,9.03436203 C20.7531982,9.03436203 21.8456418,7.94196835 21.8456418,6.59438394 Z M13.0000238,1 C9.74099567,1 9.33234294,1.01381388 8.05241535,1.07221326 C6.77515526,1.13046973 5.90283244,1.33334326 5.13954402,1.63000828 C4.35043794,1.93662882 3.68122682,2.34694874 3.01406396,3.01406396 C2.34694874,3.68122682 1.93662882,4.35043794 1.63000828,5.13954402 C1.33334326,5.90283244 1.13046973,6.77515526 1.07221326,8.05241535 C1.01381388,9.33234294 1,9.74099567 1,13.0000238 C1,16.2590043 1.01381388,16.6676571 1.07221326,17.9475847 C1.13046973,19.2248447 1.33334326,20.0971676 1.63000828,20.860456 C1.93662882,21.6495621 2.34694874,22.3187732 3.01406396,22.985936 C3.68122682,23.6530513 4.35043794,24.0633712 5.13954402,24.3700394 C5.90283244,24.6666567 6.77515526,24.8695303 8.05241535,24.9277867 C9.33234294,24.9861861 9.74099567,25 13.0000238,25 C16.2590043,25 16.6676571,24.9861861 17.9475847,24.9277867 C19.2248447,24.8695303 20.0971676,24.6666567 20.860456,24.3700394 C21.6495621,24.0633712 22.3187732,23.6530513 22.985936,22.985936 C23.6530513,22.3187732 24.0633712,21.6495621 24.3700394,20.860456 C24.6666567,20.0971676 24.8695303,19.2248447 24.9277867,17.9475847 C24.9861861,16.6676571 25,16.2590043 25,13.0000238 C25,9.74099567 24.9861861,9.33234294 24.9277867,8.05241535 C24.8695303,6.77515526 24.6666567,5.90283244 24.3700394,5.13954402 C24.0633712,4.35043794 23.6530513,3.68122682 22.985936,3.01406396 C22.3187732,2.34694874 21.6495621,1.93662882 20.860456,1.63000828 C20.0971676,1.33334326 19.2248447,1.13046973 17.9475847,1.07221326 C16.6676571,1.01381388 16.2590043,1 13.0000238,1 Z M13.0000238,3.1621583 C16.2041299,3.1621583 16.5836782,3.17440026 17.8490298,3.23213276 C19.0190179,3.28548292 19.6544088,3.48097316 20.0772565,3.64531072 C20.6373856,3.86299845 21.0371308,4.12303286 21.4570251,4.54297487 C21.8769671,4.96286924 22.1370016,5.3626144 22.3546893,5.92274348 C22.5190268,6.34559117 22.7145171,6.9809821 22.7678672,8.15097025 C22.8255997,9.41632182 22.8378417,9.79587013 22.8378417,13.0000238 C22.8378417,16.2041299 22.8255997,16.5836782 22.7678672,17.8490298 C22.7145171,19.0190179 22.5190268,19.6544088 22.3546893,20.0772565 C22.1370016,20.6373856 21.8769671,21.0371308 21.4570251,21.4570251 C21.0371308,21.8769671 20.6373856,22.1370016 20.0772565,22.3546893 C19.6544088,22.5190268 19.0190179,22.7145171 17.8490298,22.7678672 C16.5838687,22.8255997 16.204368,22.8378417 13.0000238,22.8378417 C9.79563196,22.8378417 9.41617891,22.8255997 8.15097025,22.7678672 C6.9809821,22.7145171 6.34559117,22.5190268 5.92274348,22.3546893 C5.3626144,22.1370016 4.96286924,21.8769671 4.54297487,21.4570251 C4.1230805,21.0371308 3.86299845,20.6373856 3.64531072,20.0772565 C3.48097316,19.6544088 3.28548292,19.0190179 3.23213276,17.8490298 C3.17440026,16.5836782 3.1621583,16.2041299 3.1621583,13.0000238 C3.1621583,9.79587013 3.17440026,9.41632182 3.23213276,8.15097025 C3.28548292,6.9809821 3.48097316,6.34559117 3.64531072,5.92274348 C3.86299845,5.3626144 4.12303286,4.96286924 4.54297487,4.54297487 C4.96286924,4.12303286 5.3626144,3.86299845 5.92274348,3.64531072 C6.34559117,3.48097316 6.9809821,3.28548292 8.15097025,3.23213276 C9.41632182,3.17440026 9.79587013,3.1621583 13.0000238,3.1621583 Z M13.0000238,6.8378417 C9.59671206,6.8378417 6.8378417,9.59671206 6.8378417,13.0000238 C6.8378417,16.4032879 9.59671206,19.1621583 13.0000238,19.1621583 C16.4032879,19.1621583 19.1621583,16.4032879 19.1621583,13.0000238 C19.1621583,9.59671206 16.4032879,6.8378417 13.0000238,6.8378417 Z M13.0000238,17 C10.7908507,17 9,15.2091493 9,13.0000238 C9,10.7908507 10.7908507,9 13.0000238,9 C15.2091493,9 17,10.7908507 17,13.0000238 C17,15.2091493 15.2091493,17 13.0000238,17 Z M20.8456418,6.59438394 C20.8456418,5.79908543 20.2009146,5.15435822 19.4056161,5.15435822 C18.6103652,5.15435822 17.965638,5.79908543 17.965638,6.59438394 C17.965638,7.38968246 18.6103652,8.03436203 19.4056161,8.03436203 C20.2009146,8.03436203 20.8456418,7.38968246 20.8456418,6.59438394 Z",fillOpacity:.3,fill:"#263238",fillRule:"nonzero"}),c.jsx("path",{d:"M13.0000238,1 C16.2590043,1 16.6676571,1.01381388 17.9475847,1.07221326 C19.2248447,1.13046973 20.0971676,1.33334326 20.860456,1.63000828 C21.6495621,1.93662882 22.3187732,2.34694874 22.985936,3.01406396 C23.6530513,3.68122682 24.0633712,4.35043794 24.3700394,5.13954402 C24.6666567,5.90283244 24.8695303,6.77515526 24.9277867,8.05241535 C24.9861861,9.33234294 25,9.74099567 25,13.0000238 C25,16.2590043 24.9861861,16.6676571 24.9277867,17.9475847 C24.8695303,19.2248447 24.6666567,20.0971676 24.3700394,20.860456 C24.0633712,21.6495621 23.6530513,22.3187732 22.985936,22.985936 C22.3187732,23.6530513 21.6495621,24.0633712 20.860456,24.3700394 C20.0971676,24.6666567 19.2248447,24.8695303 17.9475847,24.9277867 C16.6676571,24.9861861 16.2590043,25 13.0000238,25 C9.74099567,25 9.33234294,24.9861861 8.05241535,24.9277867 C6.77515526,24.8695303 5.90283244,24.6666567 5.13954402,24.3700394 C4.35043794,24.0633712 3.68122682,23.6530513 3.01406396,22.985936 C2.34694874,22.3187732 1.93662882,21.6495621 1.63000828,20.860456 C1.33334326,20.0971676 1.13046973,19.2248447 1.07221326,17.9475847 C1.01381388,16.6676571 1,16.2590043 1,13.0000238 C1,9.74099567 1.01381388,9.33234294 1.07221326,8.05241535 C1.13046973,6.77515526 1.33334326,5.90283244 1.63000828,5.13954402 C1.93662882,4.35043794 2.34694874,3.68122682 3.01406396,3.01406396 C3.68122682,2.34694874 4.35043794,1.93662882 5.13954402,1.63000828 C5.90283244,1.33334326 6.77515526,1.13046973 8.05241535,1.07221326 C9.33234294,1.01381388 9.74099567,1 13.0000238,1 Z M13.0000238,3.1621583 C9.79587013,3.1621583 9.41632182,3.17440026 8.15097025,3.23213276 C6.9809821,3.28548292 6.34559117,3.48097316 5.92274348,3.64531072 C5.3626144,3.86299845 4.96286924,4.12303286 4.54297487,4.54297487 C4.12303286,4.96286924 3.86299845,5.3626144 3.64531072,5.92274348 C3.48097316,6.34559117 3.28548292,6.9809821 3.23213276,8.15097025 C3.17440026,9.41632182 3.1621583,9.79587013 3.1621583,13.0000238 C3.1621583,16.2041299 3.17440026,16.5836782 3.23213276,17.8490298 C3.28548292,19.0190179 3.48097316,19.6544088 3.64531072,20.0772565 C3.86299845,20.6373856 4.1230805,21.0371308 4.54297487,21.4570251 C4.96286924,21.8769671 5.3626144,22.1370016 5.92274348,22.3546893 C6.34559117,22.5190268 6.9809821,22.7145171 8.15097025,22.7678672 C9.41617891,22.8255997 9.79563196,22.8378417 13.0000238,22.8378417 C16.204368,22.8378417 16.5838687,22.8255997 17.8490298,22.7678672 C19.0190179,22.7145171 19.6544088,22.5190268 20.0772565,22.3546893 C20.6373856,22.1370016 21.0371308,21.8769671 21.4570251,21.4570251 C21.8769671,21.0371308 22.1370016,20.6373856 22.3546893,20.0772565 C22.5190268,19.6544088 22.7145171,19.0190179 22.7678672,17.8490298 C22.8255997,16.5836782 22.8378417,16.2041299 22.8378417,13.0000238 C22.8378417,9.79587013 22.8255997,9.41632182 22.7678672,8.15097025 C22.7145171,6.9809821 22.5190268,6.34559117 22.3546893,5.92274348 C22.1370016,5.3626144 21.8769671,4.96286924 21.4570251,4.54297487 C21.0371308,4.12303286 20.6373856,3.86299845 20.0772565,3.64531072 C19.6544088,3.48097316 19.0190179,3.28548292 17.8490298,3.23213276 C16.5836782,3.17440026 16.2041299,3.1621583 13.0000238,3.1621583 Z M13.0000238,6.8378417 C16.4032879,6.8378417 19.1621583,9.59671206 19.1621583,13.0000238 C19.1621583,16.4032879 16.4032879,19.1621583 13.0000238,19.1621583 C9.59671206,19.1621583 6.8378417,16.4032879 6.8378417,13.0000238 C6.8378417,9.59671206 9.59671206,6.8378417 13.0000238,6.8378417 Z M13.0000238,17 C15.2091493,17 17,15.2091493 17,13.0000238 C17,10.7908507 15.2091493,9 13.0000238,9 C10.7908507,9 9,10.7908507 9,13.0000238 C9,15.2091493 10.7908507,17 13.0000238,17 Z M20.8456418,6.59438394 C20.8456418,7.38968246 20.2009146,8.03436203 19.4056161,8.03436203 C18.6103652,8.03436203 17.965638,7.38968246 17.965638,6.59438394 C17.965638,5.79908543 18.6103652,5.15435822 19.4056161,5.15435822 C20.2009146,5.15435822 20.8456418,5.79908543 20.8456418,6.59438394 Z",id:"IG-logo",fillOpacity:.6,fill:"#FFFFFF"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.LogoInstagramIcon=m}),98);
__d("WAWebLogoYoutubeIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="logo-youtube";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=20,R=75;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 75 20",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),version:"1.1",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{d:"M58.0577137,16.5924517 L58.0577137,16.6109096 L54.4614664,16.6109096 L54.435877,16.4445786 C53.9935766,16.6634739 53.4952699,16.777363 52.9520481,16.777363 C52.0069701,16.777363 51.2207817,16.4221346 50.7048004,15.724042 C50.6344039,15.6287022 50.5702014,15.5280378 50.5119372,15.4219109 L50.5119372,16.5924147 L46.683398,16.5924147 L46.683398,16.6109096 L43.0871507,16.6109096 L43.0615614,16.4445786 C42.619261,16.6634739 42.1209542,16.777363 41.5777324,16.777363 C40.6326544,16.777363 39.8464661,16.4221346 39.3304847,15.724042 C39.1528633,15.4834847 39.0146744,15.2090287 38.9118132,14.898461 C38.6441723,15.4298888 38.2837063,15.8583571 37.8229911,16.1655005 C37.198009,16.5821553 36.399029,16.777326 35.4319956,16.7770426 C34.4663993,16.7540523 33.666818,16.5571404 33.0516159,16.1470057 C32.3952164,15.709406 31.9472728,15.0440781 31.7037147,14.1915153 C31.5447488,13.6510314 31.4469181,12.9965579 31.4067673,12.235867 L31.4067673,16.5925257 L27.2243783,16.5925257 L27.2243783,11.4300087 L24.3773733,1.10961535 L28.6991282,1.10961535 L28.8690811,1.89918819 L29.3165231,3.97793852 L29.9567738,1.10961535 L34.2774102,1.10961535 L33.1365212,5.18539989 C33.1442322,5.18016703 33.1519706,5.17496321 33.1597365,5.16978843 C33.7981445,4.7612073 34.5762693,4.5681841 35.492788,4.5681841 C36.4004338,4.5681841 37.1822463,4.76517621 37.8043363,5.17990291 C38.1487847,5.40943954 38.4371395,5.7067374 38.6725808,6.06418313 L38.6725808,4.75316931 L44.1471592,4.75316931 L44.1471592,1.10968933 L52.712821,1.10968933 L52.712821,4.75316931 L57.3893779,4.75316931 L57.3893779,0.610181175 L61.5349622,0.610181175 L61.5349622,4.70857657 C61.8471504,4.6027659 62.1755901,4.54976326 62.5137233,4.54976326 C63.2696894,4.54976326 63.9414049,4.78115764 64.43659,5.24539378 C64.7667068,5.55468494 65.0163437,5.95885855 65.1930604,6.44995282 C65.2727761,6.28602999 65.3610538,6.13229383 65.458189,5.98853377 C66.1229151,5.00473908 67.2126941,4.53117596 68.6169406,4.53117596 C69.5534434,4.53117596 70.3406071,4.7233183 70.9372855,5.13032953 C71.5435056,5.54366138 71.95366,6.17559898 72.1876248,6.98072766 C72.3797416,7.66456937 72.4653282,8.55012146 72.4653282,9.69251096 L72.4653282,12.3755398 L72.3518452,12.3755398 L72.3713658,12.4721766 C72.4058099,12.642692 72.4098437,12.7425382 72.4098437,13.021579 C72.4098437,14.2001549 72.0663789,15.1527839 71.3344147,15.8034187 C70.634676,16.4254086 69.6959688,16.721823 68.5614561,16.721823 C67.1615954,16.721823 66.0766331,16.2286583 65.4293218,15.2303041 C65.3280412,15.074163 65.2365958,14.9066861 65.1546963,14.7277305 C65.0949496,14.8887045 65.0290421,15.0394995 64.9568553,15.1799998 C64.4332835,16.199587 63.5533459,16.7587202 62.4212491,16.7587202 C61.9417607,16.7587202 61.4944835,16.6598433 61.0408162,16.4583658 L61.0086088,16.5924517 L58.0577137,16.5924517 L58.0577137,16.5924517 Z M24.3259002,5.62700608 C24.4236017,6.80523705 24.4550259,7.99393883 24.452758,8.86763092 C24.4527188,8.88030443 24.4527188,8.88030443 24.4527142,8.87879427 C24.4527142,8.93207856 24.4521755,9.02871609 24.4505765,9.16258163 C24.4479325,9.38394029 24.4431816,9.63016676 24.4357956,9.89517645 C24.4146551,10.6536972 24.3765715,11.41283 24.3169931,12.125387 C24.2352291,13.1032848 24.1195818,13.917554 23.9559594,14.5392558 C23.6044034,15.8450354 22.5773994,16.87197 21.265891,17.2253029 C20.4937667,17.4284935 18.9802227,17.5536738 16.85366,17.6336198 C15.8403408,17.6717145 14.7566214,17.6961593 13.6731798,17.7097362 C13.2941932,17.7144854 12.942212,17.7175391 12.626158,17.7192365 C12.4360536,17.7202574 12.2998065,17.7205989 12.2263571,17.7205989 C12.1527485,17.7205989 12.0162686,17.7202415 11.825867,17.7191733 C11.5093529,17.7173974 11.1568676,17.7142027 10.7773413,17.709234 C9.69233025,17.6950295 8.60702899,17.6694544 7.59215165,17.6295952 C5.47232465,17.5463391 3.95962355,17.4161347 3.18134306,17.2053493 C1.87545563,16.8537642 0.848339874,15.8266484 0.495965191,14.5178102 C0.3319537,13.901127 0.215623574,13.0804506 0.133715024,12.0909953 C0.0750181786,11.3819374 0.0374970877,10.6265128 0.0166687608,9.8716942 C0.0093917654,9.60797588 0.00471093513,9.36295002 0.00210595247,9.14267269 C0.000530665118,9.00946639 0,8.91330987 0,8.86029945 C0,8.80701516 0.000538670764,8.71037762 0.00213763803,8.57651208 C0.00478167356,8.35515343 0.00953263464,8.10892695 0.0169186349,7.84391726 C0.0380591243,7.0853965 0.0761427077,6.32626374 0.135721054,5.61370672 C0.217485081,4.63580895 0.333132432,3.82153968 0.496754797,3.19983788 C0.84683331,1.89954626 1.88747318,0.851922236 3.18682324,0.495296018 C3.9589475,0.292105423 5.47249146,0.166925095 7.59905417,0.0869791289 C8.61237336,0.0488844227 9.69609279,0.0244396234 10.7795344,0.0108626608 C11.158521,0.00611345554 11.5105022,0.00305983032 11.8265562,0.00136244031 C12.0166606,0.000341471398 12.1529077,0 12.2263571,0 C12.2998759,0 12.4361942,0.000355316061 12.6263728,0.00141753781 C12.9425189,0.00318333776 13.294595,0.00635996401 13.6736809,0.0113004323 C14.757431,0.0254244933 15.8414699,0.0508545797 16.8551605,0.0904875938 C18.9847305,0.173748977 20.4997674,0.304064932 21.2713711,0.515249619 C22.576591,0.866654965 23.6033241,1.8929005 23.9554197,3.19783538 C24.1252865,3.81933066 24.2440865,4.64037511 24.3259002,5.62700608 Z M22.9903436,3.45981136 C22.7314161,2.4980806 21.9731284,1.73979289 21.0113977,1.48086538 C19.2543895,1 12.2263571,1 12.2263571,1 C12.2263571,1 5.19832465,1 3.44131653,1.46237056 C2.4980806,1.72129807 1.72129807,2.4980806 1.46237056,3.45981136 C1,5.21681947 1,8.86029945 1,8.86029945 C1,8.86029945 1,12.5222742 1.46237056,14.2607875 C1.72129807,15.2225183 2.47958578,15.980806 3.44131653,16.2397335 C5.21681947,16.7205989 12.2263571,16.7205989 12.2263571,16.7205989 C12.2263571,16.7205989 19.2543895,16.7205989 21.0113977,16.2582283 C21.9731284,15.9991159 22.7314161,15.2410131 22.9903436,14.2792824 C23.4527142,12.5222742 23.4527142,8.87879427 23.4527142,8.87879427 C23.4527142,8.87879427 23.471209,5.21681947 22.9903436,3.45981136 Z M9.9884836,12.2263571 L9.9884836,5.4942418 L15.8328474,8.86029945 L9.9884836,12.2263571 Z M33.6063161,15.3149554 C34.0501918,15.6108726 34.6790158,15.7588311 35.4557983,15.777326 C36.214086,15.777326 36.8244152,15.6293674 37.2682909,15.3334502 C37.7121666,15.0375331 38.0265786,14.5566677 38.2300217,13.9278437 C38.4336497,13.280525 38.5261238,12.448258 38.5261238,11.3940531 L38.5261238,9.96995179 C38.5261238,8.8972521 38.4149699,8.04649028 38.2115268,7.41766632 C38.0080838,6.78884237 37.6938568,6.30797699 37.2497961,6.01205983 C36.8059204,5.71614268 36.214086,5.5681841 35.492788,5.5681841 C34.7529951,5.5681841 34.1611608,5.71614268 33.6987902,6.01205983 C33.2549145,6.30797699 32.9220077,6.77034755 32.7000698,7.41766632 C32.4966268,8.0649851 32.3856578,8.91574692 32.3856578,9.96995179 L32.3856578,11.3940531 C32.3856578,12.4297631 32.478132,13.280525 32.6630802,13.9093489 C32.8480284,14.5566677 33.1624404,15.0190383 33.6063161,15.3149554 Z M36.1031171,13.7613903 C35.9736534,14.0942971 35.7702103,14.2422557 35.4742932,14.2422557 C35.1598812,14.2422557 34.9379433,14.0758023 34.8269744,13.7613903 C34.6975106,13.4469784 34.6420262,12.9106285 34.6420262,12.1893305 L34.6420262,9.11918997 C34.6420262,8.41638672 34.6975106,7.8985317 34.8269744,7.5656249 C34.9379433,7.25121292 35.1598812,7.08475952 35.4557983,7.08475952 C35.7702103,7.08475952 35.9736534,7.2327181 36.1031171,7.5656249 C36.2325809,7.8985317 36.2880653,8.41638672 36.2880653,9.11918997 L36.2880653,12.1893305 C36.2880653,12.9106285 36.2325809,13.4469784 36.1031171,13.7613903 Z M67.7478689,11.3755398 L71.4653282,11.3755398 L71.4653282,9.69251096 C71.4653282,8.65680092 71.3911639,7.84302874 71.2248955,7.25119443 C71.0582571,6.67785494 70.7808348,6.23397921 70.3739487,5.95655687 C69.9672476,5.67913454 69.3754133,5.53117596 68.6169406,5.53117596 C67.525931,5.53117596 66.7491485,5.86408276 66.286778,6.54839118 C65.8244074,7.23269961 65.6022846,8.3053993 65.6022846,9.78498507 L65.6022846,11.5050035 C65.6022846,12.9475997 65.8244074,14.0018045 66.2682831,14.686113 C66.7119739,15.3704214 67.4704466,15.721823 68.5614561,15.721823 C69.4678874,15.721823 70.1706906,15.4998851 70.6700508,15.0560094 C71.169411,14.6121337 71.4098437,13.9278253 71.4098437,13.021579 C71.4098437,12.8736204 71.4098437,12.7626515 71.3911639,12.6701773 L69.4861973,12.5592084 C69.4678874,13.1695375 69.4124029,13.5949185 69.2829392,13.853846 C69.1534754,14.1127735 68.9313526,14.2422372 68.5986307,14.2422372 C68.3395183,14.2422372 68.1545701,14.1682579 68.0437861,14.0202994 C67.9141374,13.8908356 67.840343,13.6504029 67.8033534,13.3359909 C67.7663637,13.021579 67.7478689,12.5407136 67.7478689,11.9118896 L67.7478689,11.3755398 Z M68.0252912,7.26968925 C68.1362602,7.12173067 68.3027136,7.04775138 68.5614561,7.06624621 C68.783579,7.06624621 68.9685272,7.1402255 69.0793112,7.26968925 C69.190465,7.39915301 69.2829392,7.62109087 69.3199288,7.95399767 C69.3567335,8.28690447 69.3754133,8.76776985 69.3754133,9.39659381 L69.3754133,10.0993971 L67.7478689,10.0993971 L67.7478689,9.39659381 C67.7478689,8.74927503 67.7663637,8.26840965 67.8033534,7.95399767 C67.840343,7.6395857 67.9141374,7.41764783 68.0252912,7.26968925 Z M28.2058835,11.2275627 L28.2243783,11.2275627 L28.2243783,15.5925257 L30.4067673,15.5925257 L30.4067673,11.2275627 L32.9590528,2.10961535 L30.758169,2.10961535 L29.8334279,6.25245553 C29.5745003,7.4731138 29.4080469,8.32387562 29.3340677,8.84173065 L29.2785832,8.84173065 C29.1676143,8.12043258 29.0011609,7.25117593 28.779223,6.23396071 L27.8914715,2.10961535 L25.6905877,2.10961535 L28.2058835,11.2275627 Z M45.683398,5.75316931 L43.4640194,5.75316931 L43.4640194,13.5764791 C43.390225,13.7614273 43.2605763,13.9093859 43.0756281,14.0203548 C42.8906799,14.1496337 42.7057317,14.2053031 42.5207834,14.2053031 C42.2988456,14.2053031 42.1325771,14.112829 42.040103,13.9278807 C41.9476289,13.7429325 41.8919595,13.4285205 41.8919595,12.9846448 L41.8919595,5.75316931 L39.6725808,5.75316931 L39.6725808,13.1141086 C39.6725808,14.0388497 39.8207243,14.7044783 40.1349514,15.1300442 C40.4493633,15.5554251 40.9304137,15.777363 41.5777324,15.777363 C42.5207834,15.777363 43.2422664,15.3149924 43.704637,14.4087461 L43.7601215,14.4087461 L43.9450697,15.6109096 L45.683398,15.6109096 L45.683398,5.75316931 Z M57.0577137,5.75316931 L54.838335,5.75316931 L54.838335,13.5764791 C54.7645407,13.7614273 54.634892,13.9093859 54.4499438,14.0203548 C54.2649955,14.1496337 54.0800473,14.2053031 53.8950991,14.2053031 C53.6731612,14.2053031 53.5068928,14.112829 53.4144187,13.9278807 C53.3219446,13.7429325 53.2662751,13.4285205 53.2662751,12.9846448 L53.2662751,5.75316931 L51.0468965,5.75316931 L51.0468965,13.1141086 C51.0468965,14.0388497 51.19504,14.7044783 51.509267,15.1300442 C51.823679,15.5554251 52.3047293,15.777363 52.9520481,15.777363 C53.8950991,15.777363 54.6165821,15.3149924 55.0789527,14.4087461 L55.1344371,14.4087461 L55.3193854,15.6109096 L57.0577137,15.6109096 L57.0577137,5.75316931 Z M51.712821,3.90368709 L51.712821,2.10968933 L45.1471592,2.10968933 L45.1471592,3.90368709 L47.3478581,3.90368709 L47.3478581,15.5924147 L49.5119372,15.5924147 L49.5119372,3.90368709 L51.712821,3.90368709 Z M64.4001951,7.32526619 C64.2707314,6.69625729 64.0489784,6.2525665 63.7528763,5.97514417 C63.4569592,5.69772184 63.0317632,5.54976326 62.5137233,5.54976326 C62.1070221,5.54976326 61.7184459,5.66073219 61.3672292,5.90116488 C61.0156427,6.12310275 60.7382203,6.43751473 60.5532721,6.80741117 L60.5349622,6.80741117 L60.5349622,1.61018118 L58.3893779,1.61018118 L58.3893779,15.5924517 L60.2203653,15.5924517 L60.4424881,14.6677106 L60.4977876,14.6677106 C60.664241,15.0006174 60.9231685,15.25936 61.2747551,15.462988 C61.6259718,15.6479362 61.9958682,15.7587202 62.4212491,15.7587202 C63.1795369,15.7587202 63.7158867,15.4075035 64.0672883,14.7231951 C64.4188749,14.0388867 64.6038231,12.9475072 64.6038231,11.4866012 L64.6038231,9.93285118 C64.5851433,8.80485197 64.5296589,7.93559533 64.4001951,7.32526619 Z M62.3657647,11.3386426 C62.3657647,12.0597557 62.328775,12.6146004 62.2732906,13.0216714 C62.2178061,13.4285575 62.1070221,13.7242897 61.9773734,13.8909281 C61.8295998,14.0571965 61.6446516,14.1496706 61.4225287,14.1496706 C61.2375805,14.1496706 61.0711271,14.112866 60.9231685,14.0203918 C60.77521,13.9279177 60.6457462,13.798454 60.5532721,13.6318156 L60.5532721,8.04656426 C60.6274363,7.78763675 60.7567151,7.56569888 60.9416634,7.38075066 C61.1266116,7.21429726 61.3300546,7.12182315 61.5334977,7.12182315 C61.7554355,7.12182315 61.9403838,7.21429726 62.0513527,7.38075066 C62.1808165,7.56569888 62.2547957,7.86161604 62.3102802,8.26831718 C62.3657647,8.69388304 62.3844444,9.2855324 62.3844444,10.0440051 L62.3844444,11.3386426 L62.3657647,11.3386426 Z",fillOpacity:.3,fill:"#263238",fillRule:"nonzero"}),c.jsx("path",{d:"M22.9903436,3.45981136 C23.471209,5.21681947 23.4527142,8.87879427 23.4527142,8.87879427 C23.4527142,8.87879427 23.4527142,12.5222742 22.9903436,14.2792824 C22.7314161,15.2410131 21.9731284,15.9991159 21.0113977,16.2582283 C19.2543895,16.7205989 12.2263571,16.7205989 12.2263571,16.7205989 C12.2263571,16.7205989 5.21681947,16.7205989 3.44131653,16.2397335 C2.47958578,15.980806 1.72129807,15.2225183 1.46237056,14.2607875 C1,12.5222742 1,8.86029945 1,8.86029945 C1,8.86029945 1,5.21681947 1.46237056,3.45981136 C1.72129807,2.4980806 2.4980806,1.72129807 3.44131653,1.46237056 C5.19832465,1 12.2263571,1 12.2263571,1 C12.2263571,1 19.2543895,1 21.0113977,1.48086538 C21.9731284,1.73979289 22.7314161,2.4980806 22.9903436,3.45981136 Z M9.9884836,12.2263571 L15.8328474,8.86029945 L9.9884836,5.4942418 L9.9884836,12.2263571 Z M33.6063161,15.3149554 C33.1624404,15.0190383 32.8480284,14.5566677 32.6630802,13.9093489 C32.478132,13.280525 32.3856578,12.4297631 32.3856578,11.3940531 L32.3856578,9.96995179 C32.3856578,8.91574692 32.4966268,8.0649851 32.7000698,7.41766632 C32.9220077,6.77034755 33.2549145,6.30797699 33.6987902,6.01205983 C34.1611608,5.71614268 34.7529951,5.5681841 35.492788,5.5681841 C36.214086,5.5681841 36.8059204,5.71614268 37.2497961,6.01205983 C37.6938568,6.30797699 38.0080838,6.78884237 38.2115268,7.41766632 C38.4149699,8.04649028 38.5261238,8.8972521 38.5261238,9.96995179 L38.5261238,11.3940531 C38.5261238,12.448258 38.4336497,13.280525 38.2300217,13.9278437 C38.0265786,14.5566677 37.7121666,15.0375331 37.2682909,15.3334502 C36.8244152,15.6293674 36.214086,15.777326 35.4557983,15.777326 C34.6790158,15.7588311 34.0501918,15.6108726 33.6063161,15.3149554 Z M36.1031171,13.7613903 C36.2325809,13.4469784 36.2880653,12.9106285 36.2880653,12.1893305 L36.2880653,9.11918997 C36.2880653,8.41638672 36.2325809,7.8985317 36.1031171,7.5656249 C35.9736534,7.2327181 35.7702103,7.08475952 35.4557983,7.08475952 C35.1598812,7.08475952 34.9379433,7.25121292 34.8269744,7.5656249 C34.6975106,7.8985317 34.6420262,8.41638672 34.6420262,9.11918997 L34.6420262,12.1893305 C34.6420262,12.9106285 34.6975106,13.4469784 34.8269744,13.7613903 C34.9379433,14.0758023 35.1598812,14.2422557 35.4742932,14.2422557 C35.7702103,14.2422557 35.9736534,14.0942971 36.1031171,13.7613903 Z M67.7478689,11.3755398 L67.7478689,11.9118896 C67.7478689,12.5407136 67.7663637,13.021579 67.8033534,13.3359909 C67.840343,13.6504029 67.9141374,13.8908356 68.0437861,14.0202994 C68.1545701,14.1682579 68.3395183,14.2422372 68.5986307,14.2422372 C68.9313526,14.2422372 69.1534754,14.1127735 69.2829392,13.853846 C69.4124029,13.5949185 69.4678874,13.1695375 69.4861973,12.5592084 L71.3911639,12.6701773 C71.4098437,12.7626515 71.4098437,12.8736204 71.4098437,13.021579 C71.4098437,13.9278253 71.169411,14.6121337 70.6700508,15.0560094 C70.1706906,15.4998851 69.4678874,15.721823 68.5614561,15.721823 C67.4704466,15.721823 66.7119739,15.3704214 66.2682831,14.686113 C65.8244074,14.0018045 65.6022846,12.9475997 65.6022846,11.5050035 L65.6022846,9.78498507 C65.6022846,8.3053993 65.8244074,7.23269961 66.286778,6.54839118 C66.7491485,5.86408276 67.525931,5.53117596 68.6169406,5.53117596 C69.3754133,5.53117596 69.9672476,5.67913454 70.3739487,5.95655687 C70.7808348,6.23397921 71.0582571,6.67785494 71.2248955,7.25119443 C71.3911639,7.84302874 71.4653282,8.65680092 71.4653282,9.69251096 L71.4653282,11.3755398 L67.7478689,11.3755398 Z M68.0252912,7.26968925 C67.9141374,7.41764783 67.840343,7.6395857 67.8033534,7.95399767 C67.7663637,8.26840965 67.7478689,8.74927503 67.7478689,9.39659381 L67.7478689,10.0993971 L69.3754133,10.0993971 L69.3754133,9.39659381 C69.3754133,8.76776985 69.3567335,8.28690447 69.3199288,7.95399767 C69.2829392,7.62109087 69.190465,7.39915301 69.0793112,7.26968925 C68.9685272,7.1402255 68.783579,7.06624621 68.5614561,7.06624621 C68.3027136,7.04775138 68.1362602,7.12173067 68.0252912,7.26968925 Z M28.2058835,11.2275627 L25.6905877,2.10961535 L27.8914715,2.10961535 L28.779223,6.23396071 C29.0011609,7.25117593 29.1676143,8.12043258 29.2785832,8.84173065 L29.3340677,8.84173065 C29.4080469,8.32387562 29.5745003,7.4731138 29.8334279,6.25245553 L30.758169,2.10961535 L32.9590528,2.10961535 L30.4067673,11.2275627 L30.4067673,15.5925257 L28.2243783,15.5925257 L28.2243783,11.2275627 L28.2058835,11.2275627 Z M45.683398,5.75316931 L45.683398,15.6109096 L43.9450697,15.6109096 L43.7601215,14.4087461 L43.704637,14.4087461 C43.2422664,15.3149924 42.5207834,15.777363 41.5777324,15.777363 C40.9304137,15.777363 40.4493633,15.5554251 40.1349514,15.1300442 C39.8207243,14.7044783 39.6725808,14.0388497 39.6725808,13.1141086 L39.6725808,5.75316931 L41.8919595,5.75316931 L41.8919595,12.9846448 C41.8919595,13.4285205 41.9476289,13.7429325 42.040103,13.9278807 C42.1325771,14.112829 42.2988456,14.2053031 42.5207834,14.2053031 C42.7057317,14.2053031 42.8906799,14.1496337 43.0756281,14.0203548 C43.2605763,13.9093859 43.390225,13.7614273 43.4640194,13.5764791 L43.4640194,5.75316931 L45.683398,5.75316931 Z M57.0577137,5.75316931 L57.0577137,15.6109096 L55.3193854,15.6109096 L55.1344371,14.4087461 L55.0789527,14.4087461 C54.6165821,15.3149924 53.8950991,15.777363 52.9520481,15.777363 C52.3047293,15.777363 51.823679,15.5554251 51.509267,15.1300442 C51.19504,14.7044783 51.0468965,14.0388497 51.0468965,13.1141086 L51.0468965,5.75316931 L53.2662751,5.75316931 L53.2662751,12.9846448 C53.2662751,13.4285205 53.3219446,13.7429325 53.4144187,13.9278807 C53.5068928,14.112829 53.6731612,14.2053031 53.8950991,14.2053031 C54.0800473,14.2053031 54.2649955,14.1496337 54.4499438,14.0203548 C54.634892,13.9093859 54.7645407,13.7614273 54.838335,13.5764791 L54.838335,5.75316931 L57.0577137,5.75316931 Z M51.712821,3.90368709 L49.5119372,3.90368709 L49.5119372,15.5924147 L47.3478581,15.5924147 L47.3478581,3.90368709 L45.1471592,3.90368709 L45.1471592,2.10968933 L51.712821,2.10968933 L51.712821,3.90368709 Z M64.4001951,7.32526619 C64.5296589,7.93559533 64.5851433,8.80485197 64.6038231,9.93285118 L64.6038231,11.4866012 C64.6038231,12.9475072 64.4188749,14.0388867 64.0672883,14.7231951 C63.7158867,15.4075035 63.1795369,15.7587202 62.4212491,15.7587202 C61.9958682,15.7587202 61.6259718,15.6479362 61.2747551,15.462988 C60.9231685,15.25936 60.664241,15.0006174 60.4977876,14.6677106 L60.4424881,14.6677106 L60.2203653,15.5924517 L58.3893779,15.5924517 L58.3893779,1.61018118 L60.5349622,1.61018118 L60.5349622,6.80741117 L60.5532721,6.80741117 C60.7382203,6.43751473 61.0156427,6.12310275 61.3672292,5.90116488 C61.7184459,5.66073219 62.1070221,5.54976326 62.5137233,5.54976326 C63.0317632,5.54976326 63.4569592,5.69772184 63.7528763,5.97514417 C64.0489784,6.2525665 64.2707314,6.69625729 64.4001951,7.32526619 Z M62.3657647,11.3386426 L62.3844444,11.3386426 L62.3844444,10.0440051 C62.3844444,9.2855324 62.3657647,8.69388304 62.3102802,8.26831718 C62.2547957,7.86161604 62.1808165,7.56569888 62.0513527,7.38075066 C61.9403838,7.21429726 61.7554355,7.12182315 61.5334977,7.12182315 C61.3300546,7.12182315 61.1266116,7.21429726 60.9416634,7.38075066 C60.7567151,7.56569888 60.6274363,7.78763675 60.5532721,8.04656426 L60.5532721,13.6318156 C60.6457462,13.798454 60.77521,13.9279177 60.9231685,14.0203918 C61.0711271,14.112866 61.2375805,14.1496706 61.4225287,14.1496706 C61.6446516,14.1496706 61.8295998,14.0571965 61.9773734,13.8909281 C62.1070221,13.7242897 62.2178061,13.4285575 62.2732906,13.0216714 C62.328775,12.6146004 62.3657647,12.0597557 62.3657647,11.3386426 Z",fillOpacity:.6,fill:"#FFFFFF"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.LogoYoutubeIcon=m}),98);
__d("WAWebPipConst",["$InternalEnum","WAWebLogoFacebookIcon.react","WAWebLogoInstagramIcon.react","WAWebLogoYoutubeIcon.react"],(function(t,n,r,o,a,i,l){var e={YOUTUBE:"youtube.com",YOUTUBE_MOBILE:"m.youtube.com",YOUTUBE_SHORTENED:"youtu.be",INSTAGRAM:"instagram.com",STREAMABLE:"streamable.com",FACEBOOK:"facebook.com",FBWATCH:"fbwat.ch",FBWATCH_ALT:"fb.watch",SHARECHAT:"sharechat.com"},s=n("$InternalEnum").Mirrored(["FLOATER","OG_FLOATER","MEDIA_VIEWER"]),u=n("$InternalEnum").Mirrored(["OG","YOUTUBE","MSG","VOIP"]),c=16/9;function d(t){switch(t){case e.YOUTUBE:case e.YOUTUBE_MOBILE:case e.YOUTUBE_SHORTENED:return o("WAWebLogoYoutubeIcon.react").LogoYoutubeIcon;case e.INSTAGRAM:return o("WAWebLogoInstagramIcon.react").LogoInstagramIcon;case e.FACEBOOK:return o("WAWebLogoFacebookIcon.react").LogoFacebookIcon;default:return null}}var m={ONLINE_VIDEO_URL:{YOUTUBE:[/^https?:\/\/youtu\.be\/(.{11})/,/^https?:\/\/(m\.)?youtube\.com\/watch\?v=(.{11})/,/^https?:\/\/(m\.)?youtube\.com\/shorts\/(.{11})/]}},p="t",_=/^(\d+h)?(\d+m)?(\d+s)?(\d+)?$/;l.HOSTNAME=e,l.PlayerType=s,l.PiPVideoType=u,l.YOUTUBE_VIDEO_DEFAULT_ASPECT_RATIO=c,l.getAttributionIcon=d,l.URL_PATTERNS=m,l.YOUTUBE_URL_TIME_PARAM_NAME=p,l.YOUTUBE_URL_TIME_PARAM_PATTERN=_}),98);
__d("WAWebUtilsYoutubeUrlParser",["WAWebPipConst","WAWebURLUtils"],(function(t,n,r,o,a,i,l){function e(e){for(var t=o("WAWebPipConst").URL_PATTERNS.ONLINE_VIDEO_URL.YOUTUBE,n=0;n<t.length;n++){var a=r("WAWebURLUtils").withoutWww(e).match(t[n]);if(a)return a[a.length-1]}return null}l.parseYoutubeVideoId=e}),98);
__d("WAWebMsgRcatUtils",["Promise","WABase64","WACryptoHkdf","WACryptoHmac","WANullthrows","WAWebABProps","WAWebFrontendMsgGetters","WAWebMsgGetters","WAWebMsgType","WAWebUserPrefsMeUser","WAWebUtilsYoutubeUrlParser","WAWebWidToJid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s="Rcat",u=32;function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e.nonce!=null)return e.nonce;var t=o("WAWebMsgGetters").getSender(e),n=o("WAWebUserPrefsMeUser").getMaybeMePnUser();if(t==null||n==null||e.rcat==null||e.messageSecret==null)return null;var r=yield _(e.id.id,e.messageSecret,o("WAWebWidToJid").widToUserJid(t),o("WAWebWidToJid").widToUserJid(n));return e.nonce=r,r}),d.apply(this,arguments)}function m(e,t,n,r){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=new TextEncoder().encode([e,n,r,s].join("")),i=yield o("WACryptoHkdf").extractAndExpand(t,a,u);return new Uint8Array(i)}),p.apply(this,arguments)}function _(e,t,n,r){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=yield m(e,t,n,r);return o("WABase64").encodeB64UrlSafe(a,!0)}),f.apply(this,arguments)}function g(e,t){var n=o("WAWebMsgGetters").getMatchedText(e);if(n==null||n==="")return null;var r=o("WAWebUtilsYoutubeUrlParser").parseYoutubeVideoId(n);return t||r!=null?r:n}function h(e){var t=g(e,!1);return t==null?null:new TextEncoder().encode(t)}function y(e,t){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WACryptoHmac").hmacSha256(t,e);return new Uint8Array(n).slice(0,8)}),C.apply(this,arguments)}function b(e,t){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a){var i=r("WANullthrows")(o("WAWebMsgGetters").getFrom(t)),l=h(t),s=o("WAWebMsgGetters").getMessageSecret(t);if(!o("WAWebABProps").getABPropConfigValue("web_youtube_rcat_chat_generation_enabled")||a.length===0||t.type!==o("WAWebMsgType").MSG_TYPE.CHAT||!o("WAWebFrontendMsgGetters").getIsUrlMessage(t)||s==null||l==null||!o("WAWebMsgGetters").getIsSentByMe(t)||a.length>o("WAWebABProps").getABPropConfigValue("maximum_group_size_for_rcat"))return null;var u=o("WAWebWidToJid").widToUserJid(i),c=new Map,d=a.map(function(e){var n=o("WAWebWidToJid").widToUserJid(e);return m(o("WAWebMsgGetters").getId(t).id,s,u,n).then(function(e){return y(l,e)}).then(function(e){c.set(n,e)})});return yield(e||(e=n("Promise"))).all(d),c}),v.apply(this,arguments)}l.genNonceForMsg=c,l.deriveNonce=m,l.deriveNonceString=_,l.getContentIdString=g,l.genContentBindingForMsg=b}),98);
__d("WAWebQuotedMsgModelUtils",["WALogger","WAWebDBProcessReplyMsgs","WAWebLidMigrationUtils","WAWebMsgGetters","WAWebMsgModelUtils","WAWebStateUtils","WAWebUserPrefsMeUser","WAWebWid","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e){var t=d(e);return t?o("WAWebMsgGetters").getIsSentByMe(t):!1}function d(t){var n=o("WAWebStateUtils").unproxy(t);if(n.quotedMsgKey==null){try{var r=o("WAWebDBProcessReplyMsgs").createQuotedMsgKey(n);r!=="missing-stanza-id"&&(n.quotedMsgKey=r)}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to create quoted msg key"]))).devConsole(t).sendLogs("qmk-fail")}if(n.quotedMsgKey==null)return null}if(!n.quotedMsg&&!n.paymentRequestMessageKey)return null;var a=n.getCollection(),i=n.quotedMsgKey;if(i){var l=a.get(i);if(l)return l.safe();var s=o("WAWebLidMigrationUtils").getAlternateMsgKey(i);if(s){var u=a.get(s);if(u)return u.safe()}}var c;return n.quotedMsg?c=m(n):n.paymentRequestMessageKey&&(c=p(n)),c==null?null:(n.quotedMsgKey=c.id,c.ephemeralDuration=null,a.add(c.unsafe()),c)}function m(e){var t,n=h(e),a=y(e),i=e.quotedStanzaID;if(!n||!a||r("isStringNullOrEmpty")(i))return null;var l=o("WAWebUserPrefsMeUser").isMeAccount(n),s=l?"out":"in",u=e.quotedRemoteJid?e.quotedRemoteJid:e.id.remote,c={id:i,from:l?a:u,to:l?u:a,self:s,author:n,remote:u},d=r("WAWebWid").isGroup(c.from)||r("WAWebWid").isGroup(c.to);(d||r("WAWebWid").isStatus(u))&&(c.participant=n),Object.assign(c,e.quotedMsg);var m=(t=o("WAWebMsgModelUtils").createQuotedMsg(c))!=null?t:void 0;return m==null?null:(e.selectedCarouselCardIndex!=null&&(m.interactiveHeader=void 0,m.isCarouselCard=!1),m.safe())}function p(e){var t,n=h(e),r=y(e);if(!e.paymentRequestMessageKey||!n||!r)return null;var a=e.paymentRequestMessageKey.remote?e.paymentRequestMessageKey.remote:e.id.remote,i=e.paymentRequestMessageKey.fromMe,l=e.paymentRequestMessageKey.self!=null?e.paymentRequestMessageKey.self:i?"out":"in",s=e.paymentRequestMessageKey.participant||e.paymentMessageReceiverJid,u=e.paymentRequestMessageKey.id,c={id:u,from:i?r:a,to:i?a:r,self:l,participant:s,author:s,remote:a,amount1000:e.paymentAmount1000,currency:e.paymentCurrency,receiverJid:o("WAWebMsgGetters").getSender(e),type:e.type,subtype:"request"};return(t=o("WAWebMsgModelUtils").createQuotedMsg(c))==null?void 0:t.safe()}function _(e){var t=o("WAWebStateUtils").unproxy(e);return t.quotedMsg==null?t.quotedRemoteJid:null}function f(e){var t=o("WAWebStateUtils").unproxy(e);return t.quotedMsg==null?t.quotedGroupSubject:null}function g(e){var t=o("WAWebStateUtils").unproxy(e);return t.quotedMsg==null?t.quotedParentGroupJid:null}var h=function(t){return t.quotedParticipant==null&&o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["null quotedParticipant in quotedMsg"]))).devConsole(t).sendLogs("null-quoted-participant"),t.quotedParticipant},y=function(t){var e=o("WAWebUserPrefsMeUser").getMaybeMePnUser();return e==null&&o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["null meUser in quotedMsg"]))).devConsole(t).sendLogs("null-me-user"),e};l.isMyQuotedMsg=c,l.getQuotedMsgObj=d,l.createQuotedMsgObj=m,l.getQuotedMsgAdminGroupJid=_,l.getQuotedMsgAdminGroupSubject=f,l.getQuotedMsgAdminParentGroupJid=g}),98);
__d("WAWebStarredMsgCollection",["Promise","WALogger","WANullthrows","WAWebBaseCollection","WAWebCollectionConstants","WAWebFrontendMsgGetters","WAWebMsgCollection","WAWebMsgModel","WAWebSocketConstants","WAWebSocketModel"],(function(t,n,r,o,a,i,l){var e,s,u,c=(function(t){function a(){var e;return e=t.call(this)||this,e.syncPromise=null,e.isSynced=!1,e.listenTo(o("WAWebSocketModel").Socket,"change:stream",function(){o("WAWebSocketModel").Socket.stream===o("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED?e.isSynced=!1:o("WAWebSocketModel").Socket.stream===o("WAWebSocketConstants").SOCKET_STREAM.CONNECTED&&e.delete()}),e}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.process=function(t,n,r,o){o!==!0?this.updateMsgs(t,n,r):this.delete()},i.sync=function(a){if(this.isSynced)return(u||(u=n("Promise"))).resolve();if(this.syncPromise!=null)return this.syncPromise;var t=this,i,l=this.last();return l&&(i=l.id),this.syncPromise=o("WAWebMsgCollection").MsgCollection.getStarred(a,o("WAWebCollectionConstants").PAGE_SIZE,i).then(function(e){e.length&&t.add(e,{silent:!0}),e.length<o("WAWebCollectionConstants").PAGE_SIZE&&(t.isSynced=!0)}).catch(function(t){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["starred msg sync error: "]))).devConsole(t)}).finally(function(){t.syncPromise=null,t.trigger("sync")}),this.trigger("sync"),r("WANullthrows")(this.syncPromise,"syncPromise can not be null")},i.updateMsgs=function(t,r,a){var e=this,i=this.syncPromise||(u||(u=n("Promise"))).resolve();this.syncPromise=i.then(function(){if(t){var i=r.length>0?o("WAWebMsgCollection").MsgCollection.incrementalStarredUpdate(r):(u||(u=n("Promise"))).resolve([]);return i.then(function(t){var n=t.concat(a);e.isSynced&&e.add(n,{silent:!0}),n.forEach(function(e){var t;(t=o("WAWebFrontendMsgGetters").getChat(e).starredMsgs)==null||t.add(e)}),e.trigger("sync")}).catch(function(e){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["models:starred:update:error: "]))).devConsole(e)})}var l=r.concat(a).filter(function(e){return!e.star});p(l)}).finally(function(){e.syncPromise=null})},i.delete=function(){this.isSynced=!1,t.prototype.delete.call(this)},a})(o("WAWebBaseCollection").BaseCollection);c.model=o("WAWebMsgModel").Msg,c.comparator=function(e,t){return t.t-e.t};var d=new c;function m(e){d.add(e),e.forEach(function(e){var t;(t=o("WAWebFrontendMsgGetters").getChat(e).starredMsgs)==null||t.add(e)})}function p(e){d.remove(e),e.forEach(function(e){var t;(t=o("WAWebFrontendMsgGetters").getChat(e).starredMsgs)==null||t.remove(e)})}l.StarredMsgCollection=c,l.AllStarredMsgsCollection=d,l.addStarredMsgs=m,l.removeStarredMsgs=p}),98);
__d("WAWebSyncButtonState",["WANullthrows","WAWebBizInteractiveMessageQuickReplyAction","WAWebFrontendMsgGetters","WAWebMsgButtonReplyMsgCollection","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgType","WAWebQuotedMsgModelUtils","WAWebTemplateButtonReplyMsgCollection","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){function e(e){s(e),u(e),c(e)}function s(e){for(var t=function(){var t=e[a];if(!t||t.selectedCarouselCardIndex!=null)return 0;if(d(t)){var n=o("WAWebFrontendMsgGetters").getChat(t);n.msgUnsyncedButtonReplyMsgs==null&&(n.msgUnsyncedButtonReplyMsgs=new(r("WAWebMsgButtonReplyMsgCollection")));var i=n.msgUnsyncedButtonReplyMsgs,l=o("WAWebQuotedMsgModelUtils").getQuotedMsgObj(t);if(!l)return 0;var s=i.get(l.id);s||(i.add({id:l.id,unsyncedButtonReplies:new(r("WAWebTemplateButtonReplyMsgCollection"))}),s=i.get(l.id));var u=r("WANullthrows")(s),c=u.unsyncedButtonReplies;c.add(t);var m=o("WAWebMsgCollection").MsgCollection.get(l.id);if(m!=null&&m.buttons){var p=m.buttons.get(""+r("WANullthrows")(t.selectedIndex));p&&(p.selected=!0),c.remove(t)}}else if(t.isFromTemplate&&t.buttons){var _=o("WAWebFrontendMsgGetters").getChat(t),f=_.msgUnsyncedButtonReplyMsgs;if(f==null)return 0;var g=f.get(t.id);g&&(g.unsyncedButtonReplies.forEach(function(e){var n=r("WANullthrows")(t.buttons).get(""+r("WANullthrows")(e.selectedIndex));n&&(n.selected=!0)}),g.unsyncedButtonReplies.delete())}},n,a=0;a<e.length;a++)n=t()}function u(e){for(var t=function(){var t=e[r];if(!t||t.selectedCarouselCardIndex!=null)return 0;if(t.type===o("WAWebMsgType").MSG_TYPE.BUTTONS_RESPONSE&&t.selectedButtonId!=null&&m(t)){var n=o("WAWebQuotedMsgModelUtils").getQuotedMsgObj(t);if(!n)return 0;var a=o("WAWebMsgCollection").MsgCollection.get(n.id);if(a!=null&&a.replyButtons){var i=a.replyButtons.get(t.selectedButtonId);i&&(i.selected=!0)}}else if(t.isDynamicReplyButtonsMsg&&t.replyButtons&&t.replyButtons.every(function(e){return!e.selected})&&o("WAWebFrontendMsgGetters").getChat(t)){var l=Math.max(0,o("WAWebFrontendMsgGetters").getChat(t).msgs.length-1e3);o("WAWebFrontendMsgGetters").getChat(t).msgs.getModelsArray().slice(l).filter(function(e){var n;return e.type===o("WAWebMsgType").MSG_TYPE.BUTTONS_RESPONSE&&e.selectedButtonId!=null&&m(e)&&((n=o("WAWebQuotedMsgModelUtils").getQuotedMsgObj(e))==null?void 0:n.id.toString())===t.id.toString()}).map(function(e){var t=e.selectedButtonId;return t}).forEach(function(e){var n,r=(n=t.replyButtons)==null?void 0:n.get(e);r!=null&&(r.selected=!0)})}},n,r=0;r<e.length;r++)n=t()}function c(e){for(var t=function(){var t=e[a];if(!t)return 0;if(d(t)&&t.selectedCarouselCardIndex!=null){var n=r("WANullthrows")(t.selectedCarouselCardIndex),i=r("WANullthrows")(t.selectedIndex),l=o("WAWebQuotedMsgModelUtils").getQuotedMsgObj(t);if(!l)return 0;var s=o("WAWebMsgCollection").MsgCollection.get(l.id);if(s==null||s.carouselCardsParsed==null||s.carouselCardsParsed[n]==null)return 0;var u=s.carouselCardsParsed.slice();u[n]=babelHelpers.extends({},u[n],{interactivePayload:o("WAWebBizInteractiveMessageQuickReplyAction").rebuildInteractivePayloadWithDisabledButton(u[n].interactivePayload,i)}),s.carouselCardsParsed=u}else if(t.type===o("WAWebMsgType").MSG_TYPE.INTERACTIVE&&t.carouselCardsParsed!=null&&o("WAWebFrontendMsgGetters").getChat(t)){var c=Math.max(0,o("WAWebFrontendMsgGetters").getChat(t).msgs.length-1e3),m=o("WAWebFrontendMsgGetters").getChat(t).msgs.getModelsArray().slice(c).filter(function(e){var n;return d(t)&&e.selectedCarouselCardIndex!=null&&((n=o("WAWebQuotedMsgModelUtils").getQuotedMsgObj(e))==null?void 0:n.id.toString())===t.id.toString()});if(m.length===0)return 0;var p=r("WANullthrows")(t.carouselCardsParsed).slice();for(var _ of m){var f=r("WANullthrows")(_.selectedCarouselCardIndex),g=r("WANullthrows")(_.selectedIndex);p[f]!=null&&(p[f]=babelHelpers.extends({},p[f],{interactivePayload:o("WAWebBizInteractiveMessageQuickReplyAction").rebuildInteractivePayloadWithDisabledButton(p[f].interactivePayload,g)}))}t.carouselCardsParsed=p}},n,a=0;a<e.length;a++)n=t()}function d(e){return e.type===o("WAWebMsgType").MSG_TYPE.TEMPLATE_BUTTON_REPLY&&e.selectedIndex!=null&&m(e)}var m=function(t){var e=o("WAWebMsgGetters").getSender(t);return e!=null?e.equals(o("WAWebUserPrefsMeUser").getMePnUserOrThrow()):!1};l.default=e}),98);
__d("WAWebBlocklistCollection",["WAWebBaseCollection","WAWebBlocklistModel","WAWebContactCollection","WAWebLidMigrationUtils","WAWebWidFactory"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){var t;return t=e.call(this)||this,t.listenTo(t,"add",function(e){t.$BlocklistCollectionImpl$p_1(e.id,!0)}),t.listenTo(t,"remove",function(e){t.$BlocklistCollectionImpl$p_1(e.id,!1)}),t}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.$BlocklistCollectionImpl$p_1=function(t,n){var e=o("WAWebWidFactory").asUserWidOrThrow(t);for(var r of[o("WAWebLidMigrationUtils").toPn(e),o("WAWebLidMigrationUtils").toLid(e)])if(r){var a;(a=o("WAWebContactCollection").ContactCollection.get(r))==null||a.set("isContactBlocked",n)}},n.replaceAllWith=function(t){var e=this,n=new Map(t.map(function(e){return[e.toString(),new(r("WAWebBlocklistModel"))({id:e})]}));this.toArray().forEach(function(t){n.has(t.id.toString())?n.delete(t.id.toString()):e.remove(t)}),n.forEach(function(t){return e.add(t)})},n.dedupedList=function(){var e=this;return this.filter(function(t){var n=t.contact(),r=n.phoneNumber;return n.id.isLid()&&r!=null?e.get(r)==null:!0})},t})(o("WAWebBaseCollection").BaseCollection);e.model=r("WAWebBlocklistModel");var s=new e;l.BlocklistCollection=s}),98);
__d("WAWebBlocklistModel",["WAWebBaseModel","WAWebBlocklistCollection","WAWebContactCollection","WAWebWid"],(function(t,n,r,o,a,i,l){function e(e){throw new TypeError('"'+e+'" is read-only')}var s=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.contact=function(){var e=o("WAWebContactCollection").ContactCollection.gadd(this.id);return e},n.getCollection=function(){return o("WAWebBlocklistCollection").BlocklistCollection},t})(o("WAWebBaseModel").BaseModel);s.Proxy="blocklist",s.idClass=r("WAWebWid");var u=o("WAWebBaseModel").defineModel(s);l.default=u}),98);
__d("WAWebKeptMsgCollection",["WAWebBaseCollection","WAWebMsgModel","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.isSynced=!0,t.syncPromise=null,babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var r=t.prototype;return r.process=function(){},r.sync=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){});function t(){return e.apply(this,arguments)}return t})(),r.updateMsgs=function(){},t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebMsgModel").Msg,e.comparator=function(e,t){return t.t-e.t},l.KeptMsgCollection=e}),98);
__d("WAWebUpdateOptOutListDbJob",["WALogger","WAWebSchemaOptOutList","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s;function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var a=t.toString();try{n?yield o("WAWebSchemaOptOutList").getOptOutListTable().createOrReplace({id:a}):yield o("WAWebSchemaOptOutList").getOptOutListTable().remove(a)}catch(t){throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[WAWebUpdateOptOutListDbJob] updateOptOutListDbJob failed"]))).verbose().devConsole(t).sendLogs("Failed to update optoutlist db"),r("err")("updateOptOutListDbJob failed")}}),c.apply(this,arguments)}function d(){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{yield o("WAWebSchemaOptOutList").getOptOutListTable().clear()}catch(e){throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[WAWebUpdateOptOutListDbJob] clearOptOutListDbJob failed"]))).devConsole(e),r("err")("clearOptOutListDbJob failed")}}),m.apply(this,arguments)}l.updateOptOutListDbJob=u,l.clearOptOutListDbJob=d}),98);
__d("WAWebOptOutListCollection",["Promise","WAWebBaseCollection","WAWebContactCollection","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebOptOutListModel","WAWebUpdateOptOutListDbJob","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=function(t){return o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()?o("WAWebLidMigrationUtils").toLid(t):null},u=(function(t){function a(){var r;return r=t.call(this)||this,r.updateOptOutListInCollectionAndDb=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=t.targetWid,a=t.isBlocked,i=o("WAWebWidFactory").asUserWidOrThrow(r);if(a){yield o("WAWebUpdateOptOutListDbJob").updateOptOutListDbJob(i,a),c.add({id:i});return}var l=[o("WAWebLidMigrationUtils").toPn(i),s(i)].filter(Boolean);yield(e||(e=n("Promise"))).all(l.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield o("WAWebUpdateOptOutListDbJob").updateOptOutListDbJob(e,a),c.remove(e)});return function(t){return e.apply(this,arguments)}})()))});return function(e){return t.apply(this,arguments)}})(),r.listenTo(r,"add",function(e){r.$OptOutListCollectionImpl$p_1(e.id,!0)}),r.listenTo(r,"remove",function(e){r.$OptOutListCollectionImpl$p_1(e.id,!1)}),r}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.$OptOutListCollectionImpl$p_1=function(t,n){var e=o("WAWebWidFactory").asUserWidOrThrow(t);for(var r of[o("WAWebLidMigrationUtils").toPn(e),s(e)])if(r){var a=o("WAWebContactCollection").ContactCollection.get(r);a&&(a.set("isContactOptedOut",n),n&&a.set("isEverOptedOutOfMarketingMessages",n))}},i.replaceAllWith=function(t){var e=this,n=new Map(t.map(function(e){return[e.wid.toString(),new(r("WAWebOptOutListModel"))({id:e.wid})]}));this.toArray().forEach(function(t){n.has(t.id.toString())?n.delete(t.id.toString()):e.remove(t)}),n.forEach(function(t){return e.add(t)})},a})(o("WAWebBaseCollection").BaseCollection);u.model=r("WAWebOptOutListModel");var c=new u;l.OptOutListCollection=c}),98);
__d("WAWebOptOutListModel",["WAWebBaseModel","WAWebContactCollection","WAWebOptOutListCollection","WAWebWid"],(function(t,n,r,o,a,i,l){function e(e){throw new TypeError('"'+e+'" is read-only')}var s=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.contact=function(){var e=o("WAWebContactCollection").ContactCollection.gadd(this.id);return e},n.getCollection=function(){return o("WAWebOptOutListCollection").OptOutListCollection},t})(o("WAWebBaseModel").BaseModel);s.Proxy="optoutlist",s.idClass=r("WAWebWid");var u=o("WAWebBaseModel").defineModel(s);l.default=u}),98);
__d("WAWebPresenceCollection",["WAWebBaseCollection","WAWebChatCollection","WAWebContactPresenceBridge","WAWebPresenceChatAction","WAWebPresenceModel","WAWebWid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a))||this,t.findImpl=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n=t.gadd(e);return!n.isUser||r("WAWebWid").isServer(e)||r("WAWebWid").isPSA(e)||r("WAWebWid").isFbidBot(e)?{id:e}:(yield t._subscribe(e),{id:e})});return function(t){return e.apply(this,arguments)}})(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a._subscribe=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebChatCollection").ChatCollection.get(e);if(t){var n=o("WAWebPresenceChatAction").getChatIdentifier(t),r=t==null?void 0:t.getTcToken();yield o("WAWebContactPresenceBridge").subscribePresence(n,r)}});function t(t){return e.apply(this,arguments)}return t})(),a.reSubscribeWhenActive=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this.get(e);t==null||t.isSubscribed===!1||(yield this._subscribe(e))});function t(t){return e.apply(this,arguments)}return t})(),a.clearAllPresence=function(){this.forEach(function(e){e.reset(),e.set({stale:!0,isSubscribed:!1})})},t})(o("WAWebBaseCollection").BaseCollection);e.model=o("WAWebPresenceModel").Presence,e.staleCollection=!0;var s=new e;l.PresenceCollection=s}),98);
__d("WAWebPresenceEnum",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["Info","Business","ChatAssignment","None","LastSeen","E2EE","Self","CommunityName","OnlyAdminsCanSend"]);i.WithholdDisplayStage=e}),66);
__d("WAWebPresenceModel",["fbt","WALogger","WAWebBaseCollection","WAWebBaseModel","WAWebChatAssignmentCollection","WAWebChatAssignmentUtils","WAWebChatCollection","WAWebChatContactUtils","WAWebChatGetters","WAWebClock","WAWebContactCollection","WAWebContactGetters","WAWebElevatedPushNamesFlag","WAWebFrontendChatGetters","WAWebFrontendContactGetters","WAWebGroupType","WAWebPresenceCollection","WAWebPresenceEnum","WAWebPrivacyGatingUtils","WAWebTextStatusGatingUtils","WAWebWid","lodash"],(function(t,n,r,o,a,i,l,s){var e,u,c,d=3e3,m=5e3,p=2e3,_=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.type=o("WAWebBaseModel").prop(),t.t=o("WAWebBaseModel").prop(),t.deny=o("WAWebBaseModel").prop(),t.updateTime=o("WAWebBaseModel").session(),t.expireTimerId=o("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})((c=o("WAWebBaseModel")).BaseModel);_.Proxy="chatstate",_.idClass=r("WAWebWid");var f=c.defineModel(_),g=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WAWebBaseCollection").BaseCollection);g.model=f;var h=(function(t){function n(){for(var e,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a))||this,e.id=o("WAWebBaseModel").prop(),e.isOnline=o("WAWebBaseModel").session(!1),e.stale=o("WAWebBaseModel").session(!0),e.hasData=o("WAWebBaseModel").session(!1),e.isSubscribed=o("WAWebBaseModel").session(!1),e.withholdDisplayStage=o("WAWebBaseModel").session(o("WAWebPresenceEnum").WithholdDisplayStage.None),e.forceDisplay=o("WAWebBaseModel").session(!1),e.chatActive=o("WAWebBaseModel").session(!1),e.withholdDisplayTimer=o("WAWebBaseModel").session(),e.forceDisplayTimer=o("WAWebBaseModel").session(),e.chatstate=o("WAWebBaseModel").session(),e.chatstates=o("WAWebBaseModel").collection(g),e.isGroup=o("WAWebBaseModel").derived(function(){return r("WAWebWid").isGroup(this.id)}),e.isUser=o("WAWebBaseModel").derived(function(){return r("WAWebWid").isUser(this.id)}),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.initialize=function(){var e=this;t.prototype.initialize.call(this);var n=this.isGroup?{id:"",type:"unavailable"}:{id:this.id};this.addChild("chatstate",new f(n)),this.isGroup?this.listenTo(this.chatstates,"add change",r("lodash").debounce(function(){var t,n=!1;e.chatstates.forEach(function(e){(e.type==="typing"||e.type==="recording_audio")&&(!t||t.updateTime<e.updateTime)&&(t=e),n=n||e.type==="available"}),e.set({isOnline:n}),e.chatstate.set({id:t?t.id:"",type:t?t.type:"unavailable"})})):this.listenTo(this.chatstate,"change:type",function(){e.chatstate.type==="available"?e.isOnline=!0:e.chatstate.type==="unavailable"&&(e.isOnline=!1)}),this.listenTo(this,"change:chatActive",this.$PresenceImpl$p_1)},a.delete=function(){t.prototype.delete.call(this),this.getCollection().remove(this.id),this.chatstate.delete(),this.chatstates.forEach(function(e){return e.delete()})},a.reset=function(){this.hasData=!1,this.isGroup?this.chatstates.forEach(function(e){e.type="unavailable"}):this.isUser&&(this.chatstate.unset("t"),this.chatstate.unset("deny")),this.chatstate.set({id:this.isGroup?"":this.id,type:"unavailable",t:void 0,deny:void 0})},a.isActive=function(){var e=this.chatstate.type;return this.hasData&&(e==="typing"||e==="recording_audio")},a.getGroupSubtitleText=function(n){var t;if(!this.hasData)return null;if(!this.isGroup)return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getGroupSubtitleText is used when presence is not for a group"]))).sendLogs("getGroupSubtitleText-not-group"),null;var r=this.$PresenceImpl$p_2();if(r==null)return null;var a,i=(t=n==null?void 0:n.elevatedPushNamesEnabled)!=null?t:!1,l=o("WAWebElevatedPushNamesFlag").pushNameCanBeUsed(r)&&i,u;if(l){u=o("WAWebChatContactUtils").getFormattedNotifyName(o("WAWebContactGetters").getNotifyName(r));var c=o("WAWebChatContactUtils").getAccessibleNotifyName(o("WAWebContactGetters").getNotifyName(r));a=this.chatstate.type==="typing"?s._(/*BTDS*/"{member} est\u00e1 escribiendo\u2026",[s._param("member",c)]):s._(/*BTDS*/"{member} est\u00e1 grabando un audio\u2026",[s._param("member",c)])}else u=o("WAWebFrontendContactGetters").getFormattedShortName(r);return{text:this.chatstate.type==="typing"?s._(/*BTDS*/"{member} est\u00e1 escribiendo\u2026",[s._param("member",u)]):s._(/*BTDS*/"{member} est\u00e1 grabando un audio\u2026",[s._param("member",u)]),ariaLabel:a}},a.$PresenceImpl$p_2=function(){var e=this.chatstate.id;return e?o("WAWebContactCollection").ContactCollection.get(e):null},a.getUserSubtitleText=function(t){if(t===void 0&&(t=!1),!this.hasData)return null;if(!this.isUser)return o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["getUserSubtitleText is used when presence is not for a user"]))).sendLogs("getUserSubtitleText-not-user"),null;var e=this.chatstate;switch(e.type){case"available":return s._(/*BTDS*/"en l\u00ednea");case"typing":return t?s._(/*BTDS*/"en l\u00ednea"):s._(/*BTDS*/"escribiendo...");case"recording_audio":return t?s._(/*BTDS*/"en l\u00ednea"):s._(/*BTDS*/"grabando audio...");case"unavailable":return e.deny||e.t==null?null:o("WAWebClock").Clock.lastSeenStr(e.t)}},a.getFormattedString=function(t){if(this.hasData){if(this.isGroup){var e=this.getGroupSubtitleText(t);if(e!=null)return{text:e.text,ariaLabel:e.ariaLabel}}else if(this.isUser)return{text:this.getUserSubtitleText()}}else return null;return null},a.getGroupStages=function(t){var e,n,r,a,i=[];return((e=t.groupMetadata)==null?void 0:e.groupType)===o("WAWebGroupType").GroupType.LINKED_SUBGROUP&&(n=t.groupMetadata)!=null&&n.participants.iAmMember()&&i.push(o("WAWebPresenceEnum").WithholdDisplayStage.CommunityName),t!=null&&(r=t.groupMetadata)!=null&&r.participants.iAmAdmin()&&(a=t.groupMetadata)!=null&&a.announce?(i.push(o("WAWebPresenceEnum").WithholdDisplayStage.OnlyAdminsCanSend),o("WAWebPrivacyGatingUtils").isDataPrivacyPhase2Enabled()&&t!=null&&o("WAWebFrontendChatGetters").getIsE2ee(t)&&i.push(o("WAWebPresenceEnum").WithholdDisplayStage.E2EE)):o("WAWebPrivacyGatingUtils").isDataPrivacyPhase2Enabled()&&t!=null&&o("WAWebFrontendChatGetters").getIsE2ee(t)?i.push(o("WAWebPresenceEnum").WithholdDisplayStage.E2EE):i.push(o("WAWebPresenceEnum").WithholdDisplayStage.Info),o("WAWebTextStatusGatingUtils").receiveTextStatusForNewSurfacesEnabled()&&i.push(o("WAWebPresenceEnum").WithholdDisplayStage.LastSeen),i.push(o("WAWebPresenceEnum").WithholdDisplayStage.None),i},a.$PresenceImpl$p_1=function(){var e=this,t=this.chatActive;if(t){var n=o("WAWebChatAssignmentCollection").ChatAssignmentCollection.getAgentCollectionForChatId(this.id).length>0,r=this.$PresenceImpl$p_2(),a=r&&o("WAWebContactGetters").getIsMe(r),i=[],l=o("WAWebChatCollection").ChatCollection.get(this.id);l!=null&&o("WAWebChatGetters").getIsGroup(l)?i=this.getGroupStages(l):a===!0?(o("WAWebPrivacyGatingUtils").isDataPrivacyPhase2Enabled()&&l!=null&&o("WAWebFrontendChatGetters").getIsE2ee(l)&&i.push(o("WAWebPresenceEnum").WithholdDisplayStage.E2EE),i.push(o("WAWebPresenceEnum").WithholdDisplayStage.Self),y(this,i)):this.hasData?(o("WAWebChatAssignmentUtils").canAssignChat(l)&&n&&i.push(o("WAWebPresenceEnum").WithholdDisplayStage.ChatAssignment),(r==null?void 0:r.isBusiness)===!0&&i.push(o("WAWebPresenceEnum").WithholdDisplayStage.Business),o("WAWebTextStatusGatingUtils").receiveTextStatusForNewSurfacesEnabled()&&i.push(o("WAWebPresenceEnum").WithholdDisplayStage.LastSeen),i.length>0||o("WAWebTextStatusGatingUtils").receiveTextStatusForNewSurfacesEnabled()&&i.push(o("WAWebPresenceEnum").WithholdDisplayStage.LastSeen),i.push(o("WAWebPresenceEnum").WithholdDisplayStage.None)):(o("WAWebChatAssignmentUtils").canAssignChat(l)&&n&&i.push(o("WAWebPresenceEnum").WithholdDisplayStage.ChatAssignment),(r==null?void 0:r.isBusiness)===!0&&i.push(o("WAWebPresenceEnum").WithholdDisplayStage.Business),o("WAWebPrivacyGatingUtils").isDataPrivacyPhase2Enabled()&&l!=null&&o("WAWebFrontendChatGetters").getIsE2ee(l)?i.push(o("WAWebPresenceEnum").WithholdDisplayStage.E2EE):i.push(o("WAWebPresenceEnum").WithholdDisplayStage.Info),o("WAWebTextStatusGatingUtils").receiveTextStatusForNewSurfacesEnabled()&&i.push(o("WAWebPresenceEnum").WithholdDisplayStage.LastSeen),i.push(o("WAWebPresenceEnum").WithholdDisplayStage.None)),y(this,i),this.forceDisplayTimer=self.setTimeout(function(){e.set({forceDisplay:!0,forceDisplayTimer:void 0})},p)}else this.withholdDisplayTimer&&(self.clearTimeout(this.withholdDisplayTimer),this.withholdDisplayTimer=void 0),this.forceDisplayTimer&&(self.clearTimeout(this.forceDisplayTimer),this.forceDisplayTimer=void 0)},a.subscribe=function(){return this.getCollection().find(this.id)},a.getCollection=function(){return o("WAWebPresenceCollection").PresenceCollection},n})(c.BaseModel);h.Proxy="presence",h.idClass=r("WAWebWid");function y(e,t){if(t.length!==0){var n=t[0],r=babelHelpers.arrayLikeToArray(t).slice(1);e.set({withholdDisplayStage:n,withholdDisplayTimer:n===o("WAWebPresenceEnum").WithholdDisplayStage.None?null:self.setTimeout(function(){y(e,r)},n===o("WAWebPresenceEnum").WithholdDisplayStage.Business?m:d)})}}var C=c.defineModel(h);l.processStagesRecursively=y,l.Presence=C,l.Chatstate=f,l.ChatstateCollection=g}),226);
__d("WAWebWamEnumUserNoticeErrorEvent",[],(function(t,n,r,o,a,i){var e=Object.freeze({INVALID_STANZA:1,JSON_FETCH:2,JSON_PARSE:3,IMAGE_FETCH:4,NO_ELIGIBLE_DISCLOSURE:5,DISCLOSURE_STAGE_FETCH:6,UI_TEMPLATE_MISMATCHED:7,ERROR_UNKNOWN:8,SYNC_STAGE_MISMATCH:9,IMAGE_FETCH_400:10,JSON_FETCH_400:11,JSON_FETCH_REDIRECT:12,IMAGE_FETCH_REDIRECT:13,IMAGE_FETCH_FORBIDDEN:14,JSON_FETCH_FORBIDDEN:15,FAIL_TO_SEND_STAGE_TO_SERVER:16});i.USER_NOTICE_ERROR_EVENT=e}),66);
__d("WAWebUserNoticeErrorWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumNoticeType","WAWebWamEnumUserNoticeErrorEvent"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({UserNoticeError:[2474,{noticeType:[4,o("WAWebWamEnumNoticeType").NOTICE_TYPE],userNoticeContentVersion:[2,o("WAWebWamCodegenUtils").TYPES.INTEGER],userNoticeErrorEvent:[3,o("WAWebWamEnumUserNoticeErrorEvent").USER_NOTICE_ERROR_EVENT],userNoticeId:[1,o("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,1],"regular"]},{UserNoticeError:[]});l.UserNoticeErrorWamEvent=e}),98);
__d("isNonZeroNumber",[],(function(t,n,r,o,a,i){"use strict";function e(e){return e!=null&&e!==0&&!isNaN(e)}i.isNonZeroNumber=e}),66);
__d("WAWebGetUserDisclosuresContentsQueryJob",["Promise","WAAbortError","WALogger","WAWebConnModel","WAWebCountryCodeUtils","WAWebHttpErrors","WAWebPonyfillsFetch","WAWebURLUtils","WAWebUserNoticeErrorWamEvent","WAWebUserPrefsInfoStore","WAWebUserPrefsMeUser","WAWebWamEnumUserNoticeErrorEvent","asyncToGeneratorRuntime","err","isNonZeroNumber"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m="https://www.whatsapp.com/user-notice/v1/",p=new Set(["ACCEPT","OK"]),_="zz",f="ZZ";function g(e){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(o("isNonZeroNumber").isNonZeroNumber(e)){var t,a,i=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),l=o("WAWebCountryCodeUtils").pnToCountryCodeString(i.user),s=yield o("WAWebUserPrefsInfoStore").deviceInfo.get(),u=r("WAWebURLUtils").build(m,{id:e,lg:(t=s.lg)!=null?t:_,lc:(a=s.lc)!=null?a:f,cc:l,platform:o("WAWebConnModel").Conn.isSMB?"smbweb":"web"});return y(u,e)}return(d||(d=n("Promise"))).resolve({disclosureId:e})}),h.apply(this,arguments)}function y(e,t){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){try{var n=yield S(e);try{if(n!=null){var r=JSON.parse(n);if(r!=null)return L(r,t)}}catch(e){var a=new(o("WAWebUserNoticeErrorWamEvent")).UserNoticeErrorWamEvent({userNoticeId:t,userNoticeContentVersion:1,userNoticeErrorEvent:o("WAWebWamEnumUserNoticeErrorEvent").USER_NOTICE_ERROR_EVENT.JSON_PARSE});a.commit()}}catch(e){if(e.name===o("WAAbortError").ABORT_ERROR)return;throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Notice: Error Message : ",""])),e.message).sendLogs("pdfn-notice-content-error"),new(o("WAWebHttpErrors")).HttpNetworkError}}),C.apply(this,arguments)}function b(e){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return new(d||(d=n("Promise")))(function(t,n){var r=new FileReader;r.onload=function(){var e=String(r.result);t(e)},r.onerror=n,r.readAsDataURL(e)})}),v.apply(this,arguments)}function S(e){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=new AbortController,n=t.signal,o=yield r("WAWebPonyfillsFetch")(e,{signal:n}),a=o.headers.get("Content-Type");return a==null||a.includes("image/svg+xml")?o.text():a.includes("image/png")?b(yield o.blob()):o.text()}),R.apply(this,arguments)}function L(e,t){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var a=e.policyVersion;if(a==null)throw r("err")("Missing field policyVersion in notice content.");o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Notice:fetchNoticeData successful for policyVersion ",""])),a);var i=I(e),l=k(e),s=parseInt(a,10),m;try{m=yield P(i)}catch(e){var p=new(o("WAWebUserNoticeErrorWamEvent")).UserNoticeErrorWamEvent({userNoticeId:t,userNoticeContentVersion:s,userNoticeErrorEvent:o("WAWebWamEnumUserNoticeErrorEvent").USER_NOTICE_ERROR_EVENT.IMAGE_FETCH});p.commit(),o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Notice: Icon fetch error : ",""])),e.message).sendLogs("notice-icon-fetch-error")}return(d||(d=n("Promise"))).resolve({disclosureId:t,policyVersion:s,privacyDisclosureModal:m!=null?m:i,endDate:l})}),E.apply(this,arguments)}function k(e){var t,n=e["privacy-disclosure"]&&((t=e["privacy-disclosure"])==null||(t=t.timing)==null||(t=t.end)==null?void 0:t.time);return n==null?null:new Date(n)}function I(e){var t=e["privacy-disclosure"]&&T(e["privacy-disclosure"].prompts[0]);return t==null?null:$(t)}function T(e){if(e){D(["icon","iconDescription","title","bullets","primaryButton","nav"],e),D(["light","dark","type"],e.icon),D(["dismissButton","backButton"],e.nav);for(var t=0;t<e.bullets.length;t++)D(["icon","text"],e.bullets[t]);var n=e.footer!=null?{footer:e.footer}:{};return babelHelpers.extends({icon:{light:e.icon.light,dark:e.icon.dark,type:e.icon.type},iconSvg:{light:"",dark:""},iconDescription:e.iconDescription,title:e.title,bullets:e.bullets,primaryButton:e.primaryButton,nav:{dismissButton:e.nav.dismissButton,backButton:e.nav.backButton}},n)}}function D(e,t){e.forEach(function(e){if(!(e in t))throw r("err")("Missing field "+e+" in notice content.")})}var x=function(n){if(!n)return null;var t=n.action;if(t){if(p.has(t))return n;o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Notice: Unknown action type ",""])),t)}return null};function $(e){return e?(e.primaryButton=x(e.primaryButton),e):null}function P(e){return N.apply(this,arguments)}function N(){return N=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){for(var t=[e==null?void 0:e.icon.light,e==null?void 0:e.icon.dark],r=0;r<((o=e==null?void 0:e.bullets.length)!=null?o:0);r++){var o,a=e==null?void 0:e.bullets[r];a!=null&&(t.push(a.icon.light),t.push(a.icon.dark))}for(var i=t.map(function(e){return e!=null?S(e):(d||(d=n("Promise"))).resolve(null)}),l=e,s=yield(d||(d=n("Promise"))).all(i),u=s[0],c=s[1],m=babelHelpers.arrayLikeToArray(s).slice(2),p=[],_=0;_<((f=e==null?void 0:e.bullets.length)!=null?f:0);_++){var f,g=e==null?void 0:e.bullets[_];if(g!=null){var h=m[_*2],y=m[_*2+1];h!=null&&y!=null?p.push(babelHelpers.extends({},g,{iconSvg:{light:h,dark:y}})):p.push(g)}}return e&&u!=null&&c!=null&&(l=babelHelpers.extends({},e,{bullets:p,iconSvg:{light:u,dark:c}})),l}),N.apply(this,arguments)}l.getUserDisclosureContentsQueryJob=g,l.attemptFetch=S}),98);
__d("WAWebGetUserDisclosuresContentsJob",["WAJobOrchestratorTypes","WAWebGetUserDisclosuresContentsQueryJob","WAWebOrchestratorNonPersistedJob"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getDisclosuresContentsJob",function(){return o("WAWebGetUserDisclosuresContentsQueryJob").getUserDisclosureContentsQueryJob(e)},{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}l.getDisclosuresContentsJob=e}),98);
__d("WAWebGetUserDisclosuresContentsAction",["WAWebGetUserDisclosuresContentsJob","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebGetUserDisclosuresContentsJob").getDisclosuresContentsJob(e);return t}),s.apply(this,arguments)}l.getDisclosuresContentAction=e}),98);
__d("WAWebUserDisclosureCollection",["WAWebBaseCollection","WAWebGetUserDisclosuresContentsAction","WAWebUserDisclosureModel","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=864e5,s=(function(t){function a(){for(var a,i=arguments.length,l=new Array(i),s=0;s<i;s++)l[s]=arguments[s];return a=t.call.apply(t,[this].concat(l))||this,a.findImpl=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n,i=a.get(t);if(i!=null&&i.privacyDisclosureModal!=null&&i.endDate!=null&&((n=i.endDate)==null?void 0:n.getTime())>new Date().getTime()&&new Date().getTime()-i.lastUpdated.getTime()<e)return i;var l=yield o("WAWebGetUserDisclosuresContentsAction").getDisclosuresContentAction(parseInt(t,10));if(l!=null){var s=new(r("WAWebUserDisclosureModel"))({id:l.disclosureId,policyVersion:l.policyVersion,privacyDisclosureModal:l.privacyDisclosureModal,endDate:l.endDate,lastUpdated:new Date});return a.gadd(s,{merge:!0}),s}});return function(e){return t.apply(this,arguments)}})(),babelHelpers.assertThisInitialized(a)||babelHelpers.assertThisInitialized(a)}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.updateNoticeStage=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.id,n=e.accepted,o=e.policyVersion,a=new(r("WAWebUserDisclosureModel"))({id:t,policyVersion:o,accepted:n,lastUpdated:new Date});this.gadd(a,{merge:!0})});function t(t){return e.apply(this,arguments)}return t})(),a})(o("WAWebBaseCollection").BaseCollection);s.model=r("WAWebUserDisclosureModel");var u=new s;l.UserDisclosureCollection=u}),98);
__d("WAWebUserDisclosureModel",["WAWebBaseModel","WAWebUserDisclosureCollection"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,t.id=o("WAWebBaseModel").prop(),t.policyVersion=o("WAWebBaseModel").prop(),t.privacyDisclosureModal=o("WAWebBaseModel").prop(),t.endDate=o("WAWebBaseModel").prop(),t.accepted=o("WAWebBaseModel").session(),t.lastUpdated=o("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getCollection=function(){return o("WAWebUserDisclosureCollection").UserDisclosureCollection},t})(o("WAWebBaseModel").BaseModel);e.Proxy="userDisclosure";var s=o("WAWebBaseModel").defineModel(e);l.default=s}),98);
__d("WAWebViewOnceState",["WATimeUtils","WAWebAck","WAWebFrontendMsgGetters","WAWebStateUtils"],(function(t,n,r,o,a,i,l){var e=1209600;function s(e){var t=o("WAWebStateUtils").unproxy(e);return t!=null?o("WAWebFrontendMsgGetters").getAsViewOnce(t.unsafe()):null}function u(e){return!c(e)&&!d(e)}function c(e){var t;return((t=s(e))==null?void 0:t.ack)===o("WAWebAck").ACK.PLAYED}function d(t){var n=s(t);if(n==null)return!1;var r=o("WATimeUtils").unixTime()-o("WAWebStateUtils").unproxy(n).t;return!c(n)&&r>=e}l.VIEW_ONCE_EXPIRE_AFTER=e,l.isUnviewed=u,l.isViewed=c,l.isExpired=d}),98);
__d("WAWebAppMutex",["fbt","Promise","WACustomError","WAFilteredCatch","WALogger","WAPromiseTimeout","WAResolvable","WAWebAlarm","WAWebCallCollection","WAWebCmd","WAWebEventsWaitForEvent","WAWebL10N","WAWebLaunchSocket","WAWebPageLoadLogging","WAWebUserPrefsKeys","WAWebUserPrefsStore","WAWebUserPrefsTabMutex","WAWebVoipGatingUtils","asyncToGeneratorRuntime","justknobx"],(function(t,n,r,o,a,i,l,s){var e,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I=6e5,T={INIT:"init",PING:"ping",PONG:"pong",TAKEOVER:"local-takeover",CHECK_ACTIVE_CALL:"check-active-call",ACTIVE_CALL_RESPONSE:"active-call-response",FOCUS_REQUEST:"focus-request"},D=(function(){function t(){var e=this;this.$3=!1,this.$4=!0,this.$5=new(o("WAResolvable")).Resolvable,this.$6=!1,this.$8=function(){e.$10();var t=Date.now();o("WAWebUserPrefsTabMutex").setMutex(e.$1=T.INIT+"_"+t),e.$2=r("WAWebAlarm").setLocalTimeout(e.$8,t+I)},o("WAWebCmd").Cmd.on("ab_props_loaded",$),o("WAWebCmd").Cmd.on("on_ab_props_update",$)}var a=t.prototype;return a.hasShownCallTakeoverModal=function(){return this.$6},a.waitForCompletion=function(){return this.$5.promise},a.setShouldLaunchSocket=function(n){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[app] AppMutex setting shouldLaunchSocket: ",""])),n),this.$4=n},a.init=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){e===void 0&&(e=0),this.$3||(o("WAWebPageLoadLogging").startPageLoadQplMeasure("acquire_mutex"),this.$3=!0);var t=e+1;if(t>3)return o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[app] AppMutex init generation: ",""])),t),!0;var n=o("WAWebUserPrefsTabMutex").getNoTakeover();o("WAWebUserPrefsTabMutex").setNoTakeover();var a=yield this.$7();if(a)return this.$8(),o("WAWebPageLoadLogging").endPageLoadQplMeasure("acquire_mutex"),this.$4&&(yield o("WAWebLaunchSocket").launchSocket(null)),this.$5.resolve(),r("WAWebL10N").checkForLocaleMismatchBetweenCookieAndUserPref(),!1;if(r("justknobx")._("4316")){var i=yield this.$9();if(i)return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["app:init: Other tab has active call, setting flag"]))),this.$6=!0,!0}if(n)return o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[app] AppMutex init no take over"]))),!0;throw t});function t(t){return e.apply(this,arguments)}return t})(),a.takeoverLocal=function(t){var e=this;return o("WAWebUserPrefsTabMutex").getMutex()?(o("WAWebPageLoadLogging").startPageLoadQplMeasure("mutex_takeover"),o("WAWebUserPrefsTabMutex").setMutex(T.TAKEOVER),o("WAPromiseTimeout").promiseTimeout(r("WAWebEventsWaitForEvent")(window,"storage",o("WAWebUserPrefsTabMutex").takeoverFilter),3e4,"takeoverLocalTimeout").then(function(n){return o("WAWebUserPrefsTabMutex").removeMutex(),o("WAWebPageLoadLogging").endPageLoadQplMeasure("mutex_takeover"),e.init(t)}).catch(o("WAFilteredCatch").filteredCatch(o("WACustomError").TimeoutError,function(){return o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[app] takeoverLocal timeout"]))),o("WAWebUserPrefsTabMutex").removeMutex(),o("WAWebPageLoadLogging").addPageLoadQplAnnotation({mutex_takeover_timeout:!0}),o("WAWebPageLoadLogging").endPageLoadQplMeasure("mutex_takeover"),e.init(t)})).finally(function(){o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[mutex] shut down an existing instance of WA Web"])))})):this.init(t)},a.unloadMutex=function(){var e=o("WAWebUserPrefsTabMutex").getMutex();e&&this.$1&&e.includes(this.$1)&&o("WAWebUserPrefsTabMutex").removeMutex()},a.storagePong=function(t){if(o("WAWebUserPrefsTabMutex").mutexFilter(t)){var e=o("WAWebUserPrefsTabMutex").parseMutex(t.newValue);if(e){if(e===T.TAKEOVER)return this.$10(),o("WAWebUserPrefsTabMutex").localTakeoverSuccess(),!0;if(e.indexOf(T.PING)===0)o("WAWebUserPrefsTabMutex").setMutex(T.PONG+Math.random());else if(e.indexOf(T.CHECK_ACTIVE_CALL)===0){if(o("WAWebVoipGatingUtils").isCallingEnabled()){var n=r("WAWebCallCollection").activeCall!=null;o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["app:storagePong: responding to active call check, hasCall: ",""])),n),o("WAWebUserPrefsTabMutex").setMutex(T.ACTIVE_CALL_RESPONSE+"_"+String(n))}}else e.indexOf(T.FOCUS_REQUEST)===0&&o("WAWebVoipGatingUtils").isCallingEnabled()&&(o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["app:storagePong: received focus request, focusing window"]))),this.$11())}}},a.$10=function(){this.$2!=null&&r("WAWebAlarm").clearTimeout(this.$2)},a.$7=function(){var e=o("WAWebUserPrefsTabMutex").getMutex();if(e){o("WAWebPageLoadLogging").startPageLoadQplMeasure("mutex_ping"),e+="";var t=1e3;if(e.indexOf("_")>0){var a=e.split("."),i=parseInt(a[a.length-1],10);if(Number.isFinite(i)){var l=Date.now()-I*1.5;i<l&&(o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[app] _pingForOtherLocalSession stale mutex"]))),t=1e3)}}var s=o("WAPromiseTimeout").promiseTimeout(r("WAWebEventsWaitForEvent")(window,"storage",o("WAWebUserPrefsTabMutex").mutexFilter),t,"waitForOtherLocalSessionTimeout").then(function(){return o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[app] _pingForOtherLocalSession other session is alive"]))),!1}).catch(o("WAFilteredCatch").filteredCatch(o("WACustomError").TimeoutError,function(){return o("WALogger").WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[app] _pingForOtherLocalSession mutex timeout after ","ms"])),t),o("WAWebPageLoadLogging").addPageLoadQplAnnotation({mutex_ping_timeout:!0}),!0}));return s.finally(function(){return o("WAWebPageLoadLogging").endPageLoadQplMeasure("mutex_ping")}),o("WAWebUserPrefsTabMutex").setMutex(T.PING+Math.random()),s}return(k||(k=n("Promise"))).resolve(!0)},a.$9=function(){var e=o("WAWebUserPrefsTabMutex").getMutex();if(!e)return(k||(k=n("Promise"))).resolve(!1);var t=o("WAPromiseTimeout").promiseTimeout(r("WAWebEventsWaitForEvent")(window,"storage",function(e){return o("WAWebUserPrefsTabMutex").mutexFilter(e)&&e.newValue!=null&&e.newValue.indexOf(T.ACTIVE_CALL_RESPONSE)>=0}),2e3,"checkActiveCallTimeout").then(function(e){var t,n=o("WAWebUserPrefsTabMutex").parseMutex((t=e.newValue)!=null?t:"");if(n&&n.indexOf(T.ACTIVE_CALL_RESPONSE)===0){var r=n.split("_")[1]==="true";return o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["app:_checkForActiveCallInOtherTab: other tab has active call: ",""])),r),r}return!1}).catch(o("WAFilteredCatch").filteredCatch(o("WACustomError").TimeoutError,function(){return o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["app:_checkForActiveCallInOtherTab timeout"]))),!1}));return o("WAWebUserPrefsTabMutex").setMutex(T.CHECK_ACTIVE_CALL+Math.random()),t},a.requestFocusOnOtherTab=function(){var e=this;o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["app:requestFocusOnOtherTab: requesting notification permission in this tab first"]))),Notification!==void 0&&Notification.permission==="default"?Notification.requestPermission().then(function(){e.$12()}).catch(function(t){o("WALogger").WARN(S||(S=babelHelpers.taggedTemplateLiteralLoose(["[app] Failed to request notification permission: ",""])),t),e.$12()}):this.$12()},a.$12=function(){o("WALogger").LOG(R||(R=babelHelpers.taggedTemplateLiteralLoose(["app:requestFocusOnOtherTab: sending focus request to other tab"]))),o("WAWebUserPrefsTabMutex").setMutex(T.FOCUS_REQUEST+Math.random())},a.$11=function(){Notification!==void 0&&Notification.permission==="granted"&&this.$13()},a.$13=function(){var e=new Notification(s._(/*BTDS*/"WhatsApp\u00a0Web").toString(),{body:s._(/*BTDS*/"Tienes una llamada activa en esta ventana").toString(),requireInteraction:!0,tag:"wa-web-call-active"});e.onclick=function(){window.focus(),e.close()},window.setTimeout(function(){e.close()},5e3)},t})();function x(e){o("WALogger").DEV(L||(L=babelHelpers.taggedTemplateLiteralLoose(["[mutex] setPingTimeoutSeconds: ",""])),e),r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").KEYS.MUTEX_PING_TIMEOUT_SECONDS,e)}function $(){x(1),o("WALogger").LOG(E||(E=babelHelpers.taggedTemplateLiteralLoose(["[mutex] setMutexBlockStrategy: ",""])),0),r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").UserPrefs.MutexBlockStrategy,0)}var P=new D;l.default=P}),226);
__d("WAWebUpdater",["Promise","WALogger","WAWebAlarm","WAWebMiscBrowserUtils","WAWebStreamModel","WAWebSwUpdater","WAWebUpdaterBaseUpdater","WAWebUpdaterDownloadStateType","WAWebUpdaterVersion","cr:6022"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=(function(t){function a(){return t.apply(this,arguments)||this}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.showSoftUpdateBanner=function(){o("WAWebStreamModel").Stream.needsUpdate=!0},i.update=function(a,i,l){var t=this;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["AppUpdate:update current: "," latest: ",""])),String(this.activeVersion),String(a));var s=++this.latestUpdateIteration,u=a==null?void 0:new(o("WAWebUpdaterVersion")).Version(a);return this.clearHardExpiration(),typeof l=="number"&&(this.hardExpirationTimer=r("WAWebAlarm").setLocalTimeout(function(){o("WAWebStreamModel").Stream.clientExpired=!0,t.restart()},Date.now()+l)),this.updateInProgress=(c||(c=n("Promise"))).resolve(this.updateInProgress).then(function(){return t._update(u)}).then(function(e){t.updateInProgress=void 0;var n=s!==t.latestUpdateIteration,r=e===o("WAWebUpdaterDownloadStateType").DownloadState.ERROR,a=e===o("WAWebUpdaterDownloadStateType").DownloadState.UPDATE_NOT_AVAILABLE;return n||r||a||((i===!0||typeof l=="number")&&(o("WAWebStreamModel").Stream.needsUpdate=!0),typeof l=="number"&&t.listenToAndRun(o("WAWebStreamModel").Stream,"change:couldForce",function(){o("WAWebStreamModel").Stream.couldForce&&t.restart()})),e}),this.updateInProgress},i._update=function(t){if(!this.activeVersion.equals(t)&&n("cr:6022")!=null&&n("cr:6022").alive)return o("WAWebSwUpdater").updateSw();var e=this.activeVersion.equals(t)?o("WAWebUpdaterDownloadStateType").DownloadState.UPDATE_NOT_AVAILABLE:o("WAWebUpdaterDownloadStateType").DownloadState.UPDATE_DOWNLOADED;return(c||(c=n("Promise"))).resolve(e)},i.killServiceWorker=function(){if(!(n("cr:6022")!=null&&n("cr:6022").alive))return(c||(c=n("Promise"))).resolve();var e=navigator.serviceWorker;return e?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Killing service worker"]))),e.ready.then(function(e){return e.unregister()}).then(function(e){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Service worker unregistration status: ",""])),String(e))})):(c||(c=n("Promise"))).resolve()},i.restart=function(t){return t===!0?this.update(void 0,!0,0):(r("WAWebMiscBrowserUtils").hardRefresh(),(c||(c=n("Promise"))).resolve(o("WAWebUpdaterDownloadStateType").DownloadState.UPDATE_DOWNLOADED))},a})(o("WAWebUpdaterBaseUpdater").UpdaterBase),m=new d;l.UpdaterImpl=d,l.Updater=m}),98);
__d("WAWebUpdaterBaseUpdater",["WACustomError","WAWebAlarm","WAWebBuildConstants","WAWebEventEmitter","WAWebStreamModel","WAWebUpdaterVersion","WAWebWAWCStorage"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){var t;return t=e.call(this)||this,t.$UpdaterBase$p_1=!1,t.latestUpdateIteration=0,t.activeVersion=new(o("WAWebUpdaterVersion")).Version(o("WAWebBuildConstants").VERSION_BASE),r("WAWebWAWCStorage").onVersionChange(function(){return t.setForceUpdateOnTakeOver()}),t}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.setForceUpdateOnTakeOver=function(){this.$UpdaterBase$p_1=!0},n.shouldForceUpdateOnTakeOver=function(){var e=this.$UpdaterBase$p_1;return this.$UpdaterBase$p_1=!1,!!e},n.isExpired=function(){return!1},n.clearHardExpiration=function(){this.hardExpirationTimer&&(r("WAWebAlarm").clearTimeout(this.hardExpirationTimer),this.hardExpirationTimer=void 0),this.stopListening(o("WAWebStreamModel").Stream,"change:couldForce")},n.update=function(t,n,r,a){throw new(o("WACustomError")).UnimplementedMethod("Updater::update")},n.showSoftUpdateBanner=function(){throw new(o("WACustomError")).UnimplementedMethod("Updater::showSoftUpdateBanner")},n.restart=function(t){throw new(o("WACustomError")).UnimplementedMethod("Updater::restart")},n.manualDownload=function(){throw new(o("WACustomError")).UnimplementedMethod("Updater::manualDownload")},n.killServiceWorker=function(){throw new(o("WACustomError")).UnimplementedMethod("Updater::killServiceWorker")},t})(r("WAWebEventEmitter"));l.UpdaterBase=e}),98);